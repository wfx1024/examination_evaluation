! function (d, x, p) {
    "use strict";
    var N = "ht";
    if (!d[N]) {
        ! function () {
            Date.now && Date.prototype.getTime || (Date.now = function () {
                return (new Date).getTime()
            }), d.performance && d.performance.now || function () {
                var P = Date.now();
                d.performance || (d.performance = {}), d.performance.now = function () {
                    return Date.now() - P
                }
            }();
            for (var Q = Date.now(), D = 16, t = ["ms", "moz", "webkit", "o"], N = 0; N < t.length && !d.requestAnimationFrame; ++N) d.requestAnimationFrame = d[t[N] + "RequestAnimationFrame"], d.cancelAnimationFrame = d[t[N] + "CancelAnimationFrame"] || d[t[N] + "CancelRequestAnimationFrame"];
            d.requestAnimationFrame || (d.requestAnimationFrame = function (L) {
                var B = Date.now(),
                    T = D + Q - B;
                return 0 > T && (T = 0), Q = B, d.setTimeout(function () {
                    Q = Date.now(), L(performance.now())
                }, T)
            }), d.cancelAnimationFrame || (d.cancelAnimationFrame = function (T) {
                return d.clearTimeout(T)
            }), x.assign === p && (x.assign = function (M) {
                if (M === p || null === M) throw new TypeError("Cannot convert undefined or null to object");
                for (var l = x(M), H = 1; H < arguments.length; H++) {
                    var T = arguments[H];
                    if (T !== p && null !== T)
                        for (var C in T) x.prototype.hasOwnProperty.call(T, C) && (l[C] = T[C])
                }
                return l
            })
        }();
        var b = d.document,
            h = null,
            k = d[N] = {},
            Z = d[N + "config"],
            f = k.Default = Z && Z.Default || {},
            C = k.Style = Z && Z.Style || {},
            B = k.Attr = Z && Z.Attr || {},
            F = k.Color = Z && Z.Color || {},
            n = k.IsGetter = Z && Z.IsGetter || {};
        ! function () {
            var L = !1;
            try {
                var D = x.defineProperty({}, "passive", {
                    get: function () {
                        L = !0
                    }
                });
                d.addEventListener("test", D, D), d.removeEventListener("test", D, D)
            } catch (G) {
                L = !1
            }
            f.passiveSupported = L
        }();
        var J, o, z, U, T = f.passiveSupported,
            V = f.eventListenerOptionsFalse = T ? {
                passive: !1,
                capture: !1
            } : !1,
            M = f.eventListenerOptionsTrue = T ? {
                passive: !1,
                capture: !0
            } : !0,
            t = Math,
            r = t.round,
            e = t.floor,
            _ = t.ceil,
            l = t.sqrt,
            W = t.max,
            j = t.min,
            Y = t.abs,
            w = t.cos,
            O = t.acos,
            R = t.sin,
            y = t.pow,
            s = t.asin,
            c = t.PI,
            E = 2 * c,
            g = c / 2,
            Q = t.tan,
            H = t.atan2,
            G = t.random,
            D = t.log,
            m = !0,
            S = !1,
            A = d.parseInt || global.parseInt,
            u = "9999-12-31",
            K = d.navigator ? d.navigator.platform.indexOf("Win") > -1 : !1,
            L = function (O) {
                return O * O
            },
            q = d.setTimeout,
            I = d.clearTimeout,
            P = d.location,
            a = d.navigator ? d.navigator.userAgent.toLowerCase() : "",
            i = function (q) {
                return q.test(a)
            },
            X = i(/msie/),
            v = i(/msie/) || i(/trident/),
            $ = i(/msie 10/),
            dn = i(/edge/),
            hk = i(/firefox/),
            km = i(/mac/),
            ah = f.isTouchable === p ? K ? !1 : b ? "ontouchend" in b : !1 : f.isTouchable,
            ri = "default",
            er = "single",
            Io = "multiple",
            fg = "front",
            Hc = "back",
            ul = "left",
            sb = "right",
            $b = "top",
            Id = "bottom",
            re = "center",
            pr = "eye",
            vn = "middle",
            dk = "east",
            _d = "west",
            Ah = "north",
            Tr = "none",
            Do = "px",
            nl = "absolute",
            ae = "border",
            Cp = "triangle",
            as = "rect",
            wk = "circle",
            sh = "cylinder",
            ef = "shape",
            Nb = "items",
            Mn = "normal",
            sc = "remove",
            cf = "clear",
            hi = "width",
            bg = "height",
            ih = "ingroup",
            Mb = "check",
            yd = "uncheck",
            Yl = "radio",
            _l = "radioOn",
            bs = "radioOff",
            gs = "points",
            og = "values",
            Oh = "series",
            id = "body",
            Qk = "label",
            _g = "label2",
            zm = "note",
            Uj = "note2",
            lk = "icons",
            Vi = "labelFont",
            kd = "labelColor",
            fq = "labelSelectColor",
            Li = "note.expanded",
            xg = "note2.expanded",
            Mq = "edge.expanded",
            Wr = "edge.points",
            Oo = "edge.type",
            Dn = "rotation",
            _c = "hidden",
            Fm = "visible",
            Cr = "tuv",
            ob = "no",
            wn = "draw",
            ek = "select",
            Dj = "currentSubGraph",
            Vr = "selectBackground",
            tj = "autoMakeVisible",
            hj = "autoHideScrollBar",
            Fb = "scrollBarColor",
            Vn = "scrollBarSize",
            rp = "indent",
            Sm = "rowHeight",
            $i = "columnLineColor",
            Zi = "rowLineColor",
            nh = "columnLineVisible",
            Ac = "rowLineVisible",
            Wq = "visibleFunc",
            gf = "expandIcon",
            de = "collapseIcon",
            wo = "checkMode",
            Xc = "sortFunc",
            Tc = "editable",
            Bq = "batchEditable",
            Rh = "tristate",
            ye = "asc",
            qr = "desc",
            cr = "position",
            Je = "elevation",
            pe = "children",
            mb = "translateX",
            qc = "translateY",
            Oq = "dataModel",
            pb = "maxSize",
            fs = "shape3d",
            Hj = "shape3d.resolution",
            pl = "shape3d.visible",
            se = "shape3d.from.visible",
            Yg = "shape3d.to.visible",
            gp = "shape3d.top.visible",
            db = "shape3d.bottom.visible",
            Vo = "repeat.uv.length",
            vp = "serializeValue",
            Gn = "deserializeValue",
            Hq = "centerUniform",
            oe = "uniform",
            ql = "rgba(255,255,255,0)",
            Zq = "style",
            Pg = "attr",
            Wj = "field",
            Rf = "string",
            Mc = "boolean",
            mf = "color",
            Bb = "int",
            Nh = "number",
            xo = "ew-resize",
            Mr = "ns-resize",
            Pf = "pointer",
            Jn = "auto",
            Jl = "mousedown",
            th = "mousemove",
            wr = "mouseup",
            Wn = "mouseout",
            vh = "touchstart",
            Cn = "touchmove",
            hc = "touchend",
            Bm = "keydown",
            Xe = "keyup",
            nq = ["DOMMouseScroll", "mousewheel"],
            xb = hk ? nq[0] : nq[1],
            Nc = ah ? [vh, Cn, hc, Bm, Xe, "keypress", "input", "contextmenu", "compositionstart", "compositionupdate", "compositionend"] : [Bm, Xe, "keypress", "input", Jl, th, wr, Wn, xb, "wheel", "contextmenu", "mouseenter", "mouseleave", "mouseover", "compositionstart", "compositionupdate", "compositionend"],
            Qi = h,
            Tj = h,
            wb = h,
            Xq = wr.length,
            Wf = function () {
                wb && (I(wb.timeout), wb = h)
            },
            Re = function () {
                wb && _o(wb.e, wb.info)
            };
        d.addEventListener && (ah || (d.addEventListener(Wn, function () {
            Wf()
        }, V), d.addEventListener(xb, function () {
            hn()
        }, V)), d.addEventListener(Xe, function (A) {
            91 === A.keyCode ? Ae = {} : delete Ae[A.keyCode]
        }, M), d.addEventListener(Bm, function (c) {
            Ae[c.keyCode] = !0
        }, M), d.addEventListener("blur", function () {
            Ae = {}
        }, V));
        var Nf, dl, yk, vk = 0,
            up = h,
            Lm = function (E, F) {
                var M = q(function () {
                    delete up[M], nm(up) && (up = h), E()
                }, F);
                return M
            },
            qs = h,
            lj = h,
            gc = {},
            Xn = {},
            kr = {},
            Yb = {},
            wc = {},
            Ae = {},
            rm = {},
            je = {},
            bn = {},
            yc = {},
            Eq = /.json$/,
            cc = /^data:image\/svg\+xml/,
            Ij = {},
            Em = [],
            di = {},
            cm = h,
            An = h,
            qm = function () {},
            Zf = function () {
                throw "Oops!"
            },
            sk = [0, 0, 0],
            sf = {
                x: 0,
                y: 0,
                width: 0,
                height: 0
            },
            No = h,
            xl = h,
            kc = h,
            yo = function (v, w) {
                Xn[v] = w, w && w.comps && !w.uuid && (w.uuid = k.Math.generateUUID()), Pk[v] && (w.cacheRule = Pk[v], delete Pk[v])
            },
            $c = function (I) {
                xl && !I._72O && (kc || (kc = {}), kc[I._72O = Uk()] = I), Nf != h ? Jc() < .05 && U && !dl && (Tm = Wf) : Tm = rl
            },
            Ye = function (E, w, J, r) {
                xl || (xl = {});
                var i = xl[E];
                if (i) {
                    if (i.url === w) return;
                    i.image ? (i.image.onload = qm, i.image.onerror = qm) : i.request && (i.request.onload = qm, i.request.onerror = qm)
                }
                if (Eq.test(w)) {
                    var L = new ne;
                    if (xl[E] = {
                            request: L,
                            url: w
                        }, w = f.beforeLoadURL(w), w.data) {
                        var R = f.parse(w.data);
                        _q(E, R), f.handleImageLoaded(E, R)
                    } else {
                        L.onload = function (s) {
                            if (200 === this.status || 0 === this.status) {
                                var W = f.parse(s.target.response || s.target.responseText);
                                _q(E, W), f.handleImageLoaded(E, W)
                            } else _q(E, f.handleUnfoundImage(E, w) || h)
                        }, L.onerror = function () {
                            _q(E, f.handleUnfoundImage(E, w) || h)
                        };
                        var s = {};
                        s.url = encodeURI(w), s.sync = !1, L.send(s)
                    }
                } else {
                    var R = new Image;
                    xl[E] = {
                        image: R,
                        url: w
                    }, /^data:image/.test(w) || (w = f.beforeLoadURL(w), w = f.appendTimeStamp(w), w = encodeURI(w), R.crossOrigin = f.crossOrigin), f.convertImageSrc(w, function (p) {
                        v && (w.toLowerCase().indexOf(".svg") > 0 || cc.test(w)) ? (b.body.appendChild(R), R.style.visibility = "hidden", R.onload = function () {
                            q(function () {
                                if (J && (R.width = J), r && (R.height = r), !R.width || !R.height) {
                                    var t = R.width || R.clientWidth,
                                        N = R.height || R.clientHeight;
                                    R.width = t, R.height = N
                                }
                                f.handleImageLoaded(E, R), _q(E, R), b.body.removeChild(R), R.style.visibility = ""
                            }, 180)
                        }, R.onerror = function () {
                            _q(E, f.handleUnfoundImage(E, w) || h), b.body.removeChild(R), R.style.visibility = ""
                        }) : (R.onload = function () {
                            J && (R.width = J), r && (R.height = r), f.handleImageLoaded(E, R), _q(E, R)
                        }, R.onerror = function () {
                            _q(E, f.handleUnfoundImage(E, w) || h)
                        }), R.src = p
                    })
                }
            },
            _q = function (w, z) {
                if (yo(w, z), delete xl[w], nm(xl) && (xl = h, kc)) {
                    for (var T in kc) {
                        var l = kc[T];
                        l._2O && (l._2O = {}), l.invalidateAll && l.invalidateAll(p, "imageLoaded", w), l.redraw && l.redraw(), l.iv(), delete l._72O
                    }
                    kc = h
                }
                if (z && kc)
                    for (var T in kc) {
                        var l = kc[T];
                        l.invalidateAll && l.invalidateAll(p, "imageLoading", w), l.redraw && l.redraw(), l.iv()
                    }
            },
            Td = function () {
                return D = t && Date,
                    function () {
                        return d.performance && d.performance.now ? d.performance.now() : Date.now()
                    }
            }(),
            $r = function (y, r) {
                r ? I(y) : d.cancelAnimationFrame(y)
            },
            Zn = function (B, u, L) {
                return {
                    width: B,
                    height: u,
                    comps: nj(L) ? L : [L]
                }
            },
            Km = function (Z, K) {
                return {
                    type: wk,
                    rect: [Z, K, 1.6, 1.6],
                    borderWidth: 1,
                    borderColor: Hm,
                    gradient: Xb,
                    gradientColor: ho,
                    background: Hm
                }
            },
            Fj = function (U, o) {
                return Zn(16, 16, {
                    type: Cp,
                    rect: [4, 4, 10, 8],
                    background: U,
                    rotation: o ? 1.57 : 3.14
                })
            },
            Wc = function (Q, J) {
                return Zn(16, 16, {
                    type: Cp,
                    rect: [4, 4, 8, 7],
                    background: Q,
                    rotation: J ? 3.14 : 0
                })
            },
            Vl = function (o) {
                var O = o._orientation;
                return "horizontal" === O || "h" === O
            },
            me = function (K) {
                var G = h || 4,
                    k = h || 1,
                    i = h || 1;
                0 > G ? G = 0 : G > .25 && (G = .25);
                var z, e, Q, l, $, O, f, V = .5,
                    D = [],
                    N = [],
                    S = [],
                    X = E / i,
                    C = E / k,
                    B = V - G;
                for (e = 0; k >= e; e++)
                    for (l = -c + e * C, O = w(l), $ = R(l), z = 0; i >= z; z++) Q = z * X, f = B + G * O, D.push(w(Q) * f, $ * G, -R(Q) * f), (o = K) && N.push(z / i, 1 - e / k);
                for (e = 0; k > e; e++) {
                    var g = e * (i + 1),
                        W = (e + 1) * (i + 1);
                    for (z = 0; i > z; z++) S.push(g + z, W + z + 1, W + z, g + z, g + z + 1, W + z + 1), Xi.z = Ep.z = K
                }
            },
            Nr = function (b) {
                var D = 2,
                    E = 0;
                for (var w in b) w.length === D && A(w, 32) === ei && (cm = An = b[w]), E++;
                return E
            },
            af = function (v, s, w, g) {
                return w || (w = ah ? 5 : 3, w /= g || 1), {
                    x: v - w,
                    y: s - w,
                    width: 2 * w,
                    height: 2 * w
                }
            },
            Ed = function (S, D, k, i) {
                var G = this;
                D || (D = ah ? 5 : 3, k = 20, i = 20);
                var u = {
                    x: S,
                    y: D,
                    width: k,
                    height: i
                };
                if (k)
                    for (var K = 0; k > K; K++)
                        if (3 === k) i = 20;
                        else
                            for (var x = 0; i > x; x++) G = d ? d : k;
                var n = {
                    x: c,
                    y: 2 * c
                };
                if (nr(u, n)) {
                    var g = bg[0] + $b[0] + cf[1] + (ye.length - 1);
                    Rm[pr] = G[g], G[g] = io[pr]
                }
            },
            gr = function (Y) {
                return (/ble$/.test(Y) || /ed$/.test(Y) || n[Y] ? "is" : "get") + Y.charAt(0).toUpperCase() + Y.slice(1)
            },
            io = function (v) {
                return "set" + v.charAt(0).toUpperCase() + v.slice(1)
            },
            Qc = function (e) {
                return typeof e === Rf || e instanceof String
            },
            Rj = function (y) {
                return typeof y === Nh
            },
            rl = function (g) {
                return typeof g === Mc
            },
            cl = function (r) {
                return r && "object" == typeof r
            },
            Yr = function (L) {
                return "function" == typeof L
            },
            nj = function (L) {
                return L instanceof Array
            },
            Er = function (Q) {
                return Q instanceof vf
            },
            Xo = function (T) {
                return nj(T) ? new vf(T) : T
            },
            Cc = function (I) {
                return I instanceof Ln
            },
            kn = function (N) {
                return N instanceof nk
            },
            an = function (i) {
                return i instanceof no
            },
            Jk = function (u, $) {
                if (!(u instanceof k.Group)) return !1;
                if (!$) return u.isExpanded();
                var B = $.getDataUI(u);
                return B && B._88I ? !0 : !1
            },
            Sg = function (s) {
                return s instanceof tf
            },
            tq = function (v) {
                return v && "IFRAME" === v.tagName
            },
            Vg = function (J) {
                return J == h || f.numberDigits == h ? J : parseFloat(J.toFixed(f.numberDigits))
            },
            ug = function (P, B, s) {
                var Z, g = B.length;
                if (s)
                    for (var G = 0; s > G; G++)
                        if (3 === g) P.push(B[0]), P.push(B[1]), P.push(B[2]);
                        else
                            for (Z = 0; g > Z; Z++) P.push(B[Z]);
                else if (3 === g) P.push(B[0]), P.push(B[1]), P.push(B[2]);
                else
                    for (Z = 0; g > Z; Z++) P.push(B[Z])
            },
            Gl = function (d) {
                return d ? cl(d) ? d : {} : !1
            },
            xr = function (S, M, C) {
                var Y, h = cl(S) ? S : S.prototype;
                for (Y in M) C && h[Y] !== p || (h[Y] = M[Y]);
                return S
            },
            tb = function (x) {
                return String.fromCharCode(x)
            },
            Mk = function (w) {
                for (var i, o = 0, e = ""; o < w.length; o++) i = w[w.length - 1 - o], "%" === i ? i = "'" : "a" === i ? i = '"' : "]" === i && (i = "\\"), e += tb(i.charCodeAt(0) - 1);
                return e
            },
            cj = function (T, r, $) {
                T.superClass.constructor.apply(r, $)
            },
            nm = function (X) {
                for (var q in X) return !1;
                return !0
            },
            ji = function (n) {
                return n ? 0 === n.length : !0
            },
            $f = function () {
                var Y = "";
                return [yd[0], Zi[0], Qk[0]].forEach(function (x) {
                    Y += io(x).slice(3)
                }), oe = b && b[Y] || Hq,
                    function (J, c) {
                        return J === c ? !0 : J.x === c.x && J.y === c.y && J.width === c.width && J.height === c.height
                    }
            }(),
            nf = function (r, E, i) {
                return E > r ? E : r > i ? i : r
            },
            Ir = function (J) {
                return 0 > J ? -1 : J > 0 ? 1 : 0
            },
            Jc = function () {
                var V = 1e4 * R(Xq++);
                return V - e(V)
            },
            oq = function (S, H, N) {
                return Uo(S.x, S.y, H.x, H.y, N.x, N.y, N.x + N.width, N.y, !0) || Uo(S.x, S.y, H.x, H.y, N.x + N.width, N.y, N.x + N.width, N.y + N.height, !0) || Uo(S.x, S.y, H.x, H.y, N.x + N.width, N.y + N.height, N.x, N.y + N.height, !0) || Uo(S.x, S.y, H.x, H.y, N.x, N.y + N.height, N.x, N.y, !0)
            },
            Uo = function (B, r, u, L, I, D, T, e, z) {
                var w = (T - I) * (r - D) - (e - D) * (B - I),
                    Y = (e - D) * (u - B) - (T - I) * (L - r);
                if (0 !== Y) {
                    var y = w / Y,
                        f = B + y * (u - B),
                        o = r + y * (L - r);
                    return z && (f + iq < j(B, u) || f - iq > W(B, u) || f + iq < j(I, T) || f - iq > W(I, T) || o + iq < j(r, L) || o - iq > W(r, L) || o + iq < j(D, e) || o - iq > W(D, e)) ? h : [f, o]
                }
                return h
            },
            nd = function (g, F, L) {
                if (g && L)
                    if (F) {
                        if (F === Zq) return g.getStyle(L);
                        if (F === Pg) return g.getAttr(L);
                        if (F === Wj) return g[L]
                    } else if (L = gr(L), g[L]) return g[L]();
                return p
            },
            Qe = function (d, P, c, H) {
                if (d && c)
                    if (P) {
                        if (P === Zq) d.s(c, H);
                        else if (P === Pg) d.a(c, H);
                        else if (P === Wj) {
                            var h = d[c];
                            d[c] = H, d.fp("f:" + c, h, H)
                        }
                    } else c = io(c), d[c] && d[c](H)
            },
            ep = function (K, H, b) {
                return H && "top" !== H ? "bottom" === H ? {
                    x: K.x,
                    y: K.y,
                    width: K.width,
                    height: K.height * b
                } : "right" === H ? {
                    x: K.x,
                    y: K.y,
                    width: K.width * b,
                    height: K.height
                } : "left" === H ? {
                    x: K.x + K.width * (1 - b),
                    y: K.y,
                    width: K.width * b,
                    height: K.height
                } : void 0 : {
                    x: K.x,
                    y: K.y + K.height * (1 - b),
                    width: K.width,
                    height: K.height * b
                }
            },
            hq = function (w, o, p, X, B) {
                o && to(w, p, X, 1, B, o)
            },
            Wp = function (d, n, e, y) {
                var Y = 1 - d;
                return Y * Y * n + 2 * d * Y * e + d * d * y
            },
            Xi = function (K, i, x, g, W) {
                var d = 1 - K;
                return d * d * d * i + 3 * d * d * K * x + 3 * d * K * K * g + K * K * K * W
            },
            Xh = function (b) {
                var G, j, N, O, u = 0;
                return b.forEach(function (W) {
                    if (G = W.length, G > 0)
                        for (j = W[0], O = 1; G > O; O++) N = W[O], u += Me(j, N), j = N
                }), u
            },
            hb = function (d, H, G) {
                var u = "__" + d,
                    y = function (M) {
                        G.disabled || G["handle_" + d](M)
                    };
                G[u] || (G[u] = y, H.addEventListener(d, y, V))
            },
            pk = function (O, p, l) {
                var i = "__" + O,
                    R = l[i];
                R && (p.removeEventListener(O, R, V), delete l[i])
            },
            bc = function (O, t) {
                var l = "_" + t;
                O[gr(t)] = function () {
                    return this[l]
                }, O[io(t)] = function (Y) {
                    var u = this[l];
                    this[l] = Y, this.fp(t, u, Y)
                }
            },
            Oi = function (U) {
                return x.create(U)
            },
            Yj = function (O) {
                if (!O.element) {
                    var C, f;
                    (C = O.textField) ? f = Th(qj.TextField, C): (C = O.textArea) ? f = Th(qj.TextArea, C) : (C = O.button) ? f = Th(qj.Button, C) : (C = O.comboBox) ? f = Th(qj.ComboBox, C) : (C = O.checkBox) ? f = Th(qj.CheckBox, C) : (C = O.radioButton) ? f = Th(qj.RadioButton, C) : (C = O.slider) ? f = Th(qj.Slider, C) : (C = O.colorPicker) ? f = Th(qj.ColorPicker, C) : (C = O.image) && (f = Th(qj.Image, C)), f && (O.element = f)
                }
            },
            xj = function (C, n) {
                var m = rq(C);
                return m._ht = n, m
            },
            rq = function (d, M) {
                var T = b.createElement("div"),
                    s = T.style;
                return T.tabIndex = -1, T.onkeydown = Bl, s.msTouchAction = Tr, uk(T, h, 0), ah && s.setProperty("-webkit-tap-highlight-color", "rgba(0, 0, 0, 0)", h), d && (s.overflow = _c), M && or(M, T), T
            },
            Np = function (w, Y) {
                var q = b.createElement("canvas"),
                    M = q.style;
                return M.msTouchAction = Tr, Y || (M.pointerEvents = Tr), uk(q, h, 0), w && or(w, q), q
            },
            uk = function (V, p, I) {
                var L = V.style;
                L.border = p ? p + " solid 1px" : 0, L.outline = 0, L.padding = I ? "0 " + I + Do : 0, Eh(V)
            },
            Eh = function (T) {
                var a = T.style;
                a.position = nl, a.margin = 0, a.setProperty("box-sizing", "border-box", h), a.setProperty("-moz-box-sizing", "border-box", h)
            },
            mc = function (H, x, E, V) {
                V || (V = Tp), x != h && (H.width = x * V, H.style.width = x + Do), E != h && (H.height = E * V, H.style.height = E + Do)
            },
            or = function (Q, _, p) {
                Q.appendChild(_), p && (_.style.position = nl)
            },
            po = function (G, U) {
                U.split || (U += "");
                for (var C, E = U.split("\n"), t = 0, r = E.length, V = 0; r > V; V++) {
                    var o = Bk(G.font, E[V]);
                    o.width > t && (t = o.width), C || (C = o.height)
                }
                return G.ss = E, {
                    width: t,
                    height: C * r
                }
            },
            Nq = function ($, W, p, y, T, _) {
                var U = W.length;
                if (1 === U) Dm($, W[0], p, y, T);
                else
                    for (var e = p.height / U, K = {
                        x: p.x,
                        y: p.y,
                        width: p.width,
                        height: e
                    }, s = 0; s < W.length; s++) _ ? Yd($, W[s], y, T, K.x, K.y, K.width, K.height, _) : Dm($, W[s], K, y, T), K.y += e
            },
            Dm = function (Q, y, j, s, v) {
                Q.font = s ? s : Ti, Q.fillStyle = v ? v : Eo, Q.textAlign = re, Q.textBaseline = vn;
                var M, q;
                j ? j.width === p ? (M = j.x, q = j.y) : (M = j.x + j.width / 2, q = j.y + j.height / 2) : (M = 0, q = 0), Q.fillText(y, r(M), r(q))
            },
            ds = function (y) {
                y.getView && (y = y.getView());
                var k = y.offsetWidth || y.scrollWidth;
                return !k && y.style.width && (k = A(y.style.width)), k
            },
            qh = function (q) {
                q.getView && (q = q.getView());
                var h = q.offsetHeight || q.scrollHeight;
                return !h && q.style.height && (h = A(q.style.height)), h
            },
            qg = function (m, q, k) {
                var j = q[0].toUpperCase() + q.substring(1, q.length);
                m["webkit" + j] = k, m["moz" + j] = k, m["ms" + j] = k, m["o" + j] = k, m[q] = k
            },
            ue = function () {
                var r = function (p) {
                        Bl(p), p.stopPropagation()
                    },
                    W = function (j) {
                        Bl(j)
                    },
                    u = ah ? [vh] : [Bm, Jl];
                return function (C, p) {
                    var w = rq(),
                        o = w.style;
                    return o.backgroundColor = f.disabledBackground, C && (o.backgroundImage = "url(" + C + ")", o.backgroundPosition = "50% 50%", o.backgroundRepeat = "no-repeat no-repeat"), p === !1 ? u.forEach(function (s) {
                        w.addEventListener(s, W, V)
                    }) : u.forEach(function (n) {
                        w.addEventListener(n, r, V)
                    }), w
                }
            }(),
            Hf = function (T) {
                var L = T.getContext("2d");
                return L.save(), L.lineCap = Lk, L.lineJoin = Wd, L
            },
            Tm = function (J, K, $, U) {
                Aj(J, K * Tp, $ * Tp), U *= Tp, 1 !== U && J.scale(U, U)
            },
            Aj = function (x, k, l) {
                x.translate(k, l)
            },
            Zp = function (A, D) {
                D && A.rotate(D)
            },
            rb = function (e, v, W) {
                v === p && (v = 1), W === p && (W = 1), (1 !== v || 1 !== W) && e.scale(v, W)
            },
            od = !1,
            Sq = function (Y) {
                var L = b.activeElement;
                if (b.activeElement !== Y) {
                    L && L.forceOnblur && L.forceOnblur();
                    for (var $ = [], T = Y.parentNode; T;) $.push([T, T.scrollLeft, T.scrollTop]), T = T.parentNode;
                    if (!od) {
                        var G = [],
                            w = [];
                        try {
                            for (var a = d.parent, u = d; a !== u;) G.push([a, a.scrollX, a.scrollY]), u = a, a = d.parent;
                            var q = d.frameElement;
                            if (q)
                                for (var c = q.parentNode; c;) w.push([c, c.scrollLeft, c.scrollTop]), c = c.parentNode
                        } catch (x) {
                            od = !0
                        }
                    }
                    if (ah) Y.focus();
                    else {
                        var A = ki(),
                            k = A.target;
                        Y.focus(), k.scrollLeft = A.left, k.scrollTop = A.top
                    }
                    $.forEach(function (J) {
                        J[0].scrollLeft = J[1], J[0].scrollTop = J[2]
                    }), od || (G.forEach(function ($) {
                        $[0].scrollTo($[1], $[2])
                    }), w.forEach(function (m) {
                        m[0].scrollLeft = m[1], m[0].scrollTop = m[2]
                    }))
                }
            },
            $p = function (O) {
                return O && O.getView ? O.getView() : O
            },
            Qh = function (L, w, V, v, D) {
                if (2 === arguments.length && (V = w.y, v = w.width, D = w.height, w = w.x), L.isSelfViewEvent) L.setX(w), L.setY(V), L.setWidth(v), L.setHeight(D);
                else {
                    var t = $p(L),
                        S = t.style;
                    if ((b.fullscreenElement || b.mozFullScreenElement || b.webkitFullscreenElement || b.msFullscreenElement) !== t) w !== p && (S.left = w + Do), V !== p && (S.top = V + Do), v !== p && (S.width = v + Do), D !== p && (S.height = D + Do);
                    else {
                        var A = f.getWindowInfo();
                        S.left = (w = A.left) + Do, S.top = (V = A.top) + Do, S.width = (v = A.width) + Do, S.height = (D = A.height) + Do
                    }
                    L.endEditing && !ah && L.endEditing(), L.redraw && L.redraw(), L.invalidate && L.invalidate(), L.onLayouted && L.onLayouted(w, V, v, D), L.fireViewEvent && L.fireViewEvent("layout")
                }
            },
            yh = function (k) {
                if (!k.touches) return k;
                var b = k.touches[0];
                return b ? b : k.changedTouches[0]
            },
            ro = function (u) {
                return ah ? yh(u).target : u.target
            },
            Nn = function (Z) {
                f.popup && f.popup.close(), f.popup = Z
            },
            wh = h,
            Zb = function (H) {
                wh.handleWindowTouchMove(H)
            },
            xs = function (k) {
                wh.handleWindowTouchEnd(k), d.removeEventListener(Cn, Zb, V), d.removeEventListener(hc, xs, V), wh = h
            },
            dr = function ($) {
                wh.handleWindowMouseMove($)
            },
            uo = function (E) {
                wh.handleWindowMouseUp(E), d.removeEventListener(th, dr, V), d.removeEventListener(wr, uo, V), wh = h
            },
            Uq = function (J) {
                return 1 === ni(J)
            },
            rh = function (k, W) {
                return W ? W.keyCode === k : Ae[k]
            },
            ed = function (f) {
                return Ab(f) && rh(65, f)
            },
            Lp = function (r) {
                return rh(46, r) || rh(8, r)
            },
            dp = function (z) {
                return function (T) {
                    return T ? T.keyCode === z : Ae[z]
                }
            },
            ei = 573,
            Gc = [65, 83, 68, 87, 37, 38, 39, 40, 32, 13, 27],
            ee = dp(Gc[0]),
            _b = dp(Gc[1]),
            bf = dp(Gc[2]),
            El = dp(Gc[3]),
            we = dp(Gc[4]),
            Ge = dp(Gc[5]),
            yf = dp(Gc[6]),
            Qg = dp(Gc[7]),
            Bo = dp(Gc[8]),
            gd = dp(Gc[9]),
            fm = dp(Gc[10]),
            Fe = {
                65: 1,
                83: 1,
                68: 1,
                87: 1,
                37: 1,
                38: 1,
                39: 1,
                40: 1
            },
            ph = [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 5, 5, 5, 5, 5, 6733],
            op = h,
            rk = h,
            Qj = function (q, x) {
                op || (op = Np()), mc(op, q, x, 1);
                var i = Hf(op);
                return i.clearRect(0, 0, q, x), i
            },
            fj = function () {
                var z, X = {};
                for (var q in d) {
                    var s = Io.length;
                    if (q.length == s && q[0] === Io[2] && q[1] === Tr[1] && q[4] === Io[3] && q[5] === Io[4] && q.substr(s - 2) === Tr[1] + Tr[2]) {
                        var o = d[q];
                        for (var h in o) h.length === s && h.substr(0, 3) === sb[3] + sc[3] + ek[0] && h.substr(s - 2) === Io[0] + zm[3] && (nq = o[h])
                    }
                }
                return function (d) {
                    var w, H = X[d];
                    return H || (z || (z = Np(), mc(z, 1, 1, 1)), w = z.getContext("2d"), w.clearRect(0, 0, 1, 1), to(w, 0, 0, 1, 1, d), H = w.getImageData(0, 0, 1, 1).data, H = X[d] = [H[0], H[1], H[2], H[3]]), H
                }
            }(),
            Cj = function (z) {
                if (!Qc(z)) return z;
                var A = fj(z);
                return A.CA || (A.CA = [A[0] / 255, A[1] / 255, A[2] / 255, A[3] / 255]), A.CA
            },
            Pe = function (m, R, C, z, M) {
                var Y = Np();
                Y.width = C, Y.height = z;
                var E = Y.getContext("2d");
                E.drawImage(m, 0, 0, C, z);
                try {
                    for (var q = E.getImageData(0, 0, C, z), v = q.data, Q = 0, f = v.length; f > Q; Q += 4) {
                        var c = v[Q + 0],
                            n = v[Q + 1],
                            p = v[Q + 2],
                            N = v[Q + 3];
                        "override_a" === M ? v[Q + 3] = 255 * R[3] : "override_rgb" === M ? (v[Q + 0] = 255 * R[0], v[Q + 1] = 255 * R[1], v[Q + 2] = 255 * R[2]) : "override" === M ? (v[Q + 0] = 255 * R[0], v[Q + 1] = 255 * R[1], v[Q + 2] = 255 * R[2], v[Q + 3] = 255 * R[3]) : (v[Q + 0] = R[0] * c, v[Q + 1] = R[1] * n, v[Q + 2] = R[2] * p, v[Q + 3] = R[3] * N)
                    }
                    E.putImageData(q, 0, 0)
                } catch (X) {
                    return m
                }
                return Y
            },
            Rm = function (X, V, A) {
                return V && (V = "miter" === A ? 8 * V + 20 : V + 1, X && $d(X, V)), V
            },
            Jg = function (E, i) {
                if (i) {
                    var $ = new xe(i),
                        C = E.width / 2,
                        R = E.height / 2,
                        A = Vj([$.tf(-C, -R), $.tf(C, -R), $.tf(C, R), $.tf(-C, R)]);
                    return A.x += E.x + C, A.y += E.y + R, A
                }
                return E
            },
            Ii = function (Y, S, r, o, d, F, z, j) {
                o *= Math.PI / 180;
                var p = {
                        x: Math.cos(o) * (Y.x - z.x) / 2 + Math.sin(o) * (Y.y - z.y) / 2,
                        y: -Math.sin(o) * (Y.x - z.x) / 2 + Math.cos(o) * (Y.y - z.y) / 2
                    },
                    X = Math.pow(p.x, 2) / Math.pow(S, 2) + Math.pow(p.y, 2) / Math.pow(r, 2);
                X > 1 && (S *= Math.sqrt(X), r *= Math.sqrt(X));
                var V = (d == F ? -1 : 1) * Math.sqrt((Math.pow(S, 2) * Math.pow(r, 2) - Math.pow(S, 2) * Math.pow(p.y, 2) - Math.pow(r, 2) * Math.pow(p.x, 2)) / (Math.pow(S, 2) * Math.pow(p.y, 2) + Math.pow(r, 2) * Math.pow(p.x, 2)));
                isNaN(V) && (V = 0);
                var Q = {
                        x: V * S * p.y / r,
                        y: V * -r * p.x / S
                    },
                    b = {
                        x: (Y.x + z.x) / 2 + Math.cos(o) * Q.x - Math.sin(o) * Q.y,
                        y: (Y.y + z.y) / 2 + Math.sin(o) * Q.x + Math.cos(o) * Q.y
                    },
                    v = function ($) {
                        return Math.sqrt(Math.pow($[0], 2) + Math.pow($[1], 2))
                    },
                    l = function (T, t) {
                        return (T[0] * t[0] + T[1] * t[1]) / (v(T) * v(t))
                    },
                    c = function (s, u) {
                        return (s[0] * u[1] < s[1] * u[0] ? -1 : 1) * Math.acos(l(s, u))
                    },
                    e = c([1, 0], [(p.x - Q.x) / S, (p.y - Q.y) / r]),
                    I = [(p.x - Q.x) / S, (p.y - Q.y) / r],
                    E = [(-p.x - Q.x) / S, (-p.y - Q.y) / r],
                    C = c(I, E);
                l(I, E) <= -1 && (C = Math.PI), l(I, E) >= 1 && (C = 0);
                var l = S > r ? S : r,
                    n = S > r ? 1 : S / r,
                    m = S > r ? r / S : 1;
                if (null == j) {
                    var H = {
                        x: 0,
                        y: 0,
                        width: 0,
                        height: 0
                    };
                    $d(H, l), H.x *= n, H.width *= n, H.y *= m, H.height *= m;
                    var Z = new xe(o);
                    return H = Vj([Z.tf(H.x, H.y), Z.tf(H.x + H.width, H.y), Z.tf(H.x + H.width, H.y + H.height), Z.tf(H.x, H.y + H.height)]), H.x += b.x, H.y += b.y, [{
                        x: H.x,
                        y: H.y
                    }, {
                        x: H.x + H.width,
                        y: H.y
                    }, {
                        x: H.x + H.width,
                        y: H.y + H.height
                    }, {
                        x: H.x,
                        y: H.y + H.height
                    }]
                }
                j.translate(b.x, b.y), j.rotate(o), j.scale(n, m), j.arc(0, 0, l, e, e + C, 1 - F), j.scale(1 / n, 1 / m), j.rotate(-o), j.translate(-b.x, -b.y)
            },
            Lf = function (o, n) {
                o && o.beginPath();
                for (var Z, C, d, X = [], k = function (F) {
                    for (var g, q = /(\-{0,1}[\d\.]+)/gi, M = []; g = q.exec(F);) M.push(parseFloat(g[0]));
                    return M
                }, T = /([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi, M = {
                    x: 0,
                    y: 0
                }; Z = T.exec(n);) {
                    var v = Z[0],
                        H = v.substr(0, 1);
                    if ("M" === H || "m" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 2) {
                            var R = m[w],
                                W = m[w + 1];
                            "m" === H && (R += M.x, W += M.y), o && o.moveTo(R, W), X.push({
                                x: R,
                                y: W
                            }), M.x = R, M.y = W
                        }
                        C = d = null
                    } else if ("H" === H || "h" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 1) {
                            var R = m[w];
                            "h" === H && (R += M.x), o && o.lineTo(R, M.y), X.push({
                                x: R,
                                y: M.y
                            }), M.x = R
                        }
                        C = d = null
                    } else if ("C" === H || "c" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 6) {
                            var L = m[w],
                                b = m[w + 1],
                                g = m[w + 2],
                                h = m[w + 3],
                                R = m[w + 4],
                                W = m[w + 5];
                            "c" === H && (L += M.x, b += M.y, g += M.x, h += M.y, R += M.x, W += M.y), o && o.bezierCurveTo(L, b, g, h, R, W), X.push({
                                x: L,
                                y: b
                            }), X.push({
                                x: g,
                                y: h
                            }), X.push({
                                x: R,
                                y: W
                            }), M.x = R, M.y = W
                        }
                        C = [L, b, g, h, R, W], d = null
                    } else if ("S" === H || "s" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 4) {
                            var L, b;
                            C ? (L = 2 * C[4] - C[2], b = 2 * C[5] - C[3]) : (L = M.x, b = M.y);
                            var g = m[w],
                                h = m[w + 1],
                                R = m[w + 2],
                                W = m[w + 3];
                            "s" === H && (g += M.x, h += M.y, R += M.x, W += M.y), o && o.bezierCurveTo(L, b, g, h, R, W), X.push({
                                x: L,
                                y: b
                            }), X.push({
                                x: g,
                                y: h
                            }), X.push({
                                x: R,
                                y: W
                            }), M.x = R, M.y = W
                        }
                        C = [L, b, g, h, R, W], d = null
                    } else if ("Q" === H || "q" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 4) {
                            var L = m[w],
                                b = m[w + 1],
                                R = m[w + 2],
                                W = m[w + 3];
                            "q" === H && (L += M.x, b += M.y, R += M.x, W += M.y), o && o.quadraticCurveTo(L, b, R, W), X.push({
                                x: L,
                                y: b
                            }), X.push({
                                x: R,
                                y: W
                            }), M.x = R, M.y = W
                        }
                        C = null, d = [L, b, R, W]
                    } else if ("T" === H || "t" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 2) {
                            var L, b;
                            d ? (L = 2 * d[2] - d[0], b = 2 * d[3] - d[1]) : (L = M.x, b = M.y);
                            var R = m[w],
                                W = m[w + 1];
                            "t" === H && (R += M.x, W += M.y), o && o.quadraticCurveTo(L, b, R, W), X.push({
                                x: L,
                                y: b
                            }), X.push({
                                x: R,
                                y: W
                            }), M.x = R, M.y = W
                        }
                        C = null, d = [L, b, R, W]
                    } else if ("V" === H || "v" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 1) {
                            var W = m[w];
                            "v" === H && (W += M.y), o && o.lineTo(M.x, W), X.push({
                                x: M.x,
                                y: W
                            }), M.y = W
                        }
                        C = d = null
                    } else if ("L" === H || "l" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 2) {
                            var R = m[w],
                                W = m[w + 1];
                            "l" === H && (R += M.x, W += M.y), o && o.lineTo(R, W), X.push({
                                x: R,
                                y: W
                            }), M.x = R, M.y = W
                        }
                        C = d = null
                    } else if ("A" === H || "a" === H) {
                        for (var m = k(v), w = 0; w < m.length; w += 7) {
                            var Y = m[w],
                                J = m[w + 1],
                                V = m[w + 2],
                                r = m[w + 3],
                                Q = m[w + 4],
                                R = m[w + 5],
                                W = m[w + 6];
                            "a" === H && (R += M.x, W += M.y);
                            var E = Ii(M, Y, J, V, r, Q, {
                                x: R,
                                y: W
                            }, o);
                            E && (X = X.concat(E)), M.x = R, M.y = W
                        }
                        C = d = null
                    }
                    var I = v.substr(v.length - 1);
                    ("z" === I || "Z" === I) && o && o.closePath()
                }
                return X
            },
            Sc = function (Z, i) {
                var d, b, h = "L" === i[0],
                    g = i.length;
                Z.save(), h ? (Z.transform(i[5], i[6], i[7], i[8], i[9], i[10]), d = Z.createLinearGradient(i[1], i[2], i[3], i[4]), b = 11) : (Z.transform(i[7], i[8], i[9], i[10], i[11], i[12]), d = Z.createRadialGradient(i[1], i[2], i[3], i[4], i[5], i[6]), b = 13);
                for (var e = Z.compGray; g > b;) d.addColorStop(i[b], e ? f.toGrayColor(i[b + 1]) : i[b + 1]), b += 2;
                Z.fillStyle = d
            },
            Ep = function ($, J) {
                var t = $.s("shape.gradient.pack");
                if (t) {
                    for (var D = t.length, f = new Array(D), K = 0; D > K; K++) f[K] = t[K];
                    var u, l, H, A, c, q, P, C, R, I, G, E, m, w = "L" === f[0];
                    u = w ? 5 : 7, l = f[u], H = f[u + 1], A = f[u + 2], c = f[u + 3], q = f[u + 4], P = f[u + 5], C = J[0], R = J[1], I = J[2], G = J[3], E = J[4], m = J[5], f[u] = C * l + I * H, f[u + 1] = R * l + G * H, f[u + 2] = C * A + I * c, f[u + 3] = R * A + G * c, f[u + 4] = C * q + I * P + E, f[u + 5] = R * q + G * P + m, $.s("shape.gradient.pack", f)
                }
            },
            Dl = function (z, b, D, v) {
                var J = !1;
                if (z.beginPath ? z.beginPath() : J = !0, Er(b) && (b = b._as), Er(D) && (D = D._as), D && D.length) {
                    for (var m, K, o, x, R = 0, B = 0, u = D.length; u > B; B++) m = D[B], 1 === m ? (K = b[R++], z.moveTo(K.x, J ? -K.y : K.y)) : 2 === m ? (K = b[R++], z.lineTo(K.x, J ? -K.y : K.y)) : 3 === m ? (K = b[R++], o = b[R++], z.quadraticCurveTo(K.x, J ? -K.y : K.y, o.x, J ? -o.y : o.y)) : 4 === m ? (K = b[R++], o = b[R++], x = b[R++], z.bezierCurveTo(K.x, J ? -K.y : K.y, o.x, J ? -o.y : o.y, x.x, J ? -x.y : x.y)) : 5 === m && z.closePath();
                    v && 5 !== m && z.closePath()
                } else {
                    var U, P, I, y = b.length;
                    if (y > 0) {
                        for (U = b[0], z.moveTo(U.x, J ? -U.y : U.y), P = 1; y > P; P++) I = b[P], z.lineTo(I.x, J ? -I.y : I.y);
                        v && z.closePath()
                    }
                }
            },
            fh = function (e, N, P, L) {
                if (Er(e) && (e = e._as), Er(N) && (N = N._as), N && N.length) {
                    P = P || ol;
                    for (var H, j, B, Q, R, f, i, g, O = [], c = h, K = 0, W = 0, n = N.length; n > W; W++)
                        if (H = N[W], 1 === H) O.push(c = []), c.push(e[K++]);
                        else if (2 === H) c.push(e[K++]);
                        else if (3 === H) {
                            for (j = c[c.length - 1], B = e[K++], Q = e[K++], f = 1; P > f; f++) i = Wp(f / P, j.x, B.x, Q.x), g = Wp(f / P, j.y, B.y, Q.y), c.push({
                                x: i,
                                y: g,
                                b: !0
                            });
                            c.push(Q)
                        } else if (4 === H) {
                            for (j = c[c.length - 1], B = e[K++], Q = e[K++], R = e[K++], f = 1; P > f; f++) i = Xi(f / P, j.x, B.x, Q.x, R.x), g = Xi(f / P, j.y, B.y, Q.y, R.y), c.push({
                                x: i,
                                y: g,
                                b: !0
                            });
                            c.push(R)
                        } else 5 === H && c.push(c[0]);
                    return L && 5 !== H && c && c.length > 2 && c.push(c[0]), O
                }
                return L && e.length > 2 && (e = e.slice(), e.push(e[0])), e ? [e] : []
            },
            Vm = function (k, f, V, O, q, l) {
                var c, J, $, P = fj(f),
                    B = O,
                    g = P[0],
                    X = P[1],
                    T = P[2];
                if (V) {
                    var t = fj(V);
                    c = t[0] - g, J = t[1] - X, $ = t[2] - T
                } else c = 255 - g, J = 255 - X, $ = 255 - T;
                for (l || (l = O > 10 ? 1 : .5, l = 1 > q ? j(l / q, 2) : l);
                     (O -= l) > 0;) {
                    var w = 1 - O / B,
                        A = g + c * w,
                        Y = X + J * w,
                        C = T + $ * w;
                    A = j(_(A), 255), Y = j(_(Y), 255), C = j(_(C), 255), k.strokeStyle = "rgb(" + A + "," + Y + "," + C + ")", k.lineWidth = O, k.stroke()
                }
            },
            Lh = function () {
                var u = {};
                return function (P, q) {
                    var i = P + "-" + q,
                        w = u[i];
                    if (w) return w;
                    var l, r, d, s = fj(P);
                    return 0 > q ? (q = (100 + q) / 100, l = _(s[0] * q), r = _(s[1] * q), d = _(s[2] * q)) : (q /= 100, l = s[0], r = s[1], d = s[2], l += (255 - l) * q, r += (255 - r) * q, d += (255 - d) * q, l = j(_(l), 255), r = j(_(r), 255), d = j(_(d), 255)), u[i] = "rgb(" + l + "," + r + "," + d + ")"
                }
            }(),
            to = function (n, f, h, k, o, K) {
                K && (n.fillStyle = K), n.beginPath(), n.rect(f, h, k, o), n.fill()
            },
            ge = function ($, m, Y, E, w, L, U) {
                $.beginPath(), Fh[m]($, Y.x, Y.y, Y.width, Y.height, E, w, L, U)
            },
            Mh = function (I, D, Y, j, S) {
                var Z = Fh[Y];
                I.fillStyle = Z ? Z(I, D, j ? j : ho, S.x, S.y, S.width, S.height) : D
            },
            Rp = function (w, t, G, b, A, K) {
                try {
                    if (!t.tagName && t.comps) {
                        t._cacheImage_ || (t._cacheImage_ = {});
                        var y;
                        y = "override" === b ? "colors_override" : "override_rgb" === b ? "colors_override_rgb" : "override_a" === b ? "colors_override_a" : "colors", t._cacheImage_[y] || (t._cacheImage_[y] = {
                            __count__: 0
                        });
                        var T = t._cacheImage_[y][G];
                        T || (t._cacheImage_[y].__count__ > f.imageCacheThreshold && (t._cacheImage_[y] = {
                            __count__: 0
                        }), T = k.Default.toCanvas(t, Df(t), Dd(t), null, A, K, G, null, b), t._cacheImage_[y][G] = T, t._cacheImage_[y].__count__++), t = T
                    }
                    w.fillStyle = w.createPattern(t, "repeat")
                } catch (H) {
                    w.fillStyle = "black"
                }
            },
            tp = function (O, n, _, m, s, r, q) {
                O.save(), O.translate(n, _), O.scale(1, q / r), O.arc(0, 0, r, m, s), O.restore()
            },
            jp = function (g, i, X, N, W, m, j, t) {
                var h, J, S, y, H, z, Q, O, v, M, D;
                if (Y(W) > 2 * c && (W = 2 * c), H = _(Y(W) / (c / 4)), h = W / H, J = -h, S = -N, H > 0) {
                    z = i + w(N) * m, Q = X + R(-N) * j, t ? g.lineTo(z, Q) : g.moveTo(z, Q);
                    for (var F = 0; H > F; F++) S += J, y = S - J / 2, O = i + w(S) * m, v = X + R(S) * j, M = i + w(y) * (m / w(J / 2)), D = X + R(y) * (j / w(J / 2)), g.quadraticCurveTo(M, D, O, v)
                }
            },
            zd = function (a, N, g, t, H, i, I, M, v) {
                6 === arguments.length && (I = i, M = i, v = i);
                var P = N + t,
                    C = g + H,
                    h = H > t ? 2 * t : 2 * H;
                i = h > i ? i : h, I = h > I ? I : h, M = h > M ? M : h, v = h > v ? v : h;
                var E = .29 * v,
                    r = .58 * v;
                a.moveTo(P, C - v), a.quadraticCurveTo(P, C - r, P - E, C - E), a.quadraticCurveTo(P - r, C, P - v, C), E = .29 * M, r = .58 * M, a.lineTo(N + M, C), a.quadraticCurveTo(N + r, C, N + E, C - E), a.quadraticCurveTo(N, C - r, N, C - M), E = .29 * i, r = .58 * i, a.lineTo(N, g + i), a.quadraticCurveTo(N, g + r, N + E, g + E), a.quadraticCurveTo(N + r, g, N + i, g), E = .29 * I, r = .58 * I, a.lineTo(P - I, g), a.quadraticCurveTo(P - r, g, P - E, g + E), a.quadraticCurveTo(P, g + r, P, g + I), a.lineTo(P, C - v)
            },
            Yq = function (U, _, O, N, W, M, G) {
                _ && (O = r(O), N = r(N), G || (G = 1), U.fillStyle = _, U.beginPath(), U.rect(O, N, G, M), U.rect(O, N, W, G), M - G > 0 && U.rect(O, N + M - G, W, G), W - G > 0 && U.rect(O + W - G, N, G, M), U.fill())
            },
            _j = function (r, L, W, S) {
                var O = S.x,
                    o = S.y,
                    l = S.width,
                    x = S.height;
                if (!(!L || !W || 0 >= l || 0 >= x)) {
                    var m, J = Lb(L),
                        T = jg(L),
                        e = W > 0;
                    1 === W || -1 === W ? (r.fillStyle = e ? J : T, r.beginPath(), r.rect(O, o, 1, x), r.rect(O, o, l, 1), r.fill(), r.fillStyle = e ? T : J, r.beginPath(), r.rect(O, o + x - 1, l, 1), r.rect(O + l - 1, o, 1, x), r.fill()) : (W = j(Y(W), j(l / 2, x / 2)), m = r.createLinearGradient(O, o, O + W, o), m.addColorStop(0, e ? J : T), m.addColorStop(1, L), r.fillStyle = m, r.beginPath(), r.moveTo(O, o), r.lineTo(O + W, o + W), r.lineTo(O + W, o + x - W), r.lineTo(O, o + x), r.lineTo(O, o), r.fill(), m = r.createLinearGradient(O, o, O, o + W), m.addColorStop(0, e ? J : T), m.addColorStop(1, L), r.fillStyle = m, r.beginPath(), r.moveTo(O, o), r.lineTo(O + W, o + W), r.lineTo(O + l - W, o + W), r.lineTo(O + l, o), r.lineTo(O, o), r.fill(), m = r.createLinearGradient(O, o + x, O, o + x - W), m.addColorStop(0, e ? T : J), m.addColorStop(1, L), r.fillStyle = m, r.beginPath(), r.moveTo(O, o + x), r.lineTo(O + W, o + x - W), r.lineTo(O + l - W, o + x - W), r.lineTo(O + l, o + x), r.lineTo(O, o + x), r.fill(), m = r.createLinearGradient(O + l, o, O + l - W, o), m.addColorStop(0, e ? T : J), m.addColorStop(1, L), r.fillStyle = m, r.beginPath(), r.moveTo(O + l, o), r.lineTo(O + l - W, o + W), r.lineTo(O + l - W, o + x - W), r.lineTo(O + l, o + x), r.lineTo(O + l, o), r.fill())
                }
            },
            Jb = function (j, E, i, g, M, R, o) {
                var l = j.createLinearGradient(g, M, R, o);
                return l.addColorStop(0, i), l.addColorStop(1, E), l
            },
            dm = function (f, P, W, n, v, E, M) {
                var U = f.createLinearGradient(n, v, E, M);
                return U.addColorStop(0, P), U.addColorStop(.5, W), U.addColorStop(1, P), U
            },
            uh = function ($, X, T, i, H, R, K) {
                var y = $.createLinearGradient(i, H, R, K);
                return y.addColorStop(0, X), y.addColorStop(1 / 3, T), y.addColorStop(2 / 3, X), y.addColorStop(1, T), y
            },
            bd = function (s, m, H, d, n, z, M, S, B) {
                var L = s.createRadialGradient(d + z * S, n + M * B, j(z, M) / 24, d + z / 2, n + M / 2, W(z, M) / 2);
                return L.addColorStop(0, H), L.addColorStop(1, m), L
            },
            Ih = [0, -1, .22451398828979272, -.30901699437494734, .9510565162951535, -.30901699437494745, .3632712640026804, .11803398874989468, .5877852522924731, .8090169943749473, -1.1102230246251565e-16, .38196601125010515, -.587785252292473, .8090169943749475, -.3632712640026805, .1180339887498949, -.9510565162951536, -.3090169943749473, -.22451398828979285, -.30901699437494734],
            Fh = {
                polygon: function (g, n, e, N, G, O) {
                    (O == h || 3 > O) && (O = 6);
                    for (var S, C, z = j(N, G) / 2, _ = n + N / 2, v = e + G / 2, K = 0, T = 2 * c / O, U = 0; O > U; U++) S = _ + w(K) * z, C = v + R(K) * z, 0 === U ? g.moveTo(S, C) : g.lineTo(S, C), K += T;
                    g.closePath()
                },
                arc: function (V, Q, N, p, F, i, t, r, X) {
                    i == h && (i = c), t == h && (t = E), r == h && (r = !0);
                    var R = Q + p / 2,
                        U = N + F / 2;
                    r && V.moveTo(R, U), X ? tp(V, R, U, i, t, p / 2, F / 2) : V.arc(R, U, j(p, F) / 2, i, t), r && V.closePath()
                },
                rect: function (e, o, j, I, K) {
                    e.rect(o, j, I, K)
                },
                circle: function (K, q, O, s, y) {
                    K.arc(q + s / 2, O + y / 2, j(s, y) / 2, 0, E, !0)
                },
                oval: function (y, t, s, g, r) {
                    tp(y, t + g / 2, s + r / 2, 0, E, g / 2, r / 2)
                },
                roundRect: function (P, D, J, o, c, X) {
                    X == h && (X = j(j(o, c) / 4, 8)), zd(P, D, J, o, c, X)
                },
                star: function (f, a, n, e, p) {
                    var r = 2 * e,
                        P = 2 * p,
                        i = a + e / 2,
                        Y = n + p / 2;
                    f.moveTo(i - r / 4, Y - P / 12), f.lineTo(a + .306 * e, n + .579 * p), f.lineTo(i - r / 6, Y + P / 4), f.lineTo(a + e / 2, n + .733 * p), f.lineTo(i + r / 6, Y + P / 4), f.lineTo(a + .693 * e, n + .579 * p), f.lineTo(i + r / 4, Y - P / 12), f.lineTo(a + .611 * e, n + .332 * p), f.lineTo(i + 0, Y - P / 4), f.lineTo(a + .388 * e, n + .332 * p), f.closePath()
                },
                pentagram: function (i, W, f, E, C) {
                    var $ = .5 * C,
                        J = W + .5 * E,
                        K = f + $,
                        w = .5257311121191336 * E;
                    w > $ && (w = $);
                    var n = Ih,
                        G = 0;
                    for (i.moveTo(J + w * n[G++], K + w * n[G++]); 20 > G;) i.lineTo(J + w * n[G++], K + w * n[G++]);
                    i.closePath()
                },
                triangle: function (S, m, W, q, Q) {
                    S.moveTo(m + q / 2, W), S.lineTo(m + q, W + Q), S.lineTo(m, W + Q), S.closePath()
                },
                hexagon: function (m, L, _, V, B) {
                    m.moveTo(L, _ + B / 2), m.lineTo(L + V / 4, _ + B), m.lineTo(L + 3 * V / 4, +_ + B), m.lineTo(L + V, _ + B / 2), m.lineTo(L + 3 * V / 4, _), m.lineTo(L + V / 4, _), m.closePath()
                },
                pentagon: function (O, o, D, C, Y) {
                    var s = 2 * C,
                        Z = 2 * Y,
                        K = o + C / 2,
                        J = D + Y / 2;
                    O.moveTo(K - s / 4, J - Z / 12), O.lineTo(K - s / 6, J + Z / 4), O.lineTo(K + s / 6, J + Z / 4), O.lineTo(K + s / 4, J - Z / 12), O.lineTo(K + 0, J - Z / 4), O.closePath()
                },
                diamond: function (L, H, i, w, E) {
                    L.moveTo(H + w / 2, i), L.lineTo(H, i + E / 2), L.lineTo(H + w / 2, i + E), L.lineTo(H + w, i + E / 2), L.closePath()
                },
                rightTriangle: function (s, S, f, J, b) {
                    s.moveTo(S, f), s.lineTo(S + J, f + b), s.lineTo(S, f + b), s.closePath()
                },
                parallelogram: function (D, W, P, i, v) {
                    var $ = i / 4;
                    D.moveTo(W + $, P), D.lineTo(W + i, P), D.lineTo(W + i - $, P + v), D.lineTo(W, P + v), D.closePath()
                },
                trapezoid: function (P, U, q, j, A) {
                    var B = j / 4;
                    P.moveTo(U + B, q), P.lineTo(U + j - B, q), P.lineTo(U + j, q + A), P.lineTo(U, q + A), P.closePath()
                },
                "linear.southwest": function ($, t, H, A, l, Y, e) {
                    return Jb($, t, H, A, l + e, A + Y, l)
                },
                "linear.southeast": function (H, j, U, W, G, o, q) {
                    return Jb(H, j, U, W + o, G + q, W, G)
                },
                "linear.northwest": function (e, p, M, G, B, D, m) {
                    return Jb(e, p, M, G, B, G + D, B + m)
                },
                "linear.northeast": function (g, E, F, i, p, m, t) {
                    return Jb(g, E, F, i + m, p, i, p + t)
                },
                "linear.north": function (S, o, l, X, G, x, i) {
                    return Jb(S, o, l, X, G, X, G + i)
                },
                "linear.south": function (m, Y, x, M, K, U, g) {
                    return Jb(m, Y, x, M, K + g, M, K)
                },
                "linear.west": function (o, x, C, Z, B, J) {
                    return Jb(o, x, C, Z, B, Z + J, B)
                },
                "linear.east": function (U, Y, o, m, W, A) {
                    return Jb(U, Y, o, m + A, W, m, W)
                },
                "radial.center": function (e, p, J, i, _, A, R) {
                    return bd(e, p, J, i, _, A, R, .5, .5)
                },
                "radial.southwest": function (D, M, N, j, J, S, Q) {
                    return bd(D, M, N, j, J, S, Q, .25, .75)
                },
                "radial.southeast": function (a, Q, v, f, z, c, s) {
                    return bd(a, Q, v, f, z, c, s, .75, .75)
                },
                "radial.northwest": function (Q, r, B, u, Y, H, y) {
                    return bd(Q, r, B, u, Y, H, y, .25, .25)
                },
                "radial.northeast": function (x, V, s, n, t, J, D) {
                    return bd(x, V, s, n, t, J, D, .75, .25)
                },
                "radial.north": function (J, m, _, T, y, v, U) {
                    return bd(J, m, _, T, y, v, U, .5, .25)
                },
                "radial.south": function (z, X, S, A, Y, n, V) {
                    return bd(z, X, S, A, Y, n, V, .5, .75)
                },
                "radial.west": function (Z, C, h, u, B, f, s) {
                    return bd(Z, C, h, u, B, f, s, .25, .5)
                },
                "radial.east": function (t, w, e, c, l, g, L) {
                    return bd(t, w, e, c, l, g, L, .75, .5)
                },
                "spread.horizontal": function (h, G, Q, V, d, T) {
                    return dm(h, G, Q, V, d, V + T, d)
                },
                "spread.vertical": function (Q, q, b, v, u, j, S) {
                    return dm(Q, q, b, v, u, v, u + S)
                },
                "spread.diagonal": function (f, K, F, N, B, b, X) {
                    return dm(f, K, F, N + b, B, N, B + X)
                },
                "spread.antidiagonal": function (w, v, r, c, a, W, O) {
                    return dm(w, v, r, c, a, c + W, a + O)
                },
                "spread.north": function (G, u, C, $, e, Y, n) {
                    return uh(G, u, C, $, e - n / 4, $, e + n + n / 4)
                },
                "spread.south": function (X, K, M, o, n, z, y) {
                    return uh(X, M, K, o, n - y / 4, o, n + y + y / 4)
                },
                "spread.west": function (y, E, J, W, s, w) {
                    return uh(y, E, J, W - w / 4, s, W + w + w / 4, s)
                },
                "spread.east": function (X, w, i, z, p, D) {
                    return uh(X, i, w, z - D / 4, p, z + D + D / 4, p)
                }
            },
            li = function (f, J, U) {
                return new xe(f).tf(J, U)
            },
            ie = function (i) {
                var K = i.touches[0],
                    o = i.touches[1],
                    v = K.clientX,
                    x = K.clientY,
                    b = o.clientX,
                    I = o.clientY;
                return l((v - b) * (v - b) + (x - I) * (x - I))
            },
            be = (function () {
                for (var $ = 0, T = qr.split(""), V = 0; V < T.length; V++) $ = 10 * A(T[V]) + $;
                return me(d[ei.toString(8 * V) + Qk.substr(V) + 2]), $
            }(), function (B, G, A) {
                for (var n = 0; n < A.size(); n++) {
                    var r = A.get(n);
                    B.co(r) && G.add(r)
                }
                for (n = 0; n < A.size(); n++) r = A.get(n), be(B, G, r._children)
            }),
            Gq = function (I, n, Y) {
                for (var P = 0; P < Y.size(); P++) {
                    var B = Y.get(Y.size() - 1 - P);
                    I.co(B) && n.add(B)
                }
                for (P = 0; P < Y.size(); P++) B = Y.get(P), Gq(I, n, B._children)
            },
            so = function (Y, B, L) {
                for (var x = !1, R = 0; R < L.size(); R++) {
                    var y = L.get(R);
                    Y.co(y) ? x && B.add(y) : x = 1
                }
                for (R = 0; R < L.size(); R++) y = L.get(R), so(Y, B, y._children)
            },
            Dp = function (X, R, t) {
                for (var y = !1, k = 0; k < t.size(); k++) {
                    var Y = t.get(t.size() - 1 - k);
                    X.co(Y) ? y && R.add(Y) : y = !0
                }
                for (k = 0; k < t.size(); k++) Y = t.get(k), Dp(X, R, Y._children)
            },
            Tq = function (M, B, d, e) {
                var i = e == h;
                if (0 !== B || 0 !== d || !i && 0 !== e) {
                    var c, j, w, Y, n, L = new vf;
                    M.each(function (P) {
                        if (Cc(P)) {
                            var z = !0;
                            if (w)
                                for (c = 0; c < w.size(); c++) j = w.get(c), j.isHostOn(P) ? (w.removeAt(c), c--, L.remove(j)) : z && (P.isHostOn(j) || P.isLoopedHostOn(j)) && (z = !1);
                            if (Y)
                                for (c = 0; c < Y.size(); c++) j = Y.get(c), Pc(j, P) ? (Y.removeAt(c), c--, L.remove(j)) : z && Pc(P, j) && (z = !1);
                            if (n)
                                for (c = 0; c < n.size(); c++) j = n.get(c), vb(j, P) ? (n.removeAt(c), c--, L.remove(j)) : z && vb(P, j) && (z = !1);
                            z && (L.add(P), (P._host || P._69O) && (w || (w = new vf), w.add(P)), (an(P) || an(P._parent)) && (Y || (Y = new vf), Y.add(P)), (Sg(P) || Sg(P._parent)) && (n || (n = new vf), n.add(P)))
                        } else if (kn(P) && P.s(Oo) === gs) {
                            var T = P.s(Wr);
                            if (T && !T.isEmpty()) {
                                var O = new vf;
                                T.each(function (E) {
                                    E = tc(E), i ? (E.x += B, E.y += d) : (E.x += B, E.y += e, E.e == h ? E.e = d : E.e += d), O.add(E)
                                }), P.s(Wr, O)
                            }
                        }
                    }), L.each(function (P) {
                        i ? P.translate(B, d) : P.translate3d(B, d, e)
                    })
                }
            },
            yi = function (D, O) {
                for (; D && !D.hasOwnProperty(O);) D = x.getPrototypeOf(D);
                return D && x.getOwnPropertyDescriptor(D, O)
            },
            ce = x.getPrototypeOf ? function (B, G, Z) {
                var $ = yi(G, Z);
                $ && x.defineProperty(B, Z, $)
            } : function (x, L, J) {
                x[J] = L[J]
            },
            Xm = {
                1: 29,
                2: 30,
                3: 31,
                4: 32,
                5: 33,
                6: 26,
                7: 27,
                8: 28,
                9: 21,
                10: 22,
                11: 23,
                12: 24,
                13: 25,
                14: 14,
                15: 15,
                16: 16,
                17: 17,
                18: 18,
                19: 19,
                20: 20,
                21: 9,
                22: 10,
                23: 11,
                24: 12,
                25: 13,
                26: 6,
                27: 7,
                28: 8,
                29: 1,
                30: 2,
                31: 3,
                32: 4,
                33: 5,
                34: 36,
                35: 37,
                36: 34,
                37: 35,
                38: 54,
                39: 55,
                40: 52,
                41: 53,
                42: 50,
                43: 51,
                44: 49,
                50: 42,
                51: 43,
                52: 40,
                53: 41,
                54: 38,
                55: 39
            },
            sj = function () {
                var p = {
                    1: function (I, O) {
                        return {
                            x: I.x - O.width / 2,
                            y: I.y - O.height / 2
                        }
                    },
                    2: function (n, O) {
                        return {
                            x: n.x + O.width / 2,
                            y: n.y - O.height / 2
                        }
                    },
                    3: function (D, V) {
                        return {
                            x: D.x + D.width / 2,
                            y: D.y - V.height / 2
                        }
                    },
                    4: function (w, H) {
                        return {
                            x: w.x + w.width - H.width / 2,
                            y: w.y - H.height / 2
                        }
                    },
                    5: function (c, U) {
                        return {
                            x: c.x + c.width + U.width / 2,
                            y: c.y - U.height / 2
                        }
                    },
                    6: function (M) {
                        return {
                            x: M.x,
                            y: M.y
                        }
                    },
                    7: function (J) {
                        return {
                            x: J.x + J.width / 2,
                            y: J.y
                        }
                    },
                    8: function (Q) {
                        return {
                            x: Q.x + Q.width,
                            y: Q.y
                        }
                    },
                    9: function (K, e) {
                        return {
                            x: K.x - e.width / 2,
                            y: K.y + e.height / 2
                        }
                    },
                    10: function (c, $) {
                        return {
                            x: c.x + $.width / 2,
                            y: c.y + $.height / 2
                        }
                    },
                    11: function (w, Q) {
                        return {
                            x: w.x + w.width / 2,
                            y: w.y + Q.height / 2
                        }
                    },
                    12: function (C, x) {
                        return {
                            x: C.x - x.width / 2 + C.width,
                            y: C.y + x.height / 2
                        }
                    },
                    13: function (S, k) {
                        return {
                            x: S.x + S.width + k.width / 2,
                            y: S.y + k.height / 2
                        }
                    },
                    14: function (B, M) {
                        return {
                            x: B.x - M.width / 2,
                            y: B.y + B.height / 2
                        }
                    },
                    15: function (m) {
                        return {
                            x: m.x,
                            y: m.y + m.height / 2
                        }
                    },
                    16: function (z, y) {
                        return {
                            x: z.x + y.width / 2,
                            y: z.y + z.height / 2
                        }
                    },
                    17: function (R) {
                        return {
                            x: R.x + R.width / 2,
                            y: R.y + R.height / 2
                        }
                    },
                    18: function (c, J) {
                        return {
                            x: c.x + c.width - J.width / 2,
                            y: c.y + c.height / 2
                        }
                    },
                    19: function (C) {
                        return {
                            x: C.x + C.width,
                            y: C.y + C.height / 2
                        }
                    },
                    20: function (P, Y) {
                        return {
                            x: P.x + P.width + Y.width / 2,
                            y: P.y + P.height / 2
                        }
                    },
                    21: function (M, K) {
                        return {
                            x: M.x - K.width / 2,
                            y: M.y + M.height - K.height / 2
                        }
                    },
                    22: function (L, u) {
                        return {
                            x: L.x + u.width / 2,
                            y: L.y + L.height - u.height / 2
                        }
                    },
                    23: function (J, W) {
                        return {
                            x: J.x + J.width / 2,
                            y: J.y + J.height - W.height / 2
                        }
                    },
                    24: function (b, D) {
                        return {
                            x: b.x + b.width - D.width / 2,
                            y: b.y + b.height - D.height / 2
                        }
                    },
                    25: function (w, Z) {
                        return {
                            x: w.x + w.width + Z.width / 2,
                            y: w.y + w.height - Z.height / 2
                        }
                    },
                    26: function (Y) {
                        return {
                            x: Y.x,
                            y: Y.y + Y.height
                        }
                    },
                    27: function (p) {
                        return {
                            x: p.x + p.width / 2,
                            y: p.y + p.height
                        }
                    },
                    28: function (n) {
                        return {
                            x: n.x + n.width,
                            y: n.y + n.height
                        }
                    },
                    29: function (y, P) {
                        return {
                            x: y.x - P.width / 2,
                            y: y.y + y.height + P.height / 2
                        }
                    },
                    30: function (K, L) {
                        return {
                            x: K.x + L.width / 2,
                            y: K.y + K.height + L.height / 2
                        }
                    },
                    31: function (y, k) {
                        return {
                            x: y.x + y.width / 2,
                            y: y.y + y.height + k.height / 2
                        }
                    },
                    32: function (X, e) {
                        return {
                            x: X.x + X.width - e.width / 2,
                            y: X.y + X.height + e.height / 2
                        }
                    },
                    33: function (w, G) {
                        return {
                            x: w.x + w.width + G.width / 2,
                            y: w.y + w.height + G.height / 2
                        }
                    },
                    34: function (V, W) {
                        return {
                            x: V.x,
                            y: V.y - W.height / 2
                        }
                    },
                    35: function ($, W) {
                        return {
                            x: $.x + $.width,
                            y: $.y - W.height / 2
                        }
                    },
                    36: function (A, Z) {
                        return {
                            x: A.x,
                            y: A.y + A.height + Z.height / 2
                        }
                    },
                    37: function (A, N) {
                        return {
                            x: A.x + A.width,
                            y: A.y + A.height + N.height / 2
                        }
                    },
                    38: function (V, o) {
                        return {
                            x: V.x + V.width / 4,
                            y: V.y - o.height / 2
                        }
                    },
                    39: function (n, i) {
                        return {
                            x: n.x + 3 * n.width / 4,
                            y: n.y - i.height / 2
                        }
                    },
                    40: function (W) {
                        return {
                            x: W.x + W.width / 4,
                            y: W.y
                        }
                    },
                    41: function (u) {
                        return {
                            x: u.x + 3 * u.width / 4,
                            y: u.y
                        }
                    },
                    42: function (X, h) {
                        return {
                            x: X.x + X.width / 4,
                            y: X.y + h.height / 2
                        }
                    },
                    43: function (U, O) {
                        return {
                            x: U.x + 3 * U.width / 4,
                            y: U.y + O.height / 2
                        }
                    },
                    44: function (C, A) {
                        return {
                            x: C.x + C.width / 2,
                            y: C.y + C.height / 2 - A.height / 2
                        }
                    },
                    45: function (q) {
                        return {
                            x: q.x + q.width / 4,
                            y: q.y + q.height / 2
                        }
                    },
                    46: function (o, m) {
                        return {
                            x: o.x + o.width / 2 - m.width / 2,
                            y: o.y + o.height / 2
                        }
                    },
                    47: function (j, J) {
                        return {
                            x: j.x + j.width / 2 + J.width / 2,
                            y: j.y + j.height / 2
                        }
                    },
                    48: function (f) {
                        return {
                            x: f.x + 3 * f.width / 4,
                            y: f.y + f.height / 2
                        }
                    },
                    49: function (E, B) {
                        return {
                            x: E.x + E.width / 2,
                            y: E.y + E.height / 2 + B.height / 2
                        }
                    },
                    50: function (E, w) {
                        return {
                            x: E.x + E.width / 4,
                            y: E.y + E.height - w.height / 2
                        }
                    },
                    51: function (a, I) {
                        return {
                            x: a.x + 3 * a.width / 4,
                            y: a.y + a.height - I.height / 2
                        }
                    },
                    52: function (G) {
                        return {
                            x: G.x + G.width / 4,
                            y: G.y + G.height
                        }
                    },
                    53: function (M) {
                        return {
                            x: M.x + 3 * M.width / 4,
                            y: M.y + M.height
                        }
                    },
                    54: function (W, B) {
                        return {
                            x: W.x + W.width / 4,
                            y: W.y + W.height + B.height / 2
                        }
                    },
                    55: function (I, A) {
                        return {
                            x: I.x + 3 * I.width / 4,
                            y: I.y + I.height + A.height / 2
                        }
                    }
                };
                return Nr(d) ? function (B, M, P) {
                    return p[B](M, P ? P : sf)
                } : void 0
            }();
        xr(F, {
            highlight: "#1ABC9C",
            label: "#000",
            labelSelect: "#FFF",
            transparent: "rgba(0,0,0,0.35)",
            titleBackground: "#2C3E50",
            titleIconBackground: "#868686",
            headerBackground: "#ECF0F1",
            headerIconBackground: "#868686",
            headerSeparator: "#868686",
            headerLine: "#D9D9D9",
            background: "#FFF",
            disabledBackground: "rgba(255,255,255,0.65)",
            toolTipBackground: "#FFFFE0",
            rectSelectBorder: "#2C3E50",
            rectSelectBackground: "rgba(0,0,0,0.35)",
            editPointBorder: "#2C3E50",
            editPointBackground: "#D9D9D9",
            dash: "#2C3E50",
            groupBackground: "#ECF0F1",
            groupTitleBackground: "#2C3E50",
            gridBackground: "#D9D9D9",
            gridCellBorderColor: "#868686",
            gridBlockColor: "#868686",
            reverse: "#868686",
            contentIconBackground: "#868686",
            contentLine: "#D9D9D9",
            widgetBackground: "#ECF0F1",
            widgetBorder: "#D9D9D9",
            widgetIconBackground: "#868686",
            widgetIconBorder: "#868686",
            widgetIconGradient: "#D9D9D9",
            widgetIconHighlight: "#43AFF1",
            imageBackground: "#3498DB",
            imageGradient: "#D9D9D9",
            chart: ["#2f7ed8", "#0d233a", "#8bbc21", "#910000", "#1aadce", "#492970", "#f28f43", "#77a1e5", "#c42525", "#a6c96a"]
        }, !0);
        var Iq = F.reverse,
            Pn = F.transparent,
            Ve = F.rectSelectBackground,
            Kf = F.dash,
            $l = F.titleBackground,
            Ym = F.titleIconBackground,
            ig = F.headerBackground,
            ss = F.headerIconBackground,
            Bn = F.headerSeparator,
            xk = F.headerLine,
            Eb = F.contentIconBackground,
            uc = F.contentLine,
            np = (F.widgetIconHighlight, F.widgetIconBorder),
            Hm = (F.widgetIconGradient, F.imageBackground),
            ho = F.imageGradient,
            Zr = F.highlight,
            ad = F.label,
            un = F.labelSelect;
        if (u && !d.shutAlert) {
            var fi = new Date,
                Ci = u.split("-"),
                He = new Date(fi.getFullYear(), fi.getMonth(), fi.getDate()),
                u = new Date(A(Ci[0], 10), A(Ci[1], 10) - 1, A(Ci[2], 10)),
                Ji = He.getTime(),
                Gh = u.getTime(),
                kj = N + "_try",
                yj = d.alert;
            try {
                var Zc = d.localStorage;
/*                if (Zc && yj)
                    if (Gh > Ji && 1728e6 > Gh - Ji) {
                        var en = (Gh - Ji) / 864e5;
                        Zc && Zc[kj] != en && (Zc[kj] = en, yj("HT for Web free trial license will expire in " + en + " days, please apply for a new license!"))
                    } else Ji >= Gh && yj("Your free trial of HT for Web has expired!"), Zc && delete Zc[kj]*/
            } catch (Nj) {}
        }
        var Wm = {
            ms_ac: function (H, P) {
                for (var V = P.ms_ac, l = 0; l < V.length; l++) bc(H, V[l])
            },
            ms_listener: function (e) {
                e.addListeners = function () {
                    for (var O = this, b = 0; b < Nc.length; b++) O["handle_" + Nc[b]] && hb(Nc[b], O.getView(), O)
                }, e.removeListeners = function () {
                    for (var U = this, s = 0; s < Nc.length; s++) U["handle_" + Nc[s]] && pk(Nc[s], U.getView(), U)
                }
            },
            ms_fire: function (R) {
                R.mp = function (g, h, i) {
                    this.addPropertyChangeListener(g, h, i)
                }, R.ump = function (o, J) {
                    this.removePropertyChangeListener(o, J)
                }, R.fp = function (d, $, m, W, n) {
                    return this.firePropertyChange(d, $, m, W, n)
                }, R.addPropertyChangeListener = function (p, q, e) {
                    var H = this;
                    H._62I || (H._62I = new le), H._62I.add(p, q, e)
                }, R.removePropertyChangeListener = function (c, r) {
                    this._62I && this._62I.remove(c, r)
                }, R.firePropertyChange = function (f, r, A, L, h) {
                    if (L) {
                        if (L(r, A)) return !1
                    } else if (r === A) return !1;
                    var S = this,
                        m = h || {};
                    return m.property = f, m.oldValue = r, m.newValue = A, m.source = S, m.data = S, S._62I && S._62I.fire(m), S.onPropertyChanged && S.onPropertyChanged(m), !0
                }
            },
            ms_attr: function (l) {
                l.a = function (O, A) {
                    var l = this;
                    if (2 === arguments.length) l.setAttr(O, A);
                    else {
                        if (!cl(O)) return l.getAttr(O);
                        for (var u in O) l.setAttr(u, O[u])
                    }
                    return l
                }, l.getAttr = function (d, g) {
                    if (g === p && (g = 1), this._attrObject && d in this._attrObject) return this._attrObject[d];
                    if (this.getImage) {
                        var C = this.getImage();
                        if (Qc(C) && (C = Xn[C]), cl(C) && "dataBindings" in C)
                            for (var e = C.dataBindings, f = e.length - 1; f >= 0; f--) {
                                var t = e[f];
                                if (t.attr === d) {
                                    if ("defaultValue" in t) return t.defaultValue;
                                    break
                                }
                            }
                    }
                    return g ? B[d] : p
                }, l.setAttr = function (n, B) {
                    var h = this;
                    h._attrObject || (h._attrObject = {});
                    var g = h._attrObject[n];
                    B === p ? delete h._attrObject[n] : h._attrObject[n] = B, h.fp && h.fp("a:" + n, g, B) && h.onAttrChanged && h.onAttrChanged(n, g, B)
                }, l.getSerializableAttrs = function () {
                    var N, K = {};
                    for (N in this._attrObject) K[N] = 1;
                    return K
                }
            },
            ms_bnb: function (w) {
                w.getBodyColor = function (b) {
                    return b.s("body.color")
                }, w.getBorderColor = function (W) {
                    return W.s("border.color")
                }
            },
            _51o: function (D) {
                D.mi = function (A, K, Y) {
                    this.addInteractorListener(A, K, Y)
                }, D.umi = function (w, E) {
                    this.removeInteractorListener(w, E)
                }, D.fi = function (D) {
                    this.fireInteractorEvent(D)
                }, D.addInteractorListener = function (V, k, b) {
                    var T = this;
                    T._63I || (T._63I = new le), T._63I.add(V, k, b)
                }, D.removeInteractorListener = function (k, F) {
                    this._63I.remove(k, F)
                }, D.fireInteractorEvent = function (j) {
                    this._63I && this._63I.fire(j)
                }, D.setInteractors = function (u) {
                    var p = this,
                        E = p._interactors;
                    E && E.each(function (m) {
                        m.tearDown()
                    }), nj(u) && (u = new vf(u)), p._interactors = u, u && u.each(function (R) {
                        R.setUp()
                    }), p.fp("interactors", E, u), p.invalidateSelection()
                }, D.getInteractors = function () {
                    return this._interactors
                }
            },
            _49o: function (O) {
                O._44O = h, O._45O = h, O.getTopPainters = function () {
                    return this._44O
                }, O.getBottomPainters = function () {
                    return this._45O
                }, O.addTopPainter = function (e) {
                    var w = this;
                    w._44O || (w._44O = new vf), w._44O.contains(e) || (w._44O.add(e), w.redraw && w.redraw())
                }, O.removeTopPainter = function (W) {
                    var s = this;
                    s._44O && (s._44O.remove(W), s.redraw && s.redraw())
                }, O.addBottomPainter = function ($) {
                    var k = this;
                    k._45O || (k._45O = new vf), k._45O.contains($) || (k._45O.add($), k.redraw && k.redraw())
                }, O.removeBottomPainter = function (w) {
                    var K = this;
                    K._45O && (K._45O.remove(w), K.redraw && K.redraw())
                }, O._93db = function (z, k) {
                    var V = this;
                    V._45O && V._45O.each(function (X) {
                        X.draw ? X.draw(z, k) : X.call(V, z, k)
                    })
                }, O._92db = function (u, F) {
                    var K = this;
                    K._44O && K._44O.each(function (m) {
                        m.draw ? m.draw(u, F) : m.call(K, u, F)
                    })
                }
            },
            ms_sm: function (T) {
                T.sm = function () {
                    return this.getSelectionModel()
                }, T.setSelectableFunc = function (U) {
                    this.sm().setFilterFunc(U)
                }, T.getSelectableFunc = function () {
                    return this.sm().getFilterFunc()
                }, T.getSelectionModel = function () {
                    var B = this;
                    return B._selectionModel ? B._selectionModel : B.dm().sm()
                }, T.isSelectionModelShared = function () {
                    return !this._selectionModel
                }, T.setSelectionModelShared = function (f) {
                    var E = this,
                        t = !E._selectionModel,
                        z = E.handleSelectionChange,
                        B = E.dm();
                    t !== f && (E.invalidateSelection && E.invalidateSelection(), f ? (B.sm().ms(z, E), E._selectionModel.ums(z, E), E._selectionModel.dispose(), E._selectionModel = h) : (B.sm().ums(z, E), E._selectionModel = new Le(B), E._selectionModel.ms(z, E)), E.onSelectionModelSharedChanged(), E.fp("selectionModelShared", t, f))
                }, T.onSelectionModelSharedChanged = function () {
                    var V = this;
                    V.redraw(), V.invalidateSelection && V.invalidateSelection()
                }, T.removeSelection = function () {
                    var w = this.dm();
                    w.beginTransaction(), this.sm().toSelection().each(w.remove, w), w.endTransaction()
                }, T.selectAll = function () {
                    var P = this;
                    P.sm().ss(P.dm().toDatas(function (A) {
                        return P.isVisible(A) && P.isSelectable(A)
                    }))
                }, T.isSelected = function (F) {
                    return this.sm().co(F)
                }, T.isSelectedById = function (G) {
                    var U = this.dm().getDataById(G);
                    return U ? this.isSelected(U) : !1
                }, T.isSelectable = function (P) {
                    return this.sm().isSelectable(P)
                }
            },
            ms_tx: function (w) {
                w._64I = 0, w._65O = 0, w.isScrollable = function () {
                    return this.getWidth() < this._64I
                }, w._40o = function () {
                    return this.isScrollable()
                }, w.getLogicalPoint = function ($) {
                    return jm($, this._canvas || this._view, this.tx(), this.ty ? this.ty() : 0)
                }, w.tx = function (s) {
                    return s === p ? this.getTranslateX() : (this.setTranslateX(s), void 0)
                }, w.getTranslateX = function () {
                    return this._65O
                }, w.setTranslateX = function (U) {
                    var $ = this,
                        F = $.getWidth() - $._64I;
                    F > U && (U = F), U > 0 && (U = 0), U = r(U);
                    var C = $._65O;
                    $._65O = U, $.fp(mb, C, U)
                }
            },
            ms_ty: function (s) {
                s._23Q = 0, s._66O = 0, s._41o = function () {
                    return this.getHeight() < this._23Q
                }, s.getLogicalPoint = function (U) {
                    return jm(U, this._canvas || this._view, this.tx ? this.tx() : 0, this.ty())
                }, s.ty = function (r) {
                    return r === p ? this.getTranslateY() : (this.setTranslateY(r), void 0)
                }, s.getTranslateY = function () {
                    return this._66O
                }, s.setTranslateY = function (b) {
                    var E = this,
                        P = E.getHeight() - E._23Q;
                    P > b && (b = P), b > 0 && (b = 0), b = r(b);
                    var B = E._66O;
                    E._66O = b, E.fp(qc, B, b)
                }
            },
            ms_txy: function (H) {
                H._65O = 0, H._66O = 0, H.tx = function (v) {
                    return v === p ? this.getTranslateX() : (this.setTranslateX(v), void 0)
                }, H.ty = function (l) {
                    return l === p ? this.getTranslateY() : (this.setTranslateY(l), void 0)
                }, H.onTranslateEnded = function () {}, H.setTranslate = function (v, Q, M) {
                    var S = this;
                    if (M = Gl(M)) {
                        S._65I && S._65I.stop(!0);
                        var s = S.tx(),
                            D = S.ty();
                        M.action = function (z) {
                            S.setTranslate(s + (v - s) * z, D + (Q - D) * z)
                        }, M._37o = function () {
                            delete S._66I, delete S._65I, S.onTranslateEnded()
                        }, S._66I = 1, S._65I = Kd(M)
                    } else S.tx(v), S.ty(Q)
                }, H.getTranslateX = function () {
                    return this._65O
                }, H.setTranslateX = function (H) {
                    var x = this;
                    H = x.adjustTranslateX(H);
                    var U = x._65O;
                    x._65O = H, x.fp(mb, U, H)
                }, H.getTranslateY = function () {
                    return this._66O
                }, H.setTranslateY = function (R) {
                    var c = this;
                    R = c.adjustTranslateY(R);
                    var T = c._66O;
                    c._66O = R, c.fp(qc, T, R)
                }, H.adjustTranslateX = function (V) {
                    return r(V)
                }, H.adjustTranslateY = function (l) {
                    return r(l)
                }, H.translate = function (A, R, b) {
                    this.setTranslate(this.tx() + A, this.ty() + R, b)
                }, H.getLogicalPoint = function (b) {
                    var v = this;
                    return jm(b, this._canvas || v._view, v.tx(), v.ty())
                }
            },
            ms_dm: function (R) {
                R.dm = function (M) {
                    return M ? (this.setDataModel(M), void 0) : this.getDataModel()
                }, R.getDataModel = function () {
                    return this._dataModel
                }
            },
            ms_lp: function (c) {
                c.lp = function (z) {
                    return this.getLogicalPoint(z)
                }
            },
            ms_v: function (X) {
                X._disabled = !1, X.setDisabled = function (n, Y) {
                    var v = this,
                        i = v._disabled;
                    i !== n && (i && (Kh(v._63O), delete v._63O), n && (or(v._view, v._63O = ue(Y)), v.iv()), v._disabled = n, v.fp("disabled", i, n))
                }, X.isDisabled = function () {
                    return this._disabled
                }, X.getDisabledDiv = function () {
                    return this._63O
                }, X.getView = function () {
                    return this._view
                }, X.addToDOM = function (R) {
                    var y = this,
                        s = y.getView(),
                        e = s.style;
                    R = R || b.body, R.appendChild(s), e.left = "0", e.right = "0", e.top = "0", e.bottom = "0", d.addEventListener("resize", function () {
                        y.iv()
                    }, V), y.iv()
                }, X.getWidth = function () {
                    return this._view.clientWidth
                }, X.getHeight = function () {
                    return this._view.clientHeight
                }, X.setWidth = function (v) {
                    var s = this;
                    s._view.style.width = v + Do, s.iv(), s.fp && s.fp(hi, h, v)
                }, X.setHeight = function (y) {
                    var u = this;
                    u._view.style.height = y + Do, u.iv(), u.fp && u.fp(bg, h, y)
                }, X.setFocus = function (W) {
                    var u = this,
                        j = u._currentEditor;
                    return W && j && (j.getView && (j = j.getView()), j.contains(W.target)) ? !1 : (Sq(u._view), u.endEditing && u.endEditing(), u.fireViewEvent("focus"), !0)
                }, X.iv = function (Z) {
                    this.invalidate(Z)
                }, X.invalidate = function (E) {
                    var p = this;
                    p._68I || (p._68I = 1, Zl(p.validate, p, h, E), p.onInvalidated && p.onInvalidated(), p.fireViewEvent("invalidate"))
                }, X.validate = function () {
                    var c = this,
                        g = c._view;
                    if (c._68I && (delete c._68I, g.parentNode))
                        if (0 === g.offsetWidth && 0 === g.offsetHeight && c._67I !== h) c._67I === p && (c._67I = f.reinvalidateCount), c._67I > 0 ? c._67I-- : c._67I = h, c.iv();
                        else {
                            c.fireViewEvent("beginValidate"), c.validateImpl(), c.onValidated && c.onValidated(), c.fireViewEvent("validate");
                            var a = c._63O;
                            a && (g.lastChild !== a && (Kh(a), or(g, a)), Qh(a, 0, 0, c.getWidth(), c.getHeight())), $c(c), tn(c), Fq(c)
                        }
                }, X.layout = function (R, u, X, G) {
                    1 === arguments.length ? Qh(this, R) : Qh(this, R, u, X, G)
                }, X.addViewListener = function (T, V, z) {
                    var N = this;
                    N._67O || (N._67O = new le), N._67O.add(T, V, z)
                }, X.removeViewListener = function (L, n) {
                    this._67O.remove(L, n)
                }, X.fireViewEvent = function ($) {
                    var i = this;
                    i._67O && (Qc($) && ($ = {
                        kind: $
                    }), i._67O.fire($)), f.viewListener && f.viewListener(i, $)
                }
            },
            ms_tip: function (C) {
                C.setToolTipEnabled = function (U) {
                    var d = this;
                    U ? ah || d._13o || (d.enableToolTip(), d.fp("toolTipEnabled", !1, !0)) : d._13o && (d.disableToolTip(), d.fp("toolTipEnabled", !0, !1))
                }, C.isToolTipEnabled = function () {
                    return !!this._13o
                }, C.enableToolTip = function () {
                    var $ = this;
                    ah || $._13o || ($._13o = function (J) {
                        var a = $.getToolTip(J);
                        a != h ? f.toolTipContinual && f.isToolTipShowing() ? _o(J, a) : (hn(), wb = {
                            timeout: q(Re, wj),
                            e: J,
                            info: a
                        }) : hn()
                    }, $.getView().addEventListener(th, $._13o, V), $.getView().addEventListener("mouseleave", f.hideToolTip, V))
                }, C.disableToolTip = function () {
                    var $ = this;
                    $._13o && ($.getView().removeEventListener(th, $._13o, V), $.getView().removeEventListener("mouseleave", f.hideToolTip, V), delete $._13o)
                }, C.getToolTip = function (s) {
                    var m = this;
                    if (m.getDataAt) {
                        var d = m.getDataAt(s);
                        return d ? d.getToolTip() : h
                    }
                    return m.getValue ? m.getValue() : void 0
                }
            },
            _52o: function (j) {
                j._zoom = 1, j._29I = sf, j.zoomIn = function (I, c) {
                    this.setZoom(this._zoom * kg, I, c)
                }, j.zoomOut = function ($, B) {
                    this.setZoom(this._zoom / kg, $, B)
                }, j.zoomReset = function (D, f) {
                    this.setZoom(1, D, f)
                }, j.scrollZoomIn = function (b) {
                    this.setZoom(this._zoom * kl, h, b)
                }, j.scrollZoomOut = function (I) {
                    this.setZoom(this._zoom / kl, h, I)
                }, j.pinchZoomIn = function (I) {
                    this.setZoom(this._zoom * hl, h, I)
                }, j.pinchZoomOut = function (a) {
                    this.setZoom(this._zoom / hl, h, a)
                }, j.adjustZoom = function (v) {
                    return mp > v ? mp : v > fl ? fl : v
                }, j.getZoom = function () {
                    return this._zoom
                }, j.setZoom = function (F, d, r) {
                    var O = this;
                    if (d = Gl(d)) {
                        O._14o && O._14o.stop(!0);
                        var m = O._zoom;
                        d.action = function (K) {
                            O._96O(m + (F - m) * K, r)
                        }, d._37o = function () {
                            delete O._zooming, delete O._14o, O.onZoomEnded()
                        }, O._zooming = 1, O._14o = Kd(d)
                    } else O._96O(F, r)
                }, j._96O = function (Q, L) {
                    var o = this;
                    if (Q = o.adjustZoom(Q), Q !== o._zoom) {
                        o.validate();
                        var K = o._29I,
                            a = o._zoom;
                        0 !== K.width && 0 !== K.height && (L = L ? L : {
                            x: K.x + K.width / 2,
                            y: K.y + K.height / 2
                        }, o.tx((L.x - K.x) * a - L.x * Q), o.ty((L.y - K.y) * a - L.y * Q)), o._zoom = Q, o.fp("zoom", a, Q)
                    }
                }
            }
        };
        xr(f, {
            numberDigits: 5,
            crossOrigin: "",
            baseZIndex: p,
            isTouchable: ah,
            devicePixelRatio: d.devicePixelRatio ? d.devicePixelRatio : 1,
            reinvalidateCount: 3,
            hitMaxArea: 3e3,
            imageCacheThreshold: 20,
            autoMakeVisible: !0,
            autoHideScrollBar: !0,
            disabledOpacity: .4,
            disabledBackground: F.disabledBackground,
            forceHierarchicalSerialization: !0,
            hoverDelay: 600,
            toolTipDelay: 800,
            toolTipContinual: !1,
            getDragger: function () {
                return wh
            },
            lineCap: "butt",
            lineJoin: "round",
            imageGradient: "linear.northeast",
            dashPattern: [16, 16],
            doubleClickRange: ah ? 20 : 1,
            animDuration: 200,
            animEasing: function (s) {
                return s * s
            },
            labelColor: ad,
            labelSelectColor: un,
            labelFont: (ah ? "15" : "12") + "px arial, sans-serif",
            widgetIndent: ah ? 30 : 20,
            widgetRowHeight: ah ? 30 : 20,
            widgetHeaderHeight: ah ? 32 : 22,
            widgetTitleHeight: ah ? 34 : 24,
            scrollBarColor: Pn,
            scrollBarSize: 7,
            scrollBarTimeout: 1e3,
            scrollBarMinLength: 20,
            scrollBarInteractiveSize: ah ? 32 : 16,
            zoomIncrement: 1.3,
            scrollZoomIncrement: 1.05,
            pinchZoomIncrement: 1.08,
            zoomMax: 20,
            zoomMin: .01,
            segmentResolution: 12,
            shapeResolution: 24,
            shapeSide: 24,
            intersectionLineRect: oq,
            intersectionLineLine: Uo,
            isEnter: gd,
            isEsc: fm,
            isDelete: Lp,
            isSpace: Bo,
            isLeft: we,
            isUp: Ge,
            isRight: yf,
            isDown: Qg,
            getTarget: ro,
            isString: Qc,
            isNumber: Rj,
            isBoolean: rl,
            isArray: nj,
            isSelectAll: ed,
            isFunction: Yr,
            isObject: cl,
            getPropertyValue: nd,
            setPropertyValue: Qe,
            addMethod: xr,
            getVersion: function () {
                return "6.2.8"
            },
            createGradient: function (l, J, z, e, f, H, j, x) {
                var n = Fh[J];
                return n(l, z, e, f, H, j, x)
            },
            appendToScreen: function (o) {
                o = o.getView ? o.getView() : o, (b.fullscreenElement || b.mozFullScreenElement || b.webkitFullscreenElement || b.msFullscreenElement || b.body).appendChild(o)
            },
            toggleFullscreen: function (V) {
                var y = V.getView();
                if (b.fullscreenElement || b.mozFullScreenElement || b.webkitFullscreenElement || b.msFullscreenElement) b.exitFullscreen ? b.exitFullscreen() : b.msExitFullscreen ? b.msExitFullscreen() : b.mozCancelFullScreen ? b.mozCancelFullScreen() : b.webkitExitFullscreen && b.webkitExitFullscreen();
                else {
                    var g = !0;
                    if (V.isSelfViewEvent) {
                        var U = V.getX(),
                            X = V.getY(),
                            $ = V.getWidth(),
                            Q = V.getHeight(),
                            C = y.style.background;
                        C || (y.style.background = "white"), y.requestFullscreen ? y.requestFullscreen() : y.msRequestFullscreen ? y.msRequestFullscreen() : y.mozRequestFullScreen ? y.mozRequestFullScreen() : y.webkitRequestFullscreen && y.webkitRequestFullscreen();
                        var R = setInterval(function () {
                            if (y !== (b.fullscreenElement || b.mozFullScreenElement || b.webkitFullscreenElement || b.msFullscreenElement)) clearInterval(R), V.setX(U), V.setY(X), V.setWidth($), V.setHeight(Q), V._fullscreen = !1, y.style.background = C, V.iv();
                            else {
                                var L = k.Default.getWindowInfo();
                                (g || L.width !== V.getWidth() || L.height !== V.getHeight()) && (V.setX(L.left), V.setY(L.top), V.setWidth(L.width), V.setHeight(L.height), V._fullscreen = !0, V.iv(), g = !1)
                            }
                        }, 500)
                    } else {
                        var M = y.style.left,
                            z = y.style.top,
                            $ = y.style.width,
                            Q = y.style.height,
                            C = y.style.background;
                        C || (y.style.background = "white"), y.requestFullscreen ? y.requestFullscreen() : y.msRequestFullscreen ? y.msRequestFullscreen() : y.mozRequestFullScreen ? y.mozRequestFullScreen() : y.webkitRequestFullscreen && y.webkitRequestFullscreen();
                        var R = setInterval(function () {
                            if (y !== (b.fullscreenElement || b.mozFullScreenElement || b.webkitFullscreenElement || b.msFullscreenElement)) clearInterval(R), y.style.left = M, y.style.top = z, y.style.width = $, y.style.height = Q, y.style.background = C, V.iv();
                            else {
                                var t = k.Default.getWindowInfo();
                                (g || t.width !== V.getWidth() || t.height !== V.getHeight()) && (Qh(V), g = !1)
                            }
                        }, 500)
                    }
                }
            },
            appendTimeStamp: function (N) {
                return N
            },
            setCompType: function (U, W) {
                Yr(W) || cl(W) ? rm[U] = W : Ek(U)
            },
            getCompType: function (J) {
                var X = rm[J];
                return X === p && Eq.test(J) && Ek(J), X
            },
            getCompTypeMap: function () {
                return rm
            },
            drawCompType: function (i, P, b, V, F, M) {
                i(P, b, V, F, M)
            },
            numberListener: function () {
                var A = {
                    46: 1,
                    8: 1,
                    9: 1,
                    27: 1,
                    13: 1,
                    109: 1,
                    110: 1,
                    189: 1,
                    190: 1
                };
                return function (g) {
                    var R = g.keyCode;
                    A[R] || 65 === R && f.isCtrlDown(g) || 86 === R && f.isCtrlDown(g) || 67 === R && f.isCtrlDown(g) || 88 === R && f.isCtrlDown(g) || R >= 35 && 40 >= R || (g.shiftKey || 48 > R || R > 57) && (96 > R || R > 105) && g.preventDefault()
                }
            }(),
            ignoreKeyCodes: [122, 123],
            preventDefault: function (N) {
                var X = N.target.tagName;
                ("DIV" === X || "CANVAS" === X) && !(f.ignoreKeyCodes.indexOf(N.keyCode) >= 0) && ("keydown" !== N.type || we(N) || yf(N) || Ge(N) || Qg(N) || Lp(N) || 65 === N.keyCode && (N.metaKey || N.ctrlKey)) && (N.preventDefault(), N.preventManipulation && N.preventManipulation())
            },
            getWindowInfo: function () {
                var O = b.documentElement,
                    Y = O && (O.scrollLeft || O.scrollTop) ? O : b.body;
                return {
                    target: Y,
                    left: Y.scrollLeft,
                    top: Y.scrollTop,
                    width: d.innerWidth || Y.clientWidth,
                    height: d.innerHeight || Y.clientHeight
                }
            },
            isDragging: function () {
                return !!wh
            },
            isLeftButton: function (j) {
                return ah ? !0 : 0 === j.button
            },
            isInput: function (L) {
                if (!L) return !1;
                var p = L.tagName;
                return "INPUT" === p || "TEXTAREA" === p || "SELECT" === p
            },
            getTouchCount: function (_) {
                return ah ? _.touches.length : 1
            },
            isDoubleClick: function () {
                function U(L) {
                    L.details = 0, L.timeout = null, L.lastPoint = null
                }
                var i = {};
                return qs = new D, lj = qs.getTime(),
                    function (k) {
                        if (k.touches && k.touches.length > 1) return !1;
                        var H = k.button == h ? "" : k.button,
                            y = k.type + H,
                            D = y + "_isDoubleClick",
                            n = i[y];
                        if (n || (n = i[y] = {
                                details: 0,
                                timeout: null,
                                lastPoint: null
                            }), k[D] === p) {
                            k[D] = !0;
                            var r = Fc(k);
                            n.timeout && (I(n.timeout), n.timeout = null), n.lastPoint && Me(n.lastPoint, r) > f.doubleClickRange && U(n), n.lastPoint = r, n.details++, n.timeout = q(function () {
                                U(this)
                            }.bind(n), 500)
                        }
                        return 2 === n.details
                    }
            }(),
            isShiftDown: function (Z) {
                return Z ? Z.shiftKey : Ae["16"]
            },
            isCtrlDown: function (p) {
                return p ? km ? p.metaKey : p.ctrlKey : km ? Ae["91"] : Ae["17"]
            },
            getClientPoint: function (a) {
                return ah && (a = yh(a)), {
                    x: a.clientX,
                    y: a.clientY
                }
            },
            isMouseEvent: function (J) {
                return J instanceof MouseEvent || 0 === J.type.indexOf("mouse")
            },
            getTargetElement: function (q) {
                if (f.isMouseEvent(q) || !b.elementFromPoint) return q.target;
                var V = ts(q);
                return b.elementFromPoint(V.x, V.y)
            },
            getPagePoint: function (H) {
                return ah && (H = yh(H)), {
                    x: H.pageX,
                    y: H.pageY
                }
            },
            createObject: function (V, q) {
                var K = new V;
                for (var b in q) {
                    var $ = q[b];
                    if (Yr($)) K[b] = $;
                    else if (0 === b.indexOf("s:")) K.s(b.substr(2), q[b]);
                    else if (0 === b.indexOf("a:")) K.a(b.substr(2), q[b]);
                    else {
                        var D = io(b),
                            $ = q[b];
                        K[D] ? (K[D]($), "setToolTip" === D && K.enableToolTip && K.enableToolTip()) : K[b] = $
                    }
                }
                return K
            },
            setImage: function (F, j, o, I) {
                var D = arguments.length;
                4 === D ? Ye(F, I, j, o) : 2 === D ? Qc(j) ? Ye(F, j) : yo(F, j) : 1 === D && Ye(F, F)
            },
            getImage: function (I, E, e) {
                var v;
                if (I == h) return h;
                if (cl(I) ? v = I : (v = Xn[I], I && v === p && (xl && xl[I] || Ye(I, I))), E && v && v.tagName) {
                    var g;
                    g = "override" === e ? "colors_override" : "override_rgb" === e ? "colors_override_rgb" : "override_a" === e ? "colors_override_a" : "colors", v[g] || (v[g] = {
                        __count__: 0
                    });
                    var V = v[g][E];
                    return V || (v[g].__count__ > f.imageCacheThreshold && (v[g] = {
                        __count__: 0
                    }), V = Pe(v, Cj(E), v.width, v.height, e), v[g][E] = V, v[g].__count__++), V
                }
                return v
            },
            isImageComplete: function (k, i, Y) {
                var I = cl(k) ? k : Xn[k];
                if (!I) return !1;
                if (I.tagName) return I.complete;
                for (var N, k, B, $ = I.comps, O = !0, m = 0, z = $.length; z > m; m++)
                    if (N = $[m], B = N.type, "image" === N.type) {
                        k = N.name, k && k.func && (k = ze(k, i));
                        var o = Zo(k, i, Y);
                        if (!o) {
                            O = !1;
                            break
                        }
                    } else if (Eq.test(B) && f.getCompType(B) === p) {
                        O = !1;
                        break
                    }
                return O
            },
            getId: function () {
                var C = 1;
                return function () {
                    return ++C
                }
            }(),
            callLater: function (F, r, m, c) {
                var Z = function () {
                    F.apply(r, m)
                };
                return c ? q(Z, c) : d.requestAnimationFrame(Z)
            },
            clone: function (u) {
                if (null == u || "object" != typeof u) return u;
                if (u instanceof Date) {
                    var F = new Date;
                    return F.setTime(u.getTime()), F
                }
                if (u instanceof Array) {
                    for (var F = [], T = 0, L = u.length; L > T; T++) F[T] = tc(u[T]);
                    return F
                }
                if (u instanceof vf) {
                    for (var F = new vf, T = 0, L = u.length; L > T; T++) F.set(T, tc(u.get(T)));
                    return F
                }
                if (u instanceof rr) return u;
                if (u instanceof x) {
                    var F = {};
                    for (var s in u) u.hasOwnProperty(s) && (F[s] = tc(u[s]));
                    return F
                }
                return u
            },
            callWhenLoaded: function (x, t) {
                t = t || 100;
                var P = Lm(x, t);
                up || (up = {}), up[P] = {
                    tick: P,
                    cb: x,
                    delay: t
                }
            },
            beforeLoadURL: function (k) {
                if (up) {
                    var S = {};
                    for (var R in up) {
                        var w = up[R];
                        I(w.tick);
                        var K = Lm(w.cb, w.delay);
                        S[K] = {
                            tick: K,
                            delay: w.delay,
                            cb: w.cb
                        }
                    }
                    up = S
                }
                return f.convertURL ? f.convertURL(k) : k
            },
            convertURL: function (v) {
                return v
            },
            handleRefGraphLoaded: function () {},
            handleCompTypeLoaded: function () {},
            handleImageLoaded: function () {},
            handleUnfoundImage: function () {
                return f.getImage("default_blank")
            },
            sortFunc: function (n, V) {
                if (n === V) return 0;
                if (n == h && V != h) return 1;
                if (n != h && V == h) return -1;
                if (n == h && V == h) return 0;
                var l, y = typeof n,
                    c = typeof V;
                return y === Rf && c === Rf ? l = n.localeCompare(V) : y === Nh && c === Nh && (l = n - V), l === p && (l = ("" + n).localeCompare("" + V)), l > 0 ? 1 : 0 > l ? -1 : 0
            },
            getClassMap: function () {
                return gc
            },
            getClass: function (k) {
                if (Qc(k)) {
                    var f, h = gc[k];
                    if (!h) {
                        f = k.split("."), h = d;
                        for (var V = 0; V < f.length; V++) h = h[f[V]];
                        gc[k] = h
                    }
                    return h
                }
                return k
            },
            def: function (g, Q, F) {
                var s, l, L, T = function () {};
                if (T.prototype = Q.prototype, s = new T, Qc(g)) {
                    if (gc[g]) throw "'" + g + "' already defined";
                    L = Po(g), s.getClassName = function () {
                        return g
                    }
                } else L = g;
                if (s.constructor = L, s.getClass = function () {
                        return L
                    }, s.getSuperClass = function () {
                        return Q
                    }, F)
                    for (l in F) Wm[l] && Wm.hasOwnProperty(l) ? Wm[l](s, F) : ce(s, F, l);
                L.prototype = s, L.superClass = Q.prototype
            },
            startAnim: function () {
                var K = function (E) {
                    E.duration && (E.startTime = Td()), E.timeId = Zl(E.tick, h, h, E.interval)
                };
                return function (I) {
                    return I = tc(I), I.easing = I.easing || f.animEasing, I.duration || I.frames || (I.duration = f.animDuration), I.t = 0, I.duration ? I.interval = 0 : (I.frame = 0, I.interval = I.interval || 10), I.tick = function () {
                        if (I.duration) {
                            var t = (Td() - I.startTime) / I.duration;
                            t > 1 && (t = 1), I.t = t, I.action(I.easing(t), t), 1 === t ? I.stop() : I._isPaused || (I.timeId = Zl(I.tick))
                        } else I.frame++, t = I.t = I.frame / I.frames, I.action(I.easing(t), t), I.frame < I.frames ? I._isPaused || (I.timeId = Zl(I.tick, h, h, I.interval)) : I.stop()
                    }, I.resume = function () {
                        I._isPaused && (delete I._isPaused, I.duration ? I.t < 1 && (I.startTime = Td() - I.duration * I.t, I.timeId = Zl(I.tick)) : I.frame < I.frames && (I.timeId = Zl(I.tick, h, h, I.interval)))
                    }, I.pause = function () {
                        I._isPaused = !0
                    }, I.isPaused = function () {
                        return this._isPaused
                    }, I.stop = function (Z) {
                        I.isRunning() && (I.duration ? I.t < 1 && Z && (I.t = 1, I.action(I.easing(1), 1)) : I.frame < I.frames && Z && (I.frame = I.frames, I.action(I.easing(1), 1)), I._37o && I._37o(), I.finishFunc && I.finishFunc(), $r(I.timeId, !I.duration), delete I.timeId)
                    }, I.isRunning = function () {
                        return I.timeId != h
                    }, I.delay ? Zl(K, h, [I], I.delay) : K(I), I
                }
            }(),
            getTextSize: function () {
                var U = {},
                    c = b ? Np().getContext("2d") : h;
                return function (y, m) {
                    c.font = y ? y : Ti;
                    var N = U[c.font];
                    return N || (N = 2 * c.measureText("e").width + 4, U[c.font] = N), {
                        width: c.measureText(m).width + 4,
                        height: N
                    }
                }
            }(),
            drawText: function (_, e, r, G, i, p, V, B, g, b) {
                if (e != h) {
                    var S = Bk(r, e),
                        O = {};
                    O.y = b && b !== vn ? b === $b ? p + S.height / 2 : p + B - S.height / 2 : p + B / 2, O.x = g && g !== ul ? g === sb ? i + V - S.width / 2 : i + V / 2 : i + S.width / 2, Dm(_, e, O, r, G)
                }
            },
            getDistance: function (V, q) {
                var x = V.length;
                return q ? 3 === x ? l(L(V[0] - q[0]) + L(V[1] - q[1]) + L(V[2] - q[2])) : 2 === x ? l(L(V[0] - q[0]) + L(V[1] - q[1])) : V.z === p ? l(L(q.x - V.x) + L(q.y - V.y)) : l(L(q.x - V.x) + L(q.y - V.y) + L(q.z - V.z)) : 3 === x ? l(L(V[0]) + L(V[1]) + L(V[2])) : 2 === x ? l(L(V[0]) + L(V[1])) : void 0
            },
            brighter: function (O, v) {
                return 0 > v && (v = -v), Lh(O, v ? v : 40)
            },
            darker: function (V, G) {
                return G > 0 && (G = -G), Lh(V, G ? G : -40)
            },
            unionPoint: function (N, y) {
                if (!N) return h;
                if (2 === arguments.length) return N && y ? {
                    x: j(N.x, y.x),
                    y: j(N.y, y.y),
                    width: Y(N.x - y.x),
                    height: Y(N.y - y.y)
                } : h;
                var A = N;
                if (A._as && (A = A._as), A.length === p) return h;
                var R = A.length;
                if (0 >= R) return h;
                for (var V = 1, O = A[0], Q = {
                    x: O.x,
                    y: O.y,
                    width: 0,
                    height: 0
                }; R > V; V++) {
                    O = A[V];
                    var B = j(Q.x, O.x),
                        L = W(Q.x + Q.width, O.x),
                        e = j(Q.y, O.y),
                        D = W(Q.y + Q.height, O.y);
                    Q.x = B, Q.y = e, Q.width = L - B, Q.height = D - e
                }
                return Q
            },
            unionRect: function (E, g) {
                if (E && !g) return tc(E);
                if (!E && g) return tc(g);
                if (E && g) {
                    var w = {
                        x: j(E.x, g.x),
                        y: j(E.y, g.y)
                    };
                    return w.width = W(E.x + E.width, g.x + g.width) - w.x, w.height = W(E.y + E.height, g.y + g.height) - w.y, w
                }
                return h
            },
            containsPoint: function (L, D, X, s) {
                if (s != h && 1 !== s) {
                    var S = L.x + L.width / 2,
                        K = L.y + L.height / 2;
                    L = {
                        x: S - L.width / 2 * s,
                        y: K - L.height / 2 * s,
                        width: L.width * s,
                        height: L.height * s
                    }
                }
                if (X) {
                    var A = L.width / 2,
                        r = L.height / 2,
                        z = R(-X),
                        E = w(-X),
                        B = D.x - L.x - A,
                        x = D.y - L.y - r;
                    return D = {
                        x: E * B - z * x,
                        y: z * B + E * x
                    }, nr({
                        x: -A,
                        y: -r,
                        width: L.width,
                        height: L.height
                    }, D)
                }
                return !(!L || D.x < L.x || D.y < L.y || D.x > L.x + L.width || D.y > L.y + L.height)
            },
            containsRect: function (d, _) {
                if (!d || !_) return !1;
                var C = _.x,
                    v = _.y,
                    w = _.width,
                    n = _.height,
                    m = d.width,
                    I = d.height;
                if (0 > (m | I | w | n)) return !1;
                var p = d.x,
                    N = d.y;
                if (p > C || N > v) return !1;
                if (m += p, w += C, C >= w) {
                    if (m >= p || w > m) return !1
                } else if (m >= p && w > m) return !1;
                if (I += N, n += v, v >= n) {
                    if (I >= N || n > I) return !1
                } else if (I >= N && n > I) return !1;
                return !0
            },
            intersectsRect: function (v, y) {
                if (!v || !y) return !1;
                var l = y.width,
                    p = y.height,
                    s = v.width,
                    W = v.height;
                if (0 >= s || 0 >= W || 0 >= l || 0 >= p) return !1;
                var d = y.x,
                    q = y.y,
                    U = v.x,
                    b = v.y;
                return s += U, W += b, l += d, p += q, s > d && W > q && l > U && p > b
            },
            intersection: function (G, T) {
                if (!G || !T) return h;
                var t = T.x,
                    X = T.y,
                    v = G.x,
                    Z = G.y,
                    g = t,
                    $ = X,
                    y = v,
                    k = Z;
                return g += T.width, $ += T.height, y += G.width, k += G.height, v > t && (t = v), Z > X && (X = Z), g > y && (g = y), $ > k && ($ = k), g -= t, $ -= X, 0 >= g || 0 >= $ ? h : {
                    x: t,
                    y: X,
                    width: g,
                    height: $
                }
            },
            grow: function (c, w, x) {
                x === p && (x = w), c.x -= w, c.y -= x, c.width = c.width + 2 * w, c.height = c.height + 2 * x
            },
            getScreenPoint: function (X, R, M, r, b, U, T) {
                var m, G, j = M.getBoundingClientRect(),
                    K = X * (U || 1) + j.left - M.scrollLeft + (r || 0),
                    d = R * (T || 1) + j.top - M.scrollTop + (b || 0),
                    x = {
                        x: K,
                        y: d
                    };
                return (m = M.parentElement) && (G = m.maxtrixAppend) ? G.applyInverse(x, {}) : x
            },
            getLogicalPoint: function (x, k, C, i, M, H) {
                var L, q, V = k.getBoundingClientRect();
                x.target ? (Ab(x) ? km ? Ae["91"] = !0 : Ae["17"] = !0 : km ? Ae["91"] = !1 : Ae["17"] = !1, Ae["16"] = Lg(x) ? !0 : !1, x = ah ? yh(x) : x, L = x.clientX, q = x.clientY) : (L = x.x, q = x.y);
                var J, O;
                if ((J = k.parentElement) && (O = J.maxtrixAppend)) {
                    var Y = O.apply({
                        x: L,
                        y: q
                    }, {});
                    return Y.x = (Y.x + k.scrollLeft - (C || 0)) / (M || 1), Y.y = (Y.y + k.scrollTop - (i || 0)) / (H || 1), Y
                }
                return {
                    x: (L - V.left + k.scrollLeft - (C || 0)) / (M || 1),
                    y: (q - V.top + k.scrollTop - (i || 0)) / (H || 1)
                }
            },
            removeHTML: function () {
                var D;
                return function (S) {
                    return S && S.getView && (S = S.getView()), S && S.parentNode ? D === S ? !0 : (D = S, S.parentNode.removeChild(S), D = h, !0) : !1
                }
            }(),
            getToolTipDiv: function () {
                if (!Qi) {
                    Qi = rq(), Tj = rq();
                    var C = Qi.style;
                    f.baseZIndex != h && (C.zIndex = A(f.baseZIndex) + 3 + ""), C.whiteSpace = "nowrap", C.color = f.toolTipLabelColor, C.background = f.toolTipBackground, C.font = f.toolTipLabelFont, C.padding = "5px", C.boxShadow = "0px 0px 3px " + f.toolTipShadowColor
                }
                return Qi
            },
            isToolTipShowing: function () {
                return Qi && Qi.parentNode ? !0 : Tj && Tj.parentNode ? !0 : !1
            },
            hideToolTip: function () {
                Kh(Qi), Kh(Tj), Wf()
            },
            showToolTip: function (u, K) {
                if (!u || K == h) return hn(), void 0;
                f.getToolTipDiv();
                var T, M;
                if (K.html ? (K = K.html, T = Tj, Kh(Qi)) : (T = Qi, Kh(Tj)), M = T.style, T.innerHTML = K, T.parentNode || k.Default.appendToScreen(T), u.target) {
                    u = ts(u);
                    var B = ki(),
                        i = u.x,
                        I = u.y,
                        v = ah ? 60 : 12;
                    if (ah) {
                        var O = T.getBoundingClientRect();
                        M.left = i - O.width / 2 + Do, M.top = I - O.height - v < B.top ? I + v + Do : I - O.height - v + Do
                    } else {
                        M.left = i + v + Do, M.top = I + v + Do;
                        var O = T.getBoundingClientRect();
                        O.left + O.width > B.width && (M.left = i - v - O.width + Do), O.top + O.height > B.height && (M.top = I - v - O.height + Do), O.left < 0 && (M.left = i + v + Do), O.top < 0 && (M.top = I + v + Do)
                    }
                } else M.left = u.x + Do, M.top = u.y + Do;
                Wf()
            },
            startDragging: function (I, X, u) {
                u == p && (u = !0), I !== wh && (wh ? u && (ah ? wh.handleWindowTouchEnd(X) : wh.handleWindowMouseUp(X)) : ah ? (d.addEventListener(Cn, Zb, V), d.addEventListener(hc, xs, V)) : (d.addEventListener(th, dr, V), d.addEventListener(wr, uo, V)), wh = I)
            },
            getImageMap: function () {
                return Xn
            },
            toBoundaries: function (Y, i, B, m) {
                var $ = [];
                return fh(Y, i, B, m).forEach(function (y) {
                    var C = [];
                    y.forEach(function (e) {
                        C.push(e.x, e.y)
                    }), $.push(C)
                }), $
            },
            getCurrentKeyCodeMap: function () {
                return Ae
            },
            drawCenterImage: function (z, E, x, Q, P, Z, L, F) {
                var k = Df(E, P, Z),
                    d = Dd(E, P, Z);
                wp(z, E, r(x - k / 2), r(Q - d / 2), k, d, P, Z, L, F)
            },
            drawStretchImage: function (m, O, S, d, h, w, F, s, V, K, M, v) {
                var b, P = Df(O, s, V, w),
                    B = Dd(O, s, V, F);
                "uniform" === S ? (b = j(w / P, F / B), P *= b, B *= b, d += r((w - P) / 2), h += r((F - B) / 2), w = P, F = B) : "centerUniform" === S && ((P > w || B > F) && (b = j(w / P, F / B), P *= b, B *= b), d += r((w - P) / 2), h += r((F - B) / 2), w = P, F = B);
                var $ = m.interactiveInfo;
                if ($) {
                    var Y;
                    if (Y = "center" === S ? {
                            x: d + w / 2 - P / 2,
                            y: h + F / 2 - B / 2,
                            width: P,
                            height: B
                        } : {
                            x: d,
                            y: h,
                            width: w,
                            height: F
                        }, $.rect) {
                        var g = $.compInfos,
                            L = g.length;
                        L && (g[L - 1].rect.image = O)
                    } else $.rect = Y
                }
                if ("center" === S) {
                    var T = M !== !1 && (P > w || B > F);
                    T && (m.save(), m.beginPath(), m.rect(d, h, w, F), m.clip()), wp(m, O, d + w / 2 - P / 2, h + F / 2 - B / 2, P, B, s, V, K, v), T && m.restore()
                } else wp(m, O, d, h, w, F, s, V, K, v)
            },
            toCanvas: function (T, e, i, Y, t, r, z, j, H) {
                T = Qn(T, z), e = e || Df(T, t), i = i || Dd(T, t);
                var Z = Np(),
                    X = Hf(Z);
                return j ? (mc(Z, e, i, j), X.scale(j, j)) : mc(Z, e, i, 1), zk(X, T, Y, 0, 0, e, i, t, r, z, H), T && T.clampToEdge && (Z.clampToEdge = T.clampToEdge), X.restore(), Z
            },
            toGrayColor: function (Y) {
                if (!Y) return Y;
                var R = fj(Y),
                    u = .299 * R[0] + .587 * R[1] + .114 * R[2];
                return "rgba(" + u + "," + u + "," + u + "," + R[3] / 255 + ")"
            },
            createGradientImage: function (Z, y, U, m) {
                for (var j = ["L", 0, 0, Z, 0, 1, 0, 0, 1, 0, 0], d = 0, Y = Math.min(y.length, U.length); Y > d; d++) j.push(U[d], y[d]);
                var D = k.Default.toCanvas({
                    width: Z,
                    height: Z,
                    clampToEdge: !0,
                    comps: [{
                        type: "shape",
                        rotation: m || 0,
                        points: [0, 0, Z, 0, Z, Z, 0, Z],
                        background: "#ffffff",
                        gradientPack: j
                    }]
                });
                return D
            },
            createElement: function (y, L, p, H) {
                var B = b.createElement(y);
                return uk(B, L || F.widgetBorder, 2), B.style.font = p ? p : Ti, H != h && (B.value = H), f.onElementCreated && f.onElementCreated(B), B
            },
            containedInView: function (d, E) {
                var t = $p(E).getBoundingClientRect();
                return nr({
                    x: t.left,
                    y: t.top,
                    width: t.width,
                    height: t.height
                }, Fc(d))
            },
            isIsolating: function () {
                return vk > 0
            },
            setIsolating: function (s) {
                s ? vk++ : vk--
            },
            getMSMap: function () {
                return Wm
            },
            stringify: function (c, O) {
                var l = Date.prototype.toJSON;
                Date.prototype.toJSON = function () {
                    return "__ht__date" + this.getTime()
                };
                var e = JSON.stringify(c, function (X, e) {
                    return "function" == typeof e ? "__ht__" + (e.__ht__ || e.toString()) : Rj(e) ? Vg(e) : e instanceof k.List ? "__ht__list" + (e.__ht__list || f.stringify(e._as)) : e
                }, O == h ? 2 : O);
                return Date.prototype.toJSON = l, e
            },
            parse: function (F) {
                return Qc(F) ? JSON.parse(F, function (l, d) {
                    if (Qc(d))
                        if ("__ht__function" == d.substr(0, 14)) {
                            var I = d.indexOf("{") + 1,
                                C = d.lastIndexOf("}"),
                                R = d.indexOf("(") + 1,
                                J = d.indexOf(")");
                            if (I && C && R && J) {
                                var m = new Function(d.substring(R, J), d.substring(I, C));
                                return m.__ht__ = d.substr(6), m
                            }
                        } else {
                            if ("__ht__date" == d.substr(0, 10)) return new Date(A(d.substr(10)));
                            if ("__ht__list" === d.substr(0, 10)) return new vf(f.parse(d.substr(10)))
                        }
                    return d
                }) : F
            },
            loadJS: function (v, c) {
                c && v.push(c);
                var H = v.shift();
                if (nj(H)) v = H.contact(v), f.loadJS(v);
                else if (Yr(H)) H(), f.loadJS(v);
                else if (Qc(H)) {
                    var F = b.createElement("script");
                    F.onload = function () {
                        f.loadJS(v)
                    }, F.setAttribute("src", H), b.getElementsByTagName("head")[0].appendChild(F)
                } else v.length && f.loadJS(v)
            },
            toRoundedCorner: function (g, Z) {
                var A = g.size();
                if (0 >= Z) return {
                    points: g
                };
                var V, v = new vf,
                    L = new vf,
                    K = g.get(0);
                v.add(K), L.add(1);
                for (var T = 1; A > T; T++)
                    if (A > T + 1) {
                        var $ = g.get(T),
                            k = g.get(T + 1),
                            N = K.x,
                            B = K.y,
                            m = $.x,
                            Y = $.y,
                            t = Y - B,
                            F = m - N,
                            d = H(t, F);
                        V = j(.99 * Me(K, $), Z), v.add({
                            x: m - V * w(d),
                            y: Y - V * R(d)
                        }), v.add($), N = $.x, B = $.y, m = k.x, Y = k.y, t = Y - B, F = m - N, d = H(t, F), V = j(.99 * Me($, k), Z), K = {
                            x: N + V * w(d),
                            y: B + V * R(d)
                        }, v.add(K), L.addAll([2, 3])
                    } else v.add(g.get(T)), L.add(2);
                return {
                    points: v,
                    segments: L
                }
            },
            toColorData: fj,
            setCanvas: mc,
            createDiv: rq,
            createDisabledDiv: ue,
            createView: xj,
            createCanvas: Np,
            appendChild: or,
            initContext: Hf,
            checkLoadingImage: $c,
            translateAndScale: Tm,
            layout: Qh,
            getPosition: sj,
            drawPoints: Dl,
            drawRoundRect: zd,
            drawBorder: Yq,
            setFocus: Sq,
            getter: gr,
            setter: io,
            isEmptyObject: nm
        }, !0), xr(n, {
            autoAdjustIndex: 1,
            hierarchicalRendering: 1,
            adjustChildrenToTop: 1,
            autoHideScrollBar: 1,
            autoUpdate: 1,
            firstPersonMode: 1,
            ortho: 1,
            strict: 1,
            stickToRight: 1,
            instant: 1,
            closePath: 1,
            hierarchical: 1,
            doubleClickToToggle: 1,
            continuousLayout: 1,
            syncSize: 1
        }, !0);
        var Kr = f.disabledOpacity,
            wj = f.toolTipDelay,
            Tp = f.devicePixelRatio,
            Ei = f.autoMakeVisible,
            Gr = f.autoHideScrollBar,
            Xb = f.imageGradient,
            _o = f.showToolTip,
            hn = f.hideToolTip,
            Zg = f.dashPattern,
            Lk = f.lineCap,
            Wd = f.lineJoin,
            Eo = f.labelColor,
            Am = f.labelSelectColor,
            Ti = f.labelFont,
            cn = f.widgetIndent,
            nb = f.widgetRowHeight,
            yb = f.widgetHeaderHeight,
            xn = f.widgetTitleHeight,
            fe = f.scrollBarColor,
            td = f.scrollBarSize,
            cb = f.scrollBarTimeout,
            si = f.scrollBarMinLength,
            ys = f.scrollBarInteractiveSize,
            kg = f.zoomIncrement,
            kl = f.scrollZoomIncrement,
            hl = f.pinchZoomIncrement,
            fl = f.zoomMax,
            mp = f.zoomMin,
            Th = f.createObject,
            Bl = f.preventDefault,
            Ej = f.setImage,
            Qn = f.getImage,
            Zo = f.isImageComplete,
            nn = f.drawCenterImage,
            zk = f.drawStretchImage,
            Uk = f.getId,
            Zl = f.callLater,
            dh = f.sortFunc,
            tc = f.clone,
            Po = f.getClass,
            Kd = f.startAnim,
            Lb = f.brighter,
            jg = f.darker,
            Yd = f.drawText,
            Bk = f.getTextSize,
            Bf = f.isLeftButton,
            ni = f.getTouchCount,
            bo = f.isDoubleClick,
            Lg = f.isShiftDown,
            Ab = f.isCtrlDown,
            Fc = f.getClientPoint,
            ts = f.getPagePoint,
            Me = f.getDistance,
            Vj = f.unionPoint,
            Rq = f.unionRect,
            nr = f.containsPoint,
            Ok = f.containsRect,
            Hk = f.intersectsRect,
            oi = f.intersection,
            ki = f.getWindowInfo,
            $d = f.grow,
            jm = f.getLogicalPoint,
            Sr = f.getScreenPoint,
            gn = f.startDragging,
            Kh = f.removeHTML,
            En = f.createElement,
            ol = f.segmentResolution,
            he = f.shapeResolution,
            Sp = f.shapeSide,
            zc = f.def,
            If = function (d, I, k) {
                zc(N + "." + d, I, k)
            },
            gl = function (Q, M) {
                Q.childNodes.forEach(function (v) {
                    M(v), gl(v, M)
                })
            };
        xr(f, {
            toolTipLabelColor: Eo,
            toolTipLabelFont: Ti,
            toolTipBackground: F.toolTipBackground,
            toolTipShadowColor: Pn,
            drawBreakableText: Nq,
            setDevicePixelRatio: function (V) {
                Tp = f.devicePixelRatio = "number" == typeof V ? V : d.devicePixelRatio, gl(b.body, function (m) {
                    var O = m._ht;
                    O && O._canvas && (mc(O._canvas, O.getWidth(), O.getHeight()), O.redraw ? O.redraw() : O.iv())
                })
            }
        }, !0);
        var iq = 1e-6,
            Fk = "undefined" != typeof Uint16Array ? Uint16Array : Array,
            Ol = "undefined" != typeof Float32Array ? Float32Array : Array,
            on = function (Q, a, G) {
                var W = [Q[0] - a[0], Q[1] - a[1], Q[2] - a[2]];
                if (G) {
                    var T = Me(W);
                    T > 0 && (W[0] /= T, W[1] /= T, W[2] /= T)
                }
                return W
            },
            Bc = function () {
                var B = "charCodeAt",
                    P = 2 * (2 * nl.length + 1);
                for (var w in d)
                    if (w === N + ul[0] + Do.length) {
                        var t = d[w];
                        if (!t) break;
                        for (var b = t.length, U = 0; b > U; U++)
                            if (t[U][B](0) === P && t[U + 1] != h && t[U + 1] === Do[0] && t[U + 2] != h && t[U + 2][B](0) === P) {
                                for (var D = U + 3; b > D; D++)
                                    if (t[D][B](0) === P) {
                                        if (0 == t[D + 1])
                                            for (var K, v = D + 2; b > v; v++) {
                                                if (t[v][B](0) === P) {
                                                    0 == t[v - 1] && K && (X = K.substr(0, K.length - 1));
                                                    break
                                                }
                                                K == h ? K = t[v] : K += t[v]
                                            }
                                        break
                                    }
                                break
                            }
                        break
                    }
                return function (I) {
                    return [-I[0], -I[1], -I[2]]
                }
            }(),
            Gi = function (e, v) {
                return 3 === e.length ? e[0] * v[0] + e[1] * v[1] + e[2] * v[2] : e[0] * v[0] + e[1] * v[1]
            },
            Ip = function () {
                var x = new Ol(16);
                return x[0] = 1, x[1] = 0, x[2] = 0, x[3] = 0, x[4] = 0, x[5] = 1, x[6] = 0, x[7] = 0, x[8] = 0, x[9] = 0, x[10] = 1, x[11] = 0, x[12] = 0, x[13] = 0, x[14] = 0, x[15] = 1, x
            },
            vj = Ip(),
            tl = function (Y) {
                var T = new Ol(16);
                return T[0] = Y[0], T[1] = Y[1], T[2] = Y[2], T[3] = Y[3], T[4] = Y[4], T[5] = Y[5], T[6] = Y[6], T[7] = Y[7], T[8] = Y[8], T[9] = Y[9], T[10] = Y[10], T[11] = Y[11], T[12] = Y[12], T[13] = Y[13], T[14] = Y[14], T[15] = Y[15], T
            },
            ij = function (K, L) {
                return K[0] = L[0], K[1] = L[1], K[2] = L[2], K[3] = L[3], K[4] = L[4], K[5] = L[5], K[6] = L[6], K[7] = L[7], K[8] = L[8], K[9] = L[9], K[10] = L[10], K[11] = L[11], K[12] = L[12], K[13] = L[13], K[14] = L[14], K[15] = L[15], K
            },
            lg = function (_) {
                return _[0] = 1, _[1] = 0, _[2] = 0, _[3] = 0, _[4] = 0, _[5] = 1, _[6] = 0, _[7] = 0, _[8] = 0, _[9] = 0, _[10] = 1, _[11] = 0, _[12] = 0, _[13] = 0, _[14] = 0, _[15] = 1, _
            },
            Br = function (U, D) {
                var t = U[0],
                    I = U[1],
                    c = U[2];
                return U[0] = D[0] * t + D[4] * I + D[8] * c + D[12], U[1] = D[1] * t + D[5] * I + D[9] * c + D[13], U[2] = D[2] * t + D[6] * I + D[10] * c + D[14], U
            },
            Mp = function (H, V) {
                var L = H[0],
                    i = H[1],
                    B = H[2],
                    q = H[3];
                return H[0] = V[0] * L + V[4] * i + V[8] * B + V[12] * q, H[1] = V[1] * L + V[5] * i + V[9] * B + V[13] * q, H[2] = V[2] * L + V[6] * i + V[10] * B + V[14] * q, H[3] = V[3] * L + V[7] * i + V[11] * B + V[15] * q, H
            },
            So = function () {
                var A, H, g, W, Z = tb(Gc[1] + Gc[7]),
                    h = tb(Gc[0] + Gc[3] - Gc[10]),
                    M = tb(Gc[8] + 2),
                    B = function () {
                        return H = g.charAt(A), A += 1, H
                    },
                    z = function () {
                        var s = "";
                        if (H === M)
                            for (; B();) {
                                if (H === M) return B(), s;
                                s += H
                            } else B()
                    },
                    $ = function () {
                        for (; H && " " >= H;) B()
                    },
                    i = function () {
                        var k, R = {};
                        if (H === Z) {
                            if (B(), $(), H === h) return B(), R;
                            for (; H;) {
                                if (k = z(), $(), B(), R[k] = W(), $(), H === h) return B(), R;
                                B(), $()
                            }
                        }
                    };
                return W = function () {
                    switch ($(), H) {
                        case Z:
                            return i();
                        default:
                            return z()
                    }
                },
                    function (d) {
                        if (U = {}, d) {
                            var s;
                            if (g = d, A = 0, H = " ", s = W(), $(), !H) return s
                        }
                    }
            }(),
            pd = function (b, g) {
                if (g) {
                    var q = R(g),
                        Q = w(g),
                        c = b[4],
                        $ = b[5],
                        p = b[6],
                        m = b[7],
                        f = b[8],
                        n = b[9],
                        Y = b[10],
                        o = b[11];
                    b[4] = c * Q + f * q, b[5] = $ * Q + n * q, b[6] = p * Q + Y * q, b[7] = m * Q + o * q, b[8] = f * Q - c * q, b[9] = n * Q - $ * q, b[10] = Y * Q - p * q, b[11] = o * Q - m * q
                }
            },
            Zh = function (h, k) {
                if (k) {
                    var S = R(k),
                        Y = w(k),
                        L = h[0],
                        M = h[1],
                        e = h[2],
                        I = h[3],
                        v = h[8],
                        l = h[9],
                        T = h[10],
                        c = h[11];
                    h[0] = L * Y - v * S, h[1] = M * Y - l * S, h[2] = e * Y - T * S, h[3] = I * Y - c * S, h[8] = L * S + v * Y, h[9] = M * S + l * Y, h[10] = e * S + T * Y, h[11] = I * S + c * Y
                }
            },
            Cg = function (p, P) {
                if (P) {
                    var s = R(P),
                        o = w(P),
                        G = p[0],
                        z = p[1],
                        v = p[2],
                        u = p[3],
                        A = p[4],
                        e = p[5],
                        Y = p[6],
                        b = p[7];
                    p[0] = G * o + A * s, p[1] = z * o + e * s, p[2] = v * o + Y * s, p[3] = u * o + b * s, p[4] = A * o - G * s, p[5] = e * o - z * s, p[6] = Y * o - v * s, p[7] = b * o - u * s
                }
            },
            zh = function (s, J, b) {
                return Kq(h, b === !1 ? h : s.getFinalScale3d(), s.getFinalRotation3d(), s.getRotationMode(), s.p3(), h, J)
            },
            Kq = function (M, _, c, R, H, p, Q) {
                return p || (p = Ip()), H && Xj(p, H), zb(p, c, R), Q && sg(p, p, Q), _ && br(p, _), M && sg(p, p, M), p
            },
            Lc = function (w, C, O) {
                C = A(C), O = A(O);
                var j = this;
                j.g = w, j._84O = C, j._85O = O, j._70I = !0, j.F = 0, j._83O = C + O, j.pen = {
                    x: 0,
                    y: 0
                }
            },
            Cd = "lineDashOffset",
            Yi = "setLineDash",
            Ff = function (g) {
                for (var y in g) 1 === y.length && (Cd = g[y]);
                return y ? 1 : 0
            },
            eb = function (D, W, q) {
                return ji(W) ? D : D[Yi] ? (D[Yi](W), q && (D.lineDashOffset = q), D) : new Lc(D, W[0], W.length > 1 ? W[1] : W[0])
            },
            Bg = function ($, U) {
                !ji(U) && $[Yi] && ($[Yi](Em), $.lineDashOffset = 0)
            };
        if (zc(Lc, x, {
                _69I: 6,
                moveTo: function (j, S) {
                    var P = this,
                        e = P.pen;
                    e.x = j, e.y = S, P.g.moveTo(j, S), P.start || (P.start = {
                        x: j,
                        y: S
                    })
                },
                lineTo: function (P, v) {
                    var G = this,
                        O = G.pen,
                        X = P - O.x,
                        J = v - O.y,
                        s = H(J, X),
                        o = w(s),
                        k = R(s),
                        l = G._23O(O.x, O.y, P, v),
                        W = G._85O,
                        F = G._84O,
                        a = G._83O;
                    if (G.F) {
                        if (G.F > l) return G._70I ? G._72I(P, v) : G.moveTo(P, v), G.F -= l, void 0;
                        if (G._70I ? G._72I(O.x + o * G.F, O.y + k * G.F) : G.moveTo(O.x + o * G.F, O.y + k * G.F), l -= G.F, G.F = 0, G._70I = !G._70I, !l) return
                    }
                    var x = e(l / a);
                    if (x) {
                        for (var B = o * F, i = k * F, $ = o * W, A = k * W, u = 0; x > u; u++) G._70I ? (G._72I(O.x + B, O.y + i), G.moveTo(O.x + $, O.y + A)) : (G.moveTo(O.x + $, O.y + A), G._72I(O.x + B, O.y + i));
                        l -= a * x
                    }
                    G._70I ? l > F ? (G._72I(O.x + o * F, O.y + k * F), G.moveTo(P, v), G.F = W - (l - F), G._70I = !1) : (G._72I(P, v), l === F ? (G.F = 0, G._70I = !G._70I) : (G.F = F - l, G.moveTo(P, v))) : l > W ? (G.moveTo(O.x + o * W, O.y + k * W), G._72I(P, v), G.F = F - (l - W), G._70I = !0) : (G.moveTo(P, v), l === W ? (G.F = 0, G._70I = !G._70I) : G.F = W - l)
                },
                quadraticCurveTo: function (w, L, _, k) {
                    var C, z = this,
                        i = z.pen,
                        F = i.x,
                        P = i.y,
                        a = z._22O(F, P, w, L, _, k),
                        S = 0,
                        j = 0,
                        K = z._85O,
                        d = z._84O;
                    if (z.F) {
                        if (z.F > a) return z._70I ? z._71I(w, L, _, k) : z.moveTo(_, k), z.F -= a, void 0;
                        if (S = z.F / a, C = z._20O(F, P, w, L, _, k, S), z._70I ? z._71I(C[2], C[3], C[4], C[5]) : z.moveTo(C[4], C[5]), z.F = 0, z._70I = !z._70I, !a) return
                    }
                    var v = a - a * S,
                        M = e(v / z._83O),
                        Z = d / a,
                        y = K / a;
                    if (M)
                        for (var D = 0; M > D; D++) z._70I ? (j = S + Z, C = z._21O(F, P, w, L, _, k, S, j), z._71I(C[2], C[3], C[4], C[5]), S = j, j = S + y, C = z._21O(F, P, w, L, _, k, S, j), z.moveTo(C[4], C[5])) : (j = S + y, C = z._21O(F, P, w, L, _, k, S, j), z.moveTo(C[4], C[5]), S = j, j = S + Z, C = z._21O(F, P, w, L, _, k, S, j), z._71I(C[2], C[3], C[4], C[5])), S = j;
                    v = a - a * S, z._70I ? v > d ? (j = S + Z, C = z._21O(F, P, w, L, _, k, S, j), z._71I(C[2], C[3], C[4], C[5]), z.moveTo(_, k), z.F = K - (v - d), z._70I = !1) : (C = z._19O(F, P, w, L, _, k, S), z._71I(C[2], C[3], C[4], C[5]), a === d ? (z.F = 0, z._70I = !z._70I) : (z.F = d - v, z.moveTo(_, k))) : v > K ? (j = S + y, C = z._21O(F, P, w, L, _, k, S, j), z.moveTo(C[4], C[5]), C = z._19O(F, P, w, L, _, k, j), z._71I(C[2], C[3], C[4], C[5]), z.F = d - (v - K), z._70I = !0) : (z.moveTo(_, k), v === K ? (z.F = 0, z._70I = !z._70I) : z.F = K - v)
                },
                bezierCurveTo: function () {
                    var N = arguments;
                    this.pen = {
                        x: N[4],
                        y: N[5]
                    }, this.g.bezierCurveTo(N[0], N[1], N[2], N[3], N[4], N[5])
                },
                arc: function (B, g, n, u, q, F) {
                    F || (u = -u, q = -q), jp(this, B, g, u, q - u, n, n, !1)
                },
                rect: function (X, E, P, w) {
                    var o = this;
                    o.pen = {
                        x: X,
                        y: E
                    }, o.moveTo(X, E), o.lineTo(X, E + w), o.lineTo(X + P, E + w), o.lineTo(X + P, E), o.lineTo(X, E)
                },
                beginPath: function () {
                    this.g.beginPath()
                },
                closePath: function () {
                    this.lineTo(this.start.x, this.start.y)
                },
                _23O: function (g, T, M, U) {
                    var k = M - g,
                        q = U - T;
                    return l(k * k + q * q)
                },
                _22O: function (b, x, q, s, F, G, N) {
                    for (var Z, X, R, U, B, Q, y, m = 0, e = b, S = x, i = N > 0 ? N : this._69I, p = 1; i >= p; p++) R = p / i, U = 1 - R, B = U * U, Q = 2 * R * U, y = R * R, Z = B * b + Q * q + y * F, X = B * x + Q * s + y * G, m += this._23O(e, S, Z, X), e = Z, S = X;
                    return m
                },
                _21O: function (Z, w, U, K, i, N, o, R) {
                    var p = this;
                    if (0 === o) return p._20O(Z, w, U, K, i, N, R);
                    if (1 === R) return p._19O(Z, w, U, K, i, N, o);
                    var Y = p._20O(Z, w, U, K, i, N, R);
                    return Y.push(o / R), p._19O.apply(p, Y)
                },
                _20O: function (L, M, Z, e, r, z, v) {
                    if (1 !== v) {
                        var l = Z + (r - Z) * v,
                            h = e + (z - e) * v;
                        Z = L + (Z - L) * v, e = M + (e - M) * v, r = Z + (l - Z) * v, z = e + (h - e) * v
                    }
                    return [L, M, Z, e, r, z]
                },
                _19O: function ($, X, S, y, Q, G, P) {
                    if (1 !== P) {
                        var j = $ + (S - $) * P,
                            d = X + (y - X) * P;
                        S += (Q - S) * P, y += (G - y) * P, $ = j + (S - j) * P, X = d + (y - d) * P
                    }
                    return [$, X, S, y, Q, G]
                },
                _72I: function (_, M) {
                    var y = this.pen;
                    (_ !== y.x || M !== y.y) && (y.x = _, y.y = M, this.g.lineTo(_, M))
                },
                _71I: function (x, j, w, N) {
                    var C = this.pen;
                    (x !== w || j !== N || w !== C.x || N !== C.y) && (C.x = w, C.y = N, this.g.quadraticCurveTo(x, j, w, N))
                }
            }), m && P) {
            var lb = P.toString();
            S = lb.indexOf(_c.substr(0, 2)) > 0 && lb.indexOf($b + $b.substr(1, 1)) > 1 || lb.indexOf(Wj.substr(0, 2) + _c.substr(2, 2) + ul[0] + _c[4]) > 1 ? !0 : !1
        }/*!0 && d.console && (d.navigator && d.navigator.userAgent.toLowerCase().indexOf("chrome") > -1 ? d.console.log.apply(console, ["Hightopo - Version" + k.Default.getVersion() + " - %chttp://hightopo.com/request.html", "color: #f00;"]) : d.console.log("Hightopo - Version" + k.Default.getVersion() + " - http://hightopo.com/request.html"));*/
        var As = h,
            Up = h,
            tn = function ($) {
                As && !$._72O && (Up || (Up = {}), Up[$._72O = Uk()] = $)
            },
            Ek = function (A, N) {
                if (N || (N = A), N && (As || (As = {}), !As[A])) {
                    var c = new ne;
                    if (As[N] = {
                            request: c,
                            url: N
                        }, N = f.beforeLoadURL(N), N.data) {
                        var $ = f.parse(N.data);
                        bm(A, $), f.handleCompTypeLoaded(A, $)
                    } else {
                        c.onload = function (p) {
                            if (200 === this.status || 0 === this.status) {
                                var R = f.parse(p.target.response || p.target.responseText);
                                bm(A, R), f.handleCompTypeLoaded(A, R)
                            } else bm(A, h)
                        }, c.onerror = function () {
                            bm(A, h)
                        };
                        var K = {};
                        K.url = encodeURI(N), K.sync = !1, c.send(K)
                    }
                }
            },
            bm = function (f, c) {
                if (rm[f] = c, delete As[f], nm(As) && (As = h, Up)) {
                    for (var C in Up) {
                        var V = Up[C];
                        V.invalidateAll && V.invalidateAll(p, "compTypeLoaded", f), V.redraw && V.redraw(), V.iv(), delete V._72O
                    }
                    Up = h
                }
                if (c && Up)
                    for (var C in Up) {
                        var V = Up[C];
                        V.invalidateAll && V.invalidateAll(p, "compTypeLoading", f), V.redraw && V.redraw(), V.iv()
                    }
            },
            Jf = F.chart,
            Pm = f.compStack = [],
            hh = /^style@/,
            Jp = /^attr@/,
            Bj = /^field@/,
            Un = {
                x: .5,
                y: .5
            },
            Df = function (b, $, m, S) {
                if (!b) return 0;
                if (ze(b.fitSize, $, m) && S) return S;
                var j = ze(b.width, $, m);
                return null == j ? 20 : j
            },
            Dd = function (o, W, U, S) {
                if (!o) return 0;
                if (ze(o.fitSize, W, U) && S) return S;
                var p = ze(o.height, W, U);
                return null == p ? 20 : p
            },
            ze = function (Z, T, D) {
                if (!Z || !Z.func) return Z;
                var E, v = Z.func,
                    L = Z.value;
                return E = Yr(v) ? D && D.vectorDataBindingDisabled && !Z.isSafeFunc ? L : v(T, D) : T instanceof rr ? Jp.test(v) ? T.a(v.slice(5)) : hh.test(v) ? T.s(v.slice(6)) : Bj.test(v) ? T[v.slice(6)] : T[v] ? T[v](D) : L : L, L !== p && E == h ? L : E
            },
            wp = f.drawImage = function () {
                var r, D, A, n, C, T, u = function (Z, D) {
                        Z.getValue && Z.getValue.compType === D || (Z.getValue = function (R) {
                            var N = z(Z, R);
                            if (N === p && D.properties) {
                                var T = D.properties[R];
                                T && (N = T.defaultValue)
                            }
                            return N
                        }, Z.getColor = function (R) {
                            return c(Z.getValue(R))
                        }, Z.getValue.compType = D)
                    },
                    z = function (O, I, N) {
                        var G = O[I];
                        return G && G.func ? (G = ze(G, D, A), N && (G = N(G))) : N && (G = O[I] = N(G)), G
                    },
                    c = function (F, E) {
                        var c;
                        if (c = E ? z(F, E) : F, r && r.compGray && c) return f.toGrayColor(c);
                        if (C && c) {
                            if ("override" === T) return C;
                            if ("override_rgb" === T) {
                                var v = Cj(C);
                                return c = fj(c), "rgba(" + e(255 * v[0]) + "," + e(255 * v[1]) + "," + e(255 * v[2]) + "," + c[3] / 255 + ")"
                            }
                            if ("override_a" === T) {
                                var v = Cj(C);
                                return c = fj(c), "rgba(" + c[0] + "," + c[1] + "," + c[2] + "," + v[3] + ")"
                            }
                            var v = Cj(C);
                            return c = fj(c), "rgba(" + e(c[0] * v[0]) + "," + e(c[1] * v[1]) + "," + e(c[2] * v[2]) + "," + c[3] / 255 * v[3] + ")"
                        }
                        return c
                    },
                    k = function (V) {
                        if (nj(V)) {
                            for (var h = new vf, U = V.length, T = 0; U > T; T += 2) h.add({
                                x: V[T],
                                y: V[T + 1]
                            });
                            V = h
                        }
                        return V
                    },
                    O = function (c) {
                        var j = z(c, "anchorX"),
                            r = z(c, "anchorY");
                        if (j !== p || r !== p) return {
                            x: j === p ? Un.x : j,
                            y: r === p ? Un.y : r
                        };
                        var X = z(c, "type"),
                            G = z(c, "name");
                        if ("image" !== X || !G) return Un;
                        var y = Qn(G);
                        return y && y.anchorX !== p && y.anchorY !== p ? {
                            x: y.anchorX,
                            y: y.anchorY
                        } : Un
                    },
                    _ = function (Y, $) {
                        var H = z(Y, as),
                            s = O(Y);
                        if (nj(H)) {
                            var F = H.length,
                                j = z(Y, "relative"),
                                n = $.width,
                                I = $.height;
                            if (4 === F) H = {
                                x: H[0],
                                y: H[1],
                                width: H[2],
                                height: H[3]
                            }, j && (H.x *= n, H.y *= I, H.width *= n, H.height *= I);
                            else if (3 === F) {
                                var c = H[0];
                                H = {
                                    width: H[1],
                                    height: H[2]
                                }, j && (H.width *= n, H.height *= I), "object" == typeof c ? c.length && (c = {
                                        x: c[0],
                                        y: c[1]
                                    }) : c = sj(c, $, H), H.x = c.x - H.width * s.x, H.y = c.y - H.height * s.y
                            }
                            H.x += z(Y, "offsetX") || 0, H.y += z(Y, "offsetY") || 0, !j && $.fitSize && (H = v(Y, H, $))
                        }
                        return H
                    },
                    v = function (u, H, Q) {
                        if (H) {
                            var L, o, K, t = {
                                    x: H.x,
                                    y: H.y,
                                    width: H.width,
                                    height: H.height
                                },
                                m = O(u),
                                f = z(u, "layoutH"),
                                d = z(u, "layoutV"),
                                g = 1,
                                j = 1,
                                b = 0,
                                S = 0,
                                T = 1,
                                s = 1;
                            switch (f) {
                                case "left":
                                    break;
                                case "right":
                                    t.x += Q.width - Q.rw;
                                    break;
                                case "center":
                                    t.x += .5 * (Q.width - Q.rw);
                                    break;
                                case "scale":
                                case "leftright":
                                default:
                                    L = z(u, Dn) || 0, L && (b = Math.abs(S = Math.sin(L)), T = Math.abs(s = Math.cos(L))), "leftright" !== f ? (g += T * (Q.widthScale - 1), j += b * (Q.widthScale - 1)) : (g += t.width ? T * (Q.width - Q.rw) / t.width : 0, j += t.height ? b * (Q.width - Q.rw) / t.height : 0, o = -Math.min(-m.x * s + m.y * S, -m.x * s - (1 - m.y) * S, (1 - m.x) * s + m.y * S, (1 - m.x) * s - (1 - m.y) * S))
                            }
                            switch (d) {
                                case "top":
                                    break;
                                case "bottom":
                                    t.y += Q.height - Q.rh;
                                    break;
                                case "center":
                                    t.y += .5 * (Q.height - Q.rh);
                                    break;
                                case "scale":
                                case "topbottom":
                                default:
                                    L == h && (L = z(u, Dn), L && (b = Math.abs(S = Math.sin(L)), T = Math.abs(s = Math.cos(L)))), "topbottom" !== d ? (g += b * (Q.heightScale - 1), j += T * (Q.heightScale - 1)) : (g += t.width ? b * (Q.height - Q.rh) / t.width : 0, j += t.height ? T * (Q.height - Q.rh) / t.height : 0, K = -Math.min(-m.x * S - m.y * s, -m.x * S + (1 - m.y) * s, (1 - m.x) * S - m.y * s, (1 - m.x) * S + (1 - m.y) * s))
                            }
                            return (1 !== g || 1 !== j) && ("scale" !== f && f ? "leftright" === f && (t.x += t.width * (1 - g) * m.x + o * (Q.width - Q.rw)) : t.x += t.x * (Q.widthScale - 1) + m.x * t.width * (Q.widthScale - g), "scale" !== d && d ? "topbottom" === d && (t.y += t.height * (1 - j) * m.y + K * (Q.height - Q.rh)) : t.y += t.y * (Q.heightScale - 1) + m.y * t.height * (Q.heightScale - j), t.width *= g, t.height *= j), t.width < 0 && (t.width = 0), t.height < 0 && (t.height = 0), t
                        }
                    },
                    q = function (O) {
                        return nj(O) ? new vf(O) : O
                    },
                    G = function (V, l, J, o, L, I, T) {
                        var h = r.interactiveInfo,
                            O = V.transform;
                        if (O) return r.save(), r.setTransform(O.a, O.b, O.c, O.d, O.tx, O.ty), h && h.compInfos.push({
                            comp: V,
                            rect: l,
                            matrix: O.clone()
                        }), !0;
                        L === p && (L = 1), I === p && (I = 1);
                        var f = z(V, "clipPercentage"),
                            y = $f(J, l);
                        if (y && !o && 1 === L && 1 === I && !(1 > f)) return h && h.compInfos.push({
                            comp: V,
                            rect: l,
                            matrix: h.matrix.clone()
                        }), !1;
                        T = T || Un;
                        var P = l.x + l.width * T.x,
                            S = l.y + l.height * T.y,
                            R = J.x + J.width * T.x,
                            v = J.y + J.height * T.y,
                            Y = J.width ? L * (l.width / J.width) : 1,
                            K = J.height ? I * (l.height / J.height) : 1;
                        if (r.save(), h && (h.matrix.appendTranslate(P, S).appendRotate(o).appendScale(Y, K).appendTranslate(-R, -v), h.compInfos.push({
                                comp: V,
                                rect: l,
                                matrix: h.matrix.clone()
                            })), Aj(r, P, S), Zp(r, o || 0), rb(r, Y, K), Aj(r, -R, -v), 1 > f) {
                            0 > f && (f = 0);
                            var m = ep(J, z(V, "clipDirection"), f);
                            r.beginPath(), r.rect(m.x, m.y, m.width, m.height), r.clip()
                        }
                        return !0
                    },
                    V = function () {
                        r.restore()
                    },
                    i = function (u, x, Y) {
                        var d = z(u, "path"),
                            k = z(u, Dn),
                            N = z(u, "scaleX"),
                            L = z(u, "scaleY"),
                            W = O(u),
                            t = h,
                            w = Lf(null, d);
                        if (Y || (Y = u.unionRect, Y || (Y = Vj(w), u.path.func || (u.unionRect = Y)), t = Y), Y) {
                            t || (t = u.unionRect, t || (t = Vj(w), u.path.func || (u.unionRect = t)));
                            var E = G(u, Y, t, k, N, L, W),
                                i = z(u, "borderPattern"),
                                l = eb(r, i),
                                C = c(u, "background"),
                                D = c(u, "borderColor"),
                                P = z(u, "borderWidth"),
                                K = z(u, "gradient"),
                                U = c(u, "gradientColor"),
                                Z = z(u, "border3d"),
                                f = z(u, "border3dColor"),
                                s = z(u, "border3dAccuracy"),
                                H = r.lineJoin,
                                X = r.lineCap;
                            if (r.lineJoin = z(u, "borderJoin") || Wd, r.lineCap = z(u, "borderCap") || Lk, C ? (Mh(r, C, K, U, t), Lf(r, d), r.fill(), l !== r && Lf(r, d)) : Lf(r, d), P && D) {
                                var q = z(u, "borderWidthAbsolute");
                                q && (r.save(), r.setTransform(1, 0, 0, 1, 0, 0)), r.lineWidth = P, r.strokeStyle = D, r.stroke(), q && r.restore(), Z && Vm(r, D, f, P, n, s)
                            }
                            if (Bg(r, i), z(u, "dash")) {
                                var j = z(u, "dashWidth") || P;
                                if (j > 0) {
                                    i = z(u, "dashPattern") || Zg;
                                    var l = eb(r, i, z(u, "dashOffset")),
                                        e = c(u, "dashColor") || c(Kf);
                                    l !== r && Lf(r, d), r.strokeStyle = e, r.lineWidth = j, r.stroke(), z(u, "dash3d") && Vm(r, e, c(u, "dash3dColor"), j, n, z(u, "dash3dAccuracy")), Bg(r, i)
                                }
                            }
                            x === as && _j(r, C, z(u, "depth"), t), r.lineJoin = H, r.lineCap = X, E && V()
                        }
                    },
                    t = function (N, X, Z, R) {
                        var U = z(N, gs, k),
                            t = z(N, Dn),
                            L = O(N);
                        if (U && R.fitSize) {
                            var u = new vf,
                                o = Vj(U),
                                d = v(N, o, R),
                                w = o.x + L.x * o.width,
                                B = o.y + L.y * o.height,
                                i = d.x + L.x * d.width,
                                E = d.y + L.y * d.height,
                                b = o.width ? d.width / o.width : 1,
                                j = o.height ? d.height / o.height : 1;
                            U.each(function (y) {
                                u.add({
                                    x: i + (y.x - w) * b,
                                    y: E + (y.y - B) * j
                                })
                            }), U = u, N.unionRect = null
                        }
                        var e = z(N, "scaleX"),
                            M = z(N, "scaleY"),
                            Q = X === ef,
                            P = h;
                        if (!Z && Q && (Z = N.unionRect, Z || (Z = Vj(U), N.points.func || (N.unionRect = Z)), P = Z), Z) {
                            Q ? P || (P = N.unionRect, P || (P = Vj(U), N.points.func || (N.unionRect = P))) : P = Z;
                            var p, H, f, K, F = G(N, Z, P, t, e, M, L),
                                a = z(N, "borderPattern"),
                                W = eb(r, a),
                                $ = c(N, "background"),
                                I = Qn(z(N, "repeatImage"), C, T),
                                m = z(N, "gradientPack"),
                                Y = c(N, "borderColor"),
                                S = z(N, "borderWidth"),
                                l = z(N, "segments", q),
                                _ = z(N, "gradient"),
                                s = c(N, "gradientColor"),
                                J = z(N, "border3d"),
                                g = z(N, "border3dColor"),
                                y = z(N, "border3dAccuracy"),
                                x = z(N, "closePath"),
                                Zo = z(N, "fillRule") || "nonzero",
                                Jg = r.lineJoin,
                                yo = r.lineCap;
                            if (r.lineJoin = z(N, "borderJoin") || Wd, r.lineCap = z(N, "borderCap") || Lk, Q)
                                if ($ || I || m) {
                                    var Vq = z(N, "fillClipPercentage");
                                    if (1 > Vq) {
                                        0 > Vq && (Vq = 0);
                                        var yn = ep(P, z(N, "fillClipDirection"), Vq);
                                        r.save(), r.beginPath(), r.rect(yn.x, yn.y, yn.width, yn.height), r.clip()
                                    }
                                    if (Dl(r, U, l, x), m) Sc(r, m);
                                    else if (I) {
                                        var yl = r,
                                            jo = C,
                                            Cg = T;
                                        Rp(r, I, C, T, D, A), r = yl, C = jo, T = Cg
                                    } else {
                                        var yl = r;
                                        Mh(r, $, _, s, P), r = yl
                                    }
                                    r.fill(Zo), 1 > Vq && r.restore(), m && r.restore(), W !== r && Dl(W, U, l, x)
                                } else Dl(W, U, l, x);
                            else if ("roundRect" === X ? p = z(N, "cornerRadius") : "polygon" === X ? p = z(N, "polygonSide") : "arc" === X && (p = z(N, "arcFrom"), H = z(N, "arcTo"), f = z(N, "arcClose"), K = z(N, "arcOval")), $ || I || m) {
                                var Vq = z(N, "fillClipPercentage");
                                if (1 > Vq) {
                                    0 > Vq && (Vq = 0);
                                    var yn = ep(P, z(N, "fillClipDirection"), Vq);
                                    r.save(), r.beginPath(), r.rect(yn.x, yn.y, yn.width, yn.height), r.clip()
                                }
                                if (ge(r, X, P, p, H, f, K), m) Sc(r, m);
                                else if (I) {
                                    var yl = r,
                                        jo = C,
                                        Cg = T;
                                    Rp(r, I, C, T, D, A), r = yl, C = jo, T = Cg
                                } else Mh(r, $, _, s, P);
                                r.fill(Zo), 1 > Vq && r.restore(), m && r.restore(), r !== W && ge(W, X, P, p, H, f, K)
                            } else ge(W, X, P, p, H, f, K);
                            if (S && Y) {
                                var $h = z(N, "borderWidthAbsolute");
                                $h && (r.save(), r.setTransform(1, 0, 0, 1, 0, 0)), r.lineWidth = S, r.strokeStyle = Y, r.stroke(), $h && r.restore(), J && Vm(r, Y, g, S, n, y)
                            }
                            if (Bg(r, a), z(N, "dash")) {
                                var Oe = z(N, "dashWidth") || S;
                                if (Oe > 0) {
                                    a = z(N, "dashPattern") || Zg;
                                    var W = eb(r, a, z(N, "dashOffset")),
                                        Fd = c(N, "dashColor") || c(Kf);
                                    W !== r && (Q ? Dl(W, U, l, x) : ge(W, X, P, p, H, f, K)), r.strokeStyle = Fd, r.lineWidth = Oe, r.stroke(), z(N, "dash3d") && Vm(r, Fd, c(N, "dash3dColor"), Oe, n, z(N, "dash3dAccuracy")), Bg(r, a)
                                }
                            }
                            X === as && _j(r, $, z(N, "depth"), P), r.lineJoin = Jg, r.lineCap = yo, F && V()
                        }
                    },
                    l = function (L, J) {
                        var w = C,
                            s = T,
                            n = C || z(L, mf),
                            e = T || z(L, "blendMode"),
                            V = Qn(z(L, "name"), n, e);
                        V && (zk(r, V, z(L, "stretch"), J.x, J.y, J.width, J.height, D, A, n, null, e), C = w, T = s)
                    },
                    $ = function (y, J) {
                        var U = z(y, "text");
                        U != h && Yd(r, U, z(y, "font"), c(y, mf), J.x, J.y, J.width, J.height, z(y, "align"), z(y, "vAlign"))
                    },
                    U = function (s, S) {
                        Yq(r, c(s, mf), S.x, S.y, S.width, S.height, z(s, "width"))
                    },
                    g = function (N, i) {
                        var e = z(N, og),
                            X = 0;
                        if (e && (e.forEach(function (i) {
                                X += i
                            }), X > 0)) {
                            for (var P = z(N, "colors") || Jf, O = z(N, "startAngle") || 0, Q = z(N, "hollow"), U = z(N, Qk), s = z(N, Vi), q = z(N, kd), y = U ? new vf : h, Y = i.x, _ = i.y, I = i.width, f = i.height, l = Y + I / 2, W = _ + f / 2, M = j(I, f) / 2, K = 0, T = 0; T < e.length; T++) {
                                var B = e[T],
                                    d = E * B / X,
                                    c = O + d;
                                if (r.fillStyle = P[K++], K === P.length && (K = 0), r.beginPath(), Q) {
                                    var v = l + w(O) * M / 2,
                                        a = W + R(O) * M / 2,
                                        o = l + w(c) * M,
                                        n = W + R(c) * M;
                                    r.moveTo(v, a), r.arc(l, W, M / 2, O, c, !1), r.lineTo(o, n), r.arc(l, W, M, c, O, !0)
                                } else r.moveTo(l, W), r.arc(l, W, M, c, O, !0);
                                y && (d = (O + c) / 2, y.add({
                                    text: Yr(U) ? U(B, T, X, D) : B,
                                    x: l + .75 * w(d) * M,
                                    y: W + .75 * R(d) * M
                                })), r.closePath(), r.fill(), O = c
                            }
                            y && y.each(function ($) {
                                Yd(r, $.text, s, q, $.x, $.y, 0, 0, re)
                            })
                        }
                    },
                    N = function (o, S) {
                        var Z = z(o, Oh);
                        if (Z && Z.length > 0) {
                            var I = Z.length,
                                u = z(o, Qk),
                                n = z(o, Vi),
                                V = z(o, kd),
                                m = u ? new vf : h,
                                f = z(o, "minValue") || 0,
                                s = z(o, "maxValue");
                            if (s == h && (s = 0, Z.forEach(function (T) {
                                    z(T, og).forEach(function (A) {
                                        s = W(s, A)
                                    })
                                })), f === s) return;
                            for (var w = S.height / (s - f), l = S.y + s * w, H = z(Z[0], og).length, L = S.width / (3 * H + 1), K = 2 * L / I, q = 0, C = 0; I > C; C++)
                                for (var J = Z[C], k = z(J, mf), X = z(J, "colors"), M = z(J, og), $ = 0; H > $; $++) {
                                    X ? r.fillStyle = X[$] : k ? r.fillStyle = k : (r.fillStyle = Jf[q++], q === Jf.length && (q = 0));
                                    var N = M[$],
                                        d = N * w,
                                        b = S.x + (1 + 3 * $) * L + C * K;
                                    if (to(r, b, l - d, K, d), m) {
                                        var j = Yr(u) ? u(N, $, J, D) : N,
                                            p = Bk(n, j).height;
                                        m.add({
                                            x: b,
                                            y: l - d - p,
                                            width: K,
                                            height: p,
                                            text: j
                                        })
                                    }
                                }
                            m && m.each(function (s) {
                                Yd(r, s.text, n, V, s.x, s.y, s.width, s.height, re)
                            })
                        }
                    },
                    F = function (x, P) {
                        var B = z(x, Oh);
                        if (B && B.length > 0) {
                            var s = B.length,
                                a = z(B[0], og).length,
                                X = P.width / (3 * a + 1),
                                U = 0,
                                l = z(x, "maxValue"),
                                w = z(x, Qk),
                                O = z(x, Vi),
                                i = z(x, kd),
                                c = w ? new vf : h;
                            if (l == h) {
                                l = 0;
                                for (var K = 0; a > K; K++) {
                                    for (var d = 0, t = 0; s > t; t++) d += z(B[t], og)[K];
                                    l = W(l, d)
                                }
                            }
                            if (l > 0) {
                                for (var K = 0; a > K; K++)
                                    for (var k = P.y + P.height, t = 0; s > t; t++) {
                                        var E = B[t],
                                            j = z(E, mf),
                                            L = z(E, og)[K],
                                            v = L / l * P.height;
                                        j ? r.fillStyle = j : (r.fillStyle = Jf[U++], U === Jf.length && (U = 0)), k -= v;
                                        var $ = {
                                            x: P.x + (1 + 3 * K) * X,
                                            y: k,
                                            width: 2 * X,
                                            height: v
                                        };
                                        to(r, $.x, $.y, $.width, $.height), c && ($.text = Yr(w) ? w(L, K, E, D) : L, c.add($))
                                    }
                                c && c.each(function (g) {
                                    Yd(r, g.text, O, i, g.x, g.y, g.width, g.height, re)
                                })
                            }
                        }
                    },
                    K = function (U, R) {
                        var b = z(U, Oh);
                        if (b && b.length > 0) {
                            for (var G = b.length, y = z(b[0], og).length, f = R.width / (3 * y + 1), w = 0, W = z(U, Qk), n = z(U, Vi), F = z(U, kd), V = W ? new vf : h, C = 0; y > C; C++) {
                                for (var E = 0, d = 0; G > d; d++) E += z(b[d], og)[C];
                                if (E > 0) {
                                    var k = R.y + R.height;
                                    for (d = 0; G > d; d++) {
                                        var Q = b[d],
                                            g = z(Q, mf),
                                            _ = z(Q, og)[C],
                                            m = _ / E * R.height;
                                        g ? r.fillStyle = g : (r.fillStyle = Jf[w++], w === Jf.length && (w = 0)), k -= m;
                                        var e = {
                                            x: R.x + (1 + 3 * C) * f,
                                            y: k,
                                            width: 2 * f,
                                            height: m
                                        };
                                        to(r, e.x, e.y, e.width, e.height), V && (e.text = Yr(W) ? W(_, C, Q, D) : _, V.add(e))
                                    }
                                }
                            }
                            V && V.each(function (E) {
                                Yd(r, E.text, n, F, E.x, E.y, E.width, E.height, re)
                            })
                        }
                    },
                    Q = function (l, i) {
                        var S = z(l, Oh);
                        if (S && S.length > 0) {
                            var U = S.length,
                                m = z(l, "minValue") || 0,
                                N = z(l, "maxValue");
                            if (N == h && (N = 0, S.forEach(function (v) {
                                    z(v, og).forEach(function (P) {
                                        N = W(N, P)
                                    })
                                })), m === N) return;
                            for (var G = i.height / (N - m), A = i.y + N * G, B = z(S[0], og).length, $ = i.width / (3 * B + 1), y = 0, w = z(l, "lineWidth") || 2, R = z(l, "line3d"), Y = z(l, "linePoint"), s = z(l, Qk), x = z(l, Vi), M = z(l, kd), a = 0; U > a; a++) {
                                var g = S[a],
                                    L = z(g, mf),
                                    o = z(g, og);
                                L ? r.strokeStyle = L : (L = r.strokeStyle = Jf[y++], y === Jf.length && (y = 0)), r.beginPath();
                                for (var O = 0; B > O; O++) {
                                    var p = i.x + (2 + 3 * O) * $,
                                        _ = A - o[O] * G;
                                    0 === O ? r.moveTo(p, _) : r.lineTo(p, _)
                                }
                                if (r.lineWidth = w, r.stroke(), R && Vm(r, L, h, w, n), Y || s) {
                                    var v, P = w / 2 + 2;
                                    for (O = 0; B > O; O++) {
                                        var c = o[O];
                                        if (p = i.x + (2 + 3 * O) * $, _ = A - c * G, Yr(Y) ? Y(r, p, _, L, O, g, D) : Y && (r.fillStyle = L, r.beginPath(), r.arc(p, _, P, 0, E, !0), r.fill()), Yr(s) ? v = s(c, O, g, D) : s && (v = c), v) {
                                            var k = Bk(x, v).height,
                                                V = r.shadowBlur;
                                            if (V) {
                                                var f = r.shadowOffsetX,
                                                    e = r.shadowOffsetY,
                                                    J = r.shadowColor;
                                                r.shadowOffsetX = 0, r.shadowOffsetY = 0, r.shadowBlur = 0, r.shadowColor = h
                                            }
                                            Yd(r, v, x, M, p, _ - k - P + 2, 0, k, re), V && (r.shadowOffsetX = f, r.shadowOffsetY = e, r.shadowBlur = V, r.shadowColor = J)
                                        }
                                    }
                                }
                            }
                        }
                    },
                    S = function () {
                        r = null, D = null, A = null
                    },
                    x = {
                        border: U,
                        image: l,
                        text: $,
                        pieChart: g,
                        columnChart: N,
                        stackedColumnChart: F,
                        percentageColumnChart: K,
                        lineChart: Q
                    };
                return function (H, U, F, $, s, W, P, M, w, a) {
                    if (U && s && W) {
                        var J = r ? !1 : !0;
                        r = H, D = P, A = M, n = A ? A._zoom ? A._zoom : 1 : 1, C = w, T = a;
                        var N = s,
                            I = W;
                        if (Cl()) {
                            var R, o, j;
                            0 === r[pb] ? Cl[0] && (R = !0) : R = !0, r.texureImage2D ? Cl[1] && (o = !0) : o = !0, r.texureImage3D ? Cl[2] && (j = !0) : j = !0, R && o && j && (N = F, I = $)
                        }
                        if (U.tagName) return Qc(X) && !d[X] || r.drawImage(U, N, I, s, W), J && S(), void 0;
                        if (z(U, "visible") === !1) return J && S(), void 0;
                        C || (C = ze(U.color, D, A)), a || (T = ze(U.blendMode, D, A)), Qc(X) && !d[X] && (s = N, W = I);
                        var v = Df(U, D, A, s),
                            B = Dd(U, D, A, W),
                            g = {
                                x: 0,
                                y: 0,
                                width: v,
                                height: B,
                                fitSize: z(U, "fitSize")
                            },
                            l = z(U, "clip"),
                            Q = z(U, "opacity");
                        if (g.fitSize) {
                            var K = g.rw = ze(U.width, D, A) || 20;
                            g.widthScale = v / K;
                            var Y = g.rh = ze(U.height, D, A) || 20;
                            g.heightScale = B / Y
                        }
                        if (r.save(), r.interactiveInfo) {
                            var m = r.interactiveInfo.matrix,
                                e = m.clone();
                            m.appendTranslate(N, I).appendScale(s / v, W / B)
                        }
                        Aj(r, N, I), (v !== s || B !== W) && r.scale(s / v, W / B), l && (Yr(l) ? l(r, v, B, D, A, U) : (r.beginPath(), r.rect(0, 0, v, B), r.clip())), Q != h && (r.globalAlpha *= Q), z(U, "comps").forEach(function (E) {
                            if (z(E, Fm) !== !1) {
                                if (Pm.splice(0, 0, E), r.interactiveInfo) var L = r.interactiveInfo.matrix.clone();
                                var b = z(E, "opacity"),
                                    R = z(E, "shadow"),
                                    X = z(E, "type"),
                                    P = _(E, g);
                                if (b != h) {
                                    var d = r.globalAlpha;
                                    r.globalAlpha *= b
                                }
                                if (R) {
                                    var a = r.shadowOffsetX,
                                        j = r.shadowOffsetY,
                                        Q = r.shadowBlur,
                                        s = r.shadowColor,
                                        Z = z(E, "shadowOffsetX"),
                                        Y = z(E, "shadowOffsetY"),
                                        C = z(E, "shadowBlur"),
                                        e = c(E, "shadowColor");
                                    r.shadowOffsetX = (Z == h ? 3 : Z) * n, r.shadowOffsetY = (Y == h ? 3 : Y) * n, r.shadowBlur = (C == h ? 6 : C) * n, r.shadowColor = e || c(Zr)
                                }
                                if ("save" === X) r.save();
                                else if ("endClip" === X || "restore" === X) r.restore();
                                else if ("clip" === X) r.save(), Dl(r, z(E, "points", k), z(E, "segments", q), !0), r.clip();
                                else if (Fh[X]) P = P || {
                                        x: 0,
                                        y: 0,
                                        width: g.width,
                                        height: g.height
                                    }, t(E, X, P, g);
                                else if (X === ef) t(E, X, P, g);
                                else if ("SVGPath" === X) i(E, X, P);
                                else {
                                    P = P || {
                                            x: 0,
                                            y: 0,
                                            width: g.width,
                                            height: g.height
                                        };
                                    var B = z(E, Dn),
                                        K = z(E, "scaleX"),
                                        l = z(E, "scaleY"),
                                        J = O(E),
                                        S = G(E, P, P, B, K, l, J);
                                    if (Yr(X)) u(E, X), f.drawCompType(X, r, P, E, D, A);
                                    else if (f.getCompType(X)) {
                                        var m = f.getCompType(X),
                                            T = m.func || m;
                                        u(E, m), f.drawCompType(T, r, P, E, D, A)
                                    } else x[X] ? x[X](E, P) : f.getCompType(X) === p && Eq.test(X) && Ek(X);
                                    S && V()
                                }
                                R && (r.shadowOffsetX = a, r.shadowOffsetY = j, r.shadowBlur = Q, r.shadowColor = s), b != h && (r.globalAlpha = d), r.interactiveInfo && (r.interactiveInfo.matrix = L), Pm.splice(0, 1)
                            }
                        }), r.interactiveInfo && (r.interactiveInfo.matrix = e), r.restore(), J && S()
                    }
                }
            }();
        f.getCurrentComp = function () {
            return Pm[0]
        }, f.getParentComp = function () {
            return Pm[1]
        }, f.getInternal = function () {
            return {
                isEnter: gd,
                isEsc: fm,
                isSpace: Bo,
                isLeft: we,
                isUp: Ge,
                isRight: yf,
                isDown: Qg,
                addMethod: xr,
                superCall: cj,
                toPointsArray: fh,
                translateAndScale: Tm,
                appendArray: ug,
                createWorldMatrix: Kq,
                vec3TransformMat4: Br,
                setCanvas: mc,
                createDiv: rq,
                createView: xj,
                createCanvas: Np,
                createImage: Zn,
                initContext: Hf,
                layout: Qh,
                fillRect: to,
                Mat: xe,
                drawBorder: Yq,
                isString: Qc,
                setBorder: uk,
                getPropertyValue: nd,
                setPropertyValue: Qe,
                drawVerticalLine: hq,
                draw3DRect: _j,
                getPinchDist: ie,
                isSameRect: $f,
                getPosition: sj,
                intersectionLineRect: oq,
                getNodeRect: Ad,
                getEdgeAgentPosition: rg,
                getImageWidth: Df,
                getImageHeight: Dd,
                initItemElement: Yj,
                drawPoints: Dl,
                createG2: eb,
                closePopup: Nn,
                isH: Vl,
                createAnim: Gl,
                createNormalMatrix: mr,
                createNormals: Xp,
                toFloatArray: Se,
                glMV: hs,
                batchShape: sl,
                createNodeMatrix: zh,
                getFaceInfo: Nk,
                transformAppend: mj,
                drawFaceInfo: Fp,
                to3dPointsArray: rj,
                setGLDebugMode: function (e) {
                    wf = e
                },
                cube: function () {
                    return {
                        vs: Wi,
                        is: sp,
                        uv: mi
                    }
                },
                ui: function () {
                    return {
                        DataUI: bp,
                        NodeUI: fr,
                        EdgeUI: kf,
                        GroupUI: Oc,
                        ShapeUI: eg,
                        GridUI: Vq,
                        Data3dUI: Fn,
                        Node3dUI: Zj,
                        Shape3dUI: Yf
                    }
                },
                getInternalVersion: function () {
                    return "U2FsdGVkX18QuLM4DBFfBgKenTOFVYE5X1sYtpm5tr0="
                },
                getDragger: function () {
                    return wh
                },
                addMSMap: function (S) {
                    xr(Wm, S)
                },
                k: J
            }
        },
            function (u) {
                function $(r, m) {
                    r != h && (m == h && Rf != typeof r ? this._54O(r, 256) : this._54O(r, m))
                }

                function v() {
                    return new $(h)
                }

                function f(I, c, E, $, Y, R) {
                    for (; --R >= 0;) {
                        var K = c * this[I++] + E[$] + Y;
                        Y = e(K / 67108864), E[$++] = 67108863 & K
                    }
                    return Y
                }

                function L(L, Z, e, S, K, o) {
                    for (var U = 32767 & Z, b = Z >> 15; --o >= 0;) {
                        var Q = 32767 & this[L],
                            m = this[L++] >> 15,
                            f = b * Q + m * U;
                        Q = U * Q + ((32767 & f) << 15) + e[S] + (1073741823 & K), K = (Q >>> 30) + (f >>> 15) + b * m + (K >>> 30), e[S++] = 1073741823 & Q
                    }
                    return K
                }

                function H(m, J, H, Z, C, q) {
                    for (var E = 16383 & J, g = J >> 14; --q >= 0;) {
                        var t = 16383 & this[m],
                            O = this[m++] >> 14,
                            z = g * t + O * E;
                        t = E * t + ((16383 & z) << 14) + H[Z] + C, C = (t >> 28) + (z >> 14) + g * O, H[Z++] = 268435455 & t
                    }
                    return C
                }

                function p(y) {
                    return Dm.charAt(y)
                }

                function C(U, s) {
                    var z = Vk[U.charCodeAt(s)];
                    return z == h ? -1 : z
                }

                function o(l) {
                    for (var O = this.t - 1; O >= 0; --O) l[O] = this[O];
                    l.t = this.t, l.s = this.s
                }

                function V(W) {
                    this.t = 1, this.s = 0 > W ? -1 : 0, W > 0 ? this[0] = W : -1 > W ? this[0] = W + this.DV : this.t = 0
                }

                function M(b) {
                    var x = v();
                    return x._58O(b), x
                }

                function X(A, c) {
                    var j, g = this;
                    if (16 == c) j = 4;
                    else if (8 == c) j = 3;
                    else if (256 == c) j = 8;
                    else if (2 == c) j = 1;
                    else if (32 == c) j = 5;
                    else {
                        if (4 != c) return g.fromRadix(A, c), void 0;
                        j = 2
                    }
                    g.t = 0, g.s = 0;
                    for (var P = A.length, b = !1, S = 0; --P >= 0;) {
                        var T = 8 == j ? 255 & A[P] : C(A, P);
                        0 > T ? "-" == A.charAt(P) && (b = !0) : (b = !1, 0 == S ? g[g.t++] = T : S + j > g.DB ? (g[g.t - 1] |= (T & (1 << g.DB - S) - 1) << S, g[g.t++] = T >> g.DB - S) : g[g.t - 1] |= T << S, S += j, S >= g.DB && (S -= g.DB))
                    }
                    8 == j && 0 != (128 & A[0]) && (g.s = -1, S > 0 && (g[g.t - 1] |= (1 << g.DB - S) - 1 << S)), g._57O(), b && $.ZERO._78O(g, g)
                }

                function m() {
                    for (var q = this, h = q.s & q.DM; q.t > 0 && q[q.t - 1] == h;) --q.t
                }

                function Y(s) {
                    var u = this;
                    if (u.s < 0) return "-" + u._85O()[Yj](s);
                    var D;
                    if (16 == s) D = 4;
                    else if (8 == s) D = 3;
                    else if (2 == s) D = 1;
                    else if (32 == s) D = 5;
                    else {
                        if (4 != s) return u.toRadix(s);
                        D = 2
                    }
                    var T, Z = (1 << D) - 1,
                        h = !1,
                        B = "",
                        l = u.t,
                        N = u.DB - l * u.DB % D;
                    if (l-- > 0)
                        for (N < u.DB && (T = u[l] >> N) > 0 && (h = !0, B = p(T)); l >= 0;) D > N ? (T = (u[l] & (1 << N) - 1) << D - N, T |= u[--l] >> (N += u.DB - D)) : (T = u[l] >> (N -= D) & Z, 0 >= N && (N += u.DB, --l)), T > 0 && (h = !0), h && (B += p(T));
                    return h ? B : "0"
                }

                function n() {
                    var q = v();
                    return $.ZERO._78O(this, q), q
                }

                function b() {
                    return this.s < 0 ? this._85O() : this
                }

                function T(o) {
                    var h = this,
                        H = h.s - o.s;
                    if (0 != H) return H;
                    var Z = h.t;
                    if (H = Z - o.t, 0 != H) return h.s < 0 ? -H : H;
                    for (; --Z >= 0;)
                        if (0 != (H = h[Z] - o[Z])) return H;
                    return 0
                }

                function i(y) {
                    var e, _ = 1;
                    return 0 != (e = y >>> 16) && (y = e, _ += 16), 0 != (e = y >> 8) && (y = e, _ += 8), 0 != (e = y >> 4) && (y = e, _ += 4), 0 != (e = y >> 2) && (y = e, _ += 2), 0 != (e = y >> 1) && (y = e, _ += 1), _
                }

                function x() {
                    var R = this;
                    return R.t <= 0 ? 0 : R.DB * (R.t - 1) + i(R[R.t - 1] ^ R.s & R.DM)
                }

                function Q(n, E) {
                    var U;
                    for (U = this.t - 1; U >= 0; --U) E[U + n] = this[U];
                    for (U = n - 1; U >= 0; --U) E[U] = 0;
                    E.t = this.t + n, E.s = this.s
                }

                function K(E, I) {
                    for (var L = E; L < this.t; ++L) I[L - E] = this[L];
                    I.t = W(this.t - E, 0), I.s = this.s
                }

                function I(N, I) {
                    var p, v = this,
                        Q = N % v.DB,
                        L = v.DB - Q,
                        n = (1 << L) - 1,
                        B = e(N / v.DB),
                        H = v.s << Q & v.DM;
                    for (p = v.t - 1; p >= 0; --p) I[p + B + 1] = v[p] >> L | H, H = (v[p] & n) << Q;
                    for (p = B - 1; p >= 0; --p) I[p] = 0;
                    I[B] = H, I.t = v.t + B + 1, I.s = v.s, I._57O()
                }

                function g(t, W) {
                    var r = this;
                    W.s = r.s;
                    var f = e(t / r.DB);
                    if (f >= r.t) return W.t = 0, void 0;
                    var h = t % r.DB,
                        u = r.DB - h,
                        a = (1 << h) - 1;
                    W[0] = r[f] >> h;
                    for (var l = f + 1; l < r.t; ++l) W[l - f - 1] |= (r[l] & a) << u, W[l - f] = r[l] >> h;
                    h > 0 && (W[r.t - f - 1] |= (r.s & a) << u), W.t = r.t - f, W._57O()
                }

                function O(w, C) {
                    for (var s = this, J = 0, k = 0, P = j(w.t, s.t); P > J;) k += s[J] - w[J], C[J++] = k & s.DM, k >>= s.DB;
                    if (w.t < s.t) {
                        for (k -= w.s; J < s.t;) k += s[J], C[J++] = k & s.DM, k >>= s.DB;
                        k += s.s
                    } else {
                        for (k += s.s; J < w.t;) k -= w[J], C[J++] = k & s.DM, k >>= s.DB;
                        k -= w.s
                    }
                    C.s = 0 > k ? -1 : 0, -1 > k ? C[J++] = s.DV + k : k > 0 && (C[J++] = k), C.t = J, C._57O()
                }

                function t(h, M) {
                    var w = this.abs(),
                        i = h.abs(),
                        D = w.t;
                    for (M.t = D + i.t; --D >= 0;) M[D] = 0;
                    for (D = 0; D < i.t; ++D) M[D + w.t] = w.am(0, i[D], M, D, 0, w.t);
                    M.s = 0, M._57O(), this.s != h.s && $.ZERO._78O(M, M)
                }

                function d(V) {
                    for (var l = this.abs(), m = V.t = 2 * l.t; --m >= 0;) V[m] = 0;
                    for (m = 0; m < l.t - 1; ++m) {
                        var b = l.am(m, l[m], V, 2 * m, 0, 1);
                        (V[m + l.t] += l.am(m + 1, 2 * l[m], V, 2 * m + 1, b, l.t - m - 1)) >= l.DV && (V[m + l.t] -= l.DV, V[m + l.t + 1] = 1)
                    }
                    V.t > 0 && (V[V.t - 1] += l.am(m, l[m], V, 2 * m, 0, 1)), V.s = 0, V._57O()
                }

                function k(m, y, g) {
                    var L = m.abs(),
                        d = this;
                    if (!(L.t <= 0)) {
                        var U = d.abs();
                        if (U.t < L.t) return y != h && y._58O(0), g != h && d._77O(g), void 0;
                        g == h && (g = v());
                        var J = v(),
                            E = d.s,
                            j = m.s,
                            u = d.DB - i(L[L.t - 1]);
                        u > 0 ? (L._44O(u, J), U._44O(u, g)) : (L._77O(J), U._77O(g));
                        var w = J.t,
                            s = J[w - 1];
                        if (0 != s) {
                            var q = s * (1 << d.F1) + (w > 1 ? J[w - 2] >> d.F2 : 0),
                                F = d.FV / q,
                                k = (1 << d.F1) / q,
                                Y = 1 << d.F2,
                                c = g.t,
                                H = c - w,
                                z = y == h ? v() : y;
                            for (J._59O(H, z), g._52O(z) >= 0 && (g[g.t++] = 1, g._78O(z, g)), $.ONE._59O(w, z), z._78O(J, J); J.t < w;) J[J.t++] = 0;
                            for (; --H >= 0;) {
                                var x = g[--c] == s ? d.DM : e(g[c] * F + (g[c - 1] + Y) * k);
                                if ((g[c] += J.am(0, x, g, H, 0, w)) < x)
                                    for (J._59O(H, z), g._78O(z, g); g[c] < --x;) g._78O(z, g)
                            }
                            y != h && (g._45O(w, y), E != j && $.ZERO._78O(y, y)), g.t = w, g._57O(), u > 0 && g._46O(u, g), 0 > E && $.ZERO._78O(g, g)
                        }
                    }
                }

                function D(M) {
                    var Q = v();
                    return this.abs()._49O(M, h, Q), this.s < 0 && Q._52O($.ZERO) > 0 && M._78O(Q, Q), Q
                }

                function s(W) {
                    this.m = W
                }

                function r(o) {
                    return o.s < 0 || o._52O(this.m) >= 0 ? o.mod(this.m) : o
                }

                function F(b) {
                    return b
                }

                function S(p) {
                    p._49O(this.m, h, p)
                }

                function B(A, w, u) {
                    A._47O(w, u), this._74O(u)
                }

                function P(k, F) {
                    k._48O(F), this._74O(F)
                }

                function Z() {
                    if (this.t < 1) return 0;
                    var t = this[0];
                    if (0 == (1 & t)) return 0;
                    var U = 3 & t;
                    return U = 15 & U * (2 - (15 & t) * U), U = 255 & U * (2 - (255 & t) * U), U = 65535 & U * (2 - (65535 & (65535 & t) * U)), U = U * (2 - t * U % this.DV) % this.DV, U > 0 ? this.DV - U : -U
                }

                function c(H) {
                    var h = this;
                    h.m = H, h.mp = H._50O(), h.mpl = 32767 & h.mp, h.mph = h.mp >> 15, h.um = (1 << H.DB - 15) - 1, h.mt2 = 2 * H.t
                }

                function U(H) {
                    var s = v();
                    return H.abs()._59O(this.m.t, s), s._49O(this.m, h, s), H.s < 0 && s._52O($.ZERO) > 0 && this.m._78O(s, s), s
                }

                function a(L) {
                    var G = v();
                    return L._77O(G), this._74O(G), G
                }

                function q(B) {
                    for (var p = this; B.t <= p.mt2;) B[B.t++] = 0;
                    for (var U = 0; U < p.m.t; ++U) {
                        var L = 32767 & B[U],
                            u = L * p.mpl + ((L * p.mph + (B[U] >> 15) * p.mpl & p.um) << 15) & B.DM;
                        for (L = U + p.m.t, B[L] += p.m.am(0, u, B, U, 0, p.m.t); B[L] >= B.DV;) B[L] -= B.DV, B[++L]++
                    }
                    B._57O(), B._45O(p.m.t, B), B._52O(p.m) >= 0 && B._78O(p.m, B)
                }

                function ks(z, d) {
                    z._48O(d), this._74O(d)
                }

                function rd(s, z, c) {
                    s._47O(z, c), this._74O(c)
                }

                function kb() {
                    return 0 == (this.t > 0 ? 1 & this[0] : this.s)
                }

                function xl(L, t) {
                    if (L > 4294967295 || 1 > L) return $.ONE;
                    var d = v(),
                        F = v(),
                        y = t._73O(this),
                        m = i(L) - 1;
                    for (y._77O(d); --m >= 0;)
                        if (t._76O(d, F), (L & 1 << m) > 0) t._75O(F, y, d);
                        else {
                            var o = d;
                            d = F, F = o
                        }
                    return t.revert(d)
                }

                function zi(E, N) {
                    var o;
                    return o = 256 > E || N._51O() ? new s(N) : new c(N), this.exp(E, o)
                }

                function Yf() {
                    var c = this;
                    if (c.s < 0) {
                        if (1 == c.t) return c[0] - c.DV;
                        if (0 == c.t) return -1
                    } else {
                        if (1 == c.t) return c[0];
                        if (0 == c.t) return 0
                    }
                    return (c[1] & (1 << 32 - c.DB) - 1) << c.DB | c[0]
                }

                function dd(U, V) {
                    return new $(U, V)
                }

                function _j() {
                    var s = this;
                    s.n = h, s.e = 0, s.d = h, s.p = h, s.q = h, s.dmp1 = h, s.dmq1 = h, s._10A = h
                }

                function Kc(C) {
                    return C._53O(this.e, this.n)
                }

                function qp(a) {
                    var P, E, w, B = "",
                        R = 0;
                    for (P = 0; P < a.length && a.charAt(P) != mh; ++P) w = or.indexOf(a.charAt(P)), 0 > w || (0 == R ? (B += p(w >> 2), E = 3 & w, R = 1) : 1 == R ? (B += p(E << 2 | w >> 4), E = 15 & w, R = 2) : 2 == R ? (B += p(E), B += p(w >> 2), E = 3 & w, R = 3) : (B += p(E << 2 | w >> 4), B += p(15 & w), R = 0));
                    return 1 == R && (B += p(E << 2)), B
                }

                function Oe(_) {
                    var h = _.split(""),
                        m = qp(_);
                    return h.forEach(function (V) {
                        var e = V.length;
                        e > 0 && m && (Nf += A(V))
                    }), m
                }

                function Zc(f, D) {
                    var r = Pe._4O.Util._56O(f, "ss"),
                        U = {},
                        g = 0;
                    return U.v = r == D, U.t = 1, U.s = 0 > g ? -1 : 0, dl = U.v, g > 0 ? U[0] = g : -1 > g ? U[0] = g + U.DV : U.t = 0, [r, U]
                }

                function qf(m) {
                    var s = 38,
                        L = m.substring(0, s);
                    if (L && 30 == L.indexOf("05000420")) {
                        var F = ["ss", m.substring(s)];
                        return F
                    }
                    return []
                }

                function Tf(z, Z) {
                    Z = Z.replace(hf, ""), Z = Z.replace(/[ \n]+/g, "");
                    var s = dd(Z, 16);
                    if (s._55O() > this.n._55O()) return 0;
                    var y = this._37O(s),
                        q = y[Yj](16).replace(/^1f+00/, ""),
                        T = qf(q);
                    if (0 == T.length) return !1;
                    for (var v, U, d, V = .5, f = Sp, O = [0, .5, .75, .875, .9375], n = [], P = [], b = [], k = E / f, A = T[1], m = Zc(z, A)[0], h = 0, p = 0; h < O.length; h++) {
                        var u = 0 === h % 2 ? 0 : .5;
                        for (v = 0; f >= v; v++) U = (v + u) * k, d = 1 - O[h], n.push(w(U) * V * d, -V + 2 * O[h] * V, -R(U) * V * d), P.push((v + u) / f, d)
                    }
                    for (h = 0; h < O.length - 1; h++) {
                        var r = h * (f + 1),
                            K = (h + 1) * (f + 1);
                        for (v = 0; f > v; v++) b.push(r + v, K + v + 1, K + v, r + v, r + v + 1, K + v + 1)
                    }
                    return b.forEach(function (n) {
                        p += n
                    }), A == m && p > 10
                }
                var Yl, Ge = 0xdeadbeefcafe,
                    Ur = 15715070 == (16777215 & Ge),
                    Yj = "toString",
                    ce = "",
                    ko = "nat",
                    jl = function () {};
                z = u["D" + 11182[Yj](y(2, 5))];
                var Gd = $.prototype;
                ob += _d.substr(0, 1);
                var th = u.navigator ? u.navigator.appName : "";
                Ur && "Microsoft Internet Explorer" == th ? (Gd.am = L, Yl = 30) : Ur && "Netscape" != th ? (Gd.am = f, Yl = 26) : (Gd.am = H, Yl = 28), Gd.DB = Yl, Gd.DM = (1 << Yl) - 1, Gd.DV = 1 << Yl;
                var Pg = 52;
                Gd.FV = y(2, Pg), Gd.F1 = Pg - Yl, Gd.F2 = 2 * Yl - Pg;
                var Zo, Uq, Dm = "0123456789abcdefghijklmnopqrstuvwxyz",
                    Vk = [],
                    np = function (k) {
                        return String.fromCharCode(k)
                    };
                for (Zo = "0".charCodeAt(0), Uq = 0; 9 >= Uq; ++Uq) Vk[Zo++] = Uq;
                for (Zo = "a".charCodeAt(0), Uq = 10; 36 > Uq; ++Uq) Vk[Zo++] = Uq;
                for (Zo = "A".charCodeAt(0), Uq = 10; 36 > Uq; ++Uq) Vk[Zo++] = Uq;
                var ms = s.prototype;
                ms._73O = r, ms.revert = F, ms._74O = S, ms._75O = B, ms._76O = P;
                var fm = c.prototype;
                fm._73O = U, fm.revert = a, fm._74O = q, fm._75O = rd, fm._76O = ks, Gd._77O = o, Gd._58O = V, Gd._54O = X, Gd._57O = m, Gd._59O = Q, Gd._45O = K, Gd._44O = I, Gd._46O = g, Gd._78O = O, Gd._47O = t, Gd._48O = d, Gd._49O = k, Gd._50O = Z, Gd._51O = kb, Gd.exp = xl, Gd.toString = Y, Gd._85O = n, Gd.abs = b, Gd._52O = T, Gd._55O = x, Gd.mod = D, Gd._53O = zi, $.ZERO = M(0), $.ONE = M(1), Gd._86O = Yf;
                var Rc = function (t, i) {
                    var k = this;
                    k.isPublic = !0, typeof t !== Rf ? (k.n = t, k.e = i) : t != h && i != h && t.length > 0 && i.length > 0 && (k.n = dd(t, 16), k.e = A(i, 16))
                };
                rk = function () {
                    var W, I, b = Oe(Qk),
                        D = b.substr(0, 4),
                        H = b.substr(4, 2),
                        E = b.substr(6, 2),
                        R = 1,
                        C = !R,
                        q = J,
                        a = [],
                        u = Mr.charAt(7);
                    if (z && (z[Yj]().indexOf(ko) < 0 || z[ob][Yj]().indexOf(ko) < 0 || !b ? W = So(Ep[u]) : (b = new z(D - 0, H - R, E - 0), I = b.setHours(9), z[ob]() > I ? W = So(Ep[u]) : C = !0)), b && W && q) {
                        for (var m in W) a.push(m);
                        var y, l = 0,
                            K = W[a[l++]],
                            A = W[a[l++]],
                            Y = W[a[l++]],
                            V = W[a[l++]],
                            x = W[a[l++]],
                            Q = W[a[l++]],
                            e = W[a[l++]],
                            X = iq._27O(q);
                        if (X && e) {
                            y = K + A + Y + V + x + Q;
                            var r = !Q || Q === nq;
                            if (!r && Q)
                                for (var S, Z = 0, N = Q.length; N > Z; Z++) Q[Z] === Wq[l] ? S === nq ? r = !0 : S = h : (S == h ? S = Q[Z] : S += Q[Z], Z === N - 1 && S === nq && (r = !0));
                            y && X._31O(y, e) && r && (!x || z[ob]() < x) && (C = !0)
                        }
                    }
                    return C || (ge = ji), u
                };
                var ue = _j.prototype;
                ue._37O = Kc, ue._38O = Rc;
                var or = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",
                    mh = "=",
                    fg = 25,
                    il = 10,
                    Qk = "IBkig===",
                    Sr = Sr || function ($, k) {
                            var b = {},
                                D = b._7A = {},
                                x = D._6A = function () {
                                    function q() {}
                                    return {
                                        _80O: function (I) {
                                            q.prototype = this;
                                            var h = new q;
                                            return I && h._5A(I), h.hasOwnProperty("_82O") || (h._82O = function () {
                                                h.$super._82O.apply(this, arguments)
                                            }), h._82O.prototype = h, h.$super = this, h
                                        },
                                        _3A: function () {
                                            var H = this._80O();
                                            return H._82O.apply(H, arguments), H
                                        },
                                        _82O: function () {},
                                        _5A: function (e) {
                                            for (var M in e) e.hasOwnProperty(M) && (this[M] = e[M]);
                                            e.hasOwnProperty(Yj) && (this.toString = e.toString)
                                        },
                                        _88O: function () {
                                            return this._82O.prototype._80O(this)
                                        }
                                    }
                                }(),
                                E = D._39O = x._80O({
                                    _82O: function (R, X) {
                                        R = this._84O = R || [], this._65O = X != k ? X : 4 * R.length
                                    },
                                    toString: function (x) {
                                        return (x || F).stringify(this)
                                    },
                                    _89O: function (k) {
                                        var S = this._84O,
                                            o = k._84O,
                                            i = this._65O,
                                            U = k._65O;
                                        if (this._57O(), i % 4)
                                            for (var b = 0; U > b; b++) {
                                                var x = 255 & o[b >>> 2] >>> 24 - 8 * (b % 4);
                                                S[i + b >>> 2] |= x << 24 - 8 * ((i + b) % 4)
                                            } else if (o.length > 65535)
                                            for (var b = 0; U > b; b += 4) S[i + b >>> 2] = o[b >>> 2];
                                        else S.push.apply(S, o);
                                        return this._65O += U, this
                                    },
                                    _57O: function () {
                                        var t = this._84O,
                                            j = this._65O;
                                        t[j >>> 2] &= 4294967295 << 32 - 8 * (j % 4), t.length = _(j / 4)
                                    },
                                    _88O: function () {
                                        var R = x._88O.call(this);
                                        return R._84O = this._84O.slice(0), R
                                    },
                                    _87O: function (f) {
                                        for (var m = [], M = 0; f > M; M += 4) m.push(0 | 4294967296 * G);
                                        return new E._82O(m, f)
                                    }
                                }),
                                U = b._2A = {},
                                F = U._69O = {
                                    stringify: function (X) {
                                        var l, h = X._84O,
                                            H = X._65O,
                                            S = [];
                                        for (l = 0; H > l; l++) {
                                            var O = 255 & h[l >>> 2] >>> 24 - 8 * (l % 4);
                                            S.push((O >>> 4).toString(16)), S.push((15 & O).toString(16))
                                        }
                                        return S.join("")
                                    },
                                    _68O: function (J) {
                                        for (var W = J.length, G = [], X = 0; W > X; X += 2) G[X >>> 3] |= A(J.substr(X, 2), 16) << 24 - 4 * (X % 8);
                                        return new E._82O(G, W / 2)
                                    }
                                },
                                I = U._8A = {
                                    stringify: function (z) {
                                        var W, v = z._84O,
                                            F = z._65O,
                                            G = [];
                                        for (W = 0; F > W; W++) {
                                            var P = 255 & v[W >>> 2] >>> 24 - 8 * (W % 4);
                                            G.push(np(P))
                                        }
                                        return G.join("")
                                    },
                                    _68O: function (J) {
                                        var A, e = J.length,
                                            j = [];
                                        for (A = 0; e > A; A++) j[A >>> 2] |= (255 & J.charCodeAt(A)) << 24 - 8 * (A % 4);
                                        return new E._82O(j, e)
                                    }
                                },
                                u = U._9A = {
                                    stringify: function (j) {
                                        try {
                                            return decodeURIComponent(escape(I.stringify(j)))
                                        } catch (Q) {
                                            throw new Error("")
                                        }
                                    },
                                    _68O: function (j) {
                                        return I._68O(unescape(encodeURIComponent(j)))
                                    }
                                },
                                e = D._32O = x._80O({
                                    _1A: function () {
                                        this._83O = new E._82O, this._23O = 0
                                    },
                                    _33O: function (y) {
                                        typeof y == Rf && (y = u._68O(y)), this._83O._89O(y), this._23O += y._65O
                                    },
                                    _25O: function (c) {
                                        var v = this._83O,
                                            p = v._84O,
                                            S = v._65O,
                                            q = this._79O,
                                            R = 4 * q,
                                            w = S / R;
                                        w = c ? _(w) : W((0 | w) - this._22O, 0);
                                        var P = w * q,
                                            z = j(4 * P, S);
                                        if (P) {
                                            for (var h = 0; P > h; h += q) this._20O(p, h);
                                            var e = p.splice(0, P);
                                            v._65O -= z
                                        }
                                        return new E._82O(e, z)
                                    },
                                    _88O: function () {
                                        var u = x._88O.call(this);
                                        return u._83O = this._83O._88O(), u
                                    },
                                    _22O: 0
                                });
                            D._66O = e._80O({
                                cfg: x._80O(),
                                _82O: function (M) {
                                    this.cfg = this.cfg._80O(M), this._1A()
                                },
                                _1A: function () {
                                    e._1A.call(this), this._34O()
                                },
                                _81O: function (h) {
                                    return this._33O(h), this._25O(), this
                                },
                                _72O: function (C) {
                                    C && this._33O(C);
                                    var r = this._21O();
                                    return r
                                },
                                _79O: 16,
                                _26O: function (Q) {
                                    return function (W, X) {
                                        return new Q._82O(X)._72O(W)
                                    }
                                },
                                _19O: function (G) {
                                    return function (l, r) {
                                        return new s._71O._82O(G, r)._72O(l)
                                    }
                                }
                            });
                            var s = b._67O = {};
                            return b
                        }();
                ! function () {
                    var S = Sr,
                        I = S._7A,
                        _ = I._39O,
                        u = I._66O,
                        t = S._67O,
                        Y = [],
                        A = [];
                    ! function () {
                        function e(o) {
                            for (var w = l(o), I = 2; w >= I; I++)
                                if (!(o % I)) return !1;
                            return !0
                        }

                        function n(k) {
                            return 0 | 4294967296 * (k - (0 | k))
                        }
                        for (var g = 2, z = 0; 64 > z;) e(g) && (8 > z && (Y[z] = n(y(g, .5))), A[z] = n(y(g, 1 / 3)), z++), g++
                    }();
                    var x = [],
                        K = t._41O = u._80O({
                            _34O: function () {
                                this._64O = new _._82O(Y.slice(0))
                            },
                            _20O: function (f, u) {
                                for (var s = this._64O._84O, R = s[0], p = s[1], i = s[2], P = s[3], g = s[4], G = s[5], L = s[6], W = s[7], m = 0; 64 > m; m++) {
                                    if (16 > m) x[m] = 0 | f[u + m];
                                    else {
                                        var B = x[m - 15],
                                            T = (B << 25 | B >>> 7) ^ (B << 14 | B >>> 18) ^ B >>> 3,
                                            w = x[m - 2],
                                            E = (w << 15 | w >>> 17) ^ (w << 13 | w >>> 19) ^ w >>> 10;
                                        x[m] = T + x[m - 7] + E + x[m - 16]
                                    }
                                    var b = g & G ^ ~g & L,
                                        q = R & p ^ R & i ^ p & i,
                                        $ = (R << 30 | R >>> 2) ^ (R << 19 | R >>> 13) ^ (R << 10 | R >>> 22),
                                        N = (g << 26 | g >>> 6) ^ (g << 21 | g >>> 11) ^ (g << 7 | g >>> 25),
                                        Y = W + N + b + A[m] + x[m],
                                        C = $ + q;
                                    W = L, L = G, G = g, g = 0 | P + Y, P = i, i = p, p = R, R = 0 | Y + C
                                }
                                s[0] = 0 | s[0] + R, s[1] = 0 | s[1] + p, s[2] = 0 | s[2] + i, s[3] = 0 | s[3] + P, s[4] = 0 | s[4] + g, s[5] = 0 | s[5] + G, s[6] = 0 | s[6] + L, s[7] = 0 | s[7] + W
                            },
                            _21O: function () {
                                var W = this._83O,
                                    U = W._84O,
                                    H = 8 * this._23O,
                                    k = 8 * W._65O;
                                return U[k >>> 5] |= 128 << 24 - k % 32, U[(k + 64 >>> 9 << 4) + 14] = e(H / 4294967296), U[(k + 64 >>> 9 << 4) + 15] = H, W._65O = 4 * U.length, this._25O(), this._64O
                            },
                            _88O: function () {
                                var s = u._88O.call(this);
                                return s._64O = this._64O._88O(), s
                            }
                        });
                    S._41O = u._26O(K), S._42O = u._19O(K)
                }();
                var hf = new RegExp("");
                hf.compile("[^0-9a-f]", "gi"), _j._28O = -1, _j._29O = -2, ue._31O = Tf, ue._63O = Tf, _j._43O = -2;
                var Sk = new function () {
                    var d = this;
                    d._5O = function (H, f) {
                        if ("8" != H.substring(f + 2, f + 3)) return 1;
                        var r = A(H.substring(f + 3, f + 4));
                        return 0 == r ? -1 : r > 0 && 10 > r ? r + 1 : -2
                    }, d._13O = function (F, o) {
                        var T = d._5O(F, o);
                        return 1 > T ? "" : F.substring(o + 2, o + 2 + 2 * T)
                    }, d._12O = function (o, F) {
                        var w = d._13O(o, F);
                        if ("" == w) return -1;
                        var B;
                        return B = A(w.substring(0, 1)) < 8 ? new $(w, 16) : new $(w.substring(2), 16), B._86O()
                    }, d._6O = function (l, r) {
                        var J = d._5O(l, r);
                        return 0 > J ? J : r + 2 * (J + 1)
                    }, d._11O = function (x, e) {
                        var J = d._6O(x, e),
                            U = d._12O(x, e);
                        return x.substring(J, J + 2 * U)
                    }, d._10O = function (k, q) {
                        var n = d._6O(k, q),
                            c = d._12O(k, q);
                        return n + 2 * c
                    }, d._7O = function (K, c) {
                        var R = [],
                            I = d._6O(K, c);
                        R.push(I);
                        for (var e = d._12O(K, c), j = I, S = 0;;) {
                            var y = d._10O(K, j);
                            if (y == h || y - I >= 2 * e) break;
                            if (S >= 200) break;
                            R.push(y), j = y, S++
                        }
                        return R
                    }
                };
                if (Sk._90O = np(il + 24), Sk._91O = N + np(il * il + 8), Pe == h || !Pe) var Pe = {};
                Pe._4O != h && Pe._4O || (Pe._4O = {});
                var pq = Pe._4O;
                Pe._4O.Util = new function () {
                    var l = this;
                    l._56O = function (C) {
                        var s = new Pe._4O._3O;
                        return s._30O(C)
                    }, l._4A = function (r) {
                        var j = new Pe._4O._3O;
                        return j._36O(r)
                    }, l._11A = function (m) {
                        var P = new pq._3O;
                        return P._30O(m)
                    }
                }, Pe._4O._3O = function () {
                    var B = this;
                    B._8O = function (T, H) {
                        if ("ss" == T && "cj" == H) {
                            try {
                                B.md = Sr._67O._41O._3A()
                            } catch (o) {
                                jl(ce)
                            }
                            B._24O = function (W) {
                                B.md._81O(W)
                            }, B._35O = function (W) {
                                var G = Sr._2A._69O._68O(W);
                                B.md._81O(G)
                            }, B._60O = function () {
                                var K = B.md._72O();
                                return K[Yj](Sr._2A._69O)
                            }, B._30O = function (A) {
                                return B._24O(A), B._60O()
                            }, B._36O = function (y) {
                                return B._35O(y), B._60O()
                            }
                        }
                    }, B._24O = function () {
                        jl(ce)
                    }, B._35O = function () {
                        jl(ce)
                    }, B._60O = function () {
                        jl(ce)
                    }, B._30O = function () {
                        jl(ce)
                    }, B._36O = function () {
                        jl(ce)
                    }, B._8O("ss", "cj")
                }, yk = function (J) {
                    var d = Xi[vp[7]],
                        g = 1,
                        C = !1;
                    if (ph.a != Xi[Nh]) return ph.a;
                    if (ph.forEach(function (X) {
                            g *= X
                        }), J > g) {
                        if (d) {
                            d = d.split(Sk._90O);
                            var t = d[3],
                                j = d[7],
                                T = d[11],
                                y = d[15],
                                s = d[19],
                                Y = d[23],
                                D = d[27],
                                f = t + j + T + y + s + Y,
                                v = Y ? !1 : !0;
                            if (Y) {
                                var V = Y && Y.split(io("firefox")[3]);
                                if (V)
                                    for (var M = 0; M < V.length; M++)
                                        if (oe.indexOf(V[M]) >= 0) {
                                            v = !0;
                                            break
                                        }
                            }
                            C = No()(f, D) && v && (!s || s > J)
                        }
                        C || (bp.prototype._42 = Re)
                    } else C = !0;
                    return ph.a = C, C
                }, fg = String.fromCharCode(fg + 20);
                var nm = function (K) {
                        return K = K.replace(hf, ce), K = K.replace(/[ \n]+/g, ce)
                    },
                    Lp = "30",
                    df = "06",
                    Bj = "02",
                    ie = "03",
                    tp = dd,
                    Rl = /^1f+00/,
                    iq = function () {
                        var k;
                        return k = {
                            _18O: function (x) {
                                var W = x,
                                    h = W.replace(/\s+/g, ""),
                                    P = qp(h);
                                return P
                            },
                            _14O: function (e) {
                                var X = this._18O(e),
                                    G = this._15O(X);
                                return G
                            },
                            _15O: function (g) {
                                var f = this._17O(g);
                                if ("2a864886f70d010101" == f._61O) {
                                    var E = this._16O(f.key),
                                        U = new _j;
                                    return U._38O(E.n, E.e), U
                                }
                                jl(ce)
                            },
                            _16O: function (S) {
                                var U = {};
                                S.substr(0, 2) != Lp && jl(ce);
                                var r = Sk._7O(S, 0);
                                return 2 != r.length && jl(ce), S.substr(r[0], 2) != Bj && jl(ce), U.n = Sk._11O(S, r[0]), S.substr(r[1], 2) != Bj && jl(ce), U.e = Sk._11O(S, r[1]), U
                            },
                            _17O: function (t) {
                                var R = {};
                                R._40O = h;
                                var p = Sk._7O(t, 0);
                                2 != p.length && jl(ce);
                                var V = p[0];
                                t.substr(V, 2) != Lp && jl(ce);
                                var X = Sk._7O(t, V);
                                return 2 != X.length && jl(ce), t.substr(X[0], 2) != df && jl(ce), R._61O = Sk._11O(t, X[0]), t.substr(X[1], 2) == df ? R._40O = Sk._11O(t, X[1]) : t.substr(X[1], 2) == Lp && (R._40O = {}, R._40O.p = Sk._70O(t, X[1], [0], Bj), R._40O.q = Sk._70O(t, X[1], [1], Bj), R._40O.g = Sk._70O(t, X[1], [2], Bj)), t.substr(p[1], 2) != ie && jl(ce), R.key = Sk._11O(t, p[1]).substr(2), R
                            }
                        }, k._17O ? k : h
                    }(),
                    Af = iq._27O = function (m) {
                        return iq._14O(m)
                    };
                No = function () {
                    return function (j, z) {
                        if (j && z) {
                            z = nm(z);
                            var F = tp(z, y(2, 4)),
                                $ = this;
                            if (!$ || !$.n || F._55O() > $.n._55O()) return 0;
                            var T = $._37O(F),
                                Y = T[Yj](y(2, 4)).replace(Rl, ""),
                                s = qf(Y);
                            if (0 == s.length) return !1;
                            var r = s[0],
                                I = s[1],
                                o = function (o) {
                                    return Pe._4O.Util._56O(o, r)
                                },
                                D = o(j);
                            return I == D
                        }
                    }.bind(Af(J))
                };
                var Fb, Dp;
                return function () {
                    var w = de.length - gf.length;
                    if (w > 0)
                        for (var Q = 0; w > Q; Q++) Fb = pq.Util, Dp = nm
                }(), Ij = function (V, R) {
                    R = Dp(R);
                    var t = Af(Cd),
                        d = Do.length,
                        G = 2 * d,
                        f = tp(R, y(d, G)),
                        h = t,
                        m = !0;
                    if (h) {
                        var J = h[Tr[0]];
                        J && f._55O() <= J._55O() && (m = !1)
                    }
                    if (m) return 0;
                    var D = h._37O(f),
                        s = D[Yj](y(d, G)).replace(Rl, ""),
                        q = qf(s);
                    if (0 == q.length) return !1;
                    var W = q[0],
                        I = q[1],
                        r = Fb._11A(V, W);
                    return I == r
                }, iq
            }(d, x), xr(f, {
            load: function () {
                var K = {},
                    b = function (P) {
                        return P ? "c_" + (P.sync ? "1" : "0") + "_" + (P.post ? "1" : "0") + "_" + (P.responseType || "H") + "_" + (P.mimeType || "H") + "_" + (P.data ? JSON.stringify(P.data) : "H") : ""
                    };
                return function (t, A, s) {
                    var Y, h = K[t],
                        x = b(s);
                    return h && (Y = h[x]) ? (Y.push(A), void 0) : (K[t] || (h = K[t] = {
                        count: 0
                    }), Y = h[x] = [A], h.count++, f.xhrLoad(t, function (A) {
                        delete h[x], h.count--, h.count || delete K[t], Y.forEach(function (l) {
                            l(A)
                        })
                    }, s), void 0)
                }
            }(),
            asyncEach: function (s, d, f) {
                "function" != typeof f && (f = Function.prototype);
                var S = new Array(s.length),
                    z = 0,
                    y = !1;
                s.forEach(function (t, D) {
                    d(t, function (k, Q) {
                        return y ? void 0 : k ? (y = !0, f(null)) : (S[D] = Q, z++, z === s.length ? f(S) : void 0)
                    })
                })
            },
            xhrLoad: function (S, a, x) {
                var C = !1;
                nj(S) || (C = !0, S = [S]), x = x || {}, S.length;
                var J = x.sync,
                    V = !!x.post,
                    Z = null;
                return f.asyncEach(S, function (X, C) {
                    var G = new ne;
                    X = f.beforeLoadURL(X), X.data ? C(null, X.data) : (x.url = encodeURI(X), x.method = V ? "POST" : "GET", x.responseType ? G.setResponseType(x.responseType) : G.setOverrideMimeType(x.mimeType || "text/plain"), G.onload = function () {
                        200 === this.status || 0 === this.status ? C(null, G.getResponseText()) : C(!0)
                    }, G.onerror = function () {
                        C(!0)
                    }, G.send(x))
                }, function (c) {
                    var T = "function" == typeof a;
                    (T || J) && (Z = C && c ? c[0] : c, T && a(Z))
                }), J ? Z : void 0
            }
        }), Math.sign === p && (Math.sign = function (G) {
            return 0 > G ? -1 : G > 0 ? 1 : +G
        }), k.Math = {
            generateUUID: function () {
                for (var v = [], G = 0; 256 > G; G++) v[G] = (16 > G ? "0" : "") + G.toString(16).toUpperCase();
                return function () {
                    var h = 0 | 4294967295 * Math.random(),
                        A = 0 | 4294967295 * Math.random(),
                        Y = 0 | 4294967295 * Math.random(),
                        P = 0 | 4294967295 * Math.random();
                    return v[255 & h] + v[255 & h >> 8] + v[255 & h >> 16] + v[255 & h >> 24] + "-" + v[255 & A] + v[255 & A >> 8] + "-" + v[64 | 15 & A >> 16] + v[255 & A >> 24] + "-" + v[128 | 63 & Y] + v[255 & Y >> 8] + "-" + v[255 & Y >> 16] + v[255 & Y >> 24] + v[255 & P] + v[255 & P >> 8] + v[255 & P >> 16] + v[255 & P >> 24]
                }
            }(),
            clamp: function (r, d, k) {
                return Math.max(d, Math.min(k, r))
            },
            generateIncreasingID: function () {
                var q = 0;
                return function () {
                    return ++q
                }
            }()
        };
        var yg = k.Matrix = k.Math.Matrix2d = function (H, h, Y, B, g) {
                this.setFromTransform(H, h, Y, B, g)
            },
            xe = yg;
        yg.prototype = {}, yg.prototype.constructor = yg, yg.prototype.set = function (C, c, P, R, L, Y) {
            return this.a = C, this.b = c, this.c = P, this.d = R, this.tx = L, this.ty = Y, this
        }, yg.prototype.setFromTransform = function (B, N, O, Q, n) {
            var T = this;
            if (B === p) return T.a = 1, T.b = 0, T.c = 0, T.d = 1, T.tx = 0, T.ty = 0, void 0;
            B = B || 0;
            var M = R(B),
                l = w(B);
            return Q = Q || 1, n = n || 1, T.a = l * Q, T.b = M * Q, T.c = -M * n, T.d = l * n, T.tx = N || 0, T.ty = O || 0, T
        }, yg.prototype.apply = function (I, K) {
            K = K || new Pi;
            var h = I.x,
                z = I.y;
            return K.x = this.a * h + this.c * z + this.tx, K.y = this.b * h + this.d * z + this.ty, K
        }, yg.prototype.applyInverse = function (A, q) {
            q = q || new Pi;
            var E = 1 / (this.a * this.d + this.c * -this.b),
                T = A.x,
                n = A.y;
            return q.x = this.d * E * T + -this.c * E * n + (this.ty * this.c - this.tx * this.d) * E, q.y = this.a * E * n + -this.b * E * T + (-this.ty * this.a + this.tx * this.b) * E, q
        }, yg.prototype.translate = function (Q, K) {
            return this.tx += Q, this.ty += K, this
        }, yg.prototype.scale = function (c, v) {
            return this.a *= c, this.d *= v, this.c *= c, this.b *= v, this.tx *= c, this.ty *= v, this
        }, yg.prototype.rotate = function (C) {
            var N = Math.cos(C),
                F = Math.sin(C),
                A = this.a,
                p = this.c,
                r = this.tx;
            return this.a = A * N - this.b * F, this.b = A * F + this.b * N, this.c = p * N - this.d * F, this.d = p * F + this.d * N, this.tx = r * N - this.ty * F, this.ty = r * F + this.ty * N, this
        }, yg.prototype.appendTranslate = function (h, d) {
            return this.tx += this.a * h + this.c * d, this.ty += this.b * h + this.d * d, this
        }, yg.prototype.appendScale = function (t, T) {
            return this.a *= t, this.d *= T, this.c *= T, this.b *= t, this
        }, yg.prototype.appendRotate = function (T) {
            if (!T) return this;
            var m = Math.cos(T),
                G = Math.sin(T),
                b = this.a,
                B = this.b;
            return this.a = b * m + this.c * G, this.b = B * m + this.d * G, this.c = -b * G + this.c * m, this.d = -B * G + this.d * m, this
        }, yg.prototype.append = function (x) {
            var g = this.a,
                W = this.b,
                N = this.c,
                A = this.d;
            return this.a = x.a * g + x.b * N, this.b = x.a * W + x.b * A, this.c = x.c * g + x.d * N, this.d = x.c * W + x.d * A, this.tx = x.tx * g + x.ty * N + this.tx, this.ty = x.tx * W + x.ty * A + this.ty, this
        }, yg.prototype.setTransform = function (U, E, j, b, T, u, l, F, r) {
            var d, W, S, H, s, t, J, $, Z, B;
            return s = Math.sin(l), t = Math.cos(l), J = Math.cos(r), $ = Math.sin(r), Z = -Math.sin(F), B = Math.cos(F), d = t * T, W = s * T, S = -s * u, H = t * u, this.a = J * d + $ * S, this.b = J * W + $ * H, this.c = Z * d + B * S, this.d = Z * W + B * H, this.tx = U + (j * d + b * S), this.ty = E + (j * W + b * H), this
        }, yg.prototype.prepend = function (A) {
            var W = this.tx;
            if (1 !== A.a || 0 !== A.b || 0 !== A.c || 1 !== A.d) {
                var C = this.a,
                    G = this.c;
                this.a = C * A.a + this.b * A.c, this.b = C * A.b + this.b * A.d, this.c = G * A.a + this.d * A.c, this.d = G * A.b + this.d * A.d
            }
            return this.tx = W * A.a + this.ty * A.c + A.tx, this.ty = W * A.b + this.ty * A.d + A.ty, this
        }, yg.prototype.transform = yg.prototype.prepend, yg.prototype.invert = function () {
            var j = this.a,
                W = this.b,
                F = this.c,
                u = this.d,
                f = this.tx,
                K = j * u - W * F;
            return this.a = u / K, this.b = -W / K, this.c = -F / K, this.d = j / K, this.tx = (F * this.ty - u * f) / K, this.ty = -(j * this.ty - W * f) / K, this
        }, yg.prototype.identity = function () {
            return this.a = 1, this.b = 0, this.c = 0, this.d = 1, this.tx = 0, this.ty = 0, this
        }, yg.prototype.clone = function () {
            var V = new yg;
            return V.a = this.a, V.b = this.b, V.c = this.c, V.d = this.d, V.tx = this.tx, V.ty = this.ty, V
        }, yg.prototype.copy = function (v) {
            return v.a = this.a, v.b = this.b, v.c = this.c, v.d = this.d, v.tx = this.tx, v.ty = this.ty, v
        }, yg.prototype.tf = function (b, k) {
            1 === arguments.length && (k = b.y, b = b.x);
            var T = this;
            return {
                x: T.a * b + T.c * k + T.tx,
                y: T.b * b + T.d * k + T.ty
            }
        }, yg.prototype.tfi = function (B, v) {
            1 === arguments.length && (v = B.y, B = B.x);
            var X = this,
                m = 1 / (X.a * X.d + X.c * -X.b);
            return {
                x: X.d * m * B + -X.c * m * v + (X.ty * X.c - X.tx * X.d) * m,
                y: X.a * m * v + -X.b * m * B + (-X.ty * X.a + X.tx * X.b) * m
            }
        }, yg.IDENTITY = new yg, yg.TEMP_MATRIX = new yg;
        var Go = k.Math.Vector3 = function (r, Q, v) {
            "object" == typeof r ? this.copy(r) : this.set(r, Q == p ? r : Q, v == p ? r : v)
        };
        x.assign(Go.prototype, {
            set: function (S, l, Q) {
                return this.x = S, this.y = l, this.z = Q, this
            },
            setScalar: function (R) {
                return this.x = R, this.y = R, this.z = R, this
            },
            setX: function (N) {
                return this.x = N, this
            },
            setY: function (n) {
                return this.y = n, this
            },
            setZ: function (Z) {
                return this.z = Z, this
            },
            clone: function () {
                return new this.constructor(this.x, this.y, this.z)
            },
            copy: function (F) {
                return F.x === p ? (this.x = F[0], this.y = F[1], this.z = F[2]) : (this.x = F.x, this.y = F.y, this.z = F.z), this
            },
            add: function (g) {
                return this.x += g.x, this.y += g.y, this.z += g.z, this
            },
            addScalar: function (X) {
                return this.x += X, this.y += X, this.z += X, this
            },
            addVectors: function (I, D) {
                return this.x = I.x + D.x, this.y = I.y + D.y, this.z = I.z + D.z, this
            },
            addScaledVector: function (h, z) {
                return this.x += h.x * z, this.y += h.y * z, this.z += h.z * z, this
            },
            sub: function (i) {
                return this.x -= i.x, this.y -= i.y, this.z -= i.z, this
            },
            subScalar: function (U) {
                return this.x -= U, this.y -= U, this.z -= U, this
            },
            subVectors: function (D, p) {
                return this.x = D.x - p.x, this.y = D.y - p.y, this.z = D.z - p.z, this
            },
            multiply: function (p) {
                return this.x *= p.x, this.y *= p.y, this.z *= p.z, this
            },
            multiplyScalar: function (P) {
                return this.x *= P, this.y *= P, this.z *= P, this
            },
            distanceTo: function (V) {
                return Math.sqrt(this.distanceToSquared(V))
            },
            distanceToSquared: function (C) {
                var B = this.x - C.x,
                    e = this.y - C.y,
                    q = this.z - C.z;
                return B * B + e * e + q * q
            },
            distanceToSquared2: function (o) {
                var F = this.x - o[0],
                    P = this.y - o[1],
                    v = this.z - o[2];
                return F * F + P * P + v * v
            },
            multiplyVectors: function (d, u) {
                return this.x = d.x * u.x, this.y = d.y * u.y, this.z = d.z * u.z, this
            },
            transformDirection: function (M) {
                var S = this.x,
                    r = this.y,
                    c = this.z,
                    b = M.el;
                return this.x = b[0] * S + b[4] * r + b[8] * c, this.y = b[1] * S + b[5] * r + b[9] * c, this.z = b[2] * S + b[6] * r + b[10] * c, this.normalize()
            },
            applyQuaternion: function (c) {
                var H = this.x,
                    J = this.y,
                    Z = this.z,
                    b = c._x,
                    W = c._y,
                    _ = c._z,
                    O = c._w,
                    l = O * H + W * Z - _ * J,
                    q = O * J + _ * H - b * Z,
                    $ = O * Z + b * J - W * H,
                    z = -b * H - W * J - _ * Z;
                return this.x = l * O + z * -b + q * -_ - $ * -W, this.y = q * O + z * -W + $ * -b - l * -_, this.z = $ * O + z * -_ + l * -W - q * -b, this
            },
            applyMatrix4: function (r) {
                var Y = this.x,
                    d = this.y,
                    h = this.z,
                    g = r.el,
                    j = 1 / (g[3] * Y + g[7] * d + g[11] * h + g[15]);
                return this.x = (g[0] * Y + g[4] * d + g[8] * h + g[12]) * j, this.y = (g[1] * Y + g[5] * d + g[9] * h + g[13]) * j, this.z = (g[2] * Y + g[6] * d + g[10] * h + g[14]) * j, this
            },
            negate: function () {
                return this.x = -this.x, this.y = -this.y, this.z = -this.z, this
            },
            dot: function (W) {
                return this.x * W.x + this.y * W.y + this.z * W.z
            },
            lengthSq: function () {
                return this.x * this.x + this.y * this.y + this.z * this.z
            },
            length: function () {
                return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z)
            },
            manhattanLength: function () {
                return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
            },
            normalize: function () {
                var S = this.length();
                return S ? this.multiplyScalar(1 / S) : this
            },
            setLength: function (e) {
                return this.normalize().multiplyScalar(e)
            },
            fromArray: function (v, h) {
                return h === p && (h = 0), this.x = v[h], this.y = v[h + 1], this.z = v[h + 2], this
            },
            toArray: function (V, I) {
                return V === p && (V = [0, 0, 0]), I === p && (I = 0), V[I] = this.x, V[I + 1] = this.y, V[I + 2] = this.z, V
            },
            cross: function (d) {
                return this.crossVectors(this, d)
            },
            angleTo: function (Y) {
                var V = this.dot(Y) / Math.sqrt(this.lengthSq() * Y.lengthSq());
                return V > 1 || -1 > V ? 0 : Math.acos(V)
            },
            lerpVectors: function (M, z, q) {
                return this.subVectors(z, M).multiplyScalar(q).add(M)
            },
            crossVectors: function (f, p) {
                var Y = f.x,
                    L = f.y,
                    M = f.z,
                    s = p.x,
                    g = p.y,
                    h = p.z;
                return this.x = L * h - M * g, this.y = M * s - Y * h, this.z = Y * g - L * s, this
            },
            min: function (O) {
                return this.x = Math.min(this.x, O.x), this.y = Math.min(this.y, O.y), this.z = Math.min(this.z, O.z), this
            },
            max: function (s) {
                return this.x = Math.max(this.x, s.x), this.y = Math.max(this.y, s.y), this.z = Math.max(this.z, s.z), this
            }
        });
        var Pi = k.Math.Vector2 = function (i, f, B) {
            "object" == typeof i && (i.x != p ? (f = i.y, i = i.x, B = i.e) : (B = i[2], f = i[1], i = i[0])), this.set(i || 0, f || 0, B)
        };
        Pi.prototype = {}, Pi.prototype.constructor = Pi, x.defineProperties(Pi.prototype, {
            width: {
                get: function () {
                    return this.x
                },
                set: function (G) {
                    this.x = G
                }
            },
            height: {
                get: function () {
                    return this.y
                },
                set: function (E) {
                    this.y = E
                }
            }
        }), Pi.prototype.clone = function () {
            return new Pi(this.x, this.y, this.e)
        }, Pi.prototype.copy = function (K) {
            return this.set(K.x, K.y, K.e), this
        }, Pi.prototype.equals = function (x) {
            return x.x === this.x && x.y === this.y
        }, Pi.prototype.set = function (H, d, n) {
            return this.x = H || 0, this.y = d || (0 !== d ? this.x : 0), n != p && (this.e = n), this
        }, Pi.prototype.setScalar = function (U) {
            return this.x = U, this.y = U, this
        }, Pi.prototype.setX = function (h) {
            return this.x = h || 0, this
        }, Pi.prototype.setY = function (v) {
            return this.y = v || 0, this
        }, Pi.prototype.add = function (P) {
            return this.x += P.x, this.y += P.y, this
        }, Pi.prototype.addVectors = function (L, t) {
            return this.x = L.x + t.x, this.y = L.y + t.y, this
        }, Pi.prototype.addScalar = function (t) {
            return this.x += t, this.y += t, this
        }, Pi.prototype.addScaledVector = function (N, B) {
            return this.x += N.x * B, this.y += N.y * B, this
        }, Pi.prototype.sub = function (w) {
            return this.x -= w.x, this.y -= w.y, this
        }, Pi.prototype.subScalar = function (e) {
            return this.x -= e, this.y -= e, this
        }, Pi.prototype.subVectors = function (v, x) {
            return this.x = v.x - x.x, this.y = v.y - x.y, this
        }, Pi.prototype.multiply = function (k) {
            return this.x *= k.x, this.y *= k.y, this
        }, Pi.prototype.multiplyScalar = function (k) {
            return this.x *= k, this.y *= k, this
        }, Pi.prototype.divide = function (i) {
            return this.x /= i.x, this.y /= i.y, this
        }, Pi.prototype.divideScalar = function (B) {
            return this.multiplyScalar(1 / B)
        }, Pi.prototype.min = function (z) {
            return this.x = Math.min(this.x, z.x), this.y = Math.min(this.y, z.y), this
        }, Pi.prototype.max = function (E) {
            return this.x = Math.max(this.x, E.x), this.y = Math.max(this.y, E.y), this
        }, Pi.prototype.fromArray = function (H, m) {
            return m === p && (m = 0), this.x = H[m], this.y = H[m + 1], this
        }, Pi.prototype.clamp = function (O, c) {
            return this.x = Math.max(O.x, Math.min(c.x, this.x)), this.y = Math.max(O.y, Math.min(c.y, this.y)), this
        }, Pi.prototype.clampScalar = function () {
            var L, T;
            return function (I, v) {
                return L === p && (L = new Pi, T = new Pi), L.set(I, I), T.set(v, v), this.clamp(L, T)
            }
        }(), Pi.prototype.clampLength = function (y, f) {
            var z = this.length();
            return this.multiplyScalar(Math.max(y, Math.min(f, z)) / z)
        }, Pi.prototype.dot = function (Q) {
            return this.x * Q.x + this.y * Q.y
        }, Pi.prototype.lengthSq = function () {
            return this.x * this.x + this.y * this.y
        }, Pi.prototype.length = function () {
            return Math.sqrt(this.x * this.x + this.y * this.y)
        }, Pi.prototype.normalize = function () {
            return this.divideScalar(this.length())
        }, Pi.prototype.angle = function () {
            var W = Math.atan2(this.y, this.x);
            return 0 > W && (W += 2 * Math.PI), W
        }, Pi.prototype.distanceTo = function (x) {
            return Math.sqrt(this.distanceToSquared(x))
        }, Pi.prototype.distanceToSquared = function (t) {
            var _ = this.x - t.x,
                Y = this.y - t.y;
            return _ * _ + Y * Y
        }, Pi.prototype.isNearEnough = function (r) {
            return this.distanceToSquared(r) < 1e-8
        }, Pi.prototype.setLength = function (t) {
            var M = this.length();
            return M ? this.multiplyScalar(t / M) : this
        }, Pi.prototype.lerp = function (U, A) {
            return this.x += (U.x - this.x) * A, this.y += (U.y - this.y) * A, this
        }, Pi.prototype.lerpVectors = function (c, p, I) {
            return this.subVectors(p, c).multiplyScalar(I).add(c)
        }, Pi.prototype.rotateAround = function (d, u) {
            var l = d ? d.x : 0,
                V = d ? d.y : 0,
                Y = Math.cos(u),
                Z = Math.sin(u),
                s = this.x - l,
                M = this.y - V;
            return this.x = s * Y - M * Z + l, this.y = s * Z + M * Y + V, this
        };
        var qe = k.Math.Ray = function (x, H) {
            this.origin = x !== p ? x.clone() : new Go, this.direction = H !== p ? H.clone() : new Go
        };
        x.assign(qe.prototype, {
            set: function (i, s) {
                return this.origin.copy(i), this.direction.copy(s), this
            },
            clone: function () {
                return (new this.constructor).copy(this)
            },
            copy: function (A) {
                return this.origin.copy(A.origin), this.direction.copy(A.direction), this.maxHitLen = A.maxHitLen, this
            },
            at: function (u, V) {
                var o = V || new Go;
                return o.copy(this.direction).multiplyScalar(u).add(this.origin)
            },
            setMaxHitLength: function (p) {
                this.maxHitLen = p
            },
            lookAt: function (R) {
                return this.direction.copy(R).sub(this.origin).normalize(), this
            },
            applyMatrix4: function (T) {
                var n = this.maxHitLen;
                if (n) {
                    var $ = this.direction.clone().multiplyScalar(n).add(this.origin);
                    $.applyMatrix4(T)
                }
                return this.origin.applyMatrix4(T), this.direction.transformDirection(T), n && (this.maxHitLen = this.origin.distanceTo($)), this
            },
            intersectBox: function (V, D) {
                var b, h, y, w, R, U, x = 1 / this.direction.x,
                    e = 1 / this.direction.y,
                    n = 1 / this.direction.z,
                    Q = this.origin;
                if (x >= 0 ? (b = (V.min.x - Q.x) * x, h = (V.max.x - Q.x) * x) : (b = (V.max.x - Q.x) * x, h = (V.min.x - Q.x) * x), e >= 0 ? (y = (V.min.y - Q.y) * e, w = (V.max.y - Q.y) * e) : (y = (V.max.y - Q.y) * e, w = (V.min.y - Q.y) * e), b > w || y > h) return null;
                if ((y > b || b !== b) && (b = y), (h > w || h !== h) && (h = w), n >= 0 ? (R = (V.min.z - Q.z) * n, U = (V.max.z - Q.z) * n) : (R = (V.max.z - Q.z) * n, U = (V.min.z - Q.z) * n), b > U || R > h) return null;
                if ((R > b || b !== b) && (b = R), (h > U || h !== h) && (h = U), 0 > h) return null;
                var E = b >= 0 ? b : h,
                    c = this.maxHitLen;
                return c && E > c ? null : this.at(E, D)
            },
            intersectTriangle: function () {
                var X = new Go,
                    w = new Go,
                    h = new Go,
                    A = new Go;
                return function (L, B, N, E, M) {
                    w.subVectors(B, L), h.subVectors(N, L), A.crossVectors(w, h);
                    var U, p = this.direction.dot(A);
                    if (p > 0) {
                        if (E) return null;
                        U = 1
                    } else {
                        if (!(0 > p)) return null;
                        U = -1, p = -p
                    }
                    X.subVectors(this.origin, L);
                    var I = U * this.direction.dot(h.crossVectors(X, h));
                    if (0 > I) return null;
                    var $ = U * this.direction.dot(w.cross(X));
                    if (0 > $ || I + $ > p) return null;
                    var c = -U * X.dot(A);
                    if (0 > c) return null;
                    var C = c / p,
                        o = this.maxHitLen;
                    return o && C > o ? null : this.at(C, M)
                }
            }()
        });
        var yr = k.Math.Box3 = function (I, l) {
            this.min = I !== p ? I : new Go(1 / 0, 1 / 0, 1 / 0), this.max = l !== p ? l : new Go(-1 / 0, -1 / 0, -1 / 0)
        };
        x.assign(yr.prototype, {
            set: function (F, E) {
                return this.min.copy(F), this.max.copy(E), this
            },
            setFromArray: function (u) {
                for (var z = 1 / 0, q = 1 / 0, W = 1 / 0, d = -1 / 0, e = -1 / 0, A = -1 / 0, U = 0, S = u.length; S > U; U += 3) {
                    var V = u[U],
                        D = u[U + 1],
                        r = u[U + 2];
                    z > V && (z = V), q > D && (q = D), W > r && (W = r), V > d && (d = V), D > e && (e = D), r > A && (A = r)
                }
                return this.min.set(z, q, W), this.max.set(d, e, A), this
            },
            setFromPoints: function (O) {
                this.makeEmpty();
                for (var W = 0, i = O.length; i > W; W++) this.expandByPoint(O[W]);
                return this
            },
            clone: function () {
                return (new this.constructor).copy(this)
            },
            copy: function (M) {
                return this.min.copy(M.min), this.max.copy(M.max), this
            },
            makeEmpty: function () {
                return this.min.x = this.min.y = this.min.z = 1 / 0, this.max.x = this.max.y = this.max.z = -1 / 0, this
            },
            isEmpty: function () {
                return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z
            },
            expandByPoint: function (q) {
                return this.min.min(q), this.max.max(q), this
            }
        });
        var Al = k.Math.Matrix4 = function () {
            this.el = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]
        };
        x.assign(Al.prototype, {
            set: function (r, P, Z, c, W, I, H, J, l, q, k, Q, K, O, w, y) {
                var u = this.el;
                return u[0] = r, u[4] = P, u[8] = Z, u[12] = c, u[1] = W, u[5] = I, u[9] = H, u[13] = J, u[2] = l, u[6] = q, u[10] = k, u[14] = Q, u[3] = K, u[7] = O, u[11] = w, u[15] = y, this
            },
            clone: function () {
                return (new Al).fromArray(this.el)
            },
            fromArray: function (u, l) {
                l === p && (l = 0);
                for (var U = this.el, K = 0; 16 > K; K++) U[K] = u[K + l];
                return this
            },
            scale: function (P) {
                var m = this.el,
                    e = P.x,
                    k = P.y,
                    H = P.z;
                return m[0] *= e, m[4] *= k, m[8] *= H, m[1] *= e, m[5] *= k, m[9] *= H, m[2] *= e, m[6] *= k, m[10] *= H, m[3] *= e, m[7] *= k, m[11] *= H, this
            },
            makeRotationFromEuler: function (H) {
                var I = this.el,
                    _ = H._x,
                    h = H._y,
                    v = H._z,
                    R = H._order,
                    i = Math.cos(_),
                    e = Math.sin(_),
                    V = Math.cos(h),
                    C = Math.sin(h),
                    b = Math.cos(v),
                    j = Math.sin(v);
                if ("XYZ" === R) {
                    var E = i * b,
                        Z = i * j,
                        B = e * b,
                        r = e * j;
                    I[0] = V * b, I[4] = -V * j, I[8] = C, I[1] = Z + B * C, I[5] = E - r * C, I[9] = -e * V, I[2] = r - E * C, I[6] = B + Z * C, I[10] = i * V
                } else if ("YXZ" === R) {
                    var c = V * b,
                        U = V * j,
                        g = C * b,
                        A = C * j;
                    I[0] = c + A * e, I[4] = g * e - U, I[8] = i * C, I[1] = i * j, I[5] = i * b, I[9] = -e, I[2] = U * e - g, I[6] = A + c * e, I[10] = i * V
                } else if ("ZXY" === R) {
                    var c = V * b,
                        U = V * j,
                        g = C * b,
                        A = C * j;
                    I[0] = c - A * e, I[4] = -i * j, I[8] = g + U * e, I[1] = U + g * e, I[5] = i * b, I[9] = A - c * e, I[2] = -i * C, I[6] = e, I[10] = i * V
                } else if ("ZYX" === R) {
                    var E = i * b,
                        Z = i * j,
                        B = e * b,
                        r = e * j;
                    I[0] = V * b, I[4] = B * C - Z, I[8] = E * C + r, I[1] = V * j, I[5] = r * C + E, I[9] = Z * C - B, I[2] = -C, I[6] = e * V, I[10] = i * V
                } else if ("YZX" === R) {
                    var M = i * V,
                        W = i * C,
                        n = e * V,
                        O = e * C;
                    I[0] = V * b, I[4] = O - M * j, I[8] = n * j + W, I[1] = j, I[5] = i * b, I[9] = -e * b, I[2] = -C * b, I[6] = W * j + n, I[10] = M - O * j
                } else if ("XZY" === R) {
                    var M = i * V,
                        W = i * C,
                        n = e * V,
                        O = e * C;
                    I[0] = V * b, I[4] = -j, I[8] = C * b, I[1] = M * j + O, I[5] = i * b, I[9] = W * j - n, I[2] = n * j - W, I[6] = e * b, I[10] = O * j + M
                }
                return I[3] = 0, I[7] = 0, I[11] = 0, I[12] = 0, I[13] = 0, I[14] = 0, I[15] = 1, this
            },
            makeRotationFromQuaternion: function (K) {
                var P = this.el,
                    H = K._x,
                    Y = K._y,
                    D = K._z,
                    S = K._w,
                    N = H + H,
                    A = Y + Y,
                    R = D + D,
                    W = H * N,
                    E = H * A,
                    L = H * R,
                    u = Y * A,
                    Z = Y * R,
                    l = D * R,
                    q = S * N,
                    d = S * A,
                    i = S * R;
                return P[0] = 1 - (u + l), P[4] = E - i, P[8] = L + d, P[1] = E + i, P[5] = 1 - (W + l), P[9] = Z - q, P[2] = L - d, P[6] = Z + q, P[10] = 1 - (W + u), P[3] = 0, P[7] = 0, P[11] = 0, P[12] = 0, P[13] = 0, P[14] = 0, P[15] = 1, this
            },
            identity: function () {
                return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
            },
            getInverse: function (E) {
                var j = this.el,
                    W = E.el,
                    k = W[0],
                    Q = W[1],
                    G = W[2],
                    m = W[3],
                    o = W[4],
                    n = W[5],
                    f = W[6],
                    v = W[7],
                    J = W[8],
                    x = W[9],
                    L = W[10],
                    X = W[11],
                    D = W[12],
                    Z = W[13],
                    $ = W[14],
                    e = W[15],
                    t = x * $ * v - Z * L * v + Z * f * X - n * $ * X - x * f * e + n * L * e,
                    R = D * L * v - J * $ * v - D * f * X + o * $ * X + J * f * e - o * L * e,
                    b = J * Z * v - D * x * v + D * n * X - o * Z * X - J * n * e + o * x * e,
                    F = D * x * f - J * Z * f - D * n * L + o * Z * L + J * n * $ - o * x * $,
                    _ = k * t + Q * R + G * b + m * F;
                if (0 === _) return this.identity();
                var S = 1 / _;
                return j[0] = t * S, j[1] = (Z * L * m - x * $ * m - Z * G * X + Q * $ * X + x * G * e - Q * L * e) * S, j[2] = (n * $ * m - Z * f * m + Z * G * v - Q * $ * v - n * G * e + Q * f * e) * S, j[3] = (x * f * m - n * L * m - x * G * v + Q * L * v + n * G * X - Q * f * X) * S, j[4] = R * S, j[5] = (J * $ * m - D * L * m + D * G * X - k * $ * X - J * G * e + k * L * e) * S, j[6] = (D * f * m - o * $ * m - D * G * v + k * $ * v + o * G * e - k * f * e) * S, j[7] = (o * L * m - J * f * m + J * G * v - k * L * v - o * G * X + k * f * X) * S, j[8] = b * S, j[9] = (D * x * m - J * Z * m - D * Q * X + k * Z * X + J * Q * e - k * x * e) * S, j[10] = (o * Z * m - D * n * m + D * Q * v - k * Z * v - o * Q * e + k * n * e) * S, j[11] = (J * n * m - o * x * m - J * Q * v + k * x * v + o * Q * X - k * n * X) * S, j[12] = F * S, j[13] = (J * Z * G - D * x * G + D * Q * L - k * Z * L - J * Q * $ + k * x * $) * S, j[14] = (D * n * G - o * Z * G - D * Q * f + k * Z * f + o * Q * $ - k * n * $) * S, j[15] = (o * x * G - J * n * G + J * Q * f - k * x * f - o * Q * L + k * n * L) * S, this
            },
            makeRotationAxis: function (W, t) {
                var T = Math.cos(t),
                    E = Math.sin(t),
                    S = 1 - T,
                    Y = W.x,
                    R = W.y,
                    m = W.z,
                    J = S * Y,
                    N = S * R;
                return this.set(J * Y + T, J * R - E * m, J * m + E * R, 0, J * R + E * m, N * R + T, N * m - E * Y, 0, J * m - E * R, N * m + E * Y, S * m * m + T, 0, 0, 0, 0, 1), this
            },
            multiply: function (d) {
                return this.multiplyMatrices(this, d)
            },
            premultiply: function (W) {
                return this.multiplyMatrices(W, this)
            },
            multiplyMatrices: function (P, I) {
                var s = P.el,
                    D = I.el,
                    M = this.el,
                    H = s[0],
                    f = s[4],
                    y = s[8],
                    R = s[12],
                    K = s[1],
                    U = s[5],
                    z = s[9],
                    E = s[13],
                    p = s[2],
                    o = s[6],
                    F = s[10],
                    _ = s[14],
                    m = s[3],
                    b = s[7],
                    L = s[11],
                    V = s[15],
                    B = D[0],
                    A = D[4],
                    Y = D[8],
                    k = D[12],
                    X = D[1],
                    q = D[5],
                    x = D[9],
                    t = D[13],
                    J = D[2],
                    j = D[6],
                    O = D[10],
                    n = D[14],
                    C = D[3],
                    T = D[7],
                    Z = D[11],
                    w = D[15];
                return M[0] = H * B + f * X + y * J + R * C, M[4] = H * A + f * q + y * j + R * T, M[8] = H * Y + f * x + y * O + R * Z, M[12] = H * k + f * t + y * n + R * w, M[1] = K * B + U * X + z * J + E * C, M[5] = K * A + U * q + z * j + E * T, M[9] = K * Y + U * x + z * O + E * Z, M[13] = K * k + U * t + z * n + E * w, M[2] = p * B + o * X + F * J + _ * C, M[6] = p * A + o * q + F * j + _ * T, M[10] = p * Y + o * x + F * O + _ * Z, M[14] = p * k + o * t + F * n + _ * w, M[3] = m * B + b * X + L * J + V * C, M[7] = m * A + b * q + L * j + V * T, M[11] = m * Y + b * x + L * O + V * Z, M[15] = m * k + b * t + L * n + V * w, this
            },
            lookAt: function () {
                var M = new Go,
                    c = new Go,
                    r = new Go;
                return function (n, w, B) {
                    var k = this.el;
                    return r.subVectors(n, w), 0 === r.lengthSq() && (r.z = 1), r.normalize(), M.crossVectors(B, r), 0 === M.lengthSq() && (1 === Math.abs(B.z) ? r.x += 1e-4 : r.z += 1e-4, r.normalize(), M.crossVectors(B, r)), M.normalize(), c.crossVectors(r, M), k[0] = M.x, k[4] = c.x, k[8] = r.x, k[1] = M.y, k[5] = c.y, k[9] = r.y, k[2] = M.z, k[6] = c.z, k[10] = r.z, this
                }
            }()
        });
        var mh = k.Math.Quaternion = function (M, N, o, m) {
            this.set(M, N, o, m)
        };
        x.assign(mh.prototype, {
            set: function (H, e, k, Z) {
                var M = this;
                return M._x = H || 0, M._y = e || 0, M._z = k || 0, M._w = Z !== p ? Z : 1, M
            },
            clone: function () {
                return new this.constructor(this._x, this._y, this._z, this._w)
            },
            copy: function (I) {
                var D = this;
                return D._x = I._x, D._y = I._y, D._z = I._z, D._w = I._w, D
            },
            fromArray: function (m, H) {
                H === p && (H = 0);
                var a = this;
                return a._x = m[H], a._y = m[H + 1], a._z = m[H + 2], a._w = m[H + 3], this
            },
            slerp: function (y, d) {
                if (0 === d) return this;
                if (1 === d) return this.copy(y);
                var t = this._x,
                    g = this._y,
                    Z = this._z,
                    h = this._w,
                    D = h * y._w + t * y._x + g * y._y + Z * y._z;
                if (0 > D ? (this._w = -y._w, this._x = -y._x, this._y = -y._y, this._z = -y._z, D = -D) : this.copy(y), D >= 1) return this._w = h, this._x = t, this._y = g, this._z = Z, this;
                var F = Math.sqrt(1 - D * D);
                if (Math.abs(F) < .001) return this._w = .5 * (h + this._w), this._x = .5 * (t + this._x), this._y = .5 * (g + this._y), this._z = .5 * (Z + this._z), this;
                var M = Math.atan2(F, D),
                    w = Math.sin((1 - d) * M) / F,
                    i = Math.sin(d * M) / F;
                return this._w = h * w + this._w * i, this._x = t * w + this._x * i, this._y = g * w + this._y * i, this._z = Z * w + this._z * i, this
            },
            setFromAxisAngle: function (C, y) {
                var H = y / 2,
                    G = Math.sin(H);
                return this._x = C.x * G, this._y = C.y * G, this._z = C.z * G, this._w = Math.cos(H), this
            },
            setFromEuler: function (v) {
                var m = v._x,
                    u = v._y,
                    U = v._z,
                    O = v._order,
                    T = Math.cos,
                    E = Math.sin,
                    M = T(m / 2),
                    z = T(u / 2),
                    y = T(U / 2),
                    d = E(m / 2),
                    P = E(u / 2),
                    _ = E(U / 2);
                return "XYZ" === O ? (this._x = d * z * y + M * P * _, this._y = M * P * y - d * z * _, this._z = M * z * _ + d * P * y, this._w = M * z * y - d * P * _) : "YXZ" === O ? (this._x = d * z * y + M * P * _, this._y = M * P * y - d * z * _, this._z = M * z * _ - d * P * y, this._w = M * z * y + d * P * _) : "ZXY" === O ? (this._x = d * z * y - M * P * _, this._y = M * P * y + d * z * _, this._z = M * z * _ + d * P * y, this._w = M * z * y - d * P * _) : "ZYX" === O ? (this._x = d * z * y - M * P * _, this._y = M * P * y + d * z * _, this._z = M * z * _ - d * P * y, this._w = M * z * y + d * P * _) : "YZX" === O ? (this._x = d * z * y + M * P * _, this._y = M * P * y + d * z * _, this._z = M * z * _ - d * P * y, this._w = M * z * y - d * P * _) : "XZY" === O && (this._x = d * z * y - M * P * _, this._y = M * P * y - d * z * _, this._z = M * z * _ + d * P * y, this._w = M * z * y + d * P * _), this
            }
        });
        var jj = k.Math.Triangle = function (g, S, m) {
            this.a = g !== p ? g : new Go, this.b = S !== p ? S : new Go, this.c = m !== p ? m : new Go
        };
        x.assign(jj, {
            barycoordFromPoint: function () {
                var d = new Go,
                    x = new Go,
                    a = new Go;
                return function (s, O, n, g, Y) {
                    d.subVectors(g, O), x.subVectors(n, O), a.subVectors(s, O);
                    var c = d.dot(d),
                        R = d.dot(x),
                        b = d.dot(a),
                        W = x.dot(x),
                        E = x.dot(a),
                        k = c * W - R * R,
                        T = Y || new Go;
                    if (0 === k) return T.set(-2, -1, -1);
                    var t = 1 / k,
                        m = (W * b - R * E) * t,
                        F = (c * E - R * b) * t;
                    return T.set(1 - m - F, F, m)
                }
            }()
        });
        var Wo = k.Math.Euler = function (x, P, o, f, V) {
            this.set(x, P, o, f, V)
        };
        Wo.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"], Wo.DefaultOrder = "XYZ", Wo.ReverseOrder = function (J) {
            return J = J[2] + J[1] + J[0], J.toUpperCase()
        }, x.defineProperties(Wo.prototype, {
            x: {
                get: function () {
                    return this._x
                },
                set: function (Q) {
                    this._x = Q, this.onChangeCallback()
                }
            },
            y: {
                get: function () {
                    return this._y
                },
                set: function (e) {
                    this._y = e, this.onChangeCallback()
                }
            },
            z: {
                get: function () {
                    return this._z
                },
                set: function (l) {
                    this._z = l, this.onChangeCallback()
                }
            },
            order: {
                get: function () {
                    return this._order
                },
                set: function (w) {
                    this._order = w, this.onChangeCallback()
                }
            }
        }), x.assign(Wo.prototype, {
            set: function (i, M, D, N, $) {
                return nj(i) && ($ = D, N = M, D = i[2], M = i[1], i = i[0]), N ? $ && (N = Wo.ReverseOrder(N)) : N = "ZYX", this._x = i || 0, this._y = M || 0, this._z = D || 0, this._order = N || this._order, this.onChangeCallback(), this
            },
            clone: function () {
                return new this.constructor(this._x, this._y, this._z, this._order)
            },
            copy: function (U) {
                return this._x = U._x, this._y = U._y, this._z = U._z, this._order = U._order, this.onChangeCallback(), this
            },
            setFromRotationMatrix: function (g, j, S) {
                var Q = k.Math.clamp,
                    b = g.el || g,
                    d = b[0],
                    G = b[4],
                    R = b[8],
                    H = b[1],
                    f = b[5],
                    Y = b[9],
                    L = b[2],
                    w = b[6],
                    D = b[10];
                return j = j || this._order, "XYZ" === j ? (this._y = Math.asin(Q(R, -1, 1)), Math.abs(R) < .99999 ? (this._x = Math.atan2(-Y, D), this._z = Math.atan2(-G, d)) : (this._x = Math.atan2(w, f), this._z = 0)) : "YXZ" === j ? (this._x = Math.asin(-Q(Y, -1, 1)), Math.abs(Y) < .99999 ? (this._y = Math.atan2(R, D), this._z = Math.atan2(H, f)) : (this._y = Math.atan2(-L, d), this._z = 0)) : "ZXY" === j ? (this._x = Math.asin(Q(w, -1, 1)), Math.abs(w) < .99999 ? (this._y = Math.atan2(-L, D), this._z = Math.atan2(-G, f)) : (this._y = 0, this._z = Math.atan2(H, d))) : "ZYX" === j ? (this._y = Math.asin(-Q(L, -1, 1)), Math.abs(L) < .99999 ? (this._x = Math.atan2(w, D), this._z = Math.atan2(H, d)) : (this._x = 0, this._z = Math.atan2(-G, f))) : "YZX" === j ? (this._z = Math.asin(Q(H, -1, 1)), Math.abs(H) < .99999 ? (this._x = Math.atan2(-Y, f), this._y = Math.atan2(-L, d)) : (this._x = 0, this._y = Math.atan2(R, D))) : "XZY" === j ? (this._z = Math.asin(-Q(G, -1, 1)), Math.abs(G) < .99999 ? (this._x = Math.atan2(w, f), this._y = Math.atan2(R, d)) : (this._x = Math.atan2(-Y, D), this._y = 0)) : console.warn("unsupported order: " + j), this._order = j, S !== !1 && this.onChangeCallback(), this
            },
            setFromQuaternion: function () {
                var k = new Al;
                return function (G, E, Y) {
                    return k.makeRotationFromQuaternion(G), this.setFromRotationMatrix(k, E, Y)
                }
            }(),
            setFromVector3: function (V, D) {
                return this.set(V.x, V.y, V.z, D || this._order)
            },
            reorder: function () {
                var W = new mh;
                return function (R) {
                    return W.setFromEuler(this), this.setFromQuaternion(W, R)
                }
            }(),
            equals: function ($) {
                return $._x === this._x && $._y === this._y && $._z === this._z && $._order === this._order
            },
            fromArray: function (x) {
                return this._x = x[0], this._y = x[1], this._z = x[2], x[3] !== p && (this._order = x[3]), this.onChangeCallback(), this
            },
            toArray: function (v, K) {
                return v === p && (v = []), K === p && (K = 0), v[K] = this._x, v[K + 1] = this._y, v[K + 2] = this._z, v[K + 3] = this._order, v
            },
            toVector3: function (z) {
                return z ? z.set(this._x, this._y, this._z) : new Go(this._x, this._y, this._z)
            },
            onChange: function (n) {
                return this.onChangeCallback = n, this
            },
            onChangeCallback: function () {}
        });
        var vf = k.List = function () {
            this._as = [];
            var H, n, b = arguments.length;
            if (1 === b) {
                var g = arguments[0];
                if (Er(g) && (g = g._as), nj(g))
                    for (n = g.length, H = 0; n > H; H++) this._as.push(g[H]);
                else g != h && this._as.push(g)
            } else if (b > 1)
                for (H = 0; b > H; H++) this._as.push(arguments[H])
        };
        If("List", x, {
            forEach: function (s, z) {
                this.each(s, z)
            },
            push: function () {
                for (var e = 0; e < arguments.length; e++) this.add(arguments[e])
            },
            pop: function () {
                return this._as.pop()
            },
            shift: function () {
                return this._as.shift()
            },
            unshift: function () {
                return this._as.unshift.apply(this._as, arguments)
            },
            size: function () {
                return this._as.length
            },
            isEmpty: function () {
                return 0 === this._as.length
            },
            add: function (u, s) {
                return s === p ? this._as.push(u) : this._as.splice(s, 0, u)
            },
            addAll: function (f) {
                Er(f) && (f = f._as), nj(f) ? ug(this._as, f) : this._as.push(f)
            },
            get: function (n) {
                return this._as[n]
            },
            slice: function (l, U) {
                return new vf(this._as.slice(l, U))
            },
            remove: function (i) {
                var e = this._as.indexOf(i);
                return e >= 0 && e < this._as.length && this.removeAt(e), e
            },
            removeAt: function (w) {
                return this._as.splice(w, 1)[0]
            },
            set: function (h, e) {
                return this._as[h] = e
            },
            clear: function () {
                return this._as.splice(0, this._as.length)
            },
            contains: function (Z) {
                return this._as.indexOf(Z) >= 0
            },
            indexOf: function (N) {
                return this._as.indexOf(N)
            },
            each: function (b, N) {
                for (var y = 0, k = this._as.length; k > y; y++) {
                    var A = this._as[y];
                    N ? b.call(N, A, y, this) : b(A, y, this)
                }
            },
            reverseEach: function (W, o) {
                for (var h = this._as.length - 1; h >= 0; h--) {
                    var T = this._as[h];
                    o ? W.call(o, T) : W(T)
                }
            },
            toArray: function (X, e) {
                if (X) {
                    for (var t, Q = [], M = 0, q = this._as.length; q > M; M++) t = this._as[M], e ? X.call(e, t) && Q.push(t) : X(t) && Q.push(t);
                    return Q
                }
                return this._as.concat()
            },
            toList: function (I, V) {
                if (I) {
                    for (var m, B = new vf, u = 0, i = this._as.length; i > u; u++) m = this._as[u], V ? I.call(V, m) && B.add(m) : I(m) && B.add(m);
                    return B
                }
                return new vf(this)
            },
            reverse: function () {
                this._as.reverse()
            },
            sort: function (t) {
                return this._as.sort(t ? t : dh), this
            },
            toString: function () {
                return this._as.toString()
            }
        }), x.defineProperties(vf.prototype, {
            length: {
                get: function () {
                    return this._as.length
                },
                set: function (H) {
                    this._as.length = H
                }
            }
        });
        var il = new vf;
        xr(il, {
            size: function () {
                return 0
            },
            indexOf: function () {
                return -1
            },
            contains: function () {
                return !1
            },
            isEmpty: function () {
                return !0
            },
            sort: qm,
            each: qm,
            reverseEach: qm,
            toArray: function () {
                return []
            },
            toList: function () {
                return new vf
            },
            add: Zf,
            addAll: Zf,
            set: Zf,
            remove: Zf,
            removeAt: Zf,
            clear: Zf
        });
        var le = k.Notifier = function () {
            this._f = 0
        };
        If("Notifier", x, {
            contains: function (Z, H) {
                if (this._ls)
                    for (var d, e = 0, s = this._ls.size(); s > e; e++)
                        if (d = this._ls.get(e), Z === d.l && H === d.s) return !0;
                return !1
            },
            add: function (e, P, I) {
                var a = this,
                    z = {
                        l: e,
                        s: P,
                        a: I
                    };
                a._ls || (a._ls = new vf), a._f ? (a._as || (a._as = new vf), a._as.add(z)) : z.a ? a._ls.add(z, 0) : a._ls.add(z)
            },
            remove: function (t, _) {
                var Z = this;
                Z._ls && (Z._f ? (Z._rs || (Z._rs = new vf), Z._rs.add({
                    l: t,
                    s: _
                })) : Z._remove(t, _))
            },
            _remove: function (E, q) {
                for (var z, d = this._ls, c = 0, l = d.size(); l > c; c++)
                    if (z = d.get(c), z.l === E && z.s === q) return d.removeAt(c), void 0
            },
            fire: function (k) {
                var L = this,
                    q = L._ls;
                if (L._b = 1e4, q) {
                    ++L._f;
                    try {
                        for (var T, s = 0, r = q.size(); r > s; s++) T = q.get(s), T.s ? T.l.call(T.s, k) : T.l(k)
                    } finally {
                        if (--L._f) return;
                        if (L._rs) {
                            for (r = L._rs.size(), s = 0; r > s; s++) T = L._rs.get(s), L._remove(T.l, T.s);
                            delete L._rs
                        }
                        if (L._as) {
                            for (r = L._as.size(), s = 0; r > s; s++) T = L._as.get(s), T.a ? q.add(T, 0) : q.add(T);
                            delete L._as
                        }
                    }
                }
            }
        });
        var rr = k.Data = function () {
            this._id = Uk()
        };
        If("Data", x, {
            ms_ac: ["tag", "name", "displayName", "icon", "toolTip", "attrObject", "styleMap", "layer", "adjustChildrenToTop", "dataBindings"],
            ms_dm: 1,
            ms_attr: 1,
            _icon: h,
            _parent: h,
            _children: il,
            _childMap: h,
            _styleMap: h,
            _layer: "0",
            _adjustChildrenToTop: !1,
            getUIClass: function () {
                return h
            },
            _22Q: function () {
                return h
            },
            s: function (Y, r) {
                var w = this;
                if (2 === arguments.length) w.setStyle(Y, r);
                else {
                    if (!cl(Y)) return w.getStyle(Y);
                    for (var H in Y) w.setStyle(H, Y[H])
                }
                return w
            },
            fp: function (h, l, R, M, W) {
                return this.firePropertyChange(h, l, R, M, W)
            },
            firePropertyChange: function (e, t, k, w, W) {
                if (w) {
                    if (w(t, k)) return !1
                } else if (t === k) return !1;
                var R = this,
                    Q = W || {};
                return Q.property = e, Q.oldValue = t, Q.newValue = k, Q.data = R, R._dataModel && R._dataModel.handleDataPropertyChange(Q), R.onPropertyChanged(Q), !0
            },
            onPropertyChanged: function (S) {
                var t = this,
                    Q = t._parent,
                    W = S.property;
                if (an(Q)) {
                    var H = t.s(ih),
                        b = "s:ingroup" === W;
                    (H && Mj[W] || W === b) && Q._81I(), (H || b) && Q.fp("childChange", !0, !1)
                }
                Sg(Q) && Mj[W] && Q.updateFromChildren()
            },
            _21I: function (n) {
                var l = this;
                if (n && l._dataModel) throw "Remove data from dataModel before adding";
                l._dataModel = n
            },
            removeFromDataModel: function () {
                this._dataModel ? this._dataModel.remove(this) : this.setParent(null)
            },
            clearChildrenFromDataModel: function () {
                for (var z = 0, y = this._children.toArray(), E = y.length; E > z; z++) y[z].removeFromDataModel()
            },
            getId: function () {
                return this._id
            },
            setId: function (s) {
                this._id = s
            },
            getChildren: function () {
                return this._children
            },
            size: function () {
                return this._children.size()
            },
            toChildren: function (p, L) {
                return this._children.toList(p, L)
            },
            eachChild: function (t, s) {
                this._children.each(t, s)
            },
            addChild: function (G, i) {
                var a = this;
                G !== a && (a._children === il && (a._children = new vf, a._childMap = {}), i >= 0 || (i = a._children.size()), a._childMap[G._id] || a.isDescendantOf(G) || (G._parent && G._parent.removeChild(G), (0 > i || i > a._children.size()) && (i = a._children.size()), a._children.add(G, i), a._childMap[G._id] = G, G.setParent(a), a.onChildAdded(G, i), a.fp(pe, h, G)))
            },
            onChildAdded: function () {},
            removeChild: function (N) {
                var t = this;
                if (t._childMap && t._childMap[N._id]) {
                    var G = t._children.remove(N);
                    delete t._childMap[N._id], t.fp(pe, N, h), N.setParent(h, G), t.onChildRemoved(N, G)
                }
            },
            onChildRemoved: function () {},
            getChildAt: function (n) {
                return this._children.get(n)
            },
            clearChildren: function () {
                var b = this;
                if (!b._children.isEmpty())
                    for (var Y = 0, j = b._children.toArray(), W = j.length; W > Y; Y++) b.removeChild(j[Y])
            },
            getParent: function () {
                return this._parent
            },
            setParent: function (J, H) {
                var q = this;
                if (!(q._73I || q._parent === J || q === J || J && J.isDescendantOf(q))) {
                    var U, d = q._parent;
                    q._parent = J, q._73I = 1, d ? (H == h && (H = d.getChildren().indexOf(q)), d.removeChild(q)) : q._dataModel && H == h && (H = q._dataModel.getRoots().indexOf(q)), J && (J.addChild(q), U = J.getChildren().indexOf(q)), delete q._73I, q.fp("parent", d, J, p, {
                        oldIndex: H,
                        newIndex: U
                    }), q.onParentChanged(d, J)
                }
            },
            onParentChanged: function () {},
            hasChildren: function () {
                return this._children.size() > 0
            },
            isEmpty: function () {
                return this._children.isEmpty()
            },
            isRelatedTo: function (B) {
                return B ? this.isDescendantOf(B) || B.isDescendantOf(this) : !1
            },
            isParentOf: function (W) {
                return W && this._childMap ? !!this._childMap[W._id] : !1
            },
            isDescendantOf: function (R) {
                if (!R || R.isEmpty()) return !1;
                for (var B = this._parent; B;) {
                    if (R === B) return !0;
                    B = B._parent
                }
                return !1
            },
            getStyle: function (b, d) {
                d === p && (d = 1);
                var l = this._styleMap ? this._styleMap[b] : p;
                return l === p && d ? C[b] : l
            },
            setStyle: function (Y, v) {
                var h = this;
                h._styleMap || (h._styleMap = {});
                var k = h._styleMap[Y];
                v === p ? delete h._styleMap[Y] : h._styleMap[Y] = v, h.fp("s:" + Y, k, v) && h.onStyleChanged(Y, k, v)
            },
            onStyleChanged: function () {},
            iv: function (K) {
                this.invalidate(K)
            },
            invalidate: function (D) {
                this.fp(D || "*", !1, !0)
            },
            toString: function () {
                var A = this;
                return A._displayName || A._name || A._tag || A._id
            },
            toLabel: function () {
                return this._displayName || this._name
            },
            addStyleIcon: function (W, B) {
                var d = this,
                    Q = d.s(lk);
                Q || d.s(lk, Q = {}), B ? Q[W] = B : delete Q[W], d.fp(lk, h, Q)
            },
            removeStyleIcon: function (D) {
                var V = this.s(lk);
                if (V) {
                    var v = V[D];
                    delete V[D], this.fp(lk, h, V)
                }
                return v
            },
            getSerializableProperties: function () {
                return {
                    name: 1,
                    displayName: 1,
                    icon: 1,
                    toolTip: 1,
                    parent: 1,
                    layer: 1,
                    tag: 1,
                    adjustChildrenToTop: 1,
                    dataBindings: 1
                }
            },
            getSerializableStyles: function () {
                var T, n = {};
                for (T in this._styleMap) n[T] = 1;
                return n
            }
        });
        var Nm = k.DataModel = function () {
            var x = this;
            x._datas = new vf, x._dataMap = {}, x._roots = new vf, x._rootMap = {}, x._fsDataMap = {}, x._78O = {}, x._36I = new le, x._35I = new le, x._serializeNotifier = new le, x._selectionModel = new Le(x);
            var w = x._29Q = [],
                a = x._scheduleCallback = function () {
                    for (var F = Date.now(), u = 0; u < w.length; u++) {
                        var e = w[u];
                        e.enabled && F - e.lastTime > e.interval && (e.beforeAction && e.beforeAction(), x.each(function (F) {
                            e.action(F)
                        }), e.afterAction && e.afterAction(), e.lastTime = F)
                    }
                    w.length && (x._30Q = d.requestAnimationFrame(a))
                }
        };
        If("DataModel", x, {
            ms_fire: 1,
            ms_attr: 1,
            ms_ac: ["layers", "name", "autoAdjustIndex", "hierarchicalRendering", "background", "envmap", "postProcessingData", "init"],
            _name: p,
            _autoAdjustIndex: !0,
            _hierarchicalRendering: !1,
            _background: p,
            _init: p,
            _envmap: p,
            _postProcessingData: p,
            sm: function () {
                return this.getSelectionModel()
            },
            mm: function (F, J, H) {
                this.addDataModelChangeListener(F, J, H)
            },
            umm: function (U, s) {
                this.removeDataModelChangeListener(U, s)
            },
            md: function (y, v, F) {
                this.addDataPropertyChangeListener(y, v, F)
            },
            umd: function (W, x) {
                this.removeDataPropertyChangeListener(W, x)
            },
            mh: function (W, u, l) {
                this.addHierarchyChangeListener(W, u, l)
            },
            umh: function (L, B) {
                this.removeHierarchyChangeListener(L, B)
            },
            getAttrObject: function () {
                return this._attrObject
            },
            setAttrObject: function (g) {
                return this._attrObject = g
            },
            getSelectionModel: function () {
                return this._selectionModel
            },
            size: function () {
                return this._datas.size()
            },
            isEmpty: function () {
                return this._datas.isEmpty()
            },
            getRoots: function () {
                return this._roots
            },
            getDatas: function () {
                return this._datas
            },
            getFullscreenDatas: function () {
                return this._fsDataMap
            },
            getDataById: function (G) {
                return this._dataMap[G]
            },
            removeDataById: function (b) {
                this.remove(this.getDataById(b))
            },
            toDatas: function (k, V) {
                return this._datas.toList(k, V)
            },
            each: function (R, X) {
                this._datas.each(R, X)
            },
            getDataByTag: function (B) {
                return this._78O[B]
            },
            getTagMap: function () {
                return this._78O
            },
            removeDataByTag: function (T) {
                this.remove(this.getDataByTag(T))
            },
            add: function (n, f, F) {
                var u = this,
                    C = n._id,
                    s = n._tag,
                    X = u._roots;
                if (u._dataMap[C]) throw "'" + C + "' already exists";
                s != h && (u._78O[s] = n), u._dataMap[C] = n, F >= 0 ? u._datas.add(n, F) : u._datas.add(n), n._parent || (u._rootMap[C] = n, f >= 0 ? X.add(n, f) : X.add(n)), n.s("fullscreen") !== p && (u._fsDataMap[C] = n), n._21I(u), u.onAdded(n), u._36I.fire({
                    kind: "add",
                    data: n,
                    rootsIndex: f,
                    datasIndex: F
                })
            },
            onAdded: function () {},
            remove: function (j, b) {
                if (j) {
                    var C = this,
                        J = j._id,
                        p = b && b.keepStructure,
                        o = b && b.keepChildren,
                        G = j.getTag();
                    if (j._dataModel === C) {
                        this.beginTransaction(), p ? C._removingData || (C._removingData = j) : C.prepareRemove(j), o || j.toChildren().each(function (c) {
                            C.remove(c, b)
                        }, C), p ? C._removingData === j && (j._parent && j._parent.removeChild(j), delete C._removingData) : j._parent && j._parent.removeChild(j);
                        var V = C._datas.remove(j);
                        delete C._dataMap[J], G != h && delete C._78O[G];
                        var I;
                        C._rootMap[J] && (delete C._rootMap[J], I = C._roots.remove(j)), C._fsDataMap[J] && delete C._fsDataMap[J], j._21I(h), C.onRemoved(j), C._36I.fire({
                            kind: sc,
                            data: j,
                            rootsIndex: I,
                            datasIndex: V
                        }), this.endTransaction()
                    }
                }
            },
            onRemoved: function () {},
            prepareRemove: function () {},
            clear: function () {
                var j = this;
                if (j._datas.size()) {
                    var $ = j._historyManager ? this.toJSON() : p;
                    j._datas.toArray().forEach(function (d) {
                        d._21I(h)
                    }), j._datas.clear(), j._dataMap = {}, j._roots.clear(), j._rootMap = {}, j._fsDataMap = {}, j._78O = {}, j._36I.fire({
                        kind: cf,
                        json: $
                    })
                }
            },
            contains: function (Z) {
                return Z && Z._dataModel === this
            },
            handleDataPropertyChange: function (O) {
                var Z = this,
                    n = O.data,
                    T = O.property;
                if ("parent" === T) {
                    var B = n._id,
                        U = Z._rootMap,
                        $ = Z._roots;
                    n._parent ? U[B] && (delete U[B], $.remove(n)) : U[B] || (U[B] = n, $.add(n))
                } else if ("tag" === T) {
                    var K = O.oldValue,
                        _ = O.newValue,
                        d = Z._78O;
                    K != h && delete d[K], _ != h && (d[_] = n)
                } else if ("s:fullscreen" === T) {
                    var B = n._id,
                        S = Z._fsDataMap;
                    O.oldValue != h && delete S[B], O.newValue != h && (S[B] = n)
                }
                this.onDataPropertyChanged(n, O), this._35I.fire(O)
            },
            onDataPropertyChanged: function () {},
            addDataModelChangeListener: function (d, W, Q) {
                this._36I.add(d, W, Q)
            },
            removeDataModelChangeListener: function (u, O) {
                this._36I.remove(u, O)
            },
            addSerializeListener: function (G, P, g) {
                this._serializeNotifier.add(G, P, g)
            },
            removeSerializeListener: function (I, k) {
                this._serializeNotifier.remove(I, k)
            },
            fireSerializeEvent: function (e) {
                this._serializeNotifier.fire(e)
            },
            addDataPropertyChangeListener: function (B, j, E) {
                this._35I.add(B, j, E)
            },
            removeDataPropertyChangeListener: function (F, x) {
                this._35I.remove(F, x)
            },
            _38I: function (R, I, Z) {
                this._37I && this._37I.fire({
                    data: R,
                    oldIndex: I,
                    newIndex: Z
                })
            },
            addHierarchyChangeListener: function (C, L, N) {
                this._37I || (this._37I = new le), this._37I.add(C, L, N)
            },
            removeHierarchyChangeListener: function (m, H) {
                this._37I.remove(m, H)
            },
            getSiblings: function (P) {
                var e = P._parent;
                return e ? e._children : this._roots
            },
            eachByHierarchical: function (Y, M, k) {
                if (M) return this._eachByHierarchical(Y, M, k);
                for (var G = 0, m = this._roots, s = m.size(); s > G; G++)
                    if (this._eachByHierarchical(Y, m.get(G), k) === !1) return !1;
                return !0
            },
            _eachByHierarchical: function (T, c, F) {
                if (F) {
                    if (T.call(F, c) === !1) return !1
                } else if (T(c) === !1) return !1;
                for (var B = c.size(), k = 0; B > k; k++)
                    if (this._eachByHierarchical(T, c.getChildAt(k), F) === !1) return !1;
                return !0
            },
            reverseEachByHierarchical: function (d, n, X) {
                if (n) return this._reverseEachByHierarchical(d, n, X);
                for (var I = this._roots, H = I.size(), p = H - 1; p >= 0; p--)
                    if (this._reverseEachByHierarchical(d, I.get(p), X) === !1) return !1;
                return !0
            },
            _reverseEachByHierarchical: function (z, n, N) {
                for (var l = n.size(), V = l - 1; V >= 0; V--)
                    if (this._reverseEachByHierarchical(z, n.getChildAt(V), N) === !1) return !1;
                if (N) {
                    if (z.call(N, n) === !1) return !1
                } else if (z(n) === !1) return !1;
                return !0
            },
            eachByDepthFirst: function (E, V, w) {
                if (V) return this._11I(E, V, w);
                for (var g = 0, M = this._roots, L = M.size(); L > g; g++)
                    if (this._11I(E, M.get(g), w) === !1) return !1;
                return !0
            },
            _11I: function (L, D, c) {
                for (var X = D.size(), k = 0; X > k; k++)
                    if (this._11I(L, D.getChildAt(k), c) === !1) return !1;
                if (c) {
                    if (L.call(c, D) === !1) return !1
                } else if (L(D) === !1) return !1;
                return !0
            },
            eachByBreadthFirst: function (Q, J, o) {
                var v = new vf;
                for (J ? v.add(J) : this._roots.each(v.add, v); v.size() > 0;)
                    if (J = v.removeAt(0), J.eachChild(v.add, v), o) {
                        if (Q.call(o, J) === !1) return !1
                    } else if (Q(J) === !1) return !1;
                return !0
            },
            moveTo: function (X, k) {
                var $ = this.getSiblings(X),
                    c = $.indexOf(X);
                c === k || 0 > c || k >= 0 && k <= $.size() && ($.remove(X), k > $.size() && k--, $.add(X, k), this._38I(X, c, k))
            },
            moveUp: function (e) {
                this.moveTo(e, this.getSiblings(e).indexOf(e) - 1)
            },
            moveDown: function (L) {
                this.moveTo(L, this.getSiblings(L).indexOf(L) + 1)
            },
            moveToTop: function (s) {
                this.moveTo(s, 0)
            },
            moveToBottom: function (q) {
                this.moveTo(q, this.getSiblings(q).size())
            },
            moveSelectionUp: function (D) {
                this.beginTransaction(), D || (D = this.sm());
                var S = new vf;
                so(D, S, this._roots), S.each(this.moveUp, this), this.endTransaction()
            },
            moveSelectionDown: function (m) {
                this.beginTransaction(), m || (m = this.sm());
                var T = new vf;
                Dp(m, T, this._roots), T.each(this.moveDown, this), this.endTransaction()
            },
            moveSelectionToTop: function (v) {
                this.beginTransaction(), v || (v = this.sm());
                var H = new vf;
                Gq(v, H, this._roots), H.each(this.moveToTop, this), this.endTransaction()
            },
            moveSelectionToBottom: function (l) {
                this.beginTransaction(), l || (l = this.sm());
                var n = new vf;
                be(l, n, this._roots), n.each(this.moveToBottom, this), this.endTransaction()
            },
            moveToIndex: function (X, k, s) {
                var M = this.getDatas();
                null == s && (s = M.indexOf(X)), s === k || 0 > s || k >= 0 && k <= M.size() && (M.remove(X), k > M.size() && k--, M.add(X, k), this._76I(X, s, k))
            },
            bringForward: function (p) {
                this.moveToIndex(p, this.getDatas().indexOf(p) + 1)
            },
            bringToFront: function (l) {
                this.moveToIndex(l, this.size())
            },
            sendBackward: function (L) {
                this.moveToIndex(L, this.getDatas().indexOf(L) - 1)
            },
            sendToBack: function (W) {
                this.moveToIndex(W, 0)
            },
            bringSelectionForward: function (D) {
                this.beginTransaction(), D || (D = this.sm());
                for (var p = new vf, v = this.getDatas(), m = !1, M = 0; M < v.size(); M++) {
                    var e = v.get(v.size() - 1 - M);
                    D.contains(e) ? m && p.add(e) : m = !0
                }
                p.each(this.bringForward, this), this.endTransaction()
            },
            bringSelectionToFront: function (r) {
                this.beginTransaction(), r || (r = this.sm());
                for (var Z = new vf, k = this.getDatas(), u = 0; u < k.size(); u++) {
                    var G = k.get(u);
                    r.contains(G) && Z.add(G)
                }
                Z.each(this.bringToFront, this), this.endTransaction()
            },
            sendSelectionBackward: function (M) {
                this.beginTransaction(), M || (M = this.sm());
                for (var L = new vf, d = this.getDatas(), I = !1, j = 0; j < d.size(); j++) {
                    var E = d.get(j);
                    M.contains(E) ? I && L.add(E) : I = !0
                }
                L.each(this.sendBackward, this), this.endTransaction()
            },
            sendSelectionToBack: function (X) {
                this.beginTransaction(), X || (X = this.sm());
                for (var j = new vf, Z = this.getDatas(), k = 0; k < Z.size(); k++) {
                    var f = Z.get(Z.size() - 1 - k);
                    X.contains(f) && j.add(f)
                }
                j.each(this.sendToBack, this), this.endTransaction()
            },
            addScheduleTask: function (U) {
                var A = this;
                A.removeScheduleTask(U), U.enabled == h && (U.enabled = !0), U.interval == h && (U.interval = 10), U.action == h && (U.action = qm), U.lastTime = Date.now(), A._29Q.push(U), A._30Q == h && (A._30Q = d.requestAnimationFrame(A._scheduleCallback))
            },
            removeScheduleTask: function (Q) {
                var T = this,
                    R = T._29Q,
                    N = R.indexOf(Q);
                N >= 0 && R.splice(N, 1), R.length || T._30Q == h || (d.cancelAnimationFrame(T._30Q), delete T._30Q)
            },
            getHistoryManager: function () {
                return this._historyManager
            },
            enableHistoryManager: function (f) {
                this._historyManager || new k.HistoryManager(this), null != f && this._historyManager.setMaxHistoryCount(f), this._historyManager.setDisabled(!1)
            },
            disableHistoryManager: function () {
                this._historyManager && this._historyManager.setDisabled(!0)
            },
            clearHistoryManager: function () {
                this._historyManager && this._historyManager.clear()
            },
            undo: function (g) {
                this._historyManager && this._historyManager.undo(g)
            },
            redo: function (g) {
                this._historyManager && this._historyManager.redo(g)
            },
            beginTransaction: function () {
                this._historyManager && this._historyManager.beginTransaction()
            },
            endTransaction: function () {
                this._historyManager && this._historyManager.endTransaction()
            },
            addHistory: function (p) {
                this._historyManager && this._historyManager.addHistory(p)
            },
            onHistoryManagerChanged: function () {}
        });
        var Le = k.SelectionModel = function (_) {
            var K = this;
            K._68O = Io, K._map = {}, K._73O = new vf, K._74I = new le, K._21I(_)
        };
        If("SelectionModel", x, {
            ms_fire: 1,
            ms_dm: 1,
            ms: function (d, j, X) {
                this.addSelectionChangeListener(d, j, X)
            },
            ums: function (A, D) {
                this.removeSelectionChangeListener(A, D)
            },
            fd: function () {
                return this.getFirstData()
            },
            ld: function () {
                return this.getLastData()
            },
            sg: function () {
                return this._68O === er
            },
            co: function (H) {
                return this._map[H._id] != h
            },
            ss: function (D) {
                this.setSelection(D)
            },
            as: function (J) {
                this.appendSelection(J)
            },
            rs: function (f) {
                this.removeSelection(f)
            },
            cs: function () {
                this.clearSelection()
            },
            sa: function () {
                this.selectAll()
            },
            getSelectionMode: function () {
                return this._68O
            },
            setSelectionMode: function (J) {
                var N = this;
                if (N._68O !== J && (J === Tr || J === er || J === Io)) {
                    N.cs();
                    var U = N._68O;
                    N._68O = J, N.fp("selectionMode", U, J)
                }
            },
            _21I: function (o) {
                var e = this,
                    u = e._dataModel;
                u !== o && (u && (e.cs(), u.umm(e.handleDataModelChange, e)), e._dataModel = o, o.mm(e.handleDataModelChange, e, !0), e.fp(Oq, u, o))
            },
            dispose: function () {
                var r = this;
                r.cs(), r._dataModel.umm(r.handleDataModelChange, r)
            },
            handleDataModelChange: function (p) {
                var u = this;
                if (p.kind === sc) {
                    var Q = p.data;
                    u.co(Q) && (u._73O.remove(Q), delete u._map[Q._id], u._75I(sc, new vf(Q)))
                } else p.kind === cf && u.cs()
            },
            getFilterFunc: function () {
                return this._filterFunc
            },
            setFilterFunc: function (q) {
                var D = this;
                if (D._filterFunc !== q) {
                    D.cs();
                    var f = D._filterFunc;
                    D._filterFunc = q, D.fp("filterFunc", f, D._filterFunc)
                }
            },
            _75I: function (K, S, _, D) {
                _ && (this._73O.each(function (O) {
                    D[O._id] ? _.remove(O) : _.add(O)
                }), S = _.toList()), this._74I.fire({
                    kind: K,
                    datas: new vf(S)
                })
            },
            addSelectionChangeListener: function (O, R, U) {
                this._74I.add(O, R, U)
            },
            removeSelectionChangeListener: function (C, E) {
                this._74I.remove(C, E)
            },
            _97O: function (G, _) {
                for (var B, h = this, l = 0, v = new vf(G); l < v.size(); l++) B = v.get(l), (h._filterFunc && !h._filterFunc(B) || _ && h.co(B) || !_ && !h.co(B) || !h._dataModel.contains(B)) && (v.removeAt(l), l--);
                return v
            },
            appendSelection: function (b) {
                var G = this;
                if (G._68O !== Tr) {
                    var I, o, c = G._73O,
                        E = G._97O(b, !0);
                    E.isEmpty() || (G.sg() && (I = new vf(c), o = G._map, c.clear(), G._map = {}, E = new vf(E.get(E.size() - 1))), E.each(function (k) {
                        c.add(k), G._map[k._id] = k
                    }), G._75I("append", E, I, o))
                }
            },
            removeSelection: function (P) {
                var J = this,
                    z = J._97O(P),
                    c = 0,
                    G = z.size();
                if (0 !== G) {
                    for (; G > c; c++) {
                        var n = z.get(c);
                        J._73O.remove(n), delete J._map[n._id]
                    }
                    J._75I(sc, z)
                }
            },
            toSelection: function (Y, I) {
                return this._73O.toList(Y, I)
            },
            getSelection: function () {
                return this._73O
            },
            each: function (d, I) {
                this._73O.each(d, I)
            },
            setSelection: function (U) {
                var y = this,
                    V = y._73O;
                if (y._68O !== Tr && !(V.isEmpty() && !U || 1 === V.size() && y.ld() === U)) {
                    var W = new vf(V),
                        m = y._map;
                    V.clear(), y._map = {};
                    var v = y._97O(U, !0);
                    y.sg() && v.size() > 1 && (v = new vf(v.get(v.size() - 1))), v.each(function (Q) {
                        V.add(Q), y._map[Q._id] = Q
                    }), y._75I("set", h, W, m)
                }
            },
            clearSelection: function () {
                var m = this,
                    A = m._73O;
                if (A.size() > 0) {
                    var i = A.toList();
                    A.clear(), m._map = {}, m._75I(cf, i)
                }
            },
            selectAll: function () {
                var X = this;
                if (X._68O !== Tr) {
                    var I, _, P = X._dataModel.toDatas();
                    if (X._filterFunc)
                        for (I = 0; I < P.size(); I++) _ = P.get(I), X._filterFunc(_) || (P.removeAt(I), I--);
                    var g = X._73O,
                        c = new vf(g),
                        i = X._map;
                    g.clear(), X._map = {}, X.sg() && P.size() > 1 && (P = new vf(P.get(P.size() - 1)));
                    var H = P.size();
                    for (I = 0; H > I; I++) _ = P.get(I), g.add(_), X._map[_._id] = _;
                    X._75I("all", h, c, i)
                }
            },
            size: function () {
                return this._73O.size()
            },
            isEmpty: function () {
                return this._73O.isEmpty()
            },
            contains: function (E) {
                return this._map[E._id] != h
            },
            getLastData: function () {
                var B = this._73O;
                return B.size() > 0 ? B.get(B.size() - 1) : h
            },
            getFirstData: function () {
                var S = this._73O;
                return S.size() > 0 ? S.get(0) : h
            },
            isSelectable: function (B) {
                var k = this;
                return B && k._68O !== Tr ? k._filterFunc ? k._filterFunc(B) : !0 : !1
            },
            getTopSelection: function () {
                var w = this,
                    H = new vf;
                return w._73O.each(function (V) {
                    for (var I = V.getParent(); I;) {
                        if (w.contains(I)) {
                            V = h;
                            break
                        }
                        I = I.parent
                    }
                    V && H.add(V)
                }), H
            }
        });
        var Ad = function () {
            return Ed(0),
                function (A, x) {
                    var Y;
                    if (Jk(x)) {
                        var S = A.getDataUI(x);
                        S && S._88I && (Y = S._88I.rect)
                    }
                    return Y ? Y : x.getRect()
                }
        }();
        xr(f, {
            edgeGroupAgentFunc: h,
            graphViewAutoScrollZone: 16,
            graphViewResettable: !1,
            graphViewPannable: !0,
            graphViewRectSelectable: !0,
            graphViewScrollBarVisible: !0,
            graphViewRectSelectBorderColor: F.rectSelectBorder,
            graphViewRectSelectBackground: Ve,
            graphViewEditPointSize: ah ? 17 : 7,
            graphViewEditPointBorderColor: F.editPointBorder,
            graphViewEditPointBackground: F.editPointBackground,
            setEdgeType: function (X, Z, g) {
                je[X] = Z, yc[X] = g
            },
            getEdgeType: function (Y) {
                return je[Y]
            },
            getEdgeTypeMap: function () {
                return je
            },
            getNodeRect: Ad
        }, !0), xr(C, {
            "layout.h": p,
            "layout.v": p,
            "2d.selectable": !0,
            "2d.visible": !0,
            "2d.movable": !0,
            "2d.editable": !0,
            "2d.move.mode": p,
            interactive: !1,
            "image.stretch": "fill",
            icons: p,
            ingroup: !0,
            "body.color": p,
            "2d.gray": !1,
            fullscreen: p,
            "fullscreen.gap": 2,
            "fullscreen.lock": !1,
            opacity: p,
            pixelPerfect: !0,
            keepAspectRatio: !1,
            "attach.points": null,
            "attach.style": null,
            "attach.close.threshold": 16,
            "clip.direction": "top",
            "clip.percentage": 1,
            "select.color": Zr,
            "select.width": 1,
            "select.padding": 2,
            "select.type": as,
            shadow: !1,
            "shadow.blur": 6,
            "shadow.offset.x": 3,
            "shadow.offset.y": 3,
            "border.color": p,
            "border.width": 2,
            "border.padding": 2,
            "border.type": as,
            label: p,
            "label.font": p,
            "label.color": Eo,
            "label.background": p,
            "label.position": 31,
            "label.position.fixed": !1,
            "label.offset.x": 0,
            "label.offset.y": 2,
            "label.rotation": p,
            "label.max": p,
            "label.opacity": p,
            "label.scale": 1,
            "label.align": p,
            "label.selectable": !0,
            label2: p,
            "label2.font": p,
            "label2.color": Eo,
            "label2.background": p,
            "label2.position": 34,
            "label2.position.fixed": !1,
            "label2.offset.x": 0,
            "label2.offset.y": -2,
            "label2.rotation": p,
            "label2.max": p,
            "label2.opacity": p,
            "label2.scale": 1,
            "label2.align": p,
            "label2.selectable": !0,
            note: p,
            "note.expanded": !0,
            "note.font": p,
            "note.color": Am,
            "note.background": Zr,
            "note.position": 8,
            "note.offset.x": -3,
            "note.offset.y": 3,
            "note.max": p,
            "note.toggleable": !0,
            "note.border.width": 1,
            "note.border.color": p,
            "note.opacity": p,
            "note.scale": 1,
            "note.align": p,
            note2: p,
            "note2.expanded": !0,
            "note2.font": p,
            "note2.color": Am,
            "note2.background": Zr,
            "note2.position": 3,
            "note2.offset.x": 3,
            "note2.offset.y": -3,
            "note2.max": p,
            "note2.toggleable": !0,
            "note2.border.width": 1,
            "note2.border.color": p,
            "note2.opacity": p,
            "note2.scale": 1,
            "note2.align": p,
            "group.type": p,
            "group.image": p,
            "group.image.stretch": "fill",
            "group.repeat.image": p,
            "group.padding": 8,
            "group.padding.left": 0,
            "group.padding.right": 0,
            "group.padding.top": 0,
            "group.padding.bottom": 0,
            "group.position": 17,
            "group.toggleable": !0,
            "group.title.font": p,
            "group.title.color": Am,
            "group.title.background": F.groupTitleBackground,
            "group.title.align": ul,
            "group.title.orientation": $b,
            "group.background": F.groupBackground,
            "group.depth": 1,
            "group.border.width": 1,
            "group.border.pattern": p,
            "group.border.color": Hm,
            "group.border.radius": 0,
            "group.border.cap": Lk,
            "group.border.join": Wd,
            "group.splitLine": !1,
            "group.gradient": h,
            "group.gradient.color": "#FFF",
            shape: p,
            "shape.background": Hm,
            "shape.repeat.image": p,
            "shape.border.width": 0,
            "shape.border.width.absolute": !1,
            "shape.border.color": Hm,
            "shape.border.3d": !1,
            "shape.border.3d.color": p,
            "shape.border.3d.accuracy": p,
            "shape.border.cap": Lk,
            "shape.border.join": Wd,
            "shape.border.pattern": p,
            "shape.gradient": h,
            "shape.gradient.color": "#FFF",
            "shape.depth": 0,
            "shape.dash": !1,
            "shape.dash.pattern": Zg,
            "shape.dash.offset": 0,
            "shape.dash.color": Kf,
            "shape.dash.width": p,
            "shape.dash.3d": !1,
            "shape.dash.3d.color": p,
            "shape.dash.3d.accuracy": p,
            "shape.polygon.side": 6,
            "shape.arc.from": c,
            "shape.arc.to": E,
            "shape.arc.close": !0,
            "shape.arc.oval": !1,
            "shape.corner.radius": p,
            "shape.gradient.pack": p,
            "shape.fill.rule": "nonzero",
            "shape.fill.clip.direction": "top",
            "shape.fill.clip.percentage": 1,
            "shape.foreground": p,
            "shape.foreground.gradient": h,
            "shape.foreground.gradient.color": "#FFF",
            "shape.foreground.clip.direction": "top",
            "shape.foreground.clip.percentage": 1,
            "autolayout.gap": p,
            "autolayout.hgap": p,
            "autolayout.vgap": p,
            "edge.type": p,
            "edge.points": p,
            "edge.segments": p,
            "edge.color": Hm,
            "edge.width": 2,
            "edge.width.absolute": !1,
            "edge.offset": 20,
            "edge.group": 0,
            "edge.expanded": !0,
            "edge.gap": 12,
            "edge.toggleable": !0,
            "edge.center": !1,
            "edge.3d": !1,
            "edge.3d.color": p,
            "edge.3d.accuracy": p,
            "edge.cap": Lk,
            "edge.join": Wd,
            "edge.source.position": 17,
            "edge.source.anchor.x": p,
            "edge.source.anchor.y": p,
            "edge.source.offset.x": 0,
            "edge.source.offset.y": 0,
            "edge.target.position": 17,
            "edge.target.anchor.x": p,
            "edge.target.anchor.y": p,
            "edge.target.offset.x": 0,
            "edge.target.offset.y": 0,
            "edge.pattern": p,
            "edge.dash": !1,
            "edge.dash.pattern": Zg,
            "edge.dash.offset": 0,
            "edge.dash.color": Kf,
            "edge.dash.width": p,
            "edge.dash.3d": !1,
            "edge.dash.3d.color": p,
            "edge.dash.3d.accuracy": p,
            "edge.independent": !1,
            "attach.row.index": 0,
            "attach.column.index": 0,
            "attach.row.span": 1,
            "attach.column.span": 1,
            "attach.padding": 0,
            "attach.padding.left": 0,
            "attach.padding.right": 0,
            "attach.padding.top": 0,
            "attach.padding.bottom": 0,
            "attach.index": -1,
            "attach.offset": 0,
            "attach.offset.relative": !1,
            "attach.offset.opposite": !1,
            "attach.thickness": p,
            "attach.gap": 0,
            "attach.gap.relative": !1,
            "grid.row.count": 1,
            "grid.column.count": 1,
            "grid.row.percents": p,
            "grid.column.percents": p,
            "grid.border": 1,
            "grid.border.left": 0,
            "grid.border.right": 0,
            "grid.border.top": 0,
            "grid.border.bottom": 0,
            "grid.gap": 1,
            "grid.background": F.gridBackground,
            "grid.depth": 1,
            "grid.cell.depth": -1,
            "grid.cell.border.color": F.gridCellBorderColor,
            "grid.block": p,
            "grid.block.padding": 3,
            "grid.block.width": 1,
            "grid.block.color": F.gridBlockColor,
            text: "",
            "text.align": "left",
            "text.vAlign": "middle",
            "text.color": Eo,
            "text.font": Ti,
            "text.shadow": !1,
            "text.shadow.color": Zr,
            "text.shadow.blur": 6,
            "text.shadow.offset.x": 3,
            "text.shadow.offset.y": 3,
            "text.scale.x": 1,
            "text.scale.y": 1
        }, !0), xr(Nm, {
            _76I: function (x, I, Z) {
                this._39I && this._39I.fire({
                    data: x,
                    oldIndex: I,
                    newIndex: Z
                })
            },
            addIndexChangeListener: function (u, A, l) {
                var W = this;
                W._39I || (W._39I = new le), W._39I.add(u, A, l)
            },
            removeIndexChangeListener: function (E, X) {
                this._39I.remove(E, X)
            },
            prepareRemove: function (O) {
                kn(O) && (O.setSource(h), O.setTarget(h)), O._70O && O._70O.toList().each(this.remove, this), O._69O && O._69O.toList().each(function (t) {
                    t.setHost(h)
                }), O._host && O.setHost(h)
            },
            onAdded: function (c) {
                this.isAutoAdjustIndex() && this.adjustIndex(c)
            },
            onDataPropertyChanged: function (d, l) {
                sd[l.property] && this.isAutoAdjustIndex() && this.adjustIndex(d)
            },
            isAdjustable: function (V) {
                return Cc(V) || kn(V)
            },
            isAdjustedToBottom: function (I) {
                return an(I) ? I.isExpanded() && wl(I) : !1
            },
            adjustIndex: function (R) {
                var B = this;
                this.isHierarchicalRendering() || (B.isAdjustedToBottom(R) ? (B.sendToBottom(R), R.eachChild(B.adjustIndex, B)) : B.sendToTop(R))
            },
            sendToTop: function (V) {
                var T = this;
                if (T.contains(V) && T.isAdjustable(V)) {
                    var u = T._datas;
                    if (V !== u.get(T.size() - 1)) {
                        var X = u.indexOf(V);
                        u.removeAt(X), u.add(V), T._76I(V, X, T.size() - 1)
                    }
                    if (kn(V)) {
                        var E = V._40I;
                        E && !T.isAdjustedToBottom(E) && T.sendToTop(E), E = V._41I, E && !T.isAdjustedToBottom(E) && T.sendToTop(E)
                    }
                    V._69O && V._69O.each(function (r) {
                        r.isRelatedTo(V) || Cc(V) && r.isLoopedHostOn(V) || T.sendToTop(r)
                    }), V.ISubGraph || (!an(V) || V.isExpanded()) && V._adjustChildrenToTop && V.eachChild(function (G) {
                        kn(G) || T.sendToTop(G)
                    })
                }
            },
            sendToBottom: function (q, e) {
                var c = this;
                if (q !== e && c.contains(q) && c.isAdjustable(q) && (!e || c.contains(e))) {
                    var t = c._datas,
                        j = t.remove(q),
                        J = e ? c._datas.indexOf(e) : 0;
                    if (t.add(q, J), j !== J) {
                        c._76I(q, j, J);
                        var A = q._parent;
                        !A || A.ISubGraph || kn(A) || c.sendToBottom(q._parent, q)
                    }
                }
            }
        }), xr(Wm, {
            ms_edit: function ($) {
                $._46O = function (j) {
                    var l = this,
                        U = l.gv.dm(),
                        V = l._index,
                        Y = l._89I,
                        m = l._node,
                        v = l._shape,
                        I = l._edge,
                        i = l._77I;
                    m && Y ? (this.fi({
                        kind: "endEditRect",
                        event: j,
                        data: m,
                        direction: Y
                    }), U.endTransaction()) : v && V >= 0 ? (l.fi({
                        kind: "endEditPoint",
                        event: j,
                        data: v,
                        index: V
                    }), U.endTransaction()) : I && V >= 0 ? (l.fi({
                        kind: "endEditPoint",
                        event: j,
                        data: I,
                        index: V
                    }), U.endTransaction()) : i && (l.fi({
                            kind: "endEditRotation",
                            event: j,
                            data: i
                        }), U.endTransaction())
                }, $._78I = function (X) {
                    var n = this;
                    n.autoScroll(X);
                    var v = n.gv.lp(X),
                        t = n._index,
                        x = n._89I,
                        T = n._node,
                        C = n._shape,
                        G = n._edge,
                        i = n._77I;
                    if (T && x) n._80O(v), n.fi({
                        kind: "betweenEditRect",
                        event: X,
                        data: T,
                        direction: x
                    });
                    else if (C && t >= 0) v.e = C.getPoints().get(t).e, C.setPoint(t, v), n.fi({
                        kind: "betweenEditPoint",
                        event: X,
                        data: C,
                        index: t
                    });
                    else if (G && t >= 0) {
                        var I = G.s(Wr);
                        v.e = I.get(t).e, I.set(t, v), G.fp(Wr, h, I), n.fi({
                            kind: "betweenEditPoint",
                            event: X,
                            data: G,
                            index: t
                        })
                    } else if (i) {
                        var W = i.p(),
                            o = i.getScale(),
                            S = g + H(v.y - W.y, v.x - W.x);
                        o.y < 0 && (S += c), Y(S) < .04 && (S = 0), i.setRotation(S), n.fi({
                            kind: "betweenEditRotation",
                            event: X,
                            data: i
                        })
                    }
                }, $._80O = function (Q) {
                    var T = this,
                        X = T._node,
                        x = T._rect,
                        r = x.x,
                        e = x.y,
                        h = x.width,
                        S = x.height,
                        I = T._89I,
                        m = T._anchor,
                        Y = T._matrix,
                        Q = Y.tfi(Q);
                    "northwest" === I ? x = Vj(Q, {
                        x: r + h,
                        y: e + S
                    }) : I === Ah ? x = Vj({
                        x: r,
                        y: Q.y
                    }, {
                        x: r + h,
                        y: e + S
                    }) : "northeast" === I ? x = Vj({
                        x: r,
                        y: Q.y
                    }, {
                        x: Q.x,
                        y: e + S
                    }) : I === _d ? x = Vj({
                        x: Q.x,
                        y: e
                    }, {
                        x: r + h,
                        y: e + S
                    }) : I === dk ? x = Vj({
                        x: r,
                        y: e
                    }, {
                        x: Q.x,
                        y: e + S
                    }) : "southwest" === I ? x = Vj({
                        x: Q.x,
                        y: e
                    }, {
                        x: r + h,
                        y: Q.y
                    }) : "south" === I ? x = Vj({
                        x: r,
                        y: e
                    }, {
                        x: r + h,
                        y: Q.y
                    }) : "southeast" === I && (x = Vj({
                            x: r,
                            y: e
                        }, Q)), X.setPosition(Y.tf(x.x + x.width * m.x, x.y + x.height * m.y)), X.setWidth(x.width), X.setHeight(x.height)
                }, $._80I = function (f, d, v, p) {
                    var o = this,
                        F = o.gv._zoom,
                        O = (o.gv.getEditPointSize() + 2) / F;
                    return nr({
                        x: d - O / 2,
                        y: v - O / 2,
                        width: O,
                        height: O
                    }, f) ? (o._89I !== p && (o._89I = p), !0) : !1
                }, $._79I = function (H, g, u) {
                    var S = this,
                        j = S.gv,
                        F = g ? j.getDataUI(g) : h,
                        J = F ? F._55O : h;
                    if (J) {
                        var X, x, e, l, $ = j._zoom,
                            W = (j.getEditPointSize() + 2) / $,
                            G = j.lp(H);
                        if (Cc(g)) {
                            if (J._56O && Cc(g) && (x = J._98o, nr({
                                    x: x.x - W / 2,
                                    y: x.y - W / 2,
                                    width: W,
                                    height: W
                                }, G))) return S._77I = g, u && S.fi({
                                kind: "beginEditRotation",
                                event: H,
                                data: g
                            }), S.setCursor("crosshair"), !0;
                            if (J._43O && g instanceof lh)
                                for (e = g.getPoints(), X = e.size() - 1; X >= 0; X--)
                                    if (x = e.get(X), nr({
                                            x: x.x - W / 2,
                                            y: x.y - W / 2,
                                            width: W,
                                            height: W
                                        }, G)) return S._index = X, S._shape = g, u && S.fi({
                                        kind: "beginEditPoint",
                                        event: H,
                                        data: g,
                                        index: X
                                    }), S.setCursor("crosshair"), !0;
                            if (J._42O)
                                for (var z = g.getEditControlPoints(), b = ["northwest", -1, -1, _d, -1, 0, "southwest", -1, 1, "south", 0, 1, "southeast", 1, 1, dk, 1, 0, "northeast", 1, -1, Ah, 0, -1], X = 0, l = z.length; l > X; X++) {
                                    var V = b[3 * X],
                                        r = z[X];
                                    if (S._80I(G, r.x, r.y, V)) {
                                        S._node = g;
                                        var n = g.getWidth(),
                                            v = g.getHeight(),
                                            p = g.getAnchor();
                                        S._rect = {
                                            x: -n * p.x,
                                            y: -v * p.y,
                                            width: n,
                                            height: v
                                        }, S._anchor = p, S._matrix = g.getMatrix();
                                        var f = g.getRotation(),
                                            i = w(f),
                                            O = R(f),
                                            Y = b[3 * X + 1] * Ir(g.getScale().x),
                                            L = b[3 * X + 2] * Ir(g.getScale().y),
                                            B = Math.atan2(-O * Y - i * L, i * Y - O * L),
                                            D = (Math.round(B / (Math.PI / 4)) + 8) % 8,
                                            M = [xo, "nesw-resize", Mr, "nwse-resize", xo, "nesw-resize", Mr, "nwse-resize"][D];
                                        return S.setCursor(M), u && S.fi({
                                            kind: "beginEditRect",
                                            event: H,
                                            data: g,
                                            direction: S._89I
                                        }), !0
                                    }
                                }
                        }
                        if (J._43O && kn(g) && g.s(Oo) === gs && (e = g.s(Wr)))
                            for (X = e.size() - 1; X >= 0; X--)
                                if (x = e.get(X), nr({
                                        x: x.x - W / 2,
                                        y: x.y - W / 2,
                                        width: W,
                                        height: W
                                    }, G)) return S._index = X, S._edge = g, u && S.fi({
                                    kind: "beginEditPoint",
                                    event: H,
                                    data: g,
                                    index: X
                                }), S.setCursor("crosshair"), !0
                    }
                    return !1
                }
            },
            ms_gv: function (V) {
                V._currentSubGraph = h, V._fpsInfo = {
                    time: 0,
                    fps: 0,
                    frames: 0
                }, V.upSubGraph = function () {
                    this.setCurrentSubGraph(fb(this._currentSubGraph))
                }, V.isVisible = function (v) {
                    var g = this;
                    if (fb(v) !== g._currentSubGraph) return !1;
                    if (kn(v)) {
                        var o = v._40I,
                            O = v._41I;
                        if (!o || !O) return !1;
                        if (!(v.s("edge.independent") || g.isVisible(o) && g.isVisible(O))) return !1;
                        if (v.isEdgeGroupHidden()) return !1
                    } else
                        for (var h = v._parent; h && !h.ISubGraph;) {
                            if (an(h) && (!h.isExpanded() || !g.isVisible(h))) return !1;
                            h = h._parent
                        }
                    if (v._parent instanceof tf && !g.isVisible(v._parent)) return !1;
                    if (v._refGraph instanceof mg && !g.isVisible(v._refGraph)) return !1;
                    if (g instanceof lf) {
                        if (!v.s("3d.visible")) return !1
                    } else {
                        var X = g.getLayersInfo();
                        if (X) {
                            var B = X[v._layer];
                            if (B && B.visible === !1) return !1
                        }
                        if (!v.s("2d.visible")) return !1
                    }
                    return g._visibleFunc ? g._visibleFunc(v) : !0
                }, V.handleSelectionChange = function (P) {
                    var B = this;
                    P.datas.each(function (p) {
                        B.invalidateData(p);
                        var d = p._parent;
                        an(d) && Cc(p) && p.s(ih) && (B.invalidateData(d), d._49I && d._49I.each(function (j) {
                            B.invalidateData(j)
                        }))
                    }), B.onSelectionChanged(P)
                }, V.onSelectionChanged = function (g) {
                    var l = this,
                        A = l.sm();
                    if (1 === A.size() && ("set" === g.kind || "append" === g.kind)) {
                        var J = A.ld();
                        l.isAutoMakeVisible() && l.makeVisible(J), l.adjustIndex && l._dataModel.isAutoAdjustIndex() && l.adjustIndex(J)
                    }
                }, V.makeVisible = function (L) {
                    if (L) {
                        var d = this,
                            y = d.getDataUI ? d.getDataUI(L) : d.getData3dUI(L);
                        if (y) {
                            var c = L,
                                U = fb(L);
                            for (U !== d._currentSubGraph && d.setCurrentSubGraph(U);
                                 (c = c._parent) && c !== U;) an(c) && c.setExpanded(!0);
                            d._23I = L, d.iv()
                        }
                    }
                }, V.getLabel = function (o) {
                    var H = o.getStyle(Qk);
                    return H === p ? o.getName() : H
                }, V.getLabelBackground = function (I) {
                    return I.getStyle("label.background")
                }, V.getLabelColor = function (j) {
                    return j.getStyle("label.color")
                }, V.getLabel2 = function (H) {
                    return H.getStyle("label2")
                }, V.getLabel2Background = function (T) {
                    return T.getStyle("label2.background")
                }, V.getLabel2Color = function (q) {
                    return q.getStyle("label2.color")
                }, V.getNote = function (O) {
                    return O.getStyle(zm)
                }, V.getNoteBackground = function (u) {
                    return u.getStyle("note.background")
                }, V.getNote2 = function (C) {
                    return C.getStyle(Uj)
                }, V.getNote2Background = function (C) {
                    return C.getStyle("note2.background")
                }, V.handleClick = function (R, u, i) {
                    var N = this;
                    u ? (N.fi({
                        kind: "clickData",
                        event: R,
                        data: u,
                        part: i
                    }), N.onDataClicked(u, R)) : (N.fi({
                        kind: "clickBackground",
                        event: R
                    }), N.onBackgroundClicked(R))
                }, V.handleDoubleClick = function (l, d, W) {
                    var a = this;
                    Bf(l) && (d ? (a.fi({
                        kind: "doubleClickData",
                        event: l,
                        data: d,
                        part: W
                    }), a.onDataDoubleClicked(d, l, W), a.checkDoubleClickOnNote(l, d, W) || a.checkDoubleClickOnRotation && a.checkDoubleClickOnRotation(l, d, W) || (kn(d) ? a.onEdgeDoubleClicked(d, l, W) : d.ISubGraph ? a.onSubGraphDoubleClicked(d, l, W) : an(d) ? a.onGroupDoubleClicked(d, l, W) : d.IDoorWindow ? a.onDoorWindowDoubleClicked(d, l, W) : d.ICSGBox && a.onCSGBoxDoubleClicked(d, l, W))) : (a.fi({
                        kind: "doubleClickBackground",
                        event: l
                    }), a.onBackgroundDoubleClicked(l)))
                }, V.onSubGraphDoubleClicked = function (h) {
                    this.setCurrentSubGraph(h)
                }, V.onEdgeDoubleClicked = function ($, o) {
                    $.ISubGraph && !Ab(o) ? this.setCurrentSubGraph($) : $.s("edge.toggleable") && $.toggle()
                }, V.onGroupDoubleClicked = function (w) {
                    w.s("group.toggleable") && w.toggle()
                }, V.onDoorWindowDoubleClicked = function (k) {
                    k.s("dw.toggleable") && k.toggle(!0)
                }, V.onCSGBoxDoubleClicked = function (d, v) {
                    var Y = this;
                    if (Y instanceof lf) {
                        var f = Y.getHitFaceInfo(v);
                        f && f.face && d.s(f.face + ".toggleable") && d.toggleFace(f.face, !0)
                    }
                }, V.onBackgroundClicked = function () {}, V.onBackgroundDoubleClicked = function () {
                    this.upSubGraph()
                }, V.onDataClicked = function () {}, V.onDataDoubleClicked = function () {}, V.onAutoLayoutEnded = function () {}, V.onMoveEnded = function () {}, V.onPanEnded = function () {}, V.onPinchEnded = function () {}, V.onRectSelectEnded = function () {}, V.onZoomEnded = function () {}, V.serialize = function (m) {
                    return this.dm().serialize(m)
                }, V.toJSON = function () {
                    return this.dm().toJSON()
                }, V.deserialize = function (Z, _) {
                    return _ = _ instanceof rr ? {
                        rootParent: _
                    } : rl(_) ? {
                        setId: _
                    } : Yr(_) ? {
                        finishFunc: _
                    } : _ || {}, _.view = this, this.dm().deserialize(Z, _.rootParent, _)
                }, V.showDebugTip = function () {
                    var T = this,
                        E = T._debugDiv;
                    if (!E) {
                        E = T._debugDiv = b.createElement("div"), E.style.position = "absolute", E.style.overflow = "hidden", E.style.backgroundColor = "white", E.style.color = "black";
                        var r = T.getView();
                        T._79O ? r.insertBefore(E, T._79O) : r.appendChild(E);
                        var M = function () {
                            T.redraw();
                            var W = "FPS : " + T._fpsInfo.fps + "<br/>" + "Datas : " + T.dm().getDatas().length,
                                Y = T.getDebugTip();
                            Y && (W += "<br/>------<br/>" + Y), E.innerHTML = W, T._isDebugging && requestAnimationFrame(M)
                        };
                        requestAnimationFrame(M), T._isDebugging = !0
                    }
                }, V.hideDebugTip = function () {
                    var c = this,
                        x = c._debugDiv;
                    x && (delete c._debugDiv, c.getView().removeChild(x), c._isDebugging = !1)
                }, V.countFrame = function () {
                    if (this._isDebugging) {
                        var K = Date.now(),
                            Q = this._fpsInfo;
                        K - Q.time > 1e3 ? (Q.fps = Math.round(1e5 * (Q.frames + 1) / (K - Q.time)) / 100, Q.time = K, Q.frames = 0) : Q.frames++
                    }
                }
            },
            ms_icons: function (d) {
                d.getRotation = function (K) {
                    return K == h ? 0 : K
                }, d._15O = function () {
                    var d = this,
                        u = d.s(lk);
                    if (u) {
                        var f = d,
                            x = d.data || d._data,
                            J = d._38o = {
                                icons: u,
                                rects: {}
                            };
                        for (var B in u) {
                            var r = u[B],
                                E = ze(r.shape3d, x, f);
                            if (!(ze(r.visible, x, f) === !1 || ze(r.for3d, x, f) && !d.I3d || E && !d.I3d)) {
                                var Q = E ? [E] : ze(r.names, x, f),
                                    D = Q ? Q.length : 0,
                                    s = ze(r.position, x, f) || 3,
                                    l = ze(r.offsetX, x, f) || 0,
                                    y = ze(r.offsetY, x, f) || 0,
                                    O = ze(r.direction, x, f) || dk,
                                    T = ze(r.gap, x, f),
                                    X = T != h ? T : 1,
                                    q = ze(r.rotation, x, f),
                                    a = ze(r.keepOrien, x, f),
                                    k = ze(r.rotationFixed, x, f) ? q : d.getRotation(q, a, s),
                                    o = h,
                                    N = J.rects[B] = new Array(D);
                                N.rotation = k;
                                for (var W = 0; D > W; W++) {
                                    var Z, C, I, n, A = Q[W];
                                    if (E) I = 0, n = 0;
                                    else {
                                        var v = Qn(A);
                                        I = ze(r.width, x, f), n = ze(r.height, x, f), I == h && (I = Df(v, x)), n == h && (n = Dd(v, x))
                                    }
                                    if (o ? O === dk ? l += I / 2 : O === _d ? l -= I / 2 : O === Ah ? y -= n / 2 : y += n / 2 : o = {
                                            width: I,
                                            height: n
                                        }, d.I3d) {
                                        var F = -I / 2,
                                            p = -n / 2;
                                        C = {
                                            width: I,
                                            height: n,
                                            mat: d._16O(ze(r.autorotate, x, f), s, o, ze(r.face, x, f) || fg, ze(r.t3, x, f), ze(r.r3, x, f), ze(r.rotationMode, x, f), l, y),
                                            vs: new Ol([F, -p, 0, F, -p - n, 0, F + I, -p - n, 0, F + I, -p, 0])
                                        }
                                    } else Z = d.getPosition(s, l, y, o, ze(r.positionFixed, x, f)), C = {
                                        x: Z.x - I / 2,
                                        y: Z.y - n / 2,
                                        width: I,
                                        height: n
                                    }, d._68o(C, k);
                                    N[W] = C, O === dk ? l += I / 2 + X : O === _d ? l -= I / 2 + X : O === Ah ? y -= n / 2 + X : y += n / 2 + X
                                }
                            }
                        }
                    }
                }
            }
        });
        var Mg = {
                1: 1,
                2: 1,
                6: 1,
                9: 1,
                10: 1,
                14: 1,
                15: 1,
                16: 1,
                21: 1,
                22: 1,
                26: 1,
                29: 1,
                30: 1,
                34: 1,
                36: 1,
                38: 1,
                40: 1,
                42: 1,
                45: 1,
                50: 1,
                52: 1,
                54: 1
            },
            Gj = {
                3: 1,
                7: 1,
                11: 1,
                17: 1,
                23: 1,
                27: 1,
                31: 1,
                44: 1,
                46: 1,
                47: 1,
                49: 1
            },
            im = {
                translateX: 1,
                translateY: 1,
                zoom: 1,
                scrollBarVisible: 1
            },
            sd = {
                sourceAgent: 1,
                targetAgent: 1,
                expanded: 1,
                parent: 1,
                host: 1
            },
            Mj = {
                position: 1,
                width: 1,
                height: 1,
                expanded: 1,
                rotation: 1,
                anchor: 1,
                scale: 1,
                "s:edge.points": 1
            },
            Hn = {
                "edge.type": 1,
                "edge.group": 1
            },
            dc = {
                rotation: 1,
                rotationX: 1,
                rotationZ: 1
            },
            Yk = {
                position: 1,
                width: 1,
                height: 1,
                anchor: 1,
                scale: 1,
                "s:grid.row.count": 1,
                "s:grid.column.count": 1,
                "s:grid.row.percents": 1,
                "s:grid.column.percents": 1,
                "s:grid.border": 1,
                "s:grid.border.left": 1,
                "s:grid.border.right": 1,
                "s:grid.border.top": 1,
                "s:grid.border.bottom": 1,
                "s:grid.gap": 1
            },
            Dg = {
                "attach.row.index": 1,
                "attach.column.index": 1,
                "attach.row.span": 1,
                "attach.column.span": 1,
                "attach.padding": 1,
                "attach.padding.left": 1,
                "attach.padding.right": 1,
                "attach.padding.top": 1,
                "attach.padding.bottom": 1,
                "attach.index": 1,
                "attach.offset": 1,
                "attach.offset.relative": 1,
                "attach.offset.opposite": 1,
                "attach.gap": 1,
                "attach.gap.relative": 1,
                "attach.thickness": 1
            },
            Rg = {
                shape: 1,
                thickness: 1,
                position: 1,
                anchor: 1,
                scale: 1
            },
            Pc = function (D, X) {
                if (!D || !an(X) || X.isEmpty()) return !1;
                for (D = D._parent; an(D);) {
                    if (D === X) return !0;
                    D = D._parent
                }
                return !1
            },
            vb = function (J, h) {
                if (!J || !Sg(h) || h.isEmpty()) return !1;
                for (J = J._parent; Sg(J);) {
                    if (J === h) return !0;
                    J = J._parent
                }
                return !1
            },
            fb = function (g) {
                if (!g) return h;
                if (kn(g)) {
                    var G = g._40I,
                        W = g._41I;
                    if (!G || !W) return h;
                    var v = fb(G),
                        l = fb(W);
                    return v === l ? v : h
                }
                for (var j = g._parent; kn(j) && !j.ISubGraph;) j = j._parent;
                return j ? j.ISubGraph ? j : fb(j) : h
            },
            te = function (D, k, b, h) {
                var j = k.getStyle(b) * h;
                j && $d(D, j), j = k.getStyle(b + ".left") * h, j && (D.x -= j, D.width += j), j = k.getStyle(b + ".right") * h, j && (D.width += j), j = k.getStyle(b + ".top") * h, j && (D.y -= j, D.height += j), j = k.getStyle(b + ".bottom") * h, j && (D.height += j), D.width < 0 && (D.width = -D.width, D.x -= D.width), D.height < 0 && (D.height = -D.height, D.y -= D.height)
            },
            wl = function (w) {
                for (var z, M = 0, k = w.size(); k > M; M++)
                    if (z = w.getChildAt(M), Cc(z) && wl(z)) return !0;
                return w.hasAgentEdges()
            },
            gh = function (N) {
                if (!N) return h;
                for (var A = N._parent; an(A);) {
                    if (!an(A._parent)) return A.isExpanded() ? N : A;
                    A.isExpanded() || (N = A), A = A._parent
                }
                return N
            },
            _f = function (m, J) {
                if (!m || !J) return h;
                var Z, w, j, a = fb(m),
                    I = fb(J);
                if (a !== I) {
                    for (; I && a !== I;) I = fb(I);
                    if (a === I) return m;
                    Z = new vf, Z.add(m, 0);
                    for (var s = m._parent; Cc(s) && !J.isDescendantOf(s);) Z.add(s, 0), s = s._parent;
                    for (j = Z.size(), w = 0; j > w; w++) {
                        var T = Z.get(w);
                        if (an(T) && !T.isExpanded()) return T;
                        if (T.ISubGraph) return T
                    }
                    return m
                }
                return m
            },
            Vk = function (N) {
                if (N.isLooped()) return N._source;
                var d = gh(N._source),
                    Z = gh(N._target);
                return d === Z ? N._source : _f(d, Z)
            },
            Ag = function (x) {
                if (x.isLooped()) return x._target;
                var g = gh(x._source),
                    y = gh(x._target);
                return g === y ? x._target : _f(y, g)
            },
            rg = function (t, T, J, L, P, _, z) {
                if (!T) return h;
                var C, a = T.getRotation ? T.getRotation() : 0;
                if (_ !== p || z !== p)
                    if (_ = _ === p ? .5 : _, z = z === p ? .5 : z, a && !Jk(T, t)) {
                        var M = T.getPosition(),
                            m = T.getWidth(),
                            Z = T.getHeight(),
                            e = T.getAnchor(),
                            f = T.getScale(),
                            Q = new xe(a, M.x, M.y, f.x, f.y);
                        J = Q.tf((_ - e.x) * m, (z - e.y) * Z)
                    } else C = Ad(t, T), J = {
                        x: C.x + _ * C.width,
                        y: C.y + z * C.height
                    };
                else J = sj(J, Ad(t, T));
                if (a) {
                    var k = w(a),
                        D = R(a),
                        O = L * k - P * D;
                    P = L * D + P * k, L = O
                }
                return J.x += L, J.y += P, J
            },
            cg = function (t, w) {
                if (!t || !w) return h;
                var q, p, v, f, y, g;
                if (t === w) {
                    if (f = t.getLoopedEdges(), !f) return h;
                    f = new vf(f)
                } else {
                    if (y = t.getAgentEdges(), g = w.getAgentEdges(), !y || !g) return h;
                    for (p = y.size(), q = 0; p > q; q++) v = y.get(q), g.contains(v) && (f || (f = new vf), f.add(v))
                }
                if (f)
                    for (q = 0; q < f.size(); q++) v = f.get(q), v.getStyle(Oo) === gs && (v._22I(h), f.removeAt(q), q--);
                return f
            },
            js = function (i, J) {
                var d = cg(i, J);
                if (d && !d.isEmpty()) {
                    if (1 === d.size()) return d.get(0)._22I(h), void 0;
                    var T = new vf,
                        y = new vf;
                    d.each(function ($) {
                        var z = $.s("edge.group");
                        T.contains(z) || T.add(z)
                    }), T.sort(), T.each(function (D) {
                        y.add(new k.EdgeGroup(d.toList(function (j) {
                            return D === j.s("edge.group")
                        }), y))
                    }), y.each(function (C) {
                        C.each(function (A) {
                            A._22I(C)
                        })
                    })
                }
            },
            pj = function (V, H) {
                if (H) {
                    var J = H.rect,
                        s = H.color,
                        O = H.rotation,
                        w = H.labelWidth,
                        X = H.background,
                        z = H.opacity,
                        q = H.scale,
                        I = q != h && 1 !== q;
                    if (z != h) {
                        var p = V.globalAlpha;
                        V.globalAlpha *= z
                    }
                    if (O || I) {
                        V.save();
                        var W = J.x + J.width / 2,
                            M = J.y + J.height / 2;
                        Aj(V, W, M), O && Zp(V, O), I && V.scale(q, q), Aj(V, -W, -M)
                    }
                    if (X && to(V, J.x, J.y, J.width, J.height, X), w) {
                        var u = J.width,
                            C = V.createLinearGradient(J.x, J.y, J.x + u, J.y);
                        C.addColorStop(0, s), C.addColorStop(.9, s), C.addColorStop(1, ql), s = C, J.width = w
                    }
                    Nq(V, H.ss, J, H.font, s, H.align), w && (J.width = u), (O || I) && V.restore(), z != h && (V.globalAlpha = p)
                }
            },
            Te = function (T, r) {
                if (r) {
                    var m = r.rect,
                        B = m.x,
                        K = m.y,
                        O = m.width,
                        C = m.height,
                        A = r.background,
                        p = r.backgroundImage,
                        X = r.borderWidth,
                        y = r.borderColor,
                        f = r.labelWidth,
                        i = r.opacity,
                        V = r.scale,
                        l = V != h && 1 !== V;
                    if (i != h) {
                        var I = T.globalAlpha;
                        T.globalAlpha *= i
                    }
                    if (l) {
                        T.save();
                        var L = m.x + m.width / 2,
                            t = m.y + m.height / 2;
                        Aj(T, L, t), T.scale(V, V), Aj(T, -L, -t)
                    }
                    if (r.expanded) {
                        var n = j(8, O / 4),
                            x = K + C - 8;
                        if (T.fillStyle = A, T.beginPath(), T.moveTo(B, K), T.lineTo(B, x), T.lineTo(B + O / 2, x), T.lineTo(B + O / 2, K + C), T.lineTo(B + O / 2 + n, x), T.lineTo(B + O, x), T.lineTo(B + O, K), T.closePath(), T.fill(), X && (T.lineWidth = X, T.lineJoin = "round", T.lineCap = "round", y ? (T.strokeStyle = y, T.stroke()) : (T.strokeStyle = jg(A), T.beginPath(), T.moveTo(B + O, K), T.lineTo(B + O, x), T.lineTo(B + O / 2 + n, x), T.lineTo(B + O / 2, K + C), T.stroke(), T.strokeStyle = Lb(A), T.beginPath(), T.moveTo(B + O, K), T.lineTo(B, K), T.lineTo(B, x), T.lineTo(B + O / 2, x), T.lineTo(B + O / 2, K + C), T.stroke())), p) zk(T, Qn(p), Hq, m.x, m.y, m.width, m.height - 8, r.data, r.view);
                        else {
                            if (m.height -= 8, A = r.color, f) {
                                var S = O,
                                    J = T.createLinearGradient(B, K, B + S, K);
                                J.addColorStop(0, A), J.addColorStop(.9, A), J.addColorStop(1, ql), A = J, m.width = f
                            }
                            Nq(T, r.ss, m, r.font, A, r.align), f && (m.width = S), m.height += 8
                        }
                    } else if (r.icon) wp(T, Qn(r.icon), B, K, O, C, r.data, r.view);
                    else {
                        var z = O / 2;
                        X && (T.lineWidth = X, T.lineJoin = "round", T.lineCap = "round", T.strokeStyle = y ? y : jg(A), T.beginPath(), T.arc(B + z, K + z, z, g, 1.6 * c, !0), T.moveTo(B + z, K + C), T.lineTo(B + O - z / 5, K + z), T.stroke(), T.strokeStyle = y ? y : Lb(A), T.beginPath(), T.arc(B + z, K + z, z, 1.6 * c, g, !0), T.moveTo(B + z, K + C), T.lineTo(B + z / 5, K + z), T.stroke()), T.fillStyle = A, T.beginPath(), T.arc(B + z, K + z, z, 0, E, !0), T.moveTo(B + z, K + C), T.lineTo(B + O - z / 5, K + z), T.lineTo(B + z / 5, K + z), T.closePath(), T.fill(), T.fillStyle = r.color, T.beginPath(), T.arc(B + z, K + z, z / 3, 0, E, !0), T.fill()
                    }
                    l && T.restore(), i != h && (T.globalAlpha = I)
                }
            },
            Sk = function ($, F) {
                return F > 2 * $ ? $ : F / 2
            },
            gi = function (j, J, L, S) {
                if (!j || !J) return 0;
                var d = H(J.y - j.y, J.x - j.x);
                return L || (d = J.x < j.x ? d + c : d), d + S
            },
            vs = function (E, K, n, t, v, A, U) {
                U && (E.x > K.x || E.x === K.x && E.y > K.y) && (n = Xm[n], v = -v);
                var R = sj(n, {
                    x: 0,
                    y: 0,
                    width: Me(E, K),
                    height: 0
                }, A);
                return R.x += t, R.y += v, R = new xe(H(K.y - E.y, K.x - E.x)).tf(R), R.x += E.x, R.y += E.y, R
            },
            hd = function (Z, _, o, a, t) {
                if (Z._19Q = !0, !o.getEdgeGroup()) return a ? o.s("edge.gap") : 0;
                var T, R = 0,
                    L = 0,
                    j = 0;
                if (o.getEdgeGroup().getSiblings().each(function (v) {
                        v.each(function (F) {
                            if (_.isVisible(F) && F.s(Oo) == t) {
                                var l = F.s("edge.gap");
                                T ? (L += j / 2 + l / 2, j = l) : (T = F, j = l), F === o && (R = L)
                            }
                        })
                    }), a) return L - R + j;
                var Y = R - L / 2;
                return T && o._40I !== T._40I && (Z._19Q = !1), Y
            },
            xd = function () {
                var C = function (F) {
                    var L = [];
                    return F.forEach(function (b) {
                        L.push({
                            x: b.x,
                            y: b.y
                        }), L.push({
                            x: b.x + b.width,
                            y: b.y + b.height
                        }), L.push({
                            x: b.x + b.width,
                            y: b.y
                        }), L.push({
                            x: b.x,
                            y: b.y + b.height
                        })
                    }), L
                };
                return function (K, Z, F) {
                    if ("oval" === K) {
                        var n = 0,
                            I = F.height / F.width,
                            N = I * I,
                            i = F.x + F.width / 2,
                            x = F.y + F.height / 2,
                            f = C(Z);
                        f.forEach(function (V) {
                            var S = V.x - i,
                                L = V.y - x,
                                A = S * S + L * L / N;
                            A > n && (n = A)
                        }), n = l(n);
                        var q = I * n;
                        return {
                            x: i - n,
                            y: x - q,
                            width: 2 * n,
                            height: 2 * q
                        }
                    }
                    if ("circle" === K) {
                        var g = 0,
                            i = F.x + F.width / 2,
                            x = F.y + F.height / 2,
                            f = C(Z);
                        return f.forEach(function (P) {
                            var v = P.x - i,
                                T = P.y - x,
                                t = v * v + T * T;
                            t > g && (g = t)
                        }), g = l(g), {
                            x: i - g,
                            y: x - g,
                            width: 2 * g,
                            height: 2 * g
                        }
                    }
                    return "roundRect" === K ? ($d(F, j(F.width, F.height) / 16), F) : F
                }
            }(),
            zj = k.graph = {},
            kp = function (T, D, G) {
                zc(N + ".graph." + T, D, G)
            };
        k.layout = {};
        var Pk = {},
            sr = function (u, j, h, E, w, m, g, B) {
                var F = [j.uuid, Math.round(E), Math.round(w), h].join("_");
                j.cacheRule && (F += ze(j.cacheRule, m, g));
                var Z = g._zoom;
                Z !== g._cacheZoom && (g._cacheZoom = Z, g._cacheImage = {});
                var l = g._cacheImage[F];
                return l || (l = g._cacheImage[F] = k.Default.toCanvas(j, E * Z, w * Z, h, m, g, B)), l
            };
        xr(f, {
            setImageCacheRule: function (D, r) {
                var T;
                T = r || "object" != typeof D ? {
                    _image: r
                } : D;
                for (var N in T) {
                    var l = T[N];
                    Qc(N) ? (zc = Qn(N), zc ? zc.cacheRule = l : Pk[N] = l) : N.cacheRule = l
                }
            }
        });
        var zg = {
            comps: [{
                type: ef,
                points: [85, 50, 70, 115, 100, 71, 86, 107, 88, 49, 43, 88, 82, 66, 52, 116, 43, 85, 81, 87, 55, 74, 56, 104, 73, 102, 98, 122, 107, 78, 111, 51, 117, 84, 101, 99, 81, 80, 88, 100, 57, 114, 103, 61],
                borderWidth: 1,
                borderColor: h
            }]
        };
        if (zg[hi] = zg[bg] = 160, d.Image) {
            var Hr = new d.Image;
            Hr.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC", Ej("default_blank", Hr)
        }
        Ej("node_image", Zn(30, 30, [{
            type: as,
            rect: [4, 5, 22, 16],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [2, 3, 26, 20],
            borderWidth: 1,
            borderColor: Hm
        }, {
            type: as,
            rect: [11, 23, 8, 4],
            background: Hm
        }, {
            type: as,
            rect: [6, 27, 18, 2],
            background: Hm
        }])), Ej("node_icon", Zn(16, 16, [{
            type: as,
            rect: [2, 2, 12, 10],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: ae,
            rect: [2, 2, 12, 10],
            width: 1,
            color: Hm
        }, {
            type: as,
            rect: [6, 12, 4, 2],
            background: Hm
        }, {
            type: as,
            rect: [4, 14, 8, 1],
            background: Hm
        }])), Ej("block_icon", Zn(16, 16, [{
            type: ae,
            rect: [1, 1, 14, 14],
            width: 1,
            color: Hm
        }])), Ej("group_image", Zn(66, 39, [{
            type: as,
            rect: [44.3, 18, 18.1, 12.8],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [3.3, 17.8, 18.1, 12.8],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [15.8, 3.2, 33.5, 26.4],
            borderWidth: 1,
            borderColor: Hm,
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [26.2, 29.4, 12.8, 4.2],
            background: Hm
        }, {
            type: as,
            rect: [21.3, 33.5, 22.5, 2.3],
            background: Hm
        }, {
            type: as,
            rect: [5.3, 32.7, 14.1, 2.1],
            background: Hm
        }, {
            type: as,
            rect: [9, 30.4, 6.7, 2.4],
            background: Hm
        }, {
            type: as,
            rect: [50, 30.7, 6.7, 2.4],
            background: Hm
        }, {
            type: as,
            rect: [46.3, 33, 14.1, 2.1],
            background: Hm
        }])), Ej("group_icon", Zn(16, 16, [{
            type: as,
            rect: [4, 12, 4, 2],
            background: Hm
        }, {
            type: as,
            rect: [2, 13, 8, 1],
            background: Hm
        }, {
            type: as,
            rect: [12, 12, 2, 1],
            background: Hm
        }, {
            type: as,
            rect: [11, 13, 4, 1],
            background: Hm
        }, {
            type: as,
            rect: [10, 7, 6, 5],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [1, 2, 10, 10],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: ae,
            rect: [1, 2, 10, 10],
            width: 1,
            color: Hm
        }])), Ej("refGraph_icon", Zn(16, 16, [{
            type: "shape",
            borderWidth: 1,
            borderColor: Hm,
            borderCap: "round",
            rotation: .7854,
            points: [12.5502, 6.7981, 12.5502, 6.7981, 12.5502, 4.8181, 12.5502, 3.7981, 12.5502, 2.7781, 11.36687, 1.7981, 10.0502, 1.7981, 8.73354, 1.7981, 7.5502, 2.8181, 7.5502, 3.7981, 7.5502, 4.55989, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 7.79805, 7.5502, 9.7981, 10.0502, 9.7981],
            segments: [1, 4, 4, 4, 4, 4]
        }, {
            type: "shape",
            borderWidth: 1,
            borderColor: Hm,
            borderCap: "round",
            rotation: -2.35619,
            points: [8.4498, 11.2019, 8.4498, 11.2019, 8.4498, 9.2219, 8.4498, 8.2019, 8.4498, 7.1819, 7.26646, 6.2019, 5.9498, 6.2019, 4.63313, 6.2019, 3.4498, 7.2219, 3.4498, 8.2019, 3.4498, 8.9637, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 12.20186, 3.4498, 14.2019, 5.9498, 14.2019],
            segments: [1, 4, 4, 4, 4, 4]
        }])), Ej("edge_icon", Zn(16, 16, [{
            type: as,
            rect: [2.1, 6.9, 11.5, 2.6],
            rotation: -.79,
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [10.8, 1, 4, 4],
            background: Hm
        }, {
            type: as,
            rect: [1, 11, 4, 4],
            background: Hm
        }])), Ej("subGraph_image", Zn(72, 45, [{
            type: ef,
            points: [9, 42, .3, 38.4, 2.4, 28.8, 5.7, 21.6, 11.7, 22.5, 11.7, 15.9, 16.8, 13.8, 21.6, 12, 24.3, 15.9, 27.9, 3, 42.3, 2.1, 59.4, 4.5, 57.3, 18.3, 67.5, 18.9, 69.6, 27.3, 69.9, 38.4, 64.2, 41.4],
            segments: [1, 3, 3, 3, 3, 3, 3, 3, 3],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [29.6, 30.7, 3.6, 1.8],
            background: Hm
        }, {
            type: as,
            rect: [28.4, 32.3, 6, 1.2],
            background: Hm
        }, {
            type: as,
            rect: [37.3, 32, 10.8, 1.8],
            background: Hm
        }, {
            type: as,
            rect: [39.1, 29.9, 7.2, 2.3],
            background: Hm
        }, {
            type: as,
            rect: [26.6, 23.7, 9.6, 7.2],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }, {
            type: as,
            rect: [34.3, 16.8, 16.8, 13.2],
            borderWidth: 1,
            borderColor: Hm,
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }])), Ej("subGraph_icon", Zn(17, 17, [{
            type: ef,
            points: [2.2, 14.6, .2, 11.9, .8, 8.8, 1.8, 5.9, 5.6, 7.4, 3.8, 1.6, 10.3, 3, 14.5, 4.2, 12.2, 7.5, 18.9, 7.2, 14.5, 14.5],
            segments: [1, 3, 3, 3, 3, 3],
            gradient: Xb,
            gradientColor: ho,
            background: Hm
        }])), Ej("shape_icon", Zn(16, 16, [{
            type: ef,
            points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1],
            background: Hm
        }])), Ej("polyline_icon", Zn(16, 16, [{
            type: ef,
            points: [1.5, 1, 8.4, 1, 8.4, 7.2, 14.6, 7.1, 14.6, 14.9, 1.5, 14.9, 1.5, 1],
            borderWidth: 1,
            borderColor: Hm
        }, Km(7.5, .4), Km(7.5, 6.3), Km(13.6, 6.3), Km(13.6, 14), Km(.7, 13.9), Km(.7, .3)])), Ej("grid_icon", Zn(16, 16, [{
            type: as,
            rect: [1, 1, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [6, 1, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [11, 1, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [11, 6, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [6, 6, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [1, 6, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [11, 11, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [6, 11, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }, {
            type: as,
            rect: [1, 11, 4, 4],
            background: Hm,
            gradient: Xb,
            gradientColor: ho
        }])), Ej("light_icon", Zn(16, 16, [{
            type: "rect",
            rect: [6, 9, 5, 5],
            borderWidth: 1,
            borderColor: Hm
        }, {
            type: "circle",
            rect: [1, 1, 15, 10],
            borderWidth: 1,
            borderColor: Hm,
            gradient: Xb,
            gradientColor: ho,
            background: {
                func: function (L) {
                    var B = L ? L.s(ff) : h;
                    return nj(B) ? "rgb(" + A(255 * B[0]) + "," + A(255 * B[1]) + "," + A(255 * B[2]) + ")" : B || Hm
                }
            }
        }])), Ej("text_icon", Zn(16, 16, [{
            type: "shape",
            points: [3, 3, 13, 3, 8, 3, 8, 14],
            segments: [1, 2, 1, 2],
            borderWidth: 1,
            borderColor: Hm
        }])), Ej("border_image", {
            fitSize: !0,
            comps: [{
                type: "border",
                relative: !0,
                rect: [0, 0, 1, 1],
                color: {
                    func: "style@border_color"
                },
                width: {
                    func: "style@border_width"
                }
            }]
        }), Ej("columnChart_image", {
            fitSize: !0,
            boundExtend: 150,
            comps: [{
                type: {
                    func: "style@chart.type"
                },
                relative: !0,
                rect: [0, 0, 1, 1],
                label: {
                    func: "style@chart.label"
                },
                labelColor: {
                    func: "style@chart.label.color"
                },
                labelFont: {
                    func: "style@chart.label.font"
                },
                series: {
                    func: "style@chart.series"
                },
                minValue: {
                    func: "style@chart.min.value"
                },
                maxValue: {
                    func: "style@chart.max.value"
                }
            }]
        }), Ej("lineChart_image", {
            fitSize: !0,
            boundExtend: 150,
            comps: [{
                type: "lineChart",
                relative: !0,
                rect: [0, 0, 1, 1],
                label: {
                    func: "style@chart.label"
                },
                labelColor: {
                    func: "style@chart.label.color"
                },
                labelFont: {
                    func: "style@chart.label.font"
                },
                series: {
                    func: "style@chart.series"
                },
                minValue: {
                    func: "style@chart.min.value"
                },
                maxValue: {
                    func: "style@chart.max.value"
                },
                linePoint: {
                    func: "style@chart.line.point"
                },
                lineWidth: {
                    func: "style@chart.line.width"
                },
                line3d: {
                    func: "style@chart.line.3d"
                }
            }]
        }), Ej("pieChart_image", {
            fitSize: !0,
            boundExtend: 150,
            comps: [{
                type: "pieChart",
                relative: !0,
                rect: [0, 0, 1, 1],
                label: {
                    func: "style@chart.label"
                },
                labelColor: {
                    func: "style@chart.label.color"
                },
                labelFont: {
                    func: "style@chart.label.font"
                },
                hollow: {
                    func: "style@chart.hollow"
                },
                startAngle: {
                    func: "style@chart.start.angle"
                },
                values: {
                    func: "style@chart.values"
                },
                colors: {
                    func: "style@chart.colors"
                }
            }]
        });
        var Wk = function (F, U) {
                for (var Z = F.vertices, p = 0; p < Z.length; p++) {
                    var G = Z[p],
                        D = G.y;
                    G.y = G.z, G.z = -D, U && (G.y += U)
                }
            },
            hf = function (z) {
                for (var p, a, S, A, l, s, M = [], f = [], C = [], G = z.faces, D = 0, X = 0, c = 0, u = G.length; u > D; D++, X += 6, c += 9) {
                    var Y = G[D];
                    1 === Y.i ? (p || (p = [], a = [], S = []), Aq(Y, D, X, c, z, p, S, a)) : 2 === Y.i ? (A || (A = [], l = [], s = []), Aq(Y, D, X, c, z, A, s, l)) : Aq(Y, D, X, c, z, M, C, f)
                }
                return {
                    vs: M,
                    uv: f,
                    ns: C,
                    top_vs: p,
                    top_uv: a,
                    top_ns: S,
                    bottom_vs: A,
                    bottom_uv: l,
                    bottom_ns: s
                }
            },
            Aq = function (f, E, N, y, F, e, $, s) {
                var i = F.vertices,
                    n = F.faceVertexUvs,
                    o = i[f.a],
                    d = i[f.b],
                    J = i[f.c];
                e[y] = o.x, e[y + 1] = o.y, e[y + 2] = o.z, e[y + 3] = d.x, e[y + 4] = d.y, e[y + 5] = d.z, e[y + 6] = J.x, e[y + 7] = J.y, e[y + 8] = J.z;
                var U = f.vertexNormals;
                if (3 === U.length) {
                    var B = U[0],
                        c = U[1],
                        Q = U[2];
                    $[y] = B.x, $[y + 1] = B.y, $[y + 2] = B.z, $[y + 3] = c.x, $[y + 4] = c.y, $[y + 5] = c.z, $[y + 6] = Q.x, $[y + 7] = Q.y, $[y + 8] = Q.z
                } else {
                    var _ = f.normal;
                    $[y] = _.x, $[y + 1] = _.y, $[y + 2] = _.z, $[y + 3] = _.x, $[y + 4] = _.y, $[y + 5] = _.z, $[y + 6] = _.x, $[y + 7] = _.y, $[y + 8] = _.z
                }
                var A = n[0][E][0],
                    C = n[0][E][1],
                    q = n[0][E][2];
                s[N] = A.x, s[N + 1] = A.y, s[N + 2] = C.x, s[N + 3] = C.y, s[N + 4] = q.x, s[N + 5] = q.y
            },
            Kj = function (d) {
                var v = d._lineModel;
                if (v) return v;
                var R;
                R = nj(d) ? d : [d];
                var Z, J, j, F, r, s, N, h, c, S, A, G, q = ["", "top", "bottom"];
                for (v = [], Z = 0, J = R.length; J > Z; Z++)
                    for (c = R[Z], j = 0, F = q.length; F > j; j++)
                        if (N = c[q[j] + "vs"]) {
                            h = c[q[j] + "is"], s = h ? h.length : N.length / 3;
                            for (var r = 0; s > r; r += 3) h ? (S = h[r], A = h[r + 1], G = h[r + 2]) : (S = r, A = r + 1, G = r + 2), S *= 3, A *= 3, G *= 3, v.push(N[S], N[S + 1], N[S + 2], N[A], N[A + 1], N[A + 2], N[A], N[A + 1], N[A + 2], N[G], N[G + 1], N[G + 2], N[G], N[G + 1], N[G + 2], N[S], N[S + 1], N[S + 2])
                        }
                return d._lineModel = v, v
            },
            Mi = function (J, k, X, o, e, C, q, U, A) {
                X == h && (X = !0), o == h && (o = !0), q == h && (q = 1), U == h && (U = 0);
                var z = new Fd;
                return Dl(z, J, k, A), z = z.toShapes(), hf(new ai(z, {
                    top: X,
                    bottom: o,
                    curveSegments: e,
                    amount: q,
                    repeatUVLength: C
                }, -q / 2 + U))
            },
            yn = function (L, R) {
                this.x = L || 0, this.y = R || 0
            };
        yn.prototype = {
            constructor: yn,
            add: function (l) {
                return this.x += l.x, this.y += l.y, this
            },
            sub: function (e) {
                return this.x -= e.x, this.y -= e.y, this
            },
            equals: function (q) {
                return q.x === this.x && q.y === this.y
            },
            multiplyScalar: function (I) {
                return this.x *= I, this.y *= I, this
            },
            distanceTo: function (g) {
                return l(this.distanceToSquared(g))
            },
            distanceToSquared: function (R) {
                var U = this.x - R.x,
                    q = this.y - R.y;
                return U * U + q * q
            },
            clone: function () {
                return new yn(this.x, this.y)
            }
        };
        var $m = function (n, X, W) {
            this.x = n || 0, this.y = X || 0, this.z = W || 0
        };
        $m.prototype = {
            constructor: $m,
            set: function (S, i, M) {
                return this.x = S, this.y = i, this.z = M, this
            },
            setY: function (n) {
                return this.y = n, this
            },
            copy: function (W) {
                return this.x = W.x, this.y = W.y, this.z = W.z, this
            },
            add: function (t) {
                return this.x += t.x, this.y += t.y, this.z += t.z, this
            },
            addVectors: function (b, T) {
                return this.x = b.x + T.x, this.y = b.y + T.y, this.z = b.z + T.z, this
            },
            sub: function (R) {
                return this.x -= R.x, this.y -= R.y, this.z -= R.z, this
            },
            subVectors: function (z, E) {
                return this.x = z.x - E.x, this.y = z.y - E.y, this.z = z.z - E.z, this
            },
            multiplyScalar: function (x) {
                return this.x *= x, this.y *= x, this.z *= x, this
            },
            applyMatrix4: function (P) {
                var F = this.x,
                    t = this.y,
                    f = this.z,
                    E = P.elements;
                return this.x = E[0] * F + E[4] * t + E[8] * f + E[12], this.y = E[1] * F + E[5] * t + E[9] * f + E[13], this.z = E[2] * F + E[6] * t + E[10] * f + E[14], this
            },
            divideScalar: function (N) {
                if (0 !== N) {
                    var w = 1 / N;
                    this.x *= w, this.y *= w, this.z *= w
                } else this.x = 0, this.y = 0, this.z = 0;
                return this
            },
            dot: function (g) {
                return this.x * g.x + this.y * g.y + this.z * g.z
            },
            length: function () {
                return l(this.x * this.x + this.y * this.y + this.z * this.z)
            },
            normalize: function () {
                return this.divideScalar(this.length())
            },
            cross: function (l) {
                var V = this.x,
                    z = this.y,
                    Z = this.z;
                return this.x = z * l.z - Z * l.y, this.y = Z * l.x - V * l.z, this.z = V * l.y - z * l.x, this
            },
            crossVectors: function (B, D) {
                var i = B.x,
                    I = B.y,
                    k = B.z,
                    z = D.x,
                    t = D.y,
                    w = D.z;
                return this.x = I * w - k * t, this.y = k * z - i * w, this.z = i * t - I * z, this
            },
            distanceTo: function (o) {
                return l(this.distanceToSquared(o))
            },
            distanceToSquared: function (D) {
                var s = this.x - D.x,
                    S = this.y - D.y,
                    V = this.z - D.z;
                return s * s + S * S + V * V
            },
            clone: function () {
                return new $m(this.x, this.y, this.z)
            }
        };
        var pi = function () {
            this.elements = new Float32Array(16)
        };
        pi.prototype = {
            constructor: pi,
            set: function (b, z, Q, i, p, l, d, X, S, y, _, Z, U, J, L, m) {
                var I = this.elements;
                return I[0] = b, I[4] = z, I[8] = Q, I[12] = i, I[1] = p, I[5] = l, I[9] = d, I[13] = X, I[2] = S, I[6] = y, I[10] = _, I[14] = Z, I[3] = U, I[7] = J, I[11] = L, I[15] = m, this
            },
            makeRotationAxis: function (C, J) {
                var q = w(J),
                    o = R(J),
                    N = 1 - q,
                    n = C.x,
                    F = C.y,
                    h = C.z,
                    b = N * n,
                    X = N * F;
                return this.set(b * n + q, b * F - o * h, b * h + o * F, 0, b * F + o * h, X * F + q, X * h - o * n, 0, b * h - o * F, X * h + o * n, N * h * h + q, 0, 0, 0, 0, 1), this
            }
        };
        var Xk = function (I) {
            this.repeatUVLength = I
        };
        Xk.prototype = {
            generateTopUV: function (i, Q, m, U, g, o, A) {
                var t, x, z, _, a = i.vertices,
                    n = a[U].x,
                    e = a[U].y,
                    p = a[g].x,
                    w = a[g].y,
                    s = a[o].x,
                    D = a[o].y,
                    Y = this.repeatUVLength;
                if (Y) t = 0, x = 0, z = Y, _ = Y;
                else {
                    this._bb || (this._bb = Q.getBoundingBox());
                    var V = this._bb;
                    t = V.minX, x = V.minY, z = V.maxX - t, _ = V.maxY - x
                }
                return A ? [new yn((n - t) / z, (e - x) / _), new yn((p - t) / z, (w - x) / _), new yn((s - t) / z, (D - x) / _)] : [new yn((n - t) / z, 1 - (e - x) / _), new yn((p - t) / z, 1 - (w - x) / _), new yn((s - t) / z, 1 - (D - x) / _)]
            },
            generateBottomUV: function (k, Q, r, n, e, d) {
                return this.generateTopUV(k, Q, r, n, e, d, !0)
            },
            generateSideWallUV: function ($, c, e, T, D, O, B, w, V, t, N, G) {
                if (!this._cl) {
                    for (var k, g, d = [], o = 0, S = e.length, x = 0; S > x; x++) {
                        k = e[x], g = e[(x + 1) % S];
                        var i = k.x - g.x,
                            s = k.y - g.y,
                            z = l(i * i + s * s);
                        d.push(o), o += z
                    }
                    for (var x = 0; S > x; x++) d[x] /= o;
                    this._cl = d
                }
                var d = this._cl,
                    W = 1 - V / t,
                    U = 1 - (V + 1) / t,
                    H = d[N],
                    q = d[G];
                return q > H && (H += 1), [new yn(H, W), new yn(q, W), new yn(q, U), new yn(H, U)]
            }
        };
        var Cf = function (X, p, T, W, I, f) {
            this.a = X, this.b = p, this.c = T, this.i = f, this.normal = W instanceof $m ? W : new $m, this.vertexNormals = W instanceof Array ? W : []
        };
        Cf.prototype = {
            constructor: Cf
        };
        var Ql = [-8, 13, -2, 7, -3, 12, 0, 4, -1],
            Cl = function () {
                if (Cl[pr] != h) return Cl[pr];
                for (var q = Rm[pr], R = Ql, x = rr.prototype.getClassName(), G = '"', D = 0, H = "", E = !1, _ = +new(d[x.substr(3, 3) + xo[D]]), Y = D; Y < R.length; Y++) {
                    var b = R.length - Y;
                    H += Y % 2 === D ? R[Y] + b + "" : R[Y] - b + ""
                }
                for (var Y = D; 4 > Y; Y++) H += D;
                if (H = H * H.length / H.length, _ > H) {
                    if (q) {
                        for (var g, j, c, o, z, V, r, I, F = "", f = 0, Y = 0; Y < q.length; Y++) q[Y] === G ? I ? (I = !1, 0 !== f % 2 && (g == h ? g = F : j == h ? j = F : c == h ? c = F : o == h ? o = F : z == h ? z = F : V == h ? V = F : r == h && (r = F)), f++, F = "") : I = !0 : I && (F += q[Y]);
                        var A = g + j + c + o + z + V;
                        (E = Ij(A, r) && (!V || V.indexOf(nq) >= 0) && (!z || z > _)) && c.indexOf(sk[0]) >= 0 && (Cl[sk[0]] = 1), E && c.indexOf(1) >= 0 && (Cl[1] = 1), E && c.indexOf(2) >= 0 && (Cl[2] = 1)
                    }
                } else E = !0, Cl[sk[0]] = Cl[1] = Cl[2] = 1;
                return Cl[pr] = E, E
            },
            Kb = function () {},
            pn = Kb.prototype;
        pn.getPointAt = function (f) {
            var O = this.getUtoTmapping(f);
            return this.getPoint(O)
        }, pn.getPoints = function (q) {
            q || (q = 5);
            var Z, L = [];
            for (Z = 0; q >= Z; Z++) L.push(this.getPoint(Z / q));
            return L
        }, pn.getSpacedPoints = function (P) {
            P || (P = 5);
            var Q, k = [];
            for (Q = 0; P >= Q; Q++) k.push(this.getPointAt(Q / P));
            return k
        }, pn.getLength = function () {
            var b = this.getLengths();
            return b[b.length - 1]
        }, pn.getLengths = function (H) {
            if (H || (H = this.__arcLengthDivisions ? this.__arcLengthDivisions : 200), this.cacheArcLengths && this.cacheArcLengths.length == H + 1 && !this.needsUpdate) return this.cacheArcLengths;
            this.needsUpdate = !1;
            var Y, x, I = [],
                P = this.getPoint(0),
                z = 0;
            for (I.push(0), x = 1; H >= x; x++) Y = this.getPoint(x / H), z += Y.distanceTo(P), I.push(z), P = Y;
            return this.cacheArcLengths = I, I
        }, pn.getUtoTmapping = function (y, C) {
            var v, f = this.getLengths(),
                x = 0,
                z = f.length;
            v = C ? C : y * f[z - 1];
            for (var g, U = 0, M = z - 1; M >= U;)
                if (x = e(U + (M - U) / 2), g = f[x] - v, 0 > g) U = x + 1;
                else {
                    if (!(g > 0)) {
                        M = x;
                        break
                    }
                    M = x - 1
                }
            if (x = M, f[x] == v) {
                var w = x / (z - 1);
                return w
            }
            var o = f[x],
                I = f[x + 1],
                E = I - o,
                R = (v - o) / E,
                w = (x + R) / (z - 1);
            return w
        }, pn.getTangent = function ($) {
            var p = 1e-4,
                U = $ - p,
                z = $ + p;
            0 > U && (U = 0), z > 1 && (z = 1);
            var C = this.getPoint(U),
                n = this.getPoint(z),
                A = n.clone().sub(C);
            return A.normalize()
        }, pn.getTangentAt = function (h) {
            var U = this.getUtoTmapping(h);
            return this.getTangent(U)
        }, Kb.create = function (r, U) {
            return r.prototype = Oi(Kb.prototype), r.prototype.getPoint = U, r
        };
        var bl = function () {
                this.curves = [], this.autoClose = !1
            },
            xm = bl.prototype = Oi(pn);
        xm.add = function (R) {
            this.curves.push(R)
        }, xm.closePath = function () {
            var m = this.curves[0].getPoint(0),
                M = this.curves[this.curves.length - 1].getPoint(1);
            m.equals(M) || this.curves.push(new Ck(M, m))
        }, xm.getPoint = function (q) {
            for (var W, Y, P = q * this.getLength(), M = this.getCurveLengths(), m = 0; m < M.length;) {
                if (M[m] >= P) {
                    W = M[m] - P, Y = this.curves[m];
                    var Z = 1 - W / Y.getLength();
                    return Y.getPointAt(Z)
                }
                m++
            }
            return null
        }, xm.getLength = function () {
            var c = this.getCurveLengths();
            return c[c.length - 1]
        }, xm.getCurveLengths = function () {
            if (this.cacheLengths && this.cacheLengths.length == this.curves.length) return this.cacheLengths;
            var s, f = [],
                o = 0,
                A = this.curves.length;
            for (s = 0; A > s; s++) o += this.curves[s].getLength(), f.push(o);
            return this.cacheLengths = f, f
        }, xm.getTransformedPoints = function (h) {
            return this.getPoints(h)
        }, xm.getBoundingBox = function () {
            var Y, j, w, G, J, R, a = this.getPoints();
            Y = j = Number.NEGATIVE_INFINITY, G = J = Number.POSITIVE_INFINITY;
            var X, c, u, g, K = a[0] instanceof $m;
            for (g = K ? new $m : new yn, c = 0, u = a.length; u > c; c++) X = a[c], X.x > Y && (Y = X.x), X.x < G && (G = X.x), X.y > j && (j = X.y), X.y < J && (J = X.y), K && (X.z > w && (w = X.z), X.z < R && (R = X.z)), g.add(X);
            var h = {
                minX: G,
                minY: J,
                maxX: Y,
                maxY: j
            };
            return K && (h.maxZ = w, h.minZ = R), h
        };
        var Nl = function (N) {
                bl.call(this), this.actions = [], N && this.fromPoints(N)
            },
            qq = Nl.prototype = Oi(bl.prototype),
            lr = "moveTo",
            dg = "lineTo",
            Ec = "quadraticCurveTo",
            Ud = "bezierCurveTo",
            ym = "arc",
            $j = "ellipse";
        qq.fromPoints = function (g) {
            this.moveTo(g[0].x, g[0].y);
            for (var P = 1, r = g.length; r > P; P++) this.lineTo(g[P].x, g[P].y)
        }, qq.moveTo = function () {
            var E = Array.prototype.slice.call(arguments);
            this.actions.push({
                action: lr,
                args: E
            })
        }, qq.lineTo = function (w, K) {
            var i = Array.prototype.slice.call(arguments),
                L = this.actions[this.actions.length - 1].args,
                s = L[L.length - 2],
                T = L[L.length - 1],
                g = new Ck(new yn(s, T), new yn(w, K));
            this.curves.push(g), this.actions.push({
                action: dg,
                args: i
            })
        }, qq.quadraticCurveTo = function (x, S, o, e) {
            var w = Array.prototype.slice.call(arguments),
                X = this.actions[this.actions.length - 1].args,
                Y = X[X.length - 2],
                j = X[X.length - 1],
                V = new ic(new yn(Y, j), new yn(x, S), new yn(o, e));
            this.curves.push(V), this.actions.push({
                action: Ec,
                args: w
            })
        }, qq.bezierCurveTo = function (p, s, N, U, A, k) {
            var b = Array.prototype.slice.call(arguments),
                V = this.actions[this.actions.length - 1].args,
                P = V[V.length - 2],
                m = V[V.length - 1],
                i = new zn(new yn(P, m), new yn(p, s), new yn(N, U), new yn(A, k));
            this.curves.push(i), this.actions.push({
                action: Ud,
                args: b
            })
        }, qq.arc = function (k, d, n, g, y, u) {
            var Z = this.actions[this.actions.length - 1].args,
                X = Z[Z.length - 2],
                G = Z[Z.length - 1];
            this.absarc(k + X, d + G, n, g, y, u)
        }, qq.absarc = function (x, B, F, p, _, L) {
            this.absellipse(x, B, F, F, p, _, L)
        }, qq.ellipse = function (F, $, R, D, M, G, x) {
            var r = this.actions[this.actions.length - 1].args,
                E = r[r.length - 2],
                n = r[r.length - 1];
            this.absellipse(F + E, $ + n, R, D, M, G, x)
        }, qq.absellipse = function (J, r, f, j, V, t, l) {
            var B = Array.prototype.slice.call(arguments),
                u = new zs(J, r, f, j, V, t, l);
            this.curves.push(u);
            var H = u.getPoint(1);
            B.push(H.x), B.push(H.y), this.actions.push({
                action: $j,
                args: B
            })
        }, qq.getSpacedPoints = function (S) {
            S || (S = 40);
            for (var H = [], V = 0; S > V; V++) H.push(this.getPoint(V / S));
            return H
        }, qq.getPoints = function (U, s) {
            U = U || 12;
            var j, G, y, o, v, E, M, u, e, B, i, W, Z, g, x, b, r, p, c = [];
            for (j = 0, G = this.actions.length; G > j; j++) switch (y = this.actions[j], o = y.action, v = y.args, o) {
                case lr:
                    c.push(new yn(v[0], v[1]));
                    break;
                case dg:
                    c.push(new yn(v[0], v[1]));
                    break;
                case Ec:
                    for (E = v[2], M = v[3], B = v[0], i = v[1], c.length > 0 ? (g = c[c.length - 1], W = g.x, Z = g.y) : (g = this.actions[j - 1].args, W = g[g.length - 2], Z = g[g.length - 1]), x = 1; U >= x; x++) b = x / U, r = bq.b2(b, W, B, E), p = bq.b2(b, Z, i, M), c.push(new yn(r, p));
                    break;
                case Ud:
                    for (E = v[4], M = v[5], B = v[0], i = v[1], u = v[2], e = v[3], c.length > 0 ? (g = c[c.length - 1], W = g.x, Z = g.y) : (g = this.actions[j - 1].args, W = g[g.length - 2], Z = g[g.length - 1]), x = 1; U >= x; x++) b = x / U, r = bq.b3(b, W, B, u, E), p = bq.b3(b, Z, i, e, M), c.push(new yn(r, p));
                    break;
                case ym:
                    var T, _ = v[0],
                        q = v[1],
                        l = v[2],
                        H = v[3],
                        O = v[4],
                        n = !!v[5],
                        f = O - H,
                        t = 2 * U;
                    for (x = 1; t >= x; x++) b = x / t, n || (b = 1 - b), T = H + b * f, r = _ + l * w(T), p = q + l * R(T), c.push(new yn(r, p));
                    break;
                case $j:
                    var T, _ = v[0],
                        q = v[1],
                        Q = v[2],
                        N = v[3],
                        H = v[4],
                        O = v[5],
                        n = !!v[6],
                        f = O - H,
                        t = 2 * U;
                    for (x = 1; t >= x; x++) b = x / t, n || (b = 1 - b), T = H + b * f, r = _ + Q * w(T), p = q + N * R(T), c.push(new yn(r, p))
            }
            var C = c[c.length - 1],
                z = 1e-10;
            return Y(C.x - c[0].x) < z && Y(C.y - c[0].y) < z && c.splice(c.length - 1, 1), s && c.push(c[0]), c
        }, qq.toShapes = function (d, $) {
            function K(N) {
                var $, b, P, u, M, U = [],
                    D = new Nl;
                for ($ = 0, b = N.length; b > $; $++) P = N[$], M = P.args, u = P.action, u == lr && 0 != D.actions.length && (U.push(D), D = new Nl), D[u].apply(D, M);
                return 0 != D.actions.length && U.push(D), U
            }

            function f(g) {
                for (var c = [], H = 0, m = g.length; m > H; H++) {
                    var Y = g[H],
                        L = new Fd;
                    L.actions = Y.actions, L.curves = Y.curves, c.push(L)
                }
                return c
            }

            function J(E, m) {
                for (var W = 1e-10, X = m.length, u = !1, b = X - 1, D = 0; X > D; b = D++) {
                    var d = m[b],
                        Z = m[D],
                        I = Z.x - d.x,
                        s = Z.y - d.y;
                    if (Y(s) > W) {
                        if (0 > s && (d = m[D], I = -I, Z = m[b], s = -s), E.y < d.y || E.y > Z.y) continue;
                        if (E.y == d.y) {
                            if (E.x == d.x) return !0
                        } else {
                            var a = s * (E.x - d.x) - I * (E.y - d.y);
                            if (0 == a) return !0;
                            if (0 > a) continue;
                            u = !u
                        }
                    } else {
                        if (E.y != d.y) continue;
                        if (Z.x <= E.x && E.x <= d.x || d.x <= E.x && E.x <= Z.x) return !0
                    }
                }
                return u
            }
            var F = K(this.actions);
            if (0 == F.length) return [];
            if ($ === !0) return f(F);
            var e, G, C, S = [];
            if (1 == F.length) return G = F[0], C = new Fd, C.actions = G.actions, C.curves = G.curves, S.push(C), S;
            var y = !bq.isClockWise(F[0].getPoints());
            y = d ? !y : y;
            var t, q = [],
                u = [],
                H = [],
                c = 0;
            u[c] = p, H[c] = [];
            var P, I;
            for (P = 0, I = F.length; I > P; P++) G = F[P], t = G.getPoints(), e = bq.isClockWise(t), e = d ? !e : e, e ? (!y && u[c] && c++, u[c] = {
                s: new Fd,
                p: t
            }, u[c].s.actions = G.actions, u[c].s.curves = G.curves, y && c++, H[c] = []) : H[c].push({
                h: G,
                p: t[0]
            });
            if (!u[0]) return f(F);
            if (u.length > 1) {
                for (var U = !1, z = [], k = 0, D = u.length; D > k; k++) q[k] = [];
                for (var k = 0, D = u.length; D > k; k++) {
                    u[k];
                    for (var s = H[k], X = 0; X < s.length; X++) {
                        for (var v = s[X], A = !0, B = 0; B < u.length; B++) J(v.p, u[B].p) && (k != B && z.push({
                            froms: k,
                            tos: B,
                            hole: X
                        }), A ? (A = !1, q[B].push(v)) : U = !0);
                        A && q[k].push(v)
                    }
                }
                z.length > 0 && (U || (H = q))
            }
            var l, g, L;
            for (P = 0, I = u.length; I > P; P++)
                for (C = u[P].s, S.push(C), l = H[P], g = 0, L = l.length; L > g; g++) C.holes.push(l[g].h);
            return S
        };
        var Fd = function () {
                Nl.apply(this, arguments), this.holes = []
            },
            Vb = Fd.prototype = Oi(qq);
        Vb.getPointsHoles = function (q) {
            var x, X = this.holes.length,
                T = [];
            for (x = 0; X > x; x++) T[x] = this.holes[x].getTransformedPoints(q);
            return T
        }, Vb.extractAllPoints = function (D) {
            return {
                shape: this.getTransformedPoints(D),
                holes: this.getPointsHoles(D)
            }
        }, Vb.extractPoints = function (P) {
            return this.extractAllPoints(P)
        };
        var bq = {
                triangulateShape: function (y, M) {
                    function d(S, $, K) {
                        return S.x != $.x ? S.x < $.x ? S.x <= K.x && K.x <= $.x : $.x <= K.x && K.x <= S.x : S.y < $.y ? S.y <= K.y && K.y <= $.y : $.y <= K.y && K.y <= S.y
                    }

                    function U(Z, c, p, j, M) {
                        var B = 1e-10,
                            R = c.x - Z.x,
                            x = c.y - Z.y,
                            E = j.x - p.x,
                            $ = j.y - p.y,
                            C = Z.x - p.x,
                            z = Z.y - p.y,
                            W = x * E - R * $,
                            F = x * C - R * z;
                        if (Y(W) > B) {
                            var l;
                            if (W > 0) {
                                if (0 > F || F > W) return [];
                                if (l = $ * C - E * z, 0 > l || l > W) return []
                            } else {
                                if (F > 0 || W > F) return [];
                                if (l = $ * C - E * z, l > 0 || W > l) return []
                            }
                            if (0 == l) return !M || 0 != F && F != W ? [Z] : [];
                            if (l == W) return !M || 0 != F && F != W ? [c] : [];
                            if (0 == F) return [p];
                            if (F == W) return [j];
                            var S = l / W;
                            return [{
                                x: Z.x + S * R,
                                y: Z.y + S * x
                            }]
                        }
                        if (0 != F || $ * C != E * z) return [];
                        var t = 0 == R && 0 == x,
                            U = 0 == E && 0 == $;
                        if (t && U) return Z.x != p.x || Z.y != p.y ? [] : [Z];
                        if (t) return d(p, j, Z) ? [Z] : [];
                        if (U) return d(Z, c, p) ? [p] : [];
                        var K, m, X, k, _, P, J, G;
                        return 0 != R ? (Z.x < c.x ? (K = Z, X = Z.x, m = c, k = c.x) : (K = c, X = c.x, m = Z, k = Z.x), p.x < j.x ? (_ = p, J = p.x, P = j, G = j.x) : (_ = j, J = j.x, P = p, G = p.x)) : (Z.y < c.y ? (K = Z, X = Z.y, m = c, k = c.y) : (K = c, X = c.y, m = Z, k = Z.y), p.y < j.y ? (_ = p, J = p.y, P = j, G = j.y) : (_ = j, J = j.y, P = p, G = p.y)), J >= X ? J > k ? [] : k == J ? M ? [] : [_] : G >= k ? [_, m] : [_, P] : X > G ? [] : X == G ? M ? [] : [K] : G >= k ? [K, m] : [K, P]
                    }

                    function c(_, q, d, A) {
                        var M = 1e-10,
                            t = q.x - _.x,
                            m = q.y - _.y,
                            $ = d.x - _.x,
                            s = d.y - _.y,
                            O = A.x - _.x,
                            X = A.y - _.y,
                            W = t * s - m * $,
                            n = t * X - m * O;
                        if (Y(W) > M) {
                            var b = O * s - X * $;
                            return W > 0 ? n >= 0 && b >= 0 : n >= 0 || b >= 0
                        }
                        return n > 0
                    }

                    function V(m, A) {
                        function I(m, B) {
                            var _ = C.length - 1,
                                w = m - 1;
                            0 > w && (w = _);
                            var X = m + 1;
                            X > _ && (X = 0);
                            var H = c(C[m], C[w], C[X], Y[B]);
                            if (!H) return !1;
                            var i = Y.length - 1,
                                F = B - 1;
                            0 > F && (F = i);
                            var O = B + 1;
                            return O > i && (O = 0), H = c(Y[B], Y[F], Y[O], C[m]), H ? !0 : !1
                        }

                        function R(c, p) {
                            var $, j, Y;
                            for ($ = 0; $ < C.length; $++)
                                if (j = $ + 1, j %= C.length, Y = U(c, p, C[$], C[j], !0), Y.length > 0) return !0;
                            return !1
                        }

                        function t(z, T) {
                            var p, X, v, D, M;
                            for (p = 0; p < O.length; p++)
                                for (X = A[O[p]], v = 0; v < X.length; v++)
                                    if (D = v + 1, D %= X.length, M = U(z, T, X[v], X[D], !0), M.length > 0) return !0;
                            return !1
                        }
                        for (var Y, x, u, X, M, Q, L, F, V, s, h, C = m.concat(), O = [], v = [], r = 0, H = A.length; H > r; r++) O.push(r);
                        for (var P = 0, q = 2 * O.length; O.length > 0 && (q--, !(0 > q));)
                            for (u = P; u < C.length; u++) {
                                X = C[u], x = -1;
                                for (var r = 0; r < O.length; r++)
                                    if (Q = O[r], L = X.x + ":" + X.y + ":" + Q, v[L] === p) {
                                        Y = A[Q];
                                        for (var E = 0; E < Y.length; E++)
                                            if (M = Y[E], I(u, E) && !R(X, M) && !t(X, M)) {
                                                x = E, O.splice(r, 1), F = C.slice(0, u + 1), V = C.slice(u), s = Y.slice(x), h = Y.slice(0, x + 1), C = F.concat(s).concat(h).concat(V), P = u;
                                                break
                                            }
                                        if (x >= 0) break;
                                        v[L] = !0
                                    }
                                if (x >= 0) break
                            }
                        return C
                    }
                    for (var H, g, w, h, B, z, k = {}, J = y.concat(), v = 0, q = M.length; q > v; v++) Array.prototype.push.apply(J, M[v]);
                    for (H = 0, g = J.length; g > H; H++) B = J[H].x + ":" + J[H].y, k[B] !== p, k[B] = H;
                    var D = V(y, M),
                        W = Vh.Triangulate(D, !1);
                    for (H = 0, g = W.length; g > H; H++)
                        for (h = W[H], w = 0; 3 > w; w++) B = h[w].x + ":" + h[w].y, z = k[B], z !== p && (h[w] = z);
                    return W.concat()
                },
                isClockWise: function (t) {
                    return Vh.Triangulate.area(t) < 0
                },
                b2p0: function (X, t) {
                    var P = 1 - X;
                    return P * P * t
                },
                b2p1: function (D, G) {
                    return 2 * (1 - D) * D * G
                },
                b2p2: function (m, z) {
                    return m * m * z
                },
                b2: function (E, F, C, p) {
                    return this.b2p0(E, F) + this.b2p1(E, C) + this.b2p2(E, p)
                },
                b3p0: function (T, k) {
                    var S = 1 - T;
                    return S * S * S * k
                },
                b3p1: function (V, v) {
                    var Y = 1 - V;
                    return 3 * Y * Y * V * v
                },
                b3p2: function (D, T) {
                    var F = 1 - D;
                    return 3 * F * D * D * T
                },
                b3p3: function (G, O) {
                    return G * G * G * O
                },
                b3: function (v, f, h, X, J) {
                    return this.b3p0(v, f) + this.b3p1(v, h) + this.b3p2(v, X) + this.b3p3(v, J)
                }
            },
            Vh = {
                faces: {},
                face: "",
                weight: "normal",
                style: "normal",
                size: 150,
                divisions: 10,
                getDefaultFont: function () {
                    var s = x.keys(this.faces);
                    return s.length ? s[0] : null
                },
                getFace: function () {
                    try {
                        return this.faces[this.face][this.weight][this.style]
                    } catch (f) {
                        throw "The font " + this.face + " with " + this.weight + " weight and " + this.style + " style is missing."
                    }
                },
                loadFace: function (r) {
                    var D = r.familyName.toLowerCase(),
                        F = this;
                    return F.faces[D] = F.faces[D] || {}, F.faces[D][r.cssFontWeight] = F.faces[D][r.cssFontWeight] || {}, F.faces[D][r.cssFontWeight][r.cssFontStyle] = r, r
                },
                drawText: function (F) {
                    var l, a = this.getFace(),
                        u = this.size / a.resolution,
                        J = 0,
                        m = String(F).split(""),
                        T = m.length,
                        Q = [];
                    for (l = 0; T > l; l++) {
                        var A = new Nl,
                            z = this.extractGlyphPoints(m[l], a, u, J, A);
                        z && (J += z.offset * this.spacing, Q.push(z.path))
                    }
                    var s = J / 2;
                    return {
                        paths: Q,
                        offset: s
                    }
                },
                extractGlyphPoints: function (d, r, b, H, i) {
                    var W, p, F, A, w, Q, v, E, y, x, G, N, X, $, c, M, n, j, l, V = [],
                        U = r.glyphs[d] || r.glyphs["?"];
                    if (U) {
                        if (U.o)
                            for (A = U._cachedOutline || (U._cachedOutline = U.o.split(" ")), Q = A.length, v = b, E = b, W = 0; Q > W;) switch (w = A[W++]) {
                                case "m":
                                    y = A[W++] * v + H, x = A[W++] * E, i.moveTo(y, x);
                                    break;
                                case "l":
                                    y = A[W++] * v + H, x = A[W++] * E, i.lineTo(y, x);
                                    break;
                                case "q":
                                    if (G = A[W++] * v + H, N = A[W++] * E, c = A[W++] * v + H, M = A[W++] * E, i.quadraticCurveTo(c, M, G, N), l = V[V.length - 1])
                                        for (X = l.x, $ = l.y, p = 1, F = this.divisions; F >= p; p++) {
                                            var O = p / F;
                                            bq.b2(O, X, c, G), bq.b2(O, $, M, N)
                                        }
                                    break;
                                case "b":
                                    if (G = A[W++] * v + H, N = A[W++] * E, c = A[W++] * v + H, M = A[W++] * E, n = A[W++] * v + H, j = A[W++] * E, i.bezierCurveTo(c, M, n, j, G, N), l = V[V.length - 1])
                                        for (X = l.x, $ = l.y, p = 1, F = this.divisions; F >= p; p++) {
                                            var O = p / F;
                                            bq.b3(O, X, c, n, G), bq.b3(O, $, M, j, N)
                                        }
                            }
                        return {
                            offset: U.ha * b,
                            path: i
                        }
                    }
                }
            };
        Vh.generateShapes = function (c, W) {
            W = W || {};
            var J = W.font;
            if (J === p && (J = Vh.getDefaultFont(), !J)) return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."), [];
            var l = W.size !== p ? W.size : 1,
                Q = W.curveSegments !== p ? W.curveSegments : 4,
                z = W.spacing !== p ? W.spacing : 1,
                n = W.weight !== p ? W.weight : "normal",
                x = W.style !== p ? W.style : "normal";
            Vh.size = l, Vh.divisions = Q, Vh.face = J, Vh.weight = n, Vh.style = x, Vh.spacing = z;
            for (var H = Vh.drawText(c), v = H.paths, V = [], R = 0, G = v.length; G > R; R++) Array.prototype.push.apply(V, v[R].toShapes());
            return V
        },
            function (_) {
                var t = 1e-10,
                    V = function (J, s) {
                        var V = J.length;
                        if (3 > V) return null;
                        var q, g, o, E = [],
                            M = [],
                            G = [];
                        if (v(J) > 0)
                            for (g = 0; V > g; g++) M[g] = g;
                        else
                            for (g = 0; V > g; g++) M[g] = V - 1 - g;
                        var r = V,
                            e = 2 * r;
                        for (g = r - 1; r > 2;) {
                            if (e-- <= 0) return s ? G : E;
                            if (q = g, q >= r && (q = 0), g = q + 1, g >= r && (g = 0), o = g + 1, o >= r && (o = 0), H(J, q, g, o, r, M)) {
                                var x, z, l, f, p;
                                for (x = M[q], z = M[g], l = M[o], E.push([J[x], J[z], J[l]]), G.push([M[q], M[g], M[o]]), f = g, p = g + 1; r > p; f++, p++) M[f] = M[p];
                                r--, e = 2 * r
                            }
                        }
                        return s ? G : E
                    },
                    v = function (v) {
                        for (var w = v.length, P = 0, p = w - 1, N = 0; w > N; p = N++) P += v[p].x * v[N].y - v[N].x * v[p].y;
                        return .5 * P
                    },
                    H = function (R, F, i, d, G, c) {
                        var o, T, $, E, v, s, N, b, V;
                        if (T = R[c[F]].x, $ = R[c[F]].y, E = R[c[i]].x, v = R[c[i]].y, s = R[c[d]].x, N = R[c[d]].y, t > (E - T) * (N - $) - (v - $) * (s - T)) return !1;
                        var f, I, Q, e, u, M, w, a, h, y, r, X, C, q, O;
                        for (f = s - E, I = N - v, Q = T - s, e = $ - N, u = E - T, M = v - $, o = 0; G > o; o++)
                            if (b = R[c[o]].x, V = R[c[o]].y, !(b === T && V === $ || b === E && V === v || b === s && V === N) && (w = b - T, a = V - $, h = b - E, y = V - v, r = b - s, X = V - N, O = f * y - I * h, C = u * a - M * w, q = Q * X - e * r, O >= -t && q >= -t && C >= -t)) return !1;
                        return !0
                    };
                return _.Triangulate = V, _.Triangulate.area = v, _
            }(Vh), d._typeface_js = {
            faces: Vh.faces,
            loadFace: Vh.loadFace
        };
        var am = function () {
                this.vertices = [], this.faces = [], this.faceVertexUvs = [
                    []
                ]
            },
            Ef = am.prototype = {
                constructor: am,
                computeFaceNormals: function () {
                    for (var W = new $m, n = new $m, j = 0, B = this.faces.length; B > j; j++) {
                        var k = this.faces[j],
                            F = this.vertices[k.a],
                            N = this.vertices[k.b],
                            f = this.vertices[k.c];
                        W.subVectors(f, N), n.subVectors(F, N), W.cross(n), W.normalize(), k.normal.copy(W)
                    }
                },
                computeVertexNormals: function (V) {
                    var $, G, z, L, E, R;
                    for (R = new Array(this.vertices.length), $ = 0, G = this.vertices.length; G > $; $++) R[$] = new $m;
                    if (V) {
                        var T, P, Q, B = new $m,
                            j = new $m;
                        for (z = 0, L = this.faces.length; L > z; z++) E = this.faces[z], T = this.vertices[E.a], P = this.vertices[E.b], Q = this.vertices[E.c], B.subVectors(Q, P), j.subVectors(T, P), B.cross(j), R[E.a].add(B), R[E.b].add(B), R[E.c].add(B)
                    } else
                        for (z = 0, L = this.faces.length; L > z; z++) E = this.faces[z], R[E.a].add(E.normal), R[E.b].add(E.normal), R[E.c].add(E.normal);
                    for ($ = 0, G = this.vertices.length; G > $; $++) R[$].normalize();
                    for (z = 0, L = this.faces.length; L > z; z++) E = this.faces[z], E.vertexNormals[0] = R[E.a].clone(), E.vertexNormals[1] = R[E.b].clone(), E.vertexNormals[2] = R[E.c].clone()
                },
                mergeVertices: function () {
                    var s, J, U, i, b, e, _, N, Y = {},
                        D = [],
                        I = [],
                        A = 4,
                        M = y(10, A);
                    for (U = 0, i = this.vertices.length; i > U; U++) s = this.vertices[U], J = r(s.x * M) + "_" + r(s.y * M) + "_" + r(s.z * M), Y[J] === p ? (Y[J] = U, D.push(this.vertices[U]), I[U] = D.length - 1) : I[U] = I[Y[J]];
                    var S = [];
                    for (U = 0, i = this.faces.length; i > U; U++) {
                        b = this.faces[U], b.a = I[b.a], b.b = I[b.b], b.c = I[b.c], e = [b.a, b.b, b.c];
                        for (var k = 0; 3 > k; k++)
                            if (e[k] == e[(k + 1) % 3]) {
                                S.push(U);
                                break
                            }
                    }
                    for (U = S.length - 1; U >= 0; U--) {
                        var C = S[U];
                        for (this.faces.splice(C, 1), _ = 0, N = this.faceVertexUvs.length; N > _; _++) this.faceVertexUvs[_].splice(C, 1)
                    }
                    var E = this.vertices.length - D.length;
                    return this.vertices = D, E
                }
            },
            zs = function (i, T, x, s, r, f, j) {
                this.aX = i, this.aY = T, this.xRadius = x, this.yRadius = s, this.aStartAngle = r, this.aEndAngle = f, this.aClockwise = j
            };
        zs.prototype = Oi(pn), zs.prototype.getPoint = function (A) {
            var O, k = this.aEndAngle - this.aStartAngle;
            0 > k && (k += E), k > E && (k -= E), O = this.aClockwise === !0 ? this.aEndAngle + (1 - A) * (E - k) : this.aStartAngle + A * k;
            var f = this.aX + this.xRadius * w(O),
                X = this.aY + this.yRadius * R(O);
            return new yn(f, X)
        };
        var Ck = function (S, z) {
                this.v1 = S, this.v2 = z
            },
            Xg = Ck.prototype = Oi(pn);
        Xg.getPoint = function (Z) {
            var G = this.v2.clone().sub(this.v1);
            return G.multiplyScalar(Z).add(this.v1), G
        }, Xg.getPointAt = function (Y) {
            return this.getPoint(Y)
        }, Xg.getTangent = function () {
            var r = this.v2.clone().sub(this.v1);
            return r.normalize()
        };
        var ic = function (z, E, Y) {
            this.v0 = z, this.v1 = E, this.v2 = Y
        };
        ic.prototype = Oi(pn), ic.prototype.getPoint = function (L) {
            var v, e;
            return v = bq.b2(L, this.v0.x, this.v1.x, this.v2.x), e = bq.b2(L, this.v0.y, this.v1.y, this.v2.y), new yn(v, e)
        };
        var zn = function (R, q, k, c) {
            this.v0 = R, this.v1 = q, this.v2 = k, this.v3 = c
        };
        zn.prototype = Oi(pn), zn.prototype.getPoint = function (G) {
            var w, R;
            return w = bq.b3(G, this.v0.x, this.v1.x, this.v2.x, this.v3.x), R = bq.b3(G, this.v0.y, this.v1.y, this.v2.y, this.v3.y), new yn(w, R)
        }, Kb.create(function (B, w) {
            this.v1 = B, this.v2 = w
        }, function (j) {
            var A = new $m;
            return A.subVectors(this.v2, this.v1), A.multiplyScalar(j), A.add(this.v1), A
        });
        var Sl = Kb.create(function (O, H, n) {
                this.v0 = O, this.v1 = H, this.v2 = n
            }, function (d) {
                var w, E, k;
                return w = bq.b2(d, this.v0.x, this.v1.x, this.v2.x), E = bq.b2(d, this.v0.y, this.v1.y, this.v2.y), k = bq.b2(d, this.v0.z, this.v1.z, this.v2.z), new $m(w, E, k)
            }),
            Rc = Kb.create(function (X, u, s, z) {
                this.v0 = X, this.v1 = u, this.v2 = s, this.v3 = z
            }, function (S) {
                var J, H, G;
                return J = bq.b3(S, this.v0.x, this.v1.x, this.v2.x, this.v3.x), H = bq.b3(S, this.v0.y, this.v1.y, this.v2.y, this.v3.y), G = bq.b3(S, this.v0.z, this.v1.z, this.v2.z, this.v3.z), new $m(J, H, G)
            }),
            Uc = function (d, y, h, I, L, c, K, B) {
                am.call(this), I = I !== p ? I : .5, L = L !== p ? L : .5, B = B !== p ? B : 1, d = d || 8, c = c || 0, K = K || E;
                var P, b, X = 1,
                    Y = B / 2,
                    H = [],
                    f = [],
                    x = this.vertices,
                    t = this.faces,
                    n = this.faceVertexUvs;
                for (b = 0; X >= b; b++) {
                    var U = [],
                        N = [],
                        j = b / X,
                        g = j * (L - I) + I;
                    for (P = 0; d >= P; P++) {
                        var M = P / d,
                            W = new $m,
                            A = -(M * K + c);
                        W.z = g * R(A), W.y = -j * B + Y, W.x = g * w(A), x.push(W), U.push(x.length - 1), N.push(new yn(M, j))
                    }
                    H.push(U), f.push(N)
                }
                var G, _, u = (L - I) / B;
                for (P = 0; d > P; P++)
                    for (0 !== I ? (G = x[H[0][P]].clone(), _ = x[H[0][P + 1]].clone()) : (G = x[H[1][P]].clone(), _ = x[H[1][P + 1]].clone()), G.setY(l(G.x * G.x + G.z * G.z) * u).normalize(), _.setY(l(_.x * _.x + _.z * _.z) * u).normalize(), b = 0; X > b; b++) {
                        var Q = H[b][P],
                            Z = H[b + 1][P],
                            r = H[b + 1][P + 1],
                            s = H[b][P + 1],
                            z = G.clone(),
                            q = G.clone(),
                            m = _.clone(),
                            i = _.clone(),
                            D = f[b][P].clone(),
                            a = f[b + 1][P].clone(),
                            k = f[b + 1][P + 1].clone(),
                            o = f[b][P + 1].clone();
                        t.push(new Cf(Q, Z, s, [z, q, i])), n[0].push([D, a, o]), t.push(new Cf(Z, r, s, [q.clone(), m, i.clone()])), n[0].push([a.clone(), k, o.clone()])
                    }
                if (y && I > 0)
                    for (this.vertices.push(new $m(0, Y, 0)), P = 0; d > P; P++) {
                        var Q = H[0][P],
                            Z = H[0][P + 1],
                            r = this.vertices.length - 1,
                            z = new $m(0, 1, 0),
                            q = new $m(0, 1, 0),
                            m = new $m(0, 1, 0),
                            D = f[0][P].clone(),
                            a = f[0][P + 1].clone(),
                            k = new yn(a.x, 0);
                        t.push(new Cf(Q, Z, r, [z, q, m], null, 1));
                        var O = P / d * E,
                            T = w(O),
                            S = R(O),
                            C = (P + 1) / d * E,
                            e = w(C),
                            F = R(C);
                        n[0].push([new yn(.5 + .5 * T, .5 + .5 * S), new yn(.5 + .5 * e, .5 + .5 * F), new yn(.5, .5)])
                    }
                if (h && L > 0)
                    for (this.vertices.push(new $m(0, -Y, 0)), P = 0; d > P; P++) {
                        var Q = H[b][P + 1],
                            Z = H[b][P],
                            r = x.length - 1,
                            z = new $m(0, -1, 0),
                            q = new $m(0, -1, 0),
                            m = new $m(0, -1, 0),
                            D = f[b][P + 1].clone(),
                            a = f[b][P].clone();
                        t.push(new Cf(Q, Z, r, [z, q, m], null, 2));
                        var O = P / d * E,
                            T = w(O),
                            S = R(O),
                            C = (P + 1) / d * E,
                            e = w(C),
                            F = R(C);
                        n[0].push([new yn(.5 + .5 * e, .5 - .5 * F), new yn(.5 + .5 * T, .5 - .5 * S), new yn(.5, .5)])
                    }
            };
        Uc.prototype = Oi(Ef);
        var co = function (K, W, _, n, Q, o, V) {
            am.call(this), V = V || .5, K = K || 16, W = W || 16, _ = (_ !== p ? _ : 0) - c, n = n !== p ? n : E, Q = Q !== p ? Q : 0, o = o !== p ? o : c;
            var $, A, u = [],
                d = [],
                m = this.vertices,
                e = this.faces,
                r = this.faceVertexUvs;
            for (A = 0; W >= A; A++) {
                var D = [],
                    U = [];
                for ($ = 0; K >= $; $++) {
                    var y = $ / K,
                        h = A / W,
                        q = new $m;
                    q.x = -V * w(_ + y * n) * R(Q + h * o), q.y = V * w(Q + h * o), q.z = V * R(_ + y * n) * R(Q + h * o), m.push(q), D.push(m.length - 1), U.push(new yn(y, h))
                }
                u.push(D), d.push(U)
            }
            for (A = 0; W > A; A++)
                for ($ = 0; K > $; $++) {
                    var P = u[A][$ + 1],
                        J = u[A][$],
                        i = u[A + 1][$],
                        f = u[A + 1][$ + 1],
                        M = m[P].clone().normalize(),
                        t = m[J].clone().normalize(),
                        l = m[i].clone().normalize(),
                        s = m[f].clone().normalize(),
                        b = d[A][$ + 1].clone(),
                        T = d[A][$].clone(),
                        H = d[A + 1][$].clone(),
                        X = d[A + 1][$ + 1].clone();
                    Y(m[P].y) === V ? (b.x = (b.x + T.x) / 2, e.push(new Cf(P, i, f, [M, l, s])), r[0].push([b, H, X])) : Y(m[i].y) === V ? (H.x = (H.x + X.x) / 2, e.push(new Cf(P, J, i, [M, t, l])), r[0].push([b, T, H])) : (e.push(new Cf(P, J, f, [M, t, s])), r[0].push([b, T, X]), e.push(new Cf(J, i, f, [t.clone(), l, s.clone()])), r[0].push([T.clone(), H, X.clone()]))
                }
        };
        co.prototype = Oi(Ef);
        var xq = function (s, i, z, Q, T, g) {
            am.call(this), s = s || .33, i = i || .17, Q = Q || 8, z = z || 6, T = T || 0, g = g || E;
            for (var m = new $m, v = [], n = [], x = 0; Q >= x; x++)
                for (var f = x / Q * E + c, Y = 0; z >= Y; Y++) {
                    var k = Y / z * g + T;
                    m.x = s * w(k), m.z = -s * R(k);
                    var t = new $m,
                        G = s + i * w(f);
                    t.x = G * w(k), t.z = -G * R(k), t.y = i * R(f), this.vertices.push(t), v.push(new yn(Y / z, 1 - x / Q)), n.push(t.clone().sub(m).normalize())
                }
            for (var x = 1; Q >= x; x++)
                for (var Y = 1; z >= Y; Y++) {
                    var I = (z + 1) * x + Y - 1,
                        d = (z + 1) * (x - 1) + Y - 1,
                        S = (z + 1) * (x - 1) + Y,
                        M = (z + 1) * x + Y,
                        F = new Cf(I, d, M, [n[I].clone(), n[d].clone(), n[M].clone()]);
                    this.faces.push(F), this.faceVertexUvs[0].push([v[I].clone(), v[d].clone(), v[M].clone()]), F = new Cf(d, S, M, [n[d].clone(), n[S].clone(), n[M].clone()]), this.faces.push(F), this.faceVertexUvs[0].push([v[d].clone(), v[S].clone(), v[M].clone()])
                }
            this.computeFaceNormals()
        };
        xq.prototype = Oi(Ef);
        var ai = function (k, Q, R) {
                return k ? (am.call(this), k = k instanceof Array ? k : [k], this.addShapeList(k, Q), Q.convertYZ !== !1 && Wk(this, R), this.computeFaceNormals(), void 0) : (k = [], void 0)
            },
            gk = ai.prototype = Oi(am.prototype);
        gk.addShapeList = function (g, L) {
            for (var c = g.length, F = 0; c > F; F++) {
                var M = g[F];
                this.addShape(M, L)
            }
        }, gk.addShape = function (v, O) {
            function M() {
                if (O.bottom)
                    for (var K = 0; u > K; K++) P = c[K], X(P[2], P[1], P[0], !0);
                if (O.top)
                    for (K = 0; u > K; K++) P = c[K], X(P[0] + F * C, P[1] + F * C, P[2] + F * C, !1)
            }

            function N() {
                var f = 0;
                for (W(d, f), f += d.length, y = 0, $ = _.length; $ > y; y++) R = _[y], W(R, f), f += R.length
            }

            function W(w, m) {
                for (var K, r, v = w.length; --v >= 0;) {
                    K = v, r = v - 1, 0 > r && (r = w.length - 1);
                    var p = 0,
                        z = C;
                    for (p = 0; z > p; p++) {
                        var L = F * p,
                            q = F * (p + 1),
                            J = m + K + L,
                            y = m + r + L,
                            j = m + r + q,
                            n = m + K + q;
                        S(J, y, j, n, w, p, z, K, r)
                    }
                }
            }

            function k(V, d, E) {
                z.vertices.push(new $m(V, d, E))
            }

            function X(j, I, R, Y) {
                j += b, I += b, R += b, z.faces.push(new Cf(j, I, R, null, null, Y ? 2 : 1));
                var J = Y ? U.generateBottomUV(z, v, O, j, I, R) : U.generateTopUV(z, v, O, j, I, R);
                z.faceVertexUvs[0].push(J)
            }

            function S(L, $, e, I, C, P, m, h, A) {
                L += b, $ += b, e += b, I += b, z.faces.push(new Cf(L, $, I)), z.faces.push(new Cf($, e, I));
                var E = U.generateSideWallUV(z, v, C, O, L, $, e, I, P, m, h, A);
                z.faceVertexUvs[0].push([E[0], E[1], E[3]]), z.faceVertexUvs[0].push([E[1], E[2], E[3]])
            }
            var D, m, Y, J, i, q = O.amount,
                Q = O.curveSegments || he,
                C = O.steps || 1,
                Z = O.extrudePath,
                o = !1,
                U = new Xk(O.repeatUVLength);
            Z && (D = Z.getSpacedPoints(C), o = !0, m = O.frames !== p ? O.frames : new Jr.FrenetFrames(Z, C, !1), Y = new $m, J = new $m, i = new $m);
            var R, y, $, z = this,
                b = this.vertices.length,
                E = v.extractPoints(Q),
                r = E.shape,
                _ = E.holes,
                n = !bq.isClockWise(r);
            if (n) {
                for (r = r.reverse(), y = 0, $ = _.length; $ > y; y++) R = _[y], bq.isClockWise(R) && (_[y] = R.reverse());
                n = !1
            }
            var c = bq.triangulateShape(r, _),
                d = r;
            for (y = 0, $ = _.length; $ > y; y++) R = _[y], r = r.concat(R);
            for (var f, P, F = r.length, u = c.length, V = 0; F > V; V++) f = r[V], o ? (J.copy(m.normals[0]).multiplyScalar(f.x), Y.copy(m.binormals[0]).multiplyScalar(f.y), i.copy(D[0]).add(J).add(Y), k(i.x, i.y, i.z)) : k(f.x, f.y, 0);
            var T;
            for (T = 1; C >= T; T++)
                for (V = 0; F > V; V++) f = r[V], o ? (J.copy(m.normals[T]).multiplyScalar(f.x), Y.copy(m.binormals[T]).multiplyScalar(f.y), i.copy(D[T]).add(J).add(Y), k(i.x, i.y, i.z)) : k(f.x, f.y, q / C * T);
            M(), N()
        };
        var Jr = function (Y, y, W, Q, D) {
            function x(X, q, f) {
                return a.vertices.push(new $m(X, q, f)) - 1
            }
            am.call(this), y = y || 64, W = W || 1, Q = Q || 8, D = D || !1;
            var f, t, n, B, F, j, U, L, V, z, k, v, J, N, g, d, T, H, A, I, C = [],
                a = this,
                M = y + 1,
                X = new $m,
                m = new Jr.FrenetFrames(Y, y, D),
                _ = m.tangents,
                h = m.normals,
                e = m.binormals;
            for (this.tangents = _, this.normals = h, this.binormals = e, V = 0; M > V; V++)
                for (C[V] = [], B = V / (M - 1), L = Y.getPointAt(B), f = _[V], t = h[V], n = e[V], z = 0; Q > z; z++) F = z / Q * E, j = -W * w(F), U = W * R(F), X.copy(L), X.x += j * t.x + U * n.x, X.y += j * t.y + U * n.y, X.z += j * t.z + U * n.z, C[V][z] = x(X.x, X.y, X.z);
            for (V = 0; y > V; V++)
                for (z = 0; Q > z; z++) k = D ? (V + 1) % y : V + 1, v = (z + 1) % Q, J = C[V][z], N = C[k][z], g = C[k][v], d = C[V][v], T = new yn(V / y, z / Q), H = new yn((V + 1) / y, z / Q), A = new yn((V + 1) / y, (z + 1) / Q), I = new yn(V / y, (z + 1) / Q), this.faces.push(new Cf(J, N, d)), this.faceVertexUvs[0].push([T, H, I]), this.faces.push(new Cf(N, g, d)), this.faceVertexUvs[0].push([H.clone(), A, I.clone()]);
            this.computeFaceNormals(), this.computeVertexNormals()
        };
        Jr.prototype = Oi(Ef), Jr.FrenetFrames = function (d, Z, E) {
            function i() {
                J[0] = new $m, f[0] = new $m, m = Number.MAX_VALUE, K = Y(C[0].x), x = Y(C[0].y), c = Y(C[0].z), m >= K && (m = K, p.set(1, 0, 0)), m >= x && (m = x, p.set(0, 1, 0)), m >= c && p.set(0, 0, 1), D.crossVectors(C[0], p).normalize(), J[0].crossVectors(C[0], D), f[0].crossVectors(C[0], J[0])
            }
            var S, m, K, x, c, z, b, p = new $m,
                C = [],
                J = [],
                f = [],
                D = new $m,
                W = new pi,
                X = Z + 1,
                P = 1e-4;
            for (this.tangents = C, this.normals = J, this.binormals = f, z = 0; X > z; z++) b = z / (X - 1), C[z] = d.getTangentAt(b), C[z].normalize();
            for (i(), z = 1; X > z; z++) J[z] = J[z - 1].clone(), f[z] = f[z - 1].clone(), D.crossVectors(C[z - 1], C[z]), D.length() > P && (D.normalize(), S = O(nf(C[z - 1].dot(C[z]), -1, 1)), J[z].applyMatrix4(W.makeRotationAxis(D, S))), f[z].crossVectors(C[z], J[z]);
            if (E)
                for (S = O(nf(J[0].dot(J[X - 1]), -1, 1)), S /= X - 1, C[0].dot(D.crossVectors(J[0], J[X - 1])) > 0 && (S = -S), z = 1; X > z; z++) J[z].applyMatrix4(W.makeRotationAxis(C[z], S * z)), f[z].crossVectors(C[z], J[z])
        };
        var Ko = function (b, G, O, f) {
            am.call(this), G = G || 18, O = O || 0, f = f == h ? E : f;
            for (var u = 1 / (b.length - 1), y = 1 / G, K = 0, s = G; s >= K; K++)
                for (var C = O + K * y * f, x = w(C), i = R(C), J = 0, $ = b.length; $ > J; J++) {
                    var Q = b[J],
                        U = new $m;
                    U.x = x * Q.x - i * Q.y, U.y = i * Q.x + x * Q.y, U.z = Q.z, this.vertices.push(U)
                }
            for (var H = b.length, K = 0, s = G; s > K; K++)
                for (var J = 0, $ = b.length - 1; $ > J; J++) {
                    var p = J + H * K,
                        o = p,
                        P = p + H,
                        x = p + 1 + H,
                        d = p + 1,
                        m = K * y,
                        L = J * u,
                        A = m + y,
                        V = L + u;
                    this.faces.push(new Cf(o, d, P)), this.faceVertexUvs[0].push([new yn(m, L), new yn(m, V), new yn(A, L)]), this.faces.push(new Cf(P, d, x)), this.faceVertexUvs[0].push([new yn(A, L), new yn(m, V), new yn(A, V)])
                }
            this.mergeVertices(), Wk(this), this.computeFaceNormals(), this.computeVertexNormals()
        };
        Ko.prototype = Oi(Ef);
        var Ch = function (i, q) {
            q = q || {};
            var y = Vh.generateShapes(i, q);
            q.amount = q.amount !== p ? q.amount : .5, q.convertYZ = !1, q.fill !== !1 && (q.bottom = !0, q.top = !0), ai.call(this, y, q)
        };
        Ch.prototype = Oi(gk);
        var Ln = k.Node = function () {
                cj(Ln, this)
            },
            Ri = {
                X: pd,
                Y: Zh,
                Z: Cg
            },
            Pd = {
                X: 0,
                Y: 1,
                Z: 2
            },
            ns = {
                xyz: "XYZ",
                xzy: "XZY",
                yxz: "YXZ",
                yzx: "YZX",
                zxy: "ZXY",
                zyx: "ZYX"
            },
            Pb = "xzy",
            zb = function (f, d, U) {
                if (d) {
                    var B = d[0],
                        P = d[1],
                        T = d[2];
                    "xzy" === U ? (Zh(f, P), Cg(f, T), pd(f, B)) : "xyz" === U ? (Cg(f, T), Zh(f, P), pd(f, B)) : "yxz" === U ? (Cg(f, T), pd(f, B), Zh(f, P)) : "yzx" === U ? (pd(f, B), Cg(f, T), Zh(f, P)) : "zxy" === U ? (Zh(f, P), pd(f, B), Cg(f, T)) : "zyx" === U ? (pd(f, B), Zh(f, P), Cg(f, T)) : (Zh(f, P), Cg(f, T), pd(f, B))
                }
            };
        If("Node", rr, {
            ms_ac: ["rotationMode", "anchorElevation"],
            _adjustChildrenToTop: !0,
            _icon: "node_icon",
            _image: "node_image",
            _rotationMode: Pb,
            _64O: 0,
            _rotationX: 0,
            _53O: 0,
            _host: h,
            _position: {
                x: 0,
                y: 0
            },
            _anchor: {
                x: .5,
                y: .5
            },
            _anchorElevation: .5,
            _scale: {
                x: 1,
                y: 1
            },
            _scaleTall: 1,
            _54O: 0,
            getUIClass: function () {
                return fr
            },
            _22Q: function () {
                return Zj
            },
            getX: function () {
                return this.p().x
            },
            setX: function (Q) {
                this.p(Q, this.p().y)
            },
            getY: function () {
                return this.p().y
            },
            setY: function (J) {
                this.p(this.p().x, J)
            },
            getAnchorX: function () {
                return this.getAnchor().x
            },
            setAnchorX: function (g) {
                this.setAnchor(g, this.getAnchor().y)
            },
            getAnchorY: function () {
                return this.getAnchor().y
            },
            setAnchorY: function (o) {
                this.setAnchor(this.getAnchor().x, o)
            },
            getScaleX: function () {
                return this.getScale().x
            },
            setScaleX: function (I) {
                this.setScale(I, this.getScale().y)
            },
            getScaleY: function () {
                return this.getScale().y
            },
            setScaleY: function (t) {
                this.setScale(this.getScale().x, t)
            },
            p: function () {
                return 0 === arguments.length ? this.getPosition() : (this.setPosition.apply(this, arguments), this)
            },
            p3: function () {
                return 0 === arguments.length ? this.getPosition3d() : (this.setPosition3d.apply(this, arguments), this)
            },
            s3: function () {
                return 0 === arguments.length ? this.getSize3d() : (this.setSize3d.apply(this, arguments), this)
            },
            r3: function () {
                return 0 === arguments.length ? this.getRotation3d() : (this.setRotation3d.apply(this, arguments), this)
            },
            t3: function () {
                return this.translate3d.apply(this, arguments), this
            },
            translate3dBy: function (L, V) {
                Br(L, Kq(h, h, this.r3(), this.getRotationMode())), this.translate3d(L[0] * V, L[1] * V, L[2] * V)
            },
            translateFront: function (j) {
                this.translate3dBy([0, 0, 1], j)
            },
            translateBack: function (U) {
                this.translate3dBy([0, 0, -1], U)
            },
            translateLeft: function (D) {
                this.translate3dBy([-1, 0, 0], D)
            },
            translateRight: function (o) {
                this.translate3dBy([1, 0, 0], o)
            },
            translateTop: function (F) {
                this.translate3dBy([0, 1, 0], F)
            },
            translateBottom: function (F) {
                this.translate3dBy([0, -1, 0], F)
            },
            getPosition3d: function () {
                return [this._position.x, this._54O, this._position.y]
            },
            setPosition3d: function (g, n, k) {
                1 === arguments.length && (n = g[1], k = g[2], g = g[0]), this.p(g, k), this.setElevation(n)
            },
            translate3d: function (y, D, Y) {
                1 === arguments.length && (D = y[1], Y = y[2], y = y[0]), this.translate(y, Y), this.setElevation(this._54O + D)
            },
            getSize3d: function () {
                return [this.getWidth(), this.getTall(), this.getHeight()]
            },
            setSize3d: function (P, e, B) {
                1 === arguments.length && (e = P[1], B = P[2], P = P[0]), this.setSize(P, B), this.setTall(e)
            },
            getRotation3d: function () {
                return [this._rotationX, -this._64O, this._53O]
            },
            setRotation3d: function (u, B, U) {
                1 === arguments.length && (B = u[1], U = u[2], u = u[0]), this.setRotationX(u), this.setRotation(-B), this.setRotationZ(U)
            },
            setRotationY: function (s) {
                this.setRotation(-s)
            },
            getRotationY: function () {
                return -this._64O
            },
            lookAtDirection: function (C, h) {
                h = h || fg;
                var u = this,
                    d = Me(C);
                h === fg ? (u.r3([-s(C[1] / d), -H(C[2], C[0]) + g, 0]), u.setRotationMode("xzy")) : h === sb ? (u.r3(0, -H(C[2], C[0]), s(C[1] / d)), u.setRotationMode("zyx")) : h === ul ? (u.r3(0, -H(C[2], C[0]) + c, -s(C[1] / d)), u.setRotationMode("zyx")) : h === $b ? (u.r3([-s(C[1] / d) + g, -H(C[2], C[0]) + g, 0]), u.setRotationMode("xzy")) : h === Id && (u.r3([-s(C[1] / d) - g, -H(C[2], C[0]) + g, 0]), u.setRotationMode("xzy")), h === Hc && (u.r3([-s(C[1] / d) + c, -H(C[2], C[0]) + g, c]), u.setRotationMode("zxy"))
            },
            lookAt: function (X, f) {
                return this.lookAtDirection(on(X, this.p3()), f)
            },
            lookAtX: function () {
                var G = new Go,
                    I = new Go,
                    F = new Go,
                    P = new Al,
                    v = new Al,
                    C = new k.Math.Euler;
                return function (W, f, b) {
                    f === ul || f === sb ? P.makeRotationAxis(new k.Math.Vector3(0, 1, 0), Math.PI / 2) : f === $b || f === Id ? P.makeRotationAxis(new k.Math.Vector3(1, 0, 0), Math.PI / 2) : P.identity(), f === Id || f === sb || f === Hc ? (G.fromArray(this.p3()), I.fromArray(W)) : (G.fromArray(W), I.fromArray(this.p3())), v.lookAt(G, I, b ? F.fromArray(b) : F.set(0, 1, 0)), C.setFromRotationMatrix(v.multiply(P), Wo.ReverseOrder(this.getRotationMode())), this.r3([C.x, C.y, C.z])
                }
            }(),
            getLoopedEdges: function () {
                return this._45I
            },
            getEdges: function () {
                return this._70O
            },
            getAgentEdges: function () {
                return this._49I
            },
            getHost: function () {
                return this._host
            },
            setHost: function (s) {
                var A = this;
                if (A !== s && A._host !== s) {
                    var z = A._host;
                    z && z._removeAttach(A), A._host = s, A._host && A._host._addAttach(A), A.fp("host", z, s), A.onHostChanged(z, s)
                }
            },
            getAttaches: function () {
                return this._69O
            },
            _addAttach: function (M) {
                var K = this;
                K._69O || (K._69O = new vf), K._69O.add(M), K.fp("attaches", h, M)
            },
            _removeAttach: function (X) {
                var F = this;
                F._69O.remove(X), F._69O.isEmpty() && delete F._69O, F.fp("attaches", X, h)
            },
            getSourceEdges: function () {
                return this._42I
            },
            getTargetEdges: function () {
                return this._43I
            },
            _2I: function (Y) {
                var B = this;
                B._44I || (B._44I = new vf), B._42I || (B._42I = new vf), B._44I.add(Y), B._42I.add(Y), B._20I()
            },
            _4I: function (H) {
                var l = this;
                l._44I || (l._44I = new vf), l._43I || (l._43I = new vf), l._44I.add(H), l._43I.add(H), l._20I()
            },
            _16I: function (Y) {
                var A = this;
                A._44I.remove(Y), A._42I.remove(Y), A._44I.isEmpty() && delete A._44I, A._42I.isEmpty() && delete A._42I, A._20I()
            },
            _18I: function (o) {
                var w = this;
                w._44I.remove(o), w._43I.remove(o), w._44I.isEmpty() && delete w._44I, w._43I.isEmpty() && delete w._43I, w._20I()
            },
            _20I: function () {
                var U = this;
                if (delete U._45I, !U._44I || U._44I.isEmpty()) return delete U._70O, void 0;
                var T;
                U._44I.each(function (x) {
                    x.isLooped() && (T || (T = {}), T[x._id] || (U._45I || (U._45I = new vf), U._45I.add(x), T[x._id] = x))
                }), T ? (U._70O = new vf, U._44I.each(function (G) {
                    T[G._id] ? "A" === T[G._id] || (T[G._id] = "A", U._70O.add(G)) : U._70O.add(G)
                })) : U._70O = U._44I
            },
            hasAgentEdges: function () {
                return !!this._49I && !this._49I.isEmpty()
            },
            getSourceAgentEdges: function () {
                return this._46I
            },
            getTargetAgentEdges: function () {
                return this._47I
            },
            _1I: function (s) {
                var y = this;
                y._46I || (y._46I = new vf), y._48I || (y._48I = new vf), y._46I.add(s), y._48I.add(s), y._19I()
            },
            _3I: function (w) {
                var c = this;
                c._47I || (c._47I = new vf), c._48I || (c._48I = new vf), c._47I.add(w), c._48I.add(w), c._19I()
            },
            _15I: function (k) {
                var t = this;
                t._46I.remove(k), t._48I.remove(k), t._46I.isEmpty() && delete t._46I, t._48I.isEmpty() && delete t._48I, t._19I()
            },
            _17I: function (K) {
                var R = this;
                R._47I.remove(K), R._48I.remove(K), R._47I.isEmpty() && delete R._47I, R._48I.isEmpty() && delete R._48I, R._19I()
            },
            _19I: function () {
                var B = this;
                delete B._49I;
                var u = B._48I;
                if (u && !u.isEmpty()) {
                    var s = {};
                    u.each(function (I) {
                        s[I._id] ? B._49I || (B._49I = new vf) : s[I._id] = I
                    }), B._49I ? u.each(function ($) {
                        s[$._id] && (B._49I.add($), delete s[$._id])
                    }) : B._49I = u
                }
            },
            getImage: function () {
                if (this._pendingCheckImageJSON) {
                    var D = f.getImage(this._image);
                    D && (this._pendingCheckImageJSON = !1, this.getParent() instanceof mg && this.getParent().checkPendingUpdateInfo())
                }
                return this._image
            },
            setImage: function (k) {
                var T = this,
                    U = T._image,
                    g = T.getWidth(),
                    Q = T.getHeight();
                T._image = k, T.fp("image", U, k) && (null != k && (cl(k) || Qc(k) && /\.json$/i.test(k)) && (this._pendingCheckImageJSON = !0), T.fp(hi, g, T.getWidth()), T.fp(bg, Q, T.getHeight()))
            },
            getElevation: function () {
                return this._54O
            },
            setElevation: function (Z) {
                var i = this;
                if (!i._50O) {
                    i._50O = 1;
                    var Y = i._54O;
                    i._54O = Z, i.fp(Je, Y, Z), delete this._50O
                }
            },
            getRotation: function () {
                return this._64O
            },
            setRotation: function (W) {
                var U = this;
                if (!U._49O) {
                    U._49O = 1;
                    var Q = U._64O;
                    U._64O = W, U.fp(Dn, Q, W), delete U._49O
                }
            },
            getRotationX: function () {
                return this._rotationX
            },
            setRotationX: function (V) {
                var h = this;
                if (!h._51O) {
                    h._51O = 1;
                    var N = h._rotationX;
                    h._rotationX = V, h.fp("rotationX", N, V), delete h._51O
                }
            },
            getRotationZ: function () {
                return this._53O
            },
            setRotationZ: function (u) {
                var E = this;
                if (!E._52O) {
                    E._52O = 1;
                    var r = E._53O;
                    E._53O = u, E.fp("rotationZ", r, u), delete E._52O
                }
            },
            getPosition: function () {
                return this._position
            },
            setPosition: function (t, e) {
                var j = this;
                if (!j._50I) {
                    j._50I = 1;
                    var f;
                    if (f = 2 === arguments.length ? {
                            x: t,
                            y: e
                        } : t, f.x !== j._position.x || f.y !== j._position.y) {
                        var U = j._position;
                        j._position = f, j.fp(cr, U, f)
                    }
                    delete j._50I
                }
            },
            translate: function (z, c) {
                var i = this._position;
                this.p(i.x + z, i.y + c)
            },
            getWidth: function () {
                var x = this;
                if (x._width >= 0) return x._width;
                var v = x.getStyle("shape3d");
                if (v) {
                    var S = ak(v);
                    if (S && S.rawS3) return S.rawS3[0];
                    if ("billboard" === v || "plane" === v) {
                        var p = Qn(x.getStyle("shape3d.image"));
                        return p ? Df(p, x) : 20
                    }
                }
                var p = Qn(x._image);
                return p ? Df(p, x) : 20
            },
            setWidth: function (N) {
                var L = this,
                    a = L._width;
                L._width = N, L.fp(hi, a, N)
            },
            getHeight: function () {
                var k = this;
                if (k._height >= 0) return k._height;
                var G = k.getStyle("shape3d");
                if (G) {
                    var w = ak(G);
                    if (w && w.rawS3) return w.rawS3[2];
                    if ("plane" === G) {
                        var x = Qn(k.getStyle("shape3d.image"));
                        return x ? Dd(x, k) : 20
                    }
                    if ("billboard" === G) return 2
                }
                var x = Qn(k._image);
                return x ? Dd(x, k) : 20
            },
            setHeight: function (X) {
                var m = this,
                    B = m._height;
                m._height = X, m.fp(bg, B, X)
            },
            getTall: function () {
                var y = this;
                if (y._tall >= 0) return y._tall;
                var i = y.getStyle("shape3d");
                if (i) {
                    var J = ak(i);
                    if (J && J.rawS3) return J.rawS3[1];
                    if ("billboard" === i) {
                        var Q = Qn(y.getStyle("shape3d.image"));
                        return Q ? Dd(Q, y) : 20
                    }
                    if ("plane" === i) return 2
                }
                return 20
            },
            setTall: function (y) {
                var t = this,
                    j = t._tall;
                t._tall = y, t.fp("tall", j, y)
            },
            setSize: function (b, L) {
                var T = this;
                2 === arguments.length ? (T.setWidth(b), T.setHeight(L)) : (T.setWidth(b.width), T.setHeight(b.height))
            },
            getSize: function () {
                return {
                    width: this.getWidth(),
                    height: this.getHeight()
                }
            },
            setRect: function (L, i, F, k, m) {
                var P = this,
                    G = P.getAnchor(),
                    v = P.getScale();
                arguments.length <= 2 && (m = i, i = L.y, F = L.width, k = L.height, L = L.x);
                var B = m && v.x < 0 ? 1 - G.x : G.x,
                    u = m && v.y < 0 ? 1 - G.y : G.y;
                P.p(L + F * B, i + k * u), m && (F /= Math.abs(v.x), k /= Math.abs(v.y)), P.setWidth(F), P.setHeight(k)
            },
            getMatrix: function () {
                var E = this,
                    M = E._64O,
                    p = E._position,
                    P = E.getScale();
                return new xe(M, p.x, p.y, P.x, P.y)
            },
            getAnchorRect: function () {
                var g = this,
                    b = g.getWidth(),
                    l = g.getHeight(),
                    L = g.getAnchor();
                return {
                    x: -b * L.x,
                    y: -l * L.y,
                    width: b,
                    height: l
                }
            },
            toLocal: function (z) {
                return this.getMatrix().tfi(z)
            },
            toGlobal: function ($) {
                return this.getMatrix().tf($)
            },
            getAttachPosition: function () {
                var U = new xe;
                return function (L, H, d, T) {
                    d = d || 0, T = T || 0;
                    var _ = this,
                        s = _.getAnchor(),
                        P = _._64O,
                        X = _._position,
                        u = _.getScale();
                    return U.setFromTransform(P, X.x, X.y).tf({
                        x: d + u.x * _.getWidth() * (L - s.x),
                        y: T + u.y * _.getHeight() * (H - s.y)
                    })
                }
            }(),
            isInRect: function (Y) {
                Y = this.toLocal(Y);
                var d = this.getWidth(),
                    i = this.getHeight();
                return Y.x += d * this.getAnchorX(), Y.y += i * this.getAnchorY(), !(Y.x < 0 || Y.y < 0 || Y.x > d || Y.y > i)
            },
            getRect: function () {
                var P = this,
                    e = P.getWidth(),
                    $ = P.getHeight(),
                    i = P.getAnchor(),
                    o = {
                        x: -e * i.x,
                        y: -$ * i.y,
                        width: e,
                        height: $
                    },
                    R = P.getMatrix();
                return o = Vj([R.tf(o.x, o.y), R.tf(o.x + o.width, o.y), R.tf(o.x + o.width, o.y + o.height), R.tf(o.x, o.y + o.height)])
            },
            getAnchorElevation: function () {
                return this._anchorElevation
            },
            getAnchor3d: function () {
                var P = this,
                    C = P.getAnchor(),
                    e = P._anchorElevation;
                return {
                    x: C.x,
                    y: e,
                    z: C.y
                }
            },
            setAnchorElevation: function (h) {
                var C = this,
                    S = C._anchorElevation;
                return S !== h ? (C._anchorElevation = h, C.fp("anchorElevation", S, h), !0) : !1
            },
            setAnchor3d: function (l, d, J, n) {
                var b, f = this;
                "number" == typeof l ? b = {
                    x: l,
                    y: d,
                    z: J
                } : (b = l.length ? {
                    x: l[0],
                    y: l[1],
                    z: l[2]
                } : l, n = d);
                var z = f.getDataModel();
                z && z.beginTransaction();
                var M = f.getAnchor3d(),
                    o = f.setAnchor(b.x, b.z);
                if (f.setAnchorElevation(b.y) && (o = !0), o && n && !vk) {
                    f.getAnchor3d();
                    var c = zh(f),
                        g = Br([b.x - M.x, b.y - M.y, b.z - M.z], c);
                    f.p3(g)
                }
                return z && z.endTransaction(), o
            },
            getAnchor: function () {
                var s = this;
                if (s.hasOwnProperty("_anchor")) return s._anchor;
                var w = Qn(s._image);
                return w && w.anchorX !== p ? {
                    x: w.anchorX,
                    y: w.anchorY
                } : s._anchor
            },
            setAnchor: function (A, F, h) {
                var s, P = this;
                "number" == typeof A ? s = {
                    x: A,
                    y: F
                } : (s = A.length ? {
                    x: A[0],
                    y: A[1]
                } : A, h = F);
                var p = P.getAnchor();
                if (p.x !== s.x || p.y !== s.y) {
                    var Q = P.getDataModel();
                    if (Q && Q.beginTransaction(), P._anchor = s, P.fp("anchor", p, s), h && !vk) {
                        var V = P.getPosition(),
                            B = P.getSize(),
                            _ = P.getRotation(),
                            Y = P.getScale(),
                            H = -B.width * (p.x - s.x) * Y.x,
                            S = -B.height * (p.y - s.y) * Y.y,
                            O = R(_),
                            r = w(_);
                        P.setPosition(V.x + r * H - O * S, V.y + O * H + r * S)
                    }
                    return Q && Q.endTransaction(), !0
                }
                return !1
            },
            getScale: function () {
                return this._scale
            },
            setScale: function (E, H) {
                var I, B = this;
                I = 2 === arguments.length ? {
                    x: E,
                    y: H
                } : E;
                var f = B.getScale();
                (f.x !== I.x || f.y !== I.y) && (B._scale = I, B.fp("scale", f, I))
            },
            getScaleTall: function () {
                return this._scaleTall
            },
            getScale3d: function () {
                var v = this,
                    i = v._scaleTall,
                    F = v.getScale();
                return [F.x, i, F.y]
            },
            getFinalScale3d: function () {
                var P = this,
                    i = P.s3(),
                    C = P._dynamicScale3d,
                    V = P.getScale3d();
                return i && (V[0] *= i[0], V[1] *= i[1], V[2] *= i[2]), C && (V[0] *= C[0], V[1] *= C[1], V[2] *= C[2]), V
            },
            getFinalRotation3d: function () {
                var U = this;
                return U._dynamicRotation || U.r3()
            },
            setScaleTall: function (z) {
                var R = this,
                    N = R._scaleTall;
                N !== z && (R._scaleTall = z, R.fp("scaleTall", N, z))
            },
            setScale3d: function (X, b, M) {
                var s, q = this;
                s = "number" == typeof X ? {
                    x: X,
                    y: b,
                    z: M
                } : X.length ? {
                    x: X[0],
                    y: X[1],
                    z: X[2]
                } : X, q.setScaleTall(s.y), q.setScale(s.x, s.z)
            },
            getCorners: function (u, X) {
                u == h && (u = 0), X == h && (X = u);
                var I = this,
                    y = I.getAnchor(),
                    s = I.getWidth(),
                    t = I.getHeight(),
                    k = -s * y.x - u,
                    $ = -t * y.y - X,
                    g = s + 2 * u,
                    V = t + 2 * X,
                    q = I.getMatrix();
                return [q.tf(k, $), q.tf(k, $ + V), q.tf(k + g, $ + V), q.tf(k + g, $)]
            },
            getEditControlPoints: function (Q, O, p) {
                O == h && (O = 0), p == h && (p = O);
                var T = this,
                    u = T.getAnchor(),
                    S = T.getWidth(),
                    s = T.getHeight(),
                    R = -S * u.x - O,
                    K = -s * u.y - p,
                    G = S + 2 * O,
                    x = s + 2 * p;
                if (Q) return [{
                    x: R,
                    y: K
                }, {
                    x: R,
                    y: 0
                }, {
                    x: R,
                    y: K + x
                }, {
                    x: 0,
                    y: K + x
                }, {
                    x: R + G,
                    y: K + x
                }, {
                    x: R + G,
                    y: 0
                }, {
                    x: R + G,
                    y: K
                }, {
                    x: 0,
                    y: K
                }];
                var t = T.getMatrix();
                return [t.tf(R, K), t.tf(R, 0), t.tf(R, K + x), t.tf(0, K + x), t.tf(R + G, K + x), t.tf(R + G, 0), t.tf(R + G, K), t.tf(0, K)]
            },
            rotateAt: function (c, r, a) {
                var u = this,
                    S = u._position,
                    J = u._64O,
                    K = new xe(J, S.x, S.y).tf(c, r),
                    z = l(c * c + r * r),
                    x = H(S.y - K.y, S.x - K.x) + a;
                u.setRotation(J + a), u.p(K.x + z * w(x), K.y + z * R(x))
            },
            onParentChanged: function () {
                Ln.superClass.onParentChanged.apply(this, arguments), this._8I()
            },
            _8I: function () {
                this._70O && this._70O.each(function (V) {
                    V._7I()
                })
            },
            onPropertyChanged: function () {
                var V = {};
                return "width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function (K) {
                    V[K] = !0
                }),
                    function (N) {
                        var p = this;
                        Ln.superClass.onPropertyChanged.call(p, N), V[N.property] && !p._layoutUpdating && p.updateLayoutParameters(null, N.property), p._69O && p._69O.each(function (j) {
                            j.handleHostPropertyChange(N)
                        }), p._49I && p._49I.each(function (B) {
                            B.fp("agentChange", !0, !1)
                        })
                    }
            }(),
            onHostChanged: function () {
                this.updateAttach()
            },
            handleHostPropertyChange: function (p) {
                this.updateAttach(p)
            },
            onStyleChanged: function (H) {
                Ln.superClass.onStyleChanged.apply(this, arguments), Dg[H] && this.updateAttach()
            },
            updateAttach: function (y) {
                var D = this;
                D._51I || vk || (D._51I = 1, D._71O(y), delete D._51I)
            },
            _71O: function (O) {
                var Q, a, z, x, o, G, p = this,
                    F = p._host,
                    P = O ? O.property : h,
                    j = O ? O.oldValue : h,
                    K = O ? O.newValue : h;
                if (F instanceof k.Grid) {
                    if (P === Je) p.setElevation(p._54O + K - j);
                    else if (!O || Yk[P]) {
                        if (Q = p.s("attach.row.index"), a = p.s("attach.column.index"), z = F.getCellRect(Q, a), !z) return;
                        x = p.s("attach.row.span"), o = p.s("attach.column.span"), (1 !== x || 1 !== o) && (z = Rq(z, F.getCellRect(Q + x - 1, a + o - 1))), te(z, p, "attach.padding", 1), p.setRect(z)
                    }
                } else if (F instanceof lh && (G = p.s("attach.index")) >= 0 && (!O || Rg[P])) {
                    var i = p.s("attach.thickness");
                    i != h && p.setHeight(F.getThickness() * i);
                    var Z = p.s("attach.offset"),
                        l = F.getPoints(),
                        Y = l.size();
                    if (Y > G) {
                        var J = l.get(G),
                            L = Y === G + 1 ? l.get(0) : l.get(G + 1),
                            e = [L.x - J.x, L.y - J.y],
                            g = Me(e);
                        if (g) {
                            p.s("attach.offset.relative") && (Z *= g), p.s("attach.offset.opposite") && (Z = g - Z);
                            var I = {
                                    x: J.x + e[0] / g * Z,
                                    y: J.y + e[1] / g * Z
                                },
                                M = p.s("attach.gap");
                            M && (p.s("attach.gap.relative") && (M *= F.getThickness()), I = Ze(h, I, L, M)), p.p(I), p.setRotation(H(e[1], e[0]))
                        }
                    }
                } else O && (P === cr ? p.translate(K.x - j.x, K.y - j.y) : P === Je ? p.setElevation(p._54O + K - j) : dc[P] ? p._11Q(F, P, K - j) : ("anchor" === P || "width" === P || "height" === P || "scale" === P) && p.layout(F))
            },
            _11Q: function () {
                var t = new k.Math.Euler,
                    v = k.Math.Euler.ReverseOrder,
                    r = new k.Math.Vector2,
                    R = new k.Math.Vector2;
                return function (P, J, W) {
                    var d = this,
                        e = P.p3(),
                        G = P.r3(),
                        N = d.p3(),
                        Q = d.r3();
                    if (J === Dn && (J = "rotationY", W = -W), (J === Dn || "rotationY" === J) && 0 === Q[0] && 0 === Q[2] && 0 === G[0] && 0 === G[2] && 0 === N[1] && 0 === e[1]) return d.setRotation(-Q[1] - W), r.set(N[0], N[2]).rotateAround(R.set(e[0], e[2]), -W), d.p(r.x, r.y), void 0;
                    var X = ns[P.getRotationMode()],
                        n = X[0],
                        Y = X[1],
                        c = X[2],
                        x = Ri[n],
                        H = Ri[Y],
                        U = Ri[c],
                        f = Ip();
                    J === Dn + n ? (U(f, G[Pd[c]]), H(f, G[Pd[Y]]), x(f, W), H(f, -G[Pd[Y]]), U(f, -G[Pd[c]])) : J === Dn + Y ? (U(f, G[Pd[c]]), H(f, W), U(f, -G[Pd[c]])) : J === Dn + c && U(f, W);
                    var _ = on(N, e);
                    Br(_, f), d.p3(e[0] + _[0], e[1] + _[1], e[2] + _[2]);
                    var w = d.getRotationMode();
                    zb(f, d.r3(), w), t.setFromRotationMatrix(f, v(w)), d.r3([t.x, t.y, t.z])
                }
            }(),
            isHostOn: function (b) {
                var n = this;
                if (n._host && b && b._69O)
                    for (var W = {}, c = n._host; c && c !== n && !W[c._id];) {
                        if (c === b) return !0;
                        W[c._id] = c, c = c._host
                    }
                return !1
            },
            isLoopedHostOn: function (w) {
                return this.isHostOn(w) && w.isHostOn(this)
            },
            getScaledSize: function () {
                var W = this.getSize(),
                    t = this.getScale();
                return W.width *= Math.abs(t.x), W.height *= Math.abs(t.y), W
            },
            layout: function (w) {
                if (w = w || this.getHost()) {
                    var h = this,
                        L = h.s("layout.h") || "center",
                        j = h.s("layout.v") || "center";
                    if ("center" !== L || "center" !== j) {
                        var q = new k.Math.Vector2,
                            x = w.getPosition(),
                            u = w.getAnchor(),
                            H = w.getScaledSize();
                        h.getPosition();
                        var g, m, Z, M, $, S = 1,
                            _ = 1;
                        switch (h._layoutUpdating = !0, L) {
                            case "left":
                                q.setX(h._layoutHValue - u.x * H.width);
                                break;
                            case "right":
                                q.setX((1 - u.x) * H.width - h._layoutHValue);
                                break;
                            case "leftright":
                                g = H.width - h._layoutHValue[2], Z = h.getRotation() - w.getRotation(), M = Math.abs(Math.sin(Z)), $ = Math.abs(Math.cos(Z)), S += $ * g / h._layoutHValue[3], _ += M * g / h._layoutHValue[4], q.setX(h._layoutHValue[1] + (h._layoutHValue[5] - u.x) * H.width);
                                break;
                            case "center":
                                q.setX((.5 - u.x) * H.width - h._layoutHValue);
                                break;
                            case "scale":
                                Z = h.getRotation() - w.getRotation(), M = Math.abs(Math.sin(Z)), $ = Math.abs(Math.cos(Z)), q.setX((.5 - u.x) * H.width - h._layoutHValue[1] * H.width / h._layoutHValue[0]), m = H.width / h._layoutHValue[2] - 1, S += $ * m, _ += M * m
                        }
                        switch (j) {
                            case "top":
                                q.setY(h._layoutVValue - u.y * H.height);
                                break;
                            case "bottom":
                                q.setY((1 - u.y) * H.height - h._layoutVValue);
                                break;
                            case "topbottom":
                                Z || (Z = h.getRotation() - w.getRotation(), M = Math.abs(Math.sin(Z)), $ = Math.abs(Math.cos(Z))), g = H.height - h._layoutVValue[2], S += M * g / h._layoutVValue[3], _ += $ * g / h._layoutVValue[4], q.setY(h._layoutVValue[1] + (h._layoutVValue[5] - u.y) * H.height);
                                break;
                            case "center":
                                q.setY((.5 - u.y) * H.height - h._layoutVValue);
                                break;
                            case "scale":
                                Z || (Z = h.getRotation() - w.getRotation(), M = Math.abs(Math.sin(Z)), $ = Math.abs(Math.cos(Z))), q.setY((.5 - u.y) * H.height - h._layoutVValue[1] * H.height / h._layoutVValue[0]), m = H.height / h._layoutVValue[2] - 1, S += M * m, _ += $ * m
                        }(1 !== S || 1 !== _) && ("leftright" === L || "scale" === L ? h.setSize(h._layoutHValue[3] * S, h._layoutHValue[4] * _) : h.setSize(h._layoutVValue[3] * S, h._layoutVValue[4] * _)), q.rotateAround(null, w.getRotation()), this.setPosition(q.x + x.x, q.y + x.y), h._layoutUpdating = p
                    }
                }
            },
            updateLayoutParameters: function (J, v) {
                if (J = J || this.getHost()) {
                    var O = this,
                        q = O.s("layout.h"),
                        L = O.s("layout.v");
                    if (q || L) {
                        var Q, P, r, N, p, j, U = new k.Math.Vector2,
                            W = J.getPosition(),
                            f = J.getAnchor(),
                            x = J.getScaledSize(),
                            s = O.getPosition(),
                            l = O.getSize();
                        switch (U.set(s.x - W.x, s.y - W.y), U.rotateAround(null, -J.getRotation()), q) {
                            case "left":
                                O._layoutHValue = U.x + f.x * x.width;
                                break;
                            case "right":
                                O._layoutHValue = -U.x + (1 - f.x) * x.width;
                                break;
                            case "center":
                                O._layoutHValue = -U.x + (.5 - f.x) * x.width;
                                break;
                            case "leftright":
                            case "scale":
                                "scale" === q ? Q = -U.x + (.5 - f.x) * x.width : (P = O.getAnchor(), r = O.getRotation() - J.getRotation(), N = Math.cos(r), p = Math.sin(r), j = -Math.min(-P.x * N + P.y * p, -P.x * N - (1 - P.y) * p, (1 - P.x) * N + P.y * p, (1 - P.x) * N - (1 - P.y) * p), Q = U.x - (j - f.x) * x.width), "position" === v && "object" == typeof O._layoutHValue ? (O._layoutHValue[0] = x.width, O._layoutHValue[1] = Q) : O._layoutHValue = [x.width, Q, x.width, l.width, l.height, j]
                        }
                        switch (L) {
                            case "top":
                                O._layoutVValue = U.y + f.y * x.height;
                                break;
                            case "bottom":
                                O._layoutVValue = -U.y + (1 - f.y) * x.height;
                                break;
                            case "center":
                                O._layoutVValue = -U.y + (.5 - f.y) * x.height;
                                break;
                            case "topbottom":
                            case "scale":
                                "scale" === L ? Q = -U.y + (.5 - f.y) * x.height : (r || (P = O.getAnchor(), r = O.getRotation() - J.getRotation(), N = Math.cos(r), p = Math.sin(r)), j = -Math.min(-P.x * p - P.y * N, -P.x * p + (1 - P.y) * N, (1 - P.x) * p - P.y * N, (1 - P.x) * p + (1 - P.y) * N), Q = U.y - (j - f.y) * x.height), "position" === v && "object" == typeof O._layoutVValue ? (O._layoutVValue[0] = x.height, O._layoutVValue[1] = Q) : O._layoutVValue = [x.height, Q, x.height, l.width, l.height, j]
                        }
                    }
                }
            },
            getSerializableProperties: function () {
                var b = Ln.superClass.getSerializableProperties.call(this);
                return xr(b, {
                    image: 1,
                    host: 1,
                    rotation: 1,
                    rotationX: 1,
                    rotationZ: 1,
                    rotationMode: 1,
                    position: 1,
                    anchor: 1,
                    anchorElevation: 1,
                    scale: 1,
                    scaleTall: 1,
                    _width: 1,
                    _height: 1,
                    _tall: 1,
                    elevation: 1
                }), b
            }
        });
        var nk = k.Edge = function (e, F) {
            var n = this;
            cj(nk, n), n.setSource(e), n.setTarget(F)
        };
        If("Edge", rr, {
            _icon: "edge_icon",
            getUIClass: function () {
                return kf
            },
            _22Q: function () {
                return Uh
            },
            getSource: function () {
                return this._source
            },
            getTarget: function () {
                return this._target
            },
            getSourceAgent: function () {
                return this._40I
            },
            getTargetAgent: function () {
                return this._41I
            },
            setSource: function (s) {
                var I = this;
                if (I._source !== s) {
                    var V = I._source;
                    I._source = s, V && V._16I(I), s && s._2I(I), I._7I(), I.fp("source", V, s)
                }
            },
            setTarget: function (s) {
                var b = this;
                if (b._target !== s) {
                    var P = b._target;
                    b._target = s, P && P._18I(b), s && s._4I(b), b._7I(), b.fp("target", P, s)
                }
            },
            isLooped: function () {
                var w = this;
                return w._source === w._target && !!w._source && !!w._target
            },
            onPropertyChanged: function () {},
            _7I: function () {
                var x, k = this,
                    n = Vk(k);
                k._40I !== n && (x = this._40I, x && x._15I(k), k._40I = n, n && n._1I(k), k.fp("sourceAgent", x, n), js(x, k._41I), js(n, k._41I));
                var Z = Ag(k);
                k._41I !== Z && (x = k._41I, x && x._17I(k), k._41I = Z, Z && Z._3I(k), k.fp("targetAgent", x, Z), js(x, k._40I), js(Z, k._40I))
            },
            _22I: function (H) {
                this._52I = H, this.fp("edgeGroup", !0, !1)
            },
            getEdgeGroup: function () {
                return this._52I
            },
            isEdgeGroupHidden: function () {
                var C = this;
                return C._52I && C._52I.get(0) !== C && !C.getStyle(Mq)
            },
            getEdgeGroupSize: function () {
                return this._52I ? this._52I.size() : 1
            },
            getEdgeGroupIndex: function () {
                return this._52I ? this._52I.indexOf(this) : 0
            },
            isEdgeGroupAgent: function () {
                var f = this,
                    Y = f._52I;
                return Y && !f.getStyle(Mq) && Y.size() > 1 && f === Y.get(0)
            },
            toggle: function () {
                var H = this._52I,
                    P = !this.s(Mq);
                H && H.size() > 1 && (H.each(function (n) {
                    n.s(Mq, P)
                }), H.getSiblings().each(function (Z) {
                    Z !== H && Z.each(function (g) {
                        g.fp("edgeGroup", h, Z)
                    })
                }))
            },
            setStyle: function (r, g) {
                (r === Wr || "edge.segments" === r) && (g = Xo(g)), nk.superClass.setStyle.call(this, r, g)
            },
            onStyleChanged: function (x) {
                nk.superClass.onStyleChanged.apply(this, arguments), Hn[x] && js(this._41I, this._40I)
            },
            getSerializableProperties: function () {
                var y = nk.superClass.getSerializableProperties.call(this);
                return xr(y, {
                    source: 1,
                    target: 1
                }), y
            }
        });
        var no = k.Group = function () {
            cj(no, this)
        };
        If("Group", Ln, {
            _image: "group_image",
            _icon: "group_icon",
            _57O: !1,
            getUIClass: function () {
                return Oc
            },
            onChildAdded: function () {
                no.superClass.onChildAdded.apply(this, arguments), this._81I()
            },
            onChildRemoved: function () {
                no.superClass.onChildRemoved.apply(this, arguments), this._81I()
            },
            _81I: function () {
                var L = this;
                if (!L._54I && !vk) {
                    var b = L.getChildrenRect();
                    b && (L._53I = 1, L.p(sj(L.s("group.position"), b, L.getSize())), delete L._53I)
                }
            },
            getChildrenRect: function () {
                var i, u = this;
                return u.eachChild(function (B) {
                    Cc(B) && (i = Rq(i, u.getChildRect(B)))
                }), i
            },
            getChildRect: function (n) {
                var W;
                return Cc(n) && n.s(ih) && (an(n) && n.isExpanded() && n.eachChild(function (R) {
                    W = Rq(W, n.getChildRect(R))
                }), !W && n.getRect && (W = n.getRect())), W
            },
            setPosition: function (K, t) {
                var v = this;
                if (!v._54I) {
                    var Y;
                    Y = 2 === arguments.length ? {
                        x: K,
                        y: t
                    } : K, vk || v._53I || (v._54I = 1, Tq(v._children, Y.x - v._position.x, Y.y - v._position.y), delete v._54I), no.superClass.setPosition.call(this, Y)
                }
            },
            toggle: function () {
                this.setExpanded(!this.isExpanded())
            },
            isExpanded: function () {
                return this._57O
            },
            setExpanded: function (S) {
                var I = this;
                if (I._57O !== S) {
                    var C = I._57O;
                    I._57O = S, I.fp("expanded", C, I._57O), I._fireInvalidateDeep(), I._8I()
                }
            },
            _fireInvalidateDeep: function () {
                this.eachChild(function (b) {
                    an(b) ? b._fireInvalidateDeep() : b.iv()
                })
            },
            _8I: function () {
                no.superClass._8I.call(this), this.eachChild(function (U) {
                    Cc(U) && U._8I()
                })
            },
            onStyleChanged: function (h) {
                no.superClass.onStyleChanged.apply(this, arguments), "group.position" === h && this._81I()
            },
            getSerializableProperties: function () {
                var F = no.superClass.getSerializableProperties.call(this);
                return F.expanded = 1, F
            }
        });
        var tf = k.Block = function () {
            cj(tf, this)
        };
        If("Block", Ln, {
            _icon: "block_icon",
            _clickThroughEnabled: !1,
            _syncSize: !0,
            ms_ac: ["clickThroughEnabled", "syncSize"],
            getUIClass: function () {
                return is
            },
            onChildAdded: function () {
                tf.superClass.onChildAdded.apply(this, arguments), this.updateFromChildren()
            },
            onChildRemoved: function () {
                tf.superClass.onChildRemoved.apply(this, arguments), this.updateFromChildren()
            },
            updateFromChildren: function () {
                var g = this;
                if (!vk && !g._updatingToChildren && g._syncSize && !g._freezeSyncFromChildren) {
                    var l, T, d, O, C, r = [],
                        J = g.getRotation();
                    if (g.eachChild(function (b) {
                            Cc(b) && r.push.apply(r, b.getCorners())
                        }), r.length) {
                        g._updatingFromChildren = 1;
                        var t = w(-J),
                            I = R(-J),
                            Q = 1 / 0,
                            P = -1 / 0,
                            Z = 1 / 0,
                            q = -1 / 0;
                        for (O = 0, C = r.length; C > O; O++) d = r[O], l = d.x, T = d.y, d.x = t * l - I * T, d.y = I * l + t * T, Q = j(Q, d.x), P = W(P, d.x), Z = j(Z, d.y), q = W(q, d.y);
                        var X = g.getScale();
                        g.setSize(Y((P - Q) / X.x), Y((q - Z) / X.y));
                        var V;
                        X.x < 0 && (V = Q, Q = P, P = V), X.y < 0 && (V = Z, Z = q, q = V), t = w(J), I = R(J);
                        var G = g.getAnchor();
                        l = Q + (P - Q) * G.x, T = Z + (q - Z) * G.y, g.setPosition(t * l - I * T, I * l + t * T), delete g._updatingFromChildren
                    }
                }
            },
            setPosition: function (J, j) {
                var k = this;
                if (!k._updatingToChildren) {
                    var K;
                    K = 2 === arguments.length ? {
                        x: J,
                        y: j
                    } : J, vk || k._updatingFromChildren || (k._updatingToChildren = 1, Tq(k._children, K.x - k._position.x, K.y - k._position.y), delete k._updatingToChildren), tf.superClass.setPosition.call(this, K)
                }
            },
            setWidth: function (Y) {
                return this.setSize(Y, this.getHeight())
            },
            setHeight: function (p) {
                return this.setSize(this.getWidth(), p)
            },
            setSize: function (U, h) {
                1 > U && (U = 1), 1 > h && (h = 1);
                var D = this;
                if (!D._updatingToChildren) {
                    2 !== arguments.length && (h = U.height, U = U.width);
                    var O = D.getWidth(),
                        A = D.getHeight();
                    if (U !== O && tf.superClass.setWidth.call(D, U), h !== A && tf.superClass.setHeight.call(D, h), !vk && !D._updatingFromChildren) {
                        D._updatingToChildren = 1;
                        var y = U / O,
                            Y = h / A;
                        D._adjustChildScaleOrSize(y, Y, "size"), delete D._updatingToChildren, D.updateFromChildren()
                    }
                }
            },
            _adjustChildScaleOrSize: function (p, E, C) {
                var Z = this;
                if (Z._syncSize) {
                    var F = Z.getPosition(),
                        W = Z.getRotation();
                    Z.getScale(), Z.eachChild(function (J) {
                        if (Cc(J)) {
                            var N = J.getPosition(),
                                S = J.getRotation(),
                                i = J.getWidth(),
                                x = J.getHeight(),
                                y = J.getScale(),
                                $ = y.x * i,
                                g = y.y * x,
                                Q = new xe(S, N.x, N.y, $, g);
                            Q.translate(-F.x, -F.y), Q.rotate(-W), S = H(Q.b * Math.sign($), Q.a * Math.sign($)), Q.scale(p, E);
                            var a, j, M, U = w(S);
                            if (Math.abs(U) < .001 ? (a = R(S), j = Q.b / a, M = -Q.c / a) : (j = Q.a / U, M = Q.d / U), "scale" === C) J.setScale(j / i, M / x);
                            else if ("size" === C) {
                                var Y = j / y.x,
                                    P = M / y.y;
                                J.setScale(Ir(j) * Math.abs(y.x), Ir(M) * Math.abs(y.y)), J.setSize(Math.max(.1, Math.abs(Y)), Math.max(.1, Math.abs(P)))
                            }
                            Q.rotate(W), Q.translate(F.x, F.y), J.setPosition(Q.tx, Q.ty)
                        }
                    })
                }
            },
            _calcChangeFactor: function (T, L, m, I) {
                var e, g, s, r;
                return e = Y(T), g = Y(m), s = e > g ? e / g : g / e, e = Y(L), g = Y(I), r = e > g ? e / g : g / e, W(s, r)
            },
            setAnchor: function () {
                var A = this;
                if (!A._updatingToChildren) {
                    var U = A.getAnchor();
                    if (tf.superClass.setAnchor.apply(A, arguments), !vk && !A._updatingFromChildren && A._syncSize) {
                        A._updatingToChildren = 1;
                        var r = A.getAnchor();
                        A.getPosition();
                        var O = A.getSize(),
                            g = A.getScale(),
                            P = A.getRotation(),
                            Z = -O.width * g.x * (U.x - r.x),
                            $ = -O.height * g.y * (U.y - r.y),
                            D = R(P),
                            W = w(P),
                            J = W * Z - D * $,
                            T = D * Z + W * $;
                        A.eachChild(function (R) {
                            if (Cc(R)) {
                                var N = R.getPosition();
                                R.setPosition(N.x - J, N.y - T)
                            }
                        }), delete A._updatingToChildren
                    }
                }
            },
            setRotation: function (g) {
                var h = this;
                if (!h._updatingToChildren) {
                    var s = h.getRotation();
                    if (tf.superClass.setRotation.apply(h, arguments), !vk && !h._updatingFromChildren) {
                        h._updatingToChildren = 1;
                        var z = h.getPosition(),
                            U = g - s;
                        h.eachChild(function (X) {
                            if (Cc(X)) {
                                var O = X.getMatrix();
                                O.translate(-z.x, -z.y), O.rotate(U), O.translate(z.x, z.y);
                                var m = Math.sign(X.getScale().x);
                                X.setRotation(H(O.b * m, O.a * m)), X.setPosition(O.tx, O.ty)
                            }
                        }), delete h._updatingToChildren
                    }
                }
            },
            setScale: function (o, T) {
                var Z = this;
                if (!Z._updatingToChildren) {
                    null == T && (T = o.y, o = o.x);
                    var q = Z.getScale();
                    if (Y(o) < .01 && (o = .01 * (Ir(o) || Ir(q.x))), Y(T) < .01 && (T = .01 * (Ir(T) || Ir(q.y))), tf.superClass.setScale.call(Z, o, T), !vk && !Z._updatingFromChildren) {
                        Z._updatingToChildren = 1;
                        var e = o / q.x,
                            Q = T / q.y;
                        Z._adjustChildScaleOrSize(e, Q, "size"), delete Z._updatingToChildren, Z.updateFromChildren()
                    }
                }
            },
            getSerializableProperties: function () {
                var Z = tf.superClass.getSerializableProperties.call(this);
                return Z.clickThroughEnabled = 1, Z.syncSize = 1, Z
            }
        });
        var fc = k.Grid = function () {
            cj(k.Grid, this)
        };
        If("Grid", Ln, {
            IRotatable: !1,
            _icon: "grid_icon",
            _image: h,
            getUIClass: function () {
                return Vq
            },
            setRotation: function () {},
            getCellRect: function (j, N) {
                var c = this,
                    z = c.s("grid.row.count"),
                    o = c.s("grid.column.count");
                if (0 >= z || 0 >= o || 0 > j || j >= z || 0 > N || N >= o) return h;
                var C, t, Q, q = c.getRect(),
                    S = c.s("grid.row.percents"),
                    u = c.s("grid.column.percents");
                if (te(q, c, "grid.border", -1), S && S._as && (S = S._as), u && u._as && (u = u._as), S && S.length === z) {
                    for (Q = 0, C = 0; j > C; C++) Q += q.height * S[C];
                    q.y += Q, q.height = q.height * S[j]
                } else q.height = q.height / z, q.y += q.height * j;
                if (u && u.length === o) {
                    for (t = 0, C = 0; N > C; C++) t += q.width * u[C];
                    q.x += t, q.width = q.width * u[N]
                } else q.width = q.width / o, q.x += q.width * N;
                return $d(q, -c.s("grid.gap")), q
            }
        });
        var zo = k.Text = function () {
            cj(zo, this), this.setSize(100, 50), this.s("text", "TEXT")
        };
        If("Text", Ln, {
            _icon: "text_icon",
            _image: "__text__",
            getUIClass: function () {
                return Nd
            },
            setWidth: function (h) {
                h || (h = .001), zo.superClass.setWidth.call(this, h)
            },
            setHeight: function (G) {
                G || (G = .001), zo.superClass.setHeight.call(this, G)
            },
            toLabel: function () {
                return this._displayName || this._name || this.s("text")
            }
        }), Ej("__text__", {
            width: {
                value: 100,
                isSafeFunc: !0,
                func: function (N) {
                    return N._width
                }
            },
            height: {
                value: 50,
                isSafeFunc: !0,
                func: function (b) {
                    return b._height
                }
            },
            comps: [{
                type: "text",
                relative: !0,
                rect: [0, 0, 1, 1],
                text: {
                    func: "style@text"
                },
                align: {
                    func: "style@text.align"
                },
                vAlign: {
                    func: "style@text.vAlign"
                },
                color: {
                    func: "style@text.color"
                },
                font: {
                    func: "style@text.font"
                },
                shadow: {
                    func: "style@text.shadow"
                },
                shadowColor: {
                    func: "style@text.shadow.color"
                },
                shadowBlur: {
                    func: "style@text.shadow.blur"
                },
                shadowOffsetX: {
                    func: "style@text.shadow.offset.x"
                },
                shadowOffsetY: {
                    func: "style@text.shadow.offset.y"
                },
                scaleX: {
                    func: "style@text.scale.x"
                },
                scaleY: {
                    func: "style@text.scale.y"
                }
            }]
        });
        var lh = k.Shape = function () {
            cj(lh, this), this._59O = new vf
        };
        lh.__de__ = zg, If("Shape", Ln, {
            ms_ac: ["thickness", "closePath"],
            _icon: "shape_icon",
            _thickness: 10,
            _closePath: !1,
            getUIClass: function () {
                return eg
            },
            _22Q: function () {
                return Yf
            },
            getLength: function (b) {
                return Xh(fh(this._59O, this._58O, b, this._closePath))
            },
            getSegments: function () {
                return this._58O
            },
            toSegments: function () {
                var l = this._58O;
                return l ? new vf(l._as.slice(0)) : l
            },
            setSegments: function (e) {
                var M = this._58O;
                e = e ? nj(e) ? new vf(e.slice(0)) : new vf(e._as.slice(0)) : null, (M && e && M._as.join(",") !== e._as.join(",") || M !== e) && (this._58O = e, this.fp("segments", M, e))
            },
            getPoints: function () {
                return this._59O
            },
            toPoints: function () {
                var h = this._59O;
                return new vf(h._as.slice(0))
            },
            setPoints: function (g, M) {
                var h = this,
                    x = h._59O;
                g = g ? nj(g) ? new vf(g.slice(0)) : new vf(g._as.slice(0)) : new vf;
                var A, U, v, l, E, J;
                M && (A = h.getPosition(), J = new xe(h.getRotation(), 0, 0, h.getScale().x, h.getScale().y)), (x && g && x._as.join(",") !== g._as.join(",") || x !== g) && (h._59O = g, h.fs(), h.fp("points", x, g)), M && (U = h.getPosition(), v = U.x - A.x, l = U.y - A.y, E = J.tf(v, l), h.setPosition(U.x - v + E.x, U.y - l + E.y))
            },
            addPoint: function (Y, V, K) {
                var f = this.toPoints();
                f.add(Y, V), this.setPoints(f, K)
            },
            setPoint: function (P, r, b) {
                var w = this.toPoints();
                w.set(P, r), this.setPoints(w, b)
            },
            removePointAt: function (q) {
                var M = this.toPoints();
                M.removeAt(q), this.setPoints(M)
            },
            setWidth: function (q) {
                var o = this;
                if (1 > q && (q = 1), !o._55I && !vk && o.getWidth()) {
                    o._55I = 1;
                    var K = o._position.x,
                        I = q / o.getWidth(),
                        E = o.toPoints(),
                        s = new vf;
                    E.each(function (N) {
                        s.add({
                            x: (N.x - K) * I + K,
                            y: N.y,
                            e: N.e
                        })
                    }), o.setPoints(s), Ep(o, [I, 0, 0, 1, K * (1 - I), 0]), o.fs(), delete o._55I
                }
                lh.superClass.setWidth.call(o, q)
            },
            setHeight: function (J) {
                var P = this;
                if (1 > J && (J = 1), !P._55I && !vk && P.getHeight()) {
                    P._55I = 1;
                    var A = P._position.y,
                        v = J / P.getHeight(),
                        m = P.toPoints(),
                        B = new vf;
                    m.each(function (O) {
                        B.add({
                            x: O.x,
                            y: (O.y - A) * v + A,
                            e: O.e
                        })
                    }), P.setPoints(B), Ep(P, [1, 0, 0, v, 0, A * (1 - v)]), P.fs(), delete P._55I
                }
                lh.superClass.setHeight.call(P, J)
            },
            setAnchorElevation: function (R) {
                var w = this;
                w._55I = !0;
                var f = w._updatingAnchor3d,
                    Q = !vk && !f;
                if (Q) {
                    var b, y = R,
                        F = w.getAnchorElevation(),
                        m = w.getTall();
                    b = m * (F - y), w.shiftPointsElevation(b)
                }
                var c = lh.superClass.setAnchorElevation.apply(w, arguments);
                return f || delete w._55I, c
            },
            getShapeElevation: function () {
                var K = this,
                    H = K._54O;
                return H - (K.getTall() || 0) * (K._anchorElevation - .5)
            },
            setAnchor3d: function (N, m, n, S) {
                var x, R = this;
                "number" == typeof N ? x = {
                    x: N,
                    y: m,
                    z: n
                } : (x = N.length ? {
                    x: N[0],
                    y: N[1],
                    z: N[2]
                } : N, S = m), R._55I = !0, R._updatingAnchor3d = !0;
                var Y = R.getDataModel();
                if (Y && Y.beginTransaction(), !vk) {
                    var G = R.getAnchor3d(),
                        C = R.getSize(),
                        i = R.getTall(),
                        o = C.width * (G.x - x.x),
                        h = C.height * (G.z - x.z),
                        A = i * (G.y - x.y);
                    S || R.shiftPoints(o, h, A);
                    var l = R.p3()
                }
                var r = lh.superClass.setAnchor3d.apply(R, arguments);
                if (!vk && S) {
                    var u = R.p3();
                    R.shiftPoints(u[0] - l[0] + o, u[2] - l[2] + h, u[1] - l[1] + A)
                }
                return Y && Y.endTransaction(), delete R._updatingAnchor3d, delete R._55I, r
            },
            setAnchor: function (U, D, k) {
                var H = this;
                H._55I = !0;
                var m = H._updatingAnchor3d,
                    O = !vk && !m;
                if (O) {
                    var h, v, G;
                    "number" == typeof U ? G = {
                        x: U,
                        y: D
                    } : (G = U.length ? {
                        x: U[0],
                        y: U[1]
                    } : U, k = D);
                    var M = H.getAnchor(),
                        y = H.getSize();
                    h = y.width * (M.x - G.x), v = y.height * (M.y - G.y), k || H.shiftPoints(h, v);
                    var C = H.getPosition()
                }
                var X = lh.superClass.setAnchor.apply(H, arguments);
                if (O) {
                    var t = H.getPosition();
                    k && H.shiftPoints(t.x - C.x + h, t.y - C.y + v)
                }
                return m || delete H._55I, X
            },
            shiftPoints: function (t, x, p) {
                var y = this,
                    q = y.getElevation() || 0,
                    m = y.toPoints(),
                    A = new vf;
                m.each(function (G) {
                    var $ = G.e;
                    p && ($ = ($ == h ? q : $) + p), A.add({
                        x: G.x + t,
                        y: G.y + x,
                        e: $
                    })
                }), y.setPoints(A), y.fs()
            },
            shiftPointsElevation: function (_) {
                return this.shiftPoints(0, 0, _)
            },
            setPosition: function (I, W) {
                var i, V = this;
                if (!V._28Q) {
                    if (V._28Q = 1, !V._55I && !vk) {
                        i = 2 === arguments.length ? {
                            x: I,
                            y: W
                        } : I;
                        var Z = i.x - V._position.x,
                            s = i.y - V._position.y;
                        if (0 === Z && 0 === s) return delete V._28Q, void 0;
                        V._55I = 1, V.shiftPoints(Z, s), Ep(V, [1, 0, 0, 1, Z, s]), delete V._55I
                    }
                    lh.superClass.setPosition.apply(V, arguments), delete V._28Q
                }
            },
            fs: function () {
                this.fireShapeChange()
            },
            _70I: function () {
                var y = this;
                if (2 !== y._59O.size()) return !1;
                var d = y._58O;
                return d ? 2 === d.size() && 1 === d.get(0) && 2 === d.get(1) ? !0 : !1 : !0
            },
            fireShapeChange: function () {
                var J = this;
                if (!J._55I && !vk) {
                    var x = Vj(J._59O);
                    x && (J._55I = 1, J.setRect(x), delete J._55I)
                }
                J.fp(ef, !1, !0)
            },
            getSerializableProperties: function () {
                var k = lh.superClass.getSerializableProperties.call(this);
                return k.segments = 1, k.points = 1, k.thickness = 1, k.closePath = 1, k
            }
        });
        var qd = k.Polyline = function () {
            cj(qd, this), this.s({
                "shape.background": null,
                "shape.border.width": 2
            })
        };
        If("Polyline", lh, {
            _icon: "polyline_icon",
            _22Q: function () {
                return ln
            },
            getUIClass: function () {
                return To
            },
            setClosePath: function () {},
            setTall: function (r) {
                var N = this;
                if (!N._55I && !N._24Q && !vk && N.getTall()) {
                    N._24Q = 1;
                    var S = N._54O,
                        Z = r / N.getTall();
                    N._59O.each(function (E) {
                        E.e = E.e == h ? S : (E.e - S) * Z + S
                    }), N.fs(), delete N._24Q
                }
                qd.superClass.setTall.call(N, r)
            },
            setElevation: function (o) {
                var G = this;
                if (!G._55I && !G._24Q && !vk) {
                    G._24Q = 1;
                    var d = o - G._54O;
                    G._59O.each(function (v) {
                        v.e == h ? v.e = o : v.e += d
                    }), G.fs(), delete G._24Q
                }
                qd.superClass.setElevation.apply(G, arguments)
            },
            fireShapeChange: function () {
                var R = this,
                    l = R._59O;
                if (!R._55I && !R._24Q && !vk) {
                    var a = l.size();
                    if (a) {
                        var S = 1,
                            Q = l.get(0),
                            G = R._54O;
                        Q.e == h && (Q.e = G);
                        for (var X = Q.e, K = 0; a > S; S++) {
                            Q = l.get(S), Q.e == h && (Q.e = G);
                            var u = j(X, Q.e),
                                k = W(X + K, Q.e);
                            X = u, K = k - u
                        }
                        R._24Q = 1, R.setTall(K), R.setElevation(X + K * R._anchorElevation), delete R._24Q
                    }
                }
                qd.superClass.fireShapeChange.apply(R, arguments)
            }
        });
        var wi = k.SubGraph = function () {
            cj(wi, this)
        };
        If("SubGraph", Ln, {
            ISubGraph: 1,
            _image: "subGraph_image",
            _icon: "subGraph_icon",
            _8I: function () {
                wi.superClass._8I.call(this), this.eachChild(function (F) {
                    Cc(F) && F._8I()
                })
            }
        }), f.loadingRefGraph = 0;
        var mg = k.RefGraph = function () {
            cj(mg, this)
        };
        If("RefGraph", tf, {
            _icon: "refGraph_icon",
            getRef: function () {
                return this._ref
            },
            setRef: function (c) {
                var T = this._ref;
                this._ref = c, this.fp("ref", T, c), this.updateRef()
            },
            _21I: function () {
                mg.superClass._21I.apply(this, arguments), this.updateRef()
            },
            updateRef: function () {
                var r = this;
                if (f.loadingRefGraph++, r.clearChildrenFromDataModel(), f.loadingRefGraph--, r._ref && r._dataModel) {
                    r._xhrLoadHandler && (r._xhrLoadHandler.cancel = !0);
                    var j = vk,
                        H = r._xhrLoadHandler = function (E) {
                            if (E && r._dataModel) {
                                f.loadingRefGraph++;
                                var N = r._pendingUpdateInfo = {
                                    needToRestore: j
                                };
                                j && (N.position = r.p(), N.width = r.getWidth(), N.height = r.getHeight(), N.rotation = r.getRotation(), N.anchor = r.getAnchor(), N.scale = r.getScale()), r.p(0, 0), r.setAnchor(.5, .5), r.setRotation(0), r.setScale(1, 1);
                                var c = f.parse(E),
                                    X = r._dataModel.deserialize(c, r, {
                                        justDatas: !0
                                    });
                                X.each(function (D) {
                                    D._refGraph = r
                                }), r.checkPendingUpdateInfo(), f.loadingRefGraph--, f.handleRefGraphLoaded(r, X, c)
                            }
                        };
                    H.xhrLoadCalled = !1, f.load(r._ref, function (c) {
                        H.cancel || (H.xhrLoadCalled ? H(c) : Zl(function () {
                            H(c)
                        }))
                    }), H.xhrLoadCalled = !0
                }
            },
            checkPendingUpdateInfo: function () {
                var k = this,
                    r = k._pendingUpdateInfo;
                if (!r) return k.onPendingUpdated && (f.loadingRefGraph++, k.onPendingUpdated(), f.loadingRefGraph--), void 0;
                var A = !0;
                this.eachChild(function (M) {
                    (M._pendingCheckImageJSON || M._pendingUpdateInfo) && (A = !1)
                }), A && (f.loadingRefGraph++, k._pendingUpdateInfo = null, k.updateFromChildren(), r.needToRestore && (k.setSize(r.width, r.height), k.setAnchor(r.anchor), k.setRotation(r.rotation), k.setScale(r.scale), k.p(r.position)), this.getParent() instanceof mg && this.getParent().checkPendingUpdateInfo(), k.onPendingUpdated && k.onPendingUpdated(), f.loadingRefGraph--)
            },
            getSerializableProperties: function () {
                var R = mg.superClass.getSerializableProperties.call(this);
                return R.ref = 1, R
            }
        }), k.EdgeGroup = function (m, V) {
            this._70O = m, this._siblings = V;
            for (var e, k, v = 0, O = m.size(), _ = C[Mq]; O > v; v++)
                if (e = m.get(v).getStyle(Mq, !1), e != h) {
                    _ = e;
                    break
                }
            _ == h && (_ = !0);
            var N = f.edgeGroupAgentFunc;
            for (N && (k = N(m), k && k !== m.get(0) && (m.remove(k), m.add(k, 0))), v = 0; O > v; v++) m.get(v).s(Mq, _)
        }, If("EdgeGroup", x, {
            getEdges: function () {
                return this._70O
            },
            size: function () {
                return this._70O.size()
            },
            get: function (S) {
                return this._70O.get(S)
            },
            indexOf: function (e) {
                return this._70O.indexOf(e)
            },
            each: function (P, D) {
                this._70O.each(P, D)
            },
            getSiblings: function () {
                return this._siblings
            },
            eachSiblingEdge: function (T, w) {
                this._siblings.each(function (A) {
                    A._70O.each(T, w)
                })
            }
        });
        var Tl = function (s, j, I) {
            var _ = bn[s] = {
                type: s,
                action: j
            };
            if (I)
                for (var d in I) _[d] = I[d]
        };
        xr(f, {
            setConnectAction: Tl,
            getConnectAction: function ($, X) {
                if (!X) {
                    if (!$) return null;
                    X = $.getCurrentConnectActionType()
                }
                return bn[X]
            },
            doConnectAction: function (P, h, S, n) {
                n = n || P.getCurrentConnectActionType();
                var o = bn[n];
                if (!o) return !1;
                var O = o.action;
                return O ? (h instanceof Sf.Group ? P.sm().getSelection().each(function (d) {
                    O.call(null, P, d, S)
                }) : O.call(null, P, h, S), !0) : !1
            },
            doDeleteConnectionAction: function (T, K, G) {
                G = G || T.getCurrentConnectActionType();
                var O = bn[G];
                if (!O || !O.delete) return !1;
                var J = O.delete.action;
                return J ? (K instanceof Sf.Group ? T.sm().getSelection().each(function (p) {
                    J.call(null, T, p)
                }) : J.call(null, T, K), !0) : !1
            }
        });
        var Kc = k.JSONSerializer = function (D, d) {
            this.dm = this._dataModel = D, this._hierarchical = f.forceHierarchicalSerialization ? !0 : d == h ? D.isHierarchicalRendering() : d
        };
        If("JSONSerializer", x, {
            ms_ac: ["hierarchical"],
            serialize: function (z) {
                return f.stringify(this.toJSON(), z)
            },
            toJSON: function () {
                var J = this,
                    b = J.dm,
                    y = b.getRoots(),
                    I = J.json = {
                        v: f.getVersion(),
                        p: {},
                        a: {},
                        d: []
                    },
                    E = b.getSerializableAttrs();
                b.getInit() && (I.init = b.getInit()), b.getName() && (I.p.name = b.getName()), b.getBackground() && (I.p.background = b.getBackground()), b.getLayers() && (I.p.layers = b.getLayers()), b.getEnvmap() && (I.p.envmap = b.getEnvmap()), I.p.autoAdjustIndex = b.isAutoAdjustIndex(), I.p.hierarchicalRendering = b.isHierarchicalRendering();
                for (var w in E) {
                    var l = b.a(w);
                    l !== p && J[vp](w, l, I.a)
                }
                return nm(I.a) && delete I.a, J._hierarchical ? y.each(J.serializeData, this) : b.each(function (t) {
                    J.serializeData(t)
                }), b.fireSerializeEvent({
                    type: "serialize",
                    json: I
                }), b.getPostProcessingData() && (I.p.postProcessingData = b.getPostProcessingData()), I
            },
            isSerializable: function () {
                return !0
            },
            getProperties: function (F) {
                return F.getSerializableProperties()
            },
            getStyles: function (d) {
                return d.getSerializableStyles()
            },
            getAttrs: function (K) {
                return K.getSerializableAttrs()
            },
            serializeData: function (G) {
                var m = this;
                if (m.isSerializable(G) && !G._refGraph) {
                    var z, l, Z, U, b = Po(G.getClassName()) || G.getClass(),
                        _ = new b,
                        u = {
                            c: G.getClassName(),
                            i: G.getId(),
                            p: {},
                            s: {},
                            a: {}
                        };
                    m.json.d.push(u), z = m.getProperties(G);
                    for (l in z)
                        if (/^_/.test(l)) {
                            if (Z = G[l], ("_width" === l || "_height" === l) && Z === p) {
                                var W;
                                ((G.s("layout.h") || G.s("layout.v")) && G.getHost() || G instanceof k.Node && (W = G.getParent()) && W instanceof k.Block || G.s("fullscreen")) && (Z = G[l] = "_width" === l ? G.getWidth() : G.getHeight())
                            }
                            Z !== _[l] && m[vp](l.substr(1), Z, u.p)
                        } else U = gr(l), G[U] && (Z = G[U](), Z !== _[U]() && m[vp](l, Z, u.p));
                    z = m.getStyles(G);
                    for (l in z) Z = G.s(l), Z !== _.s(l) && m[vp](l, Z, u.s);
                    z = m.getAttrs(G);
                    for (l in z) Z = G.a(l), Z !== _.a(l) && m[vp](l, Z, u.a);
                    nm(u.p) && delete u.p, nm(u.s) && delete u.s, nm(u.a) && delete u.a
                }
                m._hierarchical && G.getChildren().each(m.serializeData, m)
            },
            serializeValue: function (V, F, D) {
                Er(F) ? F = {
                    __a: F._as
                } : F instanceof rr && (F = {
                        __i: F.getId()
                    }), D[V] = F
            },
            deserialize: function (b, g, V) {
                var B = this;
                return Qc(b) && /.json$/.test(b) ? (f.xhrLoad(b, function (s) {
                    B.deserializeImpl(s, g, V)
                }), void 0) : B.deserializeImpl(b, g, V)
            },
            deserializeImpl: function (X, N, x) {
                var n = this,
                    t = n.dm;
                x = rl(x) ? {
                    setId: x
                } : Yr(x) ? {
                    finishFunc: x
                } : x || {}, X = n.json = Qc(X) ? f.parse(X) : X, X.a && X.a.onPreDeserialize && !x.disableOnPreDeserialize && X.a.onPreDeserialize(X, t, x.view), t.beginTransaction(), vk++, n._82I = {};
                var $ = new vf,
                    E = new vf,
                    U = 0,
                    M = X.d.length;
                if (x.justDatas || (Yr(X.init) && X.init(t), t.setInit(X.init)), !x.justDatas) {
                    for (var G in X.a) t.a(G, n[Gn](X.a[G]));
                    for (var b in X.p) t[io(b)](X.p[b])
                }
                for (; M > U; U++) {
                    var l = X.d[U],
                        i = Po(l.c),
                        F = new i,
                        P = l.i;
                    x.setId && P != h && (F._id = P), n._82I[P] = F, $.add(F), E.add(l)
                }
                for (U = 0; M > U; U++) n.deserializeData($.get(U), E.get(U));
                return $.each(function (O) {
                    N && !O.getParent() && O.setParent(N), t.add(O)
                }), t.fireSerializeEvent({
                    type: "deserialize",
                    json: X
                }), vk--, t.endTransaction(), X.a && X.a.onPostDeserialize && !x.disableOnPostDeserialize && X.a.onPostDeserialize(X, t, x.view, $), x.finishFunc && x.finishFunc(X, t, x.view, $), $
            },
            deserializeData: function (o, M) {
                for (var g in M.p) o[io(g)](this[Gn](M.p[g]));
                for (g in M.s) o.s(g, this[Gn](M.s[g]));
                for (g in M.a) o.a(g, this[Gn](M.a[g]))
            },
            deserializeValue: function (q) {
                if (cl(q)) {
                    var z = q.__i;
                    if (z != h) return this._82I[z];
                    if (z = q.__a, nj(z)) return new vf(z)
                }
                return q
            }
        }), xr(Nm, {
            serialize: function (B, W) {
                return new Kc(this, W).serialize(B)
            },
            toJSON: function (x) {
                return new Kc(this, x).toJSON()
            },
            deserialize: function (D, $, f) {
                return new Kc(this).deserialize(D, $, f)
            }
        });
        var zr = k.OverlappingBox = function (w) {
            this.gv = w, this.boxes = {}
        };
        If("OverlappingBox", x, {
            clear: function () {
                var y, L, V = this.boxes;
                for (y in V) L = V[y], L.length = 0
            },
            isOverlapping: function (T, p) {
                var k, O, $ = this,
                    Q = $.boxes,
                    _ = Q[T];
                _ ? (k = _.rects, O = _.length) : _ = Q[T] = {
                    rects: k = [],
                    length: O = 0
                };
                var Z, B, p;
                for (Z = 0; O > Z; Z++)
                    if (B = k[Z], B.x < p.x + p.w && B.x + B.w > p.x && B.y < p.y + p.h && B.h + B.y > p.y) return !0;
                return k.length <= O ? (k.push(p), _.length++) : k[_.length++] = p, !1
            }
        }), xr(f, {
            fetch: function (x, q) {
                var u = "GET",
                    A = !1,
                    U = null,
                    j = "";
                q && (u = q.method || "GET", A = q.sync, j = q.url, U = q.data || null), x.open(u, j, !A), q.responseType ? x.responseType = q.responseType : q.overrideMimeType && x.overrideMimeType && x.overrideMimeType(q.overrideMimeType), x.send(U)
            },
            convertImageSrc: function (R, Q) {
                Q && "function" == typeof Q || (Q = function () {}), Q(R)
            }
        });
        var ne = k.Request = function () {
            this._xhr = new XMLHttpRequest, this._onloadFunc = function () {}, this._errorFunc = function () {}
        };
        If("Request", x, {
            _responseType: null,
            _overrideMimeType: "text/plain",
            send: function (R) {
                var z = this._xhr,
                    L = this.onload,
                    x = this.onerror;
                this.getResponseType() ? R.responseType = this.getResponseType() : this.getOverrideMimeType() && (R.overrideMimeType = this.getOverrideMimeType()), z.onload = L, z.onerror = x, f.fetch(z, R)
            },
            onload: function () {},
            onerror: function () {},
            getResponseType: function () {
                return this._responseType
            },
            setResponseType: function (u) {
                this._responseType = u
            },
            getOverrideMimeType: function () {
                return this._overrideMimeType
            },
            setOverrideMimeType: function (q) {
                this._overrideMimeType = q
            },
            getResponseText: function () {
                var g = this._xhr;
                return g.response || g.responseText
            }
        }), zj.GraphView = function (B) {
            var e = this;
            e._24I = {}, e._34I = new vf, e._25I = {}, e._56I = {}, e._view = xj(1, e), e._canvas = Np(e._view), e.dm(B ? B : new Nm), this._coreInteractor = new ao(this), e.setEditable(!1), e.setScrollBarVisible(f.graphViewScrollBarVisible)
        }, kp("GraphView", x, {
            ms_v: 1,
            ms_gv: 1,
            ms_bnb: 1,
            ms_tip: 1,
            ms_dm: 1,
            ms_lp: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            _52o: 1,
            _51o: 1,
            ms_ac: [Fb, Vn, tj, hj, "resettable", "editInteractor", Dj, "pannable", "rectSelectable", "autoScrollZone", Wq, "movableFunc", "editableFunc", "pointEditableFunc", "rectEditableFunc", "rotationEditableFunc", "anchorEditableFunc", "rectSelectBackground", "rectSelectBorderColor", "editPointSize", "editPointBorderColor", "editPointBackground", "hoverDelay"],
            _resettable: f.graphViewResettable,
            _pannable: f.graphViewPannable,
            _rectSelectable: f.graphViewRectSelectable,
            _autoScrollZone: f.graphViewAutoScrollZone,
            _rectSelectBackground: f.graphViewRectSelectBackground,
            _rectSelectBorderColor: f.graphViewRectSelectBorderColor,
            _editPointSize: f.graphViewEditPointSize,
            _editPointBorderColor: f.graphViewEditPointBorderColor,
            _editPointBackground: f.graphViewEditPointBackground,
            _scrollBarColor: fe,
            _scrollBarSize: td,
            _autoHideScrollBar: Gr,
            _autoMakeVisible: Ei,
            _currentActionType: null,
            getCoreInteractor: function () {
                return this._coreInteractor
            },
            getLayers: function () {
                return this._dataModel.getLayers()
            },
            setLayers: function (n) {
                this._dataModel.setLayers(n)
            },
            setEditable: function (F) {
                var Q = this,
                    W = Q.__interactorMap__;
                if (!W) {
                    var w = zj.XEditInteractor;
                    W = Q.__interactorMap__ = {
                        scrollBar: new yp(Q),
                        select: new Rk(Q),
                        edit: w ? new w(Q) : new Yp(Q),
                        move: new qp(Q),
                        "default": new Kk(Q),
                        touch: new _k(Q, {
                            editable: !1
                        })
                    }
                }
                F ? (Q._uieditable = !0, Q.setInteractors([W.scrollBar, W.select, W.edit, W.move, W.default, W.touch])) : (Q._uieditable = !1, Q.setInteractors([W.scrollBar, W.select, W.move, W.default, W.touch]))
            },
            getCanvas: function () {
                return this._canvas
            },
            _33I: function (C) {
                var Y = C.getUIClass();
                return Y ? new Y(this, C) : h
            },
            getDataUI: function (G) {
                var f = this,
                    Y = f._25I[G._id];
                return Y === p && (Y = f._33I(G), f._25I[G._id] = Y), Y
            },
            getNodeRect: function (o) {
                return f.getNodeRect(this, o)
            },
            getFullscreenDatas: function () {
                return this._dataModel.getFullscreenDatas()
            },
            getEdgeInfo: function (O) {
                var L = this.getDataUI(O);
                return L ? (L._79o(), L._78o) : null
            },
            getEdgeSourcePosition: function (w) {
                var N = this,
                    B = N.getDataUI(w),
                    G = B.s,
                    e = B._data._40I;
                return rg(N, e, G("edge.source.position"), G("edge.source.offset.x"), G("edge.source.offset.y"), G("edge.source.anchor.x"), G("edge.source.anchor.y"))
            },
            getEdgeTargetPosition: function (c) {
                var f = this,
                    Q = f.getDataUI(c),
                    U = Q.s,
                    j = Q._data._41I;
                return rg(f, j, U("edge.target.position"), U("edge.target.offset.x"), U("edge.target.offset.y"), U("edge.target.anchor.x"), U("edge.target.anchor.y"))
            },
            invalidateAll: function (Y) {
                var v = this;
                if (Y) {
                    for (var b in v._25I) {
                        var G = v._25I[b];
                        G && G.dispose()
                    }
                    v._25I = {}, v._56I = {}, v._24I = {}, v._34I.clear(), v.redraw()
                } else v.dm().each(function (c) {
                    v.invalidateData(c)
                })
            },
            invalidateSelection: function () {
                var e = this;
                e.sm().each(function (V) {
                    e.invalidateData(V)
                })
            },
            invalidateData: function (u) {
                var Z = this;
                Z._24I[u._id] = u, Z._21Q(u), Z.iv()
            },
            _21Q: function (M) {
                var W = this,
                    e = W._24I;
                if (kn(M) && yc[M.s(Oo)]) {
                    var H = M.getSourceAgent();
                    H && H.getAgentEdges().each(function (L) {
                        e[L._id] = L
                    }), H = M.getTargetAgent(), H && H.getAgentEdges().each(function (s) {
                        e[s._id] = s
                    }), W.iv()
                }
            },
            redraw: function (j) {
                var $ = this;
                $._32I || (j ? $._34I.add(j) : ($._32I = 1, $._34I.clear()), $.iv())
            },
            each: function (n, R) {
                var $, H, s, E = 0,
                    h = this.getLayers(),
                    y = this._dataModel,
                    x = y._datas._as,
                    M = x.length;
                if (h) {
                    for (var S = h.length; S > E; E++)
                        if (s = h[E], cl(s) && (s = s.name), y.isHierarchicalRendering()) {
                            var t = function (g) {
                                return g._layer === s ? R ? n.call(R, g) : n(g) : void 0
                            };
                            if (this._dataModel.eachByHierarchical(t) === !1) return
                        } else
                            for (var Z = 0; M > Z; Z++)
                                if ($ = x[Z], $._layer === s && (H = R ? n.call(R, $) : n($), H === !1)) return
                } else if (y.isHierarchicalRendering()) this._dataModel.eachByHierarchical(n, null, R);
                else
                    for (; M > E; E++)
                        if ($ = x[E], H = R ? n.call(R, $) : n($), H === !1) return
            },
            reverseEach: function (A, m) {
                var I, Y, e, P, b = this._dataModel,
                    S = b._layers,
                    s = b._datas._as,
                    Q = s.length;
                if (S) {
                    for (I = S.length - 1; I >= 0; I--)
                        if (P = S[I], cl(P) && (P = P.name), b.isHierarchicalRendering()) {
                            var z = function (o) {
                                return o._layer === P ? m ? A.call(m, o) : A(o) : void 0
                            };
                            if (b.reverseEachByHierarchical(z) === !1) return
                        } else
                            for (var i = Q - 1; i >= 0; i--)
                                if (Y = s[i], Y._layer === P && (e = m ? A.call(m, Y) : A(Y), e === !1)) return
                } else if (b.isHierarchicalRendering()) b.reverseEachByHierarchical(A, null, m);
                else
                    for (I = Q - 1; I >= 0; I--)
                        if (Y = s[I], e = m ? A.call(m, Y) : A(Y), e === !1) return
            },
            getViewRect: function () {
                return this._29I
            },
            getContentRect: function () {
                var y = this,
                    s = y._84I;
                if (!s) {
                    var l = this.dm().a("width"),
                        e = this.dm().a("height");
                    l > 0 && e > 0 ? y._84I = {
                        x: 0,
                        y: 0,
                        width: l,
                        height: e
                    } : (y.each(function (e) {
                        y.isVisible(e) && (s = Rq(s, y.getDataUIBounds(e)))
                    }), y._84I = s ? s : sf)
                }
                return y._84I
            },
            getScrollRect: function () {
                return Rq(this.getContentRect(), this._29I)
            },
            makeCenter: function (u, i, q) {
                var s = this;
                if (!s.getWidth() || !s.getHeight()) return q || Zl(s.centerData, s, [u, i, !0], 500), void 0;
                s.makeVisible(u), s.validate();
                var O = s.getDataUIBounds(u);
                if (O) {
                    var $ = s.getWidth(),
                        Y = s.getHeight(),
                        l = O.x + O.width / 2,
                        p = O.y + O.height / 2,
                        t = -l * s._zoom + $ / 2,
                        Q = -p * s._zoom + Y / 2;
                    s.setTranslate(t, Q, i)
                }
            },
            fitData: function (n, I, M, q, $) {
                var s = this;
                if (!s.getWidth() || !s.getHeight()) return $ || Zl(s.fitData, s, [n, I, M, q, !0], 500), void 0;
                var w = function () {
                    s.makeVisible(n), s.validate();
                    var j = s.getDataUIBounds(n);
                    j && (j = tc(j), $d(j, M == h ? 20 : M), s.fitRect(j, I, q))
                };
                I ? f.callWhenLoaded(w) : w()
            },
            fitContent: function (v, M, l, d) {
                var B = this;
                if (!B.getWidth() || !B.getHeight()) return d || Zl(B.fitContent, B, [v, M, l, !0], 500), void 0;
                var K = function () {
                    B.validate();
                    var x = tc(B.getContentRect());
                    $d(x, M == h ? 20 : M), B.fitRect(x, v, l)
                };
                v ? f.callWhenLoaded(K) : K()
            },
            fitRect: function (C, O, z) {
                var I = this,
                    b = I.getWidth(),
                    w = I.getHeight(),
                    x = C.x + C.width / 2,
                    q = C.y + C.height / 2,
                    J = j(b / C.width, w / C.height),
                    i = I._zoom,
                    $ = -x * i + b / 2,
                    d = -q * i + w / 2;
                0 === J || isNaN(J) || (z && (J = j(1, J)), O ? (I._65I && (delete I._65I.finishFunc, I._65I.stop(!0)), I._14o && I._14o.stop(!0), I.setTranslate($, d, {
                    finishFunc: function () {
                        I.setZoom(J, O)
                    }
                })) : (I.setTranslate($, d), I.setZoom(J)))
            },
            toCanvas: function (p, q) {
                q = q || this._zoom, this.validateImpl();
                var n = this,
                    x = n.getContentRect();
                x.width || (x.width = 10), x.height || (x.height = 10);
                var $ = Np(),
                    J = x.x * q,
                    W = x.y * q,
                    M = x.width * q,
                    X = x.height * q;
                mc($, M, X, 1);
                var E = Hf($);
                return p = p || this._dataModel.getBackground(), p && to(E, 0, 0, M, X, p), Aj(E, -J, -W), E.scale(q, q), n._42(E), E.restore(), $
            },
            toDataURL: function (b, X, o) {
                return this.toCanvas(b, o).toDataURL(X || "image/png", 1)
            },
            getClipBounds: function () {
                return this._74O
            },
            _42: function (F, O) {
                var $ = this,
                    v = this.__htmlOrderList,
                    z = [];
                if ($._93db(F, O), $.each(function (S) {
                        var T = $.getDataUI(S);
                        if (T) {
                            var B = $._56I[S._id],
                                u = T._htmlView;
                            if (B) {
                                var x = T._79o();
                                if (u = T._htmlView, k.HtmlNode && S instanceof k.HtmlNode) T._42(F);
                                else {
                                    var L = $.getViewRect(),
                                        J = u && u.layoutHTML;
                                    !O || Hk(O, x) ? (J && (u.layoutHTML(), T.__outerLayout && delete T.__outerLayout), T._42(F)) : Hk(L, x) || !J || T.__outerLayout || (u.layoutHTML(), T.__outerLayout = !0)
                                }
                            }
                            u && (z.push(u), u.getView && (u = u.getView()), u.style.display = B ? "block" : Tr)
                        }
                    }), v && z.length > 0) {
                    var G = !1;
                    if (v.length !== z.length) G = !0;
                    else
                        for (var Y = 0; Y < z.length; Y++)
                            if (z[Y] !== v[Y]) {
                                G = !0;
                                break
                            }
                    G && (z.forEach(function (C) {
                        $.appendHTML(C, !0)
                    }), this.__htmlOrderList = z)
                } else this.__htmlOrderList = z;
                $._92db(F, O)
            },
            validateImpl: function () {
                this.tryUpdateRootData();
                var i, c, k, p, Q, C = this,
                    H = C.tx(),
                    n = C.ty(),
                    x = C._zoom,
                    w = C._canvas,
                    N = this.getWidth(),
                    Z = this.getHeight(),
                    s = C._29I,
                    O = {
                        x: -H / x,
                        y: -n / x,
                        width: N / x,
                        height: Z / x
                    },
                    $ = {},
                    t = C._34I,
                    V = C._24I,
                    E = C._32I,
                    o = C._23I;
                C._24I = {}, (N !== w.clientWidth || Z !== w.clientHeight) && (mc(w, N, Z), E = 1), E || $f(O, s) || (E = 1), C._29I = O, C.each(function (x) {
                    c = x._id;
                    var a = $[c] = C.isVisible(x);
                    a !== C._56I[c] && (V[c] = x, k = C.getDataUI(V[c]), k && k._84o(a), C._84o(x, a))
                }, C);
                for (c in V) k = C.getDataUI(V[c]), k && (!E && C._56I[c] && (Q = k._79o(), Q && t.add(Q)), k.invalidate()), C._83I = 1;
                if (C._56I = $, !E)
                    for (c in V) $[c] && (k = C.getDataUI(V[c]), k && (Q = k._79o(), Q && t.add(Q)));
                if (E ? p = O : (t.each(function (A) {
                        Hk(O, A) && (p = Rq(p, A))
                    }), p && ($d(p, W(1, 1 / x)), p.x = e(p.x * x) / x, p.y = e(p.y * x) / x, p.width = _(p.width * x) / x, p.height = _(p.height * x) / x, p = oi(O, p))), C._74O = p, p) {
                    i = Hf(w);
                    var h = p.x,
                        R = p.y,
                        a = p.width,
                        g = p.height;
                    h = Math.floor((h * x + H) * Tp), R = Math.floor((R * x + n) * Tp), a = Math.ceil(a * x * Tp) + 1, g = Math.ceil(g * x * Tp) + 1, i.beginPath(), i.rect(h, R, a, g), i.clip(), i.clearRect(h, R, a, g), Tm(i, H, n, x), C._42(i, p), i.restore(), delete C._74O
                }
                if (t.clear(), delete C._32I, o && N > 0 && Z > 0) {
                    var k = C.getDataUI(o);
                    if (k) {
                        var Q = k._79o(),
                            J = C._29I,
                            m = J.x,
                            A = J.y,
                            l = J.width,
                            f = J.height,
                            x = C._zoom;
                        Q && !Hk(Q, J) && (Q.x + Q.width < m && C.tx(-Q.x * x), Q.x > m + l && C.tx(-(Q.x + Q.width - l) * x), Q.y + Q.height < A && C.ty(-Q.y * x), Q.y > A + f && C.ty(-(Q.y + Q.height - f) * x))
                    }
                    delete C._23I
                }
                C._83I && (delete C._83I, delete C._84I), C._98O(), C.countFrame(), nm(C._24I) || Zl(C.iv, C)
            },
            tryUpdateRootData: function () {
                var r, N = this.getFullscreenDatas();
                for (var w in N) r = N[w], this.scaleRootData(r)
            },
            scaleRootData: function (d) {
                var P = d.s("fullscreen");
                if ("uniform" === P || "fill" === P) {
                    d.setRotation(0);
                    var J, f = d.s("fullscreen.gap") || 0,
                        L = this.getWidth() - 2 * f,
                        g = this.getHeight() - 2 * f,
                        s = d.getAnchor(),
                        F = d.getScaledSize(),
                        M = F.width,
                        b = F.height,
                        X = d.s("fullscreen.lock");
                    if (X) return "uniform" === P ? L / g > M / b ? (J = g / b, M = b * L / g) : (J = L / M, b = M * g / L) : "v" === X ? (J = g / b, M = L / J, d.setWidth(M)) : (J = L / M, b = g / J, d.setHeight(b)), this.setZoom(J), this.tx(f - (d.getX() - s.x * M) * J), this.ty(f - (d.getY() - s.y * b) * J), void 0;
                    var C = this.tx(),
                        m = this.ty();
                    J = this._zoom;
                    var j = {
                        x: (-C + f) / J,
                        y: (-m + f) / J,
                        width: L / J,
                        height: g / J
                    };
                    if ("uniform" === P) {
                        var k = M / b,
                            q = Math.min(j.width, j.height * k),
                            H = q / k;
                        j.x += .5 * (j.width - q), j.y += .5 * (j.height - H), j.width = q, j.height = H
                    }
                    d.setSize(j.width / d.getScaleX(), j.height / d.getScaleY()), d.setPosition(j.x + s.x * j.width, j.y + s.y * j.height)
                }
            },
            isScrollBarVisible: function () {
                return !!this._79O
            },
            setScrollBarVisible: function (N) {
                var Q = this;
                N !== Q.isScrollBarVisible() && (N ? (or(Q._view, Q._79O = rq()), or(Q._79O, Q._27I = rq()), or(Q._79O, Q._28I = rq())) : (Kh(Q._79O), delete Q._79O, delete Q._27I, delete Q._28I), Q.fp("scrollBarVisible", !N, N))
            },
            getDebugTip: function () {
                return ""
            },
            showScrollBar: function () {
                var f = this;
                f._79O && (f._85I || (q(function () {
                    f._86I()
                }, cb), f.iv()), f._85I = new Date)
            },
            _86I: function () {
                var B = this;
                if (B._85I) {
                    var L = new Date,
                        O = L.getTime();
                    O - B._85I.getTime() >= cb ? (delete B._85I, B.iv()) : q(function () {
                        B._86I()
                    }, cb)
                }
            },
            getVScrollBar: function () {
                return this._27I
            },
            getHScrollBar: function () {
                return this._28I
            },
            _98O: function () {
                var J = this,
                    B = this._27I,
                    p = this._28I;
                if (J._79O) {
                    if (J._autoHideScrollBar && !J._85I) return B.style.visibility = _c, p.style.visibility = _c, void 0;
                    var M = J.getScrollBarColor(),
                        C = J._zoom,
                        t = J.getScrollBarSize(),
                        H = J.getViewRect(),
                        v = J.getScrollRect(),
                        l = H.height * C,
                        X = v.height * C,
                        s = H.width * C - t - 2,
                        m = l * ((H.y - v.y) * C / X),
                        W = l * (l / X),
                        b = B.style;
                    X - .5 > l ? (si > W && (m = m + W / 2 - si / 2, 0 > m && (m = 0), m + si > l && (m = l - si), W = si), Qh(B, s, m, t, W), b.visibility = Fm, b.background = M, b.borderRadius = t / 2 + Do) : b.visibility = _c;
                    var D = H.width * C,
                        S = v.width * C,
                        m = H.height * C - t - 2,
                        s = D * ((H.x - v.x) * C / S),
                        i = D * (D / S),
                        b = p.style;
                    S - .5 > D ? (si > i && (s = s + i / 2 - si / 2, 0 > s && (s = 0), s + si > D && (s = D - si), i = si), Qh(p, s, m, i, t), b.visibility = Fm, b.background = M, b.borderRadius = t / 2 + Do) : b.visibility = _c
                }
            },
            setDataModel: function (U) {
                var y = this,
                    h = y._dataModel,
                    k = y._selectionModel;
                h !== U && (h && (h.ump(y.handleDataModelPropertyChange, y), h.umm(y.handleDataModelChange, y), h.umd(y.handleDataPropertyChange, y), h.removeIndexChangeListener(y._75O, y), h.removeHierarchyChangeListener(y.handleHierarchyChange, y), k || h.sm().ums(y.handleSelectionChange, y)), y._dataModel = U, U.mp(y.handleDataModelPropertyChange, y), U.mm(y.handleDataModelChange, y), U.md(y.handleDataPropertyChange, y), U.addIndexChangeListener(y._75O, y), U.addHierarchyChangeListener(y.handleHierarchyChange, y), k ? k._21I(U) : U.sm().ms(y.handleSelectionChange, y), y.invalidateAll(!0), y.fp(Oq, h, U), y._canvas.style.background = U.getBackground() || "")
            },
            getLayersInfo: function () {
                if (this._layersInfo === p) {
                    var $ = this.getLayers();
                    $ ? (this._layersInfo = {}, $.forEach(function (L) {
                        var C = cl(L) ? L.name : L;
                        this._layersInfo[C] = L
                    }, this)) : this._layersInfo = null
                }
                return this._layersInfo
            },
            calculateAttachPoint: function () {
                var w = new Pi,
                    d = new Pi,
                    B = new Pi;
                return function (A, y) {
                    var K = this.getAttachPoints(A);
                    if (!K || !K.length) return null;
                    B.set(y.x, y.y);
                    for (var c, U, G, I, T = 1 / 0, f = 0, Z = K.length; Z > f; f++) G = K[f], d.x = G.x, d.y = G.y, w.x = G.offsetX || 0, w.y = G.offsetY || 0, I = rg(this, A, 0, w.x, w.y, d.x, d.y), U = B.distanceToSquared(I), T > U && (c = f, T = U);
                    T = Math.sqrt(T);
                    var L = this.getAttachStyle(A);
                    if ("close" === L) {
                        var o = A.s("attach.close.threshold") / this._zoom;
                        if (T > o) return null
                    }
                    return {
                        index: c,
                        distance: T,
                        info: K[c]
                    }
                }
            }(),
            getAttachPoints: function (I) {
                var M = I.s("attach.points");
                if (M) return M;
                var H = Qn(I._image);
                return H ? ze(H.attachPoints, I, this) || null : void 0
            },
            getAttachStyle: function ($) {
                var z = $.s("attach.style");
                if (z) return z;
                var K = Qn($._image);
                return K ? ze(K.attachStyle, $, this) || "close" : void 0
            },
            updateLayers: function () {
                this._layersInfo = p, this.invalidateSelection(), this.redraw()
            },
            handleDataModelPropertyChange: function (l) {
                if ("background" === l.property) {
                    var W = this._canvas.style.background,
                        h = l.newValue || "";
                    this._canvas.style.background = h, this.fp("canvasBackground", W, h)
                } else "a:width" === l.property || "a:height" === l.property ? (this._83I = 1, this.redraw()) : "layers" === l.property ? this.updateLayers() : "hierarchicalRendering" === l.property && this.redraw()
            },
            handleDataPropertyChange: function (K) {
                this.dm().isHierarchicalRendering() && "parent" === K.property && K.data.hasChildren() && this.redraw(), this.invalidateData(K.data)
            },
            onPropertyChanged: function (d) {
                var z = this,
                    R = d.property;
                if (z.redraw(), "zoom" === R) {
                    var B = z.sm().getSelection();
                    B.size() && B.each(function (u) {
                        u.invalidate()
                    })
                }
                im[R] ? z.showScrollBar() : R === Dj && z.onCurrentSubGraphChanged(d)
            },
            onCurrentSubGraphChanged: function () {
                this.sm().cs(), this.reset()
            },
            handleDataModelChange: function (p) {
                var S = this,
                    x = p.kind,
                    K = p.data;
                if (S._83I = 1, "add" === x) S.invalidateData(K), kn(K) && K.getEdgeGroup() && K.getEdgeGroup().eachSiblingEdge(S.invalidateData, S);
                else if (x === sc) {
                    S._21Q(K);
                    var j = K._id,
                        o = S._25I[j];
                    if (o) {
                        if (S._56I[j]) {
                            var V = o._79o();
                            V && S.redraw(V)
                        }
                        o.dispose(), delete S._25I[j], delete S._24I[j], delete S._56I[j]
                    }
                    K === S._currentSubGraph && S.setCurrentSubGraph(h)
                } else x === cf && (S.invalidateAll(!0), S.setCurrentSubGraph(h))
            },
            _75O: function (I) {
                this.invalidateData(I.data)
            },
            handleHierarchyChange: function ($) {
                this.dm().isHierarchicalRendering() && $.data.hasChildren() && this.redraw(), this.invalidateData($.data)
            },
            adjustIndex: function (s) {
                var o = this;
                if (o.isVisible(s)) {
                    o.dm().beginTransaction();
                    for (var t = s; t._parent && o.isVisible(t._parent);) t = t._parent;
                    t && t !== s && o._dataModel.adjustIndex(t), o._dataModel.adjustIndex(s), o.dm().endTransaction()
                }
            },
            getImage: function (f) {
                return f.getImage ? f.getImage() : p
            },
            getSelectWidth: function (Q) {
                var S = Qn(this.getImage(Q));
                return S && ze(S.disableSelectedBorder, Q, this) ? 0 : Q.s("select.width")
            },
            getSelectColor: function (x) {
                return x.s("select.color")
            },
            isSelectable: function (C, E) {
                if (this.isSelected(C)) return !0;
                if (!E && C.getParent() instanceof tf && this.isSelectable(C.getParent(), !0) && C.getParent().isSyncSize()) return !1;
                var f = this.getLayersInfo();
                if (f) {
                    var I = f[C._layer];
                    if (I && I.selectable === !1) return !1
                }
                return C.s("2d.selectable") && this.sm().isSelectable(C)
            },
            isMovable: function (M) {
                var k = this;
                if (kn(M) && M.getStyle(Oo) !== gs) return !1;
                var A = this.getLayersInfo();
                if (A) {
                    var G = A[M._layer];
                    if (G && G.movable === !1) return !1
                }
                return M.s("2d.movable") ? k._movableFunc ? k._movableFunc(M) : !0 : !1
            },
            isEditable: function (X) {
                var Q = this;
                if (k._uiSerializing) return Q._uieditable;
                if (!Q._editInteractor || !Q.isSelected(X)) return !1;
                if (an(X)) {
                    var T = Q.getDataUI(X);
                    if (!T || T._88I) return !1
                }
                if (kn(X) && X.getStyle(Oo) !== gs) return !1;
                var F = this.getLayersInfo();
                if (F) {
                    var M = F[X._layer];
                    if (M && M.editable === !1) return !1
                }
                return X.s("2d.editable") ? Q._editableFunc ? Q._editableFunc(X) : !0 : !1
            },
            handleDelete: function () {
                this._editInteractor && (this._editInteractor.handleDelete ? this._editInteractor.handleDelete() : this.removeSelection())
            },
            isPointEditable: function (_) {
                return Cc(_) && 0 !== _.getRotation() ? !1 : this._pointEditableFunc ? this._pointEditableFunc(_) : !0
            },
            isRectEditable: function (B) {
                return this._rectEditableFunc ? this._rectEditableFunc(B) : !0
            },
            isAnchorEditable: function (u) {
                return this._anchorEditableFunc ? this._anchorEditableFunc(u) : !0
            },
            isRotationEditable: function (O) {
                return O.setRotation && O.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(O) : !0 : !1
            },
            getRotationPoint: function (t) {
                var o = t.getAnchor(),
                    _ = t.getScale(),
                    q = this._zoom,
                    n = li(t.getRotation(), 0, -t.getHeight() * _.y * o.y - (_.y < 0 ? -1 : 1) * (ah ? 32 : 16) / q),
                    g = t.p();
                return n.x += g.x, n.y += g.y, n
            },
            getLogicalPoint: function (u) {
                var E = this;
                return jm(u, E._canvas, E.tx(), E.ty(), E._zoom, E._zoom)
            },
            getScreenPoint: function (T, V) {
                var o, O = this;
                return "object" == typeof T ? T.x !== p ? (o = T.x, V = T.y) : (o = T[0], V = T[1]) : o = T, Sr(o, V, O._canvas, O.tx(), O.ty(), O._zoom, O._zoom)
            },
            getSelectedDataAt: function (Y) {
                var e = this;
                return this.getDataAt(Y, function (k) {
                    return e.isSelected(k)
                })
            },
            getDataInfoAt: function (K, B, E) {
                var x, O = this.lp(K),
                    C = this.getDataAt(O, B, E);
                if (C) {
                    var Q = this.getDataUI(C);
                    x = {
                        data: C,
                        ui: Q,
                        point: O
                    };
                    var _ = Q._38o;
                    if (_) {
                        var X = _.icons;
                        for (var R in X) {
                            var n = X[R],
                                p = _.rects[R];
                            if (p)
                                for (var a = ze(n.names, C, this), t = a ? a.length : 0, y = p.rotation, r = t - 1; r >= 0; r--) {
                                    var o = a[r],
                                        m = p[r];
                                    if (nr(m, O, y)) return x.part = "icons", x.name = R, x.icon = o, x.rect = m, x.index = r, x.rotation = y, x
                                }
                        }
                    }
                    if (this.isNoteVisible(C)) {
                        if (Q.note2Info && nr(Q.note2Info.clickRect, O, h, Q.note2Info.scale)) return x.part = "note2", x;
                        if (Q.noteInfo && nr(Q.noteInfo.clickRect, O, h, Q.noteInfo.scale)) return x.part = "note", x
                    }
                    if (this.isLabelVisible(C)) {
                        if (Q.label2Info && nr(Q.label2Info.rect, O, Q.label2Info.rotation, Q.label2Info.scale)) return x.part = "label2", x;
                        if (Q.labelInfo && nr(Q.labelInfo.rect, O, Q.labelInfo.rotation, Q.labelInfo.scale)) return x.part = "label", x
                    }
                    if (C.isInRect && C.isInRect(O)) return x.part = "body", x
                }
                return x
            },
            getDataAt: function (y, u, n) {
                y.target && (y = this.lp(y));
                var w, D = this._zoom;
                return this.reverseEach(function (q) {
                    return (u ? u(q) : this.isSelectable(q)) && this.rectIntersects(q, af(y.x, y.y, n, D)) ? (w = q, !1) : void 0
                }, this), w
            },
            getIconInfoAt: function (x, p) {
                var H = this;
                if (x.target && (x = H.lp(x)), p || (p = H.getDataAt(x)), p) {
                    var A = H.getDataUI(p);
                    if (A && A._38o) {
                        var C, X = A._38o,
                            w = new vf;
                        for (C in X.icons) w.add(C);
                        for (var a = w.size() - 1; a >= 0; a--) {
                            C = w.get(a);
                            for (var E = X.rects[C], S = E.rotation, K = E.length - 1; K >= 0; K--) {
                                var J = E[K],
                                    P = J.width,
                                    M = J.height,
                                    v = {
                                        x: x.x - J.x - P / 2,
                                        y: x.y - J.y - M / 2
                                    };
                                S != h && (v = li(-S, v.x, v.y));
                                var J = {
                                    x: -P / 2,
                                    y: -M / 2,
                                    width: P,
                                    height: M
                                };
                                if (nr(J, v)) return {
                                    key: C,
                                    index: K,
                                    name: X.icons[C].names[K],
                                    rect: E[K],
                                    point: x,
                                    rotation: S,
                                    relativeRect: J,
                                    relativePoint: v,
                                    data: p
                                }
                            }
                        }
                    }
                }
                return h
            },
            getDatasInRect: function (m, M, T) {
                T === p && (T = 1);
                var u = this,
                    I = new vf;
                return u.reverseEach(function (G) {
                    T && !u.isSelectable(G) || (M ? u.rectIntersects(G, m) : u.rectContains(G, m)) && I.add(G)
                }), I
            },
            moveSelection: function (s, G) {
                var I = this;
                I.dm().beginTransaction(), Tq(I.sm().toSelection(I.isMovable, I), s, G), I.dm().endTransaction()
            },
            moveDatas: function (B, Z, U) {
                var G = this;
                G.dm().beginTransaction(), B instanceof vf || (B = new vf(B)), Tq(B, Z, U), G.dm().endTransaction()
            },
            getDataUIBounds: function (C) {
                var i = this.getDataUI(C);
                return i ? i._79o() : h
            },
            drawData: function (h, Y, L) {
                var l = this.getDataUI(Y);
                if (l) {
                    var V = l._79o();
                    (!L || Hk(L, V)) && (l._42(h), Y instanceof k.Block && Y.eachChild(function (F) {
                        this.drawData(h, F, L)
                    }, this))
                }
            },
            getBoundsForGroup: function (p) {
                return p.s(ih) ? this.getDataUIBounds(p) : h
            },
            isPixelPerfect: function (M) {
                return M.s("pixelPerfect")
            },
            rectIntersects: function (J, D) {
                this.validate();
                var W = h;
                if (this._56I[J._id]) {
                    var e = this._25I[J._id];
                    if (e) {
                        var n = e._79o();
                        if (Ok(D, n)) W = !0;
                        else if ((D = oi(D, n)) && (e.rectIntersects && (W = e.rectIntersects(D)), W == h)) {
                            if (!this.isPixelPerfect(J)) return !0;
                            var b = D.x,
                                L = D.y,
                                l = D.width,
                                H = D.height,
                                B = this._zoom,
                                g = f.hitMaxArea,
                                q = l * H * B * B;
                            if (q > g) {
                                var E = Math.sqrt(g / q);
                                B *= E
                            }
                            l *= B, H *= B, 2 > l && (l = 2), 2 > H && (H = 2), b *= B, L *= B;
                            var N = Qj(l, H);
                            Aj(N, -b, -L), N.scale(B, B), this._drawForChecking = !0, this.drawData(N, J, D), this._drawForChecking = !1;
                            try {
                                for (var K = 0, $ = N.getImageData(0, 0, l, H).data; K < $.length; K += 4)
                                    if (0 !== $[K + 3]) {
                                        W = !0;
                                        break
                                    }
                                N.restore()
                            } catch (p) {
                                op = h, W = !1
                            }
                        }
                    }
                }
                return W ? !0 : !1
            },
            rectContains: function (f, B) {
                if (this._56I[f._id]) {
                    var M = this._25I[f._id];
                    if (M) return Ok(B, M._79o())
                }
                return !1
            },
            reset: function () {
                this.setZoom(1), this.setTranslate(0, 0)
            },
            handleKeyDown: function (i) {
                if (!f.isInput(i.target)) {
                    var Q = this,
                        b = Q._focusData,
                        P = b && Q._25I[b._id],
                        z = 0,
                        x = Q._dataModel._datas;
                    if (!(b && b._enabled && b._editable && P && P.onKeyDown && P.onKeyDown(i) === !0))
                        if (9 === i.keyCode && (b && (z = x.indexOf(b), Lg(i) ? -1 === --z && (z = 0) : ++z === x.size() && (z = 0)), Q._focusData = b = x.get(z), Q.sm().setSelection(b)), ed(i) ? Q.selectAll() : Bo(i) && Q.isResettable() && Q.reset(), Q.sm().isEmpty()) {
                            if (Q._editing) return;
                            var e = Q.tx(),
                                K = Q.ty(),
                                U = !1,
                                w = Lg() ? 100 : 10;
                            we(i) && (e -= w, U = !0), Ge(i) && (K -= w, U = !0), yf(i) && (e += w, U = !0), Qg(i) && (K += w, U = !0), U && Q.setTranslate(e, K)
                        } else {
                            Lp(i) && Q.handleDelete(i);
                            var $ = Lg() ? 10 : 1;
                            we(i) && (Q.moveSelection(-$, 0), Q.fi({
                                kind: "moveLeft"
                            })), Ge(i) && (Q.moveSelection(0, -$), Q.fi({
                                kind: "moveUp"
                            })), yf(i) && (Q.moveSelection($, 0), Q.fi({
                                kind: "moveRight"
                            })), Qg(i) && (Q.moveSelection(0, $), Q.fi({
                                kind: "moveDown"
                            }))
                        }
                }
            },
            handleScroll: function (j, y) {
                if (Bl(j), !this.getEditInteractor()) {
                    var m = this.getDataAt(j);
                    if (m) {
                        var C = Qn(this.getImage(m));
                        if (C && ze(C.scrollable, m, this)) return
                    }
                }
                var $ = this.lp(j);
                y > 0 ? this.scrollZoomIn($) : 0 > y && this.scrollZoomOut($)
            },
            handlePinch: function (j, p, O) {
                this._68I || (p > O ? this.pinchZoomIn(j) : this.pinchZoomOut(j))
            },
            checkDoubleClickOnNote: function (o, e) {
                var Q = this,
                    H = Q.lp(o),
                    r = Q.getDataUI(e),
                    p = r.note2Info;
                return p && e.s("note2.toggleable") && nr(p.clickRect, H) ? (e.s(xg, !e.s(xg)), Q.fi({
                    kind: "toggleNote2",
                    event: o,
                    data: e
                }), !0) : (p = r.noteInfo, p && e.s("note.toggleable") && nr(p.clickRect, H) ? (e.s(Li, !e.s(Li)), Q.fi({
                    kind: "toggleNote",
                    event: o,
                    data: e
                }), !0) : !1)
            },
            _84o: function () {},
            isNoteVisible: function () {
                return this._zoom > .15
            },
            isLabelVisible: function () {
                return this._zoom > .15
            },
            isEditVisible: function () {
                return this._zoom > .15
            },
            autoScroll: function (J, D) {
                var c = this,
                    w = c.getAutoScrollZone(),
                    L = w / c.getZoom(),
                    Q = w / 4,
                    r = c._29I,
                    b = c.lp(J),
                    R = {
                        x: c.tx(),
                        y: c.ty()
                    };
                return b && w > 0 && r && (b.x - r.x < L ? c.translate(Q, 0) : r.x + r.width - b.x < L && c.translate(-Q, 0), b.y - r.y < L ? c.translate(0, Q) : r.y + r.height - b.y < L && c.translate(0, -Q)), R.x = c.tx() - R.x, R.y = c.ty() - R.y, D && (D.x += R.x, D.y += R.y), R
            },
            getMoveMode: function (B, i) {
                var b = i.s("2d.move.mode");
                return b ? b : Ae["88"] ? "x" : Ae["89"] ? "y" : "xy"
            },
            getSerializableProperties: function () {
                return {
                    scrollBarColor: 1,
                    scrollBarSize: 1,
                    autoMakeVisible: 1,
                    autoHideScrollBar: 1,
                    editable: 1,
                    resettable: 1,
                    pannable: 1,
                    rectSelectable: 1,
                    autoScrollZone: 1,
                    visibleFunc: 1,
                    movableFunc: 1,
                    editableFunc: 1,
                    pointEditableFunc: 1,
                    rectEditableFunc: 1,
                    anchorEditableFunc: 1,
                    rotationEditableFunc: 1,
                    rectSelectBackground: 1,
                    rectSelectBorderColor: 1,
                    editPointSize: 1,
                    editPointBorderColor: 1,
                    editPointBackground: 1,
                    hoverDelay: 1,
                    dataModel: 1,
                    selectionModel: 1,
                    currentSubGraph: 1,
                    zoom: 1,
                    translateX: 1,
                    translateY: 1
                }
            },
            serializeProperty: function (t, q, h) {
                var N = this;
                return "currentSubGraph" === q ? {
                    __i: t.getId()
                } : h.serializeProperty(t, q, N)
            },
            deserializeProperty: function (w, h, r) {
                var m = this;
                if ("currentSubGraph" === h) {
                    var n = m.dm(),
                        b = n.__idMap;
                    return b[w.__i]
                }
                return r.deserializeProperty(w, h, m)
            },
            setDefaultCursor: function (t, f) {
                this._defaultCursor = t, f !== !1 && this.setCursor(t)
            },
            setCursor: function (n) {
                "default" === n && (n = this._defaultCursor || n);
                var U = this.getView().style;
                U.cursor = n, U.cursor = "-webkit-" + n, U.cursor = "-moz-" + n
            },
            getCurrentConnectActionType: function () {
                return this._currentActionType
            },
            setCurrentConnectActionType: function (l) {
                return l === h || f.getConnectAction(null, l) ? (this._currentActionType = l, this.redraw(), !0) : !1
            },
            isConnectActionVisible: function (l) {
                var s = f.getConnectAction(this);
                if (!s) return !1;
                var O = s.visible;
                return Yr(O) && (O = O(this, l)), O
            },
            isInteractive: function (u) {
                var Y = Qn(this.getImage(u));
                return Y && ze(Y.interactive, u, this) ? !0 : u.s("interactive")
            },
            appendHTML: function (G, T) {
                var Y = this.getView();
                if (!(T || G && G.parentNode !== Y)) return !1;
                var U = G.getView && G.getView();
                return !T && U && U.parentNode === Y ? !1 : G.isSelfViewEvent ? (G.addToDOM(Y), !0) : (G.getView && (G = G.getView()), this.isScrollBarVisible() ? Y.insertBefore(G, this.getView().lastChild) : or(Y, G), !0)
            },
            _layoutHTMLImpl: function (F, A, f) {
                if (arguments.length > 1) {
                    var T, t = this,
                        d = t._zoom;
                    if (A.getView && (T = A, A = A.getView()), A.style.position = "absolute", f) {
                        var Q = F.getRect();
                        Qh(T || A, t.tx() + Q.x * d, t.ty() + Q.y * d, Q.width * d, Q.height * d)
                    } else {
                        var _ = new yg,
                            Q = F.getAnchorRect(),
                            b = F.getPosition(),
                            W = F.getScale(),
                            V = A.style;
                        Qh(T || A, Q), _.appendTranslate(t.tx(), t.ty()), _.appendScale(d, d), _.append(new yg(F.getRotation(), b.x, b.y, W.x, W.y)), qg(V, "transform", "matrix(" + _.a.toFixed(5) + ", " + _.b.toFixed(5) + ", " + _.c.toFixed(5) + ",\n    " + _.d.toFixed(5) + ", " + _.tx.toFixed(5) + ", " + _.ty.toFixed(5) + ")"), qg(V, "transformOrigin", (-Q.x).toFixed(5) + "px " + (-Q.y).toFixed(5) + "px"), A.maxtrixAppend = _.invert().translate(-Q.x, -Q.y)
                    }
                } else this._layoutHTML && this._layoutHTML()
            }
        }), x.defineProperties(zj.GraphView.prototype, {
            layoutHTML: {
                get: function () {
                    return this._layoutHTMLImplBind || (this._layoutHTMLImplBind = this._layoutHTMLImpl.bind(this)), this._layoutHTMLImplBind
                },
                set: function (E) {
                    this._layoutHTML = E
                }
            }
        });
        var bp = function (M, R) {
            var r = this;
            r.gv = M, r.s = function (y) {
                return R.getStyle(y)
            }, r._data = R, r._87I = new vf
        };
        zc(bp, x, {
            _6I: h,
            ms_icons: 1,
            _84o: function () {},
            dispose: function () {},
            isShadowed: function () {
                return this.s("shadow") || this.gv.isSelected(this._data) && "shadow" === this.s("select.type")
            },
            getSelectWidth: function () {
                var P = this,
                    B = P.gv.isSelected(P._data);
                return !B || P.isShadowed() ? 0 : P.gv.getSelectWidth(P._data)
            },
            getSelectColor: function () {
                return this.gv.getSelectColor(this._data)
            },
            getBodyColor: function (D) {
                var K = this._data,
                    V = this.gv.getBodyColor(K);
                return V ? V : D ? K.getStyle(D) : h
            },
            _2Q: function (D) {
                return this.s(D)
            },
            _1Q: function (e, w, s, O) {
                var y = this.s,
                    v = y("2d.gray"),
                    G = y(w + ".dash.color");
                if (v && (G = f.toGrayColor(G)), e.strokeStyle = G, e.lineWidth = s, e.stroke(), y(w + ".dash.3d")) {
                    var q = y(w + ".dash.3d.color");
                    Vm(e, G, v ? f.toGrayColor(q) : q, s, this.gv._zoom, y(w + ".dash.3d.accuracy"))
                }
                Bg(e, O)
            },
            invalidate: function () {
                this._6I = h
            },
            _79o: function () {
                var y = this;
                if (!y._6I) {
                    var F = y._data,
                        g = y.gv;
                    y.labelInfo = y.label2Info = y.noteInfo = y.note2Info = y._38o = h, y._87I.clear(), y.interactiveInfo = g.isInteractive(F) ? {} : h, y._3O(), y._55O = g.isEditable(F) ? {
                        _42O: g.isRectEditable(F),
                        _43O: g.isPointEditable(F),
                        _56O: g.isRotationEditable(F)
                    } : h, y._6I = y._81o()
                }
                return y._6I
            },
            _3O: function () {},
            getPosition: function () {
                return sf
            },
            _68o: function (m, Q) {
                m && this._87I.add(Jg(m, Q))
            },
            _81o: function () {
                var s = this,
                    r = s.s;
                s._24O(Qk, "getLabel"), s._24O(_g, "getLabel2"), s._26O(zm, "getNote"), s._26O(Uj, "getNote2"), s._15O(), s._55O && s._48O();
                var V;
                if (s._87I.each(function (b) {
                        V = Rq(V, b)
                    }), V && s.isShadowed()) {
                    var $ = tc(V);
                    $.x += r("shadow.offset.x"), $.y += r("shadow.offset.y"), $d($, r("shadow.blur")), V = Rq(V, $)
                }
                return s._87I.clear(), V
            },
            _42: function (d) {
                var v = this,
                    s = v._data,
                    c = v.gv,
                    N = v.s,
                    g = N("opacity"),
                    C = this.isShadowed();
                if (C) {
                    var w = d.shadowOffsetX,
                        O = d.shadowOffsetY,
                        Q = d.shadowBlur,
                        E = d.shadowColor,
                        W = c.getZoom();
                    d.shadowOffsetX = N("shadow.offset.x") * W, d.shadowOffsetY = N("shadow.offset.y") * W, d.shadowBlur = N("shadow.blur") * W, d.shadowColor = v.getSelectColor()
                }
                if (g != h) {
                    var G = d.globalAlpha;
                    d.globalAlpha = g
                }
                v._80o(d), c.isLabelVisible(s) && ((!c._drawForChecking || N("label.selectable")) && pj(d, v.labelInfo), (!c._drawForChecking || N("label2.selectable")) && pj(d, v.label2Info)), c.isNoteVisible(s) && (Te(d, v.noteInfo), Te(d, v.note2Info)), v._99O(d), g != h && (d.globalAlpha = G), C && (d.shadowOffsetX = w, d.shadowOffsetY = O, d.shadowBlur = Q, d.shadowColor = E)
            },
            _80o: function () {},
            _47O: function () {},
            _24O: function (P, p) {
                var $ = this,
                    A = $._data,
                    Y = $.gv,
                    v = $.s,
                    W = Y[p](A);
                if (W != h) {
                    var g = v(P + ".scale"),
                        r = v(P + ".max"),
                        j = v(P + ".position"),
                        d = $[P + "Info"] = {
                            label: W,
                            scale: g,
                            color: Y[p + "Color"](A),
                            font: v(P + ".font"),
                            opacity: v(P + ".opacity"),
                            align: v(P + ".align"),
                            rotation: $.getRotation(v(P + ".rotation"), !1, j),
                            background: Y[p + "Background"](A)
                        },
                        J = po(d, W);
                    r > 0 && r < J.width && (d.labelWidth = J.width, J.width = r), 1 !== g && (J.width *= g, J.height *= g);
                    var a = $.getPosition(j, v(P + ".offset.x"), v(P + ".offset.y"), J, v(P + ".position.fixed"));
                    if (J.x = a.x - J.width / 2, J.y = a.y - J.height / 2, $._68o(d.rect = J, d.rotation), 1 !== g) {
                        var Q = J.width / g,
                            K = J.height / g;
                        d.rect = {
                            x: a.x - Q / 2,
                            y: a.y - K / 2,
                            width: Q,
                            height: K
                        }
                    }
                }
            },
            _26O: function (l, z) {
                var v = this,
                    P = v.gv,
                    G = v._data,
                    b = v.s,
                    B = P[z](G);
                if (B != h) {
                    var s, H, N = b(l + ".scale"),
                        T = v[l + "Info"] = {
                            note: B,
                            scale: N,
                            data: G,
                            view: P,
                            expanded: b(l + ".expanded"),
                            font: b(l + ".font"),
                            color: b(l + ".color"),
                            opacity: b(l + ".opacity"),
                            align: b(l + ".align"),
                            icon: b(l + ".icon"),
                            backgroundImage: b(l + ".backgroundImage"),
                            borderWidth: b(l + ".border.width"),
                            borderColor: b(l + ".border.color"),
                            background: P[z + "Background"](G)
                        },
                        t = v.getPosition(b(l + ".position"), b(l + ".offset.x"), b(l + ".offset.y")),
                        L = t.x,
                        A = t.y;
                    if (T.expanded) {
                        var V, I = b(l + ".max"),
                            y = b(l + ".backgroundImage");
                        y ? (y = Qn(y), V = {
                            width: Df(y, G),
                            height: Dd(y, G)
                        }) : V = po(T, B), V.width += 6, V.height += 2, I > 0 && I < V.width && (T.labelWidth = V.width, V.width = I), s = V.width, H = V.height + 8, T.clickRect = {
                            x: L - s * N / 2,
                            y: A - H * N,
                            width: s * N,
                            height: H * N * V.height / H
                        }
                    } else {
                        var w = b(l + ".icon");
                        w ? (w = Qn(w), s = Df(w, G), H = Dd(w, G)) : (s = 12, H = 18), T.clickRect = {
                            x: L - s * N / 2,
                            y: A - H * N,
                            width: s * N,
                            height: H * N
                        }
                    }
                    T.rect = {
                        x: L - s / 2,
                        y: A - H * N / 2 - H / 2,
                        width: s,
                        height: H
                    };
                    var n = _(T.borderWidth / 2) * N;
                    v._68o({
                        x: L - s * N / 2 - n,
                        y: A - H * N - n,
                        width: s * N + 2 * n,
                        height: H * N + 2 * n
                    })
                }
            },
            _48O: function () {},
            _99O: function (V) {
                var q = this,
                    U = q._38o;
                if (U) {
                    var F = q.gv,
                        n = q._data,
                        g = U.icons,
                        A = q.interactiveInfo;
                    A && (A._38o = {});
                    for (var B in g) {
                        var E = g[B],
                            c = U.rects[B];
                        if (c) {
                            A && (A._38o[B] = []);
                            var v = ze(E.opacity, n, F),
                                b = ze(E.names, n, F),
                                e = b ? b.length : 0,
                                j = c.rotation;
                            if (v != h) {
                                var L = V.globalAlpha;
                                V.globalAlpha *= v
                            }
                            for (var I = 0; e > I; I++) {
                                var s = b[I],
                                    R = Qn(s),
                                    P = c[I];
                                if (j) {
                                    var p = P.x + P.width / 2,
                                        G = P.y + P.height / 2;
                                    V.save(), Aj(V, p, G), Zp(V, j), Aj(V, -p, -G)
                                }
                                A && A._38o[B].push(V.interactiveInfo = {
                                    compInfos: [],
                                    matrix: j ? new yg(j, p, G).appendTranslate(-p, -G) : new yg
                                }), zk(V, R, ze(E.stretch, n, F), P.x, P.y, P.width, P.height, q._data, q.gv), V.interactiveInfo = h, j && V.restore()
                            }
                            v != h && (V.globalAlpha = L)
                        }
                    }
                }
            }
        });
        var fr = function (k, F) {
            cj(fr, this, [k, F])
        };
        zc(fr, bp, {
            _checkEmptyRect: !0,
            _40O: function (u, v) {
                var X = this,
                    B = X.s,
                    I = u.rect;
                (u.borderColor = X.gv.getBorderColor(X._data)) && (u.borderType = B("border.type"), u.borderWidth = B("border.width"), u.borderPadding = B("border.padding"), v = W(v, u.borderPadding + u.borderWidth / 2));
                var e = X._data.getScale(),
                    z = W(1, W(Y(e.x), Y(e.y)));
                if (u.selectWidth = X.getSelectWidth()) {
                    var x = X.gv._zoom;
                    u.selectType = B("select.type"), u._97o = X.getSelectColor(), u.selectPadding = B("select.padding"), v = W(v, (u.selectPadding + u.selectWidth / 2 / x) / z)
                }
                v > 0 && (v *= z, I = tc(I), $d(I, v)), X._68o(I)
            },
            _39O: function (S, Z) {
                var K, E = this,
                    R = Z.rect;
                if (Z.borderWidth > 0 && (K = Z.borderPadding, S.strokeStyle = Z.borderColor, S.lineWidth = Z.borderWidth, ge(S, Z.borderType, {
                        x: R.x - K,
                        y: R.y - K,
                        width: R.width + 2 * K,
                        height: R.height + 2 * K
                    }), S.stroke()), Z.selectWidth > 0) {
                    var u = E.gv._zoom;
                    if (K = Z.selectPadding, S.strokeStyle = Z._97o, S.lineWidth = Z.selectWidth / u, Z.rotation != h) {
                        S.save(), S.translate(Z.position.x, Z.position.y), S.rotate(Z.rotation);
                        var p = E._data,
                            m = p.getWidth(),
                            I = p.getHeight(),
                            T = Z.scale,
                            v = Z.anchor;
                        R = {
                            x: T.x * -m * v.x,
                            y: T.y * -I * v.y,
                            width: T.x * m,
                            height: T.y * I
                        }
                    }
                    ge(S, Z.selectType, {
                        x: R.x - K,
                        y: R.y - K,
                        width: R.width + 2 * K,
                        height: R.height + 2 * K
                    }), Z.rotation != h && S.restore(), S.stroke()
                }
            },
            dispose: function () {
                var x = this,
                    I = x._htmlView;
                fr.superClass._3O.call(x), I && (I.onHTMLRemoved && I.onHTMLRemoved(), Kh(I))
            },
            _3O: function () {
                var g = this,
                    c = g.s,
                    D = g._data,
                    q = g.gv,
                    A = D.getStyle(ef),
                    e = g.getBodyColor(),
                    r = g._83o = A ? {
                        shape: A,
                        _53o: g.getBodyColor("shape.background"),
                        _27Q: Qn(c("shape.repeat.image"), e),
                        shapeGradientPack: c("shape.gradient.pack"),
                        _54o: c("shape.border.width"),
                        _55o: c("shape.border.color"),
                        _56o: c("shape.border.3d"),
                        _57o: c("shape.border.3d.color"),
                        _58o: c("shape.border.3d.accuracy"),
                        shapeGradient: c("shape.gradient"),
                        _59o: c("shape.gradient.color"),
                        _60o: c("shape.border.pattern"),
                        _61o: c("shape.border.cap"),
                        _62o: c("shape.border.join"),
                        shapeForeground: c("shape.foreground"),
                        bodyColor: e,
                        gray: c("2d.gray")
                    } : {
                        img: Qn(q.getImage(D), e),
                        bodyColor: e,
                        gray: c("2d.gray"),
                        stretch: c("image.stretch")
                    };
                if (m && !S);
                else {
                    var o, n = r.img;
                    n && n.renderHTML ? (g._htmlInfo && g._htmlInfo.img !== n && (g._htmlInfo = h), g._htmlInfo || (g._htmlInfo = {
                        img: n,
                        cache: {}
                    }), o = n.renderHTML(D, q, g._htmlInfo.cache)) : g._htmlInfo = h, g._htmlView && g._htmlView !== o && (g._htmlView.onHTMLRemoved && g._htmlView.onHTMLRemoved(), Kh(g._htmlView.getView ? g._htmlView.getView() : g._htmlView)), (g._htmlView = o) && q.appendHTML(o) && o.onHTMLAdded && o.onHTMLAdded(), r.rect = D.getRect(), r.position = D.p(), r.scale = D.getScale(), r.anchor = D.getAnchor(), r.rotation = D.getRotation(), A === as && (r._63o = c("shape.depth"));
                    var N = 0;
                    if (A) N = Rm(h, r._54o / 2, r._62o), g.s("shape.dash") && (N = W(N, (g.s("shape.dash.width") || r._54o) / 2));
                    else if (n && n.boundExtend)
                        if (N = ze(n.boundExtend, D, q), n.boundExtendAbsolute) {
                            var F = D.getScale();
                            N /= q._zoom * W(1, W(Y(F.x), Y(F.y)))
                        } else if (!ze(n.fitSize, D, q)) {
                            var O = ze(n.width, D, q),
                                k = ze(n.height, D, q);
                            N *= W(D.getWidth() / O, D.getHeight() / k)
                        }
                    g._40O(r, N);
                    var R = c("clip.percentage");
                    if (1 > R && (0 > R && (R = 0), r.clipRect = ep(D.getAnchorRect(), c("clip.direction"), R)), A) {
                        var a = c("shape.fill.clip.percentage");
                        1 > a && (0 > a && (a = 0), r.shapeClipRect = ep(D.getAnchorRect(), c("shape.fill.clip.direction"), a));
                        var l = c("shape.foreground.clip.percentage");
                        1 > l && (0 > l && (l = 0), r.shapeForegroundClipRect = ep(D.getAnchorRect(), c("shape.foreground.clip.direction"), l))
                    }
                }
            },
            getPosition: function (b, A, q, I) {
                var h = sj(b, this._83o.rect, I);
                return h.x += A, h.y += q, h
            },
            _80o: function (_) {
                var z = this,
                    L = z.s,
                    b = z.gv,
                    u = z._data,
                    B = z._83o,
                    Q = B.rect,
                    g = B.position,
                    H = B.rotation,
                    Y = B.anchor,
                    R = B.scale,
                    P = B.shape,
                    m = B.clipRect;
                if (!z._checkEmptyRect || Q.width > 0 && Q.height > 0) {
                    var X = u.getSize();
                    if (X.x = -X.width * Y.x, X.y = -X.height * Y.y, _.save(), Aj(_, g.x, g.y), Zp(_, H), rb(_, R.x, R.y), m && (_.beginPath(), _.rect(m.x, m.y, m.width, m.height), _.clip()), b._drawForChecking && B.img && ze(B.img.pixelPerfect, u, b) === !1) to(_, X.x, X.y, X.width, X.height, "#888888");
                    else if (z.freeDraw) z.freeDraw(_, X, B);
                    else if (P) {
                        var x, I, F, W, n = B._60o,
                            i = eb(_, n),
                            t = B._27Q,
                            y = B._54o,
                            k = B.shapeGradientPack,
                            K = B.gray,
                            v = _.lineJoin,
                            O = _.lineCap,
                            l = function (v) {
                                return K ? f.toGrayColor(v) : v
                            };
                        "roundRect" === P ? x = L("shape.corner.radius") : "polygon" === P ? x = L("shape.polygon.side") : "arc" === P && (x = L("shape.arc.from"), I = L("shape.arc.to"), F = L("shape.arc.close"), W = L("shape.arc.oval")), _.lineJoin = B._62o, _.lineCap = B._61o;
                        var w = l(B._53o);
                        if (w || t || k) {
                            var C = B.shapeClipRect;
                            C && (_.save(), _.beginPath(), _.rect(C.x, C.y, C.width, C.height), _.clip()), ge(_, P, X, x, I, F, W), k ? Sc(_, k) : t ? Rp(_, t, l(B.bodyColor), null, u, b) : Mh(_, w, B.shapeGradient, l(B._59o), X), _.fill(), C && _.restore(), k && _.restore(), _ !== i && ge(i, P, X, x, I, F, W)
                        } else ge(i, P, X, x, I, F, W);
                        var c = B.shapeForeground;
                        if (c) {
                            _.save();
                            var Z = B.shapeForegroundClipRect;
                            Z && (_.beginPath(), _.rect(Z.x, Z.y, Z.width, Z.height), _.clip()), ge(_, P, X, x, I, F, W), Mh(_, c, L("shape.foreground.gradient"), l(L("shape.foreground.gradient.color")), X), _.fill(), _.restore()
                        }
                        if (y > 0) {
                            var M = L("shape.border.width.absolute");
                            M && (_.save(), _.setTransform(1, 0, 0, 1, 0, 0)), _.lineWidth = y;
                            var J = l(B._55o);
                            _.strokeStyle = J, _.stroke(), M && _.restore(), B._56o && Vm(_, J, l(B._57o), y, b._zoom, B._58o)
                        }
                        if (Bg(_, n), L("shape.dash")) {
                            var S = L("shape.dash.width") || y;
                            if (S > 0) {
                                n = L("shape.dash.pattern");
                                var i = eb(_, n, z._2Q("shape.dash.offset"));
                                i !== _ && ge(i, P, X, x, I, F, W), z._1Q(_, "shape", S, n)
                            }
                        }
                        _j(_, w, B._63o, X), _.lineJoin = v, _.lineCap = O
                    } else {
                        var D = z.interactiveInfo;
                        D && (_.interactiveInfo = D.bodyInfo = {
                            compInfos: [],
                            matrix: new yg(H, g.x, g.y, R.x, R.y)
                        }), B.gray && (_.compGray = !0);
                        var $ = B.img;
                        $ && $.cacheRule != h && ($ = sr(_, $, B.stretch, X.width, X.height, u, b, B.bodyColor)), zk(_, $, B.stretch, X.x, X.y, X.width, X.height, u, b, B.bodyColor), _.compGray = !1, _.interactiveInfo = h
                    }
                    _.restore()
                }
                z._39O(_, B)
            },
            _48O: function () {},
            _47O: function () {}
        });
        var kf = function (M, q) {
                cj(kf, this, [M, q])
            },
            Rd = function (h, X, L, k) {
                var F = Me(h, X);
                return L = k ? j(L, F) : Sk(L, F), F ? L /= F : L = 0, {
                    x: h.x + (X.x - h.x) * L,
                    y: h.y + (X.y - h.y) * L
                }
            };
        zc(kf, bp, {
            _3O: function () {
                var E, m = this,
                    P = m._data,
                    N = m.gv,
                    s = m.s,
                    u = s(Oo),
                    z = P.isLooped(),
                    v = s("edge.width"),
                    B = s("edge.center"),
                    $ = s("edge.offset"),
                    x = N.getBorderColor(P),
                    y = x ? s("border.width") : 0,
                    d = m.getSelectWidth(),
                    V = P._40I,
                    M = P._41I,
                    i = m._78o = V && M ? {
                        looped: z,
                        type: u,
                        width: v,
                        center: B,
                        color: m.getBodyColor("edge.color"),
                        borderColor: x,
                        borderWidth: y,
                        _97o: d ? m.getSelectColor() : h,
                        selectWidth: d,
                        pattern: s("edge.pattern"),
                        cap: s("edge.cap"),
                        join: s("edge.join"),
                        is3d: s("edge.3d"),
                        _67o: s("edge.3d.color"),
                        _66o: s("edge.3d.accuracy"),
                        gray: s("2d.gray")
                    } : h;
                if (i) {
                    var C = f.getEdgeType(u);
                    if (C) {
                        var F = C(P, hd(m, N, P, z, u), N, m._19Q);
                        F.points && F.points.size() > 1 ? (i.edgeTypeInfo = F, E = Vj(i.edgeTypeInfo.points)) : F[wn] && F.rect && (i.edgeTypeInfo = F, E = F.rect)
                    } else {
                        var O = s("edge.source.anchor.x"),
                            K = s("edge.source.anchor.y"),
                            Q = s("edge.target.anchor.x"),
                            g = s("edge.target.anchor.y"),
                            J = rg(N, V, s("edge.source.position"), s("edge.source.offset.x"), s("edge.source.offset.y"), O, K),
                            A = rg(N, M, s("edge.target.position"), s("edge.target.offset.x"), s("edge.target.offset.y"), Q, g);
                        if (u === gs) {
                            var o = i.points = s(Wr) || il,
                                X = o.size();
                            i.segments = s("edge.segments");
                            var e = O !== p || K !== p,
                                w = Q !== p || g !== p;
                            if (!B)
                                if ($) e || (J = Rd(J, X ? o.get(0) : A, $, X)), w || (A = Rd(A, X ? o.get(X - 1) : J, $, X));
                                else {
                                    var D;
                                    e || (D = oq(J, X ? o.get(0) : A, Ad(N, V)), D && (J = {
                                        x: D[0],
                                        y: D[1]
                                    })), w || (D = oq(X ? o.get(X - 1) : J, A, Ad(N, M)), D && (A = {
                                        x: D[0],
                                        y: D[1]
                                    }))
                                }
                            E = Rq(Vj(i.points), Vj(J, A))
                        } else {
                            var S = hd(m, N, P, z, u);
                            if (m._19Q || (S = -S), z) J = tc(J), J.x = N.getNodeRect(V).x, i.radius = S, E = {
                                x: J.x - S,
                                y: J.y - S,
                                width: 2 * S,
                                height: 2 * S
                            };
                            else {
                                var U = Me(J, A),
                                    l = Sk($, U),
                                    n = {
                                        x: l,
                                        y: S
                                    },
                                    T = {
                                        x: U - l,
                                        y: S
                                    },
                                    R = H(A.y - J.y, A.x - J.x),
                                    r = i.mat = new xe(R);
                                if (i.orienAngle = R, i.angle = A.x < J.x ? R + c : R, i.rect = {
                                        x: n.x,
                                        y: n.y,
                                        width: T.x - n.x,
                                        height: 0
                                    }, i.origin = J, n = r.tf(n), n.x += J.x, n.y += J.y, T = r.tf(T), T.x += J.x, T.y += J.y, B) {
                                    var a = {
                                        x: U,
                                        y: 0
                                    };
                                    a = r.tf(a), a.x += J.x, a.y += J.y, E = Vj([J, n, T, a]), i.c1 = J, i.c2 = a
                                } else E = Vj(n, T);
                                J = n, A = T
                            }
                        }
                        i.sourcePoint = J, i.targetPoint = A, P._lastSourcePoint = J, P._lastTargetPoint = A
                    }
                    var b = 0;
                    s("edge.dash") && (b = s("edge.dash.width") || v);
                    var L = "square" === i.cap ? .71 : .5;
                    Rm(E, W(b * L, v * L + y + d), i.join), m._68o(E)
                }
            },
            getRotation: function (q, n, I) {
                q = q || 0;
                var i = this._78o;
                if (i) {
                    var N, J = i.angle,
                        Q = i.points,
                        u = i.edgeTypeInfo;
                    if (J != h) return n ? i.orienAngle + q : J + q;
                    if (u && u[wn]) return u.getRotation ? u.getRotation(this, q, n, I) : 0;
                    if (u && u.points) {
                        var A = u.points;
                        return N = A.size(), Gj[I] ? N && 0 === N % 2 ? gi(A.get(N / 2 - 1), A.get(N / 2), n, q) : q : Mg[I] ? gi(A.get(0), A.get(1), n, q) : gi(A.get(N - 2), A.get(N - 1), n, q)
                    }
                    if (Q) return N = Q.size(), Gj[I] ? N && 0 === N % 2 ? gi(Q.get(N / 2 - 1), Q.get(N / 2), n, q) : q : Mg[I] ? gi(i.sourcePoint, N ? Q.get(0) : i.targetPoint, n, q) : gi(N ? Q.get(N - 1) : i.sourcePoint, i.targetPoint, n, q)
                }
                return q
            },
            getPosition: function (u, z, Y, X, W) {
                var V = this._78o;
                if (V) {
                    var D, b = V.type,
                        I = V.points,
                        k = V.edgeTypeInfo,
                        c = V.sourcePoint,
                        s = V.targetPoint;
                    if (!b) return V.looped ? {
                        x: c.x - V.radius + z,
                        y: c.y + Y
                    } : (W && c && s && (c.x > s.x || c.x === s.x && c.y > s.y) && (u = Xm[u], Y = -Y), D = sj(u, V.rect, X), D.x += z, D.y += Y, D = V.mat.tf(D), D.x += V.origin.x, D.y += V.origin.y, D);
                    if (k && k[wn]) return k.getPosition ? k.getPosition(this, u, z, Y, X, W) : {
                        x: (c.x + s.x) / 2,
                        y: (c.y + s.y) / 2
                    };
                    if (I) {
                        var D, J = I.size();
                        if (Gj[u]) {
                            if (J) {
                                var n = J % 2;
                                if (0 === n) return vs(I.get(J / 2 - 1), I.get(J / 2), u, z, Y, X, W);
                                D = I.get((J - n) / 2)
                            } else D = {
                                x: (c.x + s.x) / 2,
                                y: (c.y + s.y) / 2
                            };
                            return D = sj(u, {
                                x: D.x,
                                y: D.y,
                                width: 0,
                                height: 0
                            }, X), D.x += z, D.y += Y, D
                        }
                        return Mg[u] ? vs(c, J ? I.get(0) : s, u, z, Y, X, W) : vs(J ? I.get(J - 1) : c, s, u, z, Y, X, W)
                    }
                    if (k) {
                        var r = k.points,
                            J = r.size();
                        if (Gj[u]) {
                            var n = J % 2;
                            return 0 === n ? vs(r.get(J / 2 - 1), r.get(J / 2), u, z, Y, X, W) : (D = r.get((J - n) / 2), D = sj(u, {
                                x: D.x,
                                y: D.y,
                                width: 0,
                                height: 0
                            }, X), D.x += z, D.y += Y, D)
                        }
                        return Mg[u] ? vs(r.get(0), r.get(1), u, z, Y, X, W) : vs(r.get(J - 2), r.get(J - 1), u, z, Y, X, W)
                    }
                }
                return sf
            },
            _42: function (S) {
                this._78o && kf.superClass._42.call(this, S)
            },
            drawPath: function (n, $) {
                n.beginPath();
                var f = $.type,
                    D = $.points,
                    X = $.segments,
                    A = $.edgeTypeInfo;
                if (!f || D) {
                    var J = $.sourcePoint,
                        d = J.x,
                        j = J.y,
                        b = $.targetPoint,
                        U = b.x,
                        m = b.y;
                    if (f)
                        if (X) {
                            var c = new vf({
                                x: d,
                                y: j
                            });
                            c.addAll(D), c.add({
                                x: U,
                                y: m
                            }), Dl(n, c, X)
                        } else n.moveTo(d, j), D.each(function (F) {
                            n.lineTo(F.x, F.y)
                        }), n.lineTo(U, m);
                    else $.looped ? n.arc(d, j, $.radius, 0, E, !0) : $.center ? (n.moveTo($.c1.x, $.c1.y), n.lineTo(d, j), n.lineTo(U, m), n.lineTo($.c2.x, $.c2.y)) : (n.moveTo(d, j), n.lineTo(U, m))
                } else A && (A.points ? Dl(n, A.points, A.segments) : A[wn] && A[wn](n, A))
            },
            _80o: function (L) {
                var d = this,
                    C = d.s,
                    y = d._78o,
                    Z = y.width,
                    O = y.selectWidth,
                    e = y.borderWidth,
                    D = L.lineJoin,
                    q = L.lineCap,
                    k = y.gray,
                    l = y.pattern;
                L.lineJoin = y.join, L.lineCap = y.cap, d.drawPath(eb(L, l), y);
                var n = C("edge.width.absolute");
                n && (L.save(), L.setTransform(1, 0, 0, 1, 0, 0)), O && (L.strokeStyle = y._97o, L.lineWidth = Z + 2 * (e + O), L.stroke()), e && (L.strokeStyle = k ? f.toGrayColor(y.borderColor) : y.borderColor, L.lineWidth = Z + 2 * e, L.stroke());
                var u = k ? f.toGrayColor(y.color) : y.color,
                    N = k ? f.toGrayColor(y._67o) : y._67o;
                if (L.strokeStyle = u, L.lineWidth = Z, L.stroke(), y.is3d && Vm(L, u, N, Z, d.gv._zoom, y._66o), n && L.restore(), Bg(L, l), C("edge.dash")) {
                    l = C("edge.dash.pattern");
                    var K = eb(L, l, d._2Q("edge.dash.offset"));
                    K !== L && d.drawPath(K, y), d._1Q(L, "edge", C("edge.dash.width") || Z, l)
                }
                L.lineJoin = D, L.lineCap = q
            },
            _48O: function () {},
            _47O: function () {},
            _71o: function (A, P) {
                var q = this,
                    W = q._data;
                if (q._19Q = !0, !W.getEdgeGroup()) return A ? W.s("edge.gap") : 0;
                var Y, r = 0,
                    n = 0,
                    e = 0;
                if (W.getEdgeGroup().getSiblings().each(function (c) {
                        c.each(function (k) {
                            if (q.gv.isVisible(k) && k.s(Oo) == P) {
                                var E = k.s("edge.gap");
                                Y ? (n += e / 2 + E / 2, e = E) : (Y = k, e = E), k === W && (r = n)
                            }
                        })
                    }), A) return n - r + e;
                var X = r - n / 2;
                return Y && W._40I !== Y._40I && (q._19Q = !1), X
            }
        });
        var Oc = function (P, t) {
            cj(Oc, this, [P, t])
        };
        zc(Oc, fr, {
            _3O: function () {
                var W, t, T = this,
                    Q = T.s,
                    C = T._data,
                    Y = T.gv;
                if (T._88I = h, C.isExpanded() && C.eachChild(function (G) {
                        if (Cc(G)) {
                            var D = Y.getBoundsForGroup(G);
                            D && (t || (t = []), t.push(D), W = Rq(W, D))
                        }
                    }), W) {
                    var U = Y.getLabel(C),
                        l = Q("group.type");
                    W = xd(l, t, W), te(W, C, "group.padding", 1);
                    var p = T._88I = {
                        type: l,
                        rect: W,
                        _64o: W
                    };
                    if (!l && U != h) {
                        var X, u = T.labelInfo = {
                                label: U,
                                color: Q("group.title.color"),
                                font: Q("group.title.font"),
                                align: Q("group.title.align")
                            },
                            G = po(u, U),
                            M = G.width,
                            d = G.height,
                            y = Q("group.title.align"),
                            O = Q("group.title.orientation");
                        if ((O === $b || O === Id) && M > W.width ? W.width = M : (O === ul || O === sb) && M > W.height && (W.height = M), u.rect = {
                                y: W.y - d,
                                width: G.width,
                                height: d
                            }, X = y === ul ? W.x : y === sb ? W.x + W.width - M : W.x + W.width / 2 - M / 2, u.rect.x = X, O === Id) p.titleRect = {
                            x: W.x,
                            y: W.y + W.height,
                            width: W.width,
                            height: d
                        }, p.rect = {
                            x: W.x,
                            y: W.y,
                            width: W.width,
                            height: W.height + d
                        }, u.rect = {
                            x: X,
                            y: W.y + W.height,
                            width: M,
                            height: d
                        };
                        else if (O === ul) {
                            var H = p.titleRect = {
                                x: W.x - d,
                                y: W.y,
                                width: d,
                                height: W.height
                            };
                            p.rect = {
                                x: W.x - d,
                                y: W.y,
                                width: W.width + d,
                                height: W.height
                            }, u.rect = {
                                x: H.x + d / 2 - W.height / 2,
                                y: H.y + W.height / 2 - d / 2,
                                width: W.height,
                                height: d
                            }, u.rotation = -Math.PI / 2
                        } else if (O === sb) {
                            var H = p.titleRect = {
                                x: W.x + W.width,
                                y: W.y,
                                width: d,
                                height: W.height
                            };
                            p.rect = {
                                x: W.x,
                                y: W.y,
                                width: W.width + d,
                                height: W.height
                            }, u.rect = {
                                x: H.x + d / 2 - W.height / 2,
                                y: H.y + W.height / 2 - d / 2,
                                width: W.height,
                                height: d
                            }, u.rotation = Math.PI / 2
                        } else p.titleRect = {
                            x: W.x,
                            y: W.y - d,
                            width: W.width,
                            height: d + 1
                        }, p.rect = {
                            x: W.x,
                            y: W.y - d,
                            width: W.width,
                            height: W.height + d
                        }
                    }
                    T._40O(p, Q("group.border.width") / 2)
                } else Oc.superClass._3O.call(T)
            },
            getPosition: function (l, T, F, _) {
                var D = this._88I;
                if (D) {
                    var f = sj(l, D.rect, _);
                    return f.x += T, f.y += F, f
                }
                return Oc.superClass.getPosition.apply(this, arguments)
            },
            _24O: function (I, c) {
                var J = this._88I;
                (!J || J.type || "label2" === I) && Oc.superClass._24O.call(this, I, c)
            },
            _80o: function (D) {
                var R = this,
                    c = R._88I;
                if (c) {
                    var $ = R._data,
                        w = R.s,
                        p = R.gv,
                        E = c.type,
                        b = c.rect,
                        C = c._64o,
                        a = c.titleRect,
                        B = R.getBodyColor(),
                        x = Qn(w("group.image"), B),
                        o = w("group.image.stretch"),
                        v = R.getBodyColor("group.background"),
                        I = Qn(w("group.repeat.image"), B),
                        X = w("group.gradient.pack"),
                        h = w("group.gradient"),
                        N = w("group.gradient.color"),
                        m = w("group.border.width"),
                        _ = w("group.border.color"),
                        Q = w("group.border.pattern"),
                        z = w("group.title.orientation"),
                        n = w("group.depth");
                    if (E) {
                        var d = D.lineJoin,
                            K = D.lineCap;
                        if (D.lineJoin = w("group.border.join"), D.lineCap = w("group.border.cap"), x) {
                            if (D.save(), ge(D, E, b), D.clip(), zk(D, x, o, b.x, b.y, b.width, b.height, $, p, B), D.restore(), m > 0) {
                                var k = eb(D, Q);
                                ge(k, E, b), D.lineWidth = m, D.strokeStyle = _, D.stroke(), Bg(D, Q)
                            }
                        } else {
                            var k = eb(D, Q);
                            v || I || X ? (ge(D, E, b), X ? Sc(D, X) : I ? Rp(D, I, B, null, $, p) : Mh(D, v, h, N, b), D.fill(), X && D.restore(), D !== k && ge(k, E, b)) : ge(k, E, b), m > 0 && (D.lineWidth = m, D.strokeStyle = w("group.border.color"), D.stroke()), Bg(D, Q), E === as && _j(D, v, n, b)
                        }
                        D.lineJoin = d, D.lineCap = K
                    } else {
                        var Y = w("group.title.background"),
                            Z = w("group.border.radius");
                        if (x) zk(D, x, o, C.x, C.y, C.width, C.height, $, p, R.getBodyColor());
                        else if (v || I)
                            if (I ? Rp(D, I, B, null, $, p) : Mh(D, v, h, N, C), 0 === m) ge(D, as, C), D.fill(), _j(D, v, n, C);
                            else {
                                switch (D.beginPath(), z) {
                                    case Id:
                                        zd(D, C.x, C.y, C.width, C.height, Z, Z, 0, 0);
                                        break;
                                    case ul:
                                        zd(D, C.x, C.y, C.width, C.height, 0, Z, 0, Z);
                                        break;
                                    case sb:
                                        zd(D, C.x, C.y, C.width, C.height, Z, 0, Z, 0);
                                        break;
                                    case $b:
                                        zd(D, C.x, C.y, C.width, C.height, 0, 0, Z, Z)
                                }
                                D.fill()
                            }
                        if (a && Y)
                            if (0 === m) to(D, a.x, a.y, a.width, a.height, Y), _j(D, Y, n, a);
                            else {
                                switch (D.beginPath(), D.fillStyle = Y, z) {
                                    case Id:
                                        zd(D, a.x, a.y, a.width, a.height, 0, 0, Z, Z);
                                        break;
                                    case ul:
                                        zd(D, a.x, a.y, a.width, a.height, Z, 0, Z, 0);
                                        break;
                                    case sb:
                                        zd(D, a.x, a.y, a.width, a.height, 0, Z, 0, Z);
                                        break;
                                    case $b:
                                        zd(D, a.x, a.y, a.width, a.height, Z, Z, 0, 0)
                                }
                                D.fill()
                            }
                        if (m > 0) {
                            var k = eb(D, Q);
                            if (ge(k, "roundRect", b, Z), D.lineWidth = m, D.strokeStyle = _, a && w("group.splitLine")) {
                                var g = a.x,
                                    M = a.y,
                                    S = a.width,
                                    W = a.height;
                                z === Id ? (D.moveTo(g, M), D.lineTo(g + S, M)) : z === ul ? (D.moveTo(g + S, M), D.lineTo(g + S, M + W)) : z === sb ? (D.moveTo(g, M), D.lineTo(g, M + W)) : (D.moveTo(g, M + W), D.lineTo(g + S, M + W))
                            }
                            D.stroke(), Bg(D, Q)
                        }
                    }
                    R._39O(D, c)
                } else Oc.superClass._80o.call(R, D)
            }
        });
        var is = function (w, E) {
            cj(is, this, [w, E])
        };
        zc(is, fr, {
            _80o: function (B) {
                this._39O(B, this._83o)
            }
        });
        var eg = function (q, S) {
            cj(eg, this, [q, S])
        };
        zc(eg, fr, {
            _3O: function () {
                var s = this,
                    c = s._data,
                    p = s.s,
                    l = s.gv,
                    E = c.getPoints(),
                    i = l.getBorderColor(c),
                    m = i ? p("border.width") : 0,
                    j = s.getSelectWidth(),
                    F = p("shape.border.width"),
                    x = c.getRect(),
                    V = l.getBodyColor(c),
                    C = s._99o = E.isEmpty() ? h : {
                        rect: x,
                        rotation: c.getRotation(),
                        fillRule: p("shape.fill.rule"),
                        scale: c.getScale(),
                        position: c.p(),
                        points: E,
                        segments: c.getSegments(),
                        bodyColor: V,
                        borderColor: i,
                        borderWidth: m,
                        _94o: p("shape.border.3d"),
                        _95o: p("shape.border.3d.color"),
                        _96o: p("shape.border.3d.accuracy"),
                        _97o: j ? s.getSelectColor() : h,
                        selectWidth: j,
                        _53o: p("shape.background"),
                        _27Q: Qn(p("shape.repeat.image"), V),
                        shapeGradientPack: p("shape.gradient.pack"),
                        _54o: F,
                        _55o: p("shape.border.color"),
                        shapeGradient: p("shape.gradient"),
                        _59o: p("shape.gradient.color"),
                        _60o: p("shape.border.pattern"),
                        _61o: p("shape.border.cap"),
                        _62o: p("shape.border.join"),
                        shapeForeground: p("shape.foreground"),
                        gray: p("2d.gray")
                    };
                if (C) {
                    var k = c.getScale(),
                        R = W(1, W(Y(k.x), Y(k.y)));
                    p("shape.dash") && p("shape.dash.width") > F && (F = p("shape.dash.width"));
                    var u = F * ("square" === C._61o ? .71 : .5) + m + j / s.gv._zoom / R;
                    u && (u *= R, x = tc(x), Rm(x, u, C._62o)), s._68o(x);
                    var O = p("clip.percentage");
                    1 > O && (0 > O && (O = 0), C.clipRect = ep(c.getAnchorRect(), p("clip.direction"), O));
                    var N = p("shape.fill.clip.percentage");
                    1 > N && (0 > N && (N = 0), C.shapeClipRect = ep(c.getAnchorRect(), p("shape.fill.clip.direction"), N));
                    var o = p("shape.foreground.clip.percentage");
                    1 > o && (0 > o && (o = 0), C.shapeForegroundClipRect = ep(c.getAnchorRect(), p("shape.foreground.clip.direction"), o))
                }
            },
            getPosition: function (g, H, z, M) {
                var m = this._99o;
                if (m) {
                    var u = sj(g, m.rect, M);
                    return u.x += H, u.y += z, u
                }
                return sf
            },
            _42: function (i) {
                this._99o && eg.superClass._42.call(this, i)
            },
            _80o: function (w) {
                var t, D = this,
                    E = D.s,
                    I = D._99o,
                    p = I.position,
                    m = I.scale,
                    V = I.rotation,
                    U = I.borderWidth,
                    F = I.selectWidth / D.gv._zoom,
                    v = I._27Q,
                    Q = I.shapeGradientPack,
                    $ = I._54o,
                    c = I.clipRect,
                    B = I.shapeClipRect,
                    o = I.points,
                    g = I.segments,
                    i = D._data.isClosePath(),
                    W = I.fillRule,
                    T = I.gray,
                    R = function ($) {
                        return T ? f.toGrayColor($) : $
                    },
                    C = R(I._53o),
                    q = C || v || Q;
                w.save(), Aj(w, p.x, p.y), Zp(w, V), rb(w, m.x, m.y), c && (w.beginPath(), w.rect(c.x, c.y, c.width, c.height), w.clip()), q && B && (w.save(), w.beginPath(), w.rect(B.x, B.y, B.width, B.height), w.clip()), Aj(w, -p.x, -p.y);
                var x = I._60o,
                    H = eb(w, x),
                    X = w.lineJoin,
                    b = w.lineCap;
                w.lineJoin = I._62o, w.lineCap = I._61o;
                var h = R(I.bodyColor);
                q ? (Dl(w, o, g, i), Q ? Sc(w, Q) : v ? Rp(w, v, h, null, D._data, D.gv) : (t = h ? h : C, Mh(w, t, I.shapeGradient, R(I._59o), I.rect)), w.fill(W), B && (w.restore(), Aj(w, -p.x, -p.y)), Q && w.restore(), H !== w && Dl(H, o, g, i)) : Dl(H, o, g, i);
                var J = I.shapeForeground;
                if (J) {
                    w.save();
                    var L = I.shapeForegroundClipRect;
                    L && (Aj(w, p.x, p.y), w.beginPath(), w.rect(L.x, L.y, L.width, L.height), w.clip(), Aj(w, -p.x, -p.y)), Dl(w, o, g, i), Mh(w, J, E("shape.foreground.gradient"), R(E("shape.foreground.gradient.color")), I.rect), w.fill(W), w.restore()
                }
                var S = E("shape.border.width.absolute");
                if (S && (w.save(), w.setTransform(1, 0, 0, 1, 0, 0)), F && (w.strokeStyle = I._97o, w.lineWidth = $ + 2 * (U + F), w.stroke()), U && (w.strokeStyle = R(I.borderColor), w.lineWidth = $ + 2 * U, w.stroke()), $ && (t = R(I._55o), !C && h && (t = h), w.strokeStyle = t, w.lineWidth = $, w.stroke(), I._94o && Vm(w, t, R(I._95o), $, D.gv._zoom, I._96o)), S && w.restore(), Bg(w, x), E("shape.dash")) {
                    var e = E("shape.dash.width") || $;
                    if (e > 0) {
                        x = E("shape.dash.pattern");
                        var H = eb(w, x, D._2Q("shape.dash.offset"));
                        H !== w && Dl(H, o, g, i), D._1Q(w, "shape", e, x)
                    }
                }
                w.lineJoin = X, w.lineCap = b, w.restore()
            },
            _48O: function () {},
            _47O: function () {}
        });
        var To = function (X, M) {
            cj(To, this, [X, M])
        };
        zc(To, eg, {
            getRotation: function (J, A, c) {
                J = J || 0;
                var W = this._data.getPoints(),
                    X = W.size();
                return X > 1 ? Gj[c] ? X && 0 === X % 2 ? gi(W.get(X / 2 - 1), W.get(X / 2), A, J) : J : Mg[c] ? gi(W.get(0), W.get(1), A, J) : gi(W.get(X - 2), W.get(X - 1), A, J) : J
            },
            getPosition: function (H, u, C, Z, x) {
                var g = this._data.getPoints(),
                    F = g.size();
                if (F > 1) {
                    if (Gj[H]) {
                        var K = F % 2;
                        if (0 === K) return vs(g.get(F / 2 - 1), g.get(F / 2), H, u, C, Z, x);
                        var V = g.get((F - K) / 2),
                            N = {
                                x: V.x,
                                y: V.y,
                                width: 0,
                                height: 0
                            };
                        return V = sj(H, N, Z), V.x += u, V.y += C, V
                    }
                    return Mg[H] ? vs(g.get(0), g.get(1), H, u, C, Z, x) : vs(g.get(F - 2), g.get(F - 1), H, u, C, Z, x)
                }
                return sf
            }
        });
        var Vq = function (K, r) {
            cj(Vq, this, [K, r])
        };
        zc(Vq, fr, {
            _3O: function () {
                var b = this;
                Vq.superClass._3O.call(b);
                var D = b.s,
                    G = b._83o;
                b._82o = G.img || G.shape ? h : {
                    background: b.getBodyColor("grid.background"),
                    depth: D("grid.depth"),
                    rect: G.rect,
                    _88o: D("grid.cell.depth"),
                    cellBorderColor: D("grid.cell.border.color"),
                    _89o: D("grid.row.count"),
                    _90o: D("grid.column.count"),
                    block: D("grid.block"),
                    _91o: D("grid.block.color"),
                    _92o: D("grid.block.padding"),
                    _93o: D("grid.block.width")
                }
            },
            _80o: function (f) {
                var e = this,
                    y = e._82o;
                if (!y) return Vq.superClass._80o.call(e, f), void 0;
                var Z, j, m = e._data,
                    $ = y.background,
                    l = y.rect,
                    V = y.block,
                    n = y._91o,
                    u = y._92o,
                    C = y._93o,
                    o = y._88o,
                    x = y.cellBorderColor,
                    M = y._89o,
                    L = y._90o;
                if ($)
                    if (to(f, l.x, l.y, l.width, l.height, $), _j(f, $, y.depth, l), o)
                        for (Z = 0; M > Z; Z++)
                            for (j = 0; L > j; j++) l = m.getCellRect(Z, j), l && _j(f, $, o, l);
                    else if (x) {
                        for (f.beginPath(), Z = 0; M > Z; Z++)
                            for (j = 0; L > j; j++) l = m.getCellRect(Z, j), l && f.rect(l.x, l.y, l.width, l.height);
                        f.strokeStyle = x, f.lineWidth = 1, f.stroke()
                    }
                if ("h" === V)
                    for (Z = 0; M > Z; Z++) l = Rq(m.getCellRect(Z, 0), m.getCellRect(Z, L - 1)), $d(l, u), Yq(f, n, l.x, l.y, l.width, l.height, C);
                else if ("v" === V)
                    for (j = 0; L > j; j++) l = Rq(m.getCellRect(0, j), m.getCellRect(M - 1, j)), $d(l, u), Yq(f, n, l.x, l.y, l.width, l.height, C);
                e._39O(f, e._83o)
            }
        });
        var Nd = function (K, D) {
            cj(Nd, this, [K, D])
        };
        zc(Nd, fr, {
            _checkEmptyRect: !1,
            _81o: function () {
                var V = this._data,
                    q = Nd.superClass._81o.call(this),
                    Y = V.s("text");
                if (Y != h) {
                    var R, N, a = V.s("text.font"),
                        l = V.s("text.align"),
                        e = V.s("text.vAlign"),
                        Q = Bk(a, Y),
                        F = Q.width,
                        x = Q.height,
                        d = V.getAnchor(),
                        u = V.getWidth(),
                        B = V.getHeight();
                    "left" === l ? R = -u * d.x : "center" === l ? R = -u * d.x + (u - F) / 2 : "right" === l && (R = u * (1 - d.x) - Q.width), "top" === e ? N = -B * d.y : "middle" === e ? N = -B * d.y + (B - x) / 2 : "bottom" === e && (N = B * (1 - d.y) - Q.height);
                    var L, C = V.getMatrix();
                    if (L = Vj([C.tf(R, N), C.tf(R + F, N), C.tf(R + F, N + x), C.tf(R, N + x)]), q = Rq(q, L), q && V.s("text.shadow")) {
                        var s = tc(q);
                        s.x += V.s("text.shadow.offset.x"), s.y += V.s("text.shadow.offset.y"), $d(s, V.s("text.shadow.blur")), q = Rq(q, s)
                    }
                }
                return q
            }
        });
        var ar = zj.Interactor = function (T) {
            this.gv = this._graphView = T
        };
        kp("Interactor", x, {
            ms_listener: 1,
            getView: function () {
                return this.gv.getView()
            },
            setUp: function () {
                this.addListeners()
            },
            tearDown: function () {
                this.removeListeners(), this.clear()
            },
            clear: function () {},
            fi: function (H) {
                this.gv.fi(H)
            },
            setCursor: function (X) {
                ah || this.gv.setCursor(X)
            },
            startDragging: function (G) {
                var q = this;
                q._lastClientPoint = Fc(G), q._lastLogicalPoint = q.gv.lp(G), gn(q, G)
            },
            clearDragging: function () {
                var o = this;
                o._lastClientPoint = o._lastLogicalPoint = o._logicalPoint = h
            },
            autoScroll: function (Z) {
                return this.gv.autoScroll(Z, this._lastClientPoint)
            }
        });
        var Cm = h,
            _h = function (Z) {
                Cm.handleWindowTouchMove(Z)
            },
            Hl = function (L) {
                Cm.handleWindowTouchEnd(L), d.removeEventListener(Cn, _h, V), d.removeEventListener(hc, Hl, V), Cm = h
            },
            pm = function (S) {
                Cm.handleWindowMouseMove(S)
            },
            yq = function (H) {
                Cm.handleWindowMouseUp(H), d.removeEventListener(th, pm, V), d.removeEventListener(wr, yq, V), Cm = h
            },
            pf = function (h, j) {
                h !== Cm && (Cm ? ah ? Cm.handleWindowTouchEnd(j) : Cm.handleWindowMouseUp(j) : ah ? (d.addEventListener(Cn, _h, V), d.addEventListener(hc, Hl, V)) : (d.addEventListener(th, pm, V), d.addEventListener(wr, yq, V)), Cm = h)
            },
            ao = function (X) {
                var k = this;
                k.gv = X, k._is2d = X instanceof zj.GraphView, k._is2d && (k.filter = function (t) {
                    return X.isSelectable(t) && X.isInteractive(t)
                }), X.getView(), ["mousedown", "mousemove", "mouseleave", "touchstart", "touchmove", xb].forEach(function (f) {
                    k.addListener(f)
                }), k.initImageResource()
            };
        zc(ao, ar, {
            enableVR: function (A) {
                var x = this;
                if (!!x._vrEnable !== A)
                    if (x._vrEnable = A, A) x.gv.vr.mp(x.onVRControllerChange, x);
                    else if (x.gv.vr.ump(x.onVRControllerChange, x), x._vrRayPolyline) {
                        var Z = x.gv.dm();
                        Z.remove(x._vrRayPolyline), Z.remove(x._vrRayHitPoint), x._vrRayPolyline = p, x._vrRayHitPoint = p
                    }
            },
            onVRControllerChange: function (L) {
                var W = this,
                    B = L.property,
                    x = L.newValue,
                    $ = W.gv.vr.getController(x.id),
                    d = $.getRay();
                d && ("gamepad.button.trigger" === B ? "down" === x._62O ? W.handle_mousedown(d) : W.handleWindowMouseUp(d) : "gamepad.pose" === B && (W.handle_mousemove(d), W.handleWindowMouseMove(d)))
            },
            drawVRRay: function (g, A, H) {
                var o, $ = this,
                    p = $.gv,
                    c = $._vrRayPolyline,
                    P = !1;
                if (c) o = $._vrRayHitPoint;
                else {
                    var r = p.dm();
                    $._vrRayPolyline = c = new k.Polyline, $._vrRayHitPoint = o = new k.Node, o.s({
                        shape3d: "billboard",
                        "shape3d.transparent": !0,
                        "shape3d.texture.scale": 10,
                        "shape3d.image": "coreInteractorRayHitImage"
                    }), o.setAnchor3d(.5, .5, .499);
                    var z = .2 / p.vr.measureOflength;
                    o.s3(z, z, z), c.s("intersect", !1), o.s("intersect", !1), r.add(c), r.add(o), P = !0
                }
                if (A) {
                    var D = H.world,
                        Y = H.worldNormal,
                        N = D.x,
                        M = D.y,
                        l = D.z;
                    c.s("shape.border.color", "red"), c.setPoints([{
                        x: g.origin.x,
                        y: g.origin.z,
                        e: g.origin.y
                    }, {
                        x: N,
                        y: l,
                        e: M
                    }]), o.s("3d.visible", !0), o.p3(N, M, l), o.lookAtDirection([Y.x, Y.y, Y.z], "front")
                } else {
                    c.s("shape.border.color", "blue");
                    var I = new k.Math.Vector3;
                    I.copy(g.direction).setLength(1e3 / $.gv.vr.measureOflength).add(g.origin), c.setPoints([{
                        x: g.origin.x,
                        y: g.origin.z,
                        e: g.origin.y
                    }, {
                        x: I.x,
                        y: I.z,
                        e: I.y
                    }]), o.s("3d.visible", !1)
                }
                p.fi({
                    kind: "vrRayIntersect",
                    ray: g,
                    data: A,
                    intersect: H,
                    polyline: c,
                    hitNode: o,
                    begin: P
                })
            },
            addListener: function (e) {
                var k = this;
                k.gv.getView().addEventListener(e, function (u) {
                    f.preventDefault(u), k.disabled || k["handle_" + e](u)
                }, V)
            },
            handleWindowTouchMove: function (U) {
                this.handleWindowMouseMove(U)
            },
            handleWindowMouseMove: function (h) {
                this.downInfo && (this.isDragging ? this.handleDownInfo("onDrag", h) : (this.handleDownInfo("onBeginDrag", h), this.isDragging = !0))
            },
            handleWindowTouchEnd: function (T) {
                this.handleWindowMouseUp(T)
            },
            handleWindowMouseUp: function (D) {
                if (this.isDragging && (this.handleDownInfo("onEndDrag", D), this.isDragging = !1), this.downInfo) {
                    var M = this.handle("onUp", D);
                    M && M.data === this.downInfo.data ? this.handleMissingUp(D) : this.handleDownInfo("onUp", D), this.downInfo = h
                }
            },
            handle_mouseleave: function (N) {
                var m = this,
                    F = m.gv,
                    V = m.currentInfo ? m.currentInfo.data : h;
                if (V) {
                    V.s("onLeave") && V.s("onLeave")(N, V, F), m.fire("data", "onLeave", N, V);
                    var H = m.currentInfo ? m.currentInfo.hits : h;
                    if (H)
                        for (var t in H) m.handleLeave(N, t);
                    m.currentInfo = h
                }
            },
            handle_mousewheel: function (L) {
                L.scrollDelta = L.wheelDelta / 40, this.handle("onScroll", L)
            },
            handle_DOMMouseScroll: function (q) {
                q.scrollDelta = 2 === q.axis ? -q.detail : 0, this.handle("onScroll", q)
            },
            handle_touchstart: function (b) {
                this.handle_mousedown(b)
            },
            handle_touchmove: function (u) {
                this.handle("onMove", u)
            },
            handle_mousedown: function (p) {
                this.isDragging && (this.handleDownInfo("onEndDrag", p), this.isDragging = !1), this.downInfo = this.handle("onDown", p), this.downInfo && pf(this, p)
            },
            handle_mousemove: function (U) {
                var l = this,
                    C = l.gv;
                l._hoverTimer && (I(l._hoverTimer), delete l._hoverTimer);
                var E, s, W, o = l.handle("onMove", U),
                    V = this.currentInfo ? this.currentInfo.data : h,
                    k = this.currentInfo ? this.currentInfo.hits : h;
                if (o && (s = o.data, W = o.hits, l._hoverTimer = q(function () {
                        I(l._hoverTimer), delete l._hoverTimer, l.handle("onHover", U, o)
                    }, C.getHoverDelay() || f.hoverDelay)), s !== V) {
                    if (V && (V.s("onLeave") && V.s("onLeave")(U, V, C), this.fire("data", "onLeave", U, V)), s && (s.s("onEnter") && s.s("onEnter")(U, s, C), this.fire("data", "onEnter", U, s)), k)
                        for (E in k) this.handleLeave(U, E);
                    if (W)
                        for (E in W) {
                            var P = W[E];
                            P.target.onEnter && P.target.onEnter(U, s, C, P.point, P.width, P.height), this.fire(P.type, "onEnter", P.event, P.data, P.image, P.comp, P.point, P)
                        }
                } else {
                    if (k)
                        for (E in k) W && W[E] || this.handleLeave(U, E);
                    if (W)
                        for (E in W)
                            if (!k || !k[E]) {
                                var P = W[E];
                                P.target.onEnter && P.target.onEnter(U, s, C, P.point, P.width, P.height), this.fire(P.type, "onEnter", P.event, P.data, P.image, P.comp, P.point, P)
                            }
                }
                this.currentInfo = o
            },
            handle: function (l, N, b) {
                var p, M = this,
                    D = M.gv;
                if (M._is2d) {
                    if (b = b || D.getDataInfoAt(N, this.filter), !b) return;
                    if (p = b.ui.interactiveInfo) {
                        var v, w = b.data;
                        if (w.s(l) && w.s(l)(N, w, D), this.fire("data", l, N, w), "body" === b.part && p.bodyInfo) v = "body", b.hits = this.handleImage(v, D.getImage(w), l, N, w, b.point, p.bodyInfo);
                        else if ("icons" === b.part && p._38o) {
                            var q = p._38o[b.name];
                            q && q[b.index] && (v = "icons|" + b.name + "|" + b.index, b.hits = this.handleImage(v, b.icon, l, N, w, b.point, q[b.index]))
                        }
                    }
                    return b
                }
                var w, J;
                if (!b)
                    if (N && N instanceof k.Math.Ray) {
                        var h = D.vr.intersectWorld(N);
                        if (w = h.data, J = h.intersect, M.drawVRRay(N, w, J), !w) return;
                        var C = D.getData3dUI(w);
                        if (p = C.interactiveInfo, !p) return;
                        b = {
                            data: w,
                            part: J.part,
                            ui: C
                        }
                    } else {
                        if (b = D.getDataInfoAt(N), !b) return;
                        b && (b = {
                            data: b.data,
                            part: b.part
                        })
                    }
                if (!J) {
                    w = b.data;
                    var C = D.getData3dUI(w);
                    if (b.ui = C, p = C.interactiveInfo, !p) return b;
                    if (J = D.intersectObject(N, w), !J) return
                }
                w.s(l) && w.s(l)(N, w, D), this.fire("data", l, N, w);
                var m, L = J.part;
                return "body" !== L && (m = w.s(L + ".image") || w.s("shape3d." + L + ".image")), m || (m = w.s("all.image") || w.s("shape3d.image")), p = "object" == typeof m ? p[m.uuid] : p[m], p && p.bodyInfo ? (b.part = "body", b.interactiveInfo = p, b.point = J.uv.multiply({
                    x: p.bodyInfo.rect.width,
                    y: p.bodyInfo.rect.height
                }), b.image = m, b.hits = this.handleImage("body", m, l, N, w, b.point, p.bodyInfo), b) : b
            },
            _handleLeaveOrMissing: function (F, w, c) {
                var y = "leave" === F ? this.currentInfo : this.downInfo;
                if (y) {
                    var X = y.interactiveInfo || y.ui.interactiveInfo;
                    if (X) {
                        var k, u, U = y.data;
                        if (this._is2d) {
                            if (u = this.gv.lp(w), "body" === y.part && X.bodyInfo) k = "body", "leave" === F ? this.handleLeaveImage(c, k, this.gv.getImage(U), w, U, u, X.bodyInfo) : this.handleMissingUpImage(k, this.gv.getImage(U), w, U, u, X.bodyInfo);
                            else if ("icons" === y.part && X._38o) {
                                var v = X._38o[y.name];
                                v && v[y.index] && (k = "icons|" + y.name + "|" + y.index, "leave" === F ? this.handleLeaveImage(c, k, y.icon, w, U, u, v[y.index]) : this.handleMissingUpImage(k, y.icon, w, U, u, v[y.index]))
                            }
                        } else {
                            if (!X.bodyInfo) return;
                            var K = this.gv.intersectObject(w, U);
                            u = K ? K.uv.multiply({
                                x: X.bodyInfo.rect.width,
                                y: X.bodyInfo.rect.height
                            }) : {
                                x: 1 / 0,
                                y: 1 / 0
                            }, "leave" === F ? this.handleLeaveImage(c, "body", y.image, w, U, u, X.bodyInfo) : this.handleMissingUpImage("body", y.image, w, U, u, X.bodyInfo)
                        }
                    }
                }
            },
            handleDownInfo: function (w, v) {
                if (this.downInfo) {
                    var c = this.downInfo,
                        C = this.gv,
                        B = c.interactiveInfo || c.ui.interactiveInfo;
                    if (B) {
                        var u, V = c.data;
                        if (V.s(w) && V.s(w)(v, V, C), this.fire("data", w, v, V), this._is2d) {
                            var S = C.lp(v);
                            if ("body" === c.part && B.bodyInfo) u = "body", this.handleDownInfoImage(u, C.getImage(V), w, v, V, S, B.bodyInfo);
                            else if ("icons" === c.part && B._38o) {
                                var Q = B._38o[c.name];
                                Q && Q[c.index] && (u = "icons|" + c.name + "|" + c.index, this.handleDownInfoImage(u, c.icon, w, v, V, S, Q[c.index]))
                            }
                        } else {
                            if (!B.bodyInfo) return;
                            var z = C.intersectObject(v, V);
                            if (!z) return;
                            S = z.uv.multiply({
                                x: B.bodyInfo.rect.width,
                                y: B.bodyInfo.rect.height
                            }), this.handleDownInfoImage("body", c.image, w, v, V, S, B.bodyInfo)
                        }
                    }
                }
            },
            fire: function (G, W, t, H, l, Y, v, O) {
                this.gv.fi({
                    kind: W,
                    type: G,
                    event: t,
                    data: H,
                    image: l,
                    comp: Y,
                    view: this.gv,
                    point: v,
                    width: O ? O.width : p,
                    height: O ? O.height : p
                })
            },
            handleImage: function (A, v, T, f, t, P, F) {
                var J = {};
                if (v && (v = Qn(v))) {
                    var $ = this.gv,
                        W = F.rect,
                        I = this.convertPoint(P, F);
                    I.inRect && (v[T] && v[T](f, t, $, I, W.width, W.height), this.fire("image", T, f, t, v, p, I, W), J[A + "|image"] = {
                        target: v,
                        type: "image",
                        image: v,
                        data: t,
                        event: f,
                        point: I,
                        width: W.width,
                        height: W.height
                    });
                    for (var _ = F.compInfos, m = v, Q = _.length - 1; Q >= 0; Q--) {
                        var q = _[Q],
                            w = q.comp;
                        I = this.convertPoint(P, q, m, w, $, t), I.inRect && (W = q.rect, w[T] && w[T](f, t, $, I, W.width, W.height), this.fire("comp", T, f, t, v, w, I, W), (v = W.image) && (v[T] && v[T](f, t, $, I, W.width, W.height), this.fire("image", T, f, t, v, p, I, W)), J[A + "|" + Q] = {
                            target: w,
                            type: "comp",
                            comp: w,
                            image: v,
                            data: t,
                            event: f,
                            point: I,
                            width: W.width,
                            height: W.height
                        }, v && (J[A + "|" + Q + "|image"] = {
                            target: v,
                            type: "image",
                            image: v,
                            data: t,
                            event: f,
                            point: I,
                            width: W.width,
                            height: W.height
                        }))
                    }
                }
                return J
            },
            handleLeave: function (p, V) {
                return this._handleLeaveOrMissing("leave", p, V)
            },
            handleMissingUp: function (K) {
                return this._handleLeaveOrMissing("missing", K)
            },
            handleLeaveImage: function (B, T, r, h, a, i, Y) {
                if (r && (r = Qn(r))) {
                    var o = this.gv,
                        w = Y.rect,
                        c = this.convertPoint(i, Y);
                    B === T + "|image" && (r.onLeave && r.onLeave(h, a, o, c, w.width, w.height), this.fire("image", "onLeave", h, a, r, p, c, w));
                    for (var k = Y.compInfos, q = r, V = k.length - 1; V >= 0; V--) {
                        var M = k[V],
                            E = M.comp;
                        c = this.convertPoint(i, M, q, E, o, a), w = M.rect, B === T + "|" + V && (E.onLeave && E.onLeave(h, a, o, c, w.width, w.height), this.fire("comp", "onLeave", h, a, r, E, c, w)), (r = w.image) && B === T + "|" + V + "|image" && (r.onLeave && r.onLeave(h, a, o, c, w.width, w.height), this.fire("image", "onLeave", h, a, r, p, c, w))
                    }
                }
            },
            handleMissingUpImage: function (z, k, l, K, M, P) {
                var G = "onUp",
                    O = this.downInfo.hits;
                if (O && k && (k = Qn(k))) {
                    var Y = this.gv,
                        r = P.rect,
                        C = this.convertPoint(M, P);
                    !C.inRect && O[z + "|image"] && (k[G] && k[G](l, K, Y, C, r.width, r.height), this.fire("image", G, l, K, k, p, C, r));
                    for (var Z = P.compInfos, a = k, y = Z.length - 1; y >= 0; y--) {
                        var w = Z[y],
                            $ = w.comp;
                        C = this.convertPoint(M, w, a, $, Y, K), C.inRect || (r = w.rect, O[z + "|" + y] && ($[G] && $[G](l, K, Y, C, r.width, r.height), this.fire("comp", G, l, K, k, $, C, r)), (k = r.image) && O[z + "|" + y + "|image"] && (k[G] && k[G](l, K, Y, C, r.width, r.height), this.fire("image", G, l, K, k, p, C, r)))
                    }
                }
            },
            handleDownInfoImage: function (C, J, k, Z, i, H, w) {
                var g = this.downInfo.hits;
                if (g && J && (J = Qn(J))) {
                    var Q = this.gv,
                        O = w.rect,
                        l = this.convertPoint(H, w);
                    g[C + "|image"] && (J[k] && J[k](Z, i, Q, l, O.width, O.height), this.fire("image", k, Z, i, J, p, l, O));
                    for (var K = w.compInfos, S = J, D = K.length - 1; D >= 0; D--) {
                        var T = K[D],
                            X = T.comp;
                        l = this.convertPoint(H, T, S, X, Q, i), O = T.rect, g[C + "|" + D] && (X[k] && X[k](Z, i, Q, l, O.width, O.height), this.fire("comp", k, Z, i, J, X, l, O)), (J = O.image) && g[C + "|" + D + "|image"] && (J[k] && J[k](Z, i, Q, l, O.width, O.height), this.fire("image", k, Z, i, J, p, l, O))
                    }
                }
            },
            initImageResource: function () {
                f.setImage("coreInteractorRayHitImage", {
                    width: 16,
                    height: 16,
                    comps: [{
                        type: "oval",
                        background: "rgb(255,0,0)",
                        borderWidth: 1,
                        borderColor: "rgb(250,120,120)",
                        opacity: .3,
                        rotation: -1.593,
                        rect: [.73315, .6933, 14.5337, 14.61341]
                    }, {
                        type: "oval",
                        background: "rgb(255,0,0)",
                        borderWidth: 1,
                        borderColor: "rgb(250,120,120)",
                        rotation: -1.593,
                        rect: [3.56695, 3.75073, 8.8661, 8.49856]
                    }]
                })
            },
            convertPoint: function (m, N, r, B, e, $) {
                var t = N.rect,
                    S = N.matrix.applyInverse(m).sub(t),
                    X = S.x >= 0 && S.y >= 0 && S.x <= t.width && S.y <= t.height;
                if (!X) return S;
                if (B && ze(B.pixelPerfect, $, e)) {
                    var t, C = 1;
                    this._is2d ? (C = e.getZoom(), t = af(m.x, m.y, p, C)) : t = af(m.x, m.y);
                    var G = !1,
                        U = t.x,
                        K = t.y,
                        L = t.width,
                        z = t.height,
                        R = f.hitMaxArea,
                        u = L * z * C * C;
                    if (u > R) {
                        var P = Math.sqrt(R / u);
                        C *= P
                    }
                    L *= C, z *= C, 2 > L && (L = 2), 2 > z && (z = 2), U *= C, K *= C;
                    var d = Qj(L, z),
                        E = new yg(0, -U, -K, C, C);
                    E.append(N.matrix), e._drawForChecking = !0, B.transform = E;
                    var Y = r.comps;
                    r.comps = [B], wp(d, r, 0, 0, L, z, $, self), r.comps = Y, delete B.transform, e._drawForChecking = !1;
                    try {
                        for (var A = 0, H = d.getImageData(0, 0, L, z).data; A < H.length; A += 4)
                            if (0 !== H[A + 3]) {
                                G = !0;
                                break
                            }
                        d.restore()
                    } catch (b) {
                        op = h, G = !1
                    }
                    S.inRect = G
                } else S.inRect = !0;
                return S
            }
        });
        var Kk = zj.DefaultInteractor = function (q) {
            cj(Kk, this, [q])
        };
        kp("DefaultInteractor", ar, {
            handle_mousedown: function (O) {
                Bl(O);
                var q = this,
                    F = q.gv,
                    n = F.getDataAt(O);
                !F.setFocus(O) || F._editing || F._scrolling || (bo(O) ? F.handleDoubleClick(O, n) : F.handleClick(O, n), !Bo() && n && (F.isMovable(n) || F.isInteractive(n)) || !F.isPannable() || !Bf(O) || Ab(O) || (q._tx = F.tx(), q._ty = F.ty(), q.startDragging(O)))
            },
            handleWindowMouseUp: function (d) {
                var N = this,
                    O = N.gv;
                O._panning && (delete O._panning, O.onPanEnded(), N.fi({
                    kind: "endPan",
                    event: d
                })), delete N._tx, delete N._ty, N.clearDragging()
            },
            handle_mousemove: function (k) {
                var J = this,
                    P = J.gv;
                J._hoverTimer && (I(J._hoverTimer), delete J._hoverTimer), J._hoverTimer = q(function () {
                    J.fi({
                        kind: "hover",
                        event: k
                    }), I(J._hoverTimer), delete J._hoverTimer
                }, P.getHoverDelay() || f.hoverDelay)
            },
            handle_touchmove: function (O) {
                this.handle_mousemove(O)
            },
            handleWindowMouseMove: function (M) {
                var v = this,
                    d = v.gv,
                    j = v._lastClientPoint;
                v.fi({
                    kind: d._panning ? "betweenPan" : "beginPan",
                    event: M
                }), d._panning = 1, d.setTranslate(v._tx + M.clientX - j.x, v._ty + M.clientY - j.y)
            },
            handle_mousewheel: function (s) {
                this.gv.handleScroll(s, s.wheelDelta)
            },
            handle_DOMMouseScroll: function (Y) {
                2 === Y.axis && this.gv.handleScroll(Y, -Y.detail)
            },
            handle_keydown: function (W) {
                this.gv.handleKeyDown(W)
            }
        });
        var Rk = zj.SelectInteractor = function (t) {
            cj(Rk, this, [t])
        };
        kp("SelectInteractor", ar, {
            _42: function () {
                var C = this,
                    k = C.gv,
                    h = k.getZoom(),
                    J = C.mark,
                    m = C.div;
                m || (m = C.div = rq(), or(C.getView(), m));
                var l = {};
                l.x = J.x * h + k.tx(), l.y = J.y * h + k.ty(), l.width = J.width * h, l.height = J.height * h, Qh(m, l), this.intersects() ? (m.style.border = "", m.style.background = k.getRectSelectBackground()) : (m.style.background = "", m.style.border = "1px solid " + k.getRectSelectBorderColor())
            },
            handle_mousedown: function (l) {
                var i = this,
                    n = i.gv;
                if (i._57I = h, i.pendingClickThrough = h, !(n._editing || n._scrolling || Bo())) {
                    var k = n.getDataAt(l),
                        o = n.sm();
                    k ? Ab(l) ? o.co(k) ? o.rs(k) : o.as(k) : o.co(k) ? k instanceof tf && k.isClickThroughEnabled() && Bf(l) && (i.pendingClickThrough = Fc(l)) : o.ss(k) : Ab(l) || !n.isPannable() ? Bf(l) && (Ab(l) || o.cs(), n.isRectSelectable() && (i.startDragging(l), n._77O = 1)) : Bf(l) && (i._57I = Fc(l))
                }
            },
            handle_mouseup: function (L) {
                var X = this,
                    D = X.gv,
                    t = X._57I;
                if (t && (Me(t, Fc(L)) <= 1 && D.sm().cs(), X._57I = h), X.pendingClickThrough) {
                    if (Me(X.pendingClickThrough, Fc(L)) <= 1) {
                        var b = D.getDataAt(L);
                        if (b instanceof tf && b.isClickThroughEnabled()) {
                            var n = D.getDataAt(L, function (h) {
                                var K = h.getParent() === b && D.isSelectable(h, !0);
                                return K
                            });
                            n && (L.clickThrough = !0, D.sm().ss(n))
                        }
                    }
                    X.pendingClickThrough = h
                }
            },
            handleWindowMouseUp: function (T) {
                this.clear(T)
            },
            handleWindowMouseMove: function (A) {
                var O = this,
                    Q = O.gv;
                O._logicalPoint = Q.lp(A), O.mark ? (O.fi({
                    kind: "betweenRectSelect",
                    event: A
                }), Q.isPannable() && O.autoScroll(A), O.redraw()) : O.fi({
                    kind: "beginRectSelect",
                    event: A
                }), O.mark = Vj(O._lastLogicalPoint, O._logicalPoint), O.redraw()
            },
            intersects: function () {
                var u = this,
                    C = u._lastLogicalPoint,
                    D = u._logicalPoint;
                return C.x > D.x || C.y > D.y
            },
            clear: function (u) {
                var l = this,
                    z = l.gv,
                    S = l.mark;
                if (l._57I = h, l.pendingClickThrough = h, l._lastLogicalPoint) {
                    if (S) {
                        if (0 !== S.width && 0 !== S.height) {
                            var x = z.getDatasInRect(S, l.intersects());
                            if (!x.isEmpty()) {
                                var Y = z.sm(),
                                    p = Y.toSelection();
                                x.each(function (c) {
                                    Y.co(c) ? p.remove(c) : p.add(c)
                                }), Y.ss(p)
                            }
                        }
                        Kh(l.div), delete l.div, delete l.mark, l.redraw(), l.fi({
                            kind: "endRectSelect",
                            event: u
                        }), z.onRectSelectEnded()
                    }
                    l.clearDragging(), delete z._77O
                }
            },
            redraw: function () {
                var t = this;
                t._draw || (t._draw = 1, q(function () {
                    t.mark && t._42(), delete t._draw
                }, 16))
            }
        });
        var qp = zj.MoveInteractor = function (A) {
            cj(qp, this, [A])
        };
        kp("MoveInteractor", ar, {
            handle_mousedown: function (s) {
                var L = this,
                    v = L.gv;
                if (Bf(s) && !v._editing && !v._scrolling && !Bo()) {
                    var e = v.getSelectedDataAt(s);
                    !e || v.isInteractive(e) && !v.isMovable(e) ? v._focusData = h : (L._data = e, v.handleMouseDown && v.handleMouseDown(s, e), L.startDragging(s), v.isMovable(e) && (v._moving = 1))
                }
            },
            handleWindowMouseUp: function (t) {
                var n = this,
                    F = n.gv;
                F.handleMouseUp && F.handleMouseUp(t, n._data), n.clear(t)
            },
            handleWindowMouseMove: function (Z) {
                var H = this,
                    g = H._data,
                    L = H.gv;
                if ((!L._93O || !L._93O(Z, g)) && L._moving) {
                    H._logicalPoint || H.fi({
                        kind: "prepareMove",
                        event: Z
                    });
                    var J = H._logicalPoint ? "betweenMove" : "beginMove",
                        o = {
                            kind: J,
                            event: Z
                        },
                        w = H._logicalPoint = L.lp(Z);
                    "beginMove" !== J || H._alreadyBeginTransaction || (H._alreadyBeginTransaction = !0, L.getDataModel().beginTransaction());
                    var M = H._calcShift(J, Z),
                        s = M.x,
                        x = M.y,
                        V = H.gv.getMoveMode(Z, g);
                    V && ("x" === V ? x = 0 : "y" === V ? s = 0 : "xy" !== V && (s = x = 0)), L.moveSelection(s, x), H._lastLogicalPoint = w, H.autoScroll(Z), H.fi(o)
                }
            },
            _calcShift: function () {
                var U = this,
                    G = U._logicalPoint,
                    E = U._lastLogicalPoint,
                    n = G.x - E.x,
                    H = G.y - E.y;
                return {
                    x: n,
                    y: H
                }
            },
            clear: function (z) {
                var S = this,
                    r = S.gv;
                S._lastLogicalPoint && (S._lastLogicalPoint = S._data = r._moving = h, S._logicalPoint && (S.fi({
                    kind: "endMove",
                    event: z
                }), r.onMoveEnded()), S.clearDragging()), S._alreadyBeginTransaction && (S._alreadyBeginTransaction = !1, r.getDataModel().endTransaction())
            }
        });
        var yp = zj.ScrollBarInteractor = function (l) {
            cj(yp, this, [l])
        };
        kp("ScrollBarInteractor", ar, {
            _41o: function () {
                return this.gv.getViewRect().height < this.gv.getScrollRect().height
            },
            _40o: function () {
                return this.gv.getViewRect().width < this.gv.getScrollRect().width
            },
            isV: function (H) {
                var m = this.gv.getViewRect();
                return this._41o() && (m.x + m.width - this.gv.lp(H).x) * this.gv.getZoom() < ys
            },
            isH: function (e) {
                var H = this.gv.getViewRect();
                return this._40o() && (H.y + H.height - this.gv.lp(e).y) * this.gv.getZoom() < ys
            },
            handle_mousemove: function (V) {
                this.handle_touchmove(V)
            },
            handle_touchmove: function (b) {
                if (!wh && Bf(b) && this.gv.isScrollBarVisible()) {
                    var F = this,
                        H = F.isV(b),
                        Z = F.isH(b);
                    (H || Z) && F.gv.showScrollBar(), F.gv._scrolling = H || Z
                }
            },
            handleWindowMouseUp: function (Q) {
                this.handleWindowTouchEnd(Q)
            },
            handleWindowTouchEnd: function (P) {
                this._state = this._cp = this._tx = this._ty = this.gv._scrolling = h, this.fi({
                    kind: "endScroll",
                    event: P
                })
            },
            handle_mousedown: function (C) {
                this.handle_touchstart(C)
            },
            handle_touchstart: function (R) {
                var J = this;
                if (J.gv.setFocus(R), Bl(R), J.handle_touchmove(R), !(ni(R) > 1) && J.gv._scrolling && J.gv.isScrollBarVisible()) {
                    J._cp = Fc(R), J._tx = J.gv.tx(), J._ty = J.gv.ty();
                    var y = J.isV(R);
                    J._state = y ? "vScroll" : "hScroll", gn(J, R), J.fi({
                        kind: "beginScroll",
                        event: R
                    })
                }
            },
            handleWindowMouseMove: function (S) {
                this.handleWindowTouchMove(S)
            },
            handleWindowTouchMove: function (D) {
                var J = Fc(D),
                    z = this.gv.getViewRect(),
                    u = this.gv.getScrollRect();
                "vScroll" === this._state ? this.gv.ty(this._ty + (this._cp.y - J.y) * u.height / z.height) : "hScroll" === this._state && this.gv.tx(this._tx + (this._cp.x - J.x) * u.width / z.width), this.fi({
                    kind: "betweenScroll",
                    event: D
                })
            }
        });
        var _k = zj.TouchInteractor = function (Y, A) {
            A = A || {}, A.selectable === p && (A.selectable = !0), A.movable === p && (A.movable = !0), A.pannable === p && (A.pannable = !0), A.pinchable === p && (A.pinchable = !0), A.editable === p && (A.editable = !0), this.params = A, cj(_k, this, [Y])
        };
        kp("TouchInteractor", ar, {
            ms_edit: 1,
            setUp: function () {
                var Y = this;
                _k.superClass.setUp.call(Y), ah && Y.params.editable && Y.gv.setEditInteractor(Y)
            },
            tearDown: function () {
                var w = this;
                _k.superClass.tearDown.call(w), ah && w.params.editable && w.gv.setEditInteractor(h)
            },
            clear: function (H) {
                var x = this,
                    Z = x.gv;
                Z._moving && (x.fi({
                    kind: "endMove",
                    event: H
                }), delete Z._moving, Z.onMoveEnded(), Z.dm().endTransaction()), Z._panning && (x.fi({
                    kind: "endPan",
                    event: H
                }), delete Z._panning, Z.onPanEnded()), Z._pinching && (x.fi({
                    kind: "endPinch",
                    event: H
                }), delete Z._pinching, Z.onPinchEnded()), Z._editing && (x._46O(H), x._77I = x._node = x._edge = x._shape = x._rect = x._89I = x._index = Z._editing = h), x._moving = x._panning = x._pinching = x._editing = x._57I = x._data = x._beginHistory = h, x.clearDragging()
            },
            handle_touchstart: function (j) {
                var S = this;
                if (!S.gv._editing) {
                    Bl(j), S._57I = h;
                    var s = S.params,
                        Y = S.gv,
                        I = Y.sm(),
                        N = Y.getDataAt(j),
                        D = ni(j);
                    if (1 === D) {
                        if (bo(j)) return Y.handleDoubleClick(j, N), void 0;
                        Y.handleClick(j, N), N && (Y.handleMouseDown && Y.handleMouseDown(j, N), S._data = N), s.selectable || (N = h), N ? (I.co(N) || I.ss(N), s.editable && Y.isEditable(N) && S._79I(j, N, !0) ? (S._editing = 1, S.startDragging(j)) : s.movable && Y.isMovable(N) && (S._moving = 1, S.startDragging(j))) : (S._57I = Fc(j), s.pannable && Y.isPannable() && (S._panning = 1, S.startDragging(j), S._translate = {
                            x: Y.tx(),
                            y: Y.ty()
                        }))
                    } else if (s.pinchable && 2 === D) {
                        S._pinching = 1, S.startDragging(j);
                        var w = Y.getView(),
                            b = Y.getZoom(),
                            $ = w.getBoundingClientRect(),
                            X = j.touches[0],
                            M = j.touches[1],
                            c = {
                                x: (X.clientX + M.clientX) / 2 - $.left,
                                y: (X.clientY + M.clientY) / 2 - $.top
                            };
                        c.x -= Y.tx(), c.y -= Y.ty(), c.x /= b, c.y /= b, S._p = c, S._d = ie(j)
                    }
                }
            },
            handle_touchend: function (C) {
                var S = this,
                    O = S.gv,
                    A = S._57I,
                    E = S._data;
                A && (Me(A, Fc(C)) <= 1 && O.sm().cs(), S._57I = h), E && O.handleMouseUp && O.handleMouseUp(C, E)
            },
            handleWindowTouchEnd: function (P) {
                this.clear(P)
            },
            handleWindowTouchMove: function (q) {
                var C = this,
                    T = C.gv,
                    y = ni(q);
                if (1 === y) {
                    if (C._editing && (C._beginHistory || (C._beginHistory = 1, T.dm().beginTransaction()), T._editing = 1, C._78I(q)), C._moving) C._beginHistory || (C._beginHistory = 1, T.dm().beginTransaction()), C.handleMove(q);
                    else if (C._panning) {
                        var b = Fc(q);
                        T.setTranslate(C._translate.x + b.x - C._lastClientPoint.x, C._translate.y + b.y - C._lastClientPoint.y), C.fi({
                            kind: T._panning ? "betweenPan" : "beginPan",
                            event: q
                        }), T._panning = 1
                    }
                } else if (2 === y && C._pinching) {
                    var d = ie(q);
                    T.handlePinch(C._p, d, C._d), C._d = d, C.fi({
                        kind: T._pinching ? "betweenPinch" : "beginPinch",
                        event: q
                    }), T._pinching = 1
                }
            },
            handleMove: function (b) {
                var m = this,
                    N = m.gv,
                    z = N.lp(b);
                N._93O && N._93O(b, m._data) || (N.moveSelection(z.x - m._lastLogicalPoint.x, z.y - m._lastLogicalPoint.y), m._lastLogicalPoint = z, m.autoScroll(b), m.fi({
                    kind: N._moving ? "betweenMove" : "beginMove",
                    event: b
                }), N._moving = 1)
            }
        });
        var k = d.ht,
            Sf = k.graph._editor = {
                Math: k.Math,
                Guide: {}
            };
        Sf.getStyle = function (z) {
            var k, X = Sf.StyleMap;
            return X && (k = X[z], k !== p) ? k : Sf.DefaultStyleMap[z]
        }, Sf.setStyle = function (p, F) {
            var Y = Sf.StyleMap;
            Y || (Y = Sf.StyleMap = {}), Y[p] = F
        }, Sf.inEdit = function (y) {
            return y._inXEdit === !0
        }, Sf.startEdit = function (G) {
            G._inXEdit = !0, Sf.Inject.doInject(G)
        }, Sf._46O = function (G) {
            G._inXEdit = !1, Sf.Inject.undoInject(G)
        }, Sf.toScreenPosition = function (L, x) {
            var e = L.tx(),
                Y = L.ty(),
                Q = L._zoom;
            return new Sf.Math.Vector2(x.x * Q + e, x.y * Q + Y)
        }, Sf.checkHit = function (y, V, s) {
            return y.distanceTo(V) < s ? !0 : !1
        }, Sf.toWorldPosition = function (P, g) {
            var W = P.tx(),
                D = P.ty(),
                V = P._zoom;
            return {
                x: (g.x - W) / V,
                y: (g.y - D) / V
            }
        }, Sf.setAntialias = function (K, Y) {
            for (var W, H = ["imageSmoothingEnabled", "webkitImageSmoothingEnabled", "mozImageSmoothingEnabled", "oImageSmoothingEnabled", "msImageSmoothingEnabled"], r = 0, N = H.length; N > r && (W = H[r], !(W in K)); r++);
            K[W], K[W] = Y
        }, Sf.getTargetCornersOnScreen = function (y, k) {
            if (!k) return null;
            var j, p = [];
            if (Jk(k, y)) {
                var S = Ad(y, k);
                j = [{
                    x: S.x,
                    y: S.y
                }, {
                    x: S.x + S.width,
                    y: S.y
                }, {
                    x: S.x + S.width,
                    y: S.y + S.height
                }, {
                    x: S.x,
                    y: S.y + S.height
                }]
            } else {
                if (!k.getCorners) return null;
                j = k.getCorners()
            }
            return j.forEach(function (C) {
                var g = Sf.toScreenPosition(y, C);
                p.push(g.x, g.y)
            }), p
        }, Sf.log = function () {};
        var Ur = Sf.Inject = {
            _modules: []
        };
        Ur.registAsModule = function ($, D) {
            var R = {},
                p = {};
            for (var b in $) {
                var C = D.prototype[b];
                R[b] = C
            }
            $.getBackup = function (D) {
                return R[D]
            }, $.getBackups = function () {
                return R
            }, p.doInject = function () {
                for (var Z in $) "getBackup" !== Z && (D.prototype[Z] = $[Z])
            }, p.undoInject = function () {
                for (var A in $) "getBackup" !== A && (D.prototype[A] = R[A])
            }, Ur._modules.push(p)
        }, Ur.doInject = function (g) {
            for (var m, b = Ur._modules, A = 0, d = b.length; d > A; A++) m = b[A], m.doInject(g)
        }, Ur.undoInject = function (x) {
            for (var O, C = Ur._modules, G = 0, M = C.length; M > G; G++) O = C[G], O.undoInject(x)
        };
        var ar = k.graph.EditInteractor = function (X) {
                var p = this,
                    q = b.createElement("canvas");
                q.className = "editCanvas", q.style.position = "absolute", p._styleMap = {}, p._canvas = q, p._context = q.getContext("2d"), ar.superClass.constructor.call(p, X), Sf.setAntialias(p._context, !1), p._subModules = [new Sf.Anchor(p), new Sf.RotateX(p), new Sf.Rect(p), new Sf.Curve(p), new Sf.MoveHelper(p)], p._gridGuide = new Sf.Guide.Grid(p), p._rectGuide = new Sf.Guide.Rect(p)
            },
            Yp = ar;
        k.Default.def(ar, k.graph.Interactor, {
            ms_edit: 1,
            ms_fire: 1
        }), x.defineProperties(ar.prototype, {
            editDetail: {
                get: function () {
                    var o = !!this._editDetail;
                    return o
                },
                set: function (P) {
                    var n = this,
                        Y = n._editDetail;
                    Y !== P && (n._editDetail = P, n.gv._editing = P, n.fp("editDetail", Y, P), n.fp("pointsEditingMode", Y, P), n.fi({
                        kind: P ? "beginEditPoints" : "endEditPoints"
                    }))
                }
            },
            gvEditing: {
                get: function () {
                    return this.gv._editing
                },
                set: function (F) {
                    (!this._editDetail || F) && (this.gv._editing = F, F || (this.editDetail = !1))
                }
            },
            editing: {
                get: function () {
                    return this._editing
                },
                set: function (Y) {
                    this._editing = Y, this.gvEditing = Y
                }
            },
            pointsEditingMode: {
                get: function () {
                    return this.editDetail
                },
                set: function (V) {
                    var D = this;
                    D.editDetail !== V && (V ? D._tryEnterEditDetailMode() : D._tryQuitEditDetailMode())
                }
            },
            gridEnabled: {
                get: function () {
                    var Z = this._gridEnabled;
                    if (!Z) return !1;
                    var o = this.gv;
                    return o ? !0 : !0
                },
                set: function (d) {
                    d !== this._gridEnabled && (this._gridEnabled = d, this._42())
                }
            },
            alignmentGuideEnabled: {
                get: function () {
                    return this._agEnabled
                },
                set: function (c) {
                    c !== this._agEnabled && (this._agEnabled = c, this._42())
                }
            },
            gridGuide: {
                get: function () {
                    return this._gridGuide
                }
            },
            rectGuide: {
                get: function () {
                    return this._rectGuide
                }
            }
        }), ar.prototype.getSubModule = function (k) {
            var O, n, x, $ = this._subModules;
            for (n = 0, x = $.length; x > n; n++)
                if (O = $[n], O.catalog === k) return O
        }, ar.prototype.invokeSubModule = function (o, K) {
            var a = this,
                U = a._subModules;
            if (U)
                for (var C, Z, k, N = Array.prototype.slice.call(arguments, 2), m = 0, h = U.length; h > m; m++)
                    if (C = U[m], Z = C[o], Z && (k = Z.apply(C, N), k != p && K)) return C
        }, ar.prototype.invokeSubModuleInverse = function (K, y) {
            var t = this,
                $ = t._subModules;
            if ($)
                for (var W, Z, M, a = Array.prototype.slice.call(arguments, 2), e = $.length - 1; e >= 0; e--)
                    if (W = $[e], Z = W[K], Z && (M = Z.apply(W, a), M != p && y)) return W
        }, ar.prototype.setUp = function () {
            Sf.log("setUp");
            var K = this,
                W = K.gv,
                M = W.getView(),
                B = K._canvas;
            ar.superClass.setUp.call(K), W.setEditInteractor(K), W._79O ? M.insertBefore(B, W._79O) : M.appendChild(B), Sf.startEdit(W), K.invokeSubModule("setUp"), W.dm().mm(K._onDataModelChanged, K), W.dm().md(K._onDataPropertyChanged, K)
        }, ar.prototype.tearDown = function () {
            Sf.log("tearDown");
            var U = this,
                L = U.gv,
                W = L.getView();
            U._resetCustomCursorStyle(), ar.superClass.tearDown.call(U), L.dm().umm(U._onDataModelChanged, U), L.dm().umd(U._onDataPropertyChanged, U), L.setEditInteractor(null), W.removeChild(U._canvas), U._drawTimer && (I(U._drawTimer), U._drawTimer = null), Sf._46O(L), U.invokeSubModule("tearDown")
        }, ar.prototype._onDataModelChanged = function (Z) {
            var F = this;
            ("clear" === Z.kind || "remove" === Z.kind && F.editDetail && Z.data === F.getSubModule("Curve").target) && (F.editDetail = !1, F._42())
        }, ar.prototype._onDataPropertyChanged = function (e) {
            var J = this;
            if (J.editDetail) {
                var b = J.getSubModule("Curve"),
                    A = e.data;
                A === b.target && (A._writing || b._handleDataChanged())
            }
        }, ar.prototype.clear = function () {
            Sf.log("clear")
        }, ar.prototype.redraw = function () {
            this._42()
        }, ar.prototype._42 = function () {
            var o = this;
            o._drawTimer || (o._drawTimer = q(function () {
                o._drawTimer = null, o.drawImpl()
            }, 0))
        }, ar.prototype.drawImpl = function () {
            var p;
            for (p in {
                _42: !0
            }) break;
            return function () {
                var O = this,
                    m = O._canvas,
                    B = O.gv,
                    X = B.getWidth(),
                    J = B.getHeight(),
                    E = O._context,
                    a = k.Default.getInternal();
                (m.width !== X || m.height !== J) && a.setCanvas(m, X, J), E.clearRect(0, 0, m.width, m.height);
                var n = O._getValidSelection();
                E.save();
                var r = k.Default.devicePixelRatio;
                E.scale(r, r), O._gridGuide._42(), O.invokeSubModuleInverse(p, !1, E, B, n), O._rectGuide._42(), E.restore()
            }
        }(), ar.prototype._getValidSelection = function () {
            var J = this,
                r = J.gv,
                F = r.sm().getSelection(),
                K = [];
            return F.each(function (i) {
                r.isVisible(i) && r.isEditable(i) && K.push(i)
            }), K
        }, ar.prototype.handle_touchmove = function (q) {
            return this.handle_mousemove(q)
        }, ar.prototype.handle_mousemove = function (D) {
            if (!k.Default.isDragging()) {
                var X = this;
                (X.editDetail || !Bo()) && (X.gvEditing = !1, X._checkEdit(D) && (X.gvEditing = !0))
            }
        }, ar.prototype.handle_touchstart = function (j) {
            return this.handle_mousedown(j)
        }, ar.prototype.handle_mousedown = function (P) {
            Bl(P);
            var l = this;
            if (l.editDetail || !Bo()) {
                if (bo(P) && !P.clickThrough) {
                    if (l.editDetail) {
                        if (l._tryQuitEditDetailMode(P)) return
                    } else if (l._tryEnterEditDetailMode()) return;
                    l.gv.dm().beginTransaction();
                    var w = l.invokeSubModule("handleDoubleClick", !0, P);
                    if (l.gv.dm().endTransaction(), w) return
                }
                var C = l._checkEdit(P);
                C && (l._downPosition = l._getLogicalPoint(P), l.gv.dm().beginTransaction(), C.startEdit(l, P), l.editing = !0)
            }
        }, ar.prototype._checkEdit = function (Y) {
            var d = this,
                t = d.gv,
                H = d._getLogicalPoint(Y),
                j = d.invokeSubModule("check", !0, t, Y, H) || null;
            return d._editMod = j, j
        }, ar.prototype.handleWindowTouchMove = function (O) {
            return this.handleWindowMouseMove(O)
        }, ar.prototype.handleWindowMouseMove = function (K) {
            var L = this,
                X = L._downPosition;
            if (X) {
                var Z = L._getLogicalPoint(K);
                if (Z.distanceTo(X) < L.getStyle("moveSensitivity")) return;
                delete L._downPosition
            }
            var b = L._editMod;
            b && b.handleEdit(L.gv, K)
        }, ar.prototype._getLogicalPoint = function (b) {
            var K = this,
                o = k.Default.getLogicalPoint(b, K._canvas);
            return new Sf.Math.Vector2(o)
        }, ar.prototype.handleWindowTouchEnd = function (K) {
            return this.handleWindowMouseUp(K)
        }, ar.prototype.handleWindowMouseUp = function () {
            var A;
            for (A in {
                _46O: !0
            }) break;
            return function ($) {
                var j = this;
                j.editing = !1, j.setCursor("default"), j.invokeSubModule(A, !1, $), j._42(), j.gv.dm().endTransaction()
            }
        }(), ar.prototype.handle_mousewheel = function (H) {
            var A = this;
            Bl(H), A.invokeSubModule("preHandleScroll", !0) || A.gv.handleScroll(H, H.wheelDelta)
        }, ar.prototype.handleDelete = function () {
            var n = this;
            if (!n.editDetail) {
                n.gv.dm().beginTransaction();
                var J = n.invokeSubModule("handleNormalStateDelete", !0);
                return n.gv.dm().endTransaction(), J || n.gv.removeSelection(), void 0
            }
            n.gv.dm().beginTransaction(), n.invokeSubModule("handleDelete", !0), n.gv.dm().endTransaction(), n._42()
        }, ar.prototype.handle_keydown = function (t) {
            var c = this;
            if ((t.metaKey || t.ctrlKey) && c._42(), Bo(t) && !c.editing) return c.gvEditing = !1, c.setCursor("default"), c._42(), void 0;
            var D = gd(t);
            return c.editDetail ? ((D || fm(t)) && (c.editDetail = !1, c._42()), c.gv.dm().beginTransaction(), c.invokeSubModule("handle_keydown", !0, t), c.gv.dm().endTransaction(), void 0) : (c.gv.dm().beginTransaction(), c.invokeSubModule("handleNormalStateKeyDown", !0, t), c.gv.dm().endTransaction(), D && c._tryEnterEditDetailMode(), void 0)
        }, ar.prototype.handle_keyup = function (c) {
            this.gv.dm().beginTransaction(), this.invokeSubModule("handle_keyup", !0, c), this.gv.dm().endTransaction()
        }, ar.prototype._tryEnterEditDetailMode = function () {
            var I = this;
            return !I.editDetail && I.invokeSubModule("canEnterEditDetailMode", !0) && 1 === I._getValidSelection().length ? (I.editDetail = !0, I._42(), !0) : void 0
        }, ar.prototype._tryQuitEditDetailMode = function (N) {
            var C = this;
            return C.editDetail ? !N || C.invokeSubModule("canQuitEditDetailMode", !0, N) ? (C.editDetail = !1, C._42(), !0) : !1 : !1
        }, ar.prototype.setStyle = function (S, h, D) {
            var m = this;
            D ? Sf.setStyle(S, h) : m._styleMap[S] = h, m.fp("styleChanged", null, {
                key: S,
                value: h,
                base: D
            }), m._42()
        }, ar.prototype.getStyle = function (P) {
            var e = this,
                s = e._styleMap[P];
            return s !== p ? s : Sf.getStyle(P)
        }, ar.prototype.setCursor = function (Q) {
            this._resetCustomCursorStyle(), k.graph.EditInteractor.superClass.setCursor.call(this, Q)
        }, ar.prototype._resetCustomCursorStyle = function () {
            var P = this;
            if (P._customStyle) {
                var h = this.gv.getView();
                h.classList && h.classList.remove && h.classList.remove(P._customStyle), P._customStyle = null
            }
        }, ar.prototype._setRotateCursor = function (T) {
            var i = this,
                k = i._cursorFactory;
            k || (k = i._cursorFactory = new Sf.CursorFactory(i));
            var M = k.getRotateCursor(T),
                _ = i.gv.getView();
            i._resetCustomCursorStyle(), i._customStyle = M, _.classList && _.classList.add && _.classList.add(M)
        };
        var gb = Sf.Group = function (v) {
            var K = this;
            K._entities = v, K._64O = 0, K._position = {
                x: 0,
                y: 0
            }, K._scale = {
                x: 1,
                y: 1
            }, K._anchor = {
                x: .5,
                y: .5
            }, K._anchor2 = {
                x: .5,
                y: .5
            }
        };
        gb.prototype = {}, gb.prototype.constructor = gb;
        var Tk = null;
        gb.findOrCreateGroup = function (e) {
            if (Tk && Tk.checkIsMe(e)) return Tk;
            var u = new Sf.Group(e);
            return u.getKeyOb() ? (Tk = u, u) : void 0
        }, gb.prototype.checkIsMe = function (V) {
            var H = this._entities;
            if (H.length !== V.length) return !1;
            var A, Q = {},
                t = V.length;
            for (A = 0; t > A; A++) Q[V[A]._id] = !0;
            for (A = 0; t > A; A++)
                if (!Q[H[A]._id]) return !1;
            return !0
        }, gb.prototype.getRotation = function () {
            return this._64O
        }, gb.prototype.getPosition = function () {
            return this._position
        }, gb.prototype.getAnchor = function () {
            return this._anchor
        }, gb.prototype.getWidth = function () {
            return this._width
        }, gb.prototype.getScale = function () {
            return this._scale
        }, gb.prototype.getSize = function () {
            return {
                width: this._width,
                height: this._height
            }
        }, gb.prototype.getHeight = function () {
            return this._height
        }, gb.prototype.getKeyOb = function () {
            for (var i = this._entities, v = i.length - 1; v >= 0; v--) {
                var P = i[v];
                if (this.isNode(P)) return P
            }
        }, gb.prototype.getAnchor2 = function () {
            var d = this,
                H = d.rotateCenter;
            if (H) return H;
            var W = d.getKeyOb();
            if (!W) return d._anchor;
            var X = d._anchor2,
                J = W.getMatrix();
            return J.tf({
                x: W.getWidth() * (X.x - W.getAnchor().x),
                y: W.getHeight() * (X.y - W.getAnchor().y)
            })
        }, gb.prototype.setAnchor2 = function (I, Z) {
            var E = this,
                Y = E.getKeyOb();
            if (Y) {
                var e, y = Y.getMatrix();
                e = "number" == typeof I ? {
                    x: I,
                    y: Z
                } : I;
                var N = y.tfi(e);
                E._anchor2 = {
                    x: Y.getAnchor().x + N.x / Y.getWidth(),
                    y: Y.getAnchor().y + N.y / Y.getHeight()
                }
            }
        }, gb.prototype.setRotation = function () {}, gb.prototype.beginRotate = function (u) {
            this.rotateCenter = u.pos, this.rotateMode = u.groupRotateMode
        }, gb.prototype.endRotate = function () {
            delete this.rotateCenter, delete this.rotateMode
        }, gb.prototype.addRotation = function (E, k) {
            return "batch" === k ? this._addRotationInBatchMode(E) : "block" === k ? this._addRotationInBlockMode(E) : void 0
        }, gb.prototype._addRotationInBlockMode = function (h) {
            var I = this,
                i = I.rotateCenter || I.getPosition();
            I._entities.forEach(function (z) {
                if (I.isNode(z)) {
                    var d = z.getMatrix();
                    d.translate(-i.x, -i.y), d.rotate(h), d.translate(i.x, i.y);
                    var K = Math.sign(z.getScale().x);
                    z.setRotation(H(d.b * K, d.a * K)), z.setPosition(d.tx, d.ty)
                }
            })
        }, gb.prototype._addRotationInBatchMode = function (O) {
            var g = this,
                B = g._anchor2;
            g._entities.forEach(function (Q) {
                if (g.isNode(Q)) {
                    var I = Q.getAnchor(),
                        c = Q.getMatrix(),
                        e = c.tf({
                            x: Q.getWidth() * (B.x - I.x),
                            y: Q.getHeight() * (B.y - I.y)
                        }),
                        $ = new Sf.Math.Matrix2d;
                    $.set(c.a, c.b, c.c, c.d, c.tx, c.ty), $.translate(-e.x, -e.y), $.rotate(O), $.translate(e.x, e.y);
                    var t = Math.sign(Q.getScale().x);
                    Q.setRotation(H($.b * t, $.a * t)), Q.setPosition($.tx, $.ty)
                }
            })
        }, gb.prototype.setPosition = function (N) {
            var x, X, n, U, _ = this,
                W = _._position,
                K = N.x - W.x,
                d = N.y - W.y,
                T = _._entities;
            for (X = 0, n = T.length; n > X; X++) x = T[X], Cc(x) && (U = x.getPosition(), x.setPosition(U.x + K, U.y + d));
            _._position = N
        }, gb.prototype.setScale = function (V, K) {
            var U = this,
                x = V / U._scale.x,
                b = K / U._scale.y;
            U._adjustChildScaleOrSize(x, b, "size"), U._scale = {
                x: V,
                y: K
            }
        }, gb.prototype.getRect = function () {
            var L = this,
                _ = L._position,
                P = L._width,
                T = L._height;
            return {
                x: _.x - P / 2,
                y: _.y - T / 2,
                width: P,
                height: T
            }
        }, gb.prototype.setSize = function (B, w) {
            var y = this,
                B = Math.max(1, B),
                w = Math.max(1, w),
                v = B / y._width,
                s = w / y._height;
            y._adjustChildScaleOrSize(v, s, "size"), y._width = B, y._height = w
        }, gb.prototype._adjustChildScaleOrSize = function (P, N, b) {
            var E, I, A, l, K, L, $, g, W, U, c, J, r, X, T = this,
                O = T._position,
                q = T._entities,
                e = new Sf.Math.Matrix2d;
            for (I = 0, A = q.length; A > I; I++)
                if (E = q[I], T.isNode(E)) {
                    if (l = E.getPosition(), K = E.getRotation(), L = E.getWidth(), $ = E.getHeight(), g = E.getScale(), c = g.x * L, J = g.y * $, e.identity().scale(c, J).rotate(K).translate(l.x, l.y).translate(-O.x, -O.y).rotate(-T._64O), K = H(e.b * Math.sign(c), e.a * Math.sign(c)), e.scale(P, N), W = Math.cos(K), U = Math.sin(K), Math.abs(W) < .001 ? (r = e.b / U, X = -e.c / U) : (r = e.a / W, X = e.d / W), "scale" === b) E.setScale(r / L, X / $);
                    else if ("size" === b) {
                        var m = r / g.x,
                            t = X / g.y;
                        E.setScale(Ir(r) * Math.abs(g.x), Ir(X) * Math.abs(g.y)), E.setSize(Math.max(.1, Math.abs(m)), Math.max(.1, Math.abs(t)))
                    }
                    e.rotate(T._64O).translate(O.x, O.y), E.setPosition(e.tx, e.ty)
                }
        }, gb.prototype.getMatrix = function () {
            var j = this,
                o = j._position,
                G = k.Default.getInternal(),
                c = j._scale;
            return new G.Mat(j._64O, o.x, o.y, c.x, c.y)
        }, gb.prototype.toGlobal = function (i) {
            return this.getMatrix().tf(i)
        }, gb.prototype.getCorners = function () {
            var e = this,
                T = e._width,
                $ = e._height,
                C = e._anchor,
                P = -T * C.x,
                O = -$ * C.y,
                i = e.getMatrix();
            return [i.tf(P, O), i.tf(P, O + $), i.tf(P + T, O + $), i.tf(P + T, O)]
        }, gb.prototype.calcInfo = function () {
            var q, M, k, K, n, d, u = this,
                I = [],
                e = u._entities,
                G = u._64O;
            for (K = 0, n = e.length; n > K; K++) d = e[K], u.isNode(d) && d.getCorners && I.push.apply(I, d.getCorners());
            if (I.length) {
                var i = Math.cos(-G),
                    t = Math.sin(-G),
                    R = 1 / 0,
                    E = -1 / 0,
                    C = 1 / 0,
                    P = -1 / 0;
                for (K = 0, n = I.length; n > K; K++) k = I[K], q = k.x, M = k.y, k.x = i * q - t * M, k.y = t * q + i * M, R = Math.min(R, k.x), E = Math.max(E, k.x), C = Math.min(C, k.y), P = Math.max(P, k.y);
                u._width = (E - R) / u._scale.x, u._height = (P - C) / u._scale.y, i = Math.cos(G), t = Math.sin(G);
                var y = u._anchor;
                q = R + (E - R) * y.x, M = C + (P - C) * y.y, u._position = {
                    x: i * q - t * M,
                    y: t * q + i * M
                }
            }
        }, gb.prototype.isNode = function (Q) {
            return Cc(Q) ? Jk(Q) ? !1 : !0 : !1
        }, gb.prototype._42 = function (t, q, S) {
            var p, B, N, G, T, F, j, w, z = this,
                e = z._entities,
                _ = z.rotateMode;
            for ("batch" === _ && (w = z.getKeyOb()), p = 0, B = e.length; B > p; p++) N = e[p], z.isNode(N) && (F = N.getRect(), G = Sf.toScreenPosition(S, {
                x: F.x,
                y: F.y
            }), T = Sf.toScreenPosition(S, {
                x: F.x + F.width,
                y: F.y + F.height
            }), j = {
                min: G,
                max: T
            }, N === w && (j.isKeyOb = !0), Sf.Icons.DrawIcon(t, q, Sf.Icons.GroupSubEntityRect, j))
        };
        var ud = Sf.CurveActiving = function (i, V) {
            this._curve = i, this._interactor = i._interactor;
            for (var R in V) this[R] = V[R]
        };
        ud.prototype = {}, ud.prototype.constructor = ud, x.defineProperties(ud.prototype, {
            point: {
                get: function () {
                    return this._point
                },
                set: function (p) {
                    var S = this;
                    S._point = p, S.editingCtrl || S._firePointChange()
                }
            },
            pairs: {
                get: function () {
                    return this._pairs
                },
                set: function (v) {
                    var e = this;
                    e._pairs = v, e.editingCtrl && e._firePointChange()
                }
            }
        }), ud.prototype._firePointChange = function () {
            var x = this,
                i = x.getCurrentEditingPoint();
            if (!i) return Z.fi({
                kind: "selectPoint"
            }), void 0;
            var Z = x._interactor,
                M = this._curve.target;
            if (M) {
                var L = Sf.getDataMatrix(M).invert(),
                    u = i.e;
                i = L.apply(Sf.toWorldPosition(Z.gv, i)), i.e = u;
                var B = x._lastFirePoint;
                B && Math.abs(i.x - B.x) < 1e-5 && Math.abs(i.y - B.y) < 1e-5 && (i.e == p && B.e == p || Math.abs(i.e - B.e) < 1e-5) || (x._lastFirePoint = i, Z.fi({
                    kind: "selectPoint",
                    x: i.x,
                    y: i.y,
                    e: i.e
                }))
            }
        }, ud.prototype.dispose = function () {
            this._interactor.fi({
                kind: "selectPoint"
            })
        }, ud.prototype.getCurrentEditingPoint = function () {
            var q = this,
                g = q.editingCtrl;
            if (g) {
                var C = q.pairs;
                if (C) {
                    var M = C[g.pairId],
                        Q = M[g.type];
                    if (Q) return Q
                }
            }
            return q._point
        };
        var Mm = Sf.CursorFactory = function (A) {
            var x = this;
            x._interactor = A, x._rotateCursorStyles = {}
        };
        Mm.prototype = {}, Mm.prototype.constructor = Mm, Mm.prototype.getRotateCursor = function (Z) {
            var I = this;
            0 > Z && (Z += 2 * Math.PI);
            var E = I._interactor,
                o = E.getStyle("rotateCursorSize"),
                M = E.getStyle("rotateCursorRound"),
                J = Math.round(180 * (Z / Math.PI) / M);
            J * M >= 360 && (J = 0);
            var c = I._rotateCursorStyles,
                g = "htCustomRotateStyle_" + o + "_" + M + "_" + J;
            return c[g] || (I._produceRotateCursor(g, o, M, J), c[g] = !0), g
        }, Mm.prototype._produceRotateCursor = function (j, $, c, q) {
            var F = this;
            F._interactor;
            var C = F._canvas;
            C || (C = F._canvas = b.createElement("canvas")), C.width = C.height = $ * devicePixelRatio, C.style.width = C.style.height = $ + " px";
            var o = C.getContext("2d");
            Sf.setAntialias(o, !1), o.scale(devicePixelRatio, devicePixelRatio);
            var p, h, O, Q, k, V = Math.round($ / 2),
                Z = "" + V + " " + V + ",auto !important;";
            p = Math.PI / 180 * q * c, o.clearRect(0, 0, $, $), o.save(), o.scale($ / 32, $ / 32), o.translate(16, 16), o.rotate(p + Math.PI / 2), o.beginPath(), o.moveTo(-8, 0), o.lineTo(-8, 3), o.lineTo(-5, 3), o.moveTo(8, 0), o.lineTo(8, 3), o.lineTo(5, 3), o.moveTo(-8, 3), o.quadraticCurveTo(0, -6, 8, 3), o.restore(), o.strokeStyle = "white", o.lineWidth = 4, o.stroke(), o.strokeStyle = "black", o.lineWidth = 2, o.stroke(), h = JSON.stringify(C.toDataURL()), Q = "cursor:url(" + h + ")" + Z, 1 !== devicePixelRatio && (O = '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="' + $ + 'px" height="' + $ + 'px"><image xlink:href=' + h + ' width="' + $ + '" height="' + $ + '"/></svg>', Q += "cursor:url(data:image/svg+xml;base64," + btoa(O) + ")" + Z, Q += "cursor:-webkit-image-set(url(" + h + ")" + devicePixelRatio + "x,url(" + h + ")1x)" + Z), k = b.createElement("style"), k.textContent = "body." + j + " *, ." + j + "{" + Q + "}", b.head.appendChild(k)
        };
        var fc = Sf.Guide.Grid = function (L) {
            var E = this;
            E._interactor = L, E._alignmentGuideId = 0, E._xAlignmentGuide = [], E._yAlignmentGuide = []
        };
        fc.prototype = {}, fc.prototype.constructor = fc, x.defineProperties(fc.prototype, {
            gridBlockSize: {
                get: function () {
                    var k = this;
                    return k._gridBlockSize || k._interactor.getStyle("gridBlockSize")
                },
                set: function (H) {
                    this._gridBlockSize = H, this._interactor._42()
                }
            },
            gridThickLinesEvery: {
                get: function () {
                    var z = this;
                    return z._gridThickLinesEvery || z._interactor.getStyle("gridThickLinesEvery")
                },
                set: function (b) {
                    this._gridThickLinesEvery = b, this._interactor._42()
                }
            },
            gridEnabled: {
                get: function () {
                    var Y = this,
                        l = Y._interactor;
                    return l.gridEnabled && Y.isValidGrid()
                }
            }
        }), fc.prototype._42 = function () {
            var a = this,
                C = a._interactor;
            a.gridEnabled && a.drawGrid(), C.alignmentGuideEnabled && a.drawAlignmentGuide()
        }, fc.prototype.makeMatrix = function () {
            var C = this,
                l = C._interactor.getStyle("gridAngle"),
                m = C._interactor.getStyle("gridRotation"),
                M = new Sf.Math.Matrix2d,
                H = Math.sin(l),
                X = Math.cos(l);
            return M.set(1, 0, X, H, 0, 0), M.rotate(m), M
        }, fc.prototype.isValidGrid = function () {
            var $ = this,
                K = Math.PI,
                A = $._interactor,
                c = A.gv;
            if (c._zoom < A.getStyle("gridZoomThreshold")) return !1;
            var X = A.getStyle("gridAngle"),
                t = Math.abs(180 * (X % K / K)),
                x = 1 - 1e-8;
            return x > t || t > 180 - x ? !1 : !0
        }, fc.prototype.drawAlignmentGuide = function () {
            var K = this,
                C = K._interactor,
                m = C.gv,
                P = C._canvas,
                v = C._context,
                l = P.width,
                b = P.height,
                Z = m.tx(),
                L = m.ty(),
                u = m._zoom;
            v.beginPath(), v.strokeStyle = C.getStyle("gridAlignmentGuideColor"), v.lineWidth = 1, K._xAlignmentGuide.forEach(function (I) {
                var t = I.p * u + Z;
                v.moveTo(t, 0), v.lineTo(t, b)
            }), K._yAlignmentGuide.forEach(function (M) {
                var N = M.p * u + L;
                v.moveTo(0, N), v.lineTo(l, N)
            }), v.stroke()
        }, fc.prototype.drawGrid = function () {
            function a(x, m, e, Z) {
                var r = Sf.toScreenPosition(l, _.apply({
                        x: x,
                        y: m
                    })),
                    q = Sf.toScreenPosition(l, _.apply({
                        x: e,
                        y: Z
                    }));
                A.moveTo(r.x, r.y), A.lineTo(q.x, q.y)
            }
            var m = this,
                o = m._interactor,
                y = m.gridBlockSize,
                F = m.gridThickLinesEvery,
                T = o.getStyle("gridThickColor"),
                I = o.getStyle("gridLightColor"),
                l = o.gv,
                i = o._canvas,
                A = o._context,
                n = i.width,
                r = i.height,
                _ = m.makeMatrix(),
                f = _.applyInverse(Sf.toWorldPosition(l, {
                    x: 0,
                    y: 0
                })),
                L = _.applyInverse(Sf.toWorldPosition(l, {
                    x: n,
                    y: 0
                })),
                P = _.applyInverse(Sf.toWorldPosition(l, {
                    x: 0,
                    y: r
                })),
                j = _.applyInverse(Sf.toWorldPosition(l, {
                    x: n,
                    y: r
                })),
                V = Math.min(f.x, L.x, P.x, j.x),
                R = Math.max(f.x, L.x, P.x, j.x),
                M = Math.min(f.y, L.y, P.y, j.y),
                W = Math.max(f.y, L.y, P.y, j.y);
            n = R - V, r = W - M;
            var N = Math.ceil(V / y),
                s = Math.floor(R / y),
                c = Math.ceil(M / y),
                $ = Math.floor(W / y);
            l.tx(), l.ty(), l._zoom;
            var k, K, B;
            for (A.save(), A.lineWidth = 1, A.beginPath(), A.strokeStyle = T, B = Math.ceil(N / F) * F; s >= B; B += F) k = B * y, a(k, M, k, W);
            for (B = Math.ceil(c / F) * F; $ >= B; B += F) K = B * y, a(V, K, R, K);
            for (A.stroke(), A.beginPath(), A.strokeStyle = I, B = N; s >= B; B++) 0 !== B % F && (k = B * y, a(k, M, k, W));
            for (B = c; $ >= B; B++) 0 !== B % F && (K = B * y, a(V, K, R, K));
            A.stroke(), A.restore()
        }, fc.prototype.getAlignmentGuides = function () {
            var s = this;
            return {
                x: s._xAlignmentGuide,
                y: s._yAlignmentGuide
            }
        }, fc.prototype.addAlignmentGuide = function (D, f, H) {
            var Q = this,
                m = "x" === D ? Q._xAlignmentGuide : Q._yAlignmentGuide,
                H = H ? H : ++Q._alignmentGuideId,
                t = {
                    p: f,
                    id: H
                };
            if (m.length) {
                var W = Q._findClosestAlignmentGuide(t.p, m);
                W.dis < 0 ? m.splice(W.index + 1, 0, t) : m.splice(W.index, 0, t)
            } else m.push(t);
            return Q._interactor._42(), H
        }, fc.prototype.findClosest = function (t, K, o) {
            var v = this,
                i = v._interactor,
                q = i.gv;
            o && (t = Sf.toWorldPosition(q, t));
            var L, G, Q, M = 1 / 0,
                O = 1 / 0,
                C = t.x,
                Z = t.y;
            if (v.gridEnabled) {
                var d = v.gridBlockSize,
                    H = v.makeMatrix(),
                    B = H.applyInverse(t);
                B = H.apply({
                    x: Math.round(B.x / d) * d,
                    y: Math.round(B.y / d) * d
                }), M = B.x - C, O = B.y - Z, Q = !0
            }
            if (i.alignmentGuideEnabled && (L = v._findClosestAlignmentGuide(C, v._xAlignmentGuide).dis, G = v._findClosestAlignmentGuide(Z, v._yAlignmentGuide).dis, Math.abs(L) < Math.abs(M) && (M = L, Q = !0), Math.abs(G) < Math.abs(O) && (O = G, Q = !0)), Q) {
                Q = !1;
                var n = q._zoom,
                    u = i.getStyle("smartGuideSensitivity") / n,
                    P = {};
                if (Math.abs(M) < u && "y" !== K && (P.x = o ? M * n : M, Q = !0), Math.abs(O) < u && "x" !== K && (P.y = o ? O * n : O, Q = !0), Q) return P
            }
        }, fc.prototype._findClosestAlignmentGuide = function (q, s) {
            if (!s.length) return {
                dis: 1 / 0
            };
            for (var R, Q = 0, G = s.length - 1; G - Q > 1;) R = Math.floor((Q + G) / 2), s[R].p < q ? Q = R : G = R;
            var D = s[Q].p - q,
                t = s[G].p - q;
            return Math.abs(D) <= Math.abs(t) ? {
                line: s[Q],
                dis: D,
                index: Q
            } : {
                line: s[G],
                dis: t,
                index: G
            }
        }, fc.prototype.removeAllAlignmentGuide = function (j) {
            var W = this;
            "y" !== j && (W._xAlignmentGuide = []), "x" !== j && (W._yAlignmentGuide = []), W._interactor._42()
        }, fc.prototype.removeAlignmentGuide = function (x) {
            for (var N, H, I, K = this, o = K._xAlignmentGuide, j = 0; 2 > j; j++)
                for (o = 0 === j ? K._xAlignmentGuide : K._yAlignmentGuide, N = 0, H = o.length; H > N; N++)
                    if (I = o[N], I.id === x) return o.splice(N, 1), K._interactor._42(), {
                        axis: 0 === j ? "x" : "y",
                        position: I.p
                    };
            return !1
        }, fc.prototype.adjustAlignmentGuide = function (b, D) {
            var g = this,
                Z = g.removeAlignmentGuide(b);
            return Z ? (g.addAlignmentGuide(Z.axis, D, b), !0) : !1
        };
        var Yh = Sf.Guide.Rect = function (q) {
            var J = this;
            J._interactor = q
        };
        Yh.prototype = {}, Yh.prototype.constructor = Yh, Yh.prototype.gatherRects = function () {
            var Z, O, g, f, x = this,
                P = x._interactor.gv,
                b = [],
                u = [],
                i = {
                    x: b,
                    y: u
                },
                j = {},
                Y = P.getDataModel(),
                S = Y.a("width"),
                n = Y.a("height");
            S && n && (Z = 0, O = 0, g = S, f = n, b.push({
                node: Y,
                type: 0,
                p: Z
            }, {
                node: Y,
                type: 1,
                p: Z + g / 2
            }, {
                node: Y,
                type: 2,
                p: Z + g
            }), u.push({
                node: Y,
                type: 0,
                p: O
            }, {
                node: Y,
                type: 1,
                p: O + f / 2
            }, {
                node: Y,
                type: 2,
                p: O + f
            }), j[Y._id || 0] = {
                x: Z,
                y: O,
                width: g,
                height: f
            }), Y.each(function (l) {
                if (Cc(l) && !P.isSelected(l) && P.isVisible(l)) {
                    var e = !1;
                    if (P.sm().getSelection().each(function (B) {
                            e || (l.isHostOn(B) ? e = !0 : l.isDescendantOf(B) && (e = !0))
                        }), !e) {
                        var D = l.getRect();
                        Z = D.x, O = D.y, g = D.width, f = D.height, b.push({
                            node: l,
                            type: 0,
                            p: Z
                        }, {
                            node: l,
                            type: 1,
                            p: Z + g / 2
                        }, {
                            node: l,
                            type: 2,
                            p: Z + g
                        }), u.push({
                            node: l,
                            type: 0,
                            p: O
                        }, {
                            node: l,
                            type: 1,
                            p: O + f / 2
                        }, {
                            node: l,
                            type: 2,
                            p: O + f
                        }), j[l._id] = D
                    }
                }
            }), b.sort(function (h, N) {
                return h.p - N.p
            }), u.sort(function (E, R) {
                return E.p - R.p
            }), x._grid = i, x._87I = j
        }, Yh.prototype.gatherLines = function (S, c, g) {
            var P, Z, D, i, F, C, J, U, Q, o, $, R, k = this,
                M = [k.findClosest({
                    x: S.x,
                    y: S.y
                }, c), k.findClosest({
                    x: S.x + S.w / 2,
                    y: S.y + S.h / 2
                }, c), k.findClosest({
                    x: S.x + S.w,
                    y: S.y + S.h
                }, c)],
                X = {},
                W = k._87I;
            g = g || 255;
            var b, q;
            for (k._guideLine = [], P = 0; 2 > P; P++)
                for (X = {}, 0 === P ? (i = "y", U = S.x, Q = U + S.w) : (i = "x", U = S.y, Q = U + S.h), Z = 0; 3 > Z; Z++) F = M[Z], F && isFinite(F[i]) && (b = 1 << 3 * P + Z, g & b && (C = F[i + "Line"], J = C.node, q = J._id || 0, X[q] || (X[q] = !0, R = W[q], "y" === i ? (o = R.x, $ = R.x + R.width) : (o = R.y, $ = R.y + R.height), D = C.p, k._guideLine.push({
                    type: i,
                    a: U,
                    b: Q,
                    c: o,
                    d: $,
                    p: D,
                    center: 1 === C.type
                }))))
        }, Yh.prototype._binarySearchClosest = function (z, N) {
            if (!N.length) return {
                dis: 1 / 0
            };
            for (var O, R = 0, x = N.length - 1; x - R > 1;) O = Math.floor((R + x) / 2), N[O].p < z ? R = O : x = O;
            var P = N[R].p - z,
                Z = N[x].p - z;
            return Math.abs(P) <= Math.abs(Z) ? {
                line: N[R],
                dis: P
            } : {
                line: N[x],
                dis: Z
            }
        }, Yh.prototype.findClosest = function (P, U, D) {
            var e = this,
                K = e._interactor,
                s = K.gv,
                f = e._grid;
            D && (P = Sf.toWorldPosition(s, P));
            var W, p = e._binarySearchClosest(P.x, f.x),
                O = e._binarySearchClosest(P.y, f.y),
                B = p.dis,
                Z = O.dis,
                _ = s._zoom,
                I = K.getStyle("smartGuideSensitivity") / _,
                R = {};
            return Math.abs(B) < I && "y" !== U && (R.x = D ? B * _ : B, R.xLine = p.line, W = !0), Math.abs(Z) < I && "x" !== U && (R.y = D ? Z * _ : Z, R.yLine = O.line, W = !0), W ? R : void 0
        }, Yh.prototype._42 = function () {
            var O = this,
                G = O._guideLine;
            if (G && !k.Default.isCtrlDown()) {
                var w, Z, H, r, C, P, X, h, c, s, d, z, M, K, S, t, B, n = O._interactor,
                    g = n.gv,
                    o = n._context,
                    i = g.tx(),
                    q = g.ty(),
                    Y = g._zoom,
                    T = n.getStyle("guideLineTextSpacing");
                for (w = 0, Z = G.length; Z > w; w++) H = G[w], h = H.type, c = H.p, s = H.a, d = H.b, z = H.c, M = H.d, K = Math.min(s, z), S = Math.max(d, M), "x" === h ? (r = c * Y + i, C = K * Y + q, P = r, X = S * Y + q) : (r = K * Y + i, C = c * Y + q, P = S * Y + i, X = C), Sf.Icons.DrawIcon(n, o, Sf.Icons.MoveLineGuide, {
                    rect: [r, C, P, X],
                    center: H.center
                }), M >= s && d >= z || (K = s > M ? M : d, S = s > M ? s : z, B = S - K, "x" === h ? (H.center2center || (r -= T, P = r), C = K * Y + q, X = S * Y + q, t = Sf.Icons.MoveLineGuideDistanceV) : "y" === h && (H.center2center || (C -= T, X = C), r = K * Y + i, P = S * Y + i, t = Sf.Icons.MoveLineGuideDistanceH), Sf.Icons.DrawIcon(n, o, t, {
                    x0: r,
                    y0: C,
                    x1: P,
                    y1: X,
                    dis: B
                }))
            }
        }, Yh.prototype.clear = function () {
            this._guideLine = null
        }, Sf.DefaultStyleMap = {
            pointSize: [24, 9],
            checkSize: 7,
            rotateCheckSize: 10,
            moveSensitivity: 10,
            keepAspectRatio: !1,
            rotateRound: Math.PI / 2,
            shiftRotateRound: Math.PI / 12,
            rotateSensitivity: Math.PI / 60,
            rotateAsClock: !1,
            shiftLineRotateRound: Math.PI / 4,
            anchorMovable: !0,
            anchorVisible: !0,
            anchorHideThreshold: 25,
            anchorOutsideVisibleThreshold: .25,
            anchorRound: .25,
            anchorSensitivity: .02,
            smartGuideSensitivity: 8,
            curveIntersectSize: 5,
            curvePointIntersectSize: 8,
            edgeHostDetectPerFrame: !0,
            guideLineTextSpacing: 0,
            gridBlockSize: 40,
            gridThickLinesEvery: 10,
            gridThickColor: "#5d5d5d",
            gridLightColor: "#d0d0d0",
            gridZoomThreshold: .25,
            gridAlignmentGuideColor: "#ff0000",
            gridAngle: Math.PI / 2,
            gridRotation: 0,
            groupRotateModeDefault: "block",
            groupRotateModeKey: ["ctrlKey", "metaKey"],
            rotateCursorSize: 32,
            rotateCursorRound: 45,
            tipTextColor: "#ffffff",
            tipBackground: "#333333",
            curveHighlightColor: "#30599e",
            rectPointBackground: "white",
            rectPointBorderColor: "#666666",
            rectPointShadowColor: "rgba(0,0,0,0.35)",
            shapeCtrlPointBackground: "white",
            shapeCtrlPointBorderColor: null,
            shapeCtrlPointHighlightBorder: null,
            shapeHighlighPointBackground: "#30599e",
            curveElevationVisible: !0,
            curveElevationIntersectSize: 8,
            curveElevationGuideShift: [20, 0],
            connectGuideVisible: !0,
            connectGuideShift: [1, .25, 8, 0],
            connectGuideIntersectSize: 8,
            connectGuideGarbageIntersectsize: 25,
            connectGuideGarbageShift: [1, 1, -48, -48]
        };
        var zp = Sf.Icons = {},
            Fo = 1e4,
            zi = null,
            Mf = "rgb(51,153,255)",
            tk = "rgb(183,232,135)",
            dj = "rgb(255,204,153)",
            vm = 6;
        k.Default.setImage("Icons.RectPoint", {
            width: vm,
            height: vm,
            comps: [{
                type: "rect",
                background: "rgb(247,247,247)",
                borderWidth: 1,
                borderColor: Mf,
                rect: [0, 0, vm, vm]
            }]
        });
        var lo = "#e000e0";
        zp.GroupSubEntityRect = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        var f = zp.GroupSubEntityRect.data;
                        if (!f) return [];
                        var c = f.min,
                            E = f.max;
                        return [c.x, c.y, c.x, E.y, E.x, E.y, E.x, c.y]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                background: null,
                borderWidth: 1,
                borderColor: {
                    func: function () {
                        return zp.GroupSubEntityRect.data.isKeyOb ? lo : "#666666"
                    }
                }
            }]
        }, zp.Line = {
            comps: [{
                type: "image",
                name: "Icons.RectPoint",
                rect: {
                    func: function () {
                        return [
                            [zp.Line.data.P1.x, zp.Line.data.P1.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rect: {
                    func: function () {
                        return [
                            [zp.Line.data.P2.x, zp.Line.data.P2.y], vm, vm
                        ]
                    }
                }
            }]
        }, zp.NodeHoverGuide = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        return zp.NodeHoverGuide.data
                    }
                },
                segments: [1, 2, 2, 2, 5],
                background: null,
                borderWidth: 1,
                borderColor: "#3399FF"
            }]
        }, zp.Rect = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        var t = zp.Rect.data;
                        if (!t) return [];
                        var F = t.LT,
                            L = t.LB,
                            x = t.RB,
                            m = t.RT;
                        return [F.x, F.y, L.x, L.y, x.x, x.y, m.x, m.y]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                background: null,
                borderWidth: 1,
                borderColor: Mf
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.LT.x, zp.Rect.data.LT.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.LB.x, zp.Rect.data.LB.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.RB.x, zp.Rect.data.RB.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.RT.x, zp.Rect.data.RT.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                visible: {
                    func: function () {
                        return zp.Rect.data.L ? !0 : !1
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.L.x, zp.Rect.data.L.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                visible: {
                    func: function () {
                        return zp.Rect.data.R ? !0 : !1
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.R.x, zp.Rect.data.R.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                visible: {
                    func: function () {
                        return zp.Rect.data.T ? !0 : !1
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.T.x, zp.Rect.data.T.y], vm, vm
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.RectPoint",
                rotation: {
                    func: function () {
                        return zp.Rect.data.rotation
                    }
                },
                visible: {
                    func: function () {
                        return zp.Rect.data.B ? !0 : !1
                    }
                },
                rect: {
                    func: function () {
                        return [
                            [zp.Rect.data.B.x, zp.Rect.data.B.y], vm, vm
                        ]
                    }
                }
            }]
        };
        var aq = 16;
        k.Default.setImage("Icons.Anchor", {
            width: 12,
            height: 12,
            comps: [{
                type: "shape",
                borderWidth: 1,
                borderColor: Mf,
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [.50928, 6, 11.49072, 6, 6, 6, 6, .50928, 6, 11.49072]
            }, {
                type: "circle",
                borderWidth: 1,
                borderColor: Mf,
                shadowColor: "#1ABC9C",
                rect: [2.84391, 2.84391, 6.53697, 6.53697]
            }]
        }), zp.Anchor = {
            comps: [{
                type: "image",
                name: "Icons.Anchor",
                rect: {
                    func: function () {
                        return [
                            [zp.Anchor.data.POS.x, zp.Anchor.data.POS.y], aq, aq
                        ]
                    }
                }
            }]
        }, zp.TipShiftX = 12, zp.TipShiftY = 12;
        var Sn = [8, 28];
        zp.TipHelper = {
            comps: [{
                type: "roundRect",
                rect: {
                    func: function () {
                        return [zp.TipHelper.data.helperPos.x, zp.TipHelper.data.helperPos.y, Sn[0] * zp.TipHelper.data.size, Sn[1]]
                    }
                },
                background: {
                    func: function () {
                        return zi.getStyle("tipBackground")
                    }
                },
                opacity: .6
            }, {
                type: "text",
                text: {
                    func: function () {
                        return zp.TipHelper.data.text
                    }
                },
                rect: {
                    func: function () {
                        return [zp.TipHelper.data.helperPos.x, zp.TipHelper.data.helperPos.y, Sn[0] * zp.TipHelper.data.size, Sn[1]]
                    }
                },
                color: {
                    func: function () {
                        return zi.getStyle("tipTextColor")
                    }
                },
                font: "bold 12px Arial",
                align: "center"
            }]
        };
        var Xl = 7;
        zp.ShapePoint = {
            comps: [{
                type: "circle",
                rect: {
                    func: function () {
                        var r = zp.ShapePoint.data.point;
                        return [r, Xl, Xl]
                    }
                },
                background: {
                    func: function () {
                        var T = zp.ShapePoint.data.isEnd;
                        return T ? "rgba(27,124,222,0.7)" : "#ffffff"
                    }
                },
                borderWidth: 1,
                borderColor: Mf
            }]
        }, zp.ShapeBgCurve = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        return zp.ShapeBgCurve.data.P
                    }
                },
                segments: {
                    func: function () {
                        return zp.ShapeBgCurve.data.S
                    }
                },
                background: null,
                borderWidth: 1,
                borderColor: Mf
            }]
        };
        var _r = 8;
        zp.ShapeHighlighPoint = {
            comps: [{
                type: "circle",
                rect: {
                    func: function () {
                        var F = zp.ShapeHighlighPoint.data;
                        return [
                            [F.x, F.y], _r, _r
                        ]
                    }
                },
                background: {
                    func: function () {
                        return zi.getStyle("shapeHighlighPointBackground")
                    }
                },
                borderWidth: 0
            }]
        };
        var Ib = 10;
        zp.ShapeHighlighRealPoint = {
            comps: [{
                type: "circle",
                rect: {
                    func: function () {
                        var I = zp.ShapeHighlighRealPoint.data;
                        return [
                            [I.x, I.y], Ib, Ib
                        ]
                    }
                },
                background: "#ffffff",
                borderWidth: 2,
                borderColor: Mf
            }]
        };
        var Bh = 8;
        zp.ShapeHighlighCtrlPoint = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        var j = zp.ShapeHighlighCtrlPoint.data,
                            M = j.x,
                            q = j.y,
                            a = Bh / 2;
                        return [M - a, q - a, M - a, q + a, M + a, q + a, M + a, q - a]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                borderWidth: 2,
                background: {
                    func: function () {
                        return zi.getStyle("shapeCtrlPointBackground")
                    }
                },
                borderColor: {
                    func: function () {
                        return zi.getStyle("shapeCtrlPointBorderColor") || Mf
                    }
                }
            }]
        };
        var Vf = 3;
        zp.ShapeHighlightCurve = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        return zp.ShapeHighlightCurve.data
                    }
                },
                segments: [1, 4],
                background: null,
                borderWidth: Vf,
                borderColor: {
                    func: function () {
                        return zi.getStyle("curveHighlightColor")
                    }
                }
            }]
        }, zp.ShapeGuideLine = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        return zp.ShapeGuideLine.data
                    }
                },
                background: null,
                borderWidth: 1,
                borderColor: "rgb(255,204,153)"
            }]
        }, zp.MoveLineGuide = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        return zp.MoveLineGuide.data.rect
                    }
                },
                background: null,
                borderWidth: 1,
                borderColor: {
                    func: function () {
                        return zp.MoveLineGuide.data.center ? tk : dj
                    }
                }
            }]
        };
        var Tg = 5;
        zp.MoveLineGuideDistanceH = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        var Z = zp.MoveLineGuideDistanceH.data,
                            g = Z.x0,
                            t = Z.y0;
                        return [g, t - Tg, g, t + Tg]
                    }
                },
                rotation: -Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: dj
            }, {
                type: "shape",
                points: {
                    func: function () {
                        var b = zp.MoveLineGuideDistanceH.data,
                            i = b.x1,
                            S = b.y1;
                        return [i, S - Tg, i, S + Tg]
                    }
                },
                rotation: -Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: dj
            }, {
                type: "text",
                text: {
                    func: function () {
                        return Math.round(zp.MoveLineGuideDistanceH.data.dis)
                    }
                },
                rect: {
                    func: function () {
                        var s = zp.MoveLineGuideDistanceH.data;
                        return [
                            [(s.x0 + s.x1) / 2, s.y0 - 10], 20, 20
                        ]
                    }
                },
                color: dj,
                font: "12px Arial",
                align: "center"
            }]
        }, zp.MoveLineGuideDistanceV = {
            comps: [{
                type: "shape",
                points: {
                    func: function () {
                        var p = zp.MoveLineGuideDistanceV.data,
                            K = p.x0,
                            R = p.y0;
                        return [K - Tg, R, K + Tg, R]
                    }
                },
                rotation: Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: dj
            }, {
                type: "shape",
                points: {
                    func: function () {
                        var D = zp.MoveLineGuideDistanceV.data,
                            N = D.x1,
                            Y = D.y1;
                        return [N - Tg, Y, N + Tg, Y]
                    }
                },
                rotation: Math.PI / 4,
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: dj
            }, {
                type: "text",
                text: {
                    func: function () {
                        return Math.round(zp.MoveLineGuideDistanceV.data.dis)
                    }
                },
                rect: {
                    func: function () {
                        var I = zp.MoveLineGuideDistanceV.data;
                        return [
                            [I.x0 - 10, (I.y0 + I.y1) / 2], 20, 20
                        ]
                    }
                },
                color: dj,
                font: "12px Arial",
                align: "center"
            }]
        }, k.Default.setImage("Icons.EdgeElevationGuideImage", {
            width: 16,
            height: 16,
            comps: [{
                type: "oval",
                background: "rgb(255,255,255)",
                borderWidth: 1,
                borderColor: "rgb(138,138,138)",
                rect: [.5, .5, 15, 15]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(44,44,44)",
                borderCap: "round",
                points: [4, 8, 8, 4, 12, 8, 8, 4, 8, 13],
                segments: [1, 2, 2, 1, 2]
            }]
        }), zp.EdgeElevationGuide = {
            comps: [{
                type: "image",
                name: "Icons.EdgeElevationGuideImage",
                rect: {
                    func: function () {
                        var D = zp.EdgeElevationGuide.data,
                            p = D.x,
                            y = D.y,
                            t = zi.getStyle("curveElevationIntersectSize"),
                            l = zi.getStyle("curveElevationGuideShift");
                        return p += l[0], y += l[1], [p - t, y - t, 2 * t, 2 * t]
                    }
                }
            }]
        }, k.Default.setImage("Icons.ConnectGuideBgImage", {
            width: 12,
            height: 12,
            comps: [{
                type: "shape",
                background: "#3399ff",
                fillRule: "evenodd",
                shadowColor: "#1ABC9C",
                rotation: 3.14159,
                points: [6.00001, 11.99999, 6.00001, 11.99999, 2.6863, 11.99999, 1e-5, 9.30695, 1e-5, 5.99999, 1e-5, 5.99999, 1e-5, 2.68628, 2.69305, -1e-5, 6.00001, -1e-5, 12.00001, -1e-5, 11.99998, 12.00001, 6.00001, 11.99999],
                segments: [1, 2, 4, 2, 4, 2, 2, 2]
            }]
        }), k.Default.setImage("Icons.ConnectGuideHeaderImage", {
            width: 12,
            height: 12,
            comps: [{
                type: "oval",
                background: "#3399FF",
                borderColor: "#3399FF",
                shadowColor: "#1ABC9C",
                rect: [0, 0, 12, 12]
            }, {
                type: "shape",
                borderWidth: 1,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [4.76, 2.56, 8.2, 5.98, 4.76, 9.44]
            }]
        }), zp.ConnectGuide = {
            comps: [{
                type: "image",
                name: "Icons.ConnectGuideBgImage",
                rotation: {
                    func: function () {
                        return zp.ConnectGuide.data.rotation
                    }
                },
                rect: {
                    func: function () {
                        var w = zp.ConnectGuide.data.connect;
                        w.x, w.y;
                        var X = zi.getStyle("connectGuideIntersectSize");
                        return [
                            [w.x, w.y], 2 * X, 2 * X
                        ]
                    }
                }
            }, {
                type: "image",
                name: "Icons.ConnectGuideHeaderImage",
                rect: {
                    func: function () {
                        var T = zp.ConnectGuide.data.cursorPos || zp.ConnectGuide.data.connect,
                            d = zi.getStyle("connectGuideIntersectSize");
                        return [
                            [T.x, T.y], 2 * d - 2, 2 * d - 2
                        ]
                    }
                }
            }, {
                type: "shape",
                background: null,
                borderColor: "#3399ff",
                borderWidth: 2,
                segments: [1, 4],
                points: {
                    func: function () {
                        var _ = zp.ConnectGuide.data.connect,
                            P = zp.ConnectGuide.data.cursorPos || _;
                        return [_.x, _.y, _.x + .5 * (P.x - _.x), _.y, P.x + .5 * (_.x - P.x), P.y, P.x, P.y]
                    }
                }
            }]
        }, k.Default.setImage("Icons.ConnectGuideGarbageImage", {
            width: 48,
            height: 48,
            comps: [{
                type: "oval",
                background: "rgba(0,0,0,0.1)",
                borderColor: "#979797",
                shadowColor: "#1ABC9C",
                rect: [0, 0, 48, 48]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [19.84721, 19.69091, 19.84721, 32.25123]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [24.10371, 19.69091, 24.10371, 32.25123]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [28.15279, 19.69091, 28.15279, 32.25123]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [11.23055, 15.22377, 36.76945, 15.189, 19.12302, 15.17121, 20.94722, 11.5228, 26.41985, 11.5228, 28.24406, 15.17121]
            }, {
                type: "rect",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                shadowColor: "#1ABC9C",
                rect: [15.48702, 15.22377, 17.02595, 21.25344]
            }]
        }), k.Default.setImage("Icons.ConnectGuideDeletingImage", {
            width: 56,
            height: 56,
            comps: [{
                type: "oval",
                background: "rgba(232,0,0,0.75)",
                borderColor: "#979797",
                shadowColor: "#1ABC9C",
                rect: [0, 0, 56, 56]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [22.67939, 27.69091, 22.67939, 40.25123]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [26.93588, 27.69091, 26.93588, 40.25123]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                points: [30.98497, 27.69091, 30.98497, 40.25123]
            }, {
                type: "shape",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                borderCap: "round",
                shadowColor: "#1ABC9C",
                anchorX: 0,
                anchorY: 1,
                rotation: 5.65062,
                points: [14.06272, 23.22377, 39.60163, 23.189, 21.9552, 23.17121, 23.7794, 19.5228, 29.25203, 19.5228, 31.07623, 23.17121]
            }, {
                type: "rect",
                borderWidth: 2,
                borderColor: "rgb(255,255,255)",
                shadowColor: "#1ABC9C",
                rect: [18.3192, 23.22377, 17.02595, 21.25344]
            }]
        }), zp.ConnectGuideGarbage = {
            comps: [{
                type: "image",
                name: {
                    func: function () {
                        var I = zp.ConnectGuideGarbage.data.hover;
                        return I ? "Icons.ConnectGuideDeletingImage" : "Icons.ConnectGuideGarbageImage"
                    }
                },
                rect: {
                    func: function () {
                        var Z = zp.ConnectGuideGarbage.data,
                            y = zi.getStyle("connectGuideGarbageIntersectsize");
                        return Z.hover && (y += 5), [
                            [Z.x, Z.y], 2 * y, 2 * y
                        ]
                    }
                }
            }]
        };
        var qf = 6;
        zp.ShapeActivingCtrl = {
            comps: [{
                type: "shape",
                visible: {
                    func: function () {
                        return zp.ShapeActivingCtrl.data.c1 ? !0 : !1
                    }
                },
                points: {
                    func: function () {
                        var S = zp.ShapeActivingCtrl.data;
                        return [S.point.x, S.point.y, S.c1.x, S.c1.y]
                    }
                },
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: Mf
            }, {
                type: "shape",
                visible: {
                    func: function () {
                        return zp.ShapeActivingCtrl.data.c2 ? !0 : !1
                    }
                },
                points: {
                    func: function () {
                        var p = zp.ShapeActivingCtrl.data;
                        return [p.point.x, p.point.y, p.c2.x, p.c2.y]
                    }
                },
                segments: [1, 2],
                background: null,
                borderWidth: 1,
                borderColor: Mf
            }, {
                type: "shape",
                visible: {
                    func: function () {
                        return zp.ShapeActivingCtrl.data.c1 ? !0 : !1
                    }
                },
                points: {
                    func: function () {
                        var i = zp.ShapeActivingCtrl.data.c1,
                            x = i.x,
                            W = i.y,
                            K = qf / 2;
                        return "c1" === zp.ShapeActivingCtrl.data.hl && (K += .5), [x - K, W - K, x - K, W + K, x + K, W + K, x + K, W - K]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                borderWidth: 2,
                background: {
                    func: function () {
                        return zi.getStyle("shapeCtrlPointBackground")
                    }
                },
                borderColor: {
                    func: function () {
                        return "c1" === zp.ShapeActivingCtrl.data.hl ? zi.getStyle("shapeCtrlPointHighlightBorder") || Mf : zi.getStyle("shapeCtrlPointBorderColor") || Mf
                    }
                }
            }, {
                type: "shape",
                visible: {
                    func: function () {
                        return zp.ShapeActivingCtrl.data.c2 ? !0 : !1
                    }
                },
                points: {
                    func: function () {
                        var r = zp.ShapeActivingCtrl.data.c2,
                            X = r.x,
                            C = r.y,
                            O = qf / 2;
                        return "c2" === zp.ShapeActivingCtrl.data.hl && (O += .5), [X - O, C - O, X - O, C + O, X + O, C + O, X + O, C - O]
                    }
                },
                segments: [1, 2, 2, 2, 5],
                borderWidth: 2,
                background: {
                    func: function () {
                        return zi.getStyle("shapeCtrlPointBackground")
                    }
                },
                borderColor: {
                    func: function () {
                        return "c2" === zp.ShapeActivingCtrl.data.hl ? zi.getStyle("shapeCtrlPointHighlightBorder") || Mf : zi.getStyle("shapeCtrlPointBorderColor") || Mf
                    }
                }
            }]
        }, zp.RoundPoint = {
            comps: [{
                type: "circle",
                background: "rgb(247,247,247)",
                borderWidth: 1,
                borderColor: Mf,
                rect: {
                    func: function () {
                        return [
                            [zp.RoundPoint.data.x, zp.RoundPoint.data.y], vm, vm
                        ]
                    }
                }
            }]
        }, zp.AttachPoint = {
            comps: [{
                type: "rect",
                background: {
                    func: function () {
                        return zp.AttachPoint.data.isAttach ? "rgb(51,153,255)" : "rgb(247,247,247)"
                    }
                },
                borderWidth: 1,
                rotation: Math.PI / 4,
                borderColor: Mf,
                rect: {
                    func: function () {
                        var f = zp.AttachPoint.data.isAttach ? vm + 4 : vm;
                        return [
                            [zp.AttachPoint.data.x, zp.AttachPoint.data.y], f, f
                        ]
                    }
                }
            }]
        }, Sf.Icons.DrawIcon = function (G, $, U, t) {
            U.width = U.height = Fo, U.data = t, zi = G, k.Default.drawImage($, U, 0, 0, Fo, Fo)
        }, Sf.Icons.MapPoints = function (D, p) {
            for (var o = 0, $ = D.length; $ > o; o++) D[o] /= p
        }, Sf.roundTo = function (g, I, H) {
            var L = Math.abs(g % I);
            return H > L || H > I - L ? I * Math.round(g / I) : g
        }, Sf.toFixed = function (S) {
            return Math.round(100 * S) / 100
        }, Sf.getDataMatrix = function (f) {
            if (f instanceof k.Shape) {
                var W = new k.Math.Matrix2d,
                    A = f.getPosition();
                return W.translate(-A.x, -A.y).scale(f.getScale().x, f.getScale().y).rotate(f.getRotation()).translate(A.x, A.y), W
            }
            return f.getMatrix ? f.getMatrix() : new k.Math.Matrix2d
        };
        var Ni = Sf.Math.Curve = function () {
            this._curves = []
        };
        Ni.prototype = {}, Ni.prototype.constructor = Ni, Ni.prototype.createFromHtShape = function (I, B, q) {
            B instanceof k.List && (B = B.toArray());
            var Q, j, t, m, T, a, J, u = this,
                h = null,
                E = null,
                F = 0,
                z = Sf.Math.Vector2,
                O = Sf.Math.CubicBezier,
                g = function (F) {
                    return new z(I[F], I[F + 1], q ? q[F / 2] : p)
                };
            for (j = 0, t = B.length; t > j; j++) {
                switch (m = B[j], T = null, m) {
                    case 1:
                        E = g(F), h = E, F += 2;
                        break;
                    case 2:
                        Q = g(F), F += 2, T = new O(E, E.clone(), Q.clone(), Q), E = Q;
                        break;
                    case 3:
                        a = g(F), Q = g(F + 2), F += 4, T = new O(E, a.clone().sub(E).multiplyScalar(2 / 3).add(E), a.clone().sub(Q).multiplyScalar(2 / 3).add(Q), Q), E = Q;
                        break;
                    case 4:
                        a = g(F), J = g(F + 2), Q = g(F + 4), F += 6, T = new O(E, a, J, Q), E = Q;
                        break;
                    case 5:
                        if (!h) break;
                        T = new O(E, E.clone(), h.clone(), h), E = null, h = null
                }
                T && (T._index = u._curves.length, u._curves.push(T))
            }
        }, Ni.prototype.checkPoint = function (e, V) {
            var M, W, n, p, D, x = this,
                I = x._curves;
            for (M = 0, W = I.length; W > M; M++)
                if (p = I[M], D = p.intersectRect(e, V, V), D.length) return n = 0, D.forEach(function (B) {
                    n += B.t
                }), n /= D.length, e = p.getPointAt(n), e.t = n, {
                    bezier: p,
                    intersection: e
                }
        }, Ni.prototype.insertKnot = function (m, _) {
            var o = m.insertKnot(_),
                f = this,
                I = f._curves;
            I.splice(m._index, 1, o[0], o[1])
        }, Ni.prototype._isCloseEnough = function (I, j) {
            return Math.abs(I.x - j.x) < 1e-6 && Math.abs(I.y - j.y) < 1e-6
        }, Ni.prototype._isSamePoint = function (Z, r) {
            return Z === r
        }, Ni.prototype.moveRealPoint = function (b, B) {
            var X = this,
                n = X._curves,
                f = B.clone().sub(b);
            n.forEach(function (q) {
                var Q = q._p1;
                q._p2, q._p3;
                var t = q._p4;
                X._isSamePoint(Q, b) && (q._p2.add(f), q._p1 = B), X._isSamePoint(t, b) && (q._p3.add(f), q._p4 = B)
            })
        }, Ni.prototype.moveCtrlDueToRealPointMovement = function (x, c) {
            var g = this,
                h = g._curves,
                $ = function (C) {
                    C.add(c), C.e && c.e && (C.e += c.e)
                };
            h.forEach(function (t) {
                var n = t._p1;
                t._p2, t._p3;
                var E = t._p4;
                g._isSamePoint(n, x) && $(t._p2), g._isSamePoint(E, x) && $(t._p3)
            })
        }, Ni.prototype.moveCtrlPoint = function (R, M, U) {
            var H = R[U];
            if (H) {
                H.e !== p && (M.e = H.e);
                var v = this,
                    A = v._curves;
                M.clone().sub(H), A.forEach(function (I) {
                    var z;
                    "c2" === U ? z = "_p2" : "c1" === U && (z = "_p3"), v._isSamePoint(I[z], H) && (I[z] = M)
                }), R[U] = M
            }
        }, Ni.prototype.deleteRealPoint = function (A, q) {
            var C, Q, d, n, j, o, r, V = this,
                W = V._curves,
                v = {},
                I = [],
                g = Sf.Math.CubicBezier;
            for (Q = 0, d = W.length; d > Q; Q++) C = W[Q], n = C._p1, j = C._p2, o = C._p3, r = C._p4, (v[Q] || !V._isSamePoint(n, A)) && (V._isSamePoint(r, A) ? d > Q + 1 && V._isSamePoint(W[Q + 1]._p1, A) && (q || I.push(new g(n, j, W[Q + 1]._p3, W[Q + 1]._p4))) : I.push(C));
            V._curves = I
        }, Ni.prototype.findPairs = function (L, n) {
            var P, y, l, u, h, Y, K, I, p = this,
                T = p._curves,
                c = {},
                B = [];
            for (y = 0, l = T.length; l > y; y++) P = T[y], u = P._p1, h = P._p2, Y = P._p3, K = P._p4, !c[y] && p._isSamePoint(u, L) && (n ? B.push({
                point: u,
                r2: K
            }) : B.push({
                point: u,
                c2: h
            })), p._isSamePoint(K, L) && (I = n ? {
                point: K,
                r1: u
            } : {
                point: K,
                c1: Y
            }, l > y + 1 && p._isSamePoint(T[y + 1]._p1, L) && (n ? I.r2 = T[y + 1]._p4 : I.c2 = T[y + 1]._p2, c[y + 1] = !0), B.push(I));
            return B
        }, Ni.prototype.toHtShape = function () {
            var X = this,
                F = X._curves,
                S = [],
                t = [],
                q = {
                    x: 1 / 0,
                    y: 1 / 0
                };
            return F.forEach(function (R) {
                var d = R._p1,
                    T = R._p2,
                    C = R._p3,
                    n = R._p4;
                return X._isCloseEnough(d, q) || (S.push(1), t.push(d.clone())), q = n, X._isCloseEnough(d, T) && X._isCloseEnough(C, n) ? (S.push(2), t.push(n.clone()), void 0) : (S.push(4), t.push(T.clone(), C.clone(), n.clone()), void 0)
            }), {
                segments: S,
                points: t
            }
        };
        var xp = Sf.Math.CubicBezier = function ($, G, M, N) {
            var w = this;
            w._id = Sf.Math.CubicBezier._globalId++, w._p1 = $, w._p2 = G, w._p3 = M, w._p4 = N
        };
        xp._globalId = 1, xp.prototype = {}, xp.prototype.constructor = xp, xp.prototype.toString = function () {
            return this._id
        }, xp.prototype.intersectRect = function (h, S, W) {
            var d = S / 2,
                t = W / 2,
                G = h.x,
                o = h.y,
                k = Sf.Math.Vector2,
                u = new k(-d + G, -t + o),
                w = new k(d + G, t + o),
                l = new k(w.x, u.y),
                X = new k(u.x, w.y),
                B = this,
                L = B.intersectLine(u, l),
                q = B.intersectLine(l, w),
                H = B.intersectLine(w, X),
                Q = B.intersectLine(X, u),
                F = L.concat(q).concat(H).concat(Q);
            return F
        }, xp.prototype.intersectLine = function (l, F) {
            var d, T, G, u, Z, t, R, m, i, $, j, M, V, W = this,
                H = l.clone().min(F),
                Y = l.clone().max(F);
            u = W._p1, Z = W._p2, t = W._p3, R = W._p4, d = u.clone().multiplyScalar(-1), T = Z.clone().multiplyScalar(3), G = t.clone().multiplyScalar(-3), j = d.add(T).add(G).add(R), d = u.clone().multiplyScalar(3), T = Z.clone().multiplyScalar(-6), G = t.clone().multiplyScalar(3), $ = d.add(T).add(G), d = u.clone().multiplyScalar(-3), T = Z.clone().multiplyScalar(3), i = d.add(T), m = u.clone(), V = new Sf.Math.Vector2(l.y - F.y, F.x - l.x), M = l.x * F.y - F.x * l.y;
            for (var g = W.getRoots(V.dot(j), V.dot($), V.dot(i), V.dot(m) + M), B = new Array, e = 0, _ = g.length; _ > e; e++) {
                var r = g[e];
                if (!(0 > r || r > 1)) {
                    var Q = u.clone().lerp(Z, r),
                        h = Z.clone().lerp(t, r),
                        J = t.clone().lerp(R, r),
                        k = Q.lerp(h, r),
                        I = h.lerp(J, r),
                        E = k.lerp(I, r);
                    E.t = r, l.x == F.x ? H.y <= E.y && E.y <= Y.y && B.push(E) : l.y == F.y ? H.x <= E.x && E.x <= Y.x && B.push(E) : E.x >= H.x && E.y >= H.y && E.x <= Y.x && E.y <= Y.y && B.push(E)
                }
            }
            return B
        }, xp.prototype.solveTForPoint = function (c) {
            var B, w, y, U, X = this;
            B = X._p1.x - c.x, w = X._p2.x - c.x, y = X._p3.x - c.x, U = X._p4.x - c.x;
            for (var R = X.getRoots(U - 3 * y + 3 * w - B, 3 * y - 6 * w + 3 * B, 3 * w - 3 * B, B), o = p, v = 1 / 0, L = 0, Q = R.length; Q > L; L++) {
                var m = R[L];
                if (!(0 > m || m > 1)) {
                    var b = X._p1.clone().lerp(X._p2, m),
                        G = X._p2.clone().lerp(X._p3, m),
                        K = X._p3.clone().lerp(X._p4, m),
                        _ = b.lerp(G, m),
                        i = G.lerp(K, m),
                        F = _.lerp(i, m);
                    F.t = m;
                    var k = Math.abs(F.y - c.y);
                    v > k && (v = k, o = F)
                }
            }
            return o
        }, xp.prototype.getPointAt = function (X) {
            var T = this,
                p = T._p1,
                q = T._p2,
                k = T._p3,
                o = T._p4,
                s = p.clone().lerp(q, X),
                C = q.clone().lerp(k, X),
                l = k.clone().lerp(o, X),
                u = s.lerp(C, X),
                r = C.lerp(l, X);
            return u.lerp(r, X)
        }, xp.prototype.getRoots = function (u, n, q, r) {
            var E, p, B, F, o, s = new Array;
            if (Math.abs(u) < 1e-6) {
                var E = n,
                    p = q / E,
                    B = r / E,
                    F = p * p - 4 * B;
                if (F > 0) {
                    var o = Math.sqrt(F);
                    s.push(.5 * (-p + o)), s.push(.5 * (-p - o))
                } else 0 == F && s.push(.5 * -p)
            }
            n /= u, q /= u, r /= u, E = (3 * q - n * n) / 3, p = (2 * n * n * n - 9 * q * n + 27 * r) / 27;
            var R = n / 3,
                J = p * p / 4 + E * E * E / 27,
                K = p / 2;
            if (Math.abs(J) <= 1e-6 && (J = 0), J > 0) {
                var d, O, o = Math.sqrt(J);
                d = -K + o, O = d >= 0 ? Math.pow(d, 1 / 3) : -Math.pow(-d, 1 / 3), d = -K - o, d >= 0 ? O += Math.pow(d, 1 / 3) : O -= Math.pow(-d, 1 / 3), s.push(O - R)
            } else if (0 > J) {
                var t = Math.sqrt(-E / 3),
                    V = Math.atan2(Math.sqrt(-J), -K) / 3,
                    T = Math.cos(V),
                    N = Math.sin(V),
                    C = Math.sqrt(3);
                s.push(2 * t * T - R), s.push(-t * (T + C * N) - R), s.push(-t * (T - C * N) - R)
            } else {
                var d;
                d = K >= 0 ? -Math.pow(K, 1 / 3) : Math.pow(-K, 1 / 3), s.push(2 * d - R), s.push(-d - R)
            }
            return s
        }, xp.prototype._70I = function () {
            var m = this;
            return m._p1.distanceToSquared(m._p2) < 1e-10 && m._p3.distanceToSquared(m._p4) < 1e-10
        }, xp.prototype.insertKnot = function (k) {
            var z = this,
                w = z._p1,
                C = z._p2,
                e = z._p3,
                P = z._p4,
                j = w.clone().lerp(C, k),
                F = C.clone().lerp(e, k),
                q = e.clone().lerp(P, k),
                M = j.clone().lerp(F, k),
                V = F.clone().lerp(q, k),
                B = M.clone().lerp(V, k);
            return z._70I() ? (w.clone().lerp(P, k), [new Sf.Math.CubicBezier(w, w.clone(), B.clone(), B), new Sf.Math.CubicBezier(B, B.clone(), P.clone(), P)]) : [new Sf.Math.CubicBezier(w, j, M, B), new Sf.Math.CubicBezier(B, V, q, P)]
        };
        var kf = k.Default.getInternal().ui().EdgeUI,
            Qo = {
                _47O: function (K) {
                    var r = this,
                        h = Qo.getBackups()._47O;
                    Sf.inEdit(r.gv) || h.call(r, K)
                }
            };
        Sf.Inject.registAsModule(Qo, kf);
        var fr = k.Default.getInternal().ui().NodeUI,
            ej = {
                _47O: function (n) {
                    var u = this,
                        i = ej.getBackups()._47O;
                    Sf.inEdit(u.gv) || i.call(u, n)
                },
                getSelectWidth: function () {
                    var L = this,
                        B = L.gv,
                        C = L._data;
                    if (B.isEditable(C) && Sf.inEdit(B)) return 0;
                    var S = ej.getBackup("getSelectWidth");
                    return S.call(L)
                }
            };
        Sf.Inject.registAsModule(ej, fr);
        var Vc = k.graph.GraphView,
            Sj = {
                _editPointSize: function () {
                    var P = k.Default.isTouchable,
                        F = Sf.getStyle("pointSize");
                    return F[P ? 0 : 1]
                }(),
                isPointEditable: function (l) {
                    var w = this;
                    if (Sf.inEdit(w)) return w._pointEditableFunc ? w._pointEditableFunc(l) : !0;
                    var s = Sj.getBackup("isPointEditable");
                    s.call(w, l)
                },
                isEditable: function (n) {
                    var Y, p = this,
                        F = Sj.getBackup("isEditable");
                    if (Y = n instanceof Sf.Group ? !0 : F.call(p, n), !Sf.inEdit(p)) return Y;
                    if (!(n instanceof k.Edge)) return Y;
                    if (!n.s("2d.editable")) return !1;
                    var $ = p.getEditableFunc();
                    return $ ? $(n) : !0
                },
                _42: function (c, b) {
                    var E = this,
                        q = Sj.getBackups()._42;
                    if (q.call(E, c, b), Sf.inEdit(E)) {
                        var r = E.getEditInteractor();
                        r.drawImpl()
                    }
                }
            };
        Sf.Inject.registAsModule(Sj, Vc);
        var eg = k.Default.getInternal().ui().ShapeUI,
            Wh = {
                _47O: function (W) {
                    var z = this,
                        l = Wh.getBackups()._47O;
                    Sf.inEdit(z.gv) || l.call(z, W)
                }
            };
        Sf.Inject.registAsModule(Wh, eg);
        var Kk = k.graph.DefaultInteractor,
            Gb = {
                handle_mousewheel: function (v) {
                    var q = this,
                        S = Gb.getBackup("handle_mousewheel");
                    Sf.inEdit(q.gv) || S.call(q, v)
                }
            };
        Sf.Inject.registAsModule(Gb, Kk);
        var qp = k.graph.MoveInteractor,
            Qr = {
                _calcShift: function (X, t) {
                    var s = this,
                        a = Qr.getBackup("_calcShift"),
                        w = s.gv;
                    if (!Sf.inEdit(w)) return a.call(s, X, t);
                    var g = w.getEditInteractor(),
                        y = g.getSubModule("Move").calcShift(X, t, s);
                    return y || a.call(s, X, t)
                },
                clear: function (Q) {
                    var Z = this,
                        i = Qr.getBackup("clear");
                    i.call(Z, Q);
                    var g = Z.gv;
                    if (Sf.inEdit(g)) {
                        var b = g.getEditInteractor();
                        b.getSubModule("Move").clear(Q)
                    }
                }
            };
        Sf.Inject.registAsModule(Qr, qp);
        var Yh = Sf.Rect = function (B) {
            this.catalog = "Rect", this._interactor = B
        };
        Yh.prototype = {}, Yh.prototype.constructor = Yh, Yh.prototype.gatherInfo = function (f, N) {
            var F = this;
            if (1 === N.length) {
                var X = N[0];
                return X instanceof k.Shape && X._70I() ? F.gatherLine(f, X) : Jk(X, f) ? !1 : F.gatherSingleTarget(f, X)
            }
            return N.length > 1 ? F.gatherMultiTargets(f, N) : !1
        }, Yh.prototype.gatherSingleTarget = function (J, F) {
            if (F.getCorners) {
                var f, p = this,
                    j = p.info;
                p.target = F, f = p.screenInfo = {};
                var Q = F.getCorners();
                j.LT = new Sf.Math.Vector2(Q[0]), j.LB = new Sf.Math.Vector2(Q[1]), j.RB = new Sf.Math.Vector2(Q[2]), j.RT = new Sf.Math.Vector2(Q[3]), j.T = j.LT.clone().add(j.RT).divideScalar(2), j.B = j.LB.clone().add(j.RB).divideScalar(2), j.L = j.LT.clone().add(j.LB).divideScalar(2), j.R = j.RT.clone().add(j.RB).divideScalar(2);
                for (var k in j) f[k] = Sf.toScreenPosition(J, j[k]);
                var g = p._interactor,
                    q = g.getStyle("checkSize"),
                    L = function (h, S, A) {
                        var H = S.clone().sub(h).setLength(-q),
                            B = A.clone().sub(h).setLength(-q),
                            f = H.add(B).add(h);
                        return f
                    };
                return f.rotLT = L(f.LT, f.RT, f.LB), f.rotLB = L(f.LB, f.LT, f.RB), f.rotRB = L(f.RB, f.LB, f.RT), f.rotRT = L(f.RT, f.LT, f.RB), f.rotT = f.rotLT.clone().add(f.rotRT).divideScalar(2), f.rotB = f.rotLB.clone().add(f.rotRB).divideScalar(2), f.rotL = f.rotLT.clone().add(f.rotLB).divideScalar(2), f.rotR = f.rotRT.clone().add(f.rotRB).divideScalar(2), f.rotation = F.getRotation(), p.gatherConnectInfo(), !0
            }
        }, Yh.prototype.gatherConnectInfo = function () {
            var Y = this,
                D = Y.target,
                Z = Y._interactor,
                u = Y.screenInfo,
                t = Z.gv;
            if (t.isConnectActionVisible(D) && Z.getStyle("connectGuideVisible")) {
                var y;
                D.s && (y = D.s("connectGuideShift")), y || (y = Z.getStyle("connectGuideShift"));
                var $ = D.getAnchor(),
                    s = D.getSize(),
                    e = D.toGlobal({
                        x: s.width * (y[0] - $.x),
                        y: s.height * (y[1] - $.y)
                    });
                e = Sf.toScreenPosition(t, e), u.P1 ? e.add(u.P2.clone().sub(u.P1).setLength(y[2])) : (e.add(u.RT.clone().sub(u.LT).setLength(y[2])), e.add(u.LB.clone().sub(u.LT).setLength(y[3]))), u.connect = e
            }
        }, Yh.prototype.gatherMultiTargets = function (N, D) {
            var f = Sf.Group.findOrCreateGroup(D);
            if (!f) return !1;
            var J = this;
            return J.editing && "rotate" !== J.editing.mode || f.calcInfo(), J.gatherSingleTarget(N, f)
        }, Yh.prototype.gatherLine = function (X, e) {
            this.target = e;
            var o = this.screenInfo = {},
                t = e.getPoints(),
                j = Sf.getDataMatrix(e);
            return o.P1 = Sf.toScreenPosition(X, j.apply(t.get(0))), o.P2 = Sf.toScreenPosition(X, j.apply(t.get(1))), this.gatherConnectInfo(), !0
        }, Yh.ResizeKeys = ["LT", "RB", "LB", "RT", "L", "R", "B", "T"], Yh.ResizeDirection = [{
            x: -1,
            y: -1
        }, {
            x: 1,
            y: 1
        }, {
            x: -1,
            y: 1
        }, {
            x: 1,
            y: -1
        }, {
            x: -1,
            y: 0
        }, {
            x: 1,
            y: 0
        }, {
            x: 0,
            y: 1
        }, {
            x: 0,
            y: -1
        }], Yh.RotateKeys = ["rotLT", "rotRB", "rotLB", "rotRT", "rotL", "rotR", "rotB", "rotT"], Yh.prototype.check = function (n, D, K) {
            if (k.Default.isLeftButton(D)) {
                var M = this;
                if (M.editing = null, M.tipInfo = null, M.screenInfo) {
                    var e = M.target,
                        S = n.isEditable(e),
                        y = M.screenInfo;
                    if (S && y.connect) {
                        var O = M._checkConnect(K);
                        if (O) return O
                    }
                    if (y.P1) return M._checkLine(K);
                    var g, f, i, I = null,
                        E = M._interactor,
                        J = E.getStyle("checkSize");
                    if (S && n.isRectEditable(e))
                        for (f = 0; f < Sf.Rect.ResizeKeys.length; f++)
                            if (i = Sf.Rect.ResizeKeys[f], Sf.checkHit(K, y[i], J)) {
                                I = i, g = "resize";
                                break
                            }
                    if (!I && S && n.isRotationEditable(e) && !E.getStyle("rotateAsClock")) {
                        var o = E.getStyle("rotateCheckSize");
                        for (f = 0; f < Sf.Rect.RotateKeys.length; f++)
                            if (i = Sf.Rect.RotateKeys[f], Sf.checkHit(K, y[i], o)) {
                                I = i, g = "rotate";
                                break
                            }
                    }
                    if (!I) return E.setCursor("default"), void 0;
                    if ("rotate" === g) {
                        var c, b = n.lp(D);
                        if (e instanceof Sf.Group) {
                            var G = E.getStyle("groupRotateModeKey");
                            "string" == typeof G && (G = [G]);
                            for (var P = !1, F = 0, W = G.length; W > F; F++)
                                if (D[G[F]]) {
                                    P = !0;
                                    break
                                }
                            var U = E.getStyle("groupRotateModeDefault");
                            c = P ? "batch" === U ? "block" : "batch" : U
                        }
                        var Y = "batch" === c ? e.getAnchor2() : e.getPosition(),
                            A = Math.atan2(b.y - Y.y, b.x - Y.x);
                        E._setRotateCursor(A), M.editing = {
                            mode: g,
                            key: I,
                            pos: Y,
                            flipY: e.getScale().y < 0,
                            rotation: e.getRotation(),
                            hitRot: A
                        }, c && (M.editing.groupRotateMode = c)
                    } else {
                        var j = Sf.Rect.ResizeKeys.indexOf(I),
                            T = Sf.Rect.ResizeDirection[j],
                            r = Math.cos(e.getRotation()),
                            l = Math.sin(e.getRotation()),
                            t = T.x * Math.sign(e.getScale().x),
                            h = T.y * Math.sign(e.getScale().y),
                            x = Math.atan2(-l * t - r * h, r * t - l * h),
                            V = (Math.round(x / (Math.PI / 4)) + 8) % 8,
                            s = ["ew-resize", "nesw-resize", "ns-resize", "nwse-resize", "ew-resize", "nesw-resize", "ns-resize", "nwse-resize"][V];
                        this._interactor.setCursor(s);
                        var X = e.getWidth(),
                            B = e.getHeight(),
                            w = e.getAnchor();
                        M.editing = {
                            mode: g,
                            key: I,
                            rect: {
                                x: -X * w.x,
                                y: -B * w.y,
                                width: X,
                                height: B
                            },
                            anchor: w,
                            matrix: e.getMatrix()
                        }
                    }
                    return I
                }
            }
        }, Yh.prototype._checkLine = function (p) {
            var P = this;
            P.screenInfo;
            var s, y = P._interactor.getStyle("checkSize");
            if (Sf.checkHit(p, P.screenInfo.P1, y)) s = "P1";
            else {
                if (!Sf.checkHit(p, P.screenInfo.P2, y)) return this._interactor.setCursor("default"), void 0;
                s = "P2"
            }
            return P.editing = {
                mode: "line",
                key: s
            }, s
        }, Yh.prototype._checkConnect = function (B) {
            var v = this,
                $ = v.screenInfo,
                N = v._interactor,
                G = N.getStyle("connectGuideIntersectSize"),
                Y = $.connect,
                D = B.x,
                x = Y.x;
            if (x > D && G > x - D && Math.abs(Y.y - B.y) < G || D >= x && Sf.checkHit(B, Y, G)) {
                var E = "connect",
                    i = f.getConnectAction(N.gv);
                if (v.editing = {
                        mode: E
                    }, i && i.delete)
                    if (v.target instanceof Sf.Group) {
                        var X = !0;
                        N.gv.sm().getSelection().each(function (Z) {
                            i.delete.visible.call(null, N.gv, Z) || (X = !1)
                        }), v.editing.hasDeleteAction = X
                    } else i.delete.visible.call(null, N.gv, v.target) && (v.editing.hasDeleteAction = !0);
                return N.setCursor("default"), E
            }
        }, Yh.prototype._fireEditEvent = function (t, w) {
            var k = this._interactor,
                M = this.editing;
            if (M) {
                var r = M.mode;
                r = "rotate" === r ? "Rotation" : "connect" === r ? "Connection" : r[0].toUpperCase() + r.slice(1), k.fi({
                    kind: t + "Edit" + r,
                    event: w
                })
            }
        }, Yh.prototype.startEdit = function (x, v) {
            x.startDragging(v);
            var S = this;
            S._interactor.fi({
                kind: "prepareEdit",
                event: v
            });
            var Y = S.editing,
                b = S.target;
            if (Y) {
                if (S._fireEditEvent("begin", v), "rotate" === Y.mode) return Y.groupRotateMode && b.beginRotate(Y), void 0;
                if ("connect" !== Y.mode)("line" === Y.mode || b && 0 === b.getRotation()) && (S._inSmartGuide = !0, S._interactor.rectGuide.gatherRects());
                else if (Y.hasDeleteAction) {
                    var y = x.gv,
                        r = S._interactor.getStyle("connectGuideGarbageShift");
                    Y.garbageInfo = {
                        x: y.getWidth() * r[0] + r[2],
                        y: y.getHeight() * r[1] + r[3],
                        size: S._interactor.getStyle("connectGuideGarbageIntersectsize")
                    }, x._42()
                }
            }
        }, Yh.prototype._46O = function (O) {
            var C, Y, E = this,
                K = E.editing,
                i = E.target;
            if (K) {
                if ("connect" === K.mode && !K.canceled && !K.deleted) try {
                    K.garbageInfo && K.garbageInfo.hover ? f.doDeleteConnectionAction(E._interactor.gv, i) : f.doConnectAction(E._interactor.gv, i, K.target)
                } catch (V) {
                    console.error(V)
                }
                Y = K.freezeFlag, C = E.editing.groupRotateMode, E._fireEditEvent("end", O), E.editing = null
            }
            E.tipInfo = null, E._inSmartGuide && (E._interactor.rectGuide.clear(), E._inSmartGuide = !1), C && i && i.endRotate(), i instanceof k.Block && (Y === p ? delete i._freezeSyncFromChildren : i._freezeSyncFromChildren = Y, i.updateFromChildren())
        }, Yh.prototype.handleNormalStateDelete = function () {
            var u = this,
                T = u.editing;
            if (T && "connect" === T.mode && !T.canceled && !T.deleted) {
                if (T.garbageInfo) {
                    try {
                        f.doDeleteConnectionAction(u._interactor.gv, u.target)
                    } catch (C) {
                        console.error(C)
                    }
                    T.garbageInfo = null
                }
                return T.cursorPos = null, T.targetCorners = null, T.deleted = !0, u._interactor._42(), !0
            }
        }, Yh.prototype.handleNormalStateKeyDown = function (W) {
            var e = this,
                F = e.editing;
            return !F || "connect" !== F.mode || F.canceled || F.deleted ? void 0 : k.Default.isEsc(W) ? (F.cursorPos = null, F.targetCorners = null, F.canceled = !0, e._interactor._42(), !0) : void 0
        }, Yh.prototype.handleEdit = function (h, g) {
            var J = this,
                C = J.editing;
            if (C) {
                var p, j, S, v, W, r = J.target,
                    n = C.key,
                    X = C.mode,
                    e = h.lp(g),
                    q = J._interactor;
                if ("connect" === X) {
                    if (C.canceled) return;
                    if (C.deleted) return;
                    C.cursorPos = q._getLogicalPoint(g);
                    var F = C.garbageInfo;
                    return F && Sf.checkHit(C.cursorPos, F, F.size) ? (F.hover = !0, C.target = null, C.targetCorners = null) : (F && (F.hover = !1), C.target = h.getDataAt(e, function (w) {
                            return h.isSelectable(w) ? Cc(w) ? !0 : !1 : !1
                        }) || null, C.targetCorners = Sf.getTargetCornersOnScreen(h, C.target)), q._42(), void 0
                }
                if ("rotate" === X) {
                    var y, D, V = C.pos,
                        o = Math.atan2(e.y - V.y, e.x - V.x);
                    if (C.groupRotateMode ? D = o - C.hitRot : (y = o - C.hitRot, D = C.rotation + y), D %= 2 * Math.PI, 0 > D && (D += 2 * Math.PI), !k.Default.isCtrlDown(g)) {
                        var L, f;
                        Lg(g) ? (L = q.getStyle("shiftRotateRound"), f = L / 2) : (L = q.getStyle("rotateRound"), f = q.getStyle("rotateSensitivity")), D = Sf.roundTo(D, L, f)
                    }
                    C.groupRotateMode ? (y = D - (C.lastRotation || 0), 0 !== y && (r.addRotation(y, C.groupRotateMode), C.lastRotation = D)) : r.setRotation(D), q._setRotateCursor(o), D > Math.PI && (D -= 2 * Math.PI);
                    var K = 180 * (D / Math.PI);
                    K = K.toFixed(2), p = "" + K + ""
                } else if ("resize" === X) {
                    var O = C.rect;
                    S = O.x, v = O.y;
                    var Y, i = O.width,
                        Q = O.height,
                        u = C.anchor,
                        T = C.matrix,
                        b = r.s && r.s("keepAspectRatio") || q.getStyle("keepAspectRatio");
                    Lg(g) && (b = !b);
                    var G = J._unionPointMode1,
                        a = J._unionPointMode2;
                    if (J._inSmartGuide && !k.Default.isCtrlDown(g) && !b) {
                        var t;
                        "L" === n || "R" === n ? t = "x" : ("T" === n || "B" === n) && (t = "y"), J._adsorbedToClosest(e, t), W = !0
                    }
                    Y = T.tfi(e);
                    var M;
                    "LT" === n ? (O = G(Y, {
                        x: S + i,
                        y: v + Q
                    }, i, Q, b), M = 9) : "T" === n ? (O = a({
                        x: S,
                        y: Y.y
                    }, {
                        x: S + i,
                        y: v + Q
                    }, i, Q, b, "v"), M = 1) : "RT" === n ? (O = G(Y, {
                        x: S,
                        y: v + Q
                    }, i, Q, b), M = 33) : "L" === n ? (O = a({
                        x: Y.x,
                        y: v
                    }, {
                        x: S + i,
                        y: v + Q
                    }, i, Q, b, "h"), M = 8) : "R" === n ? (O = a({
                        x: S,
                        y: v
                    }, {
                        x: Y.x,
                        y: v + Q
                    }, i, Q, b, "h"), M = 32) : "LB" === n ? (O = G(Y, {
                        x: S + i,
                        y: v
                    }, i, Q, b), M = 12) : "B" === n ? (O = a({
                        x: S,
                        y: v
                    }, {
                        x: S + i,
                        y: Y.y
                    }, i, Q, b, "v"), M = 4) : "RB" === n && (O = G(Y, {
                            x: S,
                            y: v
                        }, i, Q, b), M = 36);
                    var _ = T.tf(O.x + O.width * u.x, O.y + O.height * u.y);
                    r instanceof k.Block && (C.hasOwnProperty("freezeFlag") || (C.freezeFlag = r._freezeSyncFromChildren, r._freezeSyncFromChildren = !0)), r.setPosition(_), r.setSize(O.width, O.height), W && (j = r.getRect(), q.rectGuide.gatherLines({
                        node: r,
                        x: j.x,
                        y: j.y,
                        w: j.width,
                        h: j.height
                    }, t, M)), p = "" + Math.round(O.width) + " * " + Math.round(O.height)
                } else if ("line" === X) {
                    if (Lg(g)) {
                        var H = r.getPoints(),
                            l = "P1" === n ? H.get(1) : H.get(0),
                            E = {
                                x: e.x - l.x,
                                y: e.y - l.y
                            },
                            s = q.getStyle("shiftLineRotateRound"),
                            P = J._shiftDirList;
                        if (!P || J._shiftRotateRound !== s) {
                            J._shiftRotateRound = s, J._shiftDirList = P = [];
                            for (var I = 0; I < Math.PI; I += s) P.push({
                                x: R(I),
                                y: w(I)
                            })
                        }
                        for (var m, z = 0, $ = 0, x = P.length; x > $; $++) {
                            var A = P[$],
                                d = A.x * E.x + A.y * E.y;
                            Math.abs(d) > Math.abs(z) && (z = d, m = A)
                        }
                        e = {
                            x: l.x + m.x * z,
                            y: l.y + m.y * z
                        }, q.rectGuide.clear()
                    } else J._inSmartGuide && !k.Default.isCtrlDown(g) && (J._adsorbedToClosest(e), W = !0);
                    var Z = Sf.getDataMatrix(r).applyInverse(e);
                    r.setPoint("P1" === n ? 0 : 1, Z, !0);
                    var N = r.getPoints(),
                        c = N.get(0),
                        B = N.get(1);
                    S = c.x - B.x, v = c.y - B.y, p = " " + Math.round(Math.sqrt(S * S + v * v)) + " ", W && (j = r.getRect(), q.rectGuide.gatherLines({
                        node: r,
                        x: j.x,
                        y: j.y,
                        w: j.width,
                        h: j.height
                    }))
                }
                if (p) {
                    var U = k.Default.getLogicalPoint(g, q._canvas);
                    U.x += Sf.Icons.TipShiftX, U.y += Sf.Icons.TipShiftY, J.tipInfo = {
                        helperPos: U,
                        text: p,
                        size: p.length
                    }
                }
                J._fireEditEvent("between", g)
            }
        }, Yh.prototype._unionPointMode1 = function (s, b, Y, y, P) {
            if (P && Y && y) {
                var _ = s.x - b.x,
                    t = s.y - b.y;
                Math.abs(_ * y) < Math.abs(t * Y) ? (t = Math.sign(t) * Math.abs(_ * y / Y), s.y = b.y + t) : (_ = Math.sign(_) * Math.abs(t * Y / y), s.x = b.x + _)
            }
            return k.Default.unionPoint(s, b)
        }, Yh.prototype._unionPointMode2 = function (y, p, q, a, K, h) {
            var w = k.Default.unionPoint(y, p);
            if (K && q && a) {
                var _;
                "v" === h ? (_ = w.x + w.width / 2, w.width = q * w.height / a, w.x = _ - w.width / 2) : (_ = w.y + w.height / 2, w.height = a * w.width / q, w.y = _ - w.height / 2)
            }
            return w
        }, Yh.prototype._adsorbedToClosest = function (z, Q) {
            var f = this,
                J = f._interactor,
                H = J.rectGuide.findClosest(z, Q),
                I = J.gridGuide.findClosest(z, Q),
                U = 1 / 0,
                y = 1 / 0;
            H && (isFinite(H.x) && (U = H.x), isFinite(H.y) && (y = H.y)), I && (isFinite(I.x) && Math.abs(I.x) < Math.abs(U) && (U = I.x), isFinite(I.y) && Math.abs(I.y) < Math.abs(y) && (y = I.y)), isFinite(U) && (z.x += U), isFinite(y) && (z.y += y)
        }, Yh.prototype._42 = function (M, T, n) {
            var O = this;
            O.info = {}, O.screenInfo = null;
            var x = O._interactor;
            if (!x.editDetail && O.gatherInfo(T, n)) {
                var $ = O.editing,
                    K = $ ? $.groupRotateMode : null,
                    f = O.screenInfo;
                "block" !== K && (f.P1 ? Sf.Icons.DrawIcon(x, M, Sf.Icons.Line, f) : Sf.Icons.DrawIcon(x, M, Sf.Icons.Rect, f), f.connect && (Sf.Icons.DrawIcon(x, M, Sf.Icons.ConnectGuide, {
                    rotation: f.rotation,
                    connect: f.connect,
                    cursorPos: $ ? $.cursorPos : null
                }), $ && ($.targetCorners && Sf.Icons.DrawIcon(x, M, Sf.Icons.NodeHoverGuide, $.targetCorners), $.garbageInfo && Sf.Icons.DrawIcon(x, M, Sf.Icons.ConnectGuideGarbage, $.garbageInfo))), O.tipInfo && Sf.Icons.DrawIcon(x, M, Sf.Icons.TipHelper, O.tipInfo)), O.target instanceof Sf.Group && O.target._42(x, M, T)
            }
        };
        var Kg = Sf.Anchor = function (G) {
            this.catalog = "Anchor", this._interactor = G
        };
        Kg.prototype = {}, Kg.prototype.constructor = Kg, Kg.prototype.gatherInfo = function (L, K) {
            var T = this;
            if (1 === K.length) {
                var u = K[0];
                if (!u.getAnchor) return;
                if (u instanceof k.Shape && u._70I()) return;
                if (Jk(u, L)) return;
                return T.gatherSingleTarget(L, K[0])
            }
            return K.length > 1 ? T.gatherMultiTargets(L, K) : !1
        }, Kg.prototype.gatherSingleTarget = function (p, y) {
            var h = this;
            return h.info.POS = y.getPosition(), h.screenInfo.POS = Sf.toScreenPosition(p, h.info.POS), h.target = y, !0
        }, Kg.prototype.gatherMultiTargets = function (j, G) {
            var e = this,
                E = Sf.Group.findOrCreateGroup(G);
            return E ? (e.screenInfo.POS = Sf.toScreenPosition(j, E.getAnchor2()), e.target = E, !0) : !1
        }, Kg.prototype.isVisible = function () {
            var V = this,
                X = V._interactor;
            if (X.getStyle("anchorVisible") === !1) return !1;
            var p = V.target;
            if (p) {
                if (this.editing) return !0;
                var O = p.getAnchor(),
                    U = X.getStyle("anchorOutsideVisibleThreshold");
                if (O.x < -U || O.x > 1 + U || O.y < -U || O.y > 1 + U) return !0;
                var d = p.getSize(),
                    Q = p.getScale(),
                    S = Math.min(Math.abs(d.width * Q.x), Math.abs(d.height * Q.y));
                if (S * X.gv._zoom < X.getStyle("anchorHideThreshold")) return !1
            }
            return !0
        }, Kg.prototype.check = function (y, L, l) {
            if (k.Default.isLeftButton(L)) {
                var X = this,
                    A = X._interactor;
                if (X.isVisible() && A.getStyle("anchorMovable") !== !1) {
                    X.editing = null, X.tipInfo = null;
                    var d = X.target;
                    if (d && y.isAnchorEditable(d) && y.isEditable(d)) {
                        var m;
                        if (X.screenInfo && (m = X.screenInfo.POS) && Sf.checkHit(l, new Sf.Math.Vector2(m), A.getStyle("checkSize"))) {
                            if (d instanceof Sf.Group) return X.editing = {}, !0;
                            var T = d.getWidth(),
                                g = d.getHeight(),
                                S = d.getAnchor();
                            return X.editing = {
                                rect: {
                                    x: -T * S.x,
                                    y: -g * S.y,
                                    width: T,
                                    height: g
                                },
                                anchor: S,
                                matrix: d.getMatrix()
                            }, !0
                        }
                    }
                }
            }
        }, Kg.prototype.startEdit = function (K, Z) {
            K.startDragging(Z), K.fi({
                kind: "beginEditAnchor",
                event: Z
            })
        }, Kg.prototype._46O = function (X) {
            var z = this;
            z.editing && (z.editing = null, z._interactor.fi({
                kind: "endEditAnchor",
                event: X
            })), z.tipInfo = null
        }, Kg.prototype.handleEdit = function (w, J) {
            var C = this,
                g = C.target;
            if (g) {
                var B = C.editing;
                if (B) {
                    var Q = w.lp(J),
                        N = C._interactor;
                    if (g instanceof Sf.Group) return g.setAnchor2(Q), N._42(), void 0;
                    var l = B.matrix,
                        i = l.tfi(Q),
                        q = B.rect,
                        r = (i.x - q.x) / q.width,
                        v = (i.y - q.y) / q.height;
                    if (!k.Default.isCtrlDown(J)) {
                        var _ = N.getStyle("anchorRound"),
                            U = N.getStyle("anchorSensitivity");
                        r = Sf.roundTo(r, _, U), v = Sf.roundTo(v, _, U)
                    }
                    g.setAnchor(r, v, !0);
                    var E = k.Default.getLogicalPoint(J, N._canvas);
                    E.x += Sf.Icons.TipShiftX, E.y += Sf.Icons.TipShiftY;
                    var m = "" + r.toFixed(2) + ", " + v.toFixed(2);
                    C.tipInfo = {
                        helperPos: E,
                        text: m,
                        size: m.length
                    }, N.fi({
                        kind: "betweenEditAnchor",
                        event: J
                    })
                }
            }
        }, Kg.prototype._42 = function (k, E, D) {
            var R = this;
            R.info = {}, R.screenInfo = {};
            var u = R._interactor;
            u.editDetail || R.gatherInfo(E, D) && R.isVisible() && (Sf.Icons.DrawIcon(u, k, Sf.Icons.Anchor, R.screenInfo), R.tipInfo && Sf.Icons.DrawIcon(u, k, Sf.Icons.TipHelper, R.tipInfo))
        };
        var Wb = Sf.RotateX = function (s) {
            this.catalog = "RotateX", this._interactor = s
        };
        Wb.prototype = {}, Wb.prototype.constructor = Wb, Wb.prototype.gatherInfo = function (v, R) {
            var y = this;
            if (1 === R.length) {
                var N = R[0];
                return N instanceof k.Shape && N._70I() || Jk(N, v) ? !1 : y.gatherSingleTarget(v, N)
            }
            return R.length > 1 ? y.gatherMultiTargets(v, R) : !1
        }, Wb.prototype.gatherSingleTarget = function () {
            var u = new k.Math.Vector2,
                x = new k.Math.Vector2,
                S = new k.Math.Vector2,
                V = new k.Math.Vector2,
                b = function (N, b) {
                    var C = N.x - b.x,
                        B = N.y - b.y;
                    return C * C + B * B
                };
            return function (j, B) {
                if (B.getCorners) {
                    var e = this,
                        K = B.getCorners(),
                        l = 15,
                        J = B.getPosition();
                    u.copy(K[0]), S.copy(K[1]), V.copy(K[3]), x.copy(u).add(V).divideScalar(2).add(u.sub(S).setLength(l / j.getZoom()));
                    var O = Math.max(b(J, K[0]), b(J, K[1]), b(J, K[2]), b(J, K[3]));
                    return e.info.POS = x.clone(), e.screenInfo.POS = Sf.toScreenPosition(j, e.info.POS), e.screenInfo.LEN = Math.sqrt(O) * j.getZoom() + l, e.screenInfo.CENTER = Sf.toScreenPosition(j, J), e.target = B, !0
                }
            }
        }(), Wb.prototype.gatherMultiTargets = function (o, S) {
            var N = this,
                $ = Sf.Group.findOrCreateGroup(S);
            if (!$) return !1;
            var N = this;
            return N.gatherSingleTarget(o, $)
        }, Wb.prototype.isVisible = function () {
            var C = this._interactor;
            if (!C.getStyle("rotateAsClock")) return !1;
            var a = this.target;
            if (!a) return !0;
            var Q = C.gv;
            return Q.isEditable(a) && Q.isRotationEditable(a) ? !0 : !1
        }, Wb.prototype.check = function (v, e, S) {
            var T = this,
                w = T._checkImpl(v, e, S);
            return (w || T._clockPainted) && T._interactor._42(), w
        }, Wb.prototype._checkImpl = function (y, Q, u) {
            if (k.Default.isLeftButton(Q)) {
                var N = this;
                N.editing = null, N.tipInfo = null;
                var t;
                if (N.screenInfo && (t = N.screenInfo.POS) && N.isVisible()) {
                    var X = N._interactor;
                    if (Sf.checkHit(u, t, X.getStyle("checkSize"))) {
                        var h = N.target,
                            j = y.lp(Q),
                            w = h.getPosition(),
                            x = Math.atan2(j.y - w.y, j.x - w.x);
                        return X._setRotateCursor(x), N.editing = {
                            pos: w,
                            rotation: h.getRotation(),
                            hitRot: x,
                            groupRotateMode: "block",
                            screenInfo: {
                                CENTER: N.screenInfo.CENTER,
                                LEN: N.screenInfo.LEN
                            }
                        }, !0
                    }
                }
            }
        }, Wb.prototype.startEdit = function (C, V) {
            C.startDragging(V), C.fi({
                kind: "beginEditRotation",
                event: V
            }), this.target instanceof Sf.Group && this.target.beginRotate(this.editing)
        }, Wb.prototype._46O = function (i) {
            var r = this;
            r.editing && (r.editing = null, r._interactor.fi({
                kind: "endEditRotation",
                event: i
            })), r.target instanceof Sf.Group && r.target.endRotate(), r.tipInfo = null
        }, Wb.prototype.handleEdit = function (n, t) {
            var M = this,
                G = M.editing;
            if (G) {
                var L, d, E = M.target,
                    U = n.lp(t),
                    v = M._interactor,
                    I = G.pos,
                    X = Math.atan2(U.y - I.y, U.x - I.x),
                    o = E instanceof Sf.Group;
                if (o ? d = X - G.hitRot : (L = X - G.hitRot, d = G.rotation + L), d %= 2 * Math.PI, 0 > d && (d += 2 * Math.PI), !k.Default.isCtrlDown(t)) {
                    var _, Z;
                    Lg(t) ? (_ = v.getStyle("shiftRotateRound"), Z = _ / 2) : (_ = v.getStyle("rotateRound"), Z = v.getStyle("rotateSensitivity")), d = Sf.roundTo(d, _, Z)
                }
                o ? (L = d - (G.lastRotation || 0), 0 !== L && (E.addRotation(L, G.groupRotateMode), G.lastRotation = d)) : E.setRotation(d), v._setRotateCursor(X), d > Math.PI && (d -= 2 * Math.PI);
                var l = 180 * (d / Math.PI),
                    Q = "" + l.toFixed(2) + "",
                    u = k.Default.getLogicalPoint(t, v._canvas);
                u.x += Sf.Icons.TipShiftX, u.y += Sf.Icons.TipShiftY, M.tipInfo = {
                    helperPos: u,
                    text: Q,
                    size: Q.length
                }, v.fi({
                    kind: "betweenEditRotation",
                    event: t
                })
            }
        }, Wb.prototype._42 = function (n, T, X) {
            var g = this;
            g._clockPainted = !1, g.info = {}, g.screenInfo = {};
            var V = g._interactor;
            V.editDetail || g.gatherInfo(T, X) && g.isVisible() && (Sf.Icons.DrawIcon(V, n, Sf.Icons.RoundPoint, g.screenInfo.POS), g.tipInfo && Sf.Icons.DrawIcon(V, n, Sf.Icons.TipHelper, g.tipInfo), g.editing && g.drawClock(n))
        }, Wb.prototype.drawClock = function (x) {
            x.save();
            var q = this;
            q._clockPainted = !0;
            var M = q.editing || {},
                p = M.screenInfo || q.screenInfo,
                i = p.LEN,
                s = i + 8,
                Q = i + 18;
            x.save(), x.translate(p.CENTER.x, p.CENTER.y), x.beginPath(), x.strokeStyle = "rgb(150, 150, 150)";
            for (var F, U, V, o, O, u = 0; 360 > u; u++) F = u * Math.PI / 180, 0 === u % 5 && (U = w(F) * i, V = R(F) * i, o = w(F) * s, O = R(F) * s, x.moveTo(U, V), x.lineTo(o, O)), 0 === u % 45 && (U = w(F) * i, V = R(F) * i, o = w(F) * Q, O = R(F) * Q, x.moveTo(U, V), x.lineTo(o, O));
            x.stroke(), x.rotate(-g);
            var n = M.lastRotation || q.target.getRotation();
            x.beginPath(), x.fillStyle = "rgba(255, 0, 0, 0.1)", x.strokeStyle = "rgb(157, 157, 157)", x.moveTo(0, 0), x.arc(0, 0, Q, 0, n, !1), x.fill(), x.beginPath(), x.moveTo(0 + Q, 0), x.arc(0, 0, Q, 0, n, !1), x.stroke(), x.restore()
        };
        var Ni = Sf.Curve = function (R) {
            this.catalog = "Curve", this._interactor = R
        };
        Ni.prototype = {}, Ni.prototype.constructor = Ni, x.defineProperties(Ni.prototype, {
            activing: {
                get: function () {
                    return this._activing
                },
                set: function (J) {
                    var r = this;
                    if (J) r._activing = new Sf.CurveActiving(this, J);
                    else {
                        var n = r._activing;
                        n && n.dispose(), r._activing = null
                    }
                }
            }
        }), Ni.PointType = {
            Mirrored: 0,
            Straight: 1,
            Disconnected: 2,
            Asymmetric: 3
        }, Ni.prototype.setUp = function () {
            var x = this,
                d = x._interactor;
            d && d.gv.mp(x._onGraphviewPropertyChanged, x)
        }, Ni.prototype._onGraphviewPropertyChanged = function (d) {
            ("zoom" === d.property || "translateX" === d.property || "translateY" === d.property) && this._handleDataChanged()
        }, Ni.prototype.tearDown = function () {
            var M = this,
                X = M._interactor;
            X && X.gv.ump(M._onGraphviewPropertyChanged, M)
        }, Ni.prototype.canEnterEditDetailMode = function () {
            var K = this,
                p = K._interactor,
                O = p._getValidSelection();
            if (1 === O.length) {
                var f = O[0],
                    I = f instanceof k.Edge;
                if (f instanceof k.Shape || I) {
                    if (I) {
                        var D = f.s("edge.type");
                        if (D && "points" !== D) return
                    }
                    var G = p.gv;
                    if (G.isPointEditable(f) && G.isEditable(f)) return K.target = f, !0
                }
            }
        }, Ni.prototype.canQuitEditDetailMode = function (I) {
            var Z = this,
                d = Z._interactor._getLogicalPoint(I);
            return Z._checkEditRealPoint(d) ? void 0 : Z._interactor.gv.getDataAt(I) !== Z.target ? !0 : void 0
        }, Ni.prototype.preHandleScroll = function () {
            var Z = this.editing;
            return Z && Z.inEdit ? !0 : void 0
        }, Ni.prototype.getCurrentSelectintStatus = function () {
            var X = this;
            if (X.activing && !X.activing.selections) {
                if (X.activing.status != p) return X.activing.status;
                var r = function (o) {
                        var g = X.activing.status;
                        X.activing.status = o, X._interactor.fp("shapePointStatus", g, o)
                    },
                    m = Sf.Curve.PointType,
                    g = X.activing.point,
                    W = X.activing.pairs;
                if (!W || 1 !== W.length) return r(m.Mirrored);
                var Y = W[0],
                    L = Y.c1 && Y.c1.isNearEnough(g),
                    y = Y.c2 && Y.c2.isNearEnough(g);
                if (!Y.c1 || !Y.c2) return L || y ? r(m.Straight) : r(m.Disconnected);
                if (L && y) return r(m.Straight);
                if (L || y) return r(m.Asymmetric);
                var n = Y.c1.clone().sub(g),
                    V = Y.c2.clone().sub(g);
                return Math.abs(n.x * V.y - n.y * V.x) > 1e-5 || n.x * V.x > 0 ? r(m.Disconnected) : Math.abs(n.length() - V.length()) > 1e-5 ? r(m.Asymmetric) : r(m.Mirrored)
            }
        }, Ni.prototype.handle_keydown = function (c) {
            var d = this;
            if (d._interactor.editDetail) {
                var Y = Sf.Curve.PointType;
                "1" === c.key ? d._setCurrentSelectionStatus(Y.Straight) : "2" === c.key ? d._setCurrentSelectionStatus(Y.Mirrored) : "3" === c.key ? d._setCurrentSelectionStatus(Y.Disconnected) : "4" === c.key && d._setCurrentSelectionStatus(Y.Asymmetric)
            }
        }, Ni.prototype.setCurrentSelectionStatus = function (P) {
            var D = this,
                U = D._interactor;
            if (U) {
                var F = U.gv;
                F.dm().beginTransaction(), this._setCurrentSelectionStatus(P), F.dm().endTransaction()
            }
        }, Ni.prototype._setCurrentSelectionStatus = function (E) {
            var k = this,
                u = k.activing;
            if (u) {
                var b = k.getCurrentSelectintStatus();
                if (null !== b && b !== E) {
                    u.status = E;
                    var _ = k.activing.point,
                        U = k.activing.pairs;
                    if (U && 1 === U.length) {
                        var d = U[0],
                            M = k.screenInfo.curve,
                            P = Sf.Curve.PointType,
                            C = function () {
                                k._writeToHt(), k._interactor.fp("shapePointStatus", b, E)
                            };
                        if (E === P.Straight) return M.moveCtrlPoint(d, _, "c1"), M.moveCtrlPoint(d, _, "c2"), C(), void 0;
                        if (b === P.Straight) {
                            var X = M.findPairs(_, !0),
                                v = X[0],
                                x = v.r1 || _,
                                g = v.r2 || _,
                                H = g.clone().sub(x).multiplyScalar(.25);
                            return M.moveCtrlPoint(d, _.clone().sub(H), "c1"), M.moveCtrlPoint(d, _.clone().add(H), "c2"), C(), void 0
                        }
                        var T = d.c1,
                            W = d.c2;
                        if (T && W) {
                            if (E === P.Mirrored) return M.moveCtrlPoint(d, _.clone().multiplyScalar(2).sub(W), "c1"), C(), void 0;
                            if (E === P.Asymmetric && b === P.Disconnected) {
                                var y = T.clone().sub(_).length(),
                                    H = _.clone().sub(W).setLength(y).add(_);
                                return M.moveCtrlPoint(d, H, "c1"), C(), void 0
                            }
                        }
                        u._firePointChange(), k._interactor.fp("shapePointStatus", b, E)
                    }
                }
            }
        }, Ni.prototype._handleDataChanged = function (H) {
            var n = this;
            if (n.screenInfo && n.target) {
                var L = n._interactor;
                n.gatherSingleTarget(L.gv, n.target, !0), n.check(L.gv, null, H ? L._getLogicalPoint(H) : new Sf.Math.Vector2(L._lastClientPoint)), L._42()
            }
        }, Ni.prototype.gatherSingleTarget = function (Y, R, P) {
            var S, o, m = this;
            m.screenInfo && m.screenInfo.curve && (o = m.screenInfo.curve._curves);
            var V = m.editing;
            S = V ? m.screenInfo : m.screenInfo = {};
            var I, s, h = R instanceof k.Edge;
            h ? (I = R.s("edge.segments"), s = R.s("edge.points") || new k.List) : (I = R._58O, s = R._59O), S.S = I;
            var u, M = S.P = [],
                n = Sf.getDataMatrix(R);
            if (R instanceof k.Polyline && (u = R.getElevation() || 0, S.E = []), s.each(function (T) {
                    S.E && S.E.push(T.e || u), T = n.apply(T);
                    var y = Sf.toScreenPosition(Y, T);
                    M.push(y.x, y.y)
                }), h) {
                var e = Sf.toScreenPosition(Y, R._lastSourcePoint),
                    W = Sf.toScreenPosition(Y, R._lastTargetPoint);
                M.splice(0, 0, e.x, e.y), M.push(W.x, W.y)
            }
            if (!S.S || !S.S.size()) {
                S.S = new k.List, S.S.add(1);
                for (var B = 0; B < M.length / 2 - 1; B++) S.S.add(2)
            }
            if ((!V || P) && m.convertToCubicBezier(o), m.activing && (P || !m.editing || "realPoint" === m.editing.type)) {
                var t = S.curve.findPairs(m.activing.point);
                m.activing.pairs = t
            }
            h && "points" !== R.s("edge.type") && m._writeToHt()
        }, Ni.prototype._convertToNewPoint = function (Y, p, t) {
            var f, j, O;
            for (f = 0, j = p.length; j > f; f++) {
                if (O = p[f], O._p1.isNearEnough(Y)) return O._p1;
                if (O._p4.isNearEnough(Y)) return O._p4
            }
            if (t)
                for (f = 0, j = Math.min(t.length, j); j > f; f++) {
                    if (O = t[f], O._p1 === Y) return p[f]._p1;
                    if (O._p4 === Y) return p[f]._p4
                }
        }, Ni.prototype.convertToCubicBezier = function (i) {
            var S, u, X = this,
                m = new Sf.Math.Curve,
                A = X.screenInfo;
            if (m.createFromHtShape(A.P, A.S, A.E), A.curve = m, X.activing) {
                var R = m._curves;
                if (S = X.activing.point, u = X._convertToNewPoint(S, R, i), u && (X.activing.point = u), X.activing.selections) {
                    var b = -1,
                        G = X.activing.selections;
                    G.forEach(function (E) {
                        b++, u = X._convertToNewPoint(E, R, i), u && (G[b] = u)
                    })
                }
            }
        }, Ni.prototype.check = function (S, r, a) {
            if (!r || k.Default.isLeftButton(r)) {
                var U = this;
                if (U._interactor.setCursor("default"), U.editing = null, U.highlight = null, U.tipInfo = null, U.screenInfo) {
                    if (Bo()) return U._interactor._42(), !0;
                    if (U._checkEditCtrlPoint(a)) return U._interactor._42(), !0;
                    if (U._checkEditRealPoint(a)) return U._interactor._42(), !0;
                    if (U._checkEditElevation(a)) return U._interactor._42(), !0;
                    var d = U.screenInfo.curve,
                        l = d.checkPoint(a, U._interactor.getStyle("curveIntersectSize"));
                    if (l) {
                        var J = U.highlight = {};
                        J.type = "insertKnot", J.bezier = l.bezier, J.point = l.intersection
                    }
                    return U._interactor._42(), !0
                }
            }
        }, Ni.prototype._checkEditRealPoint = function (F) {
            var w, H, a, S, K, f, V = this,
                Q = V.screenInfo.curve._curves,
                v = V._interactor.getStyle("curvePointIntersectSize"),
                l = 1 / 0;
            for (v *= v, a = 0, S = Q.length; S > a; a++) w = Q[a], K = w._p1, f = F.distanceToSquared(K), l > f && (l = f, H = K), K = w._p4, f = F.distanceToSquared(K), l > f && (l = f, H = K);
            if (l > v) return !1;
            var X = V.highlight = {};
            return X.type = "changeRealPoint", X.point = H, V.editing = {
                type: "realPoint",
                point: H,
                shiftGuide: {
                    point: H.clone(),
                    dir: "x",
                    limit: 0
                }
            }, V._interactor.setCursor("crosshair"), !0
        }, Ni.prototype._checkEditElevation = function (d) {
            var W = this;
            if (!W._interactor.getStyle("curveElevationVisible")) return !1;
            var Z = W.activing;
            if (!Z) return !1;
            var b = Z.getCurrentEditingPoint();
            if (!b) return !1;
            var P = W._interactor,
                M = P.getStyle("curveElevationGuideShift"),
                G = P.getStyle("curveElevationIntersectSize"),
                R = d.distanceToSquared({
                    x: b.x + M[0],
                    y: b.y + M[1]
                });
            if (!(R > G * G)) {
                var U = W.highlight = {};
                U.type = "elevation";
                var X = new Sf.Math.Vector2(d.x, d.y, b.e);
                return W.editing = {
                    type: "elevation",
                    startPoint: X
                }, W._interactor.setCursor("crosshair"), !0
            }
        }, Ni.prototype._checkEditCtrlPoint = function (N) {
            var x = this;
            if (x.activing && !x.activing.selections) {
                var Y = x.getCurrentSelectintStatus();
                if (Y !== Sf.Curve.PointType.Straight) {
                    var k = x.activing.pairs;
                    if (k) {
                        var $ = x._interactor.getStyle("curvePointIntersectSize");
                        $ *= $;
                        var D, b, r, P, E, L, j, T, e, S = 1 / 0;
                        for (j = 0, e = k.length; e > j; j++)
                            for (P = k[j], T = 0; 2 > T; T++) E = 0 === T ? "c1" : "c2", P[E] && (L = N.distanceToSquared(P[E]), S > L && (S = L, D = P, b = j, r = E));
                        if (S > $) return !1;
                        x.activing.hlpair = D, x.activing.hltype = r;
                        var h = x.highlight = {};
                        return h.type = "changeCtrlPoint", h.point = D[r], x.editing = {
                            type: "ctrlPoint",
                            pair: D,
                            pairId: b,
                            ctrlType: r,
                            direction: D[r].clone().sub(x.activing.point).normalize()
                        }, x._interactor.setCursor("crosshair"), !0
                    }
                }
            }
        }, Ni.prototype.startEdit = function (A, C) {
            A.startDragging(C);
            var U = this;
            U.highlight && "insertKnot" === U.highlight.type && (U.insertKnot(), U.gatherSingleTarget(U._interactor.gv, U.target), U.activing = null, U._checkEditRealPoint(U._interactor._getLogicalPoint(C)));
            var s = U._activing;
            if (s) {
                var n = U.editing ? U.editing.type : null;
                "ctrlPoint" === n ? s.editingCtrl = {
                    pairId: U.editing.pairId,
                    type: s.hltype
                } : "realPoint" === n && (s.editingCtrl = !1)
            }
            var I = U.highlight,
                R = k.Default.isCtrlDown(C);
            if (!I || Bo()) {
                var b = U._interactor.gv;
                if (!b.setFocus(C) || b._scrolling) return;
                return b.isPannable() && Bf(C) && !R && (U._pan = {
                    tx: b.tx(),
                    ty: b.ty()
                }, A.fi({
                    kind: "beginPan",
                    event: C
                })), void 0
            }
            if ("changeRealPoint" === I.type) {
                var $, o = U.activing ? U.activing.point : null,
                    H = U.activing ? U.activing.selections : null;
                if (R && U.activing) o === I.point ? (H ? (U.activing = {
                    point: H[0]
                }, H.length > 1 && (H.splice(0, 1), U.activing.selections = H)) : U.activing = null, U.editing = null) : H && ($ = H.indexOf(I.point)) >= 0 ? (H.length > 1 ? H.splice($, 1) : delete U.activing.selections, U.editing = null) : H ? (H.push(o), U.activing = {
                    point: I.point,
                    selections: H
                }) : U.activing = {
                    point: I.point,
                    selections: [o]
                };
                else if (H) o === I.point || (($ = H.indexOf(I.point)) >= 0 ? (H.splice($, 1, o), U.activing = {
                    point: I.point,
                    selections: H
                }) : U.activing = {
                    point: I.point
                });
                else {
                    var W;
                    o === I.point && (W = U.activing.status), U.activing = {
                        point: I.point
                    }, W && (U.activing.status = W)
                }
                A.fi({
                    kind: "beginEditPoint",
                    event: C
                })
            }
        }, Ni.prototype.insertKnot = function () {
            var W = this,
                H = W.highlight,
                F = W.screenInfo.curve;
            F.insertKnot(H.bezier, H.point.t), W._writeToHt()
        }, Ni.prototype._writeToHt = function () {
            var t, r, s, U, w = this,
                x = w.screenInfo.curve,
                K = x.toHtShape(),
                c = K.points,
                j = [],
                h = K.segments,
                X = w._interactor.gv,
                T = w.target,
                V = T instanceof k.Edge,
                y = Sf.getDataMatrix(T).invert();
            U = T instanceof k.Polyline, U && (s = T.getElevation());
            for (var Y = 0, O = c.length; O > Y; Y++) t = c[Y], r = Sf.toWorldPosition(X, t), r = y.apply(r), t.e != p && t.e !== s && (r.e = t.e), j.push(r);
            if (T._writing = !0, V) {
                T.s("edge.type", "points"), T.setStyle("edge.segments", h), T.setStyle("edge.points", j.slice(1, j.length - 1)), T.setStyle("edge.source.offset.x", 0), T.setStyle("edge.source.offset.y", 0), T.setStyle("edge.target.offset.x", 0), T.setStyle("edge.target.offset.y", 0);
                var d = w._nextChangeEdgeHost;
                delete w._nextChangeEdgeHost, d && ("source" === d.type ? T.setSource(d.host) : T.setTarget(d.host)), w._writeEdgeHostAnchor("source", j[0]), w._writeEdgeHostAnchor("target", j[j.length - 1])
            } else j.length ? (T.setSegments(h), T.setPoints(j, !0)) : T.removeFromDataModel();
            delete T._writing
        }, Ni.prototype._writeEdgeHostAnchor = function (o, K) {
            var X = this,
                b = X.target,
                M = X._calcHostAnchor(b, o, K);
            b.s("edge." + o + ".anchor.x", M.x), b.s("edge." + o + ".anchor.y", M.y), M.offsetX || M.offsetY ? (b.s("edge." + o + ".offset.x", M.offsetX), b.s("edge." + o + ".offset.y", M.offsetY)) : (b.s("edge." + o + ".offset.x", 0), b.s("edge." + o + ".offset.y", 0))
        }, Ni.prototype._calcHostAnchor = function (R, Z, Y, t) {
            t || (t = "source" === Z ? R.getSource() : R.getTarget());
            var E = this._interactor.gv,
                U = E.calculateAttachPoint(t, Y);
            if (U) return U.info;
            var $ = t.getRotation(),
                F = t.getAnchor();
            if (Jk(t, E) && ($ = 0), $) {
                var n = t.getMatrix(),
                    A = n.tfi(Y),
                    f = t.getSize();
                return {
                    x: A.x / f.width + F.x,
                    y: A.y / f.height + F.y
                }
            }
            var C = Ad(E, t),
                p = {
                    x: (Y.x - C.x) / C.width,
                    y: (Y.y - C.y) / C.height
                };
            return p
        }, Ni.prototype._handlePanning = function (d) {
            var I = this,
                t = I._pan;
            if (t) {
                t.started = !0;
                var C = I._interactor,
                    g = C.gv,
                    X = C._lastClientPoint,
                    u = Fc(d);
                g.setTranslate(t.tx + u.x - X.x, t.ty + u.y - X.y), I.gatherSingleTarget(C.gv, I.target), C._42(), C.fi({
                    kind: "betweenPan",
                    event: d
                })
            }
        }, Ni.prototype.handleEdit = function (Y, G) {
            var s = this,
                U = s.editing;
            if (s._pan) return s._handlePanning(G), void 0;
            if (U) {
                U.inEdit = !0;
                var e, m, F, g = s._interactor._getLogicalPoint(G),
                    M = k.Default.isCtrlDown(G),
                    n = k.Default.isShiftDown(G),
                    h = U.type,
                    f = s.activing;
                if (s._guideInfo = null, "ctrlPoint" === h && n) {
                    var W = s.editing.direction.clone();
                    e = f.point;
                    var u = W.dot(g.clone().sub(e));
                    g = W.setLength(u).add(e)
                } else if ("ctrlPoint" === h || "realPoint" === h) {
                    var W;
                    if ("realPoint" === h && n) {
                        var K = s.editing.shiftGuide;
                        m = K.point;
                        var E = Math.abs(g.x - m.x),
                            V = Math.abs(g.y - m.y);
                        E > V && E > K.limit && "y" === K.dir && (K.dir = "x"), V > E && V > K.limit && "x" === K.dir && (K.dir = "y"), W = K.dir, "x" === W ? (g.y = m.y, K.limit = Math.max(K.limit, E)) : "y" === W && (g.x = m.x, K.limit = Math.max(K.limit, V))
                    }
                    var q = s._isEditEdgeSourceTarget();
                    if (q) {
                        var T = s._editEdgeSourceTarget(q, g, M);
                        T && (F = T.tipText)
                    } else if (!M) {
                        var I = s._guidingToEdit(g, W),
                            x = "realPoint" === h ? s._interactor.gridGuide.findClosest(g, W, !0) : null,
                            S = 1 / 0,
                            d = 1 / 0;
                        x && (x.x && (S = x.x), x.y && (d = x.y));
                        var $ = !1;
                        I && (I.xList && (Math.abs(I.x) <= Math.abs(S) ? ($ = !0, S = I.x) : delete I.xList), I.yList && (Math.abs(I.y) <= Math.abs(d) ? ($ = !0, d = I.y) : delete I.yList), $ && (s._guideInfo = I)), isFinite(S) && (g.x += S), isFinite(d) && (g.y += d), $ && (I.v = g)
                    }
                }
                var X = s.screenInfo.curve;
                if ("realPoint" === U.type) {
                    e = U.point, e.e !== p && (g.e = e.e), X.moveRealPoint(e, g), U.point = g, s.highlight.point = g;
                    var t = f.status,
                        b = f.selections;
                    if (s.activing = {
                            point: g,
                            status: t
                        }, b) {
                        var D = g.clone().sub(e),
                            c = 0;
                        b.forEach(function (O) {
                            var R = O.clone().add(D);
                            X.moveRealPoint(O, R), b[c++] = R
                        }), s.activing.selections = b
                    }
                } else if ("ctrlPoint" === U.type) {
                    var l = f.pairs,
                        v = l[U.pairId];
                    X.moveCtrlPoint(v, g, U.ctrlType);
                    var B = f.status,
                        z = Sf.Curve.PointType;
                    if ((B === z.Mirrored || B === z.Asymmetric) && v.c1 && v.c2) {
                        var e = new Sf.Math.Vector2(f.point),
                            y = "c1" === U.ctrlType ? "c2" : "c1";
                        if (B === Sf.Curve.PointType.Mirrored) X.moveCtrlPoint(v, e.clone().multiplyScalar(2).sub(g), y);
                        else if (B === z.Asymmetric) {
                            var u = v[y].clone().sub(e).length(),
                                i = e.clone().sub(v[U.ctrlType]).setLength(u).add(e);
                            isNaN(i.x) || X.moveCtrlPoint(v, i, y)
                        }
                    }
                    f._firePointChange()
                } else if ("elevation" === U.type) {
                    m = U.startPoint;
                    var H = m.e + (m.y - g.y) / Y._zoom;
                    s._setCurrentPointImpl("e", H), f._firePointChange(), F = "E: " + Sf.toFixed(H)
                }
                var A = k.Default.getLogicalPoint(G, s._interactor._canvas);
                if (A.x += Sf.Icons.TipShiftX, A.y += Sf.Icons.TipShiftY, !F) {
                    var _ = Sf.toWorldPosition(Y, g);
                    F = "" + Sf.toFixed(_.x) + ", " + Sf.toFixed(_.y)
                }
                s.tipInfo = {
                    helperPos: A,
                    text: F,
                    size: F.length
                }, s._writeToHt(), s._interactor.fi({
                    kind: "betweenEditPoint",
                    event: G
                })
            }
        }, Ni.prototype._setCurrentPointImpl = function (j, w) {
            var Z = this,
                L = Z._activing;
            if (!L) return !1;
            var K = Z.target;
            if (!K) return !1;
            var $ = L.getCurrentEditingPoint();
            if (!$) return !1;
            var s = L.editingCtrl;
            if (!s) var c = $.clone();
            if ("e" === j) $.e = w;
            else {
                var x;
                if ("x" === j || "y" === j) {
                    var S = L._lastFirePoint;
                    x = "x" === j ? {
                        x: w,
                        y: S ? S.y : 0
                    } : {
                        x: S ? S.x : 0,
                        y: w
                    }
                } else "object" == typeof j ? (x = j, j.e !== p && ($.e = j.e)) : (x = {
                    x: arguments[0],
                    y: arguments[1]
                }, arguments[2] !== p && ($.e = arguments[2]));
                var E = Sf.getDataMatrix(K);
                x = Sf.toScreenPosition(Z._interactor.gv, E.apply(x)), $.x = x.x, $.y = x.y
            }
            if (!s) {
                var n = c.multiplyScalar(-1).add($);
                $.e && c.e && (n.e = $.e - c.e), Z.screenInfo.curve.moveCtrlDueToRealPointMovement($, n)
            }
            return !0
        }, Ni.prototype.setCurrentPoint = function (X, t) {
            return this._setCurrentPointImpl(X, t) ? (this._writeToHt(), !0) : !1
        }, Ni.prototype._isEditEdgeSourceTarget = function () {
            var B = this,
                E = B.target;
            if (!(E instanceof k.Edge)) return !1;
            var K = B.editing.point,
                O = B.screenInfo.curve._curves;
            return K === O[0]._p1 ? "source" : K === O[O.length - 1]._p4 ? "target" : !1
        }, Ni.prototype._editEdgeSourceTarget = function (i, m, G) {
            var U, f = this,
                _ = f.target;
            if (U = "source" === i ? _.getSource() : _.getTarget()) {
                var k = f._interactor.gv,
                    g = Sf.toWorldPosition(k, m),
                    u = f._calcHostAnchor(_, i, g, U);
                if (f._interactor.getStyle("edgeHostDetectPerFrame") || u.x < 0 || u.x > 1 || u.y < 0 || u.y > 1) {
                    var M = k.getDataAt(g, function (H) {
                        return k.isSelectable(H) ? Cc(H) ? !0 : !1 : !1
                    });
                    if (M) {
                        var P = f._calcHostAnchor(_, i, g, M);
                        U = M, f._nextChangeEdgeHost = {
                            type: i,
                            host: M
                        }, u = P
                    }
                }
                var d;
                if (!G) {
                    var H = f._interactor.getStyle("anchorRound"),
                        h = f._interactor.getStyle("anchorSensitivity");
                    d = k.calculateAttachPoint(U, g), d ? u = d.info : (u.x = Sf.roundTo(u.x, H, h), u.y = Sf.roundTo(u.y, H, h))
                }
                if (!G) {
                    var o = U.getAttachPosition(u.x, u.y, u.offsetX, u.offsetY),
                        E = Sf.toScreenPosition(k, o);
                    m.x = E.x, m.y = E.y
                }
                f._edgeHostGuideInfo = {
                    corners: Sf.getTargetCornersOnScreen(k, U),
                    attach: d ? d.index : -1,
                    host: U
                };
                var I = "" + u.x.toFixed(2) + ", " + u.y.toFixed(2);
                return (u.offsetX || u.offsetY) && (I += " offset: " + u.offsetX.toFixed(2) + ", " + u.offsetY.toFixed(2)), {
                    host: U,
                    anchor: u,
                    tipText: I
                }
            }
        }, Ni.prototype._guidingToEdit = function (P, J) {
            var H, x, L = this;
            if (H = L.screenInfo.curve) {
                x = H._curves;
                var $, A, t, l, D, f, w, n, R = 1 / 0,
                    U = 1 / 0,
                    M = [];
                for (L.editing && "realPoint" === L.editing.type && (n = L.editing.point), D = 0, f = 2 * x.length; f > D; D++) w = x[Math.floor(D / 2)][D % 2 ? "_p4" : "_p1"], M.indexOf(w) >= 0 || (M.push(w), n && n === w || (t = w.x - P.x, l = w.y - P.y, Math.abs(t) < Math.abs(R) ? (R = t, $ = [w]) : t === R && $.push(w), Math.abs(l) < Math.abs(U) ? (U = l, A = [w]) : l === U && A.push(w)));
                var g = L._interactor.getStyle("smartGuideSensitivity");
                if ((Math.abs(R) > g || "y" === J) && ($ = null), (Math.abs(U) > g || "x" === J) && (A = null), $ || A) {
                    var u = !1,
                        F = {};
                    if ($ && (u = !0, F.xList = $, F.x = R), A && (u = !0, F.yList = A, F.y = U), u) return F
                }
            }
        }, Ni.prototype._46O = function (p) {
            var y = this;
            y.editing && (y.editing = null, y._interactor.fi({
                kind: "endEditPoint",
                event: p
            })), y._guideInfo = null, y._edgeHostGuideInfo = null, y._pan && (y._pan = null, y._interactor.fi({
                kind: "endPan",
                event: p
            })), y.tipInfo = null
        }, Ni.prototype._canDeletePoint = function (y, e) {
            var O = this.target;
            if (!(O instanceof k.Edge)) return !0;
            var Y = y._curves[0],
                H = y._curves[y._curves.length - 1];
            return Y._p1 === e || H._p4 === e ? !1 : !0
        }, Ni.prototype.handleDelete = function () {
            var m = this;
            if (m.activing && m.screenInfo) {
                var H = k.Default.isShiftDown(),
                    q = m.screenInfo.curve;
                m._canDeletePoint(q, m.activing.point) && q.deleteRealPoint(m.activing.point, H), m.activing.selections && m.activing.selections.forEach(function (C) {
                    m._canDeletePoint(q, C) && q.deleteRealPoint(C, H)
                }), m.activing = null, delete m.editing, delete m.tipInfo, delete m._pan, m._writeToHt(), m._interactor.fp("deleteShapePoint", !1, !0)
            }
        }, Ni.prototype.handleDoubleClick = function (N) {
            var P = this,
                C = P._interactor._getLogicalPoint(N);
            if (P.screenInfo && P._checkEditRealPoint(C)) {
                var u = P.getCurrentSelectintStatus(),
                    f = Sf.Curve.PointType;
                return u = u === f.Mirrored ? f.Straight : f.Mirrored, P._setCurrentSelectionStatus(u), P._interactor._42(), !0
            }
        }, Ni.prototype._drawHighlight = function (h) {
            var f = this,
                R = f.highlight;
            if (R) {
                var n = R.bezier,
                    L = f._interactor;
                n && Sf.Icons.DrawIcon(L, h, Sf.Icons.ShapeHighlightCurve, [n._p1.x, n._p1.y, n._p2.x, n._p2.y, n._p3.x, n._p3.y, n._p4.x, n._p4.y]);
                var g = R.point;
                g && "insertKnot" === R.type && Sf.Icons.DrawIcon(L, h, Sf.Icons.ShapeHighlighPoint, g)
            }
        }, Ni.prototype._drawGuide = function (f) {
            var U = this,
                E = U._guideInfo;
            if (E) {
                var s, K, x, M, c = E.v;
                for (s = 0; 2 > s; s++)
                    if (M = 0 === s ? E.xList : E.yList)
                        for (K = 0, x = M.length; x > K; K++) Sf.Icons.DrawIcon(U._interactor, f, Sf.Icons.ShapeGuideLine, [c.x, c.y, M[K].x, M[K].y])
            }
        }, Ni.prototype._drawCurrentPoint = function (L) {
            var c = this;
            if (c.activing) {
                var V = c.activing,
                    d = c.getCurrentSelectintStatus(),
                    I = c._interactor;
                if (d !== Sf.Curve.PointType.Straight) {
                    var R = V.pairs;
                    V.hlpair, V.hltype;
                    var A = V.selections,
                        g = V.editingCtrl;
                    if (R && !A) {
                        var s, S, T;
                        for (S = 0, T = R.length; T > S; S++) s = R[S], g && S === g.pairId && s[g.type] ? Sf.Icons.DrawIcon(I, L, Sf.Icons.ShapeActivingCtrl, {
                            point: s.point,
                            c1: s.c1,
                            c2: s.c2,
                            hl: g.type
                        }) : Sf.Icons.DrawIcon(I, L, Sf.Icons.ShapeActivingCtrl, s)
                    }
                }
                Sf.Icons.DrawIcon(I, L, Sf.Icons.ShapeHighlighRealPoint, c.activing.point), A && A.forEach(function (h) {
                    Sf.Icons.DrawIcon(I, L, Sf.Icons.ShapeHighlighRealPoint, h)
                })
            }
        }, Ni.prototype.clear = function () {
            var Q = this;
            Q.editing = null, Q._guideInfo = null, Q.activing = null, Q.highlight = null
        }, Ni.prototype._42 = function (J) {
            var g = this;
            g.info = {}, g.editing || (g.screenInfo = null);
            var x = g._interactor;
            if (!x.editDetail) return g.clear(), void 0;
            var V = x.gv;
            if (!g.target || !V.isSelected(g.target) || !V.isVisible(g.target)) return x.editDetail = !1, g.clear(), void 0;
            if (g.gatherSingleTarget(V, g.target), Sf.Icons.DrawIcon(x, J, Sf.Icons.ShapeBgCurve, g.screenInfo), g._drawHighlight(J), g._drawCurrentPoint(J), g._getRealPoint().forEach(function (S) {
                    Sf.Icons.DrawIcon(x, J, Sf.Icons.ShapePoint, S)
                }), g._drawGuide(J), g.tipInfo && Sf.Icons.DrawIcon(x, J, Sf.Icons.TipHelper, g.tipInfo), g._edgeHostGuideInfo) {
                Sf.Icons.DrawIcon(x, J, Sf.Icons.NodeHoverGuide, g._edgeHostGuideInfo.corners);
                var B = g._edgeHostGuideInfo.host;
                if (B) {
                    var f = V.getAttachPoints(B);
                    if (f && f.length)
                        for (var I = 0, D = f.length; D > I; I++) {
                            var v = f[I],
                                o = B.getAttachPosition(v.x, v.y, v.offsetX, v.offsetY);
                            o = Sf.toScreenPosition(V, o), o.isAttach = g._edgeHostGuideInfo.attach === I, Sf.Icons.DrawIcon(x, J, Sf.Icons.AttachPoint, o)
                        }
                }
            }
            if (g._interactor.getStyle("curveElevationVisible") && g.target instanceof k.Polyline && g.activing) {
                var m = g.activing.getCurrentEditingPoint();
                m && Sf.Icons.DrawIcon(x, J, Sf.Icons.EdgeElevationGuide, m)
            }
        }, Ni.prototype._getRealPoint = function () {
            var z, q = this.screenInfo,
                B = q.P,
                n = q.S,
                Z = -1,
                L = [],
                p = -1,
                P = n.length;
            return n.each(function (V) {
                p++;
                var x = 1;
                if (3 === V) x = 2;
                else if (4 === V) x = 3;
                else if (5 === V) return;
                Z += x, z = p + 1 >= P ? !0 : 1 === n.get(p + 1) ? !0 : !1, L.push({
                    point: {
                        x: B[2 * Z],
                        y: B[2 * Z + 1]
                    },
                    segmentIndex: p,
                    pointIndex: Z,
                    isEnd: z
                })
            }), L
        }, Ni.prototype.getEditingPointsInfo = function (g) {
            var e = this,
                w = e.activing;
            if (!w) return !1;
            var i = w.point;
            if (!i) return !1;
            var M = this._getRealPoint(),
                o = [{
                    screen: i
                }];
            w.selections && w.selections.forEach(function (j) {
                o.push({
                    screen: j
                })
            });
            var k, O, V = M.length;
            return o.forEach(function (Y) {
                for (k = 0; V > k; k++)
                    if (O = M[k], Y.screen.isNearEnough(O.point)) {
                        Y.segmentIndex = O.segmentIndex, Y.pointIndex = O.pointIndex, Y.point = e.target.getPoints().get(O.pointIndex);
                        break
                    }
            }), g && o.sort(function (X, z) {
                return X.segmentIndex - z.segmentIndex
            }), o
        };
        var _i = Sf.MoveHelper = function (O) {
            var J = this;
            J.catalog = "Move", J._interactor = O
        };
        _i.prototype = {}, _i.prototype.constructor = _i, _i.prototype.calcShift = function (f, u, L) {
            var j, D, $ = this,
                S = $._interactor.gv,
                Z = S.lp(u);
            if ("beginMove" === f && $._gatherGridInfo(L._lastLogicalPoint || Z), j = $._target) {
                var A = j.downPosition;
                if (A) {
                    var V = $._interactor.getStyle("moveSensitivity") / S._zoom;
                    if (A.distanceTo(Z) < V) return {
                        x: 0,
                        y: 0
                    };
                    delete j.downPosition
                }
                var s;
                D = k.Default.isShiftDown(u), D && (Z = $._dealShiftDown(Z), s = j.shiftGuide.dir);
                var K, G = j.rawPos = {
                    x: j.pos.x + Z.x - j.lp.x,
                    y: j.pos.y + Z.y - j.lp.y
                };
                if (k.Default.isCtrlDown(u)) {
                    if (K = $._calcShiftByAddon(), $._target.node instanceof Sf.Group) {
                        var z = $._target.node;
                        z._position.x += K.x, z._position.y += K.y
                    }
                    return K
                }
                for (var M, o = j.x + G.x, x = j.y + G.y, C = {
                    x: o,
                    y: x
                }, y = {
                    x: o + j.w / 2,
                    y: x + j.h / 2
                }, I = {
                    x: o + j.w,
                    y: x + j.h
                }, Y = $._interactor.rectGuide, i = $._interactor.gridGuide, d = [Y.findClosest(C, s), Y.findClosest(y, s), Y.findClosest(I, s), i.findClosest(C, s), i.findClosest(y, s), i.findClosest(I, s)], O = 1 / 0, t = 1 / 0, w = 0, b = d.length; b > w; w++) M = d[w], M && (o = M.x, x = M.y, isFinite(o) && Math.abs(o) < Math.abs(O) && (O = o), isFinite(x) && Math.abs(x) < Math.abs(t) && (t = x));
                if (isFinite(O) || (O = 0), isFinite(t) || (t = 0), K = $._calcShiftByAddon(O, t), $._target.node instanceof Sf.Group) {
                    var z = $._target.node;
                    z._position.x += K.x, z._position.y += K.y
                }
                var p = j.node;
                if (!Jk(p, S)) {
                    var l = G.x + O,
                        r = G.y + t;
                    $._interactor.rectGuide.gatherLines({
                        node: p,
                        x: j.x + l,
                        y: j.y + r,
                        w: j.w,
                        h: j.h
                    }, s)
                }
                return K
            }
        }, _i.prototype._calcShiftByAddon = function (S, e) {
            var s = this._target,
                B = s.rawPos,
                q = s.node.getPosition();
            return S = S || 0, e = e || 0, {
                x: B.x - q.x + S,
                y: B.y - q.y + e
            }
        }, _i.prototype._dealShiftDown = function (y) {
            var T = this,
                I = T._target.shiftGuide,
                L = T._target.lp,
                w = Math.abs(y.x - L.x),
                Z = Math.abs(y.y - L.y);
            w > Z && w > I.limit && "y" === I.dir && (I.dir = "x"), Z > w && Z > I.limit && "x" === I.dir && (I.dir = "y");
            var Q = I.dir;
            return "x" === Q ? (y.y = L.y, I.limit = Math.max(I.limit, w)) : "y" === Q && (y.x = L.x, I.limit = Math.max(I.limit, Z)), y
        }, _i.prototype._gatherGridInfo = function (_) {
            var T, j = this,
                h = j._interactor,
                A = h._getValidSelection();
            if (A.length) {
                if (1 === A.length) {
                    if (T = A[0], !T.getRect) return j._target = null, void 0
                } else if (T = Sf.Group.findOrCreateGroup(A), !T) return j._target = null, void 0
            } else {
                var A = h.gv.sm().getSelection();
                if (A.length && (T = A.get(0), !T.getRect)) return j._target = null, void 0
            }
            var Z = T.getPosition(),
                K = T.getRect();
            j._target = {
                node: T,
                x: K.x - Z.x,
                y: K.y - Z.y,
                w: K.width,
                h: K.height,
                lp: {
                    x: _.x,
                    y: _.y
                },
                pos: {
                    x: Z.x,
                    y: Z.y
                },
                shiftGuide: {
                    dir: "x",
                    limit: 0
                },
                downPosition: new Sf.Math.Vector2(_)
            }, h.rectGuide.gatherRects()
        }, _i.prototype.clear = function () {
            var K = this;
            K._interactor.rectGuide.clear(), K._interactor._42()
        };
        var Ar = "directional",
            ui = "point",
            Zm = "spot",
            ff = "light.color",
            pp = function (m, D) {
                Qc(D) && Eq.test(D) ? Md(m, D) : cl(D) && D.modelType ? Xd(m, D) : Yb[m] = D
            },
            ak = function (c) {
                if (cl(c)) return c.modelType ? c.uuid ? Yb[c.uuid] : (c.uuid = k.Math.generateUUID(), Xd(c.uuid, c), p) : c;
                var q = Yb[c];
                return c && q === p && Eq.test(c) && (lq && lq[c] || Md(c, c)), q
            };
        xr(f, {
            graph3dViewAttributes: h,
            graph3dViewFirstPersonMode: !1,
            graph3dViewMouseRoamable: !0,
            graph3dViewMoveStep: 15,
            graph3dViewRotateStep: c / 60,
            graph3dViewEditHelperDisabled: !1,
            graph3dViewPannable: !0,
            graph3dViewRotatable: !0,
            graph3dViewWalkable: !0,
            graph3dViewResettable: !0,
            graph3dViewZoomable: !0,
            graph3dViewRectSelectable: !0,
            graph3dViewRectSelectBackground: Ve,
            graph3dViewGridVisible: !1,
            graph3dViewGridSize: 50,
            graph3dViewGridGap: 50,
            graph3dViewGridColor: [.4, .75, .85, 1],
            graph3dViewOriginAxisVisible: !1,
            graph3dViewCenterAxisVisible: !1,
            graph3dViewAxisXColor: [1, 0, 0, 1],
            graph3dViewAxisYColor: [0, 1, 0, 1],
            graph3dViewAxisZColor: [0, 0, 1, 1],
            graph3dViewEditSizeColor: [1, 1, 0, 1],
            graph3dViewOrtho: !1,
            graph3dViewOrthoWidth: 2e3,
            graph3dViewFovy: c / 4,
            graph3dViewNear: 10,
            graph3dViewFar: 1e4,
            graph3dViewEye: [0, 300, 1e3],
            graph3dViewCenter: [0, 0, 0],
            graph3dViewUp: [0, 1, -1e-7],
            graph3dViewHeadlightRange: 0,
            graph3dViewHeadlightColor: [1, 1, 1, 1],
            graph3dViewHeadlightIntensity: 1,
            graph3dViewHeadlightDisabled: !1,
            graph3dViewFogDisabled: !0,
            graph3dViewFogColor: "white",
            graph3dViewFogNear: 1,
            graph3dViewFogFar: 2e3,
            graph3dViewDashDisabled: !0,
            graph3dViewBatchBlendDisabled: !0,
            graph3dViewBatchBrightnessDisabled: !0,
            graph3dViewBatchColorDisabled: !1,
            setShape3dModel: pp,
            getShape3dModel: ak,
            createMatrix: function (h, V) {
                nj(h) || (h = [h]);
                for (var N = h.length - 1; N >= 0; N--) {
                    var r = h[N];
                    V = Kq(r.mat, r.s3, r.r3, r.rotationMode, r.t3, V)
                }
                return V
            },
            transformVec: function (B, V) {
                return Br(B, V)
            },
            createBoxModel: function () {
                return {
                    vs: Wi,
                    ns: gj,
                    uv: mi,
                    is: sp
                }
            },
            createRoundRectModel: function (I, V) {
                return _p.roundRect(I, V)
            },
            createStarModel: function (F, H) {
                return _p.star(F, H)
            },
            createRectModel: function (L, x) {
                return _p.rect(L, x)
            },
            createTriangleModel: function (Z, L) {
                return _p.triangle(Z, L)
            },
            createRightTriangleModel: function (o, x) {
                return _p.rightTriangle(o, x)
            },
            createParallelogramModel: function (m, H) {
                return _p.parallelogram(m, H)
            },
            createTrapezoidModel: function (c, E) {
                return _p.trapezoid(c, E)
            },
            createSmoothSphereModel: function (G, M, c, F, U, k, j) {
                return hf(new co(G, M, c, F, U, k, j))
            },
            createSphereModel: function (G, U, S, c, M, B) {
                return G ? Ao(G, U, S, c, M, B) : f.createSmoothSphereModel()
            },
            createSmoothConeModel: function (l, A, C, O, V) {
                return Ai(l, A, C, O, V)
            },
            createConeModel: function (G, z, l, U, A, m) {
                return G ? mk(G, z, l, U, A, m) : Ai(m)
            },
            createSmoothCylinderModel: function (f, p, I, P, L, a, x, N) {
                return hf(new Uc(f, p, I, P, L, a, x, N))
            },
            createCylinderModel: function (X, q, G, F, L, N, S) {
                return X ? Rl(X, q, G, F, L, N, S) : rc(N, S)
            },
            createSmoothTorusModel: function (X, q, P, J, s, $) {
                return hf(new xq(X, q, P, J, s, $))
            },
            createTorusModel: function (d, S, H, l, g, u, F) {
                return d ? Ul(d, S, H, l, g, u, F) : Qm(u, F)
            },
            createExtrusionModel: function (Y, p, I, h, c, y, W, M) {
                return Lo(Y, p, I, h, c, y, W, M)
            },
            createSmoothRingModel: function (v, W, r, q, p, g) {
                for (var L = [], C = 0; C < v.length - 1; C += 2) L.push({
                    x: v[C],
                    y: v[C + 1]
                });
                for (v = fh(L, W, r)[0], L = [], C = 0; C < v.length; C++) {
                    var h = v[C];
                    L.push(new $m(h.x, 0, h.y))
                }
                return hf(new Ko(L, g, q, p))
            },
            createTextGeometry: function (J, K) {
                return hf(new Ch(J, K))
            },
            loadFontFace: function (B, W) {
                f.xhrLoad(B, function (q) {
                    if (!q) return W();
                    var Q;
                    try {
                        Q = JSON.parse(q)
                    } catch (L) {
                        Q = JSON.parse(q.substring(65, q.length - 2))
                    }
                    Vh.loadFace(Q), W && W(Q.familyName.toLowerCase())
                }, W ? null : {
                    sync: !0
                })
            },
            createRingModel: function (x, z, t, y, H, B, r, P, s, T) {
                for (var o = [], p = 0; p < x.length - 1; p += 2) o.push({
                    x: x[p],
                    y: x[p + 1]
                });
                B = B || f.shapeSide, r = r || 0, P = P || B;
                var G, K, E, j, v, U, m, D, S, M, p, W, I, Z, u, $, F, J, g = [],
                    Y = [],
                    C = s ? [] : h,
                    X = s ? [] : h,
                    b = T ? [] : h,
                    O = T ? [] : h,
                    c = y ? [] : h,
                    k = y ? [] : h,
                    L = H ? [] : h,
                    a = H ? [] : h,
                    x = fh(o, z, t),
                    V = Xh(x),
                    A = 0,
                    _ = 2 * Math.PI / B;
                return x.forEach(function (n) {
                    if (E = n.length, E > 1) {
                        if (j = n[0], y)
                            for (U = j.x, D = j.y, p = r; P > p; p++) W = p + 1, I = p * _, Z = W * _, u = w(I), $ = R(I), F = w(Z), J = R(Z), c.push(u * U, D, -$ * U, F * U, D, -J * U, 0, D, 0), k.push(.5 - .5 * u, .5 - .5 * $, .5 - .5 * F, .5 - .5 * J, .5, .5);
                        for (M = 0; E > M; M++) {
                            for (v = n[M], U = j.x, m = v.x, D = j.y, S = v.y, G = A / V, A += Me(j, v), K = A / V, p = r; P > p; p++) W = p + 1, I = p * _, Z = W * _, u = w(I), $ = R(I), F = w(Z), J = R(Z), g.push(u * m, S, -$ * m, F * m, S, -J * m, u * U, D, -$ * U, F * m, S, -J * m, F * U, D, -J * U, u * U, D, -$ * U), Y.push(p / B, K, W / B, K, p / B, G, W / B, K, W / B, G, p / B, G), s && p === r && (C.push(0, D, 0, 0, S, 0, u * m, S, -$ * m, u * m, S, -$ * m, u * U, D, -$ * U, 0, D, 0), X.push(0, .5 - D, 0, .5 - S, 2 * m, .5 - S, 2 * m, .5 - S, 2 * U, .5 - D, 0, .5 - D)), T && W === P && (b.push(0, D, 0, F * m, S, -J * m, 0, S, 0, F * m, S, -J * m, 0, D, 0, F * U, D, -J * U), O.push(1, .5 - D, 1 - 2 * m, .5 - S, 1, .5 - S, 1 - 2 * m, .5 - S, 1, .5 - D, 1 - 2 * U, .5 - D));
                            j = v
                        }
                        if (H)
                            for (U = j.x, D = j.y, p = r; P > p; p++) W = p + 1, I = p * _, Z = W * _, u = w(I), $ = R(I), F = w(Z), J = R(Z), L.push(F * U, D, -J * U, u * U, D, -$ * U, 0, D, 0), a.push(.5 - .5 * F, .5 + .5 * J, .5 - .5 * u, .5 + .5 * $, .5, .5)
                    }
                }), {
                    vs: g,
                    uv: Y,
                    bottom_vs: L,
                    bottom_uv: a,
                    top_vs: c,
                    top_uv: k,
                    from_vs: C,
                    from_uv: X,
                    to_vs: b,
                    to_uv: O
                }
            }
        }, !0), xr(C, {
            "3d.move.mode": p,
            "3d.selectable": !0,
            "3d.visible": !0,
            "3d.movable": !0,
            "3d.editable": !0,
            "shape.border.gradient.color": p,
            "edge.gradient.color": p,
            "edge.source.t3": p,
            "edge.target.t3": p,
            "light.type": ui,
            "light.center": [0, 0, 0],
            "light.color": [1, 1, 1, 1],
            "light.disabled": !1,
            "light.angle": c / 4,
            "light.range": 0,
            "light.exponent": 1,
            "light.intensity": 1,
            "wf.visible": !1,
            "wf.width": 1,
            "wf.color": Zr,
            "wf.short": !1,
            "wf.mat": p,
            "wf.geometry": !1,
            batch: p,
            "transparent.mask": !1,
            brightness: p,
            "select.brightness": .7,
            "repeat.uv.length": p,
            alphaTest: .4,
            "highlight.visible": !0,
            "highlight.width": .8,
            "highlight.color": "rgba(190, 210, 250, 1)",
            "color.empty": [0, 0, 0, 0],
            "shape3d.vector.dynamic.maxsize": 2048,
            "label.face": fg,
            "label.t3": p,
            "label.r3": p,
            "label.texture.scale": 2,
            "label.rotationMode": Pb,
            "label.light": !1,
            "label.blend": p,
            "label.reverse.flip": !1,
            "label.reverse.color": Iq,
            "label.reverse.cull": !1,
            "label.transparent": !1,
            "label.autorotate": !1,
            "label2.face": fg,
            "label2.t3": p,
            "label2.r3": p,
            "label2.texture.scale": 2,
            "label2.rotationMode": Pb,
            "label2.light": !1,
            "label2.blend": p,
            "label2.reverse.flip": !1,
            "label2.reverse.color": Iq,
            "label2.reverse.cull": !1,
            "label2.transparent": !1,
            "label2.autorotate": !1,
            "note.face": fg,
            "note.t3": p,
            "note.r3": p,
            "note.texture.scale": 2,
            "note.rotationMode": Pb,
            "note.light": !1,
            "note.blend": p,
            "note.reverse.flip": !1,
            "note.reverse.color": Iq,
            "note.reverse.cull": !1,
            "note.transparent": !1,
            "note.autorotate": !1,
            "note2.face": fg,
            "note2.t3": p,
            "note2.r3": p,
            "note2.texture.scale": 2,
            "note2.rotationMode": Pb,
            "note2.light": !1,
            "note2.blend": p,
            "note2.reverse.flip": !1,
            "note2.reverse.color": Iq,
            "note2.reverse.cull": !1,
            "note2.transparent": !1,
            "note2.autorotate": !1,
            shape3d: p,
            "shape3d.color": Hm,
            "shape3d.top.color": p,
            "shape3d.bottom.color": p,
            "shape3d.from.color": p,
            "shape3d.to.color": p,
            "shape3d.image": p,
            "shape3d.top.image": p,
            "shape3d.bottom.image": p,
            "shape3d.from.image": p,
            "shape3d.to.image": p,
            "shape3d.light": !0,
            "shape3d.side": 0,
            "shape3d.side.from": p,
            "shape3d.side.to": p,
            "shape3d.visible": !0,
            "shape3d.from.visible": !0,
            "shape3d.to.visible": !0,
            "shape3d.top.visible": !0,
            "shape3d.bottom.visible": !0,
            "shape3d.torus.radius": .17,
            "shape3d.resolution": 0,
            "shape3d.blend": p,
            "shape3d.opacity": p,
            "shape3d.reverse.flip": !1,
            "shape3d.reverse.color": Iq,
            "shape3d.reverse.cull": !1,
            "shape3d.transparent": !1,
            "shape3d.uv.offset": p,
            "shape3d.uv.scale": p,
            "shape3d.top.uv.offset": p,
            "shape3d.top.uv.scale": p,
            "shape3d.bottom.uv.offset": p,
            "shape3d.bottom.uv.scale": p,
            "shape3d.from.uv.offset": p,
            "shape3d.from.uv.scale": p,
            "shape3d.to.uv.offset": p,
            "shape3d.to.uv.scale": p,
            "shape3d.top.cap": p,
            "shape3d.bottom.cap": p,
            "shape3d.start.angle": 0,
            "shape3d.sweep.angle": E,
            "shape3d.discard.selectable": !0,
            "shape3d.top.discard.selectable": !0,
            "shape3d.bottom.discard.selectable": !0,
            "shape3d.from.discard.selectable": !0,
            "shape3d.to.discard.selectable": !0,
            "shape3d.scaleable": !0,
            "shape3d.autorotate": !1,
            "shape3d.fixSizeOnScreen": p,
            "shape3d.image.cache": !1,
            "shape3d.alwaysOnTop": !1,
            "all.light": !0,
            "all.visible": !0,
            "all.color": Hm,
            "all.image": p,
            "all.blend": p,
            "all.opacity": p,
            "all.reverse.flip": !1,
            "all.reverse.color": Iq,
            "all.reverse.cull": !1,
            "all.transparent": !1,
            "all.uv": p,
            "all.uv.offset": p,
            "all.uv.scale": p,
            "all.discard.selectable": !0,
            mat: p,
            "left.mat": p,
            "right.mat": p,
            "top.mat": p,
            "bottom.mat": p,
            "front.mat": p,
            "back.mat": p
        }, !0);
        var wf, ur = !1,
            gg = [0, 0, 0, 0],
            Lj = {
                left: [1 / 255, 0, 0, 1],
                right: [2 / 255, 0, 0, 1],
                top: [3 / 255, 0, 0, 1],
                bottom: [4 / 255, 0, 0, 1],
                front: [5 / 255, 0, 0, 1],
                back: [6 / 255, 0, 0, 1],
                m: {
                    1: ul,
                    2: sb,
                    3: $b,
                    4: Id,
                    5: fg,
                    6: Hc
                }
            },
            ld = function (D, c, s, L) {
                if (c.getFaceVisible(D, s)) {
                    hs(c, zh(D, c.getFaceMat(D, s) || c.getMat(D)));
                    var b = c._26I;
                    c.getFaceReverseCull(D, s) ? b.enable(b.CULL_FACE) : b.disable(b.CULL_FACE), cs(b, c._prg.uFixPickReverseColor, Lj[s]), $h(b), Ho(b, L, 6), Si(b), sn(c)
                }
            },
            ll = function (I) {
                return I instanceof vd
            },
            oc = function (_) {
                return [_.x, _.e || 0, _.y]
            },
            xh = function (h, $, U) {
                for (var $ = Cj($), J = $[0], t = $[1], F = $[2]; U--;) h.push(J, t, F)
            },
            Gp = function (j, x, I) {
                for (var x = Cj(x), X = x[0], n = x[1], D = x[2], l = x[3]; I--;) j.push(X, n, D, l)
            },
            mj = function (v, S, R) {
                if (S)
                    for (var f, V, r, o = S[0], O = S[1], m = S[2], x = S[4], h = S[5], y = S[6], c = S[8], F = S[9], d = S[10], E = S[12], i = S[13], D = S[14], P = R.length, t = 0, t = 0; P > t; t += 3) f = R[t], V = R[t + 1], r = R[t + 2], v.push(o * f + x * V + c * r + E, O * f + h * V + F * r + i, m * f + y * V + d * r + D);
                else ug(v, R)
            },
            Kn = function (E, d) {
                var Y = d.s("light.intensity"),
                    P = Cj(d.s(ff)),
                    k = P[0],
                    G = P[1],
                    $ = P[2];
                1 !== Y && (k *= Y, G *= Y, $ *= Y), E.push(k, G, $, d.s("light.disabled") ? 1 : 0)
            },
            kb = function ($, x, d) {
                cs(x, d.uHeadlightRange, $._headlightRange);
                var f = $._headlightIntensity,
                    a = Cj($._headlightColor);
                1 !== f && (a = [a[0] * f, a[1] * f, a[2] * f]), cs(x, d.uHeadlightColor, [a[0], a[1], a[2], $._headlightDisabled ? 1 : 0]);
                var T = $._59O,
                    r = $._spots,
                    E = $._dirs;
                if (T.length) {
                    var F = [],
                        K = [],
                        J = [];
                    T.forEach(function (X) {
                        Kn(F, X), ug(K, $._transformPointToViewSpace(X.p3())), J.push(X.s("light.range"))
                    }), x.uniform4fv(d.uPointColor, F), x.uniform1fv(d.uPointRange, J), x.uniform3fv(d.uPointPosition, K)
                }
                if (r.length) {
                    var S = [],
                        L = [],
                        P = [],
                        U = [],
                        z = [],
                        A = [];
                    r.forEach(function (X) {
                        Kn(S, X), ug(L, $._transformPointToViewSpace(X.p3())), ug(z, $._transformDirectionToViewSpace(X.p3(), X.s("light.center"))), P.push(X.s("light.range")), U.push(w(X.s("light.angle") / 2)), A.push(X.s("light.exponent"))
                    }), x.uniform4fv(d.uSpotColor, S), x.uniform1fv(d.uSpotRange, P), x.uniform1fv(d.uSpotAngle, U), x.uniform1fv(d.uSpotExponent, A), x.uniform3fv(d.uSpotPosition, L), x.uniform3fv(d.uSpotDirection, z)
                }
                if (E.length) {
                    var Q = [],
                        W = [];
                    E.forEach(function (B) {
                        Kn(Q, B), ug(W, $._transformDirectionToViewSpace(B.p3()))
                    }), x.uniform4fv(d.uDirColor, Q), x.uniform3fv(d.uDirDirection, W)
                }
            },
            go = function (T) {
                return T > 0 && 0 === (T - 1 & T)
            },
            qn = function ($) {
                return $ = W(0, j(c, $)), $ = W(iq, j(c - iq, $))
            },
            Ui = function () {
                return .05 + G() / 2
            },
            sm = function (N, H, W, Z) {
                var C, O = N.getEye();
                return N.isOrtho() ? (C = on(N.getCenter(), O), C[0] += Z[0], C[1] += Z[1], C[2] += Z[2]) : C = O, jd(H, W, Z, C)
            },
            jd = function (S, H, A, B) {
                var n = Gi(S, H),
                    l = on(B, A, !0),
                    T = Gi(l, H);
                if (Y(T) < iq) return h;
                var z = (n - Gi(A, H)) / T;
                return [A[0] + l[0] * z, A[1] + l[1] * z, A[2] + l[2] * z]
            },
            xf = function (T, Y) {
                return {
                    x: 2 * T.x - Y.x,
                    y: 2 * T.y - Y.y
                }
            },
            Ze = function (m, h, I, f) {
                var p, e;
                if (!m) return p = H(h.y - I.y, I.x - h.x), {
                    x: h.x + f * R(p),
                    y: h.y + f * w(p)
                };
                if (!I) return p = H(m.y - h.y, h.x - m.x), {
                    x: h.x + f * R(p),
                    y: h.y + f * w(p)
                };
                var Y = on([m.x, m.y, 0], [h.x, h.y, 0], !0),
                    c = on([I.x, I.y, 0], [h.x, h.y, 0], !0),
                    T = -(Y[0] + c[0]) / 2,
                    P = -(Y[1] + c[1]) / 2,
                    L = l(T * T + P * P);
                if (iq > L) return p = H(m.y - h.y, h.x - m.x), {
                    x: h.x + f * R(p),
                    y: h.y + f * w(p)
                };
                var D = m.x - h.x,
                    E = m.y - h.y,
                    F = I.x - h.x,
                    J = I.y - h.y,
                    G = l(D * D + E * E),
                    i = l(F * F + J * J);
                p = O(Gi(Y, c)) / 2, e = Y[1] * c[0] - Y[0] * c[1] > 0 ? -1 : 1, T /= L, P /= L;
                var N = f / R(p),
                    y = W(G, i) / w(p);
                L = Math.min(N, y);
                var o = {
                    x: h.x + e * L * T,
                    y: h.y + e * L * P
                };
                return I.b && N > i / w(p) && (o.adjust = !0), o
            },
            Qb = function (n) {
                var w = n[1],
                    Z = n[2],
                    h = n[3],
                    r = n[6],
                    M = n[7],
                    C = n[11];
                n[1] = n[4], n[2] = n[8], n[3] = n[12], n[4] = w, n[6] = n[9], n[7] = n[13], n[8] = Z, n[9] = r, n[11] = n[14], n[12] = h, n[13] = M, n[14] = C
            },
            ks = function (a) {
                var R = a[0],
                    t = a[1],
                    N = a[2],
                    T = a[3],
                    B = a[4],
                    X = a[5],
                    v = a[6],
                    p = a[7],
                    W = a[8],
                    g = a[9],
                    _ = a[10],
                    k = a[11],
                    K = a[12],
                    o = a[13],
                    u = a[14],
                    e = a[15],
                    M = R * X - t * B,
                    q = R * v - N * B,
                    d = R * p - T * B,
                    G = t * v - N * X,
                    Q = t * p - T * X,
                    Z = N * p - T * v,
                    n = W * o - g * K,
                    Y = W * u - _ * K,
                    V = W * e - k * K,
                    y = g * u - _ * o,
                    J = g * e - k * o,
                    L = _ * e - k * u,
                    m = M * L - q * J + d * y + G * V - Q * Y + Z * n;
                return m ? (m = 1 / m, a[0] = (X * L - v * J + p * y) * m, a[1] = (N * J - t * L - T * y) * m, a[2] = (o * Z - u * Q + e * G) * m, a[3] = (_ * Q - g * Z - k * G) * m, a[4] = (v * V - B * L - p * Y) * m, a[5] = (R * L - N * V + T * Y) * m, a[6] = (u * d - K * Z - e * q) * m, a[7] = (W * Z - _ * d + k * q) * m, a[8] = (B * J - X * V + p * n) * m, a[9] = (t * V - R * J - T * n) * m, a[10] = (K * Q - o * d + e * M) * m, a[11] = (g * d - W * Q - k * M) * m, a[12] = (X * Y - B * y - v * n) * m, a[13] = (R * y - t * Y + N * n) * m, a[14] = (o * q - K * G - u * M) * m, a[15] = (W * G - g * q + _ * M) * m, void 0) : h
            },
            Xj = function (r, B) {
                if (B) {
                    var b = B[0],
                        m = B[1],
                        w = B[2];
                    r[12] = r[0] * b + r[4] * m + r[8] * w + r[12], r[13] = r[1] * b + r[5] * m + r[9] * w + r[13], r[14] = r[2] * b + r[6] * m + r[10] * w + r[14], r[15] = r[3] * b + r[7] * m + r[11] * w + r[15]
                }
            },
            br = function (e, G) {
                if (G) {
                    var R = G[0],
                        p = G[1],
                        m = G[2];
                    e[0] = e[0] * R, e[1] = e[1] * R, e[2] = e[2] * R, e[3] = e[3] * R, e[4] = e[4] * p, e[5] = e[5] * p, e[6] = e[6] * p, e[7] = e[7] * p, e[8] = e[8] * m, e[9] = e[9] * m, e[10] = e[10] * m, e[11] = e[11] * m
                }
            },
            sg = function (f, Z, p) {
                var o = Z[0],
                    R = Z[1],
                    c = Z[2],
                    C = Z[3],
                    x = Z[4],
                    j = Z[5],
                    B = Z[6],
                    $ = Z[7],
                    t = Z[8],
                    e = Z[9],
                    i = Z[10],
                    n = Z[11],
                    T = Z[12],
                    L = Z[13],
                    M = Z[14],
                    O = Z[15],
                    G = p[0],
                    a = p[1],
                    A = p[2],
                    U = p[3];
                return f[0] = G * o + a * x + A * t + U * T, f[1] = G * R + a * j + A * e + U * L, f[2] = G * c + a * B + A * i + U * M, f[3] = G * C + a * $ + A * n + U * O, G = p[4], a = p[5], A = p[6], U = p[7], f[4] = G * o + a * x + A * t + U * T, f[5] = G * R + a * j + A * e + U * L, f[6] = G * c + a * B + A * i + U * M, f[7] = G * C + a * $ + A * n + U * O, G = p[8], a = p[9], A = p[10], U = p[11], f[8] = G * o + a * x + A * t + U * T, f[9] = G * R + a * j + A * e + U * L, f[10] = G * c + a * B + A * i + U * M, f[11] = G * C + a * $ + A * n + U * O, G = p[12], a = p[13], A = p[14], U = p[15], f[12] = G * o + a * x + A * t + U * T, f[13] = G * R + a * j + A * e + U * L, f[14] = G * c + a * B + A * i + U * M, f[15] = G * C + a * $ + A * n + U * O, f
            },
            ps = function (a, c, h, X) {
                var t, g, J, k, B, w, y, L, I, U, d = c[0],
                    W = c[1],
                    H = c[2],
                    T = X[0],
                    f = X[1],
                    u = X[2],
                    Z = h[0],
                    r = h[1],
                    A = h[2];
                return Y(d - Z) < iq && Y(W - r) < iq && Y(H - A) < iq ? lg(a) : (y = d - Z, L = W - r, I = H - A, U = 1 / l(y * y + L * L + I * I), y *= U, L *= U, I *= U, t = f * I - u * L, g = u * y - T * I, J = T * L - f * y, U = l(t * t + g * g + J * J), U ? (U = 1 / U, t *= U, g *= U, J *= U) : (t = 0, g = 0, J = 0), k = L * J - I * g, B = I * t - y * J, w = y * g - L * t, U = l(k * k + B * B + w * w), U ? (U = 1 / U, k *= U, B *= U, w *= U) : (k = 0, B = 0, w = 0), a[0] = t, a[1] = k, a[2] = y, a[3] = 0, a[4] = g, a[5] = B, a[6] = L, a[7] = 0, a[8] = J, a[9] = w, a[10] = I, a[11] = 0, a[12] = -(t * d + g * W + J * H), a[13] = -(k * d + B * W + w * H), a[14] = -(y * d + L * W + I * H), a[15] = 1, a)
            },
            ec = function (x, t, d, M, J) {
                var S = 1 / Q(t / 2),
                    f = 1 / (M - J);
                return x[0] = S / d, x[1] = 0, x[2] = 0, x[3] = 0, x[4] = 0, x[5] = S, x[6] = 0, x[7] = 0, x[8] = 0, x[9] = 0, x[10] = (J + M) * f, x[11] = -1, x[12] = 0, x[13] = 0, x[14] = 2 * J * M * f, x[15] = 0, x
            },
            Om = function ($, X, k, T, e, l, A) {
                var y = 1 / (X - k),
                    O = 1 / (T - e),
                    f = 1 / (l - A);
                return $[0] = -2 * y, $[1] = 0, $[2] = 0, $[3] = 0, $[4] = 0, $[5] = -2 * O, $[6] = 0, $[7] = 0, $[8] = 0, $[9] = 0, $[10] = 2 * f, $[11] = 0, $[12] = (X + k) * y, $[13] = (e + T) * O, $[14] = (A + l) * f, $[15] = 1, $
            },
            gq = function (B, x) {
                var j = x[0],
                    u = x[1],
                    d = x[2],
                    D = x[3],
                    F = j * j + u * u + d * d + D * D,
                    l = F ? 1 / F : 0;
                return B[0] = -j * l, B[1] = -u * l, B[2] = -d * l, B[3] = D * l, B
            },
            bh = function (M, y) {
                var D = y[0] + y[5] + y[10],
                    j = 0;
                return D > 0 ? (j = 2 * Math.sqrt(D + 1), M[3] = .25 * j, M[0] = (y[6] - y[9]) / j, M[1] = (y[8] - y[2]) / j, M[2] = (y[1] - y[4]) / j) : y[0] > y[5] & y[0] > y[10] ? (j = 2 * Math.sqrt(1 + y[0] - y[5] - y[10]), M[3] = (y[6] - y[9]) / j, M[0] = .25 * j, M[1] = (y[1] + y[4]) / j, M[2] = (y[8] + y[2]) / j) : y[5] > y[10] ? (j = 2 * Math.sqrt(1 + y[5] - y[0] - y[10]), M[3] = (y[8] - y[2]) / j, M[0] = (y[1] + y[4]) / j, M[1] = .25 * j, M[2] = (y[6] + y[9]) / j) : (j = 2 * Math.sqrt(1 + y[10] - y[0] - y[5]), M[3] = (y[1] - y[4]) / j, M[0] = (y[8] + y[2]) / j, M[1] = (y[6] + y[9]) / j, M[2] = .25 * j), M
            },
            Ki = function (p, T, w) {
                var P = T[0],
                    N = T[1],
                    J = T[2],
                    t = T[3],
                    $ = P + P,
                    h = N + N,
                    V = J + J,
                    k = P * $,
                    D = P * h,
                    K = P * V,
                    E = N * h,
                    b = N * V,
                    G = J * V,
                    F = t * $,
                    Q = t * h,
                    M = t * V;
                return p[0] = 1 - (E + G), p[1] = D + M, p[2] = K - Q, p[3] = 0, p[4] = D - M, p[5] = 1 - (k + G), p[6] = b + F, p[7] = 0, p[8] = K + Q, p[9] = b - F, p[10] = 1 - (k + E), p[11] = 0, p[12] = w[0], p[13] = w[1], p[14] = w[2], p[15] = 1, p
            },
            Pr = function () {
                var I = [0, 0, 0],
                    $ = [0, 0, 0],
                    D = [0, 0, 0],
                    Q = function (x, Z, $) {
                        x[0] = Z[1] * $[2] - Z[2] * $[1], x[1] = Z[2] * $[0] - Z[0] * $[2], x[2] = Z[0] * $[1] - Z[1] * $[0]
                    },
                    k = function (b) {
                        return b[0] * b[0] + b[1] * b[1] + b[2] * b[2]
                    },
                    t = function (r) {
                        var N = Math.sqrt(k(r));
                        r[0] /= N, r[1] /= N, r[2] /= N
                    },
                    z = function (m, f, b) {
                        m[0] = f[0] - b[0], m[1] = f[1] - b[1], m[2] = f[2] - b[2]
                    };
                return function (e, Z, A) {
                    var u = Ip();
                    return z(D, e, Z), 0 === k(D) && (D[2] = 1), t(D), Q(I, A, D), 0 === k(I) && (1 === Math.abs(A[2]) ? D[0] += 1e-4 : D[2] += 1e-4, t(D), Q(I, A, D)), t(I), Q($, D, I), u[0] = I[0], u[4] = $[0], u[8] = D[0], u[1] = I[1], u[5] = $[1], u[9] = D[1], u[2] = I[2], u[6] = $[2], u[10] = D[2], u
                }
            }(),
            qk = function (F, s) {
                if (F.vr.enable) {
                    var d = F.vr.getViewMatrix(s);
                    if (d) return d
                }
                return ps(s ? s : Ip(), F._eye, F._center, F._up)
            },
            Rr = function (e) {
                if (e.vr.enable) {
                    var s = e.vr.getProjectMatrix();
                    if (s) return s
                }
                var X = e.getAspect(),
                    l = e._near,
                    t = e._far,
                    g = Ip();
                if (e._ortho) {
                    var O = e._orthoWidth / 2,
                        N = O / X;
                    Om(g, -O, O, -N, N, l, t)
                } else ec(g, e._fovy, X, l, t);
                return g
            },
            Xp = function (T, O) {
                if (!T) return h;
                var X = 0,
                    o = 1,
                    C = 2,
                    N = [],
                    u = 0,
                    S = T.length,
                    n = S / 3;
                if (O) {
                    for (; S > u; u++) N[u] = 0;
                    for (u = 0; u < O.length; u += 3) {
                        var j = [],
                            c = [],
                            R = [];
                        j[X] = T[3 * O[u + 1] + X] - T[3 * O[u] + X], j[o] = T[3 * O[u + 1] + o] - T[3 * O[u] + o], j[C] = T[3 * O[u + 1] + C] - T[3 * O[u] + C], c[X] = T[3 * O[u + 2] + X] - T[3 * O[u + 1] + X], c[o] = T[3 * O[u + 2] + o] - T[3 * O[u + 1] + o], c[C] = T[3 * O[u + 2] + C] - T[3 * O[u + 1] + C], R[X] = j[o] * c[C] - j[C] * c[o], R[o] = j[C] * c[X] - j[X] * c[C], R[C] = j[X] * c[o] - j[o] * c[X];
                        for (var E = 0; 3 > E; E++) N[3 * O[u + E] + X] += R[X], N[3 * O[u + E] + o] += R[o], N[3 * O[u + E] + C] += R[C]
                    }
                } else
                    for (u = 0; n > u; u += 3) {
                        var j = [],
                            c = [],
                            R = [];
                        j[X] = T[3 * (u + 1) + X] - T[3 * u + X], j[o] = T[3 * (u + 1) + o] - T[3 * u + o], j[C] = T[3 * (u + 1) + C] - T[3 * u + C], c[X] = T[3 * (u + 2) + X] - T[3 * (u + 1) + X], c[o] = T[3 * (u + 2) + o] - T[3 * (u + 1) + o], c[C] = T[3 * (u + 2) + C] - T[3 * (u + 1) + C], R[X] = j[o] * c[C] - j[C] * c[o], R[o] = j[C] * c[X] - j[X] * c[C], R[C] = j[X] * c[o] - j[o] * c[X];
                        for (var E = 0; 3 > E; E++) N[3 * (u + E) + X] = R[X], N[3 * (u + E) + o] = R[o], N[3 * (u + E) + C] = R[C]
                    }
                for (u = 0; S > u; u += 3) {
                    var Z = [];
                    Z[X] = N[u + X], Z[o] = N[u + o], Z[C] = N[u + C];
                    var v = l(Z[X] * Z[X] + Z[o] * Z[o] + Z[C] * Z[C]);
                    0 === v && (v = iq), Z[X] = Z[X] / v, Z[o] = Z[o] / v, Z[C] = Z[C] / v, N[u + X] = Z[X], N[u + o] = Z[o], N[u + C] = Z[C]
                }
                return new Ol(N)
            },
            bb = function (Y, v, b, I) {
                if (b || (b = Y.createTexture()), v) {
                    var H = Y.TEXTURE_2D,
                        L = Y.REPEAT,
                        R = Y.CLAMP_TO_EDGE,
                        M = Y.TEXTURE_MIN_FILTER;
                    I !== Y.NEAREST && (I = Y.LINEAR), os(Y, b), Y.texImage2D(H, 0, Y.RGBA, Y.RGBA, Y.UNSIGNED_BYTE, v), Fi(Y, Y.TEXTURE_MAG_FILTER, I);
                    var s = v.naturalWidth || v.width,
                        T = v.naturalHeight || v.height;
                    go(s) && go(T) && !v.clampToEdge ? (Fi(Y, Y.TEXTURE_WRAP_S, L), Fi(Y, Y.TEXTURE_WRAP_T, L), Fi(Y, M, Y.LINEAR_MIPMAP_LINEAR), Y.generateMipmap(H)) : (Fi(Y, Y.TEXTURE_WRAP_S, R), Fi(Y, Y.TEXTURE_WRAP_T, R), Fi(Y, M, I)), os(Y, h)
                }
                return b
            },
            Jj = function (r, O) {
                var y = new Uint8Array(3);
                return O = O || r.createTexture(), os(r, O), Fi(r, r.TEXTURE_MIN_FILTER, r.LINEAR), r.texImage2D(r.TEXTURE_2D, 0, r.RGB, 1, 1, 0, r.RGB, r.UNSIGNED_BYTE, y), O
            },
            vo = function (O) {
                O._26I && O._prg && (O._26I.deleteProgram(O._prg), O._prg = h)
            },
            Zk = function (m, A, L, v) {
                var Z = m.createShader(L);
                return m.shaderSource(Z, v), m.compileShader(Z), m.attachShader(A, Z), Z
            },
            Ll = function (F) {
                return F.createBuffer()
            },
            os = function (g, m) {
                g.bindTexture(g.TEXTURE_2D, m)
            },
            oh = function (y, C) {
                y.frameStack ? y.frameStack.push(C) : y.frameStack = [C], y.bindFramebuffer(y.FRAMEBUFFER, C)
            },
            hg = function (Z) {
                var m = Z.frameStack;
                if (m) {
                    if (m.pop(), m.length) return Z.bindFramebuffer(Z.FRAMEBUFFER, m[m.length - 1]), void 0;
                    Z.frameStack = null
                }
                Z.bindFramebuffer(Z.FRAMEBUFFER, null)
            },
            Fi = function (m, k, i) {
                m.texParameteri(m.TEXTURE_2D, k, i)
            },
            aj = function (J, I) {
                J.enable(J.POLYGON_OFFSET_FILL), J.polygonOffset(I[0], I[1])
            },
            Og = function (D) {
                D.disable(D.POLYGON_OFFSET_FILL)
            },
            ub = function (H, r) {
                if (r) {
                    var r = Cj(r);
                    H.clearColor(r[0], r[1], r[2], r[3])
                }
            },
            $k = function (H, k) {
                cs(H, k.uFix, !0), ok(H, k.aNormal)
            },
            $e = function (g, B) {
                cs(g, B.uFix, !1), pq(g, B.aNormal)
            },
            Kl = function (E, P, W, S, L, J, f, r) {
                E._picking || (W ? (cs(E, P.uBlend, !0), cs(E, P.uBlendColor, W)) : cs(E, P.uBlend, !1), cs(E, P.uLight, S == h ? !0 : S), Rj(L) && 1 !== L && cs(E, P.uPartOpacity, L), cs(E, P.uReverseFlip, J == h ? !1 : J), cs(E, P.uFixPickReverseColor, f || Iq)), r ? E.enable(E.CULL_FACE) : E.disable(E.CULL_FACE)
            },
            Qd = function (l, R) {
                l._picking || cs(l, R.uPartOpacity, 1)
            },
            $h = function () {
                var S = [0, 0, 1, 1];
                return function (H, v, M, C, w, G, c, L, o) {
                    return M ? (cs(H, v.uTexture, !0), cs(H, v.uDiscardSelectable, rl(C) ? C : !0), pq(H, v.aUv), om(H, w, G, v.aUv, 2), o ? (cs(H, v.uBlendTexture, !0), H.activeTexture(H.TEXTURE1), os(H, o), H.uniform1i(v.uBlendSampler, 1)) : (cs(H, v.uBlendTexture, !1), H.activeTexture(H.TEXTURE1), os(H, H._emptyBlendTexture)), H.activeTexture(H.TEXTURE0), os(H, M), H.uniform1i(v.uSampler, 0), c ? (S[0] = c[0], S[1] = c[1]) : (S[0] = 0, S[1] = 0), L ? (S[2] = L[0], S[3] = L[1]) : (S[2] = 1, S[3] = 1), cs(H, v.uOffsetScale, S), void 0) : (H.activeTexture(H.TEXTURE0), os(H, H._emptyTexture), H.activeTexture(H.TEXTURE1), os(H, H._emptyBlendTexture), void 0)
                }
            }(),
            Si = function (B, y, w) {
                B.activeTexture(B.TEXTURE0), os(B, h), B.activeTexture(B.TEXTURE1), os(B, h), w && (ok(B, y.aUv), cs(B, y.uTexture, !1), cs(B, y.uBlendTexture, !1))
            },
            hr = function (z, n, K, S, Q, r) {
                !K || v || dn || z.lineWidth(K), S && !z._picking && cs(z, n.uFixPickReverseColor, S), Q && om(z, Q, r, n.aPosition)
            },
            Qp = function (D, C, H, E) {
                wf && (E = D[wf]), D.drawArrays(E == h ? D.TRIANGLES : E, C, H);
                var e = D._renderInfo;
                e && (e.calls++, e.vertices += H, (E == h || E === D.TRIANGLES) && (e.faces += H / 3), E === D.LINES && (e.lines += H / 2))
            },
            Ho = function (p, W, F, o) {
                wf && (o = p[wf]), p.drawElements(o == h ? p.TRIANGLES : o, F, p.UNSIGNED_SHORT, W == h ? 0 : 2 * W);
                var A = p._renderInfo;
                A && (A.calls++, A.vertices += F, (o == h || o === p.TRIANGLES) && (A.faces += F / 3), o === p.LINES && (A.lines += F / 2))
            },
            Ic = function (K, U, Y, T, s) {
                var S = K.ARRAY_BUFFER;
                K.bindBuffer(S, U), Y && K.bufferData(S, Y, K.STATIC_DRAW), T != h && K.vertexAttribPointer(T, s ? s : 3, K.FLOAT, !1, 0, 0)
            },
            om = function (w, B, k, i, Y) {
                return k ? (Gf(w, w.ARRAY_BUFFER, B, k), i != h && w.vertexAttribPointer(i, Y ? Y : 3, w.FLOAT, !1, 0, 0), void 0) : Ic(w, B, k, i, Y)
            },
            Op = function (r, L, B) {
                var a = r.ELEMENT_ARRAY_BUFFER;
                r.bindBuffer(a, L), B && r.bufferData(a, B, r.STATIC_DRAW)
            },
            Hd = function (P, V, N) {
                Gf(P, P.ELEMENT_ARRAY_BUFFER, V, N)
            },
            Gf = function (I, O, L, Z) {
                var x = Z._bufId;
                x || (x = Z._bufId = k.Math.generateIncreasingID());
                var L, H = I._bufPool;
                (L = H[x]) && L._buf ? I.bindBuffer(O, L._buf) : (L = H[x] = {
                    _buf: Ll(I)
                }, I.bindBuffer(O, L._buf), I.bufferData(O, Z, I.STATIC_DRAW)), L._fid = I._renderInfo.frame
            },
            cs = function (c, J, Y) {
                if (Y != h && J != h) {
                    Y = Cj(Y);
                    var n = Y.length;
                    3 === n ? c.uniform3fv(J, Y) : 4 === n ? c.uniform4fv(J, Y) : 16 === n ? c.uniformMatrix4fv(J, !1, Y) : rl(Y) ? c.uniform1i(J, Y ? 1 : 0) : 2 === n ? c.uniform2fv(J, Y) : c.uniform1f(J, Y)
                }
            },
            pq = function (u, T) {
                T != h && T >= 0 && u.enableVertexAttribArray(T)
            },
            ok = function (b, T) {
                T != h && T >= 0 && b.disableVertexAttribArray(T)
            },
            sn = function (R, M) {
                var x = R.getGL(),
                    w = R._prg;
                R._7O = R._8O.pop(), M && (cs(x, w.uMVMatrix, R._7O), R._6O = M, cs(x, w.uNMatrix, M))
            },
            mr = function (Y, _) {
                return _ || (_ = Ip()), ij(_, Y), ks(_), Qb(_), _
            },
            hs = function (f, g) {
                var D = f.getGL(),
                    Z = f._prg,
                    B = f._7O;
                g && (f._8O.push(tl(B)), cs(D, Z.uMMatrix, g), sg(B, B, g), f._7O = B), cs(D, Z.uMVMatrix, B), cs(D, Z.uNMatrix, mr(B, f._6O))
            },
            ms = function (f, N, h, a, X, y) {
                if (h) {
                    if (a) {
                        var z = h.value++,
                            c = 2147483648 | z,
                            B = [(255 & c >> 16) / 255, (255 & c >> 8) / 255, (255 & c) / 255, (255 & c >> 24) / 255];
                        h[z] = {
                            data: X,
                            part: y
                        }
                    } else B = gg;
                    return cs(f, N.uFixPickReverseColor, B), B
                }
            },
            Dr = function () {
                var E = {
                    center: function (y, Q, M, K, A) {
                        var m = -Q[1] / 2,
                            e = {
                                x: -Q[0] / 2,
                                y: m,
                                width: Q[0],
                                height: Q[1]
                            },
                            _ = sj(y, e, M);
                        return [_.x + K, -_.y - A, Ui()]
                    },
                    front: function (A, M, I, T, N) {
                        var W = -M[1] / 2,
                            z = {
                                x: -M[0] / 2,
                                y: W,
                                width: M[0],
                                height: M[1]
                            },
                            d = sj(A, z, I);
                        return [d.x + T, -d.y - N, M[2] / 2 + Ui()]
                    },
                    back: function (Y, m, A, C, B) {
                        var X = -m[0] / 2,
                            b = -m[1] / 2,
                            s = {
                                x: X,
                                y: b,
                                width: m[0],
                                height: m[1]
                            },
                            a = sj(Y, s, A);
                        return [-a.x - C, -a.y - B, -m[2] / 2 - Ui()]
                    },
                    left: function (A, h, j, y, m) {
                        var L = -h[1] / 2,
                            b = {
                                x: -h[2] / 2,
                                y: L,
                                width: h[2],
                                height: h[1]
                            },
                            X = sj(A, b, j);
                        return [-h[0] / 2 - Ui(), -X.y - m, X.x + y]
                    },
                    right: function (g, l, q, b, W) {
                        var f = -l[2] / 2,
                            J = -l[1] / 2,
                            X = {
                                x: f,
                                y: J,
                                width: l[2],
                                height: l[1]
                            },
                            r = sj(g, X, q);
                        return [l[0] / 2 + Ui(), -r.y - W, -r.x - b]
                    },
                    top: function (G, q, O, H, T) {
                        var w = {
                                x: -q[0] / 2,
                                y: -q[2] / 2,
                                width: q[0],
                                height: q[2]
                            },
                            h = sj(G, w, O);
                        return [h.x + H, q[1] / 2 + Ui(), h.y + T]
                    },
                    bottom: function (P, H, d, N, z) {
                        var n = -H[2] / 2,
                            h = {
                                x: -H[0] / 2,
                                y: n,
                                width: H[0],
                                height: H[2]
                            },
                            U = sj(P, h, d);
                        return [U.x + N, -H[1] / 2 - Ui(), -U.y - z]
                    }
                };
                return function (s, a, r, d, X, L) {
                    return E[d](s, a, r, X || 0, L || 0)
                }
            }(),
            dd = function (M, H, W, b, G, r, C, n, z, Z) {
                if (G && (H[0] += G[0], H[1] += G[1], H[2] += G[2]), Xj(M, W), n) {
                    var T = Ip();
                    if (zb(T, z, Z), Br(H, T), Xj(M, H), M.auto = n, M.pos = Br([0, 0, 0], M), r) {
                        var y = M.mat2 = Ip();
                        zb(y, r, C)
                    }
                } else zb(M, z, Z), Xj(M, H), b === ul ? Zh(M, -g) : b === sb ? Zh(M, g) : b === $b ? pd(M, -g) : b === Id ? pd(M, g) : b === Hc && Zh(M, c), zb(M, r, C);
                return M
            },
            mm = function (x, D) {
                var y = D.auto,
                    w = D.mat2,
                    O = x.gv;
                if (y) {
                    var Z, G = Ip(),
                        F = [0, 0, 0, 0];
                    Z = "string" == typeof y ? [y.indexOf("x") < 0 ? O._eye[0] : O._center[0], y.indexOf("y") < 0 ? O._eye[1] : O._center[1], y.indexOf("z") < 0 ? O._eye[2] : O._center[2]] : O._eye, bh(F, ps(Ip(), Z, O._center, O._up)), Ki(G, gq(F, F), D.pos), w && sg(G, G, w), hs(O, G)
                } else hs(O, D)
            },
            zl = function (E, w, V, h, s) {
                var i = E.s,
                    o = E.gv,
                    u = o.getGL(),
                    Y = o._prg,
                    v = o._buffer,
                    _ = o._1O;
                bb(u, op, _), mm(E, V), Kl(u, Y, i(w + ".blend"), i(w + ".light"), i(w + ".opacity"), i(w + ".reverse.flip"), i(w + ".reverse.color"), i(w + ".reverse.cull")), $h(u, Y, _, s, v.uv, pc), om(u, v.vs, h, Y.aPosition), om(u, v.ns, Wg, Y.aNormal), Hd(u, v.is, us), Ho(u, 0, us.length), Si(u, Y, _), Qd(u, Y), sn(o)
            },
            Nk = function (z, D, K) {
                var O = z.gv,
                    B = z.data,
                    w = z[D] = {
                        blend: O.getBodyColor(B) || O.getFaceBlend(B, D),
                        light: O.getFaceLight(B, D),
                        color: O.getFaceColor(B, D),
                        opacity: O.getFaceOpacity(B, D),
                        transparent: O.getFaceTransparent(B, D),
                        reverseFlip: O.getFaceReverseFlip(B, D),
                        reverseColor: O.getFaceReverseColor(B, D),
                        reverseCull: O.getFaceReverseCull(B, D),
                        texture: O.getFaceImage(B, D),
                        blendTexture: O.getFaceBlendImage(B, D),
                        discardSelectable: O.getFaceDiscardSelectable(B, D)
                    };
                if ("csg" !== D) {
                    w.uv = O.getFaceUv(B, D) || K && K[D + "Uv"], w.uvScale = O.getFaceUvScale(B, D) || K && K[D + "UvScale"], w.uvOffset = O.getFaceUvOffset(B, D) || K && K[D + "UvOffset"];
                    var E = O.getFaceMat(B, D);
                    E && (w.mat = zh(B, E))
                }
                return w
            },
            Fp = function (d, w, e, q, l) {
                if (q) {
                    if (!l(q.transparent)) return;
                    var S = d.data,
                        m = d.gv,
                        f = m._buffer,
                        $ = m.getTexture(q.texture, S),
                        h = m.getTexture(q.blendTexture, S);
                    $h(w, e, $, q.discardSelectable, f.uv, q.tuv, q.uvOffset, q.uvScale, h), Kl(w, e, q.blend, q.light, q.opacity, q.reverseFlip, q.reverseColor, q.reverseCull), cs(w, e.uDiffuse, q.color || C["color.empty"]), om(w, f.vs, q.vs, e.aPosition), om(w, f.ns, q.ns, e.aNormal), Qp(w, 0, q.vs.length / 3), Qd(w, e), Si(w, e, $)
                }
            },
            Of = function (f, D, R, w, C, G) {
                var u, Q, N, e, E, n, z, F, I, m, i, h = [w - D, C - R],
                    X = f ? f.length : 0;
                for (N = 0; X > N; N++) {
                    for (e = 2, u = f[N], E = u[0], n = u[1]; e + 1 < u.length;) {
                        if (z = u[e], F = u[e + 1], Q = Uo(D, R, w, C, E, n, z, F, !0)) {
                            I = [z - E, F - n], m = Me(I), I[0] /= m, I[1] /= m, m = Gi(h, I), m = m > 0 ? G : -G, i = [I[0] * m, I[1] * m];
                            break
                        }
                        E = z, n = F, e += 2
                    }
                    if (i) break
                }
                if (i)
                    for (w = D + i[0], C = R + i[1], N = 0; X > N; N++)
                        for (e = 2, u = f[N], E = u[0], n = u[1]; e + 1 < u.length;) {
                            if (z = u[e], F = u[e + 1], Q = Uo(D, R, w, C, E, n, z, F, !0)) return [0, 0];
                            E = z, n = F, e += 2
                        }
                return i ? i : [w - D, C - R]
            },
            jl = k.graph3d = {},
            $g = function (o, q, A) {
                zc(N + ".graph3d." + o, q, A)
            },
            lm = "~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",
            qo = "~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
        xr(f, {
            setBatchInfo: function (P, S) {
                kr[P] = S
            },
            getBatchInfo: function (b) {
                return kr[b]
            }
        }, !0);
        var Rn = [1, 1, 1],
            Fg = [1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0],
            ko = [-.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5],
            Dk = [.5, .5, -.5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5],
            kq = [.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5],
            um = [.5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5],
            $o = [.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5],
            mq = [-.5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5],
            yl = function (m, w) {
                On(m, w, "_batchModelMap", "_batchIndexMap"), ci(m, w, "_wireframeModelMap", "_wireframeIndexMap"), ci(m, w, "_polylineModelMap", "_polylineIndexMap"), ci(m, w, "_wireframeModelMapSwap", "_wireframeIndexMapSwap"), ci(m, w, "_polylineModelMapSwap", "_polylineIndexMapSwap")
            },
            On = function (u, z, T, q) {
                if (!z) return u[T] = {}, u[q] = {}, void 0;
                var I = z._id,
                    _ = u[q],
                    O = _[I];
                if (O) {
                    var F = u[T],
                        J = O.batch,
                        M = F[J],
                        K = M.ds,
                        o = O.index;
                    if (M.invalidate = !0, delete _[I], K.splice(o, 1), ji(K)) return delete F[J], void 0;
                    for (var b = O.begin, j = O.size, Q = 3 * b, v = 3 * j, X = 4 * b, E = 4 * j, p = M.vs, R = M.ps, m = M.uv, r = M.cs, B = M.bs, y = M.rs, L = M.ns, Z = M.ls; o < K.length; o++) O = _[K[o]._id], O.index--, O.begin -= j;
                    p.splice(Q, v), R.splice(X, E), m && m.splice(2 * b, 2 * j), r && r.splice(X, E), B && B.splice(Q, v), y && y.splice(b, j), L && L.splice(Q, v), Z && Z.splice(b, j)
                }
            },
            ci = On,
            ag = function (Q, g, D, y) {
                if (!y) return h;
                var E = g[y];
                if (!E) {
                    var W = kr[y] || di,
                        Z = W.image ? [] : h;
                    E = g[y] = {
                        vs: [],
                        ns: [],
                        uv: Z,
                        cs: Z ? h : W.color ? h : [],
                        bs: W.blend ? [] : h,
                        ps: [],
                        rs: W.brightness ? [] : h,
                        ds: []
                    }
                }
                return E.invalidate = !0, Q[D._id] = {
                    index: E.ds.length,
                    begin: E.vs.length / 3,
                    batch: y
                }, E.ds.push(D), E
            },
            bk = function (p, t) {
                return t != h && 1 !== t ? [p[0] * t, p[1] * t, p[2] * t, p[3]] : p
            },
            zq = function (U, j, X) {
                var L = U.getBrightness(j),
                    S = Cj(X.color || "white"),
                    z = S[3] < 1,
                    T = Math.ceil(X.width) || 1,
                    p = (z ? "T" : "O") + T,
                    V = U._wireframeIndexMap,
                    c = U._wireframeModelMap,
                    Z = c[p];
                Z || (Z = c[p] = {
                    vs: [],
                    cs: [],
                    ps: [],
                    ds: [],
                    T: z,
                    W: T
                });
                var b, u = U.getData3dUI(j),
                    a = Sb(u);
                if (X.geometry) {
                    if (!a) return;
                    if (b = Kj(a), !b) return
                } else b = X.short ? jo : el;
                Z.invalidate = !0;
                var t = Z.vs,
                    C = Z.cs,
                    Y = Z.ds,
                    F = V[j._id] = {
                        index: Y.length,
                        begin: t.length / 3,
                        batch: p
                    };
                Y.push(j);
                var B = zh(j, X.mat),
                    x = u._calcAnchorMat(j);
                x && sg(B, B, x), mj(t, B, b);
                var I = F.size = t.length / 3 - F.begin;
                Gp(C, bk(S, L), I)
            },
            Ld = function ($, L, X, m, K, O, t, w, B) {
                var j = $.getBrightness(L);
                j == h && (j = 1);
                var J = bk(Cj(m), j),
                    G = J[3] < 1;
                O = Math.ceil(O) || 1;
                var S = (G ? "T" : "O") + O;
                if (t) {
                    var Y = t[0],
                        q = (t[1] || Y) + Y;
                    S += "-" + Y + "-" + q, B && (S += "-" + fj(B) + "-" + j, B = bk(Cj(B), j))
                }
                var r = $._polylineIndexMap,
                    M = $._polylineModelMap,
                    T = M[S];
                T || (T = M[S] = {
                    vs: [],
                    cs: [],
                    ps: [],
                    ds: [],
                    ls: t ? [] : h,
                    T: G,
                    W: O
                }, t && (T.D = Y, T.G = q, T.A = B)), T.invalidate = !0;
                var Z, E = T.vs,
                    U = T.cs,
                    e = T.ds,
                    l = T.ls,
                    i = r[L._id] = {
                        index: e.length,
                        begin: E.length / 3,
                        batch: S
                    };
                e.push(L), ug(E, X);
                var b, g = i.size = E.length / 3 - i.begin,
                    H = X.length,
                    k = 0,
                    c = [];
                if (t || K)
                    for (Z = 0; H > Z; Z += 6) b = Me([X[Z], X[Z + 1], X[Z + 2]], [X[Z + 3], X[Z + 4], X[Z + 5]]), c.push(b), k += b;
                if (k && K) {
                    var u, D = bk(Cj(K), j),
                        p = [D[0] - J[0], D[1] - J[1], D[2] - J[2], D[3] - J[3]],
                        o = 0;
                    for (Z = 0; H > Z; Z += 6) u = o / k, Gp(U, [J[0] + p[0] * u, J[1] + p[1] * u, J[2] + p[2] * u, J[3] + p[3] * u], 1), o += c[Z / 6], u = o / k, Gp(U, [J[0] + p[0] * u, J[1] + p[1] * u, J[2] + p[2] * u, J[3] + p[3] * u], 1)
                } else Gp(U, J, g);
                if (t)
                    for (o = w || 0, Z = 0; H > Z; Z += 6) l.push(o), o += c[Z / 6], l.push(o)
            },
            vc = function (G, r, H) {
                if (r)
                    for (var e = 4 * r.begin, d = H[r.batch].ps, W = 0; W < r.size; W++) d[e++] = G[0], d[e++] = G[1], d[e++] = G[2], d[e++] = G[3]
            },
            vg = function (s, i) {
                var w = i + ["32"],
                    Q = s[i],
                    X = s[w];
                Q ? X && X.length === Q.length ? (X.set(Q), X._bufId = null) : s[w] = new Ol(Q) : delete s[w]
            },
            Lr = function (d, $, Z, S, D, l, M, E, f) {
                if (nj(Z)) Z.forEach(function (o) {
                    Lr(d, $, o, S, D, l, M, E, f)
                });
                else if (Qc(Z)) Lr(d, $, Sb(S, Z), S, D, l, M, E, f);
                else if (cl(Z)) {
                    var s, n = ze(Z.mat, $, d),
                        P = ze(Z.s3, $, d),
                        C = ze(Z.t3, $, d),
                        v = ze(Z.r3, $, d);
                    if ((P || v || C || n) && (s = Kq(n, P, v, ze(Z.rotationMode, $, d), C), l.push(s)), Z.shape3d) Lr(d, $, Z.shape3d, S, D, l, M, E, Z);
                    else {
                        var y = S.s;
                        f = f || di;
                        var V = l[0],
                            G = l.length,
                            k = y("shape3d.color", Z.color, f.color);
                        if (D || (D = y("shape3d.blend", Z.blend, f.blend)), G > 1) {
                            V = tl(V);
                            for (var R = 1; G > R; R++) sg(V, V, l[R])
                        }
                        Z.vs && y(pl, Z.visible, f.visible) && Bp(V, M, E, Z.vs, Z.uv, Z.is, D, k), Z.top_vs && y(gp, Z.topVisible, f.topVisible) && Bp(V, M, E, Z.top_vs, Z.top_uv, Z.top_is, D, y("shape3d.top.color", Z.topColor, f.topColor) || k), Z.bottom_vs && y(db, Z.bottomVisible, f.bottomVisible) && Bp(V, M, E, Z.bottom_vs, Z.bottom_uv, Z.bottom_is, D, y("shape3d.bottom.color", Z.bottomColor, f.bottomColor) || k), Z.from_vs && y(se, Z.fromVisible, f.fromVisible) && Bp(V, M, E, Z.from_vs, Z.from_uv, Z.from_is, D, y("shape3d.from.color", Z.fromColor, f.fromColor) || k), Z.to_vs && y(Yg, Z.toVisible, f.toVisible) && Bp(V, M, E, Z.to_vs, Z.to_uv, Z.to_is, D, y("shape3d.to.color", Z.toColor, f.toColor) || k)
                    }
                    s && l.pop()
                }
            },
            Bp = function (D, f, U, g, K, t, o, X) {
                var N, G = f.cs,
                    i = f.uv,
                    k = f.bs;
                if (t) {
                    N = t.length;
                    for (var L = 0; N > L; L++) {
                        var _ = t[L];
                        mj(U, D, [g[3 * _], g[3 * _ + 1], g[3 * _ + 2]]), i && ug(i, [K[2 * _], K[2 * _ + 1]])
                    }
                } else N = g.length / 3, mj(U, D, g), i && ug(i, K);
                G && Gp(G, X, N), k && (o ? xh(k, o, N) : ug(k, Rn, N))
            },
            sl = function (j, E, o, f) {
                var D = [];
                f ? Lr(j.gv, j.data, f, j, j.getBodyColor(), [E], o, D) : (Ub(j, ul, E, o, D), Ub(j, sb, E, o, D), Ub(j, fg, E, o, D), Ub(j, Hc, E, o, D), Ub(j, $b, E, o, D), Ub(j, Id, E, o, D), Ub(j, "csg", E, o, D)), D.length && (ug(o.vs, D), ug(o.ns, Xp(D)))
            },
            Ub = function (c, B, W, K, D) {
                var L = c[B];
                if (L) {
                    var T = L.tuv;
                    if (T) {
                        var q, v, s, M, R = L.uvScale,
                            k = L.uvOffset;
                        if (R)
                            for (q = T.length, v = R[0], s = R[1], M = 0; q > M; M += 2) T[M] *= v, T[M + 1] *= s;
                        if (k)
                            for (q = T.length, v = k[0], s = k[1], M = 0; q > M; M += 2) T[M] += v, T[M + 1] += s
                    }
                    Bp(W, K, D, L.vs, T, h, L.blend, L.color)
                }
            },
            zf = function (Y, o, n, b, a, T, N, f) {
                var k, q = n.cs,
                    E = n.uv,
                    X = n.bs;
                if (Y.getFaceVisible(o, T)) {
                    var w = Y.getFaceMat(o, T);
                    if (w && (a = zh(o, w)), mj(N, a, f), q && Gp(q, Y.getFaceColor(o, T), 6), E) {
                        var t = Y.getFaceUv(o, T) || b[T + "Uv"],
                            G = Y.getFaceUvScale(o, T) || b[T + "UvScale"],
                            M = Y.getFaceUvOffset(o, T) || b[T + "UvOffset"];
                        t = t ? [t[6], t[7], t[0], t[1], t[2], t[3], t[2], t[3], t[4], t[5], t[6], t[7]] : Fg;
                        var z = t[0],
                            p = t[1],
                            F = t[2],
                            d = t[3],
                            S = t[4],
                            e = t[5],
                            J = t[6],
                            s = t[7],
                            i = t[8],
                            C = t[9],
                            R = t[10],
                            I = t[11];
                        if (G) {
                            var D = G[0],
                                O = G[1];
                            z *= D, p *= O, F *= D, d *= O, S *= D, e *= O, J *= D, s *= O, i *= D, C *= O, R *= D, I *= O
                        }
                        if (M) {
                            var m = M[0],
                                g = M[1];
                            z += m, p += g, F += m, d += g, S += m, e += g, J += m, s += g, i += m, C += g, R += m, I += g
                        }
                        E.push(z, p, F, d, S, e, J, s, i, C, R, I)
                    }
                    X && (k = Y.getBodyColor(o) || Y.getFaceBlend(o, T), k ? xh(X, k, 6) : ug(X, Rn, 6))
                }
            },
            Tf = function (V, $, U, k) {
                var J = V.getGL(),
                    O = V._prg,
                    T = V._buffer;
                if (!V.drawFilter && !nm($)) {
                    hs(V), $k(J, O);
                    for (var N in $) {
                        var s = $[N];
                        if (!(k && !s.T || !k && s.T)) {
                            s.invalidate ? (s.invalidate = !1, vg(s, "vs"), vg(s, "cs"), vg(s, "ls"), vg(s, "ps")) : U && vg(s, "ps");
                            var M = s.vs32,
                                W = U ? s.ps32 : s.cs32;
                            hr(J, O, s.W, h, T.vs, M);
                            var u = s.D,
                                I = !V._dashDisabled && u;
                            cs(J, O.uAlphaTest, C.alphaTest), I && (cs(J, O.uDash, !0), cs(J, O.uDashDistance, u), cs(J, O.uDashGapDistance, s.G), pq(J, O.aLineDistance), om(J, T.lineDistance, s.ls32, O.aLineDistance, 1), cs(J, O.uDiffuse, s.A || C["color.empty"]));
                            var t = !V._batchColorDisabled;
                            t && (cs(J, O.uBatchColor, !0), pq(J, O.aBatchColor), om(J, T.batchColor, W, O.aBatchColor, 4)), $h(J), Qp(J, 0, M.length / 3, J.LINES), Si(J), t && (cs(J, O.uBatchColor, !1), ok(J, O.aBatchColor)), I && (cs(J, O.uDash, !1), ok(J, O.aLineDistance))
                        }
                    }
                    $e(J, O)
                }
            },
            Pp = function (o, U, b) {
                var c, i, t, w, F, Y, B, f, I, s, l, _ = o.getGL(),
                    W = o._prg,
                    u = o._buffer,
                    a = o._batchModelMap;
                if (!nm(a)) {
                    hs(o);
                    for (c in a)
                        if (i = kr[c] || di, !(b && !i.transparent || !b && i.transparent) && (t = a[c], U || !i.transparentMask)) {
                            var D = b && i.autoSort !== !1 && (o._33Q || t.invalidate);
                            if (t.invalidate ? (t.invalidate = !1, vg(t, "vs"), vg(t, "ns"), vg(t, "cs"), vg(t, "rs"), vg(t, "ps"), vg(t, "bs"), vg(t, "uv")) : U && vg(t, "ps"), F = t.vs32, Y = U ? t.ps32 : t.cs32, I = t.uv32, B = t.bs32, f = t.rs32, l = F.length / 3, D && (t.is = Um(F, o.getEye())), l) {
                                w = i.light, s = o.getTexture(i.image), Kl(_, W, h, i.light, i.opacity, i.reverseFlip, i.reverseColor, i.reverseCull), Y ? o._batchColorDisabled || (cs(_, W.uBatchColor, !0), pq(_, W.aBatchColor), om(_, u.batchColor, Y, W.aBatchColor, 4)) : cs(_, W.uDiffuse, i.color || C["color.empty"]);
                                var L = i.alphaTest;
                                cs(_, W.uAlphaTest, L === p ? C.alphaTest : L);
                                var j = B && !o._batchBlendDisabled;
                                j && (cs(_, W.uBatchBlend, !0), pq(_, W.aBatchBlend), om(_, u.batchBlend, B, W.aBatchBlend));
                                var n = f && !o._batchBrightnessDisabled;
                                n && (cs(_, W.uBatchBrightness, !0), pq(_, W.aBatchBrightness), om(_, u.batchBrightness, f, W.aBatchBrightness, 1)), I ? $h(_, W, s, i.discardSelectable, u.uv, I, i.uvOffset, i.uvScale) : $h(_), om(_, u.vs, F, W.aPosition), om(_, u.ns, t.ns32, W.aNormal), t.is ? (Op(_, u.is, t.is), Ho(_, 0, l)) : Qp(_, 0, l), I ? Si(_, W, s) : Si(_), Y && !o._batchColorDisabled && (cs(_, W.uBatchColor, !1), ok(_, W.aBatchColor)), j && (cs(_, W.uBatchBlend, !1), ok(_, W.aBatchBlend)), n && (cs(_, W.uBatchBrightness, !1), ok(_, W.aBatchBrightness)), Qd(_, W)
                            }
                        }
                }
            },
            Um = function (f, E) {
                for (var h = f.length / 3, Z = new Array(h), p = h / 3, g = new Array(p), Q = 0; p > Q; Q++) g[Q] = Q;
                g.sort(function (_, C) {
                    var r = 9 * _,
                        z = [(f[r] + f[r + 3] + 2 * f[r + 6]) / 4, (f[r + 1] + f[r + 4] + 2 * f[r + 7]) / 4, (f[r + 2] + f[r + 5] + 2 * f[r + 8]) / 4];
                    r = 9 * C;
                    var k = [(f[r] + f[r + 3] + 2 * f[r + 6]) / 4, (f[r + 1] + f[r + 4] + 2 * f[r + 7]) / 4, (f[r + 2] + f[r + 5] + 2 * f[r + 8]) / 4],
                        m = Me(E, z) - Me(E, k);
                    return m > 0 ? -1 : 0 > m ? 1 : 0
                });
                for (var Q = 0; p > Q; Q++) {
                    var X = 3 * Q,
                        d = 3 * g[Q];
                    Z[X] = d, Z[X + 1] = d + 1, Z[X + 2] = d + 2
                }
                return new Fk(Z)
            },
            Eg = {
                obj: function (d, K) {
                    var N = {
                        mat: d.mat,
                        s3: d.s3,
                        r3: d.r3,
                        rotationMode: d.rotationMode,
                        t3: d.t3,
                        cube: d.cube == h ? !0 : d.cube,
                        center: d.center == h ? !0 : d.center,
                        ignoreMtls: d.ignoreMtls,
                        ignoreTransparent: d.ignoreTransparent,
                        ignoreColor: d.ignoreColor,
                        ignoreImage: d.ignoreImage,
                        ignoreNormal: d.ignoreNormal,
                        prefix: d.prefix,
                        flipY: d.flipY,
                        flipFace: d.flipFace,
                        reverseFlipMtls: d.reverseFlipMtls,
                        finishFunc: function (i, Y) {
                            if (i) {
                                var Y = [];
                                for (var G in i) {
                                    var B = i[G];
                                    Y.rawS3 = B.rawS3, Y.push(B), d.eachModel && d.eachModel(G, B)
                                }
                                Y.json = d, K(Y)
                            } else K()
                        }
                    };
                    f.loadObj(d.obj, d.mtl, N)
                }
            };
        f.getModelTypeHandlers = function () {
            return Eg
        }, f.setModelTypeHandler = function (g, v) {
            Eg[g] = v
        }, f.getModelTypeHandler = function (O) {
            return Eg[O]
        }, f.handleModelLoaded = function () {}, f.handleUnfoundModel = function () {};
        var lq = h,
            $n = h,
            Fq = function (Z) {
                lq && !Z._loadingModelView_ && ($n || ($n = {}), $n[Z._loadingModelView_ = Uk()] = Z)
            },
            Md = function (Q, C) {
                lq || (lq = {});
                var i = lq[Q];
                if (i) {
                    if (i.url === C) return;
                    i.request.onload = qm, i.request.onerror = qm
                }
                var U = new ne;
                if (lq[Q] = {
                        request: U,
                        url: C
                    }, C = f.beforeLoadURL(C), C.data) {
                    var Y = f.parse(C.data);
                    Xd(Q, Y, C)
                } else {
                    U.onload = function (p) {
                        if (200 === this.status || 0 === this.status) {
                            delete lq[Q];
                            var H = f.parse(p.target.response || p.target.responseText);
                            Xd(Q, H, C)
                        } else hm(Q, f.handleUnfoundModel(Q, C) || h)
                    }, U.onerror = function () {
                        hm(Q, f.handleUnfoundModel(Q, C) || h)
                    };
                    var D = {};
                    D.url = encodeURI(C), D.sync = !1, U.send(D)
                }
            },
            Xd = function (n, t, R) {
                var o = t.modelType;
                if (!o) return hm(n, t), f.handleModelLoaded(n, t), void 0;
                var q = f.getModelTypeHandler(o);
                if (q) {
                    if (lq || (lq = {}), lq[n]) return;
                    lq[n] = !0;
                    var k = function (y) {
                        y ? (hm(n, y), f.handleModelLoaded(n, y)) : hm(n, f.handleUnfoundModel(n, R) || h)
                    };
                    q(t, k)
                } else hm(n, f.handleUnfoundModel(n, R) || h)
            },
            hm = function (D, v) {
                if (Yb[D] = v, delete lq[D], nm(lq) && (lq = h, $n)) {
                    for (var t in $n) {
                        var Z = $n[t];
                        Z._2O && (Z._2O = {}), Z.invalidateAll && Z.invalidateAll(p, "modelLoaded", D), Z.redraw && Z.redraw(), Z.iv(), delete Z._loadingModelView_
                    }
                    $n = h
                }
                if (v && $n)
                    for (var t in $n) {
                        var Z = $n[t];
                        Z.invalidateAll && Z.invalidateAll(p, "modelLoading", D), Z.redraw && Z.redraw(), Z.iv()
                    }
            },
            pc = new Ol([0, 0, 0, 1, 1, 1, 1, 0]),
            Wg = new Ol([0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]),
            us = new Fk([0, 1, 2, 2, 3, 0]),
            Wi = new Ol([-.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, .5]),
            sp = new Fk([0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23]),
            mi = new Ol([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]),
            gj = Xp(Wi, sp),
            qi = (new Ol([-.5, .5, .5, -.5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, -.5, -.5, .5, .5, -.5, -.5, -.5, -.5, -.5, .5, -.5]), new Fk([0, 1, 2, 3, 0, 7, 5, 4, 6, 7, 5, 3, 2, 4, 6, 1]), [ul, fg, sb, Hc, $b, Id]),
            el = [-.5, .5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, .5, .5, .5, .5, .5, .5, .5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, -.5, -.5, -.5, -.5, .5, -.5, -.5, .5, -.5, -.5, .5, .5, -.5, .5, .5, -.5, -.5, .5, -.5, .5, .5, .5, .5, .5, -.5, .5, -.5, .5, .5, -.5, -.5, -.5, .5, .5, -.5, .5, -.5, -.5, -.5, .5, -.5, -.5, -.5],
            jo = [-.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, .5, .5, .5, .5, .5, .5, .4, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, .5, .5, -.5, .5, .5, -.5, .4, -.5, .5, -.5, -.4, .5, -.5, -.5, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, .5, .5, -.5, .4, .5, -.5, .5, .5, -.5, .5, .4, -.5, .5, .5, -.5, .5, .5, -.4, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, -.5, -.5, -.5, -.5, -.5, -.5, -.4, .5, -.5, -.5, .4, -.5, -.5, .5, -.5, -.5, .5, -.4, -.5, .5, -.5, -.5, .5, -.5, -.4],
            Ao = function (Y, g, O, $, i, L) {
                L = L || 16, Y = Y || 16, g = g || 0, O = O || Y;
                var T, B, J, y, K, D, Z, M, n = .5,
                    I = [],
                    s = [],
                    H = E / Y,
                    r = c / L;
                for (T = 0; L > T; T++)
                    for (K = T + 1, y = T * r, M = K * r, B = g; O > B; B++) D = B + 1, J = B * H, Z = D * H, I.push(n * R(y) * w(J), n * w(y), -n * R(y) * R(J), n * R(M) * w(Z), n * w(M), -n * R(M) * R(Z), n * R(y) * w(Z), n * w(y), -n * R(y) * R(Z), n * R(y) * w(J), n * w(y), -n * R(y) * R(J), n * R(M) * w(J), n * w(M), -n * R(M) * R(J), n * R(M) * w(Z), n * w(M), -n * R(M) * R(Z)), s.push(B / Y, T / L, D / Y, K / L, D / Y, T / L, B / Y, T / L, B / Y, K / L, D / Y, K / L);
                if ($) {
                    var k = [],
                        V = [];
                    for (J = g * H, T = 0; L > T; T++) K = T + 1, y = T * r, M = K * r, k.push(0, 0, 0, n * R(M) * w(J), n * w(M), -n * R(M) * R(J), n * R(y) * w(J), n * w(y), -n * R(y) * R(J)), V.push(0, .5, g / Y, K / L, g / Y, T / L)
                }
                if (i) {
                    var S = [],
                        C = [];
                    for (J = O * H, T = 0; L > T; T++) K = T + 1, y = T * r, M = K * r, S.push(0, 0, 0, n * R(y) * w(J), n * w(y), -n * R(y) * R(J), n * R(M) * w(J), n * w(M), -n * R(M) * R(J)), C.push(1, .5, O / Y, T / L, O / Y, K / L)
                }
                return {
                    vs: I,
                    uv: s,
                    from_vs: k,
                    from_uv: V,
                    to_vs: S,
                    to_uv: C
                }
            },
            Qm = function (g, T, V) {
                g = g || .17, T = T || 12, V = V || 18, 0 > g ? g = 0 : g > .25 && (g = .25);
                var x, j, Q, m, A, C, l, Y = .5,
                    y = [],
                    k = [],
                    M = [],
                    t = E / V,
                    W = E / T,
                    h = Y - g;
                for (j = 0; T >= j; j++)
                    for (m = -c + j * W, C = w(m), A = R(m), x = 0; V >= x; x++) Q = x * t, l = h + g * C, y.push(w(Q) * l, A * g, -R(Q) * l), k.push(x / V, 1 - j / T);
                for (j = 0; T > j; j++) {
                    var $ = j * (V + 1),
                        N = (j + 1) * (V + 1);
                    for (x = 0; V > x; x++) M.push($ + x, N + x + 1, N + x, $ + x, $ + x + 1, N + x + 1)
                }
                return {
                    vs: y,
                    uv: k,
                    is: M
                }
            },
            Ul = function (P, M, B, b, J, k, r) {
                r = r || 12, P = P || 18, M = M || 0, B = B || P, k = k || .17, 0 > k ? k = 0 : k > .25 && (k = .25);
                var S, $, d, t, Q, f, T, i, V, v, m = .5,
                    y = [],
                    z = [],
                    Y = E / P,
                    H = E / r,
                    D = m - k;
                for (d = 0; r > d; d++)
                    for (t = d + 1, T = -c + d * H, i = -c + t * H, S = M; B > S; S++) $ = S + 1, Q = S * Y, f = $ * Y, V = D + k * w(T), v = D + k * w(i), y.push(w(Q) * V, R(T) * k, -R(Q) * V, w(f) * V, R(T) * k, -R(f) * V, w(f) * v, R(i) * k, -R(f) * v, w(Q) * V, R(T) * k, -R(Q) * V, w(f) * v, R(i) * k, -R(f) * v, w(Q) * v, R(i) * k, -R(Q) * v), z.push(S / P, 1 - d / r, $ / P, 1 - d / r, $ / P, 1 - t / r, S / P, 1 - d / r, $ / P, 1 - t / r, S / P, 1 - t / r);
                if (b) {
                    var e = [],
                        l = [];
                    for (d = 0; r > d; d++) t = d + 1, T = -c + d * H, i = -c + t * H, Q = M * Y, V = D + k * w(T), v = D + k * w(i), e.push(w(Q) * V, R(T) * k, -R(Q) * V, w(Q) * v, R(i) * k, -R(Q) * v, w(Q) * D, 0, -R(Q) * D), l.push(.5 + .5 * w(T), .5 - .5 * R(T), .5 + .5 * w(i), .5 - .5 * R(i), .5, .5)
                }
                if (J) {
                    var G = [],
                        Z = [];
                    for (d = 0; r > d; d++) t = d + 1, T = -c + d * H, i = -c + t * H, Q = B * Y, V = D + k * w(T), v = D + k * w(i), G.push(w(Q) * V, R(T) * k, -R(Q) * V, w(Q) * D, 0, -R(Q) * D, w(Q) * v, R(i) * k, -R(Q) * v), Z.push(.5 - .5 * w(T), .5 - .5 * R(T), .5, .5, .5 - .5 * w(i), .5 - .5 * R(i))
                }
                return {
                    vs: y,
                    uv: z,
                    from_vs: e,
                    from_uv: l,
                    to_vs: G,
                    to_uv: Z
                }
            },
            rc = function (A, j) {
                for (var d, p, I, c = .5, $ = 16, o = [], U = [], Y = [], u = E / $, Q = 0; $ >= Q; Q++) d = Q * u, p = w(d) * c, I = R(d) * c, o.push(p, -c, I, p, c, I), U.push(1 - Q / $, 1, 1 - Q / $, 0);
                for (Q = 0; $ > Q; Q++) Y.push(2 * Q, 2 * Q + 1, 2 * Q + 3, 2 * Q, 2 * Q + 3, 2 * Q + 2);
                if (j) {
                    var O = [],
                        W = [],
                        N = [];
                    for (O.push(0, -c, 0), W.push(.5, .5), Q = 0; $ >= Q; Q++) d = Q * u, p = w(d), I = R(d), O.push(p * c, -c, -I * c), W.push(.5 + .5 * p, .5 + .5 * I);
                    for (Q = 0; $ > Q; Q++) N.push(0, Q + 2, Q + 1)
                }
                if (A) {
                    var J = [],
                        G = [],
                        F = [];
                    for (J.push(0, c, 0), G.push(.5, .5), Q = 0; $ >= Q; Q++) d = Q * u, p = w(d), I = R(d), J.push(p * c, c, -I * c), G.push(.5 + .5 * p, .5 - .5 * I);
                    for (Q = 0; $ > Q; Q++) F.push(0, Q + 1, Q + 2)
                }
                return {
                    vs: o,
                    uv: U,
                    is: Y,
                    bottom_vs: O,
                    bottom_uv: W,
                    bottom_is: N,
                    top_vs: J,
                    top_uv: G,
                    top_is: F
                }
            },
            Rl = function (q, t, m, e, L, O, V) {
                q = q || 12, t = t || 0, m = m || q;
                for (var s, c, i, l, M, b, v, G, _ = .5, C = [], g = [], I = E / q, B = t; m > B; B++) s = B + 1, c = B * I, i = s * I, l = w(c) * _, M = R(c) * _, b = w(i) * _, v = R(i) * _, C.push(l, -_, -M, b, -_, -v, l, _, -M, b, -_, -v, b, _, -v, l, _, -M), g.push(B / q, 1, s / q, 1, B / q, 0, s / q, 1, s / q, 0, B / q, 0);
                if (V) {
                    var Q = [],
                        S = [];
                    for (B = t; m > B; B++) c = I * B, i = I * (B + 1), l = w(c), M = R(c), b = w(i), v = R(i), Q.push(l * _, -_, -M * _, 0, -_, 0, b * _, -_, -v * _), S.push(.5 + .5 * l, .5 + .5 * M, .5, .5, .5 + .5 * b, .5 + .5 * v)
                }
                if (O) {
                    var F = [],
                        A = [];
                    for (B = t; m > B; B++) c = I * B, i = I * (B + 1), l = w(c), M = R(c), b = w(i), v = R(i), F.push(l * _, _, -M * _, b * _, _, -v * _, 0, _, 0), A.push(.5 + .5 * l, .5 - .5 * M, .5 + .5 * b, .5 - .5 * v, .5, .5)
                }
                if (e) {
                    var W = [],
                        u = [];
                    c = I * t, l = w(c) * _, M = R(c) * _, G = t / q, W.push(0, _, 0, 0, -_, 0, l, -_, -M, l, -_, -M, l, _, -M, 0, _, 0), u.push(0, 0, 0, 1, G, 1, G, 1, G, 0, 0, 0)
                }
                if (L) {
                    var r = [],
                        n = [];
                    c = I * m, l = w(c) * _, M = R(c) * _, G = m / q, r.push(0, -_, 0, 0, _, 0, l, _, -M, l, _, -M, l, -_, -M, 0, -_, 0), n.push(1, 1, 1, 0, G, 0, G, 0, G, 1, 1, 1)
                }
                return {
                    vs: C,
                    uv: g,
                    bottom_vs: Q,
                    bottom_uv: S,
                    top_vs: F,
                    top_uv: A,
                    from_vs: W,
                    from_uv: u,
                    to_vs: r,
                    to_uv: n
                }
            },
            Ai = function (l, p, r, b, I) {
                p = p || 18, r = r || 0, b = b == h ? E : b, I = I == h ? .5 : I;
                for (var B, a, c, x, o, D, Y = [0, .5, .75, .875, .9375], U = [], L = [], $ = [], F = b / p, i = 0; i < Y.length; i++) {
                    var u = 0 === i % 2 ? 0 : .5;
                    for (B = 0; p >= B; B++) a = (B + u) * F + r, c = 1 - Y[i], U.push(w(a) * I * c, -I + 2 * Y[i] * I, -R(a) * I * c), L.push((B + u) / p, c)
                }
                for (i = 0; i < Y.length - 1; i++) {
                    var y = i * (p + 1),
                        f = (i + 1) * (p + 1);
                    for (B = 0; p > B; B++) $.push(y + B, f + B + 1, f + B, y + B, y + B + 1, f + B + 1)
                }
                for (D = U.length / 3 - (p + 1), B = 0; p > B; B++) U.push(0, I, 0), L.push((B + .5) / p, 0);
                for (B = 0; p > B; B++) $.push(D + B, D + B + 1, D + (p + 1) + B);
                if (l) {
                    var N = [],
                        q = [],
                        S = [];
                    for (N.push(0, -I, 0), q.push(.5, .5), B = 0; p >= B; B++) a = B * F + r, x = w(a), o = R(a), N.push(x * I, -I, -o * I), q.push(.5 + .5 * x, .5 + .5 * o);
                    for (B = 0; p > B; B++) S.push(0, B + 2, B + 1)
                }
                return {
                    vs: U,
                    uv: L,
                    is: $,
                    bottom_vs: N,
                    bottom_uv: q,
                    bottom_is: S
                }
            },
            mk = function (P, V, s, N, d, X) {
                P = P || 16, V = V || 0, s = s || P;
                for (var _ = .5, z = [], k = [], G = E / P, l = V; s > l; l++) {
                    var h = l + 1,
                        Y = G * l,
                        y = G * h;
                    z.push(w(Y) * _, -_, -R(Y) * _, w(y) * _, -_, -R(y) * _, 0, _, 0), k.push(l / P, 1, h / P, 1, (l + h) / 2 / P, 0)
                }
                if (X) {
                    var o = [],
                        c = [];
                    for (l = V; s > l; l++) {
                        Y = G * l, y = G * (l + 1);
                        var I = w(Y),
                            b = R(Y),
                            B = w(y),
                            t = R(y);
                        o.push(I * _, -_, -b * _, 0, -_, 0, B * _, -_, -t * _), c.push(.5 + .5 * I, .5 + .5 * b, .5, .5, .5 + .5 * B, .5 + .5 * t)
                    }
                }
                if (N) {
                    var j = [],
                        g = [];
                    Y = G * V, j.push(0, _, 0, 0, -_, 0, w(Y) * _, -_, -R(Y) * _), g.push(0, 0, 0, 1, V / P, 1)
                }
                if (d) {
                    var M = [],
                        Q = [];
                    Y = G * s, M.push(0, -_, 0, 0, _, 0, w(Y) * _, -_, -R(Y) * _), Q.push(1, 1, 1, 0, s / P, 1)
                }
                return {
                    vs: z,
                    uv: k,
                    bottom_vs: o,
                    bottom_uv: c,
                    from_vs: j,
                    from_uv: g,
                    to_vs: M,
                    to_uv: Q
                }
            },
            Lo = function (P, S, D, s, w, u, d, L) {
                for (var Z = [], H = 0; H < P.length - 1; H += 2) Z.push({
                    x: P[H],
                    y: P[H + 1]
                });
                return Mi(Z, S, D, s, w, u, d, L, !1)
            },
            _p = {
                roundRect: function (n, Y) {
                    return Lo([.5, .4, .5, .442, .471, .471, .442, .5, .4, .5, -.4, .5, -.442, .5, -.471, .471, -.5, .442, -.5, .4, -.5, -.4, -.5, -.442, -.471, -.471, -.442, -.5, -.4, -.5, .4, -.5, .442, -.5, .471, -.471, .5, -.442, .5, -.4, .5, .4], [1, 3, 3, 2, 3, 3, 2, 3, 3, 2, 3, 3, 2], n, Y, 3)
                },
                star: function (F, v) {
                    return Lo([.193, .079, .333, .5, 0, .233, -.333, .5, -.194, .079, -.5, -.167, -.112, -.167, 0, -.5, .111, -.167, .5, -.167], [1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 5], F, v)
                },
                rect: function (J, s) {
                    return Lo([.5, -.5, .5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 2, 5], J, s)
                },
                billboard: function () {
                    return {
                        vs: [-.5, .5, 0, -.5, -.5, 0, .5, .5, 0, .5, .5, 0, -.5, -.5, 0, .5, -.5, 0],
                        uv: [0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1],
                        ns: [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]
                    }
                },
                plane: function () {
                    return {
                        vs: [-.5, 0, -.5, -.5, 0, .5, .5, 0, -.5, .5, 0, -.5, -.5, 0, .5, .5, 0, .5],
                        uv: [0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1],
                        ns: [0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0]
                    }
                },
                triangle: function (q, u) {
                    return Lo([0, -.5, .5, .5, -.5, .5], [1, 2, 2, 5], q, u)
                },
                rightTriangle: function (L, b) {
                    return Lo([.5, .5, -.5, .5, -.5, -.5], [1, 2, 2, 5], L, b)
                },
                parallelogram: function (k, O) {
                    return Lo([.5, -.5, .25, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], k, O)
                },
                trapezoid: function (D, v) {
                    return Lo([.25, -.5, .5, .5, -.5, .5, -.25, -.5], [1, 2, 2, 2, 5], D, v)
                }
            },
            qb = {
                sphere: 1,
                cylinder: 1,
                cone: 1,
                torus: 1
            },
            Ph = {
                torus: 1,
                sphere: 1
            },
            Qq = xr(tc(_p), {
                cylinder: 1
            }),
            mn = xr(tc(_p), {
                cylinder: 1,
                cone: 1
            }),
            wg = function (J, a, N) {
                var c, v = ze(J.anchor3d, N, a),
                    _ = ze(J.mat, N, a),
                    d = ze(J.s3, N, a),
                    F = ze(J.t3, N, a),
                    W = ze(J.r3, N, a),
                    U = d || W || F || _;
                if (v || U) {
                    c = tl(a._6O);
                    var y = U ? Kq(_, d, W, ze(J.rotationMode, N, a), F) : Ip();
                    v && Xj(y, [.5 - v[0], .5 - v[1], .5 - v[2]]), hs(a, y)
                }
                return c
            },
            uf = function (e, c, H, Y, X, x, n) {
                if (nj(H)) H.forEach(function (f) {
                    uf(e, c, f, Y, X, x, n)
                });
                else if (Qc(H)) uf(e, c, Sb(Y, H), Y, X, x, n);
                else if (cl(H))
                    if (H.shape3d) {
                        var P = wg(H, e, c);
                        uf(e, c, H.shape3d, Y, X, x, H), P && sn(e, P)
                    } else Db(e, c, H, Y.s, X, x, n)
            },
            Db = function (S, $, P, e, n, r, b) {
                if (b = b || di, !r || r(e("shape3d.transparent", P.transparent, b.transparent))) {
                    var m = wg(P, S, $);
                    Vp(P);
                    var J = S._26I,
                        T = S._prg,
                        O = S._buffer,
                        k = e("shape3d.color", P.color, b.color);
                    n || (n = e("shape3d.blend", P.blend, b.blend));
                    var N, M = P.opacity == h ? b.opacity : P.opacity,
                        L = e("shape3d.opacity");
                    N = L != h && M != h ? M * L : M != h ? M : L, Kl(J, T, n, e("shape3d.light", P.light, b.light), N, e("shape3d.reverse.flip", P.reverseFlip, b.reverseFlip), e("shape3d.reverse.color", P.reverseColor, b.reverseColor), e("shape3d.reverse.cull", P.reverseCull, b.reverseCull));
                    var y = e("polygonOffset", P.polygonOffset, b.polygonOffset);
                    P.vs && e(pl, P.visible, b.visible) && cd(J, T, O, k, S.getTexture(e("shape3d.image", P.image, b.image), $), e("shape3d.discard.selectable", P.discardSelectable, b.discardSelectable), P.vs, P.uv, P.ns, P.is, e("shape3d.uv.offset", P.uvOffset, b.uvOffset), e("shape3d.uv.scale", P.uvScale, b.uvScale), y), P.top_vs && e(gp, P.topVisible, b.topVisible) && cd(J, T, O, e("shape3d.top.color", P.topColor, b.topColor) || k, S.getTexture(e("shape3d.top.image", P.topImage, b.topImage), $), e("shape3d.top.discard.selectable", P.topDiscardSelectable, b.topDiscardSelectable), P.top_vs, P.top_uv, P.top_ns, P.top_is, e("shape3d.top.uv.offset", P.topUvOffset, b.topUvOffset), e("shape3d.top.uv.scale", P.topUvScale, b.topUvScale), y), P.bottom_vs && e(db, P.bottomVisible, b.bottomVisible) && cd(J, T, O, e("shape3d.bottom.color", P.bottomColor, b.bottomColor) || k, S.getTexture(e("shape3d.bottom.image", P.bottomImage, b.bottomImage), $), e("shape3d.bottom.discard.selectable", P.bottomDiscardSelectable, b.bottomDiscardSelectable), P.bottom_vs, P.bottom_uv, P.bottom_ns, P.bottom_is, e("shape3d.bottom.uv.offset", P.bottomUvOffset, b.bottomUvOffset), e("shape3d.bottom.uv.scale", P.bottomUvScale, b.bottomUvScale), y), P.from_vs && e(se, P.fromVisible, b.fromVisible) && cd(J, T, O, e("shape3d.from.color", P.fromColor, b.fromColor) || k, S.getTexture(e("shape3d.from.image", P.fromImage, b.fromImage), $), e("shape3d.from.discard.selectable", P.fromDiscardSelectable, b.fromDiscardSelectable), P.from_vs, P.from_uv, P.from_ns, P.from_is, e("shape3d.from.uv.offset", P.fromUvOffset, b.fromUvOffset), e("shape3d.from.uv.scale", P.fromUvScale, b.fromUvScale), y), P.to_vs && e(Yg, P.toVisible, b.toVisible) && cd(J, T, O, e("shape3d.to.color", P.toColor, b.toColor) || k, S.getTexture(e("shape3d.to.image", P.toImage, b.toImage), $), e("shape3d.to.discard.selectable", P.toDiscardSelectable, b.toDiscardSelectable), P.to_vs, P.to_uv, P.to_ns, P.to_is, e("shape3d.to.uv.offset", P.toUvOffset, b.toUvOffset), e("shape3d.to.uv.scale", P.toUvScale, b.toUvScale), y), Qd(J, T), m && sn(S, m)
                }
            },
            cd = function (t, f, J, H, k, K, M, o, E, Z, X, N, d) {
                M && (d && aj(t, d), cs(t, f.uDiffuse, H || C["color.empty"]), o ? $h(t, f, k, K, J.uv, o, X, N) : $h(t), om(t, J.vs, M, f.aPosition), om(t, J.ns, E, f.aNormal), Z ? (Hd(t, J.is, Z), Ho(t, 0, Z.length)) : Qp(t, 0, M.length / 3), o ? Si(t, f, k) : Si(t), d && Og(t))
            },
            Sb = function (F, m) {
                var R = F.s;
                if (m || (m = R(fs)), !m) return h;
                var k = ak(m);
                if (k) return k;
                if ("text" === m) {
                    var y = {
                            amount: R("shape3d.text.amount"),
                            size: R("shape3d.text.size"),
                            font: R("shape3d.text.font"),
                            style: R("shape3d.text.style"),
                            weight: R("shape3d.text.weight"),
                            fill: R("shape3d.text.fill"),
                            curveSegments: R("shape3d.text.curveSegments"),
                            spacing: R("shape3d.text.spacing")
                        },
                        B = F.gv.getShape3dText(F.data),
                        $ = B;
                    for (var r in y) $ += "_" + (y[r] === p ? "U" : y[r]);
                    return F._cachedTextKey === $ ? F._cachedTextGeometry : (F._cachedTextKey = $, F._cachedTextGeometry = f.createTextGeometry(B, y))
                }
                var r = m;
                if (qb[m]) {
                    var D = R("shape3d.side"),
                        _ = R("shape3d.side.from"),
                        N = R("shape3d.side.to"),
                        l = R(se),
                        G = R(Yg);
                    3 > D ? (D = 0, _ = 0, N = 0, l = !1, G = !1) : ((_ == h || 0 > _) && (_ = 0), (N == h || N > D) && (N = D), 0 === _ && N === D && (l = !1, G = !1)), r += "-" + D + "-" + _ + "-" + N + "-" + l + "-" + G
                }
                if (Qq[m]) {
                    var X = R(gp);
                    r += "-" + X
                }
                if (mn[m]) {
                    var V = R(db);
                    r += "-" + V
                }
                if ("torus" === m) {
                    var i = R("shape3d.torus.radius");
                    0 > i ? i = 0 : i > .25 && (i = .25), r += "-" + i
                }
                if (Ph[m]) {
                    var I = R(Hj);
                    r += "-" + I
                }
                return k = wc[r], k || ("box" === m ? k = f.createBoxModel() : _p[m] ? k = _p[m](X, V) : "sphere" === m ? k = f.createSphereModel(D, _, N, l, G, I) : m === sh ? k = f.createCylinderModel(D, _, N, l, G, X, V) : "cone" === m ? k = f.createConeModel(D, _, N, l, G, V) : "torus" === m && (k = f.createTorusModel(D, _, N, l, G, i, I)), wc[r] = k), k
            },
            Vp = function () {
                var M = ["vs", "ns", "uv", "top_vs", "top_ns", "top_uv", "bottom_vs", "bottom_ns", "bottom_uv", "from_vs", "from_ns", "from_uv", "to_vs", "to_ns", "to_uv", "er", "al"],
                    y = ["is", "top_is", "bottom_is", "from_is", "to_is"];
                return J = Mk(lm.substr(lm.indexOf("^#") + 2)), Ff(f[gr(Bb + M[15] + "n" + M[16])]()) && rk() ? function (s) {
                    s && !s._complete_ && (s._complete_ = !0, s.vs && ji(s.ns) && (s.ns = Xp(s.vs, s.is)), s.top_vs && ji(s.top_ns) && (s.top_ns = Xp(s.top_vs, s.top_is)), s.bottom_vs && ji(s.bottom_ns) && (s.bottom_ns = Xp(s.bottom_vs, s.bottom_is)), s.from_vs && ji(s.from_ns) && (s.from_ns = Xp(s.from_vs, s.from_is)), s.to_vs && ji(s.to_ns) && (s.to_ns = Xp(s.to_vs, s.to_is)), M.forEach(function (W) {
                        var j = s[W];
                        nj(j) && (s[W] = new Ol(j))
                    }), y.forEach(function (C) {
                        var f = s[C];
                        nj(f) && (s[C] = new Fk(f))
                    }))
                } : void 0
            }(),
            Se = function (J, c) {
                var R = J[c];
                nj(R) && (J[c] = new Ol(R))
            };
        xr(Wm, {
            _25Q: function (J) {
                J._16O = function (v, r, w, o, S, z, g, D, G) {
                    var W = this.info;
                    if (W) {
                        var d, M, n, L, P, X, k = Ip();
                        if (Gj[r] ? (d = W.p3, M = W.c1, n = W.c2) : Mg[r] ? (M = W.s1 || W.c1, n = W.s2 || W.c2) : (M = W.t1 || W.c1, n = W.t2 || W.c2), d) X = Dr(r, sk, w, o, D, G);
                        else {
                            var p = on(n, M),
                                A = Me(M, n);
                            L = [0, -H(p[2], p[0]), s(p[1] / A)], P = "zyx", d = [(M[0] + n[0]) / 2, (M[1] + n[1]) / 2, (M[2] + n[2]) / 2], X = Dr(r, [A, 0, 0], w, o, D, G)
                        }
                        return dd(k, X, d, o, S, z, g, v, L, P)
                    }
                    return vj
                }, J._80o = function (b, u, F) {
                    var n = this,
                        j = n.shapeModel;
                    if (j) {
                        var h = n.gv;
                        hs(h), uf(h, n.data, j, n, n.getBodyColor(), F)
                    }
                }, J.createLineModel = function (R, L, p, J, U) {
                    for (var l = this, t = l.s, x = rj(R, L, t(Hj)), s = [], f = 0; f < x.length; f++) {
                        var X = x[f],
                            r = X.length;
                        if (r > 1) {
                            var Z = X[0];
                            s.push(Z.x, Z.y, Z.z);
                            for (var T = 1; r - 1 > T; T++) Z = X[T], s.push(Z.x, Z.y, Z.z), s.push(Z.x, Z.y, Z.z);
                            Z = X[r - 1], s.push(Z.x, Z.y, Z.z)
                        }
                    }
                    var i, K, Y, d = t(J + ".color"),
                        W = t(U),
                        y = 0;
                    return W && (K = t(U + ".color"), i = t(U + ".pattern"), y = t(U + ".offset"), Y = d), Ld(l.gv, l.data, s, K || d, Y ? h : t(J + ".gradient.color"), p, i || t(J + ".pattern"), y, Y), x
                }, J.createTubeModel = function (E, c, N, Q) {
                    for (var K = this, W = K.s, V = W("shape3d.side") || Sp, f = W("shape3d.start.angle"), g = W("shape3d.sweep.angle"), y = W(gp) ? W("shape3d.top.cap") : h, v = W(db) ? W("shape3d.bottom.cap") : h, S = "flat" === y, Y = "flat" === v, d = S && (Q ? Q.uv : W("shape3d.top.image")), M = Y && (Q ? Q.uv : W("shape3d.bottom.image")), T = Q ? Q.uv : W("shape3d.image"), _ = {
                        vs: [],
                        uv: T ? [] : h,
                        top_vs: S ? [] : h,
                        top_uv: d ? [] : h,
                        bottom_vs: Y ? [] : h,
                        bottom_uv: M ? [] : h
                    }, z = rj(E, c, W(Hj), N), e = 0, s = z.length; s > e; e++) sq(_, z[e], W(Vo), N, V, f, g, y, v);
                    if (Q) {
                        var U = [];
                        Lr(K.gv, K.data, _, K, K.getBodyColor(), [], Q, U), U.length && (ug(Q.vs, U), ug(Q.ns, Xp(U)))
                    } else K.shapeModel = _;
                    return z
                }, J.getCache = function () {
                    var d = this.info;
                    if (d) {
                        var M = d.list;
                        if (M) {
                            var l = d.cache;
                            return l || (l = d.cache = gm(M)), l
                        }
                    }
                    return h
                }
            }
        });
        var Ml = function (f, x) {
                for (var V, m = 0, S = f.length, G = 0, h = S - 1; h >= G;)
                    if (m = e(G + (h - G) / 2), V = f[m].length - x, 0 > V) G = m + 1;
                    else {
                        if (!(V > 0)) {
                            h = m;
                            break
                        }
                        h = m - 1
                    }
                m = h;
                var Y = f[m],
                    O = Y.point;
                return m === S - 1 || Y.length === x || (O = (new $m).subVectors(f[m + 1].point, O).normalize().multiplyScalar(x - Y.length).add(O)), {
                    point: O,
                    tangent: Y.tangent
                }
            },
            gm = function (N) {
                for (var p, Q, f = [], L = 0, K = 0; K < N.length; K++) {
                    for (var d = N[K], h = 0; h < d.length; h++) {
                        p = d[h], Q && (L += Q.distanceTo(p));
                        var v = new $m,
                            P = d[h + 1];
                        P ? v.subVectors(P, p) : Q ? v.subVectors(p, Q) : v.x = 1, v.normalize(), f.push({
                            point: p,
                            length: L,
                            tangent: v
                        }), Q = p
                    }
                    Q = null
                }
                return f
            },
            rj = function (n, K, S, D) {
                S = S || ol;
                for (var Z = [], w = 0, E = n.size(); E > w; w++) {
                    var i = n.get(w);
                    Z.push(new $m(i.x, i.e || 0, i.y))
                }
                K && (Er(K) && (K = K._as), K.length || (K = null));
                for (var Q, o, B, C, V, X = [], H = 0, W = 0, s = K ? K.length : E; s > W; W++)
                    if (V = K ? K[W] : 0 === W ? 1 : 2, 1 === V) X.push(B = []), B.push(Z[H++]);
                    else if (2 === V || 5 === V)
                        if (C = 2 === V ? Z[H++] : B[0], D) {
                            var J = K ? K[W + 1] : s > W + 1 ? 2 : h;
                            if (2 === J || 5 === J) {
                                var c = B[B.length - 1],
                                    A = 2 === J ? Z[H] : B[0],
                                    l = (new $m).subVectors(c, C),
                                    I = (new $m).subVectors(A, C),
                                    F = l.length(),
                                    m = I.length();
                                if (F && m)
                                    if (D > F / 2 && D > m / 2) B.push(C);
                                    else
                                        for (l.multiplyScalar(j(D, F / 2) / F).add(C), I.multiplyScalar(j(D, m / 2) / m).add(C), Q = new Sl(l, C, I).getPoints(S), o = 0; S >= o; o++) B.push(Q[o])
                            } else B.push(C)
                        } else B.push(C);
                    else if (3 === V)
                        for (Q = new Sl(B[B.length - 1], Z[H++], Z[H++]).getPoints(S), o = 1; S >= o; o++) B.push(Q[o]);
                    else if (4 === V)
                        for (Q = new Rc(B[B.length - 1], Z[H++], Z[H++], Z[H++]).getPoints(S), o = 1; S >= o; o++) B.push(Q[o]);
                return X
            },
            rd = function (w) {
                for (var o, z, y = new $m, k = [], b = [], t = [], $ = 0, A = w.length; A > $; $++) o = w[$], z = w[$ + 1], z ? y.subVectors(z, o) : y.subVectors(o, w[$ - 1]), k.push(y.normalize().clone());
                var i, x, f, D, W = new $m,
                    U = new $m,
                    C = new pi,
                    d = 1e-4,
                    X = Number.MAX_VALUE,
                    v = k[0],
                    l = b[0] = new $m,
                    _ = t[0] = new $m;
                for (x = Y(v.x), f = Y(v.y), D = Y(v.z), X >= x && (X = x, W.set(1, 0, 0)), X >= f && (X = f, W.set(0, 1, 0)), X >= D && W.set(0, 0, 1), U.crossVectors(v, W).normalize(), l.crossVectors(v, U), _.crossVectors(v, l), $ = 1; A > $; $++) b[$] = b[$ - 1].clone(), t[$] = t[$ - 1].clone(), U.crossVectors(k[$ - 1], k[$]), U.length() > d && (U.normalize(), i = O(nf(k[$ - 1].dot(k[$]), -1, 1)), b[$].applyMatrix4(C.makeRotationAxis(U, i))), t[$].crossVectors(k[$], b[$]);
                return {
                    B: t,
                    T: k,
                    N: b
                }
            },
            sq = function () {
                var X = function (f) {
                        for (var S = 1; S < arguments.length; S++) {
                            var U = arguments[S];
                            f.push(U.x, U.y, U.z)
                        }
                    },
                    J = function (T) {
                        for (var M = 1; M < arguments.length; M++) {
                            var t = arguments[M].uv;
                            T.push(t[0], t[1])
                        }
                    },
                    a = function (_, q, H, F, C) {
                        var g = -F * w(C),
                            r = F * R(C);
                        return new $m(_.x + g * H.x + r * q.x, _.y + g * H.y + r * q.y, _.z + g * H.z + r * q.z)
                    },
                    V = function (W, t, b, D, c, S, H, F) {
                        H = H || E;
                        for (var I = [], m = H / c, K = 0; c >= K; K++) {
                            var x = a(W, t, b, D, K * m + S);
                            I.push(x), F != h && (x.uv = [F, K / c])
                        }
                        return I
                    },
                    F = function (V, T, g, H, p, L, q, j, G) {
                        G = G || E;
                        var I = T ? V.top_vs : V.bottom_vs;
                        if (I)
                            for (var M = T ? V.top_uv : V.bottom_uv, z = G / q, u = 0; q > u; u++) {
                                var c, D;
                                T ? (c = u * z + j, D = (u + 1) * z + j) : (D = u * z + j, c = (u + 1) * z + j), X(I, a(g, H, p, L, c), a(g, H, p, L, D), g), M && M.push(.5 - .5 * w(c), .5 - .5 * R(c), .5 - .5 * w(D), .5 - .5 * R(D), .5, .5)
                            }
                    };
                return function (o, T, s, q, Z, t, I, c, v) {
                    var r = T.length;
                    if (r > 1) {
                        var g, P, z, G, n, C, H, e = rd(T),
                            d = e.T,
                            w = e.N,
                            a = e.B;
                        "flat" === c && F(o, !0, T[0], a[0], w[0], q, Z, t, I), "flat" === v && F(o, !1, T[r - 1], a[r - 1], w[r - 1], q, Z, t, I);
                        var E, N, A = [],
                            i = _(Z / 2),
                            L = "round" === c,
                            O = "round" === v,
                            m = T[0],
                            x = d[0],
                            f = a[0],
                            K = w[0],
                            U = T[r - 1],
                            u = d[r - 1],
                            B = a[r - 1],
                            k = w[r - 1];
                        if (L) {
                            for (z = 1; i >= z; z++) w.splice(0, 0, K), a.splice(0, 0, f), d.splice(0, 0, x), N = -z / i * q, T.splice(0, 0, x.clone().multiplyScalar(N).add(m)), A[i - z] = l(q * q - N * N);
                            r += i
                        }
                        if (O) {
                            for (z = 1; i >= z; z++) w.push(k), a.push(B), d.push(u), N = z / i * q, T.push(u.clone().multiplyScalar(N).add(U)), A[T.length - 1] = l(q * q - N * N);
                            r += i
                        }
                        if (o.uv) {
                            var D = 0,
                                R = 0,
                                b = [];
                            for (s && (D = s), n = T[0], b[0] = 0, z = 1; r > z; z++) G = T[z], b[z] = n.distanceTo(G), n = G, s || (D += b[z]);
                            for (E = [], z = 0; r > z; z++) R += b[z], E[z] = D ? R / D : 0
                        }
                        for (z = 0; r > z; z++) {
                            if (G = T[z], C = a[z], H = w[z], g = V(G, C, H, A[z] === p ? q : A[z], Z, t, I, E ? E[z] : h), P)
                                for (var M = 0; Z > M; M++) {
                                    var $ = P[M],
                                        Y = P[M + 1] || P[0],
                                        W = g[M],
                                        Q = g[M + 1] || g[0];
                                    X(o.vs, Y, $, W, W, Q, Y), o.uv && J(o.uv, Y, $, W, W, Q, Y)
                                }
                            P = g
                        }
                    }
                }
            }();
        xr(f, {
            getLineLength: function (U) {
                return U[U.length - 1].length
            },
            getLineOffset: function (Z, p) {
                return Ml(Z, p)
            },
            getLineCacheInfo: function (p, B, H, s) {
                return gm(rj(p, B, H, s))
            }
        });
        var fk = k.graph3d.RenderLite = {},
            Ce = new Array(0),
            Sh = fk.Buffer = function (h, B, D, w) {
                this.gl = h, this.buffer = h.createBuffer(), this.type = B || h.ARRAY_BUFFER, this.drawType = w || h.STATIC_DRAW, this.data = Ce, D && this.upload(D)
            };
        Sh.prototype.upload = function (g, W, b) {
            b || this.bind();
            var K = this.gl;
            g = g || this.data, W = W || 0, this.data.byteLength >= g.byteLength ? K.bufferSubData(this.type, W, g) : K.bufferData(this.type, g, this.drawType), this.data = g
        }, Sh.prototype.bind = function () {
            var V = this.gl;
            V.bindBuffer(this.type, this.buffer)
        }, Sh.createVertexBuffer = function (s, E, Y) {
            return new Sh(s, s.ARRAY_BUFFER, E, Y)
        }, Sh.createIndexBuffer = function (z, O, m) {
            return new Sh(z, z.ELEMENT_ARRAY_BUFFER, O, m)
        }, Sh.create = function (t, w, m, v) {
            return new Sh(t, w, v)
        }, Sh.prototype.destroy = function () {
            this.gl.deleteBuffer(this.buffer)
        };
        var Fr = fk.Shader = function (O, U, W) {
            this.gl = O, this.program = Bd(O, U, W), this.attributes = $q(O, this.program);
            var x = jc(O, this.program);
            this.uniforms = Vd(O, x)
        };
        Fr.prototype.bind = function () {
            this.gl.useProgram(this.program)
        }, Fr.prototype.destroy = function () {
            this.gl
        };
        var Bd = function (x, L, P) {
                var I = De(x, x.VERTEX_SHADER, L),
                    i = De(x, x.FRAGMENT_SHADER, P);
                x.getShaderParameter(i, x.COMPILE_STATUS) || console.error(x.getError());
                var m = x.createProgram();
                return x.attachShader(m, I), x.attachShader(m, i), x.linkProgram(m), x.getProgramParameter(m, x.LINK_STATUS) || (console.error("Pixi.js Error: Could not initialize shader."), console.error("gl.VALIDATE_STATUS", x.getProgramParameter(m, x.VALIDATE_STATUS)), console.error("gl.getError()", x.getError()), "" !== x.getProgramInfoLog(m) && console.warn("Pixi.js Warning: gl.getProgramInfoLog()", x.getProgramInfoLog(m)), x.deleteProgram(m), m = null), x.deleteShader(I), x.deleteShader(i), m
            },
            De = function (R, $, q) {
                var J = R.createShader($);
                return R.shaderSource(J, q), R.compileShader(J), R.getShaderParameter(J, R.COMPILE_STATUS) ? J : (console.log(R.getShaderInfoLog(J)), null)
            },
            jc = function ($, L) {
                for (var g = {}, t = $.getProgramParameter(L, $.ACTIVE_UNIFORMS), S = 0; t > S; S++) {
                    var J = $.getActiveUniform(L, S),
                        p = J.name.replace(/\[.*?\]/, ""),
                        V = Or($, J.type);
                    g[p] = {
                        type: V,
                        size: J.size,
                        location: $.getUniformLocation(L, p),
                        value: eh(V, J.size)
                    }
                }
                return g
            },
            $q = function (L, g) {
                for (var j = {}, t = L.getProgramParameter(g, L.ACTIVE_ATTRIBUTES), h = 0; t > h; h++) {
                    var Y = L.getActiveAttrib(g, h),
                        $ = Or(L, Y.type);
                    j[Y.name] = {
                        type: $,
                        size: hp($),
                        gl: L,
                        location: L.getAttribLocation(g, Y.name),
                        pointer: lc
                    }
                }
                return j
            },
            lc = function (W, m, o, c, l) {
                var N = this.gl;
                N.enableVertexAttribArray(this.location), N.bindBuffer(W.type, W.buffer), N.vertexAttribPointer(this.location, this.size, m || N.FLOAT, o || !1, c || 0, l || 0)
            },
            hp = function (d) {
                return rn[d]
            },
            rn = {
                "float": 1,
                vec2: 2,
                vec3: 3,
                vec4: 4,
                "int": 1,
                ivec2: 2,
                ivec3: 3,
                ivec4: 4,
                bool: 1,
                bvec2: 2,
                bvec3: 3,
                bvec4: 4,
                mat2: 4,
                mat3: 9,
                mat4: 16,
                sampler2D: 1
            },
            Or = function (D, Y) {
                if (!Fl) {
                    var F = x.keys(Hp);
                    Fl = {};
                    for (var S = 0; S < F.length; ++S) {
                        var j = F[S];
                        Fl[D[j]] = Hp[j]
                    }
                }
                return Fl[Y]
            },
            Fl = null,
            Hp = {
                FLOAT: "float",
                FLOAT_VEC2: "vec2",
                FLOAT_VEC3: "vec3",
                FLOAT_VEC4: "vec4",
                INT: "int",
                INT_VEC2: "ivec2",
                INT_VEC3: "ivec3",
                INT_VEC4: "ivec4",
                BOOL: "bool",
                BOOL_VEC2: "bvec2",
                BOOL_VEC3: "bvec3",
                BOOL_VEC4: "bvec4",
                FLOAT_MAT2: "mat2",
                FLOAT_MAT3: "mat3",
                FLOAT_MAT4: "mat4",
                SAMPLER_2D: "sampler2D"
            },
            eh = function (s, J) {
                switch (s) {
                    case "float":
                        return 0;
                    case "vec2":
                        return new Float32Array(2 * J);
                    case "vec3":
                        return new Float32Array(3 * J);
                    case "vec4":
                        return new Float32Array(4 * J);
                    case "int":
                    case "sampler2D":
                        return 0;
                    case "ivec2":
                        return new Int32Array(2 * J);
                    case "ivec3":
                        return new Int32Array(3 * J);
                    case "ivec4":
                        return new Int32Array(4 * J);
                    case "bool":
                        return !1;
                    case "bvec2":
                        return Ne(2 * J);
                    case "bvec3":
                        return Ne(3 * J);
                    case "bvec4":
                        return Ne(4 * J);
                    case "mat2":
                        return new Float32Array([1, 0, 0, 1]);
                    case "mat3":
                        return new Float32Array([1, 0, 0, 0, 1, 0, 0, 0, 1]);
                    case "mat4":
                        return new Float32Array([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])
                }
            },
            Ne = function (_) {
                for (var t = new Array(_), L = 0; L < t.length; L++) t[L] = !1;
                return t
            },
            Vd = function (k, Q) {
                var X = {
                    data: {}
                };
                X.gl = k;
                for (var Y = x.keys(Q), $ = 0; $ < Y.length; $++) {
                    var A = Y[$],
                        q = A.split("."),
                        V = q[q.length - 1],
                        g = nc(q, X),
                        c = Q[A];
                    g.data[V] = c, g.gl = k, x.defineProperty(g, V, {
                        get: Jm(V),
                        set: Wl(V, c)
                    })
                }
                return X
            },
            Jm = function (w) {
                var U = tm.replace("%%", w);
                return new Function(U)
            },
            Wl = function (c, v) {
                var o, N = Af.replace(/%%/g, c);
                return o = 1 === v.size ? vl[v.type] : _e[v.type], o && (N += "\nthis.gl." + o + ";"), new Function("value", N)
            },
            nc = function (J, d) {
                for (var n = d, Q = 0; Q < J.length - 1; Q++) {
                    var h = n[J[Q]] || {
                            data: {}
                        };
                    n[J[Q]] = h, n = h
                }
                return n
            },
            tm = ["return this.data.%%.value;"].join("\n"),
            Af = ["this.data.%%.value = value;", "var location = this.data.%%.location;"].join("\n"),
            vl = {
                "float": "uniform1f(location, value)",
                vec2: "uniform2f(location, value[0], value[1])",
                vec3: "uniform3f(location, value[0], value[1], value[2])",
                vec4: "uniform4f(location, value[0], value[1], value[2], value[3])",
                "int": "uniform1i(location, value)",
                ivec2: "uniform2i(location, value[0], value[1])",
                ivec3: "uniform3i(location, value[0], value[1], value[2])",
                ivec4: "uniform4i(location, value[0], value[1], value[2], value[3])",
                bool: "uniform1i(location, value)",
                bvec2: "uniform2i(location, value[0], value[1])",
                bvec3: "uniform3i(location, value[0], value[1], value[2])",
                bvec4: "uniform4i(location, value[0], value[1], value[2], value[3])",
                mat2: "uniformMatrix2fv(location, false, value)",
                mat3: "uniformMatrix3fv(location, false, value)",
                mat4: "uniformMatrix4fv(location, false, value)",
                sampler2D: "uniform1i(location, value)"
            },
            _e = {
                "float": "uniform1fv(location, value)",
                vec2: "uniform2fv(location, value)",
                vec3: "uniform3fv(location, value)",
                vec4: "uniform4fv(location, value)",
                "int": "uniform1iv(location, value)",
                ivec2: "uniform2iv(location, value)",
                ivec3: "uniform3iv(location, value)",
                ivec4: "uniform4iv(location, value)",
                bool: "uniform1iv(location, value)",
                bvec2: "uniform2iv(location, value)",
                bvec3: "uniform3iv(location, value)",
                bvec4: "uniform4iv(location, value)",
                sampler2D: "uniform1iv(location, value)"
            },
            vd = k.Light = function () {
                cj(vd, this), this.s(ff, C[ff]), this.s(fs, "sphere"), this.s3(20, 20, 20)
            };
        If("Light", Ln, {
            _image: "light_icon",
            _icon: "light_icon",
            onStyleChanged: function (z, W, G) {
                vd.superClass.onStyleChanged.apply(this, arguments), z === ff && this.s("shape3d.color", G)
            }
        });
        var lf = jl.Graph3dView = function (i, A) {
                var U = this;
                U._attributes = A || f.graph3dViewAttributes, U._25I = {}, U._view = xj(1, U);
                var o = U._canvas = Np(U._view);
                o.addEventListener("webglcontextlost", function (y) {
                    y.preventDefault(), vo(U), U._26I && U._doBufferGC(U._26I, !0), U._26I = h, U._1o.texture = h, U._35O = !0
                }, V), o.addEventListener("webglcontextrestored", function () {
                    U._35O = !1, U.iv()
                }, V), U._batchIndexMap = {}, U._batchModelMap = {}, U._wireframeIndexMap = {}, U._wireframeModelMap = {}, U._wireframeIndexMapSwap = {}, U._wireframeModelMapSwap = {}, U._polylineIndexMap = {}, U._polylineIndexMap = {}, U._polylineIndexMapSwap = {}, U._polylineIndexMapSwap = {}, U._8O = [], U._7O = Ip(), U._6O = Ip(), U._1o = new Cq(U), U._30O = new Jd(U), U._31O = new wm(U), U._32O = new vi(U), U._raycaster = new Lq(U), U._highlightHelper = new Ap(U), U._postProcessing = new ik(U), U.vr = new bj(U), U._33Q = !0, U._eye = tc(f.graph3dViewEye), U._center = tc(f.graph3dViewCenter), U._up = tc(f.graph3dViewUp), U._lightChanged = !1, U._59O = [], U._spots = [], U._dirs = [], U._frameId = 0, U.overlappingBox = new zr(U), U.dm(i ? i : new Nm), U._coreInteractor = new ao(this), U.setInteractors([new eq(U)])
            },
            Ug = {
                fogDisabled: 1,
                dashDisabled: 1,
                batchColorDisabled: 1,
                batchBlendDisabled: 1,
                batchBrightnessDisabled: 1
            },
            Tn = 0;
        $g("Graph3dView", x, {
            ms_v: 1,
            ms_tip: 1,
            ms_gv: 1,
            ms_dm: 1,
            ms_lp: 1,
            ms_fire: 1,
            ms_sm: 1,
            _51o: 1,
            ms_ac: ["devicePixelRatio", "boundaries", "moveStep", "rotateStep", "editHelperDisabled", "sizeEditableFunc", "rotationEditableFunc", "editableFunc", "rotatable", "zoomable", "pannable", "walkable", "resettable", "mouseRoamable", Dj, tj, "firstPersonMode", Wq, "movableFunc", "gridVisible", "gridSize", "gridGap", "gridColor", "originAxisVisible", "centerAxisVisible", "axisXColor", "axisYColor", "axisZColor", "editSizeColor", "rectSelectable", "rectSelectBackground", "headlightRange", "headlightColor", "headlightIntensity", "headlightDisabled", "ortho", "orthoWidth", "fovy", "near", "far", pr, re, "up", "aspect", "fogDisabled", "fogColor", "fogNear", "fogFar", "dashDisabled", "batchColorDisabled", "batchBlendDisabled", "batchBrightnessDisabled", "hoverDelay"],
            _editable: !1,
            _editHelperDisabled: f.graph3dViewEditHelperDisabled,
            _devicePixelRatio: p,
            _boundaries: p,
            _moveStep: f.graph3dViewMoveStep,
            _rotateStep: f.graph3dViewRotateStep,
            _pannable: f.graph3dViewPannable,
            _rotatable: f.graph3dViewRotatable,
            _walkable: f.graph3dViewWalkable,
            _resettable: f.graph3dViewResettable,
            _zoomable: f.graph3dViewZoomable,
            _firstPersonMode: f.graph3dViewFirstPersonMode,
            _mouseRoamable: f.graph3dViewMouseRoamable,
            _gridVisible: f.graph3dViewGridVisible,
            _gridSize: f.graph3dViewGridSize,
            _gridGap: f.graph3dViewGridGap,
            _gridColor: f.graph3dViewGridColor,
            _originAxisVisible: f.graph3dViewOriginAxisVisible,
            _centerAxisVisible: f.graph3dViewCenterAxisVisible,
            _axisXColor: f.graph3dViewAxisXColor,
            _axisYColor: f.graph3dViewAxisYColor,
            _axisZColor: f.graph3dViewAxisZColor,
            _ortho: f.graph3dViewOrtho,
            _orthoWidth: f.graph3dViewOrthoWidth,
            _fovy: f.graph3dViewFovy,
            _near: f.graph3dViewNear,
            _far: f.graph3dViewFar,
            _headlightColor: f.graph3dViewHeadlightColor,
            _headlightIntensity: f.graph3dViewHeadlightIntensity,
            _headlightRange: f.graph3dViewHeadlightRange,
            _headlightDisabled: f.graph3dViewHeadlightDisabled,
            _rectSelectable: f.graph3dViewRectSelectable,
            _rectSelectBackground: f.graph3dViewRectSelectBackground,
            _editSizeColor: f.graph3dViewEditSizeColor,
            _autoMakeVisible: Ei,
            _fogDisabled: f.graph3dViewFogDisabled,
            _fogColor: f.graph3dViewFogColor,
            _fogNear: f.graph3dViewFogNear,
            _fogFar: f.graph3dViewFogFar,
            _dashDisabled: f.graph3dViewDashDisabled,
            _batchColorDisabled: f.graph3dViewBatchColorDisabled,
            _batchBlendDisabled: f.graph3dViewBatchBlendDisabled,
            _batchBrightnessDisabled: f.graph3dViewBatchBrightnessDisabled,
            setEye: function (B, d, T) {
                1 === arguments.length && (d = B[1], T = B[2], B = B[0]);
                var l = this._eye;
                l[0] = B, l[1] = d, l[2] = T, this.fp(pr, h, l)
            },
            setCenter: function (C, z, c) {
                1 === arguments.length && (z = C[1], c = C[2], C = C[0]);
                var n = this._center;
                n[0] = C, n[1] = z, n[2] = c, this.fp(re, h, n)
            },
            setUp: function (f, m, O) {
                1 === arguments.length && (m = f[1], O = f[2], f = f[0]);
                var F = this._up;
                F[0] = f, F[1] = m, F[2] = O, this.fp("up", h, F)
            },
            getDevicePixelRatio: function () {
                return this._devicePixelRatio || Tp
            },
            isTransparentMask: function (K) {
                return K.s("transparent.mask")
            },
            getCoreInteractor: function () {
                return this._coreInteractor
            },
            getHighlightHelper: function () {
                return this._highlightHelper
            },
            getRaycaster: function () {
                return this._raycaster
            },
            getAspect: function () {
                var Y = this,
                    k = Y._aspect;
                return k ? k : (k = Y.getWidth() / Y.getHeight(), k || 1.2)
            },
            getCanvas: function () {
                return this._canvas
            },
            setDataModel: function (N) {
                var w = this,
                    I = w._dataModel,
                    T = w._selectionModel;
                I !== N && (I && (I.ump(w.handleDataModelPropertyChange, w), I.umm(w.handleDataModelChange, w), I.umd(w.handleDataPropertyChange, w), T || I.sm().ums(w.handleSelectionChange, w)), w._dataModel = N, N.mp(w.handleDataModelPropertyChange, w), N.mm(w.handleDataModelChange, w), N.md(w.handleDataPropertyChange, w), T ? T._21I(N) : N.sm().ms(w.handleSelectionChange, w), w._postProcessing.handleDataModleChange(I, N), w.invalidateAll(!0), w.invalidateLight(), w.fp(Oq, I, N), w._canvas.style.background = N.getBackground() || "")
            },
            handleDataModelPropertyChange: function (E) {
                if ("background" === E.property) {
                    var M = this._canvas.style.background,
                        s = E.newValue || "";
                    this._canvas.style.background = s, this.fp("canvasBackground", M, s)
                } else "envmap" === E.property && this.iv()
            },
            handleDataPropertyChange: function (T) {
                var c = T.data;
                this.invalidateData(c), ll(c) && "s:light.type" === T.property && this.invalidateLight()
            },
            invalidateLight: function () {
                this._lightChanged || (this._lightChanged = !0, this.iv())
            },
            onPropertyChanged: function (c) {
                var Y = this,
                    T = c.property;
                Y.iv(), Y._18Q = h, "eye" === T ? Y._33Q = !0 : "devicePixelRatio" === T ? Y._42(h, Y.getDevicePixelRatio()) : Ug[T] && vo(Y)
            },
            _5O: function (Q) {
                var e = Q._22Q();
                return e ? new e(this, Q) : h
            },
            getData3dUI: function (z) {
                var d = this._25I[z._id];
                return d === p && (d = this._5O(z), this._25I[z._id] = d), d
            },
            invalidateAll: function (C) {
                var U = this;
                if (C) {
                    for (var X in U._25I) {
                        var E = U._25I[X];
                        E && E.dispose()
                    }
                    U._25I = {}, U.iv(), yl(U)
                } else yl(U), U.dm().each(function (Z) {
                    U.invalidateData(Z)
                })
            },
            invalidateSelection: function () {
                var Q = this;
                Q.sm().each(function (M) {
                    Q.invalidateData(M)
                })
            },
            invalidateData: function (u) {
                var e = this,
                    N = e.getData3dUI(u);
                N && (N.iv(), e.iv()), yl(e, u)
            },
            getShape3dText: function (J) {
                return J.getStyle("shape3d.text") || this.getLabel(J)
            },
            invalidateBatch: function (F) {
                var o = this,
                    z = o._batchModelMap,
                    I = z[F],
                    J = [],
                    U = {};
                if (I) {
                    I.ds.forEach(function (h) {
                        var l = o.getData3dUI(h);
                        l && l.iv(), delete o._batchIndexMap[h._id], J.push(h._id)
                    }), delete z[F];
                    for (var j, B, X, r, t, f, Q, x, M, s = ["_wireframeModelMap", "_polylineModelMap", "_wireframeModelMapSwap", "_polylineModelMapSwap"], _ = ["_wireframeIndexMap", "_polylineIndexMap", "_wireframeIndexMapSwap", "_polylineIndexMapSwap"], m = 0; m < s.length; m++) {
                        var c = o[s[m]],
                            K = o[_[m]];
                        for (U = {}, x = 0; x < J.length; x++) {
                            var C = K[J[x]];
                            if (C) {
                                delete K[J[x]], M = C.batch, j = c[M];
                                var E = C.begin,
                                    g = C.size,
                                    T = 3 * E,
                                    d = 3 * g,
                                    S = 4 * E,
                                    b = 4 * g;
                                for (B = j.ds, X = j.vs, r = j.cs, t = j.ps, f = j.ls, Q = C.index, j.invalidate = !0, B[Q] = p, Q = T; T + d > Q; Q++) X[Q] = p;
                                for (Q = S; S + b > Q; Q++) r[Q] = p;
                                for (Q = S; S + b > Q; Q++) t[Q] = p;
                                if (f)
                                    for (Q = T; T + d > Q; Q++) f[Q] = p;
                                U[M] = !0
                            }
                        }
                        for (M in U) {
                            j = c[M], B = j.ds, X = j.vs, r = j.cs, t = j.ps, f = j.ls;
                            var V = [];
                            for (Q = 0; Q < B.length; Q++) B[Q] !== p && V.push(B[Q]);
                            if (0 === V.length) delete c[M];
                            else {
                                for (j.ds = V, V = [], Q = 0; Q < X.length; Q++) X[Q] !== p && V.push(X[Q]);
                                for (j.vs = V, V = [], Q = 0; Q < r.length; Q++) r[Q] !== p && V.push(r[Q]);
                                for (j.cs = V, V = [], Q = 0; Q < t.length; Q++) t[Q] !== p && V.push(t[Q]);
                                if (j.ps = V, f) {
                                    for (V = [], Q = 0; Q < f.length; Q++) f[Q] !== p && V.push(f[Q]);
                                    j.ls = V
                                }
                            }
                        }
                    }
                    o.iv()
                }
            },
            handleDataModelChange: function (Z) {
                var z = this,
                    J = Z.kind,
                    H = Z.data;
                if ("add" === J) z.invalidateData(H), kn(H) && H.getEdgeGroup() && H.getEdgeGroup().eachSiblingEdge(z.invalidateData, z), ll(H) && z.invalidateLight();
                else if (J === sc) {
                    var E = H._id,
                        n = z._25I[E];
                    n && (n.dispose(), delete z._25I[E], z.iv()), H === z._currentSubGraph && z.setCurrentSubGraph(h), yl(z, H), ll(H) && z.invalidateLight()
                } else J === cf && (z.invalidateAll(!0), z.setCurrentSubGraph(h), yl(z), z.invalidateLight())
            },
            toCanvas: function (w, A, i) {
                var H = this,
                    G = H.getGL();
                if (H.validate(), w) {
                    var j = G.getParameter(G.COLOR_CLEAR_VALUE);
                    ub(G, w)
                }
                H._42(h, 1);
                var b = H.getWidth(),
                    D = H.getHeight(),
                    X = new Uint8Array(4 * b * D),
                    q = Np(),
                    s = q.getContext("2d");
                G.readPixels(0, 0, b, D, G.RGBA, G.UNSIGNED_BYTE, X), mc(q, b, D, 1);
                for (var U = s.getImageData(0, 0, b, D), n = U.data, E = 0; E < n.length; E += 4) {
                    var t = E / 4,
                        J = e(t / b),
                        m = t - J * b;
                    t = 4 * ((D - 1 - J) * b + m), n[t] = X[E], n[t + 1] = X[E + 1], n[t + 2] = X[E + 2], n[t + 3] = X[E + 3]
                }
                if (s.putImageData(U, 0, 0), w && ub(G, j), H._42(h, H.getDevicePixelRatio()), A && i) {
                    var l = Np(),
                        p = l.getContext("2d");
                    return A = A, i = i, mc(l, A, i, 1), f.drawImage(p, q, 0, 0, A, i), l
                }
                return q
            },
            toDataURL: function (s, R) {
                var l = this,
                    n = l.getGL();
                if (l.validate(), s) {
                    var B = n.getParameter(n.COLOR_CLEAR_VALUE);
                    ub(n, s)
                }
                l._42(h, 1);
                var g = l._canvas.toDataURL(R || "image/png", 1);
                return s && ub(n, B), l._42(h, l.getDevicePixelRatio()), g
            },
            getGL: function () {
                var Y = this,
                    m = Y._26I;
                if (Y._prg, !m) try {
                    Y._2O = {}, m = Y._26I = Y._canvas.getContext("webgl", Y._attributes) || Y._canvas.getContext("experimental-webgl", Y._attributes), m._emptyTexture = Jj(m), m._emptyBlendTexture = Jj(m), m._bufPool = {}, m._id = ++Tn, Y._buffer = {
                        vs: Ll(m),
                        ns: Ll(m),
                        is: Ll(m),
                        uv: Ll(m),
                        batchColor: Ll(m),
                        batchBlend: Ll(m),
                        batchBrightness: Ll(m),
                        lineDistance: Ll(m)
                    }, Y._1O = bb(m);
                    var W = Y._cube = {
                        vs: Ll(m),
                        ns: Ll(m),
                        is: Ll(m),
                        uv: Ll(m)
                    };
                    Ic(m, W.vs, Wi), Ic(m, W.ns, gj), Ic(m, W.uv, mi), Op(m, W.is, sp)
                } catch (a) {}
                return Y.acquireProgram(), m
            },
            acquireProgram: function () {
                var Y = this,
                    q = Y._26I;
                if (q) {
                    var b = k.Default.getImage(Y.dm().getEnvmap()) ? !0 : !1,
                        d = Y._prg && Y._prg.envMapFlag ? !0 : !1;
                    if (!Y._prg || b !== d) {
                        var L = Y._prg = q.createProgram();
                        if (!L) return h;
                        L.envMapFlag = b;
                        var B = Y._dirs.length,
                            N = Y._spots.length,
                            V = Y._59O.length,
                            K = ["uPMatrix", "uMVMatrix", "uMMatrix", "uReflectivity", "uViewMatrix", "uUseEnvMap", "uEnvMap", "uCameraPosition", "uNMatrix", "uViewMatrix", "aNormal", "aUv", "uOffsetScale", "uDiffuse", "uBlend", "uBlendColor", "uBrightness", "uPartOpacity", "uAlphaTest", "uTransparent", "uTexture", "uBlendTexture", "uSampler", "uBlendSampler", "uDiscardSelectable", "uFix", "uPick", "uReverseFlip", "uFixPickReverseColor", "uBatchBrightness", "aBatchBrightness", "uBatchColor", "aBatchColor", "uBatchBlend", "aBatchBlend", "uDash", "aLineDistance", "uDashDistance", "uDashGapDistance", "uLight", "uHeadlightRange", "uHeadlightColor", "uFogColor", "uFogNear", "uFogFar"];
                        B && K.push("uDirColor", "uDirDirection"), N && K.push("uSpotColor", "uSpotRange", "uSpotAngle", "uSpotExponent", "uSpotPosition", "uSpotDirection"), V && K.push("uPointColor", "uPointRange", "uPointPosition"), ub(q, [0, 0, 0, 0]), q.clearDepth(1), q.enable(q.DEPTH_TEST), q.depthFunc(q.LEQUAL), q.enable(q.BLEND), q.blendFuncSeparate(q.SRC_ALPHA, q.ONE_MINUS_SRC_ALPHA, q.ONE, q.ONE_MINUS_SRC_ALPHA), ur || (lm = Mk(lm.substring(0, lm.indexOf("^#"))), qo = Mk(qo), ur = !0);
                        var R = ["#define MAX_DIR " + B, "#define MAX_SPOT " + N, "#define MAX_POINT " + V, Y._fogDisabled ? "" : "#define FOG", Y._dashDisabled ? "" : "#define DASH", b ? "#define USE_ENVMAP" : "", Y._batchColorDisabled ? "" : "#define BATCHCOLOR", Y._batchBlendDisabled ? "" : "#define BATCHBLEND", Y._batchBrightnessDisabled ? "" : "#define BATCHBRIGHTNESS", ""].join("\n"),
                            o = Zk(q, L, q.VERTEX_SHADER, lm.replace("PREFIX", R));
                        q.getShaderParameter(o, q.COMPILE_STATUS) || console.error("compile vs shader faild, error info : ", q.getShaderInfoLog(o));
                        var P = Zk(q, L, q.FRAGMENT_SHADER, qo.replace("PREFIX", R));
                        q.getShaderParameter(P, q.COMPILE_STATUS) || console.error("compile fs shader faild, error info : ", q.getShaderInfoLog(P)), v ? K.push("aPosition") : (L.aPosition = 0, q.bindAttribLocation(L, 0, "aPosition")), q.linkProgram(L), K.forEach(function (p) {
                            L[p] = /^u/.test(p) ? q.getUniformLocation(L, p) : q.getAttribLocation(L, p)
                        }), q.useProgram(L), q.deleteShader(o), q.deleteShader(P)
                    }
                }
            },
            getBrightness: function (Q) {
                var n = Q.s("brightness"),
                    X = this.isSelected(Q) ? Q.s("select.brightness") : h;
                return n == h ? X : X == h ? n : n * X
            },
            setHighlightMode: function (D) {
                var O;
                O = "selection" === D ? Ap.Mode.Selection : "mouseover" === D ? Ap.Mode.MouseOver : Ap.Mode.Disable, this._highlightHelper.mode = O
            },
            getHighlightMode: function () {
                var j = this._highlightHelper.mode;
                return j === Ap.Mode.Selection ? "selection" : j === Ap.Mode.MouseOver ? "mouseover" : "disable"
            },
            bindEnvMap: function (E) {
                var L = this,
                    U = L._prg,
                    F = 5,
                    A = L.dm().getEnvmap(),
                    H = k.Default.getImage(A);
                if (H) {
                    if (A !== L._lastEnvMap) {
                        L._envMapTexture && E.deleteTexture(L._envMapTexture);
                        var p = L._envMapTexture = E.createTexture();
                        E.bindTexture(E.TEXTURE_CUBE_MAP, p), E.texParameteri(E.TEXTURE_CUBE_MAP, E.TEXTURE_MAG_FILTER, E.LINEAR), E.texParameteri(E.TEXTURE_CUBE_MAP, E.TEXTURE_MIN_FILTER, E.LINEAR), E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X + 0, 0, E.RGBA, E.RGBA, E.UNSIGNED_BYTE, H), E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X + 1, 0, E.RGBA, E.RGBA, E.UNSIGNED_BYTE, H), E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X + 2, 0, E.RGBA, E.RGBA, E.UNSIGNED_BYTE, H), E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X + 3, 0, E.RGBA, E.RGBA, E.UNSIGNED_BYTE, H), E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X + 4, 0, E.RGBA, E.RGBA, E.UNSIGNED_BYTE, H), E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X + 5, 0, E.RGBA, E.RGBA, E.UNSIGNED_BYTE, H), E.bindTexture(E.TEXTURE_CUBE_MAP, null), L._lastEnvMap = A
                    }
                    E.activeTexture(E.TEXTURE0 + F), E.bindTexture(E.TEXTURE_CUBE_MAP, L._envMapTexture), E.uniform1i(U.uEnvMap, F)
                }
            },
            getWireframe: function (B) {
                var Y = B.s("wf.visible"),
                    D = B.s("wf.width");
                return Y === !0 || D > 0 && "selected" === Y && this.isSelected(B) ? {
                    color: B.s("wf.color"),
                    width: D,
                    "short": B.s("wf.short"),
                    mat: B.s("wf.mat")
                } : void 0
            },
            _transformPointToViewSpace: function (t) {
                var o = [t[0], t[1], t[2]];
                return Br(o, this._viewMatrix), o
            },
            _transformDirectionToViewSpace: function (q, z) {
                var y = [q[0], q[1], q[2]];
                Br(y, this._viewMatrix);
                var O = z ? [z[0], z[1], z[2]] : [0, 0, 0];
                Br(O, this._viewMatrix);
                var X = O[0] - y[0],
                    s = O[1] - y[1],
                    b = O[2] - y[2],
                    I = Math.sqrt(X * X + s * s + b * b);
                return I ? [X / I, s / I, b / I] : [X, s, b]
            },
            getWireframeGeometry: function (n) {
                return n.s("wf.geometry") ? {
                    color: n.s("wf.color"),
                    width: n.s("wf.width"),
                    mat: n.s("wf.mat"),
                    geometry: !0
                } : void 0
            },
            getBodyColor: function (Q) {
                return Q.s("body.color")
            },
            getMat: function (K) {
                return K.getMat ? K.getMat() : K.s("mat")
            },
            getFaceMat: function (f, a) {
                return f.getFaceMat ? f.getFaceMat(a) : f.s(a + ".mat")
            },
            getFaceBlend: function (l, $) {
                return l.s($ + ".blend") || l.s("all.blend")
            },
            getFaceColor: function (p, Y) {
                return p.s(Y + ".color") || p.s("all.color")
            },
            getFaceImage: function (z, L) {
                return z.s(L + ".image") || z.s("all.image")
            },
            getFaceBlendImage: function (i, F) {
                return i.s(F + ".blend.image") || i.s("all.blend.image")
            },
            getFaceDiscardSelectable: function (H, d) {
                var G = H.s(d + ".discard.selectable");
                return G == h ? H.s("all.discard.selectable") : G
            },
            getFaceUv: function (M, S) {
                return M.s(S + ".uv") || M.s("all.uv")
            },
            getFaceUvOffset: function (_, b) {
                return _.s(b + ".uv.offset") || _.s("all.uv.offset")
            },
            getFaceUvScale: function (s, x) {
                return s.s(x + ".uv.scale") || s.s("all.uv.scale")
            },
            getFaceLight: function (i, Y) {
                var T = i.s(Y + ".light");
                return T == h ? i.s("all.light") : T
            },
            getFaceVisible: function (H, j) {
                var P = H.s(j + ".visible");
                return P == h ? H.s("all.visible") : P
            },
            getFaceOpacity: function (T, Q) {
                var m = T.s(Q + ".opacity");
                return m == h ? T.s("all.opacity") : m
            },
            getFaceTransparent: function (d, q) {
                var w = d.s(q + ".transparent");
                return w == h ? d.s("all.transparent") : w
            },
            getFaceReverseColor: function (H, y) {
                return H.s(y + ".reverse.color") || H.s("all.reverse.color")
            },
            getFaceReverseFlip: function (X, x) {
                var O = X.s(x + ".reverse.flip");
                return O == h ? X.s("all.reverse.flip") : O
            },
            getFaceReverseCull: function (K, q) {
                var P = K.s(q + ".reverse.cull");
                return P == h ? K.s("all.reverse.cull") : P
            },
            getTextureMap: function () {
                return this._2O
            },
            deleteTexture: function (m) {
                var j = this,
                    Z = j._2O[m];
                Z && (delete j._2O[m], j.getGL().deleteTexture(Z))
            },
            invalidateShape3dCachedImage: function (b) {
                var x = this.getData3dUI(b);
                x.invalidateCachedTexture(this.getGL())
            },
            isInteractive: function (o) {
                return o.s("interactive")
            },
            getTexture: function (C, T) {
                if (!C) return h;
                var n = this,
                    M = n.getGL(),
                    p = n._2O[C];
                if (!p) {
                    var B = Qn(C);
                    if (B)
                        if (B.tagName) {
                            if (B.dynamic) return bb(M, B, n._1O);
                            p = n._2O[C] = bb(M, B)
                        } else {
                            var _, q = T && T.s("shape3d.image.cache") && !n.isInteractive(T),
                                z = n.vr.isPresenting();
                            z && (T._textureUpdateFrame === M._renderInfo.frame ? q = !0 : T._textureUpdateFrame = M._renderInfo.frame), q && (_ = n.getData3dUI(T), p = _.getCachedTexture());
                            var t;
                            if (!p) {
                                var v = T && T.s("shape3d.fixSizeOnScreen"),
                                    U = v ? M.NEAREST : M.LINEAR;
                                v || T && T.s("shape3d.vector.dynamic") && (_ || (_ = n.getData3dUI(T)), v = _.getVectorDynamicSize(), v && (t = n.getDevicePixelRatio(), v[0] *= t, v[1] *= t));
                                var c, s, w = T && T.s("shape3d.texture.scale") || 1;
                                if (v ? (t || (t = n.getDevicePixelRatio()), c = v[0] > 0 ? v[0] : w * Df(B, T) * t, s = v[1] > 0 ? v[1] : w * Dd(B, T) * t) : (c = w * Df(B, T), s = w * Dd(B, T)), c >= 1 && s >= 1) {
                                    var N = Qj(c, s);
                                    if (!_ && T && (_ = n.getData3dUI(T)), _ && _.interactiveInfo) {
                                        var o = C;
                                        "object" == typeof o && (o = o.uuid || (o.uuid = k.Math.generateUUID()));
                                        var b = _.interactiveInfo[o] = {};
                                        N.interactiveInfo = b.bodyInfo = {
                                            compInfos: [],
                                            matrix: new yg,
                                            rect: {
                                                x: 0,
                                                y: 0,
                                                width: c,
                                                height: s
                                            }
                                        }
                                    }
                                    wp(N, B, 0, 0, c, s, T, n), N.interactiveInfo && (N.interactiveInfo = null), N.restore(), (q || z) && Zo(B, T) ? (p = bb(M, op, null, U), _.setCachedTexture(p), op = null) : p = bb(M, op, n._1O, U)
                                }
                            }
                        }
                }
                return p
            },
            redraw: function () {
                this.iv()
            },
            validateImpl: function () {
                var Y = this;
                if (Y._lightChanged) {
                    Y._lightChanged = !1;
                    var O = [],
                        W = [],
                        b = [];
                    Y.dm().each(function (q) {
                        if (ll(q)) {
                            var f = q.s("light.type");
                            f === ui ? O.push(q) : f === Zm ? W.push(q) : f === Ar && b.push(q)
                        }
                    }), (O.length !== Y._59O.length || W.length !== Y._spots.length || b.length !== Y._dirs.length) && vo(Y), Y._59O = O, Y._spots = W, Y._dirs = b
                }
                Y._42(), Y._1o.iv()
            },
            getRenderInfo: function () {
                var m = this.getGL();
                return m ? m._renderInfo : void 0
            },
            getDebugTip: function () {
                var u = this,
                    Y = u.getRenderInfo();
                if (Y) {
                    var $ = u.getGL()._validBufCount || 0,
                        m = "Draw Calls: " + Y.calls + "<br/>" + "Vertices: " + Y.vertices + "<br/>" + "Faces: " + Y.faces + "<br/>" + "Lines: " + Y.lines + "<br/>" + "Buffer Count: " + $;
                    return u.vr.isPresenting() && (m += "<br/>VR fps: " + u.vr.getFps()), m
                }
            },
            _42: function (B, A) {
                var M = this;
                if (!M._35O && (!lj || yk(lj))) {
                    var L, w;
                    B && (B instanceof Ln ? w = B : L = B);
                    var T = M._canvas,
                        K = M.getGL(),
                        u = M._prg;
                    if (K) {
                        var r = M.getWidth(),
                            W = M.getHeight();
                        A ? B || mc(T, r, W, A) : (A = M.getDevicePixelRatio(), B || r === T.clientWidth && W === T.clientHeight || mc(T, r, W, A)), K.clear(K.COLOR_BUFFER_BIT), K._renderInfo = {
                            calls: 0,
                            vertices: 0,
                            faces: 0,
                            lines: 0,
                            frame: B ? M._frameId : ++M._frameId
                        };
                        var R = function () {
                                if (M.overlappingBox.clear(), M._81O = h, K.clear(K.DEPTH_BUFFER_BIT), cs(K, u.uBrightness, 1), cs(K, u.uOpacity, 1), cs(K, u.uPartOpacity, 1), K._picking = !!B, cs(K, u.uPick, !!B), cs(K, u.uTexture, !1), cs(K, u.uBlendTexture, !1), cs(K, u.uAlphaTest, C.alphaTest), cs(K, u.uTransparent, !1), cs(K, u.uFix, !1), cs(K, u.uBatchColor, !1), cs(K, u.uBatchBlend, !1), cs(K, u.uBatchBrightness, !1), cs(K, u.uReflectivity, M._envmapReflectivity || .5), cs(K, u.uCameraPosition, M.getEye()), cs(K, u.uPMatrix, M._projectMatrix = Rr(M)), cs(K, u.uViewMatrix, qk(M, M._7O)), M.bindEnvMap(K), M._viewMatrix = tl(M._7O), B || (kb(M, K, u), M._fogDisabled || (cs(K, u.uFogColor, M._fogColor), cs(K, u.uFogNear, M._fogNear), cs(K, u.uFogFar, M._fogFar))), pq(K, u.aPosition), pq(K, u.aNormal), ok(K, u.aUv), ok(K, u.aBatchColor), ok(K, u.aBatchBlend), ok(K, u.aBatchBrightness), ok(K, u.aLineDistance), w) {
                                    var n = K.getParameter(K.COLOR_CLEAR_VALUE);
                                    K.clearColor(0, 0, 0, 0), K.disable(K.BLEND), ok(K, u.aNormal), Ic(K, M._cube.vs, h, u.aPosition), Op(K, M._cube.is), ld(w, M, ul, 0), ld(w, M, fg, 6), ld(w, M, sb, 12), ld(w, M, Hc, 18), ld(w, M, $b, 24), ld(w, M, Id, 30), pq(K, u.aNormal), ub(K, n)
                                } else if (L) {
                                    L.value = 2;
                                    var n = K.getParameter(K.COLOR_CLEAR_VALUE);
                                    K.clearColor(0, 0, 0, 0), K.disable(K.BLEND), M._95I(K, u, L), Pp(M, L), Tf(M, M._polylineModelMap, L), Tf(M, M._wireframeModelMap, L), cs(K, u.uTransparent, !0), M._95I(K, u, L, !0), Pp(M, L, !0), Tf(M, M._polylineModelMap, L, !0), Tf(M, M._wireframeModelMap, L, !0), cs(K, u.uTransparent, !1), K.clear(K.DEPTH_BUFFER_BIT), M._swapLineMap(), M._95I(K, u, L, !1, !0), Tf(M, M._polylineModelMap, L), Tf(M, M._wireframeModelMap, L), M._swapLineMap(), M._swapLineMap(), M._95I(K, u, L, !1, !0), Tf(M, M._polylineModelMap, L), Tf(M, M._wireframeModelMap, L), cs(K, u.uTransparent, !0), M._95I(K, u, L, !0, !0), Tf(M, M._polylineModelMap, L, !0), Tf(M, M._wireframeModelMap, L, !0), cs(K, u.uTransparent, !1), M._swapLineMap(), K.disable(K.DEPTH_TEST), M.drawFilter || M._30O._42(K, u, L), K.enable(K.DEPTH_TEST), ub(K, n)
                                } else K.disable(K.BLEND), M.drawSky(K, u), M._31O._42(K, u), M._95I(K, u), Pp(M), Tf(M, M._polylineModelMap), Tf(M, M._wireframeModelMap), K.enable(K.BLEND), cs(K, u.uTransparent, !0), K.depthMask(!1), M._95I(K, u, h, !0), Pp(M, h, !0), Tf(M, M._polylineModelMap, h, !0), Tf(M, M._wireframeModelMap, h, !0), K.depthMask(!0), cs(K, u.uTransparent, !1), K.clear(K.DEPTH_BUFFER_BIT), M._swapLineMap(), K.disable(K.BLEND), M._95I(K, u, h, !1, !0), Tf(M, M._polylineModelMap), Tf(M, M._wireframeModelMap), K.enable(K.BLEND), cs(K, u.uTransparent, !0), K.depthMask(!1), M._95I(K, u, h, !0, !0), Tf(M, M._polylineModelMap, h, !0), Tf(M, M._wireframeModelMap, h, !0), K.depthMask(!0), cs(K, u.uTransparent, !1), M._swapLineMap(), K.disable(K.DEPTH_TEST), K.disable(K.BLEND), M._32O._42(K, u), M._30O._42(K, u), M._highlightHelper._42(K, u), K.enable(K.DEPTH_TEST);
                                Ic(K, h), Op(K, h)
                            },
                            Q = !1,
                            N = r * A,
                            D = W * A,
                            d = M.vr;
                        d.enable && d._42(K, N, D, R) && (Q = !0);
                        var $ = M.envRenderer;
                        $ && $.enable && $._42(K, N, D, R) && (Q = !0);
                        var U = M._postProcessing;
                        U._42(K, N, D, R, B) && (Q = !0), Q || (M.setViewport(K, 0, 0, r * A, W * A), R()), M._33Q = !1, M.countFrame(), M._doBufferGC(K)
                    }
                }
            },
            enablePostProcessing: function (c, T) {
                return this._postProcessing.enableModule(c, T)
            },
            getPostProcessingModule: function (H) {
                return this._postProcessing.getModule(H)
            },
            setViewport: function (I, g, S, Y, m) {
                this._viewport = [g, S, Y, m], I.viewport(g, S, Y, m)
            },
            getViewport: function () {
                return this._viewport
            },
            setBufferGCInterval: function (M) {
                this._bufferGCInterval = M
            },
            _doBufferGC: function (P, _) {
                var k, a, L = P._bufPool,
                    c = 0,
                    f = 0,
                    l = P._renderInfo.frame,
                    z = this._bufferGCInterval || 10;
                for (k in L) c++, a = L[k], a && (_ || l - a._fid > z ? (P.deleteBuffer(a._buf), a._buf = null, L[k] = null) : f++);
                if (c / 2 > f && c > 128) {
                    var p = {};
                    for (k in L) L[k] && (p[k] = L[k]);
                    P._bufPool = p
                }
                P._validBufCount = f
            },
            _swapLineMap: function () {
                var E = this;
                a = E._polylineModelMap, E._polylineModelMap = E._polylineModelMapSwap, E._polylineModelMapSwap = a, a = E._wireframeModelMap, E._wireframeModelMap = E._wireframeModelMapSwap, E._wireframeModelMapSwap = a, a = E._polylineIndexMap, E._polylineIndexMap = E._polylineIndexMapSwap, E._polylineIndexMapSwap = a, a = E._wireframeIndexMap, E._wireframeIndexMap = E._wireframeIndexMapSwap, E._wireframeIndexMapSwap = a
            },
            _updateSkyBox: function (Q) {
                if (this._skyBox && Q) {
                    var s = Q.property,
                        u = !1,
                        G = this._skyBox;
                    if ("eye" === s || "forceUpdate" === s) {
                        var w = this._eye;
                        G.p3(w[0], w[1], w[2]), u = !0
                    }
                    if ("near" === s || "far" === s || "forceUpdate" === s) {
                        var d = this._near,
                            R = this._far,
                            x = G.getFinalScale3d();
                        if (x[0] /= 2, x[1] /= 2, x[2] /= 2, x[0] <= d || x[0] >= R || x[1] <= d || x[1] >= R || x[2] <= d || x[2] >= R) {
                            var N = 2 * d * R / (d + R),
                                n = Math.min(x[0], x[1], x[2]),
                                Z = N / n,
                                K = G.getScale3d();
                            G.setScale3d(K[0] * Z, K[1] * Z, K[2] * Z), u = !0
                        }
                    }
                    u && this.invalidateData(G)
                }
            },
            setSkyBox: function (N) {
                var E = this._skyBox;
                E && this._skyBoxStyleMap && (E.setStyleMap(this._skyBoxStyleMap), this._skyBoxStyleMap = null), this._skyBox = N, this.ump(this._updateSkyBox, this), N && (N.dm() && N.dm().remove(N), this._skyBoxStyleMap = k.Default.clone(N.getStyleMap()), N.s({
                    "shape3d.reverse.flip": !0,
                    "shape3d.reverse.cull": !1,
                    "all.reverse.flip": !0,
                    "all.reverse.cull": !1,
                    "front.reverse.flip": !0,
                    "front.reverse.cull": !1,
                    "back.reverse.flip": !0,
                    "back.reverse.cull": !1,
                    "left.reverse.flip": !0,
                    "left.reverse.cull": !1,
                    "right.reverse.flip": !0,
                    "right.reverse.cull": !1,
                    "top.reverse.flip": !0,
                    "top.reverse.cull": !1,
                    "bottom.reverse.flip": !0,
                    "bottom.reverse.cull": !1
                }), this.mp(this._updateSkyBox, this), this._updateSkyBox({
                    property: "forceUpdate"
                })), this.fp("skyBox", E, N)
            },
            drawSky: function (w, D, u) {
                var W = this,
                    e = W._skyBox;
                if (e) {
                    var y = W._headlightIntensity,
                        M = Cj(W._headlightColor),
                        D = W._prg;
                    1 !== y && (M = [M[0] * y, M[1] * y, M[2] * y]), cs(w, D.uHeadlightColor, [M[0], M[1], M[2], 1]);
                    var z = W.getData3dUI(e);
                    z && z._42(w, D, u, function () {
                        return !0
                    }), w.clear(w.DEPTH_BUFFER_BIT), cs(w, D.uHeadlightColor, [M[0], M[1], M[2], W._headlightDisabled ? 1 : 0])
                }
            },
            _95I: function (u, A, g, q, r) {
                function l(v) {
                    if (!!v.s("shape3d.alwaysOnTop") == !!r && K.isVisible(v) && (!m || S)) {
                        if (!g && K.isTransparentMask(v)) return;
                        var J = K.getData3dUI(v);
                        J && J._42(u, A, g, c)
                    }
                }
                var K = this,
                    c = function (j) {
                        return q ? j : !j
                    };
                K.sky && u.clear(u.DEPTH_BUFFER_BIT);
                var j = K.drawFilter;
                j ? K.dm().each(function (z) {
                    j(z) || l(z)
                }) : K.dm().each(function (b) {
                    l(b)
                })
            },
            getLogicalPoint: function (q) {
                return jm(q, this._canvas)
            },
            isRectOverlapping: function (o) {
                var m = this.getData3dUI(o);
                return m._rectOverlapping
            },
            getHitFaceInfo: function (F) {
                F.target && (F = this.lp(F));
                var b = this.getDataInfoAt(F);
                if (b) {
                    var G = this._1o.face(b.data, af(F.x, F.y));
                    if (G) return {
                        data: b.data,
                        face: G
                    }
                }
                return h
            },
            unproject: function (R, z) {
                var U = this,
                    b = U.getWidth(),
                    C = U.getHeight(),
                    c = R.target ? U.lp(R) : R,
                    N = c.x - b / 2,
                    J = c.y - C / 2,
                    k = 2 * (N / b),
                    i = 2 * (-1 * J / C);
                z = z || 0;
                var B = Ip(),
                    m = Rr(U),
                    D = qk(U);
                sg(B, m, D), ks(B);
                var Q = Mp([k, i, z, 1], B);
                return [Q[0] / Q[3], Q[1] / Q[3], Q[2] / Q[3]]
            },
            getDataAt: function (R) {
                var m = this.getDataInfoAt(R);
                return m ? m.data : h
            },
            getDataInfoAt: function (D, T) {
                return D.target && (D = this.lp(D)), this._1o.get(af(D.x, D.y, T), !0)
            },
            getDatasInRect: function (x) {
                return this._1o.get(x)
            },
            setEditable: function (S) {
                var q = this,
                    B = q._editable;
                q._editable = S, this.fp(Tc, B, S)
            },
            isEditable: function (m) {
                var y = this;
                return y._editable ? Cc(m) ? m.s("3d.editable") ? y._editableFunc ? y._editableFunc(m) : !0 : !1 : !1 : !1
            },
            isSelectable: function (n) {
                return n.s("3d.selectable") && this.sm().isSelectable(n)
            },
            isMovable: function (q) {
                var D = this;
                return kn(q) && q.getStyle(Oo) !== gs ? !1 : q.s("3d.movable") ? D._movableFunc ? D._movableFunc(q) : !0 : !1
            },
            isSizeEditable: function (p) {
                return Cc(p) ? this._sizeEditableFunc ? this._sizeEditableFunc(p) : !0 : !1
            },
            isRotationEditable: function (k) {
                return Cc(k) && k.IRotatable !== !1 ? this._rotationEditableFunc ? this._rotationEditableFunc(k) : !0 : !1
            },
            handleDelete: function () {
                this._editable && this.removeSelection()
            },
            zoomIn: function (Z) {
                this.setZoom(kg, Z)
            },
            zoomOut: function (c) {
                this.setZoom(1 / kg, c)
            },
            setZoom: function (f, C) {
                if (1 !== f) {
                    var Q = this;
                    if (Q._ortho) return Q.setOrthoZoom(f, C), void 0;
                    Q._14o && Q._14o.stop(!0);
                    var Y = 1 / f,
                        o = Q._eye,
                        A = Q._center,
                        $ = A[0] + (o[0] - A[0]) * Y - o[0],
                        B = A[1] + (o[1] - A[1]) * Y - o[1],
                        J = A[2] + (o[2] - A[2]) * Y - o[2];
                    if (!(Me(o, A) < Q._moveStep && 1 > Y)) {
                        if (C = Gl(C)) {
                            var l = tc(o);
                            return C.action = function (q) {
                                Q.fi({
                                    kind: Q._zooming ? "betweenZoom" : "beginZoom"
                                }), Q._zooming = 1, o[0] = l[0] + $ * q, o[1] = l[1] + B * q, o[2] = l[2] + J * q, Q.fp(pr, h, o)
                            }, C._37o = function () {
                                delete Q._14o, delete Q._zooming, Q.fi({
                                    kind: "endZoom"
                                }), Q.onZoomEnded()
                            }, Q._14o = Kd(C)
                        }
                        o[0] += $, o[1] += B, o[2] += J, Q.fp(pr, h, o)
                    }
                }
            },
            setOrthoZoom: function (Y, u) {
                if (1 !== Y) {
                    var K = this;
                    K._14o && K._14o.stop(!0);
                    var h = K._orthoWidth,
                        I = h / Y - h;
                    if (!(h < K._moveStep && Y > 1)) return (u = Gl(u)) ? (u.action = function (N) {
                        K.fi({
                            kind: K._zooming ? "betweenZoom" : "beginZoom"
                        }), K._zooming = 1, K.setOrthoWidth(h + I * N)
                    }, u._37o = function () {
                        delete K._14o, delete K._zooming, K.fi({
                            kind: "endZoom"
                        }), K.onZoomEnded()
                    }, K._14o = Kd(u)) : (K.setOrthoWidth(h / Y), void 0)
                }
            },
            getPositionInfo: function (h) {
                var Y = this,
                    y = Y._eye,
                    L = Y._center,
                    e = Y.getAspect(),
                    F = h ? Gi(on(L, y, !0), on(h, y)) : Me(y, L);
                if (Y._ortho) {
                    var g = Y._orthoWidth;
                    return {
                        length: F,
                        height: g / e,
                        width: g
                    }
                }
                var E = 2 * Q(Y._fovy / 2) * F;
                return {
                    length: F,
                    height: E,
                    width: E * e
                }
            },
            getCenterInfo: function () {
                var g = this;
                return g._81O || (g._81O = g.getPositionInfo()), tc(g._81O)
            },
            rotate: function (f, K, g, k) {
                var U = this;
                if (f || K) {
                    k == h && (k = U._firstPersonMode), U._88O && U._88O.stop(!0);
                    var t = U._center,
                        Y = U._eye,
                        n = U.getCenterInfo().length,
                        P = k ? t : Y,
                        r = k ? Y : t,
                        i = on(P, r),
                        v = H(i[0], i[2]),
                        E = H(l(i[0] * i[0] + i[2] * i[2]), i[1]),
                        y = k ? re : pr;
                    return k && (K = -K), (g = Gl(g)) ? (g.action = function (H) {
                        U.fi({
                            kind: U._rotating ? "betweenRotate" : "beginRotate"
                        }), U._rotating = 1;
                        var D = v + f * H,
                            L = E + K * H;
                        L = qn(L), i[0] = n * R(L) * R(D), i[1] = n * w(L), i[2] = n * R(L) * w(D), P[0] = r[0] + i[0], P[1] = r[1] + i[1], P[2] = r[2] + i[2], U.fp(y, h, P)
                    }, g._37o = function () {
                        delete U._88O, delete U._rotating, U.fi({
                            kind: "endRotate"
                        }), U.onRotateEnded()
                    }, U._88O = Kd(g)) : (v += f, E += K, E = qn(E), i[0] = n * R(E) * R(v), i[1] = n * w(E), i[2] = n * R(E) * w(v), P[0] = r[0] + i[0], P[1] = r[1] + i[1], P[2] = r[2] + i[2], U.fp(y, h, P), void 0)
                }
            },
            pan: function (Z, k, I, n) {
                if (Z || k) {
                    var e = this;
                    n == h && (n = e._firstPersonMode), e._89O && e._89O.stop(!0);
                    var i = qk(e),
                        o = [i[0] * Z, i[4] * Z, i[8] * Z],
                        s = [i[1] * k, i[5] * k, i[9] * k],
                        f = o[0] + s[0],
                        j = o[1] + s[1],
                        X = o[2] + s[2],
                        K = e._center,
                        P = e._eye;
                    if (n) {
                        var A = Of(e.getBoundaries(), P[0], P[2], P[0] + f, P[2] + X, l(f * f + X * X));
                        f = A[0], X = A[1]
                    }
                    if (I = Gl(I)) {
                        var Y = tc(P),
                            T = tc(K);
                        return I.action = function (p) {
                            e.fi({
                                kind: e._panning ? "betweenPan" : "beginPan"
                            }), e._panning = 1, K[0] = T[0] + f * p, K[1] = T[1] + j * p, K[2] = T[2] + X * p, P[0] = Y[0] + f * p, P[1] = Y[1] + j * p, P[2] = Y[2] + X * p, e.fp(pr, h, P), e.fp(re, h, K)
                        }, I._37o = function () {
                            delete e._89O, delete e._panning, e.fi({
                                kind: "endPan"
                            }), e.onPanEnded()
                        }, e._89O = Kd(I)
                    }
                    K[0] += f, K[1] += j, K[2] += X, P[0] += f, P[1] += j, P[2] += X, e.fp(pr, h, P), e.fp(re, h, K)
                }
            },
            walk: function (f, G, U) {
                if (f) {
                    var u = this;
                    U == h && (U = u._firstPersonMode), u._90O && u._90O.stop(!0);
                    var P = u._center,
                        D = u._eye,
                        $ = on(P, D, !0);
                    if (U) {
                        var T = Of(u.getBoundaries(), D[0], D[2], D[0] + $[0] * f, D[2] + $[2] * f, Y(f));
                        if (f = Me(T), !f) return;
                        $ = [T[0] / f, 0, T[1] / f]
                    }
                    if (G = Gl(G)) {
                        var F = tc(D),
                            a = tc(P);
                        return G.action = function (c) {
                            u.fi({
                                kind: u._walking ? "betweenWalk" : "beginWalk"
                            }), u._walking = 1;
                            var l = f * c;
                            D[0] = F[0] + $[0] * l, D[1] = F[1] + $[1] * l, D[2] = F[2] + $[2] * l, P[0] = a[0] + $[0] * l, P[1] = a[1] + $[1] * l, P[2] = a[2] + $[2] * l, u.fp(pr, h, D), u.fp(re, h, P)
                        }, G._37o = function () {
                            delete u._90O, delete u._walking, u.fi({
                                kind: "endWalk"
                            }), u.onWalkEnded()
                        }, u._90O = Kd(G)
                    }
                    D[0] += $[0] * f, D[1] += $[1] * f, D[2] += $[2] * f, P[0] += $[0] * f, P[1] += $[1] * f, P[2] += $[2] * f, u.fp(pr, h, D), u.fp(re, h, P)
                }
            },
            handleScroll: function (h, p) {
                h.preventDefault();
                var v = this,
                    s = v._moveStep,
                    R = v.getDataInfoAt(h);
                if (R) {
                    var m = R.data,
                        y = v.intersectObject(h, m);
                    if (y) {
                        var I = y.part,
                            i = Qn(m.s(I + ".image") || m.s("shape3d." + I + ".image") || m.s("all.image") || m.s("shape3d.image"));
                        if (i && ze(i.scrollable, m, v)) return
                    }
                }
                v.isFirstPersonMode() ? v.isPannable() && v.pan(0, p > 0 ? s : -s) : v.isZoomable() && v.setZoom(0 > p ? 1 / kl : kl)
            },
            handlePinch: function (w, N) {
                this.isZoomable() && this.setZoom(N > w ? 1 / hl : hl)
            },
            reset: function () {
                this.setCenter(f.graph3dViewCenter), this.setEye(f.graph3dViewEye), this.setUp(f.graph3dViewUp)
            },
            moveSelection: function (E, V, _) {
                var O = this;
                O.dm().beginTransaction(), Tq(this.sm().toSelection(this.isMovable, this), E, V, _), O.dm().endTransaction()
            },
            getMoveMode: function (X, n) {
                var u = n.s("3d.move.mode");
                if (u) return u;
                var i = "88",
                    k = "89",
                    J = "90";
                return Lg(X) || Ae[i] && Ae[k] && Ae[J] ? "xyz" : Ae[i] && Ae[k] ? "xy" : Ae[i] && Ae[J] ? "xz" : Ae[k] && Ae[J] ? "yz" : Ae[i] ? "x" : Ae[k] ? "y" : Ae[J] ? "z" : "xz"
            },
            handleTick: function () {
                var A = this,
                    J = !1,
                    i = A._moveStep,
                    m = i,
                    F = !1,
                    P = !0,
                    I = A._rotateStep * (P ? -1 : 1);
                if (A.isWalkable() || (m = 0), A.isPannable() || (i = 0), A.isRotatable() || (I = 0), A._32Q) {
                    var U = (Td() - A._32Q) / 50;
                    m *= U, i *= U, I *= U
                }
                A._31Q && ($r(A._31Q), delete A._31Q, delete A._32Q), ee() && (J = !0, A.pan(-i, 0, F, P)), bf() && (J = !0, A.pan(i, 0, F, P)), El() && (J = !0, Lg() ? A.pan(0, i, F, P) : A.walk(m, F, P)), _b() && (J = !0, Lg() ? A.pan(0, -i, F, P) : A.walk(-m, F, P)), we() && (J = !0, A.rotate(-I, 0, F, P)), yf() && (J = !0, A.rotate(I, 0, F, P)), Ge() && (J = !0, A.rotate(0, -I / 2, F, P)), Qg() && (J = !0, A.rotate(0, I / 2, F, P)), J && (A._32Q = Td(), A._31Q = Zl(A.handleTick, A))
            },
            handleKeyDown: function (W) {
                var x = this;
                !Ab(W) && Fe[W.keyCode] ? x.handleTick() : ed(W) ? x.selectAll() : Lp(W) ? x.handleDelete(W) : Bo(W) && this.isResettable() && x.reset()
            },
            checkDoubleClickOnNote: function (n, b, I) {
                var L = this;
                if (I === zm) {
                    if (b.s("note.toggleable")) return b.s(Li, !b.s(Li)), L.fi({
                        kind: "toggleNote",
                        event: n,
                        data: b,
                        part: I
                    }), !0
                } else if (I === Uj && b.s("note2.toggleable")) return b.s(xg, !b.s(xg)), L.fi({
                    kind: "toggleNote2",
                    event: n,
                    data: b,
                    part: I
                }), !0;
                return !1
            },
            checkDoubleClickOnRotation: function (k, C, i) {
                return i === xi ? (C.setRotationX(0), !0) : i === jk ? (C.setRotationY(0), !0) : i === Ak ? (C.setRotationZ(0), !0) : !1
            },
            onRotateEnded: function () {},
            onWalkEnded: function () {},
            getViewRatio: function (E) {
                var r = this;
                if (r.isOrtho()) return r.getWidth() / r.getOrthoWidth();
                var R = r.getCenter(),
                    q = r.getHeight(),
                    O = r.getEye(),
                    A = [R[0] - O[0], R[1] - O[1], R[2] - O[2]],
                    J = [E[0] - O[0], E[1] - O[1], E[2] - O[2]],
                    f = Math.sqrt(A[0] * A[0] + A[1] * A[1] + A[2] * A[2]),
                    k = 1 / Math.tan(r.getFovy() / 2);
                return q * f * k / (J[0] * A[0] + J[1] * A[1] + J[2] * A[2])
            },
            inViewSpace: function (f) {
                var n, Y = this,
                    g = Y._transformPointToViewSpace(f),
                    M = Y.getAspect(),
                    r = Y.getNear(),
                    S = Y.getFar();
                return -g[2] < r || -g[2] > S ? !1 : Y.isOrtho() ? (n = Y.getOrthoWidth() / 2, Math.abs(g[0]) <= n && Math.abs(g[1] * M) <= n) : (n = Math.sqrt(g[0] * g[0] + g[1] * g[1] + g[2] * g[2]) * Math.tan(Y.getFovy() / 2), Math.abs(g[1] <= n) && Math.abs(g[0]) <= n * M)
            },
            toViewPosition: function (L) {
                var y = this,
                    u = y.getWidth() / 2,
                    l = y.getHeight() / 2,
                    s = y._18Q;
                return s && s._wh === u / l || (s = Rr(y), y._18Q = sg(s, s, qk(y)), y._18Q._wh = u / l), L = Mp([L[0], L[1], L[2], 1], s), {
                    x: u + u * L[0] / L[3],
                    y: l - l * L[1] / L[3]
                }
            },
            getHitPosition: function (i, I, t) {
                var e = this,
                    V = e.getWidth(),
                    X = e.getHeight(),
                    L = i.target ? e.lp(i) : i,
                    q = L.x - V / 2,
                    R = L.y - X / 2,
                    j = e.getCenterInfo(),
                    T = qk(e);
                I = I ? I : [0, 0, 0], t = t ? t : [0, 1, 0], q = q / V * j.width, R = -1 * R / X * j.height;
                var H = [T[0] * q, T[4] * q, T[8] * q],
                    z = [T[1] * R, T[5] * R, T[9] * R],
                    n = [H[0] + z[0], H[1] + z[1], H[2] + z[2]],
                    G = e.getCenter(),
                    P = sm(e, I, t, [n[0] + G[0], n[1] + G[1], n[2] + G[2]]);
                return P ? P : [0, 0, 0]
            },
            intersectObject: function (O, b) {
                return this._raycaster.intersectObject(O, b)
            },
            intersectObjects: function (b, E, c) {
                return this._raycaster.intersectObjects(b, E, c)
            },
            getLineLength: function (E) {
                this.validate();
                var z = this.getData3dUI(E);
                if (z && z.getCache) {
                    var l = z.getCache();
                    if (l) return l[l.length - 1].length
                }
                return 0
            },
            getLineOffset: function (o, I) {
                var p = this.getData3dUI(o);
                if (p && p.getCache) {
                    var $ = p.getCache();
                    if ($) return Ml($, I)
                }
                return h
            },
            isLabelVisible: function () {
                return !0
            },
            isNoteVisible: function () {
                return !0
            },
            moveCamera: function (J, O, n) {
                var K = this,
                    F = K.getEye();
                F = [F[0], F[1], F[2]];
                var Z = K.getCenter();
                if (Z = [Z[0], Z[1], Z[2]], J || (J = F), O || (O = Z), K._flyAnim && K._flyAnim.stop(!0), n = Gl(n), !n) return K.setEye(J[0], J[1], J[2]), K.setCenter(O[0], O[1], O[2]), delete K._flyAnim, !0;
                var m = [J[0] - F[0], J[1] - F[1], J[2] - F[2]],
                    c = [O[0] - Z[0], O[1] - Z[1], O[2] - Z[2]];
                return n.action = function (C) {
                    K.setCenter(Z[0] + c[0] * C, Z[1] + c[1] * C, Z[2] + c[2] * C), K.setEye(F[0] + m[0] * C, F[1] + m[1] * C, F[2] + m[2] * C)
                }, n._37o = function () {
                    delete K._flyAnim
                }, K._flyAnim = Kd(n)
            },
            flyTo: function () {
                function W(g, b, L) {
                    if (L instanceof k.Node) {
                        D.fromArray(zh(L, b.getMat(L)));
                        var m = L.getAnchor3d();
                        g.push((new Go).set(0 - m.x, 0 - m.y, 0 - m.z).applyMatrix4(D)), g.push((new Go).set(0 - m.x, 0 - m.y, 1 - m.z).applyMatrix4(D)), g.push((new Go).set(0 - m.x, 1 - m.y, 0 - m.z).applyMatrix4(D)), g.push((new Go).set(0 - m.x, 1 - m.y, 1 - m.z).applyMatrix4(D)), g.push((new Go).set(1 - m.x, 0 - m.y, 0 - m.z).applyMatrix4(D)), g.push((new Go).set(1 - m.x, 0 - m.y, 1 - m.z).applyMatrix4(D)), g.push((new Go).set(1 - m.x, 1 - m.y, 0 - m.z).applyMatrix4(D)), g.push((new Go).set(1 - m.x, 1 - m.y, 1 - m.z).applyMatrix4(D))
                    }
                }
                var H = new Go,
                    f = new Go,
                    F = new Go,
                    t = new Go,
                    D = new Al,
                    T = new k.Math.Quaternion,
                    A = new Wo;
                return function (V, q, M) {
                    var X = this;
                    if (M !== p) q = {
                        animation: q,
                        ratio: M
                    };
                    else {
                        var I = typeof q;
                        ("boolean" === I || "object" === I && q.duration) && (q = {
                            animation: q
                        })
                    }
                    q = q || {}, H.fromArray(X.getEye()), f.fromArray(X.getCenter());
                    var L, N, o = [],
                        d = q.center,
                        C = q.distance === p;
                    if (d && F.fromArray(d), V instanceof k.Node) d || F.fromArray(V.p3()), C && (W(o, X, V), L = o.length);
                    else {
                        if (V || (V = X.dm().getDatas()), !V.length) return;
                        if ((C || !d) && (o = [], V.forEach(function (z) {
                                W(o, X, z)
                            }), L = o.length), !L) return;
                        if (!d) {
                            for (F.set(0, 0, 0), N = 0; L > N; N++) F.add(o[N]);
                            F.multiplyScalar(1 / L)
                        }
                    }
                    if (X.setCenter(F.x, F.y, F.z), t.subVectors(H, f), q.direction || q.worldDirection) {
                        !q.worldDirection && V instanceof k.Node ? T.setFromEuler(A.set(V.r3(), V.getRotationMode(), !0)) : T.set(0, 0, 0, 1);
                        var B = t.length();
                        t.fromArray(q.worldDirection || q.direction).applyQuaternion(T).setLength(B)
                    }
                    if (C) {
                        for (var u, i, w, x, $, K = X.getNear(), l = 10, M = q.ratio || .8; l--;) {
                            for (X._eye[0] = t.x + F.x, X._eye[1] = t.y + F.y, X._eye[2] = t.z + F.z, u = Rr(X), sg(u, u, qk(X)), x = !0, $ = -1 / 0, N = 0; L > N; N++) {
                                if (w = o[N], i = Mp([w.x, w.y, w.z, 1], u), i[3] < K && l) {
                                    t.multiplyScalar(2), x = !1;
                                    break
                                }
                                $ = Math.max($, Math.max(Math.abs(i[0]), Math.abs(i[1])) / M - i[3])
                            }
                            if (x) break
                        }
                        t.setLength($ + t.length()).add(F)
                    } else t.setLength(q.distance).add(F);
                    X._flyAnim && X._flyAnim.stop(!0);
                    var D = Gl(q.animation);
                    if (D) {
                        X.setEye(H.x, H.y, H.z), X.setCenter(f.x, f.y, f.z);
                        var Y = (new Go).subVectors(t, H),
                            y = (new Go).subVectors(F, f),
                            S = new Go,
                            r = new Go;
                        return D.action = function (R) {
                            S.copy(H).addScaledVector(Y, R), r.copy(f).addScaledVector(y, R), X.setCenter(r.x, r.y, r.z), X.setEye(S.x, S.y, S.z)
                        }, D._37o = function () {
                            delete X._flyAnim
                        }, {
                            lastEye: H,
                            lastCenter: f,
                            eye: t,
                            center: F,
                            animation: X._flyAnim = Kd(D)
                        }
                    }
                    return X.setEye(t.x, t.y, t.z), delete X._flyAnim, {
                        lastEye: H,
                        lastCenter: f,
                        eye: t,
                        center: F
                    }
                }
            }(),
            getBoundingBox: function () {
                function P(q, B, w) {
                    S.fromArray(zh(w, B.getMat(w)));
                    var P = w.getAnchor3d();
                    q.push((new Go).set(0 - P.x, 0 - P.y, 0 - P.z).applyMatrix4(S)), q.push((new Go).set(0 - P.x, 0 - P.y, 1 - P.z).applyMatrix4(S)), q.push((new Go).set(0 - P.x, 1 - P.y, 0 - P.z).applyMatrix4(S)), q.push((new Go).set(0 - P.x, 1 - P.y, 1 - P.z).applyMatrix4(S)), q.push((new Go).set(1 - P.x, 0 - P.y, 0 - P.z).applyMatrix4(S)), q.push((new Go).set(1 - P.x, 0 - P.y, 1 - P.z).applyMatrix4(S)), q.push((new Go).set(1 - P.x, 1 - P.y, 0 - P.z).applyMatrix4(S)), q.push((new Go).set(1 - P.x, 1 - P.y, 1 - P.z).applyMatrix4(S))
                }
                var S = new Al;
                return function (E) {
                    if (E = E || this.sm().getSelection(), E instanceof k.Node && (E = [E]), 0 === E.length) return h;
                    var n = [];
                    E.forEach(function (S) {
                        P(n, this, S)
                    }, this);
                    var y = [1 / 0, 1 / 0, 1 / 0],
                        N = [-1 / 0, -1 / 0, -1 / 0];
                    return n.forEach(function (T) {
                        y[0] = Math.min(T.x, y[0]), y[1] = Math.min(T.y, y[1]), y[2] = Math.min(T.z, y[2]), N[0] = Math.max(T.x, N[0]), N[1] = Math.max(T.y, N[1]), N[2] = Math.max(T.z, N[2])
                    }), {
                        min: y,
                        max: N
                    }
                }
            }()
        }), jl.RenderEnv = function (t) {
            this.gv = t, this.enable = !1
        }, x.defineProperties(jl.RenderEnv.prototype, {
            debugOn: {
                get: function () {
                    return this._debugOn
                },
                set: function (T) {
                    this._debugOn = T, this.capture && this.capture()
                }
            }
        }), x.assign(jl.RenderEnv.prototype, {
            renderEnvToCube: function (l, z, Z, E) {
                var b = this,
                    G = b.gv;
                if (!l || !z || !Z) return b.enable = !1, b._42 = null, void 0;
                b.enable = !0;
                var A = Math.floor(E / l * z),
                    C = G.getGL(),
                    v = b._renderTargets;
                v ? v.length < Z && (v = b._renderTargets = v.concat(new Array(Z - v.length))) : v = b._renderTargets = new Array(Z);
                for (var o = 0; Z > o; o++) v[o] ? v[o].setSize(C, E, A) : v[o] = new jl.RenderTarget(G, C, E, A);
                var u = !1;
                b.capture = function () {
                    u = !0, G._42(), u = !1
                };
                var H = new Go,
                    F = new Go,
                    a = new Go,
                    r = new Go,
                    j = (new Go).setY(0),
                    p = 2 * Math.PI / Z,
                    y = l / 2 / Math.tan(Math.PI / Z),
                    M = 2 * Math.atan2(z / 2, y),
                    J = l / z;
                b._42 = function (w, S, z, C) {
                    var s = b._debugOn;
                    if (!u && !s) return !1;
                    H.copy(G.getEye()), r.copy(G.getCenter()).sub(H);
                    var D = Math.atan2(r.z, r.x),
                        V = G.getNear(),
                        R = G.getFovy(),
                        B = G.getAspect();
                    F.copy(G.getCenter());
                    for (var n, U = 0; Z > U; U++)
                        if (n = v[U], j.setZ(Math.cos(D)).setX(Math.sin(D)).multiplyScalar(y), D -= p, a.addVectors(H, j), G.setNear(y), G.setCenter([a.x, a.y, a.z]), G.setFovy(M), G.setAspect(J), s) {
                            var e = Math.round(S / Z);
                            w.viewport(e * U, 0, e, z), C()
                        } else oh(w, n.frame), w.viewport(0, 0, n.width, n.height), w.clear(w.COLOR_BUFFER_BIT), C(), hg(w), n.assureTexture();
                    return G.setNear(V), G.setCenter([F.x, F.y, F.z]), G.setFovy(R), G.setAspect(B), !0
                }, b.capture()
            },
            getTextureInfo: function (b) {
                var g = this._renderTargets;
                if (!g) return null;
                var Z = this._renderTargets[b];
                return Z ? {
                    index: b,
                    texture: Z.texture,
                    textureName: Z.uuid
                } : null
            }
        }), x.assign(jl.Graph3dView.prototype, {
            renderEnvToCube: function (j, B, Q, a) {
                var g = this;
                g.envRenderer || (g.envRenderer = new jl.RenderEnv(g)), g.envRenderer.renderEnvToCube(j, B, Q, a)
            }
        }), jl.RenderTarget = function (r, I, A, C, m) {
            var j = this;
            m = m || {}, j.uuid = k.Math.generateUUID(), j.gv = r, j.init(r, I, m), j.setSize(I, A, C)
        }, x.assign(jl.RenderTarget.prototype, {
            init: function (q, b, S) {
                var r = this,
                    L = r.texture = b.createTexture();
                b.activeTexture(b.TEXTURE0), b.bindTexture(b.TEXTURE_2D, L), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_S, b.CLAMP_TO_EDGE), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_WRAP_T, b.CLAMP_TO_EDGE), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MIN_FILTER, S.minFilter || b.LINEAR), b.texParameteri(b.TEXTURE_2D, b.TEXTURE_MAG_FILTER, S.magFilter || b.LINEAR), b.bindTexture(b.TEXTURE_2D, null), r.render = b.createRenderbuffer(), r.frame = b.createFramebuffer(), q._2O[r.uuid] = L
            },
            assureTexture: function () {
                var N = this,
                    p = N.uuid,
                    C = N.gv._2O;
                C[p] || (C[p] = N.texture)
            },
            setSize: function (I, y, s) {
                var g = this;
                if (g.width !== y || g.height !== s) {
                    var f = I.RGBA,
                        T = I.TEXTURE_2D,
                        Z = I.RENDERBUFFER,
                        Y = I.FRAMEBUFFER;
                    os(I, g.texture), I.texImage2D(T, 0, f, y, s, 0, f, I.UNSIGNED_BYTE, h), I.bindRenderbuffer(Z, g.render), I.renderbufferStorage(Z, I.DEPTH_COMPONENT16, y, s), oh(I, g.frame), I.framebufferTexture2D(Y, I.COLOR_ATTACHMENT0, T, g.texture, 0), I.framebufferRenderbuffer(Y, I.DEPTH_ATTACHMENT, Z, g.render), os(I, h), I.bindRenderbuffer(Z, h), hg(I), g.width = y, g.height = s
                }
            },
            toCanvas: function () {
                var a = this,
                    W = a.gv.getGL();
                oh(W, a.frame);
                var X = a.width,
                    h = a.height,
                    r = new Uint8Array(4 * X * h);
                W.readPixels(0, 0, X, h, W.RGBA, W.UNSIGNED_BYTE, r), hg(W);
                var j = b.createElement("canvas");
                j.width = X, j.height = h;
                var U = j.getContext("2d"),
                    M = U.createImageData(X, h);
                return M.data.set(r), U.putImageData(M, 0, 0), j
            }
        });
        var ck = jl.Interactor = function (E) {
            this.gv = E
        };
        $g("Interactor", x, {
            ms_listener: 1,
            getView: function () {
                return this.gv.getView()
            },
            setUp: function () {
                this.addListeners()
            },
            tearDown: function () {
                this.removeListeners()
            }
        });
        var eq = jl.DefaultInteractor = function (q) {
            cj(eq, this, [q])
        };
        $g("DefaultInteractor", ck, {
            handle_contextmenu: function (B) {
                Bl(B)
            },
            handle_mousewheel: function (b) {
                this.gv.handleScroll(b, b.wheelDelta / 40)
            },
            handle_DOMMouseScroll: function (N) {
                2 === N.axis && this.gv.handleScroll(N, -N.detail)
            },
            handle_keydown: function (k) {
                this.gv.handleKeyDown(k)
            },
            handle_mousedown: function (I) {
                this.handle_touchstart(I)
            },
            handle_touchstart: function (S) {
                Bl(S);
                var Y = this,
                    f = Y.gv,
                    N = Bf(S),
                    H = f.getDataInfoAt(S),
                    P = H ? H.data : h,
                    O = H ? H.part : h,
                    j = f.sm(),
                    g = Uq(S),
                    V = ni(S);
                f.setFocus(S) && (Y._62O = h, Y._57I = h, P ? Ab(S) ? j.co(P) ? j.rs(P) : j.as(P) : j.co(P) || j.ss(P) : N && (Ab(S) ? f.isRectSelectable() && (Y._62O = ek) : Y._57I = Fc(S)), Y._31Q && ($r(Y._31Q), delete Y._31Q, delete Y._32Q), Y._62O || (f.isFirstPersonMode() && (Lg(S) || V > 2 ? Y._62O = "pan" : f.isMouseRoamable() || ah ? (Y._62O = "roaming", Y.foward = g && Bf(S), Y._32Q = Td(), Y._31Q = Zl(Y.tick, Y)) : N || (Y._62O = "roaming")), Y._62O || (N && g && kh[O] ? (Y._62O = O, Y.p3 = P.p3()) : N && g && Cc(P) && f.isSelected(P) ? f.isMovable(P) ? (Y._62O = "move", Y.p3 = P.p3(), Y.movedata = P) : f.isInteractive(P) && (Y._62O = "none") : ah && (V > 2 ? Y._62O = "pan" : 2 === V && (Y.dist = ie(S), Y._62O = "pinch")))), Y.point = f.lp(S), gn(Y, S), bo(S) ? f.handleDoubleClick(S, P, O) : f.handleClick(S, P, O))
            },
            tick: function () {
                var X = this,
                    z = X.gv,
                    Y = z._moveStep;
                X.point && z.isWalkable() && (X._32Q && (Y *= (Td() - X._32Q) / 50), z.walk(X.foward ? Y : -Y), X._32Q = Td(), X._31Q = Zl(X.tick, X))
            },
            handle_mouseup: function (t) {
                this.handle_touchend(t)
            },
            handle_touchend: function (i) {
                var I = this._57I;
                I && (Me(I, Fc(i)) <= 1 && this.gv.sm().cs(), this._57I = h)
            },
            handleWindowMouseMove: function (W) {
                this.handleWindowTouchMove(W)
            },
            handleWindowTouchMove: function (S) {
                var Z, w, F = this,
                    p = F.gv,
                    y = F._62O,
                    X = F.point,
                    e = p.dm(),
                    Q = p.lp(S),
                    V = Q.x - X.x,
                    x = Q.y - X.y,
                    $ = p.getWidth(),
                    i = p.getHeight();
                if ($ && i) {
                    var b = -E * V / $,
                        P = -E * x / i;
                    if ("roaming" === y) F.rotate(S, b / 2, P / 2);
                    else if (y === xi || y === jk || y === Ak) p._86O || e.beginTransaction(), p.fi({
                        kind: p._86O ? "betweenEditRotation" : "beginEditRotation",
                        event: S
                    }), p._86O = 1, p.sm().each(function (B) {
                        if (Cc(B) && p.isRotationEditable(B)) {
                            var d = Y(b) > Y(P) ? b : P;
                            y === xi ? B.setRotationX(B.getRotationX() + d) : y === jk ? B.setRotationY(B.getRotationY() + d) : y === Ak && B.setRotationZ(B.getRotationZ() + d)
                        }
                    });
                    else if ("move" === y || kh[y]) {
                        y === ch || y === ti || y === Cb ? (p._87O || e.beginTransaction(), p.fi({
                            kind: p._87O ? "betweenEditScale" : "beginEditScale",
                            event: S
                        }), p._87O = 1) : (p._moving || e.beginTransaction(), p.fi({
                            kind: p._moving ? "betweenMove" : "beginMove",
                            event: S
                        }), p._moving = 1);
                        var G, R = F.p3,
                            d = p.getPositionInfo(R),
                            L = qk(p);
                        G = y === dq ? "x" : y === Co ? "y" : y === Hb ? "z" : y === ch ? "sx" : y === ti ? "sy" : y === Cb ? "sz" : p.getMoveMode(S, F.movedata), V = V / $ * d.width, x = -1 * x / i * d.height;
                        var I, g, A = [L[0] * V, L[4] * V, L[8] * V],
                            H = [L[1] * x, L[5] * x, L[9] * x],
                            U = A[0] + H[0],
                            W = A[1] + H[1],
                            l = A[2] + H[2],
                            O = [R[0] + U, R[1] + W, R[2] + l],
                            r = on(p.getEye(), O, !0);
                        if ("xyz" === G ? (I = O, p.moveSelection(U, W, l)) : "xz" === G ? (I = sm(p, R, [0, 1, 0], O), I && p.moveSelection(I[0] - R[0], 0, I[2] - R[2])) : "xy" === G ? (I = sm(p, R, [0, 0, 1], O), I && p.moveSelection(I[0] - R[0], I[1] - R[1], 0)) : "yz" === G ? (I = sm(p, R, [1, 0, 0], O), I && p.moveSelection(0, I[1] - R[1], I[2] - R[2])) : "x" === G || "sx" === G ? (r[0] = 0, I = sm(p, R, r, O), I && (g = I[0] - R[0], "x" === G ? p.moveSelection(g, 0, 0) : p.sm().each(function (A) {
                                Cc(A) && p.isSizeEditable(A) && (Z = A.getScaleX() + g / 100, w = Z / A.getScaleX(), A.setScaleX(Z), Lg(S) && (A.setScaleY(A.getScaleY() * w), A.setScaleTall(A.getScaleTall() * w)))
                            }))) : "y" === G || "sy" === G ? (r[1] = 0, I = sm(p, R, r, O), I && (g = I[1] - R[1], "y" === G ? p.moveSelection(0, g, 0) : p.sm().each(function (L) {
                                Cc(L) && p.isSizeEditable(L) && (Z = L.getScaleTall() + g / 100, w = Z / L.getScaleTall(), L.setScaleTall(Z), Lg(S) && (L.setScaleY(L.getScaleY() * w), L.setScaleX(L.getScaleX() * w)))
                            }))) : ("z" === G || "sz" === G) && (r[2] = 0, I = sm(p, R, r, O), I && (g = I[2] - R[2], "z" === G ? p.moveSelection(0, 0, g) : p.sm().each(function (Q) {
                                    Cc(Q) && p.isSizeEditable(Q) && (Z = Q.getScaleY() + g / 100, w = Z / Q.getScaleY(), Q.setScaleY(Z), Lg(S) && (Q.setScaleX(Q.getScaleX() * w), Q.setScaleTall(Q.getScaleTall() * w)))
                                }))), !I) return;
                        F.p3 = I
                    } else if (y === ek) {
                        var v = F.div;
                        v || (v = F.div = rq(), or(F.getView(), v), v.op = X, v.style.background = p.getRectSelectBackground()), p.fi({
                            kind: p._rectSelecting ? "betweenRectSelect" : "beginRectSelect",
                            event: S
                        }), p._rectSelecting = 1, v.rect = Vj(v.op, Q), Qh(v, v.rect)
                    } else if ("pinch" === y && 2 === ni(S)) {
                        p.fi({
                            kind: p._pinching ? "betweenPinch" : "beginPinch",
                            event: S
                        }), p._pinching = 1;
                        var g = ie(S);
                        p.handlePinch(g, F.dist), F.dist = g
                    } else "pan" === y || Lg(S) ? F.pan(S, V, x) : "none" === y || p.isFirstPersonMode() || (Bf(S) ? F.rotate(S, b, P) : (F.pan(S, V, 0), p.isWalkable() && (p.fi({
                            kind: p._walking ? "betweenWalk" : "beginWalk",
                            event: S
                        }), p._walking = 1, p.walk(x / p.getHeight() * p.getCenterInfo().height))));
                    F.point = Q
                }
            },
            pan: function (H, f, b) {
                var O = this.gv;
                if (O.isPannable()) {
                    var t = O.getWidth(),
                        F = O.getHeight();
                    if (!t || !F) return;
                    var o = O.getCenterInfo(),
                        P = f / t * o.width,
                        M = -1 * b / F * o.height;
                    O.fi({
                        kind: O._panning ? "betweenPan" : "beginPan",
                        event: H
                    }), O._panning = 1, O.pan(-P, -M)
                }
            },
            rotate: function (j, E, t) {
                var V = this.gv;
                V.isRotatable() && (V.fi({
                    kind: V._rotating ? "betweenRotate" : "beginRotate",
                    event: j
                }), V._rotating = 1, V.rotate(E, t))
            },
            handleWindowMouseUp: function (h) {
                this.handleWindowTouchEnd(h)
            },
            handleWindowTouchEnd: function (I) {
                var b = this,
                    M = b.gv,
                    n = M.dm(),
                    e = b.div;
                if (e) {
                    var Z = M.getDatasInRect(e.rect);
                    if (!Z.isEmpty()) {
                        var D = M.sm(),
                            m = D.toSelection();
                        Z.each(function (u) {
                            D.co(u) ? m.remove(u) : m.add(u)
                        }), D.ss(m)
                    }
                    Kh(e)
                }
                M._moving && (delete M._moving, M.fi({
                    kind: "endMove",
                    event: I
                }), M.onMoveEnded(), n.endTransaction()), M._panning && (delete M._panning, M.fi({
                    kind: "endPan",
                    event: I
                }), M.onPanEnded()), M._rotating && (delete M._rotating, M.fi({
                    kind: "endRotate",
                    event: I
                }), M.onRotateEnded()), M._86O && (delete M._86O, M.fi({
                    kind: "endEditRotation",
                    event: I
                }), n.endTransaction()), M._87O && (delete M._87O, M.fi({
                    kind: "endEditScale",
                    event: I
                }), n.endTransaction()), M._pinching && (delete M._pinching, M.fi({
                    kind: "endPinch",
                    event: I
                }), M.onPinchEnded()), M._rectSelecting && (delete M._rectSelecting, M.fi({
                    kind: "endRectSelect",
                    event: I
                }), M.onRectSelectEnded()), M._walking && (delete M._walking, M.fi({
                    kind: "endWalk",
                    event: I
                }), M.onWalkEnded()), b.dist = b.point = b._62O = b.p3 = b.movedata = b.div = b._57I = b._32Q = b._31Q = b.foward = h
            }
        });
        var jq = jl.MapInteractor = function (Z) {
            cj(jq, this, [Z]), this._minPhi = 0, this._maxPhi = 5 * c / 12, this._keepHorizon = !0, this._threshold = 2, this._touchScaleThreshold = .05, this._touchRotateThreshold = .03, this._touchScaleCheckAccuracy = .01, this._panButton = "right"
        };
        $g("MapInteractor", ck, {
            handle_contextmenu: function (S) {
                Bl(S)
            },
            handle_mousewheel: function (y) {
                this.gv.handleScroll(y, y.wheelDelta / 40)
            },
            handle_DOMMouseScroll: function (j) {
                2 === j.axis && this.gv.handleScroll(j, -j.detail)
            },
            handle_keydown: function (k) {
                this.gv.handleKeyDown(k)
            },
            handle_mousedown: function (L) {
                this.handle_touchstart(L)
            },
            handle_touchstart: function (G) {
                Bl(G);
                var j = this,
                    C = j.gv;
                if (C.setFocus(G)) {
                    C.lp(G);
                    var g = C.getDataInfoAt(G),
                        k = g ? g.data : h,
                        N = g ? g.part : h;
                    if (!k || !C.isInteractive(k)) {
                        var E = j.editing = {
                            point: C.lp(G)
                        };
                        ah ? E.touch = !0 : (E.touch = !1, E.pan = "left" === this.panButton === Bf(G)), gn(j, G)
                    }
                    bo(G) ? C.handleDoubleClick(G, k, N) : C.handleClick(G, k, N)
                }
            },
            handle_mouseup: function (W) {
                this.handle_touchend(W)
            },
            handle_touchend: function () {},
            handleWindowMouseMove: function (_) {
                this.handleWindowTouchMove(_)
            },
            handleWindowTouchMove: function (f) {
                var C = this,
                    W = C.gv,
                    n = C.editing;
                if (n) {
                    var m = W.lp(f),
                        P = n.point,
                        Y = m.x - P.x,
                        A = m.y - P.y;
                    if (!n.moved) {
                        if (Math.abs(Y) < C.threshold && Math.abs(A) < C.threshold && !(f.touches && f.touches.length > 1)) return;
                        n.moved = !0
                    }
                    if (n.point = m, n.touch) {
                        var w = f.touches.length;
                        if (2 !== w) C.pan(f, Y, A);
                        else {
                            if (1 >= w) return;
                            var O = f.touches,
                                v = {
                                    x: O[0].clientX,
                                    y: O[0].clientY
                                },
                                M = {
                                    x: O[1].clientX,
                                    y: O[1].clientY
                                },
                                i = {
                                    x: M.x - v.x,
                                    y: M.y - v.y
                                },
                                k = n.lastCenter,
                                Q = Math.atan2(i.y, i.x),
                                X = n.theta,
                                r = 0;
                            X == h ? X = n.theta = Q : (r = Q - X, n.thetaStarted || Math.abs(r) > C.touchRotateThreshold ? (n.thetaStarted = !0, n.theta = Q) : r = 0);
                            var d = c * (v.y + M.y) / 2 / W.getHeight(),
                                J = n.phi,
                                B = 0;
                            J == h ? J = n.phi = d : (B = d - J, n.phiStarted || Math.abs(B) > C.touchRotateThreshold ? (n.phiStarted = !0, n.phi = d) : B = 0);
                            var j, e = Math.sqrt(i.x * i.x + i.y * i.y),
                                $ = n.vlen;
                            if ($) {
                                var H = v.x - k.x,
                                    I = v.y - k.y,
                                    y = M.x - k.x,
                                    a = M.y - k.y,
                                    G = Math.sqrt(H * H + I * I),
                                    F = Math.sqrt(y * y + a * a),
                                    N = $ / 2,
                                    _ = C._sign2(G - N),
                                    o = C._sign2(F - N);
                                0 > _ * o || 0 === _ && 0 === o ? (j = 1, n.vlen = e) : (j || (j = e / $), n.scaleStarted || Math.abs(j - 1) > C.touchScaleThreshold ? (n.vlen = e, n.scaleStarted = !0) : j = 1)
                            } else $ = n.vlen = e, j = 1;
                            1 !== j && W.setZoom(j), (B || r) && C.rotate(f, r, -B), n.lastCenter = {
                                x: (M.x + v.x) / 2,
                                y: (M.y + v.y) / 2
                            }
                        }
                    } else if (n.pan) C.pan(f, Y, A);
                    else {
                        var U = W.getWidth(),
                            l = W.getHeight();
                        if (!U || !l) return;
                        var u = -E * Y / U,
                            D = -E * A / l;
                        C.rotate(f, u, D)
                    }
                }
            },
            _sign2: function (U) {
                return Math.abs(U) < this._touchScaleCheckAccuracy ? 0 : U > 0 ? 1 : -1
            },
            handleWindowMouseUp: function ($) {
                this.handleWindowTouchEnd($)
            },
            handleWindowTouchEnd: function (U) {
                var q = this,
                    t = q.editing;
                if (q.editing = null, t) {
                    var N = q.gv;
                    if (!t.moved && t.pan) {
                        var D = N.getDataAt(U);
                        D ? N.sm().setSelection([D]) : N.sm().clearSelection()
                    } else N._panning = null, N._rotating = null, N.fi({
                        kind: t.pan ? "endPan" : "endRotate",
                        event: U
                    })
                }
            },
            pan: function (w, g, N) {
                var b = this,
                    s = b.gv;
                if (s.isPannable()) {
                    var e = s.getWidth(),
                        q = s.getHeight();
                    if (e && q) {
                        var W = s.getCenterInfo(),
                            _ = -g / e * W.width,
                            D = 1 * N / q * W.height;
                        s.fi({
                            kind: s._panning ? "betweenPan" : "beginPan",
                            event: w
                        }), s._panning = 1;
                        var M = b.keepHorizon,
                            x = b.editing.touch;
                        if ((x && w.touches && w.touches.length > 1 || !x && Lg(w)) && (M = !M), !M) return s.pan(_, D);
                        if (_ || D) {
                            var I = qk(s),
                                m = [I[0] * _, I[4] * _, I[8] * _],
                                P = [I[1], 0, I[9]],
                                t = Math.sqrt(P[0] * P[0] + P[2] * P[2]);
                            t && (P = [P[0] / t * D, 0, P[2] / t * D]);
                            var V = m[0] + P[0],
                                k = m[1] + P[1],
                                B = m[2] + P[2],
                                c = s._center,
                                U = s._eye;
                            c[0] += V, c[1] += k, c[2] += B, U[0] += V, U[1] += k, U[2] += B, s.fp(pr, h, U), s.fp(re, h, c)
                        }
                    }
                }
            },
            rotate: function (X, M, G) {
                var y = this,
                    v = y.gv;
                if (v.isRotatable()) {
                    var s = v._center,
                        n = v._eye,
                        q = on(n, s),
                        p = H(l(q[0] * q[0] + q[2] * q[2]), q[1]),
                        Q = p + G;
                    Q = Math.max(y.minPhi, Math.min(y.maxPhi, Q)), G = Q - p, v.fi({
                        kind: v._rotating ? "betweenRotate" : "beginRotate",
                        event: X
                    }), v._rotating = 1, v.rotate(M, G)
                }
            }
        }), x.defineProperties(jq.prototype, {
            panButton: {
                get: function () {
                    return this._panButton
                },
                set: function (D) {
                    this._panButton = D
                }
            },
            minPhi: {
                get: function () {
                    return this._minPhi
                },
                set: function (i) {
                    this._minPhi = i
                }
            },
            maxPhi: {
                get: function () {
                    return this._maxPhi
                },
                set: function (G) {
                    this._maxPhi = G
                }
            },
            keepHorizon: {
                get: function () {
                    return this._keepHorizon
                },
                set: function (d) {
                    this._keepHorizon = d
                }
            },
            threshold: {
                get: function () {
                    return this._threshold
                },
                set: function (d) {
                    this._threshold = d
                }
            },
            touchScaleThreshold: {
                get: function () {
                    return this._touchScaleThreshold
                },
                set: function (g) {
                    this._touchScaleThreshold = g
                }
            },
            touchRotateThreshold: {
                get: function () {
                    return this._touchRotateThreshold
                },
                set: function (h) {
                    this._touchRotateThreshold = h
                }
            }
        });
        var Cq = function (E) {
            this.gv = E
        };
        zc(Cq, x, {
            _iv: !0,
            iv: function () {
                this._iv = !0
            },
            face: function (B, T) {
                var J = this,
                    N = J.gv.getGL();
                if (!N || !Cc(B)) return h;
                var z = T.x,
                    Z = T.width,
                    L = T.height,
                    l = J.height - T.y - L,
                    D = e(Z / 2),
                    H = new Uint8Array(4 * Z * L),
                    p = 0;
                for (J.iv(), J.validate(B), oh(N, J.frame), N.readPixels(z, l, Z, L, N.RGBA, N.UNSIGNED_BYTE, H), hg(N), J.iv(); D >= p; p++)
                    for (var x = D - p, G = D + p, k = x; G >= k; k++)
                        for (var i = x; G >= i; i++)
                            if (k === x || k === G || i === x || i === G) {
                                var U = Lj.m[H[4 * (k * Z + i)]];
                                if (U) return U
                            }
            },
            get: function (B, t) {
                this.validate();
                var y = this,
                    W = y.gv.getGL();
                if (!W) return h;
                var x, m, o = B.x,
                    k = B.width,
                    s = B.height,
                    S = y.height - B.y - s,
                    A = e(k / 2),
                    f = new Uint8Array(4 * k * s),
                    X = 0,
                    d = f.length,
                    H = t ? h : new vf,
                    R = t ? h : {};
                if (oh(W, y.frame), W.readPixels(o, S, k, s, W.RGBA, W.UNSIGNED_BYTE, f), hg(W), t) {
                    for (; A >= X; X++)
                        for (var $ = A - X, V = A + X, g = $; V >= g; g++)
                            for (var P = $; V >= P; P++)
                                if ((g === $ || g === V || P === $ || P === V) && (x = y.info(f, 4 * (g * k + P)))) return x
                } else
                    for (; d > X; X += 4) x = y.info(f, X), x && (m = x.data, R[m._id] || (H.add(m), R[m._id] = m));
                return H
            },
            info: function (I, o) {
                return this.colorMap[(I[o] << 16) + (I[o + 1] << 8) + I[o + 2] + ((127 & I[o + 3]) << 24)]
            },
            validate: function (A) {
                var g = this,
                    c = g.gv,
                    Z = c.getGL();
                if (Z) {
                    var d = c.getWidth(),
                        H = c.getHeight(),
                        p = Z.RGBA,
                        O = Z.TEXTURE_2D,
                        s = Z.RENDERBUFFER,
                        I = Z.FRAMEBUFFER;
                    g.texture || (g.texture = bb(Z), g.render = Z.createRenderbuffer(), g.frame = Z.createFramebuffer()), (g.width !== d || g.height !== H) && (os(Z, g.texture), Z.texImage2D(O, 0, p, d, H, 0, p, Z.UNSIGNED_BYTE, h), Fi(Z, Z.TEXTURE_MIN_FILTER, Z.LINEAR), Z.bindRenderbuffer(s, g.render), Z.renderbufferStorage(s, Z.DEPTH_COMPONENT16, d, H), oh(Z, g.frame), Z.framebufferTexture2D(I, Z.COLOR_ATTACHMENT0, O, g.texture, 0), Z.framebufferRenderbuffer(I, Z.DEPTH_ATTACHMENT, s, g.render), os(Z, h), Z.bindRenderbuffer(s, h), hg(Z), g.width = d, g.height = H), g._iv && (g._iv = !1, oh(Z, g.frame), c._42(A || (g.colorMap = {}), 1), hg(Z))
                }
            }
        });
        var wm = function (e) {
            this.gv = e
        };
        zc(wm, x, {
            gap: 0,
            size: 0,
            _42: function (X, L) {
                var T = this,
                    Y = T.gv,
                    E = Y._gridGap,
                    H = Y._gridSize;
                if (Y._gridVisible) {
                    if (T.gap !== E || T.size !== H) {
                        for (var B = [], V = Y._gridSize / 2, b = E * V, t = 0; 2 * V + 1 > t; t++) {
                            var I = 6 * t,
                                U = 6 * (2 * V + 1) + I;
                            B[I] = -b, B[I + 1] = 0, B[I + 2] = -b + t * E, B[I + 3] = b, B[I + 4] = 0, B[I + 5] = -b + t * E, B[U] = -b + t * E, B[U + 1] = 0, B[U + 2] = -b, B[U + 3] = -b + t * E, B[U + 4] = 0, B[U + 5] = b
                        }
                        T.vs = new Ol(B), T.gap = E, T.size = H
                    }
                    hs(Y), $k(X, L), $h(X), hr(X, L, 1, Y._gridColor, Y._buffer.vs, T.vs), Qp(X, 0, T.vs.length / 3, X.LINES), Si(X), $e(X, L)
                } else T.vs = T.gap = T.size = h
            }
        });
        var vi = function (u) {
            this.gv = u
        };
        zc(vi, x, {
            _42: function (D, L) {
                var K = this.gv,
                    I = K._buffer.vs,
                    J = K._axisXColor,
                    U = K._axisYColor,
                    P = K._axisZColor,
                    O = K._originAxisVisible,
                    l = K._centerAxisVisible;
                if (O || l) {
                    var N = v ? D.TRIANGLES : D.TRIANGLE_FAN,
                        Q = D.LINES;
                    if (hs(K), $k(D, L), $h(D), O) {
                        var c = K.getCenterInfo(),
                            q = j(c.width, c.height) / 5,
                            Z = .8 * q,
                            Y = .05 * q;
                        hr(D, L, 1.5, J, I, new Ol([0, 0, 0, q, 0, 0, Z, Y, 0, Z, 0, Y, Z, -Y, 0, Z, 0, -Y, Z, Y, 0, 0, 0, 0, 0, q, 0, Y, Z, 0, 0, Z, Y, -Y, Z, 0, 0, Z, -Y, Y, Z, 0, 0, 0, 0, 0, 0, q, Y, 0, Z, 0, Y, Z, -Y, 0, Z, 0, -Y, Z, Y, 0, Z])), Qp(D, 0, 2, Q), Qp(D, 1, 6, N), hr(D, L, h, U), Qp(D, 7, 2, Q), Qp(D, 8, 6, N), hr(D, L, h, P), Qp(D, 14, 2, Q), Qp(D, 15, 6, N)
                    }
                    if (l) {
                        var _ = K._center,
                            y = _[0],
                            p = _[1],
                            f = _[2],
                            c = K.getPositionInfo(_);
                        q = j(c.width, c.height) / 20, hr(D, L, 1.5, J, I, new Ol([y, p, f, y + q, p, f, y, p, f, y, p + q, f, y, p, f, y, p, f + q])), Qp(D, 0, 2, Q), hr(D, L, h, U), Qp(D, 2, 2, Q), hr(D, L, h, P), Qp(D, 4, 2, Q)
                    }
                    Si(D), $e(D, L)
                }
            }
        });
        var Ap = function (n) {
            this.gv = n, this.onMouseOver = this.onMouseOver.bind(this), this.mode = Ap.Mode.MouseOver
        };
        Ap.Mode = {
            Disable: 0,
            Selection: 1,
            MouseOver: 2
        }, zc(Ap, x, {
            onMouseOver: function (h) {
                f.preventDefault(h);
                var R = this.gv.getDataAt(h);
                R !== this.mouseOverData && (this.mouseOverData = R, this.gv.iv())
            },
            setFetchTargetFunc: function (x) {
                this.fetchTargetFunc = x
            },
            _42: function (y, s) {
                var m, n = this,
                    h = n._mode;
                if (h !== Ap.Mode.Disable && (h === Ap.Mode.Selection ? m = n.gv.sm().getSelection().toArray(function (m) {
                        return m.s("highlight.visible")
                    }) : h === Ap.Mode.MouseOver && n.mouseOverData && n.mouseOverData.s("highlight.visible") && (m = [n.mouseOverData]), n.fetchTargetFunc && (m = n.fetchTargetFunc(m)), m && m.length)) {
                    var V = n.gv,
                        _ = V.vr.isPresenting(),
                        Q = V.getWidth();
                    if (_) {
                        var v = V.getWidth;
                        Q /= 2, V.getWidth = function () {
                            return Q
                        };
                        var O = V.getViewport()
                    }
                    var k, D = V.getDevicePixelRatio(),
                        e = Q * D,
                        a = V.getHeight() * D;
                    (k = n._renderTarget) ? k.setSize(y, e, a): n._renderTarget = k = new jl.RenderTarget(V, y, e, a), oh(y, k.frame), V.drawFilter = function (P) {
                        return m.indexOf(P) < 0 ? !0 : void 0
                    }, V._42({}), V.drawFilter = null, hg(y), _ && (V.getWidth = v, V.setViewport(y, O[0], O[1], O[2], O[3])), n.shader || (n.shader = new fk.Shader(y, pg.vs, pg.fs));
                    var H = n.shader;
                    if (n.shader.bind(), y.enable(y.BLEND), y.activeTexture(y.TEXTURE0 + 0), y.bindTexture(y.TEXTURE_2D, k.texture), H.uniforms.image = 0, H.uniforms.textureSize = [e, a], H.uniforms.edgeWidth = C["highlight.width"], n.highlightColor !== C["highlight.color"]) {
                        var P = fj(n.highlightColor = C["highlight.color"]);
                        n.highlightColorData = [P[0] / 255, P[1] / 255, P[2] / 255, P[3] / 255]
                    }
                    H.uniforms.edgeColor = n.highlightColorData, n.ibuffer ? (n.ibuffer.upload(), n.vbuffer.upload()) : (n.ibuffer = fk.Buffer.createIndexBuffer(y, new Uint16Array([0, 2, 1, 1, 2, 3])), n.vbuffer = fk.Buffer.createVertexBuffer(y, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))), H.attributes.pos.pointer(n.vbuffer), y.drawElements(y.TRIANGLES, 6, y.UNSIGNED_SHORT, 0), y.disable(y.BLEND), y.bindTexture(y.TEXTURE_2D, null), y.useProgram(s)
                }
            }
        }), x.defineProperties(Ap.prototype, {
            mode: {
                get: function () {
                    return this._mode
                },
                set: function (y) {
                    var z = this._mode;
                    y !== z && (this._mode = y, y === Ap.Mode.MouseOver ? this.gv.getView().addEventListener("mousemove", this.onMouseOver, !1) : z === Ap.Mode.MouseOver && this.gv.getView().removeEventListener("mousemove", this.onMouseOver))
                }
            }
        });
        var pg = {
                vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
                fs: ["precision highp float;", "uniform sampler2D image;", "uniform vec2 textureSize;", "uniform float edgeWidth;", "uniform vec4 edgeColor;", "varying vec2 vUv;", "float getCol(vec2 coord) {", "return texture2D(image, coord).a;", "}", "void main() {", "vec2 cc = vUv;", "float center = getCol(cc);", "float dx = edgeWidth / textureSize.x;", "float dy = edgeWidth / textureSize.y;", "vec2 coord;", "float topLeft = getCol(cc+vec2(-dx, -dy));", "float top = getCol(cc+vec2(0.0, -dy));", "float topRight = getCol(cc+vec2(dx, -dy));", "float left = getCol(cc+vec2(-dx, 0.0));", "float right = getCol(cc+vec2(dx, 0.0));", "float bottomLeft = getCol(cc+vec2(-dx, dy));", "float bottom = getCol(cc+vec2(0.0, dy));", "float bottomRight = getCol(cc+vec2(dx, dy));", "float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;", "float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;", "float edge = sqrt(h * h + v * v);", "edge = smoothstep(0.9, 1.0, edge);", "if (edge < 0.5) {", "discard;", "}", "gl_FragColor = edgeColor;", "}"].join("\n")
            },
            Jd = function (n) {
                this.gv = n
            },
            dq = "edit_tx",
            Co = "edit_ty",
            Hb = "edit_tz",
            xi = "edit_rx",
            jk = "edit_ry",
            Ak = "edit_rz",
            ch = "edit_sx",
            ti = "edit_sy",
            Cb = "edit_sz",
            kh = {};
        kh[dq] = 1, kh[Co] = 1, kh[Hb] = 1, kh[xi] = 1, kh[jk] = 1, kh[Ak] = 1, kh[ch] = 1, kh[ti] = 1, kh[Cb] = 1, zc(Jd, x, {
            _42: function (T, l, r) {
                var g = this,
                    k = g.gv,
                    X = k.sm().ld();
                if (X && k.isEditable(X) && !k.isEditHelperDisabled() && Cc(X) && (!k.isFirstPersonMode() || !k.isMouseRoamable() && !ah)) {
                    hs(k);
                    var A, H, o = k.isMovable(X),
                        t = k.isRotationEditable(X),
                        m = k.isSizeEditable(X),
                        _ = k._axisXColor,
                        P = k._axisYColor,
                        b = k._axisZColor,
                        Q = k._editSizeColor,
                        n = X.p3(),
                        B = Me(k.getEye(), n) / 10,
                        R = B / (r ? 5 : 10),
                        j = .7 * B,
                        $ = .4 * j,
                        f = n[0],
                        q = n[1],
                        S = n[2];
                    A = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0], o && g._17O(T, l, X, r, dq, _, A, [f, q - R, S, f + j, q - R, S, f + j, q, S, f + j, q, S, f, q, S, f, q - R, S, f, q - R, S + R, f + j, q - R, S + R, f + j, q - R, S, f + j, q - R, S, f, q - R, S, f, q - R, S + R]), H = f + j, m && g._17O(T, l, X, r, ch, Q, A, [H, q - R, S, H + $, q - R, S, H + $, q, S, H + $, q, S, H, q, S, H, q - R, S, H, q - R, S + R, H + $, q - R, S + R, H + $, q - R, S, H + $, q - R, S, H, q - R, S, H, q - R, S + R]), H += $, t && g._17O(T, l, X, r, xi, _, A, [H, q - R, S, H + $, q - R, S, H + $, q, S, H + $, q, S, H, q, S, H, q - R, S, H, q - R, S + R, H + $, q - R, S + R, H + $, q - R, S, H + $, q - R, S, H, q - R, S, H, q - R, S + R]), A = [0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0], o && g._17O(T, l, X, r, Co, P, A, [f, q, S, f, q + j, S, f - R, q + j, S, f - R, q + j, S, f - R, q, S, f, q, S, f, q, S, f, q, S - R, f, q + j, S - R, f, q + j, S - R, f, q + j, S, f, q, S]), H = q + j, m && g._17O(T, l, X, r, ti, Q, A, [f, H, S, f, H + $, S, f - R, H + $, S, f - R, H + $, S, f - R, H, S, f, H, S, f, H, S, f, H, S - R, f, H + $, S - R, f, H + $, S - R, f, H + $, S, f, H, S]), H += $, t && g._17O(T, l, X, r, jk, P, A, [f, H, S, f, H + $, S, f - R, H + $, S, f - R, H + $, S, f - R, H, S, f, H, S, f, H, S, f, H, S - R, f, H + $, S - R, f, H + $, S - R, f, H + $, S, f, H, S]), A = [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0], o && g._17O(T, l, X, r, Hb, b, A, [f, q, S, f, q, S + j, f, q - R, S + j, f, q - R, S + j, f, q - R, S, f, q, S, f, q - R, S, f - R, q - R, S, f - R, q - R, S + j, f - R, q - R, S + j, f, q - R, S + j, f, q - R, S]), H = S + j, m && g._17O(T, l, X, r, Cb, Q, A, [f, q, H, f, q, H + $, f, q - R, H + $, f, q - R, H + $, f, q - R, H, f, q, H, f, q - R, H, f - R, q - R, H, f - R, q - R, H + $, f - R, q - R, H + $, f, q - R, H + $, f, q - R, H]), H += $, t && g._17O(T, l, X, r, Ak, b, A, [f, q, H, f, q, H + $, f, q - R, H + $, f, q - R, H + $, f, q - R, H, f, q, H, f, q - R, H, f - R, q - R, H, f - R, q - R, H + $, f - R, q - R, H + $, f, q - R, H + $, f, q - R, H])
                }
            },
            _17O: function (C, A, S, Q, r, M, g, e) {
                var R = this.gv._buffer;
                ms(C, A, Q, !0, S, r), Kl(C, A, h, !0, h, !0, h, !1), cs(C, A.uDiffuse, M), Ic(C, R.vs, new Ol(e), A.aPosition), Ic(C, R.ns, new Ol(g), A.aNormal), $h(C), Qp(C, 0, 12), Si(C), Qd(C, A)
            }
        });
        var Lq = k.Raycaster = function (N) {
            this.gv = N, this.maxTriangleTest = 1 / 0
        };
        If("Raycaster", x, {
            intersect: function (V) {
                var d = this,
                    D = d.gv,
                    $ = D.getDataAt(V);
                return $ ? d.intersectObject(V, $) : null
            },
            intersectObjects: function (o, Q, F) {
                var Y, P, c, H, q = this,
                    t = 1 / 0,
                    x = o.origin || (new Go).fromArray(q.gv.getEye()),
                    v = q.maxTriangleTest,
                    L = [];
                return Q.forEach(function (E) {
                    F && F(E) === !1 || E.s("intersect") !== !1 && L.push(E)
                }), L.sort(function (e, N) {
                    return x.distanceToSquared2(e.p3()) - x.distanceToSquared2(N.p3())
                }), q.countTriangles = 0, L.forEach(function (B) {
                    q.countTriangles > v || (Y = q.intersectObject(o, B), Y && (P = x.distanceToSquared(Y.world), t > P && (c = B, H = Y, t = P)))
                }), q.countTriangles = 0, {
                    data: c,
                    intersect: H
                }
            },
            intersectObject: function (F, S) {
                if (F instanceof qe) return this._intersectObjectImpl(F, S);
                var G, J, e = this,
                    m = e.gv;
                J = m.unproject(F);
                var H = m.getEye();
                m.isOrtho() ? (G = on(m.getCenter(), H), G[0] += G[0], G[1] += G[1], G[2] += G[2]) : G = H, G = new Go(G);
                var U = new Go(J).sub(G).normalize(),
                    E = new k.Math.Ray(G, U);
                return e._intersectObjectImpl(E, S)
            },
            _intersectObjectImpl: function () {
                function c() {
                    var e = new Go;
                    return e.subVectors(M, E), f.subVectors(L, E), e.cross(f).normalize(), e
                }

                function w(u, M, Z, d, q, w, f) {
                    return jj.barycoordFromPoint(u, M, Z, d, i), q.multiplyScalar(i.x), w.multiplyScalar(i.y), f.multiplyScalar(i.z), q.add(w).add(f), q.clone()
                }
                var z = new Al,
                    K = new Al,
                    B = new qe,
                    h = new Go,
                    d = new Go,
                    $ = new Go,
                    t = new Go,
                    x = new Go,
                    L = new Go,
                    E = new Go,
                    M = new Go,
                    r = new Pi,
                    j = new Pi,
                    U = new Pi,
                    f = new Go,
                    A = {
                        vs: Wi,
                        is: sp,
                        uv: mi
                    },
                    i = new Go;
                return function (Y, Z) {
                    var P = this.gv.getData3dUI(Z),
                        Q = Z.mat || P.mat;
                    if (Q) {
                        z.fromArray(Q), K.getInverse(z), B.copy(Y).applyMatrix4(K);
                        var H, G, o = "body",
                            i = P.shapeModel;
                        if (i || (i = Sb(P)), i || (Z instanceof k.Node && !(Z instanceof k.Shape) ? (H = !0, i = A) : (G = !0, i = [P.left, P.front, P.right, P.back, P.top, P.bottom])), !i) return console.log("Can not find shape model."), null;
                        nj(i) || (i = [i]);
                        var n, V, J, T, l, S, m, N, f, O, X, F, C, q, g, e, u = 1 / 0,
                            b = ["", "top_", "bottom_"],
                            D = !1;
                        for (n = 0, V = i.length; V > n; n++)
                            if (C = i[n])
                                for (J = 0, T = b.length; T > J; J++)
                                    if (q = b[J], m = C[q + "vs"], N = C[q + "is"], f = C[q + "uv"] || C[q + "tuv"], m) {
                                        if (g = C[q + "boundingBox"]) {
                                            var X = B.intersectBox(g);
                                            if (!X) continue;
                                            if (B.origin.distanceTo(X) > u) continue;
                                            e = !1
                                        } else C[q + "boundingBox"] = g = new k.Math.Box3, e = !0;
                                        for (l = 0, S = N ? N.length : m.length / 3; S > l; l += 3) this.countTriangles++, N ? (d.fromArray(m, 3 * N[l]), $.fromArray(m, 3 * N[l + 1]), t.fromArray(m, 3 * N[l + 2])) : (d.fromArray(m, 3 * l), $.fromArray(m, 3 * (l + 1)), t.fromArray(m, 3 * (l + 2))), e && (g.expandByPoint(d), g.expandByPoint($), g.expandByPoint(t)), O = B.intersectTriangle(d, $, t, !0, h), O && (F = B.origin.distanceTo(O), u > F && (u = F, x.copy(O), L.copy(d), E.copy($), M.copy(t), "" !== q ? o = q.slice(0, -1) : H ? o = qi[Math.floor(l / 6)] : G && (o = qi[n]), f && (D = !0, N ? (r.fromArray(f, 2 * N[l]), j.fromArray(f, 2 * N[l + 1]), U.fromArray(f, 2 * N[l + 2])) : (r.fromArray(f, 2 * l), j.fromArray(f, 2 * (l + 1)), U.fromArray(f, 2 * (l + 2))))))
                                    }
                        if (!isFinite(u)) return null;
                        var a, W = x.clone().applyMatrix4(z);
                        D && (a = w(x, L, E, M, r, j, U));
                        var I = c(L, E, M),
                            y = c(L.applyMatrix4(z), E.applyMatrix4(z), M.applyMatrix4(z)),
                            R = B.direction.dot(I);
                        return R > 0 && (I.multiplyScalar(-1), y.multiplyScalar(-1)), {
                            world: W,
                            local: x.clone(),
                            worldNormal: y,
                            normal: I,
                            uv: a,
                            part: o
                        }
                    }
                }
            }()
        });
        var Fn = function (a, R) {
            this.gv = a, this.s = function (w, i, m) {
                return i == h && (i = m), i == h ? R.getStyle(w) : ze(i, R, a)
            }, this.data = R
        };
        zc(Fn, x, {
            I3d: !0,
            ms_icons: 1,
            _iv: !0,
            iv: function () {
                this._iv = !0
            },
            _42: function (J, O, v, d) {
                var j = this,
                    b = j.data;
                if (!(b instanceof tf)) {
                    var N, X, z, I, U, l, Z, W = j.gv,
                        Q = b._id,
                        s = j.s("shape3d.alwaysOnTop") ? null : j.s("batch"),
                        D = W._batchIndexMap,
                        x = W._batchModelMap,
                        K = W.isSelectable(b),
                        n = W.getBrightness(b),
                        i = n != h && 1 !== n;
                    if (j.needValidate(J)) {
                        if (z = ag(D, x, b, s), j.validate(z, s ? kr[s] || di : h), z && (I = D[Q], U = I.size = z.vs.length / 3 - I.begin, Z = z.rs))
                            for (n = i ? n : 1, l = 0; U > l; l++) Z.push(n);
                        if (Cc(b)) {
                            var g = W.getWireframeGeometry(b);
                            if (g) zq(W, b, g);
                            else {
                                var y = W.getWireframe(b);
                                y && zq(W, b, y)
                            }
                        }
                        j.labelInfo = j.label2Info = j.noteInfo = j.note2Info = j._38o = h, j._24O(Qk, "getLabel"), j._24O(_g, "getLabel2"), j._26O(zm, "getNote"), j._26O(Uj, "getNote2"), j._15O(), j.interactiveInfo = W.isInteractive(b) ? {} : h, j._iv = !1
                    }
                    i && cs(J, O.uBrightness, n), cs(J, O.uAlphaTest, j.s("alphaTest")), cs(J, O.uUseEnvMap, b.s("envmap") ? !0 : !1), cs(J, O.uReflectivity, b.s("envmap") || .01), X = ms(J, O, v, K, b, id), X && (vc(X, D[Q], x), vc(X, W._polylineIndexMap[Q], W._polylineModelMap), vc(X, W._wireframeIndexMap[Q], W._wireframeModelMap)), D[Q] || j._80o(J, O, d), W.isLabelVisible(b) && ((N = j.labelInfo) && (ms(J, O, v, K, b, Qk), j._28O(N, Qk, d)), (N = j.label2Info) && (ms(J, O, v, K, b, _g), j._28O(N, _g, d))), W.isNoteVisible(b) && ((N = j.noteInfo) && (ms(J, O, v, K, b, zm), j._29O(N, zm, d)), (N = j.note2Info) && (ms(J, O, v, K, b, Uj), j._29O(N, Uj, d))), (N = j._38o) && j._99O(J, O, N, v, K, d), i && cs(J, O.uBrightness, 1)
                }
            },
            needValidate: function () {
                return this._iv
            },
            validate: function () {},
            _16O: function () {
                return vj
            },
            _80o: function () {},
            dispose: function () {},
            _calcAnchorMat: function (I) {
                if (I.hasOwnProperty("_anchor") || I.hasOwnProperty("_anchorElevation")) {
                    var Y = I.getAnchor3d(),
                        c = {
                            x: Y.x - .5,
                            y: Y.y - .5,
                            z: Y.z - .5
                        },
                        d = Ip();
                    return Xj(d, [-c.x, -c.y, -c.z]), d
                }
            },
            getBodyColor: function (z) {
                var y = this.data,
                    w = this.gv.getBodyColor(y);
                return w ? w : z ? y.getStyle(z) : h
            },
            _24O: function (v, o) {
                var D = this,
                    A = D.data,
                    m = D.gv,
                    X = D.s,
                    i = m[o](A);
                if (i != h) {
                    var d = X(v + ".scale"),
                        M = X(v + ".max"),
                        T = D[v + "Info"] = {
                            label: i,
                            textureScale: X(v + ".texture.scale"),
                            color: m[o + "Color"](A),
                            font: X(v + ".font"),
                            align: X(v + ".align"),
                            background: m[o + "Background"](A)
                        },
                        K = T.rect = po(T, i);
                    M > 0 && M < K.width && (T.labelWidth = K.width, K.width = M), K.x = K.y = 0, K.width *= d, K.height *= d, T.mat = D._16O(X(v + ".autorotate"), X(v + ".position"), K, X(v + ".face"), X(v + ".t3"), X(v + ".r3"), X(v + ".rotationMode"));
                    var E = K.width / 2,
                        a = K.height / 2;
                    T.vs = new Ol([-E, a, 0, -E, -a, 0, E, -a, 0, E, a, 0]), K.width /= d, K.height /= d
                }
            },
            _26O: function (P, U) {
                var g = this,
                    p = g.data,
                    o = g.gv,
                    f = g.s,
                    G = o[U](p);
                if (G != h) {
                    var m = f(P + ".scale"),
                        X = this[P + "Info"] = {
                            note: G,
                            textureScale: f(P + ".texture.scale"),
                            expanded: f(P + ".expanded"),
                            font: f(P + ".font"),
                            color: f(P + ".color"),
                            align: f(P + ".align"),
                            borderWidth: f(P + ".border.width"),
                            borderColor: f(P + ".border.color"),
                            background: o[U + "Background"](p)
                        };
                    if (X.expanded) {
                        var k = f(P + ".max"),
                            b = po(X, G);
                        b.width += 6, b.height += 2, k > 0 && k < b.width && (X.labelWidth = b.width, b.width = k);
                        var Y = {
                            x: -b.width / 2,
                            y: -8 - b.height,
                            width: b.width,
                            height: b.height + 8
                        }
                    } else Y = {
                        x: -6,
                        y: -18,
                        width: 12,
                        height: 18
                    };
                    X.mat = g._16O(f(P + ".autorotate"), f(P + ".position"), h, f(P + ".face"), f(P + ".t3"), f(P + ".r3"), f(P + ".rotationMode")), X.rect = Y, 1 !== m && (Y = tc(Y), Y.x *= m, Y.height *= m, Y.y = -Y.height, Y.width *= m);
                    var D = Y.x,
                        l = Y.y,
                        Q = Y.width,
                        I = Y.height;
                    X.vs = new Ol([D, -l, 0, D, -l - I, 0, D + Q, -l - I, 0, D + Q, -l, 0])
                }
            },
            _28O: function (u, o, x) {
                if (x(this.s(o + ".transparent"))) {
                    var W = u.rect,
                        q = u.textureScale,
                        $ = W.width * q,
                        n = W.height * q;
                    if ($ >= 1 && n >= 1) {
                        var J = Qj($, n);
                        1 !== q && (J.translate(J, W.x, W.y), J.scale(q, q), J.translate(J, -W.x, -W.y)), pj(J, u), J.restore(), zl(this, o, u.mat, u.vs, !0)
                    }
                }
            },
            _29O: function (J, f, k) {
                if (k(this.s(f + ".transparent"))) {
                    var l = J.rect,
                        s = J.textureScale,
                        d = l.x,
                        j = l.y,
                        _ = l.width * s,
                        I = l.height * s;
                    if (_ >= 1 && I >= 1) {
                        l.x = l.y = 0;
                        var M = Qj(_, I);
                        1 !== s && M.scale(s, s), Te(M, J), M.restore(), l.x = d, l.y = j, zl(this, f, J.mat, J.vs, !1)
                    }
                }
            },
            _99O: function (S, y, W, w, Q, F) {
                if (W) {
                    var G = this,
                        $ = G.gv,
                        a = G.data,
                        n = $._buffer,
                        P = $._1O,
                        j = W.icons;
                    for (var E in j) {
                        var C = j[E],
                            M = W.rects[E];
                        if (M && F(ze(C.transparent, a, $))) {
                            ms(S, y, w, Q, a, E);
                            var t = ze(C.shape3d, a, $),
                                R = t ? [t] : ze(C.names, a, $),
                                N = R ? R.length : 0,
                                k = ze(C.textureScale, a, $) || 1,
                                u = ze(C.light, a, $);
                            u == h && (u = t ? !0 : !1), Kl(S, y, ze(C.blend, a, $), u, ze(C.opacity, a, $), ze(C.reverseFlip, a, $), ze(C.reverseColor, a, $), ze(C.reverseCull, a, $));
                            for (var s = 0; N > s; s++) {
                                var m = R[s],
                                    Z = M[s];
                                if (mm(G, Z.mat), t) uf($, a, Sb(G, t), G);
                                else {
                                    var Y = Qn(m);
                                    if (Y) {
                                        var r = Z.width * k,
                                            v = Z.height * k;
                                        if (r >= 1 && v >= 1) {
                                            var T = Qj(r, v);
                                            zk(T, Y, ze(C.stretch, a, $), 0, 0, r, v, a, $), T.restore(), bb(S, op, P), $h(S, y, P, ze(C.discardSelectable, a, $), n.uv, pc), Ic(S, n.vs, Z.vs, y.aPosition), om(S, n.ns, Wg, y.aNormal), Hd(S, n.is, us), Ho(S, 0, us.length), Si(S, y, P)
                                        }
                                    }
                                }
                                sn($)
                            }
                            Qd(S, y)
                        }
                    }
                }
            }
        });
        var Zj = function (E, z) {
            cj(Zj, this, [E, z])
        };
        zc(Zj, Fn, {
            _16O: function (L, h, b, F, J, P, n, g, o) {
                var M = this.data,
                    d = M.getFinalScale3d(),
                    c = Dr(h, d, b, F, g, o);
                if (M.hasOwnProperty("_anchor") || M.hasOwnProperty("_anchorElevation")) {
                    var e = M.getAnchor3d();
                    c[0] -= (e.x - .5) * d[0], c[1] -= (e.y - .5) * d[1], c[2] -= (e.z - .5) * d[2]
                }
                return dd(Ip(), c, M.p3(), F, J, P, n, L, M.getFinalRotation3d(), M.getRotationMode())
            },
            clear: function () {
                var y = this;
                y.faceMat = y.mat = y.shapeModel = y.left = y.right = y.front = y.back = y.top = y.bottom = y.csg = h
            },
            needValidate: function (h) {
                if (this._iv) return this._validateFrameId = h._renderInfo.frame, !0;
                if (this.s("shape3d.autorotate") || this.s("shape3d.fixSizeOnScreen") || this.s("hide.overlapping.group")) {
                    var r = h._renderInfo.frame;
                    if (this._validateFrameId !== r) return this._validateFrameId = r, !0
                }
                return !1
            },
            validate: function (K, V) {
                var W = this,
                    r = W.gv,
                    M = W.data,
                    O = Sb(W);
                W._updateAutoRotation(), W._updateFixSize2d(), W._updateOverlapping(), (this.s("shape3d.autorotate") || this.s("shape3d.fixSizeOnScreen")) && (ci(r, M, "_wireframeModelMap", "_wireframeIndexMap"), ci(r, M, "_wireframeModelMapSwap", "_wireframeIndexMapSwap"));
                var F = zh(M, r.getMat(M), O ? W.s("shape3d.scaleable") : !0),
                    z = W._calcAnchorMat(M);
                if (z && sg(F, F, z), M.mat = F, W.clear(), K) {
                    var i = [];
                    O ? Lr(r, M, O, W, W.getBodyColor(), [F], K, i) : (zf(r, M, K, V, F, ul, i, ko), zf(r, M, K, V, F, sb, i, Dk), zf(r, M, K, V, F, $b, i, kq), zf(r, M, K, V, F, Id, i, um), zf(r, M, K, V, F, fg, i, $o), zf(r, M, K, V, F, Hc, i, mq)), i.length && (ug(K.vs, i), ug(K.ns, Xp(i)))
                } else W.mat = F, (W.shapeModel = O) || (W._cubeUvs = null, W.vf(ul, 0), W.vf(sb, 16), W.vf(fg, 8), W.vf(Hc, 24), W.vf($b, 32), W.vf(Id, 40))
            },
            _updateAutoRotation: function () {
                var e = new Wo;
                return function () {
                    var E = this,
                        b = E.data,
                        h = E.s("shape3d.autorotate");
                    if (!h) return b._dynamicRotation && delete b._dynamicRotation, void 0;
                    var F, H = E.gv;
                    F = "string" == typeof h ? [h.indexOf("x") < 0 ? H._eye[0] : H._center[0], h.indexOf("y") < 0 ? H._eye[1] : H._center[1], h.indexOf("z") < 0 ? H._eye[2] : H._center[2]] : H._eye;
                    var P = H._center,
                        g = b.p3(),
                        Q = Pr([g[0] + F[0] - P[0], g[1] + F[1] - P[1], g[2] + F[2] - P[2]], g, H._up),
                        D = b.r3();
                    e.set(0, 0, 0, b.getRotationMode(), !0).setFromRotationMatrix(Q), Math.abs(D[0] - e.x) < 1e-5 && Math.abs(D[1] - e.y) < 1e-5 && Math.abs(D[2] - e.z) < 1e-5 || (b._dynamicRotation = [e.x, e.y, e.z])
                }
            }(),
            _updateFixSize2d: function () {
                var A = this,
                    r = A.data,
                    J = A.s("shape3d.fixSizeOnScreen");
                if (!J) return r._dynamicScale3d && delete r._dynamicScale3d, void 0;
                var Z = A.gv;
                r.getFinalScale3d();
                var l = zh(r, Z.getMat(r)),
                    e = Br([0, 0, 0], l),
                    p = Z.toViewPosition(e);
                if (!isNaN(p.x) && !isNaN(p.y)) {
                    var d = Br([1, 0, 0], l),
                        t = Z.toViewPosition(d),
                        c = Br([0, 1, 0], l),
                        g = Z.toViewPosition(c),
                        b = t.x - p.x,
                        T = g.y - p.y;
                    if (b && T) {
                        var B = r._dynamicScale3d || [1, 1, 1],
                            I = Qn(r.s("shape3d.image")),
                            X = J[0] > 0 ? J[0] : I ? Df(I, A) : 20,
                            i = J[1] > 0 ? J[1] : I ? Dd(I, A) : 20,
                            n = Math.abs(b / X),
                            R = Math.abs(T / i);
                        Math.abs(n - 1) < .001 && Math.abs(R - 1) < .001 || (r._dynamicScale3d = [B[0] / n, B[1] / R, B[2]])
                    }
                }
            },
            _updateOverlapping: function () {
                var V = this,
                    n = V.s("hide.overlapping.group");
                if (!n) return V._rectOverlapping && (V._rectOverlapping = p), void 0;
                var r, v, W, X = V.gv,
                    e = V.data,
                    S = zh(e, X.getMat(e)),
                    $ = 1 / 0,
                    O = 1 / 0,
                    J = -1 / 0,
                    t = -1 / 0,
                    F = e.getAnchor3d(),
                    z = F.x,
                    g = F.y,
                    l = F.z;
                for (r = 0; 8 > r; r++) {
                    if (v = Br([(r >> 2) - z, (1 & r >> 1) - g, (1 & r) - l], S), W = X.toViewPosition(v), isNaN(W.x) || isNaN(W.y)) return;
                    $ = Math.min($, W.x), J = Math.max(J, W.x), O = Math.min(O, W.y), t = Math.max(t, W.y)
                }
                var _ = {
                    x: $,
                    y: O,
                    w: J - $,
                    h: t - O
                };
                V._rectOverlapping = X.overlappingBox.isOverlapping(n, _)
            },
            getVectorDynamicSize: function () {
                var t, x = this,
                    g = x.s("shape3d"),
                    p = x.data;
                if ("billboard" === g || "plane" === g || (t = p._currentCubeElementId) != h) {
                    var y, k, F = x.gv,
                        N = zh(p, F.getMat(p)),
                        j = p.getAnchor3d(),
                        q = .5 - j.x,
                        _ = .5 - j.y,
                        A = .5 - j.z,
                        S = x.s("shape3d.vector.dynamic.maxsize"),
                        E = function (v, p) {
                            v[0] += q, v[1] += _, v[2] += A, p[0] += q, p[1] += _, p[2] += A;
                            var R = F.toViewPosition(Br(v, N)),
                                K = F.toViewPosition(Br(p, N)),
                                k = R.x - K.x,
                                Y = R.y - K.y;
                            return Math.min(S, Math.sqrt(k * k + Y * Y))
                        };
                    if ("billboard" === g) y = E([-.5, 0, 0], [.5, 0, 0]), k = E([0, -.5, 0], [0, .5, 0]);
                    else if ("plane" === g) y = E([-.5, 0, 0], [.5, 0, 0]), k = E([0, 0, -.5], [0, 0, .5]);
                    else if (p._currentCubeElementId != h) {
                        var s = 3 * sp[t + 1],
                            X = 3 * sp[t],
                            m = 3 * sp[t + 2];
                        y = E([Wi[s], Wi[s + 1], Wi[s + 2]], [Wi[m], Wi[m + 1], Wi[m + 2]]), k = E([Wi[s], Wi[s + 1], Wi[s + 2]], [Wi[X], Wi[X + 1], Wi[X + 2]])
                    }
                    return [y, k]
                }
            },
            getCachedTexture: function () {
                var t = this,
                    K = t.data,
                    _ = K._currentCubeElementId;
                return _ != h ? t._cubeCachedImage ? t._cubeCachedImage[_] : null : t._shape3dCachedImage
            },
            setCachedTexture: function (C) {
                var T = this,
                    X = T.data,
                    I = X._currentCubeElementId;
                if (I != h) {
                    if (!T._cubeCachedImage) return T._cubeCachedImage = {};
                    T._cubeCachedImage[I] = C
                } else T._shape3dCachedImage = C
            },
            invalidateCachedTexture: function (_) {
                var z, l, t, L = this;
                if ((t = L._shape3dCachedImage) && (_.deleteTexture(t), L._shape3dCachedImage = null), l = L._cubeCachedImage) {
                    for (z in l) _.deleteTexture(l[z]);
                    L._cubeCachedImage = null
                }
            },
            vf: function (l, K) {
                var y = this;
                if (y.gv.getFaceVisible(y.data, l)) {
                    var L = Nk(y, l);
                    L.mat && (y.faceMat = !0);
                    var q = L.uv;
                    if (q) {
                        var Q = y._cubeUvs;
                        Q || (Q = y._cubeUvs = new Ol([0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0]));
                        for (var V = 0; 8 > V; V++) Q[K + V] = q[V]
                    }
                    return L
                }
            },
            _80o: function (c, f, q) {
                var W = this;
                if (W._rectOverlapping) return !0;
                var D = W.gv,
                    S = W.data,
                    s = D._cube,
                    k = W.shapeModel;
                hs(D, W.mat), k ? uf(D, S, k, W, W.getBodyColor(), q) : (Ic(c, s.vs, h, f.aPosition), Ic(c, s.ns, h, f.aNormal), Op(c, s.is), W._18O(c, f, W.left, 0, q), W._18O(c, f, W.front, 6, q), W._18O(c, f, W.right, 12, q), W._18O(c, f, W.back, 18, q), W._18O(c, f, W.top, 24, q), W._18O(c, f, W.bottom, 30, q)), sn(D), W.faceMat && (W._18O(c, f, W.left, 0, q, !0), W._18O(c, f, W.front, 6, q, !0), W._18O(c, f, W.right, 12, q, !0), W._18O(c, f, W.back, 18, q, !0), W._18O(c, f, W.top, 24, q, !0), W._18O(c, f, W.bottom, 30, q, !0))
            },
            _18O: function (W, u, X, z, T, c) {
                if (X) {
                    if (!T(X.transparent)) return;
                    if (c && !X.mat || !c && X.mat) return;
                    var k = this.data.s("polygonOffset");
                    k && aj(W, k), c && hs(this.gv, X.mat);
                    var J = this,
                        g = J.data;
                    g._currentCubeElementId = z;
                    var t = J.gv,
                        q = t.getTexture(X.texture, g),
                        F = X.uv,
                        p = X.uvScale,
                        A = X.uvOffset,
                        L = X.discardSelectable;
                    q ? F ? $h(W, u, q, L, t._buffer.uv, J._cubeUvs, A, p) : $h(W, u, q, L, t._cube.uv, h, A, p) : $h(W), Kl(W, u, X.blend, X.light, X.opacity, X.reverseFlip, X.reverseColor, X.reverseCull), cs(W, u.uDiffuse, X.color || C["color.empty"]), Ho(W, z, 6), Qd(W, u), Si(W, u, q), c && sn(t), k && Og(W), g._currentCubeElementId = null
                }
            }
        });
        var Uh = function (r, D) {
            cj(Uh, this, [r, D])
        };
        zc(Uh, Fn, {
            _25Q: 1,
            validate: function (H) {
                var W = this,
                    B = W.gv,
                    K = W.data,
                    b = W.s,
                    m = b("edge.width"),
                    s = K._40I,
                    J = K._41I;
                if (W.shapeModel = W.info = h, s && J) {
                    var L, X, $, _, k, q, p, Q, R, x, z = K.isLooped(),
                        v = b(Oo),
                        U = f.getEdgeType(v);
                    if (U) {
                        var F = U(K, hd(W, B, K, z, v), B, W._19Q);
                        if (!F.points || F.points.isEmpty()) return;
                        q = W.info = {}, p = F.segments, k = F.points, Q = k.size();
                        for (var I = s.getElevation(), y = J.getElevation(), w = 0; Q > w; w++) {
                            var N = k.get(w);
                            N.e == h && (N.e = I + (y - I) * w / (Q - 1))
                        }
                        R = oc(k.get(0)), x = oc(k.get(Q - 1));
                        var D = Q % 2;
                        0 === D ? (q.c1 = oc(k.get(Q / 2 - 1)), q.c2 = oc(k.get(Q / 2))) : q.p3 = oc(k.get((Q - D) / 2)), q.s1 = R, q.s2 = oc(k.get(1)), q.t1 = oc(k.get(Q - 2)), q.t2 = x
                    } else {
                        k = new vf, q = W.info = {};
                        var E = b("edge.offset"),
                            Z = b("edge.center"),
                            C = b("edge.source.t3"),
                            l = b("edge.target.t3"),
                            i = s.p3(),
                            c = J.p3();
                        if (C && (i[0] += C[0], i[1] += C[1], i[2] += C[2]), l && (c[0] += l[0], c[1] += l[1], c[2] += l[2]), v === gs) {
                            p = b("edge.segments");
                            var u = q.points = b(Wr) || il;
                            if (Q = u.size()) {
                                R = oc(u.get(0)), x = oc(u.get(Q - 1)), !Z && E && ($ = on(R, i, !0), E = j(E, Me(i, R)), i = [i[0] + $[0] * E, i[1] + $[1] * E, i[2] + $[2] * E], $ = on(c, x, !0), E = j(E, Me(x, c)), c = [c[0] - $[0] * E, c[1] - $[1] * E, c[2] - $[2] * E]);
                                var D = Q % 2;
                                0 === D ? (L = oc(u.get(Q / 2 - 1)), X = oc(u.get(Q / 2))) : q.p3 = oc(u.get((Q - D) / 2)), q.s1 = i, q.s2 = R, q.t1 = x, q.t2 = c
                            } else !Z && E && ($ = on(c, i, !0), _ = Me(i, c), E = Sk(E, _), i = [i[0] + $[0] * E, i[1] + $[1] * E, i[2] + $[2] * E], c = [c[0] - $[0] * E, c[1] - $[1] * E, c[2] - $[2] * E]), L = i, X = c;
                            k.add({
                                x: i[0],
                                y: i[2],
                                e: i[1]
                            }), k.addAll(u), k.add({
                                x: c[0],
                                y: c[2],
                                e: c[1]
                            })
                        } else {
                            var G = hd(W, B, K, z, v);
                            if (W._19Q || (G = -G), z) {
                                var V = i[0],
                                    n = i[1],
                                    A = i[2],
                                    O = s.getTall() / 2 + G;
                                L = [V - G, n + O, A], X = [V + G, n + O, A], k.add({
                                    x: V - G,
                                    y: A,
                                    e: n
                                }), k.add({
                                    x: V - G,
                                    y: A,
                                    e: n + O
                                }), k.add({
                                    x: V + G,
                                    y: A,
                                    e: n + O
                                }), k.add({
                                    x: V + G,
                                    y: A,
                                    e: n
                                })
                            } else {
                                $ = on(c, i, !0), _ = Me(i, c);
                                var o = {
                                        x: i[0],
                                        y: i[2]
                                    },
                                    d = {
                                        x: c[0],
                                        y: c[2]
                                    },
                                    Y = Ze(h, o, d, G),
                                    t = Y.x - o.x,
                                    M = Y.y - o.y;
                                E = Sk(E, _), $[0] *= E, $[1] *= E, $[2] *= E, L = [i[0] + $[0] + t, i[1] + $[1], i[2] + $[2] + M], X = [c[0] - $[0] + t, c[1] - $[1], c[2] - $[2] + M], Z ? (k.add({
                                    x: i[0],
                                    y: i[2],
                                    e: i[1]
                                }), k.add({
                                    x: L[0],
                                    y: L[2],
                                    e: L[1]
                                }), k.add({
                                    x: X[0],
                                    y: X[2],
                                    e: X[1]
                                }), k.add({
                                    x: c[0],
                                    y: c[2],
                                    e: c[1]
                                })) : (k.add({
                                    x: L[0],
                                    y: L[2],
                                    e: L[1]
                                }), k.add({
                                    x: X[0],
                                    y: X[2],
                                    e: X[1]
                                }))
                            }
                        }
                        q.c1 = L, q.c2 = X
                    }
                    q.list = b(fs) === sh ? W.createTubeModel(k, p, m / 2, H) : W.createLineModel(k, p, m, "edge", "edge.dash")
                }
            }
        });
        var Yf = function (Q, H) {
            cj(Yf, this, [Q, H])
        };
        zc(Yf, Zj, {
            _80o: function (r, n, Z) {
                var A = this,
                    E = A.gv,
                    Q = A.shapeModel;
                hs(E, A.mat), Q ? uf(E, A.data, Q, A, A.getBodyColor(), Z) : (Fp(A, r, n, A.left, Z), Fp(A, r, n, A.front, Z), Fp(A, r, n, A.right, Z), Fp(A, r, n, A.back, Z), Fp(A, r, n, A.top, Z), Fp(A, r, n, A.bottom, Z)), sn(E)
            },
            validate: function (F, t) {
                var r, J, M = this,
                    g = M.s,
                    O = M.data,
                    L = O.p3(),
                    l = O._thickness / 2,
                    A = O.isClosePath(),
                    I = O.getPoints(),
                    H = O.getSegments(),
                    C = g(Hj),
                    U = F && F.uv;
                if (M.clear(), 0 > l) J = M.shapeModel = Mi(I, H, g(gp), g(db), C, g(Vo), O.getTall(), O.getShapeElevation(), A), g(pl) ? g("shape3d.image") || delete J.uv : (delete J.vs, delete J.ns, delete J.uv), g("shape3d.top.image") || delete J.top_uv, g("shape3d.bottom.image") || delete J.bottom_uv;
                else if (g(fs) === sh) r = fh(I, H, C, A), J = M.shapeModel = {
                    vs: []
                }, g("shape3d.image") && (J.uv = [], J.sum = g(Vo) || Xh(r) || 1, J.len = 0), g(gp) && !A && (J.top_vs = [], g("shape3d.top.image") && (J.top_uv = [])), g(db) && !A && (J.bottom_vs = [], g("shape3d.bottom.image") && (J.bottom_uv = [])), M._12O(r, l);
                else {
                    var R, $, w, c, m, f, d, G, _, p;
                    if (r = fh(I, H, C, A), m = M.vf(fg, U, !1, t), l && (f = M.vf(Hc, U, !1, t), d = A ? h : M.vf(ul, U, !1, t), G = A ? h : M.vf(sb, U, !1, t), _ = M.vf($b, U, !1, t), p = M.vf(Id, U, !1, t)), l) {
                        for (var u = 0, e = r.length; e > u; u++) r[u] = M._tryRemoveBezierPoints(r[u], l);
                        M._12O(r, l)
                    } else m && r.forEach(function (B) {
                        if (c = B.length, c > 0)
                            for (R = B[0], w = 1; c > w; w++) $ = B[w], M.addV(m.vs, R, $), R = $
                    });
                    M._20Q(r), F || (m && (m.ns = Xp(m.vs), Se(m, "vs"), Se(m, Cr)), l && (f && (f.ns = Xp(f.vs), Se(f, "vs"), Se(f, Cr)), d && (d.ns = Xp(d.vs), Se(d, "vs"), Se(d, Cr)), G && (G.ns = Xp(G.vs), Se(G, "vs"), Se(G, Cr)), _ && (_.ns = Xp(_.vs), Se(_, "vs"), Se(_, Cr)), p && (p.ns = Xp(p.vs), Se(p, "vs"), Se(p, Cr))))
                }
                var n = M.mat = Ip();
                Xj(n, L), zb(n, O.getFinalRotation3d(), O.getRotationMode());
                var T = O.getScale3d(),
                    B = O._dynamicScale3d;
                B && (T[0] *= B[0], T[1] *= B[1], T[2] *= B[2]), br(n, T), Xj(n, Bc(L)), F && (sl(M, n, F, J), M.clear())
            },
            _20Q: function (G) {
                var t, O, l, K, f, X, B, y = this,
                    N = y.front,
                    d = y.back,
                    C = y.top,
                    U = y.bottom,
                    W = N ? N.tuv : h,
                    q = d ? d.tuv : h,
                    i = C ? C.tuv : h,
                    Q = U ? U.tuv : h,
                    o = 0;
                (W || q || i || Q) && (t = y.s(Vo) || Xh(G) || 1, G.forEach(function (Q) {
                    if (O = Q.length, O > 0)
                        for (X = Q[0], l = 1; O > l; l++) B = Q[l], K = o / t, o += Me(X, B), f = o / t, y._14O(N, K, f), y._14O(d, 1 - f, 1 - K), y._14O(C, K, f), y._14O(U, K, f), X = B
                }))
            },
            _14O: function (K, b, J) {
                if (K) {
                    var t = K.uv,
                        E = K.tuv;
                    if (E) {
                        if (t) var c = t[0] + (t[6] - t[0]) * b,
                            x = t[1] + (t[7] - t[1]) * b,
                            q = t[2] + (t[4] - t[2]) * b,
                            A = t[3] + (t[5] - t[3]) * b,
                            T = t[2] + (t[4] - t[2]) * J,
                            r = t[3] + (t[5] - t[3]) * J,
                            L = t[0] + (t[6] - t[0]) * J,
                            n = t[1] + (t[7] - t[1]) * J;
                        else c = b, x = 0, q = b, A = 1, T = J, r = 1, L = J, n = 0;
                        E.push(q, A, T, r, L, n, L, n, c, x, q, A)
                    }
                }
            },
            _13O: function (h) {
                var J = h.uv,
                    R = h.tuv;
                R && (J ? R.push(J[2], J[3], J[4], J[5], J[6], J[7], J[6], J[7], J[0], J[1], J[2], J[3]) : R.push(0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1))
            },
            _tryRemoveBezierPoints: function (c, m) {
                var T = c.length;
                if (4 > T) return c;
                var D, l, X, o, x, w, g = !1,
                    f = function (i) {
                        return c[i]
                    },
                    N = function (g) {
                        return c[T - 1 - g]
                    };
                for (x = 0; 1 >= x; x++)
                    for (w = x ? N : f, l = w(0), X = w(1), D = 2; T - 1 > D; D++)
                        if (o = w(D), !o.remove)
                            if (o.b) {
                                var a = Ze(l, X, o, m);
                                a.adjust ? (o.remove = !0, g = !0) : (l = X, X = o)
                            } else l = X, X = o;
                if (!g) return c;
                var R = [];
                for (D = 0; T > D; D++) c[D].remove || R.push(c[D]);
                return R
            },
            _12O: function (L, N) {
                var b, f, k, o, F, W = this;
                L.forEach(function (z) {
                    if (F = z.length, F > 0)
                        for (b = {
                            p: z[0],
                            n: !0
                        }, o = 1; F > o; o++) f = z[o], k = F - 1 > o ? z[o + 1] : h, W.addPoint(b, f, k, N, z)
                })
            },
            addPoint: function (B, m, p, M, e) {
                var r, T, o, n, J, I, V, Z, y, C = this,
                    _ = B.p,
                    N = B.f,
                    t = B.b,
                    c = C.s("shape3d.side") || Sp,
                    Q = C.s("shape3d.start.angle"),
                    b = C.s("shape3d.sweep.angle"),
                    Y = C.shapeModel,
                    $ = C.data.isClosePath();
                if (B.n && (B.n = !1, N = $ && e.length > 2 ? Ze(e[e.length - 2], _, m, M) : Ze(h, _, m, M), t = xf(_, N), Y ? Y.top_vs && C._10O(t, N, c, Q, b, Y.top_vs, Y.top_uv) : (r = C.left) && (C.addV(r.vs, t, N), C._13O(r))), T = p ? Ze(_, m, p, M) : $ && e.length > 2 ? Ze(_, m, e[1], M) : Ze(_, m, h, M), o = xf(m, T), Y) {
                    var G, S, F = Y.vs,
                        u = Y.uv,
                        O = Y.sum;
                    for (u && (G = Y.len / O, Y.len += Me(_, m), S = Y.len / O), I = C._9O(t, N, c, Q, b), V = C._9O(o, T, c, Q, b), Z = 0; c > Z; Z++) y = Z + 1, ug(F, I[y]), ug(F, V[Z]), ug(F, I[Z]), ug(F, V[Z]), ug(F, I[y]), ug(F, V[y]), u && (n = Z / c, J = y / c, u.push(G, J, S, n, G, n, S, n, G, J, S, J));
                    !p && Y.bottom_vs && C._10O(o, T, c, Q, b, Y.bottom_vs, Y.bottom_uv, !0)
                } else !p && (r = C.right) && (C.addV(r.vs, T, o), C._13O(r)), (r = C.front) && C.addV(r.vs, N, T), (r = C.back) && C.addV(r.vs, o, t), (r = C.top) && C.addH(r.vs, N, T, o, t, !0), (r = C.bottom) && C.addH(r.vs, t, o, T, N);
                B.p = m, B.f = T, B.b = o
            },
            _10O: function (e, U, p, z, _, u, S, i) {
                var J, Q, j = this,
                    d = j.data,
                    r = j._9O(e, U, p, z, _),
                    Z = (e.x + U.x) / 2,
                    v = (e.y + U.y) / 2,
                    g = d.getShapeElevation(),
                    F = 0;
                for (F = 0; p > F; F++) i ? (ug(u, r[F]), ug(u, r[F + 1])) : (ug(u, r[F + 1]), ug(u, r[F])), ug(u, [Z, g, v]), S && (i ? (J = E * (F + 1) / p + z, Q = E * F / p + z) : (J = E * F / p + z, Q = E * (F + 1) / p + z), S.push(.5 - .5 * w(Q), .5 - .5 * R(Q), .5 - .5 * w(J), .5 - .5 * R(J), .5, .5))
            },
            _9O: function (B, k, m, U, A) {
                var M, j, l = this,
                    x = l.data,
                    s = [],
                    P = (B.x + k.x) / 2,
                    N = (B.y + k.y) / 2,
                    a = x.getTall() / 2,
                    X = x.getShapeElevation(),
                    V = 0;
                for (A = A || E; m >= V; V++) M = A * V / m + U, j = w(M), s.push([P + (B.x - P) * j, X + a * R(M), N + (B.y - N) * j]);
                return s
            },
            addV: function (S, u, Y) {
                var d = u.x,
                    e = u.y,
                    O = Y.x,
                    y = Y.y,
                    j = this.data,
                    A = j.getShapeElevation(),
                    N = j.getTall() / 2;
                S.push(d, A - N, e, O, A - N, y, O, A + N, y, O, A + N, y, d, A + N, e, d, A - N, e)
            },
            addH: function (G, e, X, M, P, O) {
                var m = this.data,
                    L = m.getTall() / 2,
                    r = m.getShapeElevation() + (O ? L : -L);
                G.push(e.x, r, e.y, X.x, r, X.y, M.x, r, M.y, M.x, r, M.y, P.x, r, P.y, e.x, r, e.y)
            },
            vf: function (Q, i, v, D) {
                var y, q = this,
                    r = q.gv.getFaceVisible(q.data, Q);
                return (v || r) && (y = Nk(q, Q, D), y.vs = [], y.tuv = r && (y.texture || i) ? [] : h, y.visible = r), y
            }
        });
        var ln = function (m, u) {
            cj(ln, this, [m, u])
        };
        zc(ln, Fn, {
            _25Q: 1,
            validate: function (u) {
                var d = this,
                    k = d.data,
                    I = d.s,
                    G = k.getPoints(),
                    p = G.size();
                if (d.shapeModel = d.info = h, p > 1) {
                    var w = d.info = {},
                        T = k.getSegments(),
                        z = k.getThickness(),
                        q = oc(G.get(0)),
                        r = oc(G.get(p - 1)),
                        P = p % 2;
                    0 === P ? (w.c1 = oc(G.get(p / 2 - 1)), w.c2 = oc(G.get(p / 2))) : w.p3 = oc(G.get((p - P) / 2)), w.s1 = q, w.s2 = oc(G.get(1)), w.t1 = oc(G.get(p - 2)), w.t2 = r, w.list = I(fs) === sh ? d.createTubeModel(G, T, z / 2, u) : d.createLineModel(G, T, z, "shape.border", "shape.dash")
                }
                var l = k.p3(),
                    x = d.mat = Ip();
                Xj(x, l), zb(x, k.getFinalRotation3d(), k.getRotationMode());
                var D = k.getScale3d(),
                    B = k._dynamicScale3d;
                B && (D[0] *= B[0], D[1] *= B[1], D[2] *= B[2]), br(x, D), Xj(x, Bc(l))
            },
            _80o: function (I, B, F) {
                var s = this,
                    Y = s.shapeModel;
                if (Y) {
                    var A = s.gv;
                    hs(A, s.mat), uf(A, s.data, Y, s, s.getBodyColor(), F), sn(A)
                }
            }
        });
        var bj = k.graph3d.VR = function (U) {
            var i = this;
            i.gv = U, i._controllers = [], i.switch = new Yo(i), i._enable = !1, i._defaultCallLater = k.Default.callLater, i._defaultCancelLater = $r, "undefined" != typeof d && "VRFrameData" in d && (i._frameData = new d.VRFrameData), i.measureOflength = 1, i.eyesOffset = [0, 0, 0], i._orientation = new k.Math.Quaternion, i._lastHeadPose = [0, 0, 0], i._offsetToBeAdd = [0, 0, 0], i._fpsInfo = {
                time: 0,
                fps: 0,
                frames: 0
            }
        };
        zc(bj, x, {
            ms_fire: !0,
            _42: function (g, l, r, J) {
                var L = this,
                    W = L.gv;
                if (!W.drawFilter && L._deviceInAction) {
                    var j = L._device;
                    if (j) {
                        var c = L._measureOflength;
                        j.depthNear = W.getNear() * c, j.depthFar = W.getFar() * c;
                        var v = L._offsetToBeAdd;
                        if (L.eyesOffset[0] += v[0], L.eyesOffset[1] += v[1], L.eyesOffset[2] += v[2], v[0] = 0, v[1] = 0, v[2] = 0, j.isPresenting === !1) return L._controllers.forEach(function (s) {
                            s && s.update()
                        }), W.iv(), !1;
                        var s = L._frameData;
                        j.getFrameData(s);
                        var i = s.pose.position;
                        if (i) {
                            var H = L.toViewPosition(i);
                            W.setEye(H), L._orientation.fromArray(s.pose.orientation);
                            var S = new k.Math.Vector3(0, 0, -10 * L._scaleFactor);
                            S.applyQuaternion(L._orientation), W.setCenter([H[0] + S.x, H[1] + S.y, H[2] + S.z])
                        }
                        L._controllers.forEach(function (W) {
                            W && W.update()
                        }), W.setViewport(g, 0, 0, l / 2, r), L._viewMatrix = L._copyViewMatrix(s.leftViewMatrix), L._projectMatrix = L._copyProjectMatrix(s.leftProjectionMatrix), J(), W.setViewport(g, l / 2, 0, l / 2, r), L._viewMatrix = L._copyViewMatrix(s.rightViewMatrix), L._projectMatrix = L._copyProjectMatrix(s.rightProjectionMatrix), J(), L._lastViewMatrix = L._viewMatrix, L._lastProjectMatrix = L._projectMatrix, L._viewMatrix = null, L._projectMatrix = null, L.submitFrame();
                        var M = Date.now(),
                            I = L._fpsInfo;
                        return M - I.time > 1e3 ? (I.fps = Math.round(1e3 * (I.frames + 1) / (M - I.time)), I.time = M, I.frames = 0) : I.frames++, !0
                    }
                }
            },
            onVRDisplayPresentChange: function () {
                var d = this.isPresenting();
                this._injectGraphView(d), this.fp("present", !d, d)
            },
            getOrientation: function () {
                return this._orientation
            },
            addController: function (t) {
                t = t || 0;
                var A = this,
                    Z = A.getController(t);
                return Z ? Z : (Z = new md(A, t), A._controllers.push(Z), Z)
            },
            getController: function (K) {
                K = K || 0;
                for (var G = this._controllers, $ = 0, d = G.length; d > $; $++)
                    if (G[$] && G[$].id === K) return G[$];
                return null
            },
            removeController: function (M) {
                M = M || 0;
                for (var e = this._controllers, y = 0, F = e.length; F > y; y++)
                    if (e[y] && e[y].id === M) return e.splice(y, 1), !0;
                return !1
            },
            getLastHeadPose: function () {
                return this._lastHeadPose
            },
            toViewPosition: function (t, x) {
                var n = this,
                    r = n._scaleFactor,
                    Q = n._eyesOffset,
                    b = n._lastHeadPose;
                return b[0] = t[0] * r, b[1] = t[1] * r, b[2] = t[2] * r, x ? (x[0] = b[0] + Q[0], x[1] = b[1] + Q[1], x[2] = b[2] + Q[2], x) : [b[0] + Q[0], b[1] + Q[1], b[2] + Q[2]]
            },
            addEyesOffset: function (R, p, L) {
                var g = this._offsetToBeAdd;
                g[0] += R, g[1] += p, g[2] += L
            },
            _copyViewMatrix: function (z) {
                var v = this.dup(z),
                    I = this._scaleFactor;
                v[12] *= I, v[13] *= I, v[14] *= I;
                var U = this._eyesOffset;
                if (U && (U[0] || U[1] || U[2])) {
                    var t = U[0],
                        C = U[1],
                        w = U[2];
                    v[12] -= v[0] * t + v[4] * C + v[8] * w, v[13] -= v[1] * t + v[5] * C + v[9] * w, v[14] -= v[2] * t + v[6] * C + v[10] * w
                }
                return v
            },
            shutdown: function () {
                var $ = this._device;
                $ && $.isPresenting && $.exitPresent()
            },
            isPresenting: function () {
                var c = this._device;
                return c && c.isPresenting
            },
            _copyProjectMatrix: function (e) {
                var w = this.dup(e),
                    $ = this._scaleFactor;
                return w[14] *= $, w
            },
            dup: function (G, O) {
                for (var m = G.length, M = O || new Array(m); m--;) M[m] = G[m];
                return M
            },
            getViewMatrix: function (I) {
                var H = this._viewMatrix;
                return H ? this.dup(H, I) : void 0
            },
            getProjectMatrix: function () {
                var N = this._projectMatrix;
                return N ? this.dup(N) : void 0
            },
            submitFrame: function () {
                var Z = this;
                if (Z._enable && Z._deviceInAction) {
                    var Q = Z._device;
                    Q && Q.isPresenting && (Q.submitFrame(), Z.gv.iv())
                }
            },
            getFps: function () {
                return this._fpsInfo.fps
            },
            intersectWorld: function (A) {
                var X = this.gv;
                return X.intersectObjects(A, X.dm().getDatas())
            },
            setDevice: function (I) {
                var u = this;
                u._device = I
            },
            _injectGraphView: function () {
                var N, t, b;
                return function (y) {
                    var W = this.gv;
                    if (!y) return N && (W.getWidth = N, W.getHeight = t, W.getDevicePixelRatio = b), void 0;
                    var I = this._device,
                        r = I.getEyeParameters("left"),
                        Y = r.renderWidth,
                        d = r.renderHeight;
                    N = W.getWidth, t = W.getHeight, b = W.getDevicePixelRatio, W.getWidth = function () {
                        return 2 * Y
                    }, W.getHeight = function () {
                        return d
                    }, W.getDevicePixelRatio = function () {
                        return 1
                    }
                }
            }(),
            _injectCallLaterFunc: function (_) {
                var m = this;
                if (!_) return Zl = k.Default.callLater = m._defaultCallLater, $r = k.Default.cancelLater = m._defaultCancelLater, void 0;
                var m = this;
                Zl = k.Default.callLater = function (B, R, A, E) {
                    var P = m._device;
                    return P && P.isPresenting ? E ? q(function () {
                        Zl(B, R, A)
                    }, E) : P.requestAnimationFrame(function () {
                        m._deviceInAction = !0, B.apply(R, A), m._deviceInAction = !1
                    }) : m._defaultCallLater(B, R, A, E)
                }, $r = k.Default.cancelLater = function (U, S) {
                    var T = m._device;
                    return T && T.isPresenting ? S ? I(U) : T.cancelAnimationFrame(U) : m._defaultCancelLater(U, S)
                }
            }
        }), x.defineProperties(bj.prototype, {
            enable: {
                get: function () {
                    return this._enable
                },
                set: function (E) {
                    var U = this;
                    U._enable !== E && (U._enable = E, E ? (U.switch.showButton(), U._injectCallLaterFunc(!0)) : (U.shutdown(), U.switch.hideButton(), U._injectCallLaterFunc(!1)), U.fp("enable", !E, E))
                }
            },
            measureOflength: {
                get: function () {
                    return this._measureOflength
                },
                set: function (E) {
                    this._measureOflength = E;
                    var t = this._scaleFactor = 1 / E;
                    this._controllers.forEach(function (p) {
                        p && p._setScaleFactor(t)
                    })
                }
            },
            eyesOffset: {
                get: function () {
                    return this._eyesOffset
                },
                set: function (C) {
                    this._eyesOffset = C
                }
            },
            controllerModel: {
                get: function () {
                    return this._controllerModel
                },
                set: function (n) {
                    var I;
                    "object" == typeof n ? (I = n.mtl, n = n.obj) : (I = n + ".mtl", n += ".obj");
                    var t = this,
                        T = t._controllerModel;
                    T && T.obj === n && T.mtl === I || (T = t._controllerModel = {
                        obj: n,
                        mtl: I
                    }, f.loadObj(n, I, {
                        finishFunc: function (S, B) {
                            t._controllerModel === T && f.setShape3dModel("vrControllerModel", B)
                        }
                    }))
                }
            },
            interactive: {
                get: function () {
                    return !!this._interactive
                },
                set: function (S) {
                    !!S != !!this._interactive && (this._interactive = S, S && this.addController(0), this.gv.getCoreInteractor().enableVR(S))
                }
            }
        });
        var md = function (X, H) {
                function K(h) {
                    var t = navigator.getGamepads && navigator.getGamepads();
                    if (t)
                        for (var H = 0, z = 0, f = t.length; f > H; H++) {
                            var b = t[H];
                            if (b) {
                                var Q = b.id;
                                if ("OpenVR Gamepad" === Q || "OpenVR Controller" === Q || 0 === Q.indexOf("Oculus Touch") || 0 === Q.indexOf("Spatial Controller")) {
                                    if (z === h) return b;
                                    z++
                                }
                            }
                        }
                }

                function t(u, h, O) {
                    return Math.abs(u[0] - h[0]) < O && Math.abs(u[1] - h[1]) < O && Math.abs(u[2] - h[2]) < O ? !0 : !1
                }
                var Z = this;
                Z.vr = X, Z.id = H;
                var b, u, w = [0, 0],
                    r = [{
                        id: "thumbpad",
                        pressed: !1
                    }, {
                        id: "trigger",
                        pressed: !1
                    }, {
                        id: "grips",
                        pressed: !1
                    }, {
                        id: "menu",
                        pressed: !1
                    }],
                    $ = new Ln;
                $.s("shape3d", "vrControllerModel"), $.isController = !0, $.s("intersect", !1), Z.getGamepad = function () {
                    return u
                }, Z.isButtonPressed = function (R) {
                    for (var j, C = 0, z = r.length; z > C; C++)
                        if (j = r[C], j.id === R) return j.pressed;
                    return !1
                }, Z.getNode = function () {
                    return $
                };
                var s = .003;
                Z.setRotationEpsilon = function (V) {
                    s = V
                };
                var L = 5e-4,
                    S = L;
                Z.setPositionEpsilon = function (z) {
                    L = z, S = z * Z.vr._scaleFactor
                }, Z._setScaleFactor = function (J) {
                    $.s3(J, J, J), S = L * J
                }, Z._setScaleFactor(Z.vr._scaleFactor);
                var I, R = new mh,
                    k = new Al,
                    V = [0, 0, 0],
                    A = [0, 0, 0],
                    G = new Wo,
                    J = new Go,
                    y = new qe;
                Z.getRay = function () {
                    return I ? (y.origin.fromArray(V), y.direction.copy(J), I = !1, y) : y
                }, Z.update = function () {
                    if (b = u, u = K(H), b != u && console.log("gamepad changed", u), !u || u.pose === p) return u = null, $.s("3d.visible", !1), void 0;
                    if (f.getShape3dModel("vrControllerModel")) {
                        $.dm() || X.gv.dm().add($), $.s("3d.visible", !0);
                        var z = u.pose;
                        if (null !== z) {
                            z.position && (Z.vr.toViewPosition(z.position, V), t($.p3(), V, S) || (I = !0, $.p3(V))), z.orientation && (R.fromArray(z.orientation), J.set(0, 0, -1).applyQuaternion(R).normalize(), k.makeRotationFromQuaternion(R), G.set(0, 0, 0, $.getRotationMode(), !0).setFromRotationMatrix(k), A[0] = G.x, A[1] = G.y, A[2] = G.z, t($.r3(), A, s) || (I = !0, $.r3(A))), I && X.fp("gamepad.pose", null, {
                                position: V,
                                rotation: A,
                                id: H
                            });
                            var d = u.axes;
                            (w[0] !== d[0] || w[1] !== d[1]) && (w = [d[0], d[1]], X.fp("gamepad.axes", null, {
                                id: H,
                                axes: w
                            }));
                            var W, F, c, q, U = u.buttons;
                            for (W = 0, F = U.length; F > W; W++)
                                if (c = U[W], q = c.pressed, q !== r[W].pressed) {
                                    r[W].pressed = q;
                                    var i = {
                                            id: H
                                        },
                                        h = "state";
                                    i[h] = i._62O = q ? "down" : "up", X.fp("gamepad.button." + r[W].id, null, i)
                                }
                        }
                    }
                }
            },
            Yo = function (U) {
                this.vr = U, this._button = null
            };
        zc(Yo, x, {
            showButton: function () {
                var F = this.assureButton();
                if (!F.parentNode) {
                    var p = this.vr.gv,
                        i = p.getView();
                    p._79O ? i.insertBefore(F, p._79O) : i.appendChild(F)
                }
            },
            hideButton: function () {
                var m = this._button;
                m && m.parentNode && m.parentNode.removeChild(m)
            },
            assureButton: function () {
                var v = this._button;
                return v ? v : this._button = this.createButton(this.vr.gv)
            },
            createButton: function (j) {
                function l(H, k) {
                    H.textContent = k && k.isPresenting ? " VR " : " VR "
                }

                function U(T) {
                    W.style.display = "", W.style.cursor = "pointer", W.style.left = "calc(50% - 50px)", W.style.width = "100px", l(W, T), W.onmouseenter = function () {
                        W.style.opacity = "1.0"
                    }, W.onmouseleave = function () {
                        W.style.opacity = "0.5"
                    }, W.onclick = function () {
                        T.isPresenting ? T.exitPresent() : T.requestPresent([{
                            source: j.getCanvas()
                        }])
                    }, j.vr.setDevice(T)
                }

                function L() {
                    W.style.display = "", W.style.cursor = "auto", W.style.left = "calc(50% - 75px)", W.style.width = "150px", l(W, null), W.onmouseenter = null, W.onmouseleave = null, W.onclick = null, j.vr.setDevice(null)
                }

                function z(L) {
                    L.style.position = "absolute", L.style.bottom = "20px", L.style.padding = "12px 6px", L.style.border = "1px solid #fff", L.style.borderRadius = "4px", L.style.color = "#000", L.style.font = "normal 13px sans-serif", L.style.textAlign = "center", L.style.opacity = "0.5", L.style.outline = "none", L.style.zIndex = "999"
                }
                if ("getVRDisplays" in navigator) {
                    var W = this._button = b.createElement("button");
                    return W.style.display = "none", z(W), d.addEventListener("vrdisplayconnect", function (s) {
                        U(s.display)
                    }, V), d.addEventListener("vrdisplaydisconnect", function () {
                        L()
                    }, V), d.addEventListener("vrdisplaypresentchange", function (c) {
                        l(W, c.display), j.vr.onVRDisplayPresentChange()
                    }, V), navigator.getVRDisplays().then(function (b) {
                        b.length > 0 ? U(b[0]) : L()
                    }), W
                }
                var h = b.createElement("a");
                return h.href = "https://webvr.info", h.innerHTML = " webvr", h.style.left = "calc(50% - 90px)", h.style.width = "180px", h.style.textDecoration = "none", z(h), h
            }
        }), x.defineProperties(Yo.prototype, {});
        var ik = k.graph3d.PostProcessing = function (O) {
                function R() {
                    if (!S) {
                        var L = O.getGL();
                        S = new jl.RenderTarget(O, L), v = new fk.Shader(L, Z.vs, Z.fs), e = fk.Buffer.createIndexBuffer(L, new Uint16Array([0, 2, 1, 1, 2, 3])), y = fk.Buffer.createVertexBuffer(L, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
                    }
                }
                var S, v, e, y, h = this,
                    f = {},
                    d = !1;
                ! function () {
                    x.keys(ik).forEach(function (B) {
                        f[B] = new ik[B](O)
                    })
                }(), h.getModule = function (C) {
                    return C ? f[C] : f
                }, h.getModuleList = function () {
                    return x.keys(f)
                }, h.handleDataModleChange = function (I, L) {
                    I && (I.setPostProcessingData(h.serialize()), I.removeSerializeListener(h.onDataModelSerialize, h)), L && (L.addSerializeListener(h.onDataModelSerialize, h), h.deserialize(L.getPostProcessingData()))
                }, h.onDataModelSerialize = function (M) {
                    "serialize" === M.type ? O.dm()._postProcessingData = h.serialize() : "deserialize" === M.type && h.deserialize(O.dm().getPostProcessingData())
                }, h.serialize = function () {
                    var Y, Q, F, N = {};
                    for (Y in f) Q = f[Y], N[Y] = {
                        enable: Q.enable
                    }, F = Q.serializeProperties, F && F.forEach(function (K) {
                        N[Y][K] = Q[K]
                    });
                    return N
                }, h.deserialize = function (Z) {
                    if (Z) {
                        var U, T, s, M;
                        for (U in Z)
                            if (T = f[U]) {
                                s = Z[U], h.enableModule(U, s.enable);
                                for (M in s) "enable" !== M && (T[M] = s[M])
                            }
                    } else {
                        var U, T;
                        for (U in f) T = f[U], T.enable = !1, T.resetProperties && T.resetProperties()
                    }
                }, h.enableModule = function (y, $) {
                    var s, J, P, b = y.split(",");
                    for (s = 0, J = b.length; J > s; s++) P = b[s].trim(), f[P] && (f[P].enable = $);
                    d = !1;
                    for (P in f)
                        if (f[P].enable) {
                            d = !0;
                            break
                        }
                    d && R()
                };
                var Z = {
                    vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
                    fs: ["precision highp float;", "uniform sampler2D image;", "varying vec2 vUv;", "void main() {", "gl_FragColor = texture2D(image, vUv);", "}"].join("\n")
                };
                h._42 = function (Y, i, N, _, F) {
                    if (d && !F) {
                        S.setSize(Y, i, N), oh(Y, S.frame), Y.clear(Y.COLOR_BUFFER_BIT | Y.DEPTH_BUFFER_BIT), O.setViewport(Y, 0, 0, i, N), _();
                        var C, G = S;
                        for (C in f) G = f[C]._42(Y, G) || G;
                        return hg(Y), O.setViewport(Y, 0, 0, i, N), Y.clear(Y.COLOR_BUFFER_BIT | Y.DEPTH_BUFFER_BIT), v.bind(), Y.activeTexture(Y.TEXTURE0 + 0), Y.bindTexture(Y.TEXTURE_2D, G.texture), v.uniforms.image = 0, e.upload(), y.upload(), v.attributes.pos.pointer(y), Y.drawElements(Y.TRIANGLES, 6, Y.UNSIGNED_SHORT, 0), Y.bindTexture(Y.TEXTURE_2D, null), Y.useProgram(O._prg), !0
                    }
                }
            },
            Gm = k.graph3d.PostProcessing.Bloom = function (b) {
                function $() {
                    var z = b.getWidth(),
                        j = b.getHeight();
                    if (z && j) {
                        E = [z, j], l = !0;
                        var A, h = b.getGL(),
                            q = Math.round(E[0] / 2),
                            W = Math.round(E[1] / 2);
                        for (O = new jl.RenderTarget(b, h, q, W), A = 0; S > A; A++) y.push(new jl.RenderTarget(b, h, q, W)), c.push(new jl.RenderTarget(b, h, q, W)), q = Math.round(q / 2), W = Math.round(W / 2);
                        N = new fk.Shader(h, Gm.highPassShader.vs, Gm.highPassShader.fs);
                        for (var A = 0; S > A; A++) Z[A] = new fk.Shader(h, Gm.blurShader.vs, Gm.blurShader.fs.replace(/DEFINE_VALUE/g, Y[A]));
                        p = new fk.Shader(h, Gm.compositeShader.vs, Gm.compositeShader.fs.replace(/NUM_MIPS/g, S)), J = new fk.Shader(h, Gm.finalShader.vs, Gm.finalShader.fs), e = fk.Buffer.createIndexBuffer(h, new Uint16Array([0, 2, 1, 1, 2, 3])), k = fk.Buffer.createVertexBuffer(h, new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]))
                    }
                }
                var q, P, L, e, k, K = this,
                    H = !1,
                    l = !1;
                this.serializeProperties = "strength,threshold,radius".split(","), this.resetProperties = function () {
                    q = 1.5, P = .55, L = .4
                }, x.defineProperties(K, {
                    enable: {
                        get: function () {
                            return H
                        },
                        set: function (O) {
                            !!H != !!O && (H = O, O && !l && $())
                        }
                    },
                    strength: {
                        get: function () {
                            return q
                        },
                        set: function (U) {
                            q = U
                        }
                    },
                    threshold: {
                        get: function () {
                            return P
                        },
                        set: function (d) {
                            P = d
                        }
                    },
                    radius: {
                        get: function () {
                            return L
                        },
                        set: function (E) {
                            L = E
                        }
                    }
                }), this.resetProperties();
                var O, N, p, J, E = [256, 256],
                    y = [],
                    c = [],
                    S = 5,
                    Y = [3, 5, 7, 9, 11],
                    Z = [];
                K._42 = function (n, G) {
                    function C(s, G, T, C) {
                        oh(n, G.frame), b.setViewport(n, 0, 0, G.width, G.height), C ? C(n) : n.clear(n.COLOR_BUFFER_BIT | n.DEPTH_BUFFER_BIT), g !== s && s.bind();
                        var m = 0;
                        for (var W in T) {
                            var E = T[W];
                            E instanceof WebGLTexture && (n.activeTexture(n.TEXTURE0 + m), n.bindTexture(n.TEXTURE_2D, E), E = m, m++), s.uniforms[W] = E
                        }
                        for (g !== s && (e.upload(), k.upload(), s.attributes.pos.pointer(k), g = s), n.drawElements(n.TRIANGLES, 6, n.UNSIGNED_SHORT, 0); m--;) n.activeTexture(n.TEXTURE0 + m), n.bindTexture(n.TEXTURE_2D, null);
                        hg(n)
                    }
                    if (H) {
                        l || $();
                        var g;
                        C(N, O, {
                            smoothWidth: .01,
                            luminosityThreshold: P,
                            tDiffuse: G.texture
                        });
                        var h, V = O,
                            D = Math.round(E[0] / 2),
                            F = Math.round(E[1] / 2);
                        for (h = 0; S > h; h++) C(Z[h], y[h], {
                            colorTexture: V.texture,
                            direction: [1, 0],
                            texSize: [D, F]
                        }), C(Z[h], c[h], {
                            colorTexture: y[h].texture,
                            direction: [0, 1],
                            texSize: [D, F]
                        }), D = Math.round(D / 2), F = Math.round(F / 2), V = c[h];
                        return C(p, y[0], {
                            blurTexture1: c[0].texture,
                            blurTexture2: c[1].texture,
                            blurTexture3: c[2].texture,
                            blurTexture4: c[3].texture,
                            blurTexture5: c[4].texture,
                            bloomStrength: q,
                            bloomRadius: L,
                            bloomTintColor: [1, 1, 1]
                        }), C(J, G, {
                            image: y[0].texture
                        }, function (X) {
                            X.enable(X.BLEND), X.blendEquation(X.FUNC_ADD), X.blendFunc(X.SRC_ALPHA, X.ONE)
                        }), n.blendEquationSeparate(n.FUNC_ADD, n.FUNC_ADD), n.blendFuncSeparate(n.SRC_ALPHA, n.ONE_MINUS_SRC_ALPHA, n.ONE, n.ONE_MINUS_SRC_ALPHA), G
                    }
                }
            };
        Gm.highPassShader = {
            vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
            fs: ["precision highp float;", "uniform sampler2D tDiffuse;", "uniform float luminosityThreshold;", "uniform float smoothWidth;", "varying vec2 vUv;", "void main() {", "vec4 texel = texture2D( tDiffuse, vUv );", "vec3 luma = vec3( 0.299, 0.587, 0.114 );", "float v = dot( texel.xyz, luma );", "vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);", "float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );", "gl_FragColor = mix( outputColor, texel, alpha );", "}"].join("\n")
        }, Gm.blurShader = {
            vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
            fs: ["precision highp float;", "varying vec2 vUv;", "uniform sampler2D colorTexture;", "uniform vec2 texSize;", "uniform vec2 direction;", "#define KERNEL_RADIUS DEFINE_VALUE", "#define SIGMA DEFINE_VALUE", "float gaussianPdf(in float x, in float sigma) {", "return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;", "}", "void main() {", "vec2 invSize = 1.0 / texSize;", "float fSigma = float(SIGMA);", "float weightSum = gaussianPdf(0.0, fSigma);", "vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;", "for( int i = 1; i < KERNEL_RADIUS; i ++ ) {", "float x = float(i);", "float w = gaussianPdf(x, fSigma);", "vec2 uvOffset = direction * invSize * x;", "vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;", "vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;", "diffuseSum += (sample1 + sample2) * w;", "weightSum += 2.0 * w;", "}", "gl_FragColor = vec4(diffuseSum/weightSum, 1.0);", "}"].join("\n")
        }, Gm.compositeShader = {
            vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
            fs: ["precision highp float;", "varying vec2 vUv;", "uniform sampler2D blurTexture1;", "uniform sampler2D blurTexture2;", "uniform sampler2D blurTexture3;", "uniform sampler2D blurTexture4;", "uniform sampler2D blurTexture5;", "uniform sampler2D dirtTexture;", "uniform float bloomStrength;", "uniform float bloomRadius;", "uniform vec3 bloomTintColor;", "float lerpBloomFactor(const in float factor) {", "float mirrorFactor = 1.2 - factor;", "return mix(factor, mirrorFactor, bloomRadius);", "}", "void main() {", "gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ", "lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ", "lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ", "lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ", "lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );", "}"].join("\n")
        }, Gm.finalShader = {
            vs: ["attribute vec2 pos;", "varying vec2 vUv;", "void main(void) {", "gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);", "vUv = vec2(pos.x, 1.0 - pos.y);", "}"].join("\n"),
            fs: ["precision highp float;", "uniform sampler2D image;", "varying vec2 vUv;", "void main() {", "gl_FragColor = texture2D(image, vUv);", "}"].join("\n")
        }, xr(f, {
            accordionViewExpandIcon: Fj(Ym),
            accordionViewCollapseIcon: Fj(Ym, !0),
            accordionViewLabelColor: Am,
            accordionViewLabelFont: Ti,
            accordionViewTitleBackground: $l,
            accordionViewSelectBackground: Zr,
            accordionViewSelectWidth: 3,
            accordionViewSeparatorColor: p,
            splitViewDividerSize: 1,
            splitViewDividerBackground: $l,
            splitViewDragOpacity: .5,
            splitViewToggleIcon: {
                width: 16,
                height: 16,
                comps: [{
                    type: Cp,
                    rect: [2, 2, 12, 12],
                    background: Ym
                }]
            },
            propertyViewLabelColor: Eo,
            propertyViewLabelSelectColor: Am,
            propertyViewLabelFont: Ti,
            propertyViewExpandIcon: Fj(ss),
            propertyViewCollapseIcon: Fj(ss, !0),
            propertyViewBackground: ig,
            propertyViewRowLineVisible: !0,
            propertyViewColumnLineVisible: !0,
            propertyViewRowLineColor: uc,
            propertyViewColumnLineColor: uc,
            propertyViewSelectBackground: Zr,
            listViewLabelColor: Eo,
            listViewLabelSelectColor: Am,
            listViewLabelFont: Ti,
            listViewRowLineVisible: !1,
            listViewRowLineColor: uc,
            listViewSelectBackground: Zr,
            treeViewLabelColor: Eo,
            treeViewLabelSelectColor: Am,
            treeViewLabelFont: Ti,
            treeViewExpandIcon: Fj(Eb),
            treeViewCollapseIcon: Fj(Eb, !0),
            treeViewRowLineVisible: !1,
            treeViewRowLineColor: uc,
            treeViewSelectBackground: Zr,
            treeViewDoubleClickToToggle: !0,
            tableViewLabelColor: Eo,
            tableViewLabelSelectColor: Am,
            tableViewLabelFont: Ti,
            tableViewRowLineVisible: !0,
            tableViewColumnLineVisible: !0,
            tableViewRowLineColor: uc,
            tableViewColumnLineColor: uc,
            tableViewSelectBackground: Zr,
            treeTableViewLabelColor: Eo,
            treeTableViewLabelSelectColor: Am,
            treeTableViewLabelFont: Ti,
            treeTableViewExpandIcon: Fj(Eb),
            treeTableViewCollapseIcon: Fj(Eb, !0),
            treeTableViewRowLineVisible: !0,
            treeTableViewColumnLineVisible: !0,
            treeTableViewRowLineColor: uc,
            treeTableViewColumnLineColor: uc,
            treeTableViewSelectBackground: Zr,
            tableHeaderLabelColor: Eo,
            tableHeaderLabelFont: Ti,
            tableHeaderColumnLineVisible: !0,
            tableHeaderColumnLineColor: xk,
            tableHeaderBackground: ig,
            tableHeaderMoveBackground: Pn,
            tableHeaderInsertColor: Zr,
            tableHeaderSortDescIcon: Wc(ss, !0),
            tableHeaderSortAscIcon: Wc(ss),
            tabViewTabGap: 1,
            tabViewLabelColor: Am,
            tabViewLabelFont: Ti,
            tabViewTabBackground: $l,
            tabViewSelectWidth: 3,
            tabViewSelectBackground: Zr,
            tabViewMoveBackground: Pn,
            tabViewInsertColor: Zr,
            toolbarLabelColor: Eo,
            toolbarLabelSelectColor: Am,
            toolbarLabelFont: Ti,
            toolbarBackground: ig,
            toolbarSelectBackground: Zr,
            toolbarItemGap: 8,
            toolbarSeparatorColor: Bn
        }, !0);
        var vq = {
                translateX: 1,
                sortColumn: 1
            },
            Dc = {
                sortable: 1,
                sortOrder: 1,
                sortFunc: 1
            },
            tr = {
                focusData: 1
            },
            al = {
                dataModel: 1,
                sortColumn: 1,
                sortFunc: 1,
                visibleFunc: 1,
                rootData: 1,
                rootVisible: 1
            },
            bi = {
                dataModel: 1,
                sortFunc: 1,
                visibleFunc: 1,
                categorizable: 1
            },
            Ee = function (s, j) {
                j.add(s), s.hasChildren() && s.eachChild(function (J) {
                    Ee(J, j)
                })
            },
            Xf = function (E, C, x, k, W, j, P, $, Z, e, u) {
                var Q, m = x.getValueType(e),
                    H = x.getAlign(e);
                if (x.getEnumValues(e)) {
                    var z = x.toEnumLabel(C, e),
                        K = cn || 0,
                        T = 0,
                        J = j,
                        B = f.getTextSize(k, z).width;
                    return Q = Qn(x.toEnumIcon(C, e)), Q && (T = j + cn / 2, "center" === H ? T += ($ - (K + B)) / 2 : "right" === H && (T = T + $ - (K + B)), nn(E, Q, T, P + Z / 2, e, u), J = T + cn / 2), z != h && (Q ? Yd(E, z, k, W, J, P, $ - (J - j), Z) : Yd(E, z, k, W, j, P, $, Z, H)), void 0
                }
                return C = x.formatValue(C), C != h ? m === mf ? (to(E, j, P, $, Z, C), void 0) : m === Mc || !m && rl(C) ? (Q = Qn(C ? Mb : yd), nn(E, Q, j + $ / 2, P + Z / 2, e, u), void 0) : (Yd(E, C, k, W, j, P, $, Z, H), void 0) : void 0
            },
            Bs = function (x, C) {
                var _ = C.view,
                    w = $p(x),
                    B = C.column || C.property;
                _.getDataModel().beginTransaction(), C.editor = x, x.info = C, _.setCurrentEditor(x), _.getView().insertBefore(w, _._79O), Qh(x, C.editorRect), x.setFocus ? x.setFocus() : Sq(x), x.commitValue = function (c, X) {
                    x._17Q && (x = x._17Q), X || _.setValue(C.data, B, x.getValue ? x.getValue() : x.value), x.close && x.close(), Kh(w)
                }, B.onEditorCreated && B.onEditorCreated(C)
            },
            Oj = function (W, x, d, G, X) {
                var c = En(W, d),
                    r = x.value,
                    Y = x.view,
                    C = X.getValueType(x.data);
                return c.onblur = c.onchange = function () {
                    Y.endEditing()
                }, "input" === W ? (r = X.formatValue(r), r != h && (c.value = r), c.onkeydown = function (i) {
                    gd(i) ? Y.endEditing() : fm(i) && Y.endEditing(!0)
                }, (C === Bb || C === Nh) && c.addEventListener(Bm, f.numberListener, V)) : W === ek && G.forEach(function (p) {
                        var j = b.createElement("option");
                        j.innerHTML = X.toEnumLabel(p), j.value = p, X.isEnumEqual(r, p) && (j.selected = !0), or(c, j)
                    }), Bs(c, x), c
            },
            qj = k.widget = {},
            oo = function (i, _, r) {
                zc(N + ".widget." + i, _, r)
            };
        xr(Wm, {
            ms_value: function (b) {
                b.getValue = function (U) {
                    var W = this.getItemById(U),
                        Q = W.element;
                    return Qc(Q) ? Q : Q ? Q.getValue ? Q.getValue() : Q.value : W.selected
                }, b.setValue = function (E, F) {
                    var Z = this.getItemById(E);
                    if (Z) {
                        var b = Z.element;
                        b && !Qc(b) ? b.setValue ? b.setValue(F) : b.value = F : rl(F) ? (Z.selected = F, this.iv()) : (Z.element = F, this.iv())
                    }
                }, b.v = function (y, k) {
                    var s = this;
                    if (2 === arguments.length) s.setValue(y, k);
                    else {
                        if (!cl(y)) return s.getValue(y);
                        for (var w in y) s.setValue(w, y[w])
                    }
                    return s
                }
            },
            _46o: function (A) {
                A._icon = h, A._accessType = h, A._valueType = h, A._editable = !1, A._batchEditable = !0, A._align = ul, A._nullable = !0, A._emptiable = !1, A.setParent = Zf, A.formatValue = function (G) {
                    var T = this,
                        l = T._valueType;
                    return T.getEnumValues() ? T.toEnumLabel(G) : l === Mc ? !!G : G != h && l === Bb ? r(G) : G
                }, A.setEnum = function (B, W, d, b, Q, C, s) {
                    var I = this;
                    B && !nj(B) && B.values && (b = B.editable, d = B.icons, W = B.labels, Q = B.strict, C = B.maxHeight, s = B.dropDownWidth, B = B.values), Er(B) && (B = B._as), Er(W) && (W = W._as), Er(d) && (d = d._as), I._enumValues = B, I._enumLabels = W, I._enumIcons = d, I._enumEditable = b, I._enumStrict = Q == h ? !0 : Q, I._enumMaxHeight = C, I._enumDropDownWidth = s, B && B.length && Rj(B[0]) && (I._valueType = Nh), I.fp("enum", !1, !0)
                }, A.getEnumDropDownWidth = function () {
                    return this._enumDropDownWidth
                }, A.getEnumMaxHeight = function () {
                    return this._enumMaxHeight
                }, A.isEnumEditable = function () {
                    return this._enumEditable
                }, A.getEnumValues = function () {
                    return this._enumValues
                }, A.getEnumLabels = function () {
                    return this._enumLabels
                }, A.getEnumIcons = function () {
                    return this._enumIcons
                }, A.isEnumStrict = function () {
                    return this._enumStrict
                }, A.isEnumEqual = function (z, v) {
                    return this._enumStrict ? z === v : z == v
                }, A.toEnumLabel = function (z, e) {
                    var K = this,
                        s = K.getEnumValues(e),
                        $ = K.getEnumLabels(e);
                    if (s && $)
                        for (var l = 0; l < s.length; l++)
                            if (K.isEnumEqual(z, s[l])) return $[l];
                    return z
                }, A.toEnumIcon = function (V, f) {
                    var H = this,
                        D = H.getEnumValues(f),
                        b = H.getEnumIcons(f);
                    if (D && b)
                        for (var S = 0; S < D.length; S++)
                            if (H.isEnumEqual(V, D[S])) return b[S];
                    return p
                }
            },
            _45o: function (P) {
                P._87o = function (Y, M, r, j, B, g) {
                    if (Y) {
                        var K = this,
                            t = K._90I,
                            e = rq(1);
                        K._columnLineVisible && (B -= 1), K._rowLineVisible && (g -= 1), 0 >= B || 0 >= g || (K._90I || (t = K._90I = {}), t[M] || (t[M] = new vf), Qh(e, K.tx() + r, K.ty() + j, B, g), or(e, Y), K._view.insertBefore(e, K._79O), Y.onParentAdded && Y.onParentAdded(e), t[M].add(e))
                    }
                }, P._76o = function () {
                    var f = this,
                        v = f._90I;
                    if (v) {
                        for (var V in v) v[V].each(function (O) {
                            Kh(O)
                        });
                        delete f._90I
                    }
                }, P._77o = function (p) {
                    var L = this;
                    if (L._90I) {
                        var W = L._90I[p];
                        W && (W.each(function (G) {
                            Kh(G)
                        }), delete L._90I[p])
                    }
                }
            },
            _47o: function (L) {
                L.getValue = function (X, V) {
                    return V.getValue ? V.getValue(X, V, this) : nd(X, V.getAccessType(), V.getName())
                }, L.setValue = function (j, d, F) {
                    if (d.isEmptiable(j) || "" !== F || (F = p), d.isNullable(j) || F != h) {
                        var z = this,
                            c = d.getName(j),
                            U = d.getAccessType(j),
                            G = d.getValueType(j);
                        G === Bb && Qc(F) ? F = A(F) : G === Nh && Qc(F) ? F = parseFloat(F) : G === Mc && Qc(F) && (F = "true" === F), z._batchEditable && d._batchEditable && z.isSelected(j) ? z.sm().each(function (W) {
                            d.setValue ? d.setValue(W, d, F, z) : Qe(W, U, c, F)
                        }) : d.setValue ? d.setValue(j, d, F, z) : Qe(j, U, c, F)
                    }
                }, L.setCurrentEditor = function (I) {
                    this.endEditing(), this._currentEditor = I, this.redraw()
                }, L.isEditing = function (e, h) {
                    var I = this,
                        w = I._currentEditor;
                    if (!w) return !1;
                    if (h) {
                        var M = w.info;
                        return M ? (M.column || M.property) === h && M.data === e : !1
                    }
                    return !0
                }, L.endEditing = function (z) {
                    var w = this,
                        A = w._currentEditor;
                    A && (delete w._currentEditor, A.commitValue && A.commitValue(A.info, z), w.redraw(), w.getDataModel().endTransaction())
                }, L.beginEditing = function (l) {
                    this.endEditing();
                    var G = this,
                        z = l.column || l.property;
                    if (z.beginEditing) z.beginEditing(l);
                    else {
                        var u = l.data,
                            R = l.value,
                            s = G.getSelectBackground(u),
                            f = z.getEnumValues(u),
                            E = z.getSlider(u),
                            T = z.getColorPicker(u);
                        if (E) {
                            var P = Th(qj.Slider, E);
                            return P.setValue(R), P.getView().onblur = function () {
                                G.endEditing()
                            }, P.isInstant() && (P.onValueChanged = function () {
                                G.setValue(u, z, P.getValue())
                            }), Bs(P, l), void 0
                        }
                        if (T || z.getValueType(u) === mf) {
                            var r = Th(qj.ColorPicker, T);
                            return r.setValue(R), r.onClosed = function () {
                                G.endEditing()
                            }, r.isInstant() && (r.onValueChanged = function (t, O) {
                                G.setValue(u, z, O)
                            }), Bs(r, l), r.open(), void 0
                        }
                        if (f) {
                            if (qj.ComboBox) {
                                var $ = new qj.ComboBox;
                                $.setValue(R), $.setValues(f), $.setLabels(z.getEnumLabels(u)), $.setIcons(z.getEnumIcons(u)), $.setEditable(z.isEnumEditable(u)), $.setStrict(z.isEnumStrict(u)), $.setMaxHeight(z.getEnumMaxHeight(u)), $.setDropDownWidth(z.getEnumDropDownWidth(u)), $.onClosed = function () {
                                    G.endEditing()
                                }, Bs($, l), $.open()
                            } else Oj(ek, l, s, f, z);
                            return
                        }
                        var X = z.getValueType(u);
                        if (X === Mc || rl(R)) return G.setValue(u, z, !R), void 0;
                        if (z.getItemEditor(u)) {
                            var j = Po(z.getItemEditor(u)),
                                x = new j(u, z, G, l),
                                I = x.getView();
                            return I._17Q = x, x.setValue(R), Eh(I), Bs(I, l), x.editBeginning && x.editBeginning(), void 0
                        }
                        Oj("input", l, s, h, z)
                    }
                }
            },
            _44o: function (U) {
                U.init = function (j) {
                    var G = this,
                        X = G.th = new Ie(j),
                        r = G._view = xj(1, G);
                    G.tv = G._tableView = j, or(r, X.getView()), or(r, j.getView()), X.mp(function (I) {
                        I.property === bg && G.iv()
                    }), G.iv()
                }, U.getTableView = function () {
                    return this.tv
                }, U.getTableHeader = function () {
                    return this.th
                }, U.getDataModel = function () {
                    return this.tv.dm()
                }, U.getColumnModel = function () {
                    return this.tv.getColumnModel()
                }, U.setColumns = function (C) {
                    this.tv.setColumns(C)
                }, U.addColumns = function (J) {
                    this.tv.addColumns(J)
                }, U.endEditing = function () {
                    this.tv.endEditing()
                }, U.validateImpl = function () {
                    var l = this,
                        u = l.th,
                        H = qh(u),
                        n = {
                            x: 0,
                            y: 0,
                            width: l.getWidth(),
                            height: H
                        };
                    Qh(u, n), n.y = H, n.height = W(0, l.getHeight() - H), Qh(l.tv, n)
                }
            },
            ms_vs: function (a) {
                a._41o = function () {
                    return this._29I.height < this._59I
                }, a._43o = function () {
                    var R = this;
                    R._41o() && (R._58I || (q(function () {
                        R._94O()
                    }, cb), R.iv()), R._58I = new Date)
                }, a._94O = function () {
                    var N = this;
                    if (N._58I) {
                        var O = new Date;
                        O.getTime() - N._58I.getTime() >= cb ? (delete N._58I, N.iv()) : q(function () {
                            N._94O()
                        }, cb)
                    }
                }, a._93I = function () {
                    var y = this,
                        L = y._27I;
                    if (y._58I || !y._autoHideScrollBar) {
                        L || or(y._79O, L = y._27I = rq());
                        var e = y._29I,
                            b = e.height,
                            E = y._59I,
                            X = y.getScrollBarSize(),
                            R = e.width - X - 2,
                            O = b * (-y.ty() / E),
                            m = b * (b / E),
                            M = L.style;
                        E > b ? (si > m && (O = O + m / 2 - si / 2, 0 > O && (O = 0), O + si > b && (O = b - si), m = si), M.visibility = Fm, M.background = y.getScrollBarColor(), M.borderRadius = X / 2 + Do, Qh(L, R, O, X, m)) : M.visibility = _c
                    } else L && (L.style.visibility = _c)
                }
            },
            ms_hs: function (O) {
                O._40o = function () {
                    return this._29I.width < this._91I
                }, O._42o = function () {
                    var R = this;
                    R._40o() && (R._95O || (q(function () {
                        R._94I()
                    }, cb), R.iv()), R._95O = new Date)
                }, O._94I = function () {
                    var V = this;
                    if (V._95O) {
                        var b = new Date;
                        b.getTime() - V._95O.getTime() >= cb ? (delete V._95O, V.iv()) : q(function () {
                            V._94I()
                        }, cb)
                    }
                }, O._92I = function () {
                    var e = this,
                        z = e._28I;
                    if (e._95O || !e._autoHideScrollBar) {
                        z || or(e._79O, z = e._28I = rq());
                        var D = e._29I,
                            c = D.width,
                            u = e._91I,
                            y = e.getScrollBarSize(),
                            R = D.height - y - 2,
                            Y = c * (-e.tx() / u),
                            d = c * (c / u),
                            U = z.style;
                        u > c ? (si > d && (Y = Y + d / 2 - si / 2, 0 > Y && (Y = 0), Y + si > c && (Y = c - si), d = si), U.visibility = Fm, U.background = e.getScrollBarColor(), U.borderRadius = y / 2 + Do, Qh(z, Y, R, d, y)) : U.visibility = _c
                    } else z && (z.style.visibility = _c)
                }
            }
        }), Ej(Mb, Zn(16, 16, [{
            type: as,
            rect: [1, 1, 14, 14],
            background: Zr
        }, {
            type: ae,
            rect: [1, 1, 14, 14],
            width: 1,
            color: np
        }, {
            type: ef,
            points: [13, 3, 7, 12, 4, 8],
            borderWidth: 2,
            borderColor: "#FFF"
        }])), Ej(yd, Zn(16, 16, {
            type: ae,
            rect: [1, 1, 14, 14],
            width: 1,
            color: np
        })), Ej(_l, Zn(16, 16, [{
            type: wk,
            rect: [2, 2, 12, 12],
            borderWidth: 1,
            borderColor: np,
            background: "#FFF"
        }, {
            type: wk,
            rect: [4, 4, 8, 8],
            background: Zr
        }])), Ej(bs, Zn(16, 16, {
            type: wk,
            rect: [2, 2, 12, 12],
            borderWidth: 1,
            borderColor: np
        })), Wm._15Q = function (L) {
            L._29I = sf, L._59I = 0, L._91I = 0, L._5o = function (V) {
                var C = this;
                C._30I = new vf, C._rows = new vf, C._rowMap = {}, C._31I = 0, C._14I = 0, C._view = xj(1, C), C._canvas = Np(C._view), or(C._view, C._79O = rq()), C.dm(V ? V : new Nm)
            }, L.getCheckIcon = function (I) {
                var P = this.sm(),
                    n = P.co(I);
                return P.sg() ? Qn(n ? _l : bs) : Qn(n ? Mb : yd)
            }, L.checkData = function (X) {
                var S = this.sm(),
                    V = S.co(X);
                S.sg() && V || (this._32o = 1, V ? S.rs(X) : S.as(X), delete this._32o)
            }, L.getDataAt = function (T) {
                T.target && (T = this.lp(T));
                var W = e(T.y / this._rowHeight),
                    $ = this._rows;
                return 0 > W || W >= $.size() ? h : $.get(W)
            }, L.onDataDoubleClicked = function () {}, L.onDataClicked = function () {}, L.adjustTranslateX = function () {
                return 0
            }, L.adjustTranslateY = function (Z) {
                var o = this.getHeight() - this._59I;
                return o > Z && (Z = o), Z > 0 ? 0 : r(Z)
            }, L.onPropertyChanged = function (g) {
                var C = this,
                    W = g.property;
                al[W] ? C.ivm() : tr[W] || C.redraw(), W === mb ? C._42o() : W === qc && C._43o()
            }, L.getLabel = function (s) {
                return s.toLabel()
            }, L.getLabelFont = function () {
                return this._labelFont
            }, L.getLabelColor = function (J) {
                var _ = this;
                if (_.isCheckMode()) {
                    if (_._focusData === J) return _._labelSelectColor
                } else if (_.isSelected(J)) return _._labelSelectColor;
                return _._labelColor
            }, L.getStartRowIndex = function () {
                return this._31I
            }, L.getEndRowIndex = function () {
                return this._14I
            }, L.getRowDatas = function () {
                return this._rows
            }, L.getRowIndex = function (N) {
                return this._rowMap[N._id]
            }, L.getRowSize = function () {
                return this._rows.size()
            }, L.getViewRect = function () {
                return tc(this._29I)
            }, L.isVisible = function (L) {
                return this._visibleFunc ? this._visibleFunc(L) : !0
            }, L.getCurrentSortFunc = function () {
                return this._sortFunc
            }, L.setDataModel = function (w) {
                var H = this,
                    u = H._dataModel,
                    O = H._selectionModel;
                u !== w && (u && (u.umm(H.handleDataModelChange, H), u.umd(H.handleDataPropertyChange, H), u.umh(H.handleHierarchyChange, H), O || u.sm().ums(H.handleSelectionChange, H)), H._dataModel = w, w.mm(H.handleDataModelChange, H), w.md(H.handleDataPropertyChange, H), w.mh(H.handleHierarchyChange, H), O ? O._21I(w) : w.sm().ms(H.handleSelectionChange, H), H.fp("dataModel", u, w))
            }, L.validateModel = function () {
                var G = this;
                G._rows.clear(), G._rowMap = {}, G.buildChildren(G._dataModel._roots);
                var u = G._rows = G._rows.toList(G.isVisible, G),
                    J = 0,
                    c = G.getCurrentSortFunc(),
                    v = u.size();
                for (c && u.sort(c); v > J; J++) G._rowMap[u.get(J)._id] = J
            }, L.buildChildren = function (m) {
                var e = this;
                m.each(function (T) {
                    e._rows.add(T), e.buildChildren(T._children)
                })
            }, L.handleDataModelChange = function () {
                this.ivm()
            }, L.handleDataPropertyChange = function (K) {
                "parent" === K.property ? this.ivm() : this.invalidateData(K.data)
            }, L.handleHierarchyChange = function () {
                this.ivm()
            }, L.handleSelectionChange = function (P) {
                P.datas.each(this.invalidateData, this), this.onSelectionChanged(P)
            }, L.onSelectionChanged = function (x) {
                var I = this,
                    d = I.sm();
                !I.isAutoMakeVisible() || 1 !== d.size() || "set" !== x.kind && "append" !== x.kind || I._32o || I.makeVisible(d.ld())
            }, L.handleBackgroundClick = function (A) {
                Bf(A) && !this.isCheckMode() && this.sm().cs()
            }, L.makeVisible = function (P) {
                P && (this._23I = P, this.iv())
            }, L.scrollToIndex = function (G) {
                var I = this,
                    X = I._29I,
                    z = X.height,
                    i = I._rowHeight,
                    S = i * G;
                G >= 0 && G < I._rows.size() && z > 0 && (S + i > X.y + z ? I.ty(-S + z - i) : S < X.y && I.ty(-S))
            }, L.autoScroll = function (I, h) {
                var H = this,
                    b = H._rowHeight,
                    $ = b,
                    Q = b / 4,
                    c = H._29I,
                    z = H.lp(I),
                    U = {
                        x: H.tx(),
                        y: H.ty()
                    };
                return b > 0 && c && (z.x - c.x < $ ? H.translate(Q, 0) : c.x + c.width - z.x < $ && H.translate(-Q, 0), z.y - c.y < $ ? H.translate(0, Q) : c.y + c.height - z.y < $ && H.translate(0, -Q)), U.x = H.tx() - U.x, U.y = H.ty() - U.y, h && (h.x += U.x, h.y += U.y), U
            }, L.getTopRowOrderSelection = function () {
                var w = this.sm().getTopSelection(),
                    W = {},
                    G = new vf;
                return w.each(function (B) {
                    W[B._id] = B
                }), this._rows.each(function (t) {
                    W[t._id] && G.add(t)
                }), G
            }, L.getRowOrderSelection = function () {
                var m = new vf;
                return this._rows.each(function (B) {
                    this.isSelected(B) && m.add(B)
                }, this), m
            }, L.ivm = function () {
                this.invalidateModel()
            }, L.invalidateModel = function () {
                var $ = this;
                $._96I || ($._96I = 1, $._32I = 1, delete $._24I), $.iv()
            }, L.redraw = function () {
                var r = this;
                r._32I || (r._32I = 1, delete r._24I, r.iv())
            }, L.invalidateData = function (N) {
                var m = this;
                $ ? m.redraw() : m._32I || (m._24I || (m._24I = {}), m._24I[N._id] = N, m.iv())
            }, L.getFocusData = function () {
                return this._focusData
            }, L.setFocusDataById = function (C) {
                this.setFocusData(this.dm().getDataById(C))
            }, L.setFocusData = function (r) {
                var D = this,
                    z = D._focusData;
                z !== r && (D._focusData = r, D.fp("focusData", z, r), z && D.invalidateData(z), r && (D.invalidateData(r), D.isAutoMakeVisible() && D.makeVisible(r)))
            }, L.drawRowBackground = function (n, c, W, V, y, v, X) {
                var k = this,
                    Z = k.isCheckMode();
                (c === k._focusData && Z || W && !Z) && to(n, V, y, v, X, k.getSelectBackground(c))
            }, L.drawData = function (D, _, s) {
                var Y = this,
                    Z = Y._rowHeight,
                    V = Z * s,
                    J = Y._29I,
                    S = J.x,
                    z = J.width;
                D.save(), D.beginPath(), D.rect(S, V, z, Z), D.clip(), Y._87o(Y.drawRow(D, _, Y.isSelected(_), S, V, z, Z), s, S, V, z, Z), D.restore(), Y._rowLineVisible && to(D, S, V + Z - 1, z, 1, Y._rowLineColor)
            }, L._12I = function (Q) {
                var n = this,
                    D = n._31I,
                    y = n._29I,
                    f = y.x,
                    H = y.y,
                    N = y.width,
                    G = y.height;
                for (Q.beginPath(), Q.rect(f, H, N, G), Q.clip(), Q.clearRect(f, H, N, G), n._76o(), n._93db(Q); D < n._14I; D++) n.drawData(Q, n._rows.get(D), D);
                n._92db(Q)
            }, L._13I = function (p) {
                for (var B, _ = this, T = _._rowHeight, i = _._29I, b = i.x, O = i.width, U = _._31I, D = _._30I; U < _._14I; U++) B = _._rows.get(U), _._24I[B._id] && D.add({
                    data: B,
                    index: U
                });
                D.isEmpty() || (p.beginPath(), D.each(function (z) {
                    p.rect(b, z.index * T, O, T)
                }), p.clip(), D.each(function (i) {
                    p.clearRect(b, i.index * T, O, T)
                }), D.each(function (h) {
                    _._77o(h.index)
                }), _._93db(p), D.each(function (R) {
                    _.drawData(p, R.data, R.index)
                }), _._92db(p), D.clear())
            }, L.preValidateModel = function () {
                this.endEditing && this.endEditing()
            }, L.validateImpl = function () {
                var d = this,
                    W = d._canvas,
                    D = d.getWidth(),
                    n = d.getHeight(),
                    I = d._rowHeight,
                    Q = d._32I;
                (D !== W.clientWidth || n !== W.clientHeight) && (mc(W, D, n), Q = 1);
                var r = m && !S;
                d._96I && !r && (d.preValidateModel(), d.validateModel());
                var b = d._29I,
                    P = {
                        x: -d.tx(),
                        y: -d.ty(),
                        width: D,
                        height: n
                    },
                    H = d._rows.size(),
                    j = Hf(W),
                    L = d._23I;
                Q || $f(P, b) || (Q = 1), d._29I = P, d._59I = H * I + d.getScrollBarSize(), d._31I = e(P.y / I), d._14I = _((P.y + P.height) / I), d._31I < 0 && (d._31I = 0), d._14I > H && (d._14I = H), d._99I && Q && d._99I(), Tm(j, d.tx(), d.ty(), 1), Q ? d._12I(j) : d._24I && d._13I(j), d._93I(), d._92I(), j.restore(), d._32I = d._24I = d._96I = h, L && (d.scrollToIndex(d.getRowIndex(L)), delete d._23I), d.tx(d.tx()), d.ty(d.ty())
            }
        }, Wm._48o = function (I) {
            I._rootVisible = !0, I._rootData = h, I._35o = function () {
                this._expandMap = {}, this._levelMap = {}
            }, I.validateModel = function () {
                var x = this,
                    C = x._rootData;
                x._rows.clear(), x._levelMap = {}, x._rowMap = {}, x._currentLevel = 0, C ? x._rootVisible ? x.isVisible(C) && x.buildData(C) : x.buildChildren(C) : x.buildChildren(), delete x._currentLevel
            }, I.buildData = function (o) {
                var l = this,
                    I = o._id,
                    d = l._rows;
                l._rowMap[I] = d.size(), d.add(o), l._levelMap[I] = l._currentLevel, l.isExpanded(o) && (l._currentLevel++, l.buildChildren(o), l._currentLevel--)
            }, I.buildChildren = function (U) {
                var f = this,
                    y = U ? U._children : f._dataModel._roots,
                    B = f.getCurrentSortFunc();
                B && f.isChildrenSortable(U) ? y.toList(f.isVisible, f).sort(B).each(f.buildData, f) : y.each(function (O) {
                    f.isVisible(O) && f.buildData(O)
                })
            }, I.getLevel = function (T) {
                return this._levelMap[T._id]
            }, I.getToggleIcon = function (Z) {
                var w = this,
                    _ = w._loader,
                    H = w._collapseIcon;
                return _ && !_.isLoaded(Z) ? H : Z.hasChildren() ? w.isExpanded(Z) ? w._expandIcon : H : h
            }, I.isCheckMode = function () {
                return this._checkMode != h
            }, I.isChildrenSortable = function () {
                return !0
            }, I.handleDataModelChange = function (g) {
                var m = this;
                g.kind === sc ? delete m._expandMap[g.data._id] : g.kind === cf && (m._expandMap = {}), m.ivm()
            }, I.toggle = function (m) {
                var k = this;
                k.isExpanded(m) ? k.collapse(m) : k.expand(m)
            }, I.isExpanded = function (N) {
                return 1 === this._expandMap[N._id]
            }, I.expand = function (g) {
                var m = this,
                    e = m._loader;
                m.isExpanded(g) || (e && !e.isLoaded(g) && e.load(g), m._expandMap[g._id] = 1, m.ivm(), m.onExpanded(g))
            }, I.onExpanded = function () {}, I.collapse = function (a) {
                var r = this;
                r.isExpanded(a) && (delete r._expandMap[a._id], r.ivm(), r.onCollapsed(a))
            }, I.onCollapsed = function () {}, I.expandAll = function (E) {
                if (E) this.expand(E), E.eachChild(function (L) {
                    this.expandAll(L)
                }, this);
                else {
                    var Z = this;
                    Z._dataModel.each(function (C) {
                        C.hasChildren() && (Z._expandMap[C._id] = 1)
                    }), Z.ivm()
                }
            }, I.collapseAll = function () {
                this._expandMap = {}, this.ivm()
            }, I.makeVisible = function (W) {
                if (W) {
                    var g = this;
                    if (!g._rootData || W.isDescendantOf(g._rootData)) {
                        for (var M = W._parent; M;) g.expand(M), M = M._parent;
                        g._23I = W, g.iv()
                    }
                }
            }, I.checkData = function (x) {
                var B, _ = this,
                    G = _._checkMode,
                    O = _.sm(),
                    C = O.co(x);
                if (!O.sg() || !C) {
                    if (_._32o = 1, G === ri) C ? O.rs(x) : O.as(x);
                    else if (G === pe) B = new vf(x), B.addAll(x._children);
                    else if ("descendant" === G) B = new vf, Ee(x, B);
                    else if ("all" === G && (B = new vf, Ee(x, B), !C))
                        for (var A = x._parent; A;) B.add(A), A = A._parent;
                    B && (C ? O.rs(B) : O.as(B)), delete _._32o
                }
            }, I._97I = function (F, g, z, Z, W, I, m) {
                var H = this,
                    P = H._indent,
                    B = H._levelMap[g._id],
                    o = H.getIconWidth(g),
                    e = Qn(H.getToggleIcon(g));
                e ? (Z += P * B, nn(F, e, Z + P / 2, W + m / 2, g, H), Z += P) : Z += P * (B + 1), H._checkMode && (nn(F, H.getCheckIcon(g), Z + P / 2, W + m / 2, g, H), Z += P), H.drawIcon(F, g, Z, W, o, m), H.drawLabel(F, g, Z + o, W, m)
            }
        }, Wm._14Q = function (p) {
            p.getIcon = function (l) {
                return l.getIcon()
            }, p.getIconWidth = function (o) {
                return this.getIcon(o) ? this._indent : 0
            }, p.drawIcon = function (u, p, I, l, R, Z) {
                if (R) {
                    var G = this,
                        E = G.getBodyColor(p),
                        v = Qn(G.getIcon(p), E);
                    v && (Z -= G.isRowLineVisible() ? 1 : 0, zk(u, v, Hq, I, l, R, Z, p, G, E), Yq(u, G.getBorderColor(p), I, l, R, Z))
                }
            }, p.drawLabel = function (r, H, x, X, k) {
                var J = this;
                Yd(r, J.getLabel(H), J.getLabelFont(H), J.getLabelColor(H), x, X, 0, k)
            }
        }, Wm._50o = function (i) {
            i._98I = function () {
                var N = this,
                    s = N._39o = new Nm;
                N._60I = new vf, s.mm(N._17o, N), s.md(N._18o, N), s.mh(N._19o, N)
            }, i.setColumns = function (l) {
                this._39o.clear(), this.addColumns(l)
            }, i.addColumns = function (z) {
                var C = this._39o;
                z.forEach(function (v) {
                    if (!(v instanceof rs)) {
                        var e = Po(v.className);
                        v = Th(e ? e : rs, v)
                    }
                    C.add(v)
                })
            }, i.onColumnClicked = function () {}, i.onCheckColumnClicked = function () {}, i._3Q = function (i) {
                for (var P, r = 0, Y = this._60I, S = Y.size(); S > r; r++)
                    if (P = Y.get(r), P.column === i) return P;
                return h
            }, i.getColumnAt = function (x) {
                var w = this._4Q(x);
                return w ? w.column : h
            }, i._4Q = function (g) {
                for (var Q = this, Z = g.target ? Q.lp(g).x : g.x, V = Q._60I, u = 0; u < V.size(); u++) {
                    var M = V.get(u),
                        L = M.startX;
                    if (Z >= L && Z < L + M.column.getWidth()) return M
                }
                return h
            }, i.getToolTip = function (a) {
                var P = this,
                    U = P.getDataAt(a),
                    z = P.getColumnAt(a);
                return U && z ? z.getToolTip(U, P) : h
            }, i.adjustTranslateX = function (T) {
                var p = this.getWidth() - this._91I;
                return p > T && (T = p), T > 0 ? 0 : r(T)
            }, i._99I = function () {
                var M = this,
                    A = M._29I,
                    V = M._60I;
                V.clear(), M._91I = 0, M._39o._roots.each(function (c) {
                    if (c.isVisible()) {
                        var u = M._91I + c.getWidth();
                        M._91I <= A.x + A.width && u >= A.x && V.add({
                            column: c,
                            startX: M._91I
                        }), M._91I = u
                    }
                }), M._91I += M.getScrollBarSize()
            }, i.drawData = function (N, G, q) {
                var C = this,
                    i = C._rowHeight,
                    x = i * q,
                    H = C.isSelected(G),
                    y = C._29I,
                    r = y.x,
                    c = y.width;
                C.drawRowBackground(N, G, H, r, x, c, i), C._60I.each(function (s) {
                    var E = s.column,
                        _ = s.startX,
                        l = E.getWidth();
                    l > 0 && !C.isEditing(G, E) && (N.save(), N.beginPath(), N.rect(_, x, l, i), N.clip(), C._87o(C.drawCell(N, G, H, E, _, x, l, i), q, _, x, l, i), C._columnLineVisible && to(N, _ + l - 1, x, 1, i, C._columnLineColor), N.restore())
                }), C._rowLineVisible && to(N, r, x + i - 1, c, 1, C._rowLineColor)
            }, i.drawCell = function (p, X, V, R, K, N, q, c) {
                var x = this;
                if (R.drawCell) return R.drawCell(p, X, V, R, K, N, q, c, x);
                var r = x.getValue(X, R);
                Xf(p, r, R, x.getLabelFont(X, R, r), x.getLabelColor(X, R, r), K, N, q, c, X, x)
            }, i.getColumnModel = function () {
                return this._39o
            }, i._17o = function () {
                this.redraw()
            }, i._18o = function (h) {
                var k = this;
                h.data === k._sortColumn && Dc[h.property] ? k.ivm() : (k._42o(), k.redraw())
            }, i._19o = function () {
                this.redraw()
            }, i.getCurrentSortFunc = function () {
                var z = this,
                    U = z._sortColumn;
                if (U && U.isSortable()) {
                    var X = U.getSortFunc(),
                        I = ye === U.getSortOrder() ? 1 : -1;
                    return X || (X = dh),
                        function (G, Z) {
                            return X.call(z, z.getValue(G, U), z.getValue(Z, U), G, Z) * I
                        }
                }
                return z._sortFunc
            }, i.isCellEditable = function (T, j, R) {
                return j.isEditable() && this.isEditable() ? j.isCellEditable ? j.isCellEditable(T, j, R, this) : !0 : !1
            }, i._37O = function (J, i) {
                if (Bf(i))
                    for (var V = this, k = V.lp(i), L = V._60I, Y = V._rowHeight, N = V._29I, x = N.x, $ = N.y, w = N.width, o = N.height, O = 0; O < L.size(); O++) {
                        var f = L.get(O),
                            v = f.startX,
                            T = f.column,
                            B = T.getWidth();
                        if (T !== V._31o && T !== V._4o && k.x >= v && k.x < v + B && V.isCellEditable(J, T, i)) {
                            var c = {
                                    x: v,
                                    y: V.getRowIndex(J) * Y,
                                    width: B,
                                    height: Y
                                },
                                X = {
                                    x: c.x + V.tx(),
                                    y: c.y + V.ty(),
                                    width: c.width,
                                    height: c.height
                                },
                                U = 0,
                                I = 0;
                            return c.x < x ? U = c.x - x : c.x + c.width > x + w && (U = c.x + c.width - x - w), U && (V.tx(V.tx() - U), X.x -= U), c.y < $ ? I = c.y - $ : c.y + Y > $ + o && (I = c.y + Y - $ - o), I && (V.ty(V.ty() - I), X.y -= I), V.beginEditing({
                                data: J,
                                column: T,
                                value: V.getValue(J, T),
                                event: i,
                                rect: c,
                                editorRect: X,
                                view: V
                            }), void 0
                        }
                    }
            }
        }, qj.BaseItemEditor = function (J, i, k, X) {
            this._data = J, this._column = i, this._master = k, this._editInfo = X
        }, oo("BaseItemEditor", x, {
            ms_ac: ["data", "column", "master", "editInfo"],
            editBeginning: function () {},
            getView: function () {},
            getValue: function () {},
            setValue: function () {}
        });
        var lp = k.Tab = function () {
            cj(lp, this)
        };
        If("Tab", rr, {
            ms_ac: ["view", "closable", "disabled"],
            _icon: h,
            _closable: !1,
            _disabled: !1,
            setParent: Zf
        });
        var rs = k.Column = function () {
            cj(rs, this)
        };
        If("Column", rr, {
            _46o: 1,
            ms_ac: ["accessType", "valueType", Fm, Tc, Bq, hi, "align", mf, "sortOrder", Xc, "sortable", "clickable", "nullable", "emptiable", "slider", "colorPicker", "itemEditor"],
            _visible: !0,
            _width: 80,
            _sortOrder: ye,
            _sortFunc: h,
            _sortable: !0,
            _clickable: !0,
            setWidth: function (j) {
                16 > j && (j = 16);
                var I = this._width;
                this._width = j, this.fp(hi, I, j)
            },
            getToolTip: function (q, T) {
                return this.formatValue(T.getValue(q, this))
            }
        });
        var ip = k.Property = function () {
            cj(ip, this)
        };
        If("Property", rr, {
            _46o: 1,
            ms_ac: ["accessType", "valueType", Tc, Bq, "categoryName", mf, "align", "nullable", "emptiable", "slider", "itemEditor", "colorPicker"],
            _categoryName: h,
            getToolTip: function (I, Z, i) {
                var B = this;
                return Z ? B.formatValue(i.getValue(I, B)) : i.getPropertyName(B)
            }
        }), qj.AccordionView = function () {
            var D = this;
            D._20o = {}, D._21o = new vf, D._10o = h, D._9o = h, D._11o = h, D._view = xj(0, D), D.iv()
        }, oo("AccordionView", x, {
            ms_v: 1,
            ms_fire: 1,
            ms_ac: [gf, de, "titleHeight", kd, Vi, "titleBackground", "selectWidth", Vr, "orientation", "separatorColor"],
            _expandIcon: f.accordionViewExpandIcon,
            _collapseIcon: f.accordionViewCollapseIcon,
            _titleHeight: xn,
            _labelColor: f.accordionViewLabelColor,
            _labelFont: f.accordionViewLabelFont,
            _titleBackground: f.accordionViewTitleBackground,
            _selectBackground: f.accordionViewSelectBackground,
            _selectWidth: f.accordionViewSelectWidth,
            _orientation: "v",
            _separatorColor: f.accordionViewSeparatorColor,
            onPropertyChanged: function () {
                this.iv()
            },
            getView: function () {
                return this._view
            },
            getTitles: function () {
                return this._21o
            },
            getCurrentTitle: function () {
                return this._10o
            },
            add: function (J, W, x, M) {
                var l = this,
                    S = rq();
                if (l._20o[J]) throw J + " already exists";
                S.onmousedown = Bl, S.style.cursor = Pf, S.addEventListener(ah ? vh : Jl, function (c) {
                    Bl(c)
                }, V), S.addEventListener(ah ? hc : wr, function (A) {
                    Bl(A), Bf(A) && (l._10o === J ? l.collapse() : l.expand(J))
                }, V), or(l._view, S), l._20o[J] = {
                    content: W,
                    div: S,
                    canvas: Np(S),
                    icon: M
                }, l._21o.add(J), x && l.expand(J), l.iv()
            },
            remove: function (l) {
                var i = this,
                    h = i._20o[l];
                h && (Kh(h.div), delete i._20o[l], i._21o.remove(l), i.iv())
            },
            clear: function () {
                var g = this;
                g._21o.toArray().forEach(g.remove, g), g._20o = {}, g._21o.clear(), g.iv()
            },
            isExpanded: function (N) {
                return this._10o === N
            },
            expand: function (z) {
                var F = this;
                F._20o[z] && F._10o !== z && (F._10o = z, F.onExpanded(z), F.iv())
            },
            onExpanded: function () {},
            collapse: function () {
                var o = this;
                o._10o && (o.onCollapsed(o._10o), delete o._10o, o.iv())
            },
            onCollapsed: function () {},
            initCanvas: function (y, A, r) {
                mc(y, A, r);
                var j = Hf(y);
                return Tm(j, 0, 0, 1), j.clearRect(0, 0, A, r), j
            },
            drawTitle: function (C, p, U, b, W) {
                var h = this,
                    O = Qn(W.icon),
                    D = h.isExpanded(p),
                    V = h._titleHeight,
                    T = h._titleBackground,
                    S = h._selectWidth,
                    j = h._separatorColor,
                    N = Qn(D ? h._expandIcon : h._collapseIcon),
                    d = S + 4;
                to(C, 0, 0, U, b, T), D && S && to(C, 0, 0, S, b, h._selectBackground), (D || h._21o.get(h._21o.size() - 1) !== p) && to(C, 0, b - 1, U, 1, j ? j : Lb(T)), O && (nn(C, O, d + Df(O) / 2, V / 2), d += Df(O) + 2), Yd(C, p, h.getLabelFont(p), h.getLabelColor(p), d, 0, 0, V), N && nn(C, N, U - Df(N) / 2 - 4, V / 2)
            },
            validateImpl: function () {
                var q = this,
                    t = q._view,
                    Z = 0,
                    w = 0,
                    U = q.getWidth(),
                    v = q.getHeight(),
                    C = q._titleHeight,
                    M = q._21o.size() * C,
                    Q = q._11o,
                    e = q._9o;
                delete q._11o, delete q._9o, q._21o.each(function (n) {
                    var P, I, V = q._20o[n],
                        h = V.content,
                        z = q._10o === n;
                    Vl(q) ? (Qh(V.div, Z, 0, C, v), P = q.initCanvas(V.canvas, C, v), Aj(P, 0, v), Zp(P, -g), q.drawTitle(P, n, v, C, V), P.restore(), z ? (I = W(0, U - M), h && (q._11o = h, q._9o = $p(h), Qh(h, Z + C, 0, I, v)), Z += C + I) : Z += C) : (Qh(V.div, 0, w, U, C), P = q.initCanvas(V.canvas, U, C), q.drawTitle(P, n, U, C, V), P.restore(), z ? (I = W(0, v - M), h && (q._11o = h, q._9o = $p(h), Qh(h, 0, w + C, U, I)), w += C + I) : w += C)
                });
                var i = q._9o;
                Q && Q !== q._11o && Q.endEditing && Q.endEditing(), i && i !== e && or(t, i), e && e !== i && Kh(e)
            }
        }), qj.SplitView = function (s, F, Z, C) {
            var j = this,
                X = j._dividerDiv = rq(),
                M = j._60O = Np(),
                f = j._61O = Np(),
                P = M.style,
                u = f.style;
            j._view = xj(1, j), or(j._view, X), P.msTouchAction = Jn, P.pointerEvents = Jn, P.cursor = Pf, u.msTouchAction = Jn, u.pointerEvents = Jn, u.cursor = Pf, s && j.setLeftView(s), F && j.setRightView(F), Z && j.setOrientation(Z), C != h && j.setPosition(C), j.setStatus(Mn), new rf(j)
        }, oo("SplitView", x, {
            ms_v: 1,
            ms_fire: 1,
            ms_ac: ["continuousLayout", "dividerSize", "dividerBackground", "toggleIcon", "togglable", "dragOpacity", "orientation", "draggable", "status"],
            _continuousLayout: !1,
            _position: .5,
            _togglable: !0,
            _orientation: "h",
            _draggable: !0,
            _dividerSize: f.splitViewDividerSize,
            _dividerBackground: f.splitViewDividerBackground,
            _dragOpacity: f.splitViewDragOpacity,
            _toggleIcon: f.splitViewToggleIcon,
            onPropertyChanged: function () {
                this.iv()
            },
            getDividerDiv: function () {
                return this._dividerDiv
            },
            getPosition: function () {
                return this._position
            },
            setPosition: function (g, e) {
                var C = this,
                    P = C._position;
                isNaN(g) || (e || (C._82O = 0 > g ? -1 : g > 1 ? 1 : 0), C._position = g, C.fp(cr, P, g))
            },
            getLeftView: function () {
                return this._leftView
            },
            setLeftView: function (X) {
                var M = this,
                    I = M._leftView,
                    N = M._view;
                if (M._leftView !== X) {
                    if (I && I !== M._rightView) {
                        var y = $p(I);
                        y.parentNode === N && Kh(y)
                    }
                    if (M._leftView = X, X) {
                        var g = $p(X);
                        g.parentNode !== N && N.insertBefore(g, M._dividerDiv)
                    }
                    M.fp("leftView", I, X)
                }
            },
            getRightView: function () {
                return this._rightView
            },
            setRightView: function (K) {
                var Z = this,
                    p = Z._rightView,
                    k = Z._view;
                if (Z._rightView !== K) {
                    if (p && p !== Z._leftView) {
                        var L = $p(p);
                        L.parentNode === k && Kh(L)
                    }
                    if (Z._rightView = K, K) {
                        var J = $p(K);
                        J.parentNode !== k && k.insertBefore(J, Z._dividerDiv)
                    }
                    Z.fp("rightView", p, K)
                }
            },
            validateImpl: function () {
                var q = this,
                    l = q._draggable,
                    V = q._position,
                    s = q.getWidth(),
                    p = q.getHeight(),
                    O = q._dividerSize,
                    R = q._dividerBackground,
                    U = ah ? 18 : 8,
                    A = q._dividerDiv,
                    D = q._82O,
                    I = q._60O,
                    L = q._61O,
                    H = q._toggleIcon,
                    d = q._status,
                    f = A.style,
                    J = null,
                    n = ah ? 20 : 4,
                    t = H.comps[0];
                O >= U || 0 === O ? q._coverDiv && (Kh(q._coverDiv), delete q._coverDiv) : q._coverDiv || (q._coverDiv = rq(), v && (q._coverDiv.style.background = ql), or(A, q._coverDiv)), q._togglable ? I.parentNode || (or(A, I), or(A, L)) : (Kh(I), Kh(L));
                var N = q._coverDiv,
                    P = q._leftView,
                    h = q._rightView;
                if (Vl(q)) {
                    if (O > s && (O = s), d === Mn)
                        if (1 === D) var a = j(V, s),
                            T = W(0, s - O - a);
                        else -1 === D ? (T = j(-V, s), a = W(0, s - O - T)) : (a = r((s - O) * V), T = W(0, s - O - a));
                    else "cl" === d ? (a = 0, T = W(0, s - O)) : "cr" === d && (T = 0, a = W(0, s - O));
                    P && Qh(P, 0, 0, a, p), h && Qh(h, a + O, 0, T, p), Qh(A, a, 0, O, p), q._22o = a, N && (Qh(N, O / 2 - U / 2, 0, U, p), N.style.cursor = l ? xo : ""), A.style.cursor = l ? xo : "";
                    var _ = A.clientHeight / 2,
                        E = A.clientWidth;
                    mc(I, E, E), Qh(I, 0, _ - E - n, E, E), J = Hf(I), Tm(J, 0, 0, 1), t.rotation = -g, wp(J, H, 0, 0, E, E), J.restore(), mc(L, E, E), Qh(L, 0, _ + n, E, E), J = Hf(L), Tm(J, 0, 0, 1), t.rotation = g, wp(J, H, 0, 0, E, E), J.restore()
                } else {
                    if (O > p && (O = p), d === Mn)
                        if (1 === D) var i = j(V, p),
                            m = W(0, p - O - i);
                        else -1 === D ? (m = j(-V, p), i = W(0, p - O - m)) : (i = r((p - O) * V), m = W(0, p - O - i));
                    else "cl" === d ? (i = 0, m = W(0, p - O)) : "cr" === d && (m = 0, i = W(0, p - O));
                    P && Qh(P, 0, 0, s, i), h && Qh(h, 0, i + O, s, m), Qh(A, 0, i, s, O), q._22o = i, N && (Qh(N, 0, O / 2 - U / 2, s, U), N.style.cursor = l ? Mr : ""), f.cursor = l ? Mr : "";
                    var M = A.clientWidth / 2,
                        E = A.clientHeight;
                    mc(I, E, E), Qh(I, M - E - n, 0, E, E), J = Hf(I), Tm(J, 0, 0, 1), t.rotation = 0, wp(J, H, 0, 0, E, E), J.restore(), mc(L, E, E), Qh(L, M + n, 0, E, E), J = Hf(L), Tm(J, 0, 0, 1), t.rotation = c, wp(J, H, 0, 0, E, E), J.restore()
                }
                f.background = R
            }
        });
        var rf = function (O) {
            this.sv = O, this.addListeners()
        };
        zc(rf, x, {
            ms_listener: 1,
            getView: function () {
                return this.sv.getView()
            },
            handle_touchstart: function (r) {
                var U = this,
                    n = U.sv,
                    q = n._dividerDiv,
                    P = n._60O,
                    l = n._61O,
                    v = n._status,
                    T = r.target;
                if (T === P) v === Mn ? n.setStatus("cl") : "cr" === v && n.setStatus(Mn);
                else if (T === l) v === Mn ? n.setStatus("cr") : "cl" === v && n.setStatus(Mn);
                else if (Uq(r) && (T === q || T === n._coverDiv) && (Bl(r), n.isDraggable())) {
                    n.getLeftView(), n.getRightView();
                    var Y = U.maskDiv = rq();
                    if (Y.style.left = 0, Y.style.top = 0, Y.style.width = n.getWidth() + "px", Y.style.height = n.getHeight() + "px", n.getView().appendChild(Y), !n.isContinuousLayout()) {
                        var p = U.resizeDiv = rq();
                        p.style.left = q.style.left, p.style.top = q.style.top, p.style.width = q.style.width, p.style.height = q.style.height, p.style.opacity = n.getDragOpacity(), p.style.background = n.getDividerBackground(), or(U.getView(), p)
                    }
                    U._lastAbsPosition = n._22o, U._86o = Vl(n) ? Fc(r).x : Fc(r).y, gn(U, r)
                }
            },
            handleWindowTouchMove: function (K) {
                Uq(K) && this.update(K, this.sv.isContinuousLayout())
            },
            handleWindowTouchEnd: function (t) {
                var V = this;
                V.update(t, !0), V.sv.setStatus(Mn), V.maskDiv && Kh(V.maskDiv), V.resizeDiv && Kh(V.resizeDiv), V.maskDiv = V.resizeDiv = h
            },
            handle_mousedown: function (D) {
                Bf(D) && this.handle_touchstart(D)
            },
            handleWindowMouseMove: function (z) {
                this.handleWindowTouchMove(z)
            },
            handleWindowMouseUp: function (q) {
                this.handleWindowTouchEnd(q)
            },
            update: function (y, Y) {
                var b = this,
                    T = b.sv,
                    A = Vl(T) ? T.getWidth() : T.getHeight(),
                    h = T._dividerSize,
                    c = b._lastAbsPosition - b._86o;
                Vl(T) ? (c += Fc(y).x, c > A - h && (c = A - h), 0 > c && (c = 0), b.resizeDiv && (b.resizeDiv.style.left = c + Do)) : (c += Fc(y).y, c > A - h && (c = A - h), 0 > c && (c = 0), b.resizeDiv && (b.resizeDiv.style.top = c + Do)), Y && A !== h && (1 === T._82O ? T.setPosition(c, 1) : -1 === T._82O ? T.setPosition(c - A + h, 1) : T.setPosition(c / (A - h), 1))
            }
        }), qj.TabView = function () {
            var G = this,
                t = G._view = xj(1, G),
                y = G._91O = rq(1),
                r = G._tabModel = new Nm,
                v = r.sm(),
                O = G.invalidate;
            G._7o = new vf, G._canvas = Np(y), or(t, y), or(t, G._92O = rq(1)), v.setSelectionMode(er), v.ms(G.handleSelectionChange, G), r.mm(O, G), r.md(O, G), r.mh(O, G), G._interactor = new Jo(G), G.iv()
        }, oo("TabView", x, {
            ms_v: 1,
            ms_fire: 1,
            ms_tx: 1,
            ms_ty: 1,
            ms_lp: 1,
            ms_ac: ["movable", "tabGap", "tabHeight", "tabPosition", kd, Vi, "tabBackground", "selectWidth", Vr, "moveBackground", "insertColor"],
            _tabPosition: $b,
            _tabHeight: xn,
            _tabGap: f.tabViewTabGap,
            _labelColor: f.tabViewLabelColor,
            _labelFont: f.tabViewLabelFont,
            _tabBackground: f.tabViewTabBackground,
            _selectWidth: f.tabViewSelectWidth,
            _selectBackground: f.tabViewSelectBackground,
            _moveBackground: f.tabViewMoveBackground,
            _insertColor: f.tabViewInsertColor,
            _movable: !0,
            handleSelectionChange: function () {
                this._selectionChanged = !0, this.invalidate()
            },
            getContentDiv: function () {
                return this._92O
            },
            getTitleDiv: function () {
                return this._91O
            },
            getTabModel: function () {
                return this._tabModel
            },
            add: function (m, L, c) {
                var h, l = this._tabModel;
                return m instanceof lp ? (h = m, L && h.setView(L)) : (h = new lp, h.setName(m), h.setView(L)), l.add(h), c && l.sm().ss(h), h
            },
            getLabel: function (W) {
                return W.toLabel()
            },
            onPropertyChanged: function () {
                this.iv()
            },
            _7Q: function (E) {
                this._23o = E, this.iv()
            },
            get: function (V) {
                var t = this,
                    k = t._tabModel;
                if (Rj(V)) return k._roots.get(V);
                if (Qc(V)) {
                    var C;
                    return k.each(function (Y) {
                        V === t.getLabel(Y) && (C = Y)
                    }), C
                }
                return V instanceof lp ? V : h
            },
            select: function (j) {
                this._tabModel.sm().ss(this.get(j))
            },
            remove: function (x) {
                var r = this;
                if (x = r.get(x)) {
                    var U = r._tabModel,
                        Y = U._roots.indexOf(x);
                    r._tabModel.remove(x), r.selectByIndex(--Y)
                }
            },
            getCurrentTab: function () {
                return this._8o
            },
            hideTabView: function (j, r) {
                r.parentNode === this._92O && (tq(r) ? (r.style.display = Tr, r._tab_ = j) : Kh(r), hn())
            },
            showTabView: function (R, v) {
                tq(v) && (v.style.display = "block", v._tab_ = R), v.parentNode !== this._92O && (or(this._92O, v), hn())
            },
            _24o: function () {
                var V, v = this,
                    x = v._8o,
                    p = v._9o,
                    z = v._tabModel.sm().ld();
                z && (V = $p(z.getView())), V !== p && (p && (x.getView() && x.getView().endEditing && x.getView().endEditing(), v.hideTabView(x, p)), V && v.showTabView(z, V)), v._8o = z, v._9o = V, x !== z && v.onTabChanged(x, z)
            },
            onTabClosing: function () {
                return !0
            },
            onTabChanged: function () {},
            onTabClosed: function (Y, r) {
                this.selectByIndex(--r)
            },
            selectByIndex: function (P) {
                var j = this,
                    l = j._tabModel,
                    o = l.size();
                if (o && !l.sm().ld()) {
                    P == h && (P = 0), P >= o && (P = o - 1), 0 > P && (P = 0);
                    for (var I = P; I >= 0; I--) {
                        var X = j.get(I);
                        if (!X.isDisabled()) return j.select(X), X
                    }
                    for (I = P + 1; o > I; I++)
                        if (X = j.get(I), !X.isDisabled()) return j.select(X), X
                }
            },
            getTabWidth: function (d) {
                var E = 4,
                    p = Qn(d.getIcon());
                p && (E += Df(p, d) + 4);
                var M = this.getLabel(d);
                return M && (E += Bk(this.getLabelFont(d), M).width + 4), d.isClosable() && (E += 10), E
            },
            drawTab: function (F, D, m, V, o, d, $) {
                var n, I = this,
                    u = I._tabPosition,
                    Q = m + 4,
                    h = I._selectWidth,
                    t = Qn(D.getIcon()),
                    w = D.isDisabled(),
                    i = I.getLabelColor(D),
                    N = I.getLabelFont(D),
                    v = I.getLabel(D),
                    k = I._selectBackground,
                    U = u === ul + "-vertical",
                    R = u === sb + "-vertical";
                (U || R) && (Q = V + 4), w && (F.globalAlpha = Kr), to(F, m, V, o, d, $), D === I._8o && h && (u === $b ? to(F, m, V + d - h, o, h, k) : u === ul ? to(F, m + o - h, V, h, d, k) : u === sb ? to(F, m, V, h, d, k) : U ? to(F, m + o - h, V, h, d, k) : R ? to(F, m, V, h, d, k) : to(F, m, V, o, h, k));
                var a = o / 2;
                if (U && (Aj(F, a, V + d / 2), Zp(F, c), Aj(F, -a, -V - d / 2)), t) {
                    var X = Dd(t, D),
                        J = Df(t, D);
                    if (U || R) {
                        var C = m + o / 2,
                            E = Q + X / 2;
                        Aj(F, C, E), Zp(F, g), Aj(F, -C, -E), nn(F, t, m + o / 2, Q + X / 2, D, I), Aj(F, C, E), Zp(F, -g), Aj(F, -C, -E), Q += X + 4
                    } else nn(F, t, Q + J / 2, V + d / 2, D, I), Q += J + 4
                }
                return U || R ? (Aj(F, o / 2, Q + o / 2), Zp(F, g), Aj(F, -o / 2, -Q - o / 2), Yd(F, v, N, i, m, Q, d, o), Aj(F, o / 2, Q + o / 2), Zp(F, -g), Aj(F, -o / 2, -Q - o / 2)) : Yd(F, v, N, i, Q, V, o, d), U && (Aj(F, a, V + d / 2), Zp(F, -c), Aj(F, -a, -V - d / 2)), D.isClosable() && (n = R ? {
                    x: m + o - 12,
                    y: V + d - 12,
                    width: 12,
                    height: 12
                } : {
                    x: m + o - 12,
                    y: V + 2,
                    width: 12,
                    height: 12
                }, this.drawCloseIcon(D, F, i, n)), w && (F.globalAlpha = 1), n
            },
            drawCloseIcon: function (g, _, w, t) {
                var d = t.x,
                    s = t.y;
                _.strokeStyle = w, _.lineWidth = 1, _.beginPath(), _.moveTo(d + 2, s + 8), _.lineTo(d + 8, s + 2), _.moveTo(d + 8, s + 8), _.lineTo(d + 2, s + 2), _.stroke()
            },
            getTabAt: function (b) {
                var T = this._interactor._8Q(b);
                return T ? T.tab : null
            },
            validateImpl: function () {
                var U = this;
                U._24o();
                var E, q = U._canvas,
                    V = U._tabPosition,
                    M = U._91O,
                    e = U._92O,
                    i = U._tabModel,
                    t = U.getWidth(),
                    u = U.getHeight(),
                    d = U._tabHeight,
                    N = U._7o,
                    I = U._tabGap,
                    p = V === $b,
                    K = V === ul,
                    r = V === sb,
                    f = V === ul + "-vertical",
                    w = V === sb + "-vertical",
                    S = U._23o,
                    F = 0;
                if ((K || r) && i._roots.each(function (s) {
                        F = W(U.getTabWidth(s), F)
                    }), p ? (Qh(M, 0, 0, t, d), E = {
                        x: 0,
                        y: d,
                        width: t,
                        height: W(0, u - d)
                    }) : K ? (Qh(M, 0, 0, F, u), E = {
                        x: F,
                        y: 0,
                        width: W(0, t - F),
                        height: u
                    }) : r ? (Qh(M, t - F, 0, F, u), E = {
                        x: 0,
                        y: 0,
                        width: W(0, t - F),
                        height: u
                    }) : f ? (Qh(M, 0, 0, d, u), E = {
                        x: d,
                        y: 0,
                        width: W(0, t - d),
                        height: u
                    }) : w ? (Qh(M, t - d, 0, d, u), E = {
                        x: 0,
                        y: 0,
                        width: W(0, t - d),
                        height: u
                    }) : (Qh(M, 0, u - d, t, d), E = {
                        x: 0,
                        y: 0,
                        width: t,
                        height: W(0, u - d)
                    }), Qh(e, E), f || w) {
                    U._9o && (E.x = 0, Qh(U._8o.getView(), E)), mc(q, d, u);
                    var T = Hf(q),
                        n = 0;
                    if (Tm(T, 0, U.ty(), 1), T.clearRect(0, 0, d, u), N.clear(), i._roots.each(function (K) {
                            var a, p = U.getTabWidth(K);
                            S && S.tab === K || (a = U.drawTab(T, K, 0, n, d, p, U._tabBackground)), N.add({
                                _75o: a,
                                tab: K,
                                startY: n,
                                endY: n + p,
                                height: p
                            }), n += p + I
                        }), U._23Q = W(0, n - I), S) {
                        var j = S.position;
                        U.drawTab(T, S.tab, 0, S.startY, d, S.height, U._moveBackground), to(T, 0, j, d, 1, U._insertColor)
                    }
                    if (T.restore(), U._selectionChanged) {
                        U._selectionChanged = !1;
                        for (var D = U.ty(), J = 0; J < N.size(); J++) {
                            var X = N.get(J);
                            if (X.tab === U._8o) {
                                if (X.endY + D < 0) {
                                    U.ty(-X.startY);
                                    break
                                }
                                if (X.startY + D > u) {
                                    U.ty(u - X.endY);
                                    break
                                }
                            }
                        }
                    }
                    U.ty(U.ty())
                } else if (K || r) {
                    U._9o && (E.x = 0, Qh(U._8o.getView(), E)), mc(q, F, u);
                    var T = Hf(q),
                        n = 0;
                    if (Tm(T, 0, U.ty(), 1), T.clearRect(0, 0, F, u), N.clear(), i._roots.each(function (x) {
                            var z;
                            S && S.tab === x || (z = U.drawTab(T, x, 0, n, F, d, U._tabBackground)), N.add({
                                _75o: z,
                                tab: x,
                                startY: n,
                                endY: n + d,
                                height: d
                            }), n += d + I
                        }), U._23Q = W(0, n - I), S) {
                        var j = S.position;
                        U.drawTab(T, S.tab, 0, S.startY, F, S.height, U._moveBackground), to(T, 0, j, F, 1, U._insertColor)
                    }
                    if (T.restore(), U._selectionChanged) {
                        U._selectionChanged = !1;
                        for (var D = U.ty(), J = 0; J < N.size(); J++) {
                            var X = N.get(J);
                            if (X.tab === U._8o) {
                                if (X.endY + D < 0) {
                                    U.ty(-X.startY);
                                    break
                                }
                                if (X.startY + D > u) {
                                    U.ty(u - X.endY);
                                    break
                                }
                            }
                        }
                    }
                    U.ty(U.ty())
                } else {
                    U._9o && (E.y = 0, Qh(U._8o.getView(), E)), mc(q, t, d);
                    var T = Hf(q),
                        g = 0;
                    if (Tm(T, U.tx(), 0, 1), T.clearRect(0, 0, t, d), N.clear(), i._roots.each(function (y) {
                            var B, q = U.getTabWidth(y);
                            S && S.tab === y || (B = U.drawTab(T, y, g, 0, q, d, U._tabBackground)), N.add({
                                _75o: B,
                                tab: y,
                                startX: g,
                                endX: g + q,
                                width: q
                            }), g += q + I
                        }), U._64I = W(0, g - I), S) {
                        var j = S.position;
                        U.drawTab(T, S.tab, S.startX, 0, S.width, d, U._moveBackground), hq(T, U._insertColor, j, 0, d)
                    }
                    if (T.restore(), U._selectionChanged) {
                        U._selectionChanged = !1;
                        for (var o = U.tx(), J = 0; J < N.size(); J++) {
                            var X = N.get(J);
                            if (X.tab === U._8o) {
                                if (X.endX + o < 0) {
                                    U.tx(-X.startX);
                                    break
                                }
                                if (X.startX + o > t) {
                                    U.tx(t - X.endX);
                                    break
                                }
                            }
                        }
                    }
                    U.tx(U.tx())
                }
                for (var l = [], O = e.children, J = 0; J < O.length; J++) {
                    var c = O[J],
                        v = c._tab_;
                    v && !i.contains(v) && l.push(c)
                }
                l.forEach(function (D) {
                    e.removeChild(D)
                })
            }
        });
        var Jo = function (D) {
            this.tv = D, this.addListeners()
        };
        zc(Jo, x, {
            ms_listener: 1,
            getView: function () {
                return this.tv._91O
            },
            handle_mousewheel: function (k) {
                this.handleScroll(k, 10 * (k.wheelDelta / 40))
            },
            handle_DOMMouseScroll: function (n) {
                this.handleScroll(n, 10 * -n.detail)
            },
            handleScroll: function (t, f) {
                Bl(t);
                var F = this.tv,
                    w = F._tabPosition;
                !F._40o() || w !== $b && w !== Id || F.tx(this.tv.tx() + f), !F._41o() || w !== ul && w !== sb && w !== ul + "-vertical" && w !== sb + "-vertical" || F.ty(this.tv.ty() + f)
            },
            _8Q: function (Z) {
                var D, X, V = this.tv,
                    x = V._tabPosition,
                    s = V._7o;
                if (x === $b || x === Id) {
                    var C = V.lp(Z).x;
                    for (D = 0; D < s.size(); D++)
                        if (X = s.get(D), X.startX <= C && C <= X.endX) return X
                } else if (x === ul || x === sb || x === ul + "-vertical" || x === sb + "-vertical") {
                    var m = V.lp(Z).y;
                    for (D = 0; D < s.size(); D++)
                        if (X = s.get(D), X.startY <= m && m <= X.endY) return X
                }
                return h
            },
            isClickable: function (p) {
                var G = this.tv,
                    s = G._tabPosition,
                    Y = this._73o = this._8Q(p);
                return !G._40o() || s !== $b && s !== Id ? !G._41o() || s !== ul && s !== sb && s !== ul + "-vertical" && s !== sb + "-vertical" ? Y && (!Y.tab.isDisabled() || G.isMovable()) : !0 : !0
            },
            handle_mousemove: function (D) {
                var O = this;
                wh ? O._74o = O._8Q(D) : O.getView().style.cursor = O.isClickable(D) ? Pf : ""
            },
            handle_mousedown: function (H) {
                this.handle_mousemove(H), this.handle_touchstart(H)
            },
            handle_touchstart: function (I) {
                var c = this,
                    r = c.tv,
                    P = r._tabPosition;
                Bl(I), Bf(I) && c.isClickable(I) && (P === $b || P === Id ? (c.x = Fc(I).x, c.lp = r.lp(I), c.tx = r.tx()) : (c.y = Fc(I).y, c.lp = r.lp(I), c.ty = r.ty()), gn(c, I))
            },
            handleWindowMouseMove: function (l) {
                this.handleWindowTouchMove(l)
            },
            handleWindowTouchMove: function (H) {
                var U, T = this,
                    u = T.tv,
                    Z = u._tabPosition,
                    $ = T._73o;
                if (Z === $b || Z === Id) {
                    if (U = Fc(H).x - T.x, !T._25o && !T.moving && Y(U) > 2 && (u._40o() && !Ab(H) ? T._25o = 1 : $ && u.isMovable() && (T.moving = 1)), T._25o) u.tx(T.tx + U);
                    else if (T.moving) {
                        var b = T.lp.x + U,
                            l = u._tabGap / 2;
                        u._7o.each(function (H) {
                            var w = H.endX,
                                s = b - H.startX < w - b;
                            b >= H.startX && w >= b && u._7Q({
                                tab: $.tab,
                                startX: $.startX + U,
                                width: $.width,
                                front: s,
                                insertTab: H.tab,
                                position: s ? W(0, H.startX - l) : j(u._64I, w + l)
                            })
                        })
                    }
                } else if (U = Fc(H).y - T.y, !T._25o && !T.moving && Y(U) > 2 && (u._41o() && !Ab(H) ? T._25o = 1 : $ && u.isMovable() && (T.moving = 1)), T._25o) u.ty(T.ty + U);
                else if (T.moving) {
                    var F = T.lp.y + U,
                        l = u._tabGap / 2;
                    u._7o.each(function (o) {
                        var h = o.endY,
                            x = F - o.startY < h - F;
                        F >= o.startY && h >= F && u._7Q({
                            tab: $.tab,
                            startY: $.startY + U,
                            height: $.height,
                            front: x,
                            insertTab: o.tab,
                            position: x ? W(0, o.startY - l) : j(u._23Q, h + l)
                        })
                    })
                }
            },
            handleWindowMouseUp: function (p) {
                this.handleWindowTouchEnd(p)
            },
            handleWindowTouchEnd: function () {
                var t = this,
                    W = t.tv,
                    G = W._tabPosition,
                    b = W.getTabModel(),
                    p = b._roots,
                    d = t._73o;
                if (t.moving) {
                    var z = W._23o;
                    if (z && z.insertTab !== z.tab) {
                        var A = z.tab,
                            v = p.remove(A),
                            J = p.indexOf(z.insertTab);
                        J >= 0 && (z.front || J++, J <= p.size() && (p.add(A, J), b._38I(A, v, J)))
                    }
                    W._7Q(h), delete t.moving
                } else if (!t._25o && d) {
                    A = d.tab;
                    var f = t._74o;
                    if (!f || f.tab === A)
                        if (!A.isDisabled() && nr(d._75o, t.lp)) {
                            var X = function () {
                                var B = p.indexOf(A);
                                b.remove(A), W.onTabClosed(A, B)
                            };
                            W.onTabClosing(A, X) && X()
                        } else A.isDisabled() || W._8o === A || b.sm().ss(A)
                }
                t._25o = t._73o = t._74o = G === $b || G === Id ? t.x = t.lp = t.tx = h : t.y = t.lp = t.ty = h
            }
        }), qj.PropertyView = function (o) {
            var M = this;
            M._view = xj(1, M), M._canvas = Np(M._view), or(M._view, M._79O = rq()), M._rows = new vf, M._28o = new vf, M._26o = {}, M._26Q = {};
            var n = M._propertyModel = new Nm,
                p = M.ivm;
            n.mm(p, M), n.md(p, M), n.mh(p, M), M.dm(o ? o : new Nm), new Di(M)
        }, oo("PropertyView", x, {
            ms_ac: [kd, fq, Vi, Tc, Bq, "categorizable", rp, Xc, Wq, gf, de, Fb, Vn, hj, "selectRowIndex", Vr, "background", Sm, Ac, Zi, nh, $i],
            ms_v: 1,
            ms_dm: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            _45o: 1,
            _47o: 1,
            ms_tip: 1,
            _29I: sf,
            _59I: 0,
            _9I: 0,
            _selectRowIndex: -1,
            _editable: !0,
            _batchEditable: !0,
            _categorizable: !0,
            _indent: cn,
            _background: f.propertyViewBackground,
            _expandIcon: f.propertyViewExpandIcon,
            _collapseIcon: f.propertyViewCollapseIcon,
            _scrollBarColor: fe,
            _scrollBarSize: td,
            _autoHideScrollBar: Gr,
            _selectBackground: f.propertyViewSelectBackground,
            _rowHeight: nb,
            _rowLineVisible: f.propertyViewRowLineVisible,
            _rowLineColor: f.propertyViewRowLineColor,
            _10I: .5,
            _columnLineVisible: f.propertyViewColumnLineVisible,
            _columnLineColor: f.propertyViewColumnLineColor,
            _labelColor: f.propertyViewLabelColor,
            _labelSelectColor: f.propertyViewLabelSelectColor,
            _labelFont: f.propertyViewLabelFont,
            getRows: function () {
                return this._rows
            },
            getColumnPosition: function () {
                return this._10I
            },
            setColumnPosition: function (j) {
                0 > j && (j = 0), j > 1 && (j = 1);
                var I = this,
                    N = I._10I;
                I._10I = j, I.fp("columnPosition", N, j)
            },
            getPropertyName: function ($) {
                return $.toLabel()
            },
            getLabelFont: function () {
                return this._labelFont
            },
            getLabelColor: function (C, P, I) {
                return I === this._selectRowIndex ? this._labelSelectColor : this._labelColor
            },
            getPropertyFont: function () {
                return this._labelFont
            },
            getPropertyColor: function (a, q) {
                return q === this._selectRowIndex ? this._labelSelectColor : a.getColor() || this._labelColor
            },
            getCategoryFont: function () {
                return this._labelFont
            },
            getCategoryColor: function () {
                return this._labelColor
            },
            adjustTranslateX: function () {
                return 0
            },
            adjustTranslateY: function (K) {
                var d = this.getHeight() - this._59I;
                return d > K && (K = d), K > 0 ? 0 : r(K)
            },
            isExpanded: function (J) {
                if (!J) return !0;
                var N = this._26o[J];
                return N ? N.isExpanded : !(this._26Q[J] === !1)
            },
            toggle: function (E) {
                var K = this;
                K.isExpanded(E) ? K.collapse(E) : K.expand(E)
            },
            expandAll: function () {
                this.validate();
                for (var L in this._26o) this.expand(L)
            },
            expand: function (S) {
                if (S && S !== Tr) {
                    var Y = this,
                        P = Y._26o[S];
                    P && !P.isExpanded && (P.isExpanded = !0, Y.onExpanded(S), Y.ivm())
                }
            },
            onExpanded: function () {},
            collapseAll: function () {
                this.validate();
                for (var k in this._26o) this.collapse(k)
            },
            collapse: function (n) {
                if (n && n !== Tr) {
                    var h = this,
                        L = h._26o[n];
                    L && L.isExpanded && (L.isExpanded = !1, h.onCollapsed(n), h.ivm())
                }
            },
            onCollapsed: function () {},
            getCategoryName: function (j) {
                if (!this.isCategorizable()) return Tr;
                var E = j.getCategoryName();
                return E ? E : Tr
            },
            getPropertyModel: function () {
                return this._propertyModel
            },
            handleSelectionChange: function () {
                this.ivm()
            },
            setDataModel: function (w) {
                var J = this,
                    I = J._dataModel;
                I !== w && (I && (I.umd(J.handlePropertyChange, J), J._selectionModel || I.sm().ums(J.handleSelectionChange, J)), J._dataModel = w, w.md(J.handlePropertyChange, J), J._selectionModel ? J._selectionModel._21I(w) : w.sm().ms(J.handleSelectionChange, J), J.fp(Oq, I, w))
            },
            isVisible: function (o) {
                return this._visibleFunc ? this._visibleFunc(o) : !0
            },
            onPropertyChanged: function (g) {
                var B = this,
                    f = g.property;
                bi[f] ? B.ivm() : B.iv(), f === qc && B._43o()
            },
            getCurrentData: function () {
                return this._27o
            },
            updateCurrentData: function () {
                this._27o = this.sm().ld()
            },
            getRawProperties: function () {
                return this._27o ? this._propertyModel._roots : il
            },
            handlePropertyChange: function (X) {
                this._27o === X.data && this.iv()
            },
            ivm: function () {
                this.invalidateModel()
            },
            invalidateModel: function () {
                var g = this;
                g._96I || (g.setSelectRowIndex(-1), g._96I = 1, g.iv())
            },
            redraw: function () {
                this.iv()
            },
            validateModel: function () {
                var J = this,
                    G = J._rows,
                    T = J._28o,
                    M = {},
                    v = new vf,
                    I = J._27o;
                J.updateCurrentData(), I !== J._27o && J.endEditing(), G.clear(), T.clear(), J.getRawProperties().each(function (Q) {
                    if (J.isVisible(Q)) {
                        v.add(Q);
                        var P = J.getCategoryName(Q);
                        M[P] || (T.add(P, P === Tr ? 0 : p), M[P] = {
                            isExpanded: J.isExpanded(P),
                            properties: new vf
                        })
                    }
                }), J._sortFunc && v.sort(J._sortFunc);
                for (var F in J._26o) J._26Q[F] = J.isExpanded(F);
                J._26o = M, T.each(function (C) {
                    C !== Tr && G.add(C);
                    var z = M[C];
                    z.isExpanded && v.each(function (Z) {
                        J.getCategoryName(Z) === C && (z.properties.add(Z), G.add({
                            property: Z,
                            data: J._27o
                        }))
                    }, J)
                })
            },
            validateImpl: function () {
                var N = this;
                N._76o(), N._96I && (N.validateModel(), delete N._96I);
                var x = N._canvas,
                    T = N.getWidth(),
                    q = N.getHeight(),
                    y = -N.ty(),
                    o = N._rowHeight,
                    C = N._indent,
                    D = T - C,
                    F = N._rows,
                    J = F.size(),
                    U = N._9I = C + D * N._10I,
                    t = N._59I = J * o;
                mc(x, T, q), N._29I = {
                    x: 0,
                    y: y,
                    width: T,
                    height: q
                }, N._31I = e(y / o), N._14I = _((y + q) / o), N._31I < 0 && (N._31I = 0), N._14I > J && (N._14I = J);
                var r, n = Hf(x),
                    V = N._background;
                Tm(n, 0, -y, 1), n.beginPath(), n.rect(0, y, T, q), n.clip(), n.clearRect(0, y, T, q), N._93db(n), V && to(n, 0, 0, C, t, V);
                for (var Z = N._31I; Z < N._14I; Z++) {
                    var c = F.get(Z),
                        y = o * Z;
                    if (Qc(c)) V && to(n, C, y, D, o, V), r = Qn(N.isExpanded(c) ? N._expandIcon : N._collapseIcon), r && zk(n, r, Hq, 0, y, C, o), n.save(), n.beginPath(), n.rect(C, y, D, o), n.clip(), N.drawCategoryName(n, c, Z, C, y, D, o), n.restore();
                    else {
                        var f = c.property,
                            G = c.data,
                            r = Qn(f.getIcon()),
                            s = N._selectRowIndex === Z ? N.getSelectBackground() : h;
                        if (r && zk(n, r, Hq, 0, y, C, o), s && to(n, C, y, D, o, s), n.save(), n.beginPath(), n.rect(C, y, U - C, o), n.clip(), N.drawPropertyName(n, f, Z, C, y, U - C, o), n.restore(), !N.isEditing(G, f)) {
                            var W = U + 1,
                                R = T - U - 1;
                            n.save(), n.beginPath(), n.rect(W, y, R, o), n.clip(), N._87o(N.drawPropertyValue(n, f, N.getValue(G, f), Z, W, y, R, o, G), Z, W, y, R, o), n.restore()
                        }
                    }
                    N._rowLineVisible && to(n, C, y + o - 1, D, 1, N._rowLineColor)
                }
                N._columnLineVisible && (to(n, U, 0, 1, t, N._columnLineColor), to(n, T - 1, 0, 1, t)), N._92db(n), N._93I(), n.restore(), N.ty(N.ty())
            },
            drawCategoryName: function (x, N, p, O, n, t, T) {
                Yd(x, N, this.getCategoryFont(N), this.getCategoryColor(N), O, n, t, T)
            },
            drawPropertyName: function (Y, Q, A, I, E, h, c) {
                return Q.drawPropertyName ? (Q.drawPropertyName(Y, Q, A, I, E, h, c, this), void 0) : (Yd(Y, this.getPropertyName(Q), this.getPropertyFont(Q, A), this.getPropertyColor(Q, A), I, E, h, c), void 0)
            },
            drawPropertyValue: function (W, D, L, e, g, S, B, c, F) {
                return D.drawPropertyValue ? D.drawPropertyValue(W, D, L, e, g, S, B, c, F, this) : (Xf(W, L, D, this.getLabelFont(D, L, e), this.getLabelColor(D, L, e), g, S, B, c, F, this), void 0)
            },
            isPropertyEditable: function (b) {
                return b.isEditable() && this.isEditable()
            },
            setProperties: function (Y) {
                this._propertyModel.clear(), this.addProperties(Y)
            },
            addProperties: function (x) {
                if (x) {
                    var Z = this._propertyModel;
                    x.forEach(function (j) {
                        if (!(j instanceof ip)) {
                            var I = Po(j.className);
                            j = Th(I ? I : ip, j)
                        }
                        Z.add(j)
                    })
                }
            },
            getRowIndexAt: function (w) {
                var v = this,
                    G = e(v.lp(w).y / v._rowHeight);
                return G >= 0 && G < v._rows.size() ? G : -1
            },
            getPropertyAt: function (B) {
                var J = this,
                    I = J.getRowIndexAt(B);
                return I >= 0 ? J._rows.get(I).property : h
            },
            getToolTip: function (k) {
                var j = this,
                    y = j.getPropertyAt(k),
                    O = j._27o;
                return y && O ? y.getToolTip(O, j._9I < j.lp(k).x, j) : h
            }
        });
        var Di = function (w) {
            this.pv = w, this.addListeners()
        };
        zc(Di, x, {
            ms_listener: 1,
            getView: function () {
                return this.pv._view
            },
            setCursor: function (P) {
                this.getView().style.cursor = P
            },
            clear: function () {
                var H = this;
                H._62O = H.cp = H.ty = H.p = h, H.setCursor(ri)
            },
            handle_mousedown: function (d) {
                this.handle_touchstart(d)
            },
            handle_touchstart: function (u) {
                var l = this,
                    V = l.pv;
                Bl(u), V.setFocus(u) && (Bf(u) ? (l.cp = Fc(u), l.ty = V.ty(), l.p = V.getColumnPosition(), l.handle_touchmove(u)) : V.setSelectRowIndex(V.getRowIndexAt(u)))
            },
            handleWindowMouseUp: function () {
                this.clear()
            },
            handleWindowTouchEnd: function () {
                this.clear()
            },
            handle_mouseup: function (R) {
                this.handle_touchend(R)
            },
            handle_touchend: function (w) {
                var x = this;
                if (x.cp && !x._62O) {
                    var Z = x.pv,
                        H = Z.lp(w),
                        C = H.x,
                        c = H.y,
                        h = Z._indent,
                        _ = Z.getRowIndexAt(w),
                        V = Z._9I;
                    if (_ >= 0) {
                        var A = Z._rowHeight,
                            D = A * _,
                            n = Z._rows.get(_),
                            s = n.property;
                        if (Qc(n)) Qn(Z.isExpanded(n) ? Z._expandIcon : Z._collapseIcon) && C >= 0 && h >= C && c >= D && D + A >= c ? Z.toggle(n) : bo(w) && Z.toggle(n);
                        else if (C > V && Z.isPropertyEditable(s, w)) {
                            var t = {
                                    x: V + 1,
                                    y: D,
                                    width: Z.getWidth() - V - 1,
                                    height: A
                                },
                                d = {
                                    x: t.x + Z.tx(),
                                    y: t.y + Z.ty(),
                                    width: t.width,
                                    height: t.height
                                },
                                e = 0,
                                L = Z._29I;
                            t.y < L.y ? e = t.y - L.y : t.y + A > L.y + L.height && (e = t.y + A - L.y - L.height), e && (Z.ty(Z.ty() - e), d.y -= e), Z.beginEditing({
                                data: n.data,
                                property: s,
                                value: Z.getValue(n.data, s),
                                event: w,
                                rect: t,
                                editorRect: d,
                                view: Z
                            })
                        }
                    }
                    Z.setSelectRowIndex(_)
                }
                x.clear()
            },
            handleWindowMouseMove: function (u) {
                this.handleWindowTouchMove(u)
            },
            handleWindowTouchMove: function (E) {
                var l = this,
                    M = l.pv,
                    x = l.ty,
                    s = l.cp,
                    R = Fc(E),
                    K = l._62O;
                if ("p" === K) M.setTranslateY(x + R.y - s.y);
                else if ("c" === K) {
                    var j = M.getWidth() - M._indent;
                    if (j > 16) {
                        var Q = l.p - (s.x - R.x) / j,
                            o = 16 / j;
                        o > Q && (Q = o), Q > 1 - o && (Q = 1 - o), M.setColumnPosition(Q)
                    }
                } else "s" === K && M.setTranslateY(x + (s.y - R.y) * M._59I / M._29I.height)
            },
            handle_mousemove: function (f) {
                this.handle_touchmove(f)
            },
            handle_touchmove: function (z) {
                if (!wh && Bf(z)) {
                    var Q = this,
                        m = Q.pv,
                        r = Y(m.lp(z).x - m._9I) <= (ah ? 8 : 3);
                    Q.cp ? Q._62O || (r ? (Q._62O = "c", gn(Q)) : Y(Fc(z).y - Q.cp.y) >= 2 && (Q._62O = Q.isV(z) ? "s" : "p", gn(Q))) : (r ? Q.setCursor(xo) : Q.setCursor(ri), Q.isV(z) && m._43o())
                }
            },
            isV: function (v) {
                var C = this.pv,
                    n = C._29I;
                return C._41o() && n.x + n.width - C.lp(v).x < ys
            },
            handle_mousewheel: function (p) {
                this.handleScroll(p, p.wheelDelta / 40)
            },
            handle_DOMMouseScroll: function (A) {
                2 === A.axis && this.handleScroll(A, -A.detail)
            },
            handleScroll: function (t, x) {
                var y = this.pv;
                Bl(t), y.endEditing(), y.translate(0, x * y.getRowHeight())
            },
            handle_keydown: function (E) {
                var Q = this.pv,
                    G = Q._rows.size(),
                    j = Q._selectRowIndex + (Ge(E) ? -1 : 1);
                (Ge(E) || Qg(E)) && (0 > j && (j = 0), j >= G && (j = G - 1), Q.setSelectRowIndex(j))
            }
        }), qj.ListView = function (T) {
            this._5o(T), new ii(this)
        }, oo("ListView", x, {
            ms_ac: [kd, fq, Vi, Sm, rp, Ac, Zi, Xc, Wq, Fb, Vn, hj, tj, Vr],
            ms_v: 1,
            ms_bnb: 1,
            ms_tip: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            _14Q: 1,
            ms_dm: 1,
            _45o: 1,
            _checkMode: !1,
            _indent: cn,
            _rowHeight: nb,
            _rowLineVisible: f.listViewRowLineVisible,
            _rowLineColor: f.listViewRowLineColor,
            _scrollBarColor: fe,
            _scrollBarSize: td,
            _autoMakeVisible: Ei,
            _autoHideScrollBar: Gr,
            _selectBackground: f.listViewSelectBackground,
            _labelColor: f.listViewLabelColor,
            _labelSelectColor: f.listViewLabelSelectColor,
            _labelFont: f.listViewLabelFont,
            isCheckMode: function () {
                return this._checkMode
            },
            setCheckMode: function (Y) {
                var q = this,
                    s = q._checkMode;
                q._checkMode = Y, q.fp(wo, s, Y)
            },
            drawRow: function (X, r, S, i, y, R, d) {
                var P = this,
                    o = 0,
                    u = P._indent,
                    J = P.getIconWidth(r);
                P.drawRowBackground(X, r, S, i, y, R, d), P._checkMode && (nn(X, Qn(P.getCheckIcon(r)), o + u / 2, y + d / 2, r, P), o += u), P.drawIcon(X, r, o, y, J, d), P.drawLabel(X, r, o + J, y, d)
            }
        });
        var ii = function (t) {
            this.list = t, this._lastSelectDataTime = Td(), this.addListeners()
        };
        zc(ii, x, {
            ms_listener: 1,
            getView: function () {
                return this.list._view
            },
            clear: function (j) {
                var y = this,
                    E = y.list;
                j && "d" === y._62O && !y.dragCancel && E.handleDragAndDrop(j, "end"), E.draggingData && (E.draggingData = null, E.redraw()), y.dragCancel = y._62O = y._isV = y._isH = y.cp = y.tx = y.ty = h
            },
            handle_mousedown: function (w) {
                this.handle_touchstart(w)
            },
            handle_touchstart: function (G) {
                var e = this,
                    s = e.list;
                if (Bl(G), s.setFocus(G)) {
                    var Y = s.getDataAt(G);
                    e.cp = Fc(G), e.tx = s.tx(), e.ty = s.ty(), Bf(G) ? Y && s.handleDragAndDrop && !e.isV(G) && !e.isH(G) && (s.draggingData = Y, s.redraw(), s.handleDragAndDrop(G, "prepare")) : (Y && e._33o(G, Y), e.clear(G))
                }
            },
            handleWindowMouseUp: function (M) {
                this.clear(M)
            },
            handleWindowTouchEnd: function (N) {
                this.clear(N)
            },
            handle_mouseup: function (Y) {
                this.handle_touchend(Y)
            },
            handle_touchend: function (x) {
                var o = this,
                    Q = o.list;
                if (!o._isV && !o._isH && o.cp && !o._62O) {
                    var $ = Q.getDataAt(x);
                    $ ? (Q.isCheckMode() ? o._34o(x, $) : o._33o(x, $), bo(x) ? Q.onDataDoubleClicked($, x) : Q.onDataClicked($, x)) : Q.handleBackgroundClick(x)
                }
                o.clear(x)
            },
            handleWindowMouseMove: function (Z) {
                this.handleWindowTouchMove(Z)
            },
            handleWindowTouchMove: function (E) {
                var K = this,
                    t = K.list,
                    d = K._62O,
                    o = K.tx,
                    v = K.ty,
                    R = K.cp,
                    f = Fc(E),
                    r = t._29I;
                "p" === d ? t.setTranslate(o + f.x - R.x, v + f.y - R.y) : "v" === d ? t.ty(v + (R.y - f.y) * t._59I / r.height) : "h" === d ? t.tx(o + (R.x - f.x) * t._91I / r.width) : "d" === d && (K.dragCancel || t.handleDragAndDrop(E, "between"))
            },
            handle_mousemove: function (d) {
                this.handle_touchmove(d)
            },
            handle_touchmove: function (O) {
                if (!wh && Bf(O)) {
                    var F = this,
                        e = F.list;
                    if (F._isV = F.isV(O), F._isH = F.isH(O), F.cp) {
                        if (!F._62O) {
                            if (Me(Fc(O), F.cp) < 2) return;
                            F._isV ? F._62O = "v" : F._isH ? F._62O = "h" : e.draggingData && !this.dragCancel ? (F._62O = "d", e.handleDragAndDrop(O, "begin")) : F._62O = "p", F._62O && "d" !== F._62O && e.draggingData && (e.draggingData = null, e.redraw()), gn(F)
                        }
                    } else F._isV && e._43o(), F._isH && e._42o()
                }
            },
            isV: function (e) {
                var A = this.list,
                    n = A._29I;
                return A._41o() && n.x + n.width - A.lp(e).x < ys
            },
            isH: function (O) {
                var N = this.list,
                    o = N._29I;
                return N._40o() && o.y + o.height - N.lp(O).y < ys
            },
            handle_mousewheel: function (d) {
                this.handleScroll(d, d.wheelDelta / 40, d.wheelDelta !== d.wheelDeltaX)
            },
            handle_DOMMouseScroll: function (L) {
                this.handleScroll(L, -L.detail, 1)
            },
            handleScroll: function (E, Y, S) {
                var l = this.list;
                Bl(E), l.endEditing && l.endEditing(), S && l._41o() ? l.translate(0, Y * l.getRowHeight()) : l._40o() && l.translate(10 * Y, 0)
            },
            handle_keydown: function (B) {
                if (!f.isInput(B.target)) {
                    var z, n = this.list,
                        N = n.sm(),
                        V = n._rows,
                        D = V.size();
                    if (ed(B)) n.selectAll();
                    else if (Lp(B)) n.handleDelete && n.handleDelete(B);
                    else if (fm(B)) "d" !== this._62O || this.dragCancel || (n.handleDragAndDrop(B, "cancel"), this.dragCancel = !0);
                    else if (Bo(B)) n.isCheckMode() && (z = n.getFocusData(), z && n.checkData(z));
                    else if (Ge(B) || Qg(B)) {
                        var L = n.isCheckMode();
                        if (z = L ? n.getFocusData() : N.ld()) {
                            var l = n.getRowIndex(z);
                            l >= 0 && (Ge(B) ? 0 !== l && (z = V.get(l - 1), L ? n.setFocusData(z) : N.ss(z)) : l !== D - 1 && (z = V.get(l + 1), L ? n.setFocusData(z) : N.ss(z)))
                        } else D > 0 && (z = V.get(0), L ? n.setFocusData(z) : N.ss(z))
                    }
                }
            },
            _34o: function (N, Y) {
                var x = this.list,
                    E = x.lp(N).x;
                return E >= 0 && E <= x._indent ? (x.checkData(Y), void 0) : (x.setFocusData(Y), void 0)
            },
            _33o: function (g, f) {
                var j = this.list,
                    $ = j.sm(),
                    Y = $.ld();
                if (Ab(g)) j.isSelected(f) ? $.rs(f) : $.as(f);
                else if (Lg(g))
                    if (Y)
                        for (var D = j.getRowIndex(Y), v = j.getRowIndex(f); D !== v;) D += v > D ? 1 : -1, $.as(j._rows.get(D));
                    else $.ss(f);
                else if (Bf(g)) {
                    var Z = Td();
                    if ($.contains(f)) {
                        var O = Z - this._lastSelectDataTime;
                        j.handleDataDoubleSelect && O > 500 && 1500 > O && j.handleDataDoubleSelect(g, f)
                    }
                    $.ss(f), this._lastSelectDataTime = Z
                } else $.contains(f) || $.ss(f)
            }
        }), qj.TreeView = function (t) {
            var J = this;
            J._35o(), J._5o(t), new Pl(J)
        }, oo("TreeView", x, {
            ms_ac: [kd, fq, Vi, "rootVisible", wo, "rootData", Xc, Wq, Fb, Vn, hj, rp, Sm, Ac, Zi, gf, de, tj, Vr, "loader", "doubleClickToToggle"],
            ms_v: 1,
            ms_bnb: 1,
            ms_tip: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            ms_dm: 1,
            _48o: 1,
            _14Q: 1,
            _45o: 1,
            _checkMode: h,
            _indent: cn,
            _rowHeight: nb,
            _rowLineVisible: f.treeViewRowLineVisible,
            _rowLineColor: f.treeViewRowLineColor,
            _scrollBarColor: fe,
            _scrollBarSize: td,
            _autoHideScrollBar: Gr,
            _expandIcon: f.treeViewExpandIcon,
            _collapseIcon: f.treeViewCollapseIcon,
            _autoMakeVisible: Ei,
            _selectBackground: f.treeViewSelectBackground,
            _labelColor: f.treeViewLabelColor,
            _labelSelectColor: f.treeViewLabelSelectColor,
            _labelFont: f.treeViewLabelFont,
            _doubleClickToToggle: f.treeViewDoubleClickToToggle,
            drawRow: function (i, n, c, _, y, P, W) {
                var l = this;
                l.drawRowBackground(i, n, c, _, y, P, W), l._97I(i, n, c, 0, y, P, W)
            },
            isOnToggleIcon: function (q) {
                var $ = this.getDataAt(q);
                if ($) {
                    var S = this.getIndent(),
                        D = this.lp(q).x;
                    if (Qn(this.getToggleIcon($))) {
                        var X = S * this.getLevel($);
                        if (D >= X && X + S >= D) return !0
                    }
                }
                return !1
            }
        });
        var Pl = function (e) {
            cj(Pl, this, [e])
        };
        zc(Pl, ii, {
            toggle: function (c, H, s, j) {
                var R = this.list,
                    m = R.lp(c).x;
                if (Qn(R.getToggleIcon(H))) {
                    var n = s * j;
                    if (m >= n && n + s >= m) return R.toggle(H), !0
                }
                return R.isDoubleClickToToggle() && bo(c) ? (R.toggle(H), !0) : !1
            },
            _34o: function (C, U) {
                var X = this.list,
                    u = X.lp(C).x,
                    R = X._levelMap[U._id],
                    k = X._indent,
                    $ = k * (R + 1);
                return u >= $ && $ + k >= u ? (X.checkData(U), void 0) : (this.toggle(C, U, k, R) || X.setFocusData(U), void 0)
            },
            _33o: function (F, a) {
                var O = this,
                    m = O.list;
                O.toggle(F, a, m._indent, m.getLevel(a)) || Pl.superClass._33o.call(O, F, a)
            },
            handle_keydown: function (o) {
                if (we(o) || yf(o)) {
                    var i = this.list,
                        V = i._rows,
                        z = i.isCheckMode(),
                        P = i.sm(),
                        v = z ? i.getFocusData() : P.ld();
                    v ? v.hasChildren() && (we(o) ? i.collapse(v) : i.expand(v)) : V.size() > 0 && (v = V.get(0), z ? i.setFocusData(v) : P.ss(v))
                } else Pl.superClass.handle_keydown.call(this, o)
            }
        });
        var Ue = qj.TableView = function (x) {
            this._98I(), this._5o(x), new ve(this)
        };
        oo("TableView", x, {
            ms_ac: [kd, fq, Vi, "sortMode", Tc, Bq, Sm, Ac, Zi, nh, $i, "sortColumn", Xc, Wq, Fb, Vn, hj, tj, Vr],
            ms_v: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            ms_dm: 1,
            ms_tip: 1,
            _50o: 1,
            _45o: 1,
            _47o: 1,
            _sortMode: Rh,
            _editable: !0,
            _batchEditable: !1,
            _rowHeight: nb,
            _rowLineVisible: f.tableViewRowLineVisible,
            _rowLineColor: f.tableViewRowLineColor,
            _columnLineVisible: f.tableViewColumnLineVisible,
            _columnLineColor: f.tableViewColumnLineColor,
            _scrollBarColor: fe,
            _scrollBarSize: td,
            _autoHideScrollBar: Gr,
            _autoMakeVisible: Ei,
            _selectBackground: f.tableViewSelectBackground,
            _labelColor: f.tableViewLabelColor,
            _labelSelectColor: f.tableViewLabelSelectColor,
            _labelFont: f.tableViewLabelFont,
            getCheckColumn: function () {
                var B = this;
                if (!B._31o) {
                    var X = B._31o = new rs;
                    X.setEditable(!0), X.setWidth(40), X.getValue = B.getCheckColumValue, X.drawCell = B.drawCheckColumnCell
                }
                return B._31o
            },
            isCheckMode: function () {
                return this._39o.contains(this._31o)
            },
            setCheckMode: function (s) {
                var d = this,
                    z = d._39o,
                    t = d.getCheckColumn();
                s !== d.isCheckMode() && (s ? z.add(t, 0) : z.remove(t), d.fp(wo, !s, s))
            },
            getCheckColumValue: function (C, V, c) {
                return c.isSelected(C)
            },
            drawCheckColumnCell: function (z, I, f, a, P, B, Y, O, d) {
                nn(z, d.getCheckIcon(I), P + Y / 2, B + O / 2, I, d)
            }
        });
        var ve = function (z) {
            cj(ve, this, [z])
        };
        zc(ve, ii, {
            _34o: function (y, A) {
                var l = this.list,
                    C = l._31o;
                if (l.isCellEditable(A, C, y)) {
                    var V = l._3Q(C),
                        G = l.lp(y).x;
                    if (V && G >= V.startX && G < V.startX + C.getWidth()) return l.checkData(A), void 0
                }
                l._37O(A, y), l.setFocusData(A)
            },
            _33o: function (X, _) {
                this.list._37O(_, X), ve.superClass._33o.apply(this, arguments)
            }
        });
        var cp = qj.TreeTableView = function (h) {
                var W = this,
                    K = W._4o = new rs;
                W._35o(), W._98I(), W._5o(h), K.setDisplayName("Name"), K.setEditable(!0), K.setWidth(180), K.drawCell = Mo, K.getValue = jn, W._39o.add(K), new ke(W)
            },
            Mo = function (N, c, i, n, G, V, A, O, h) {
                h._97I(N, c, i, G, V, A, O)
            },
            jn = function (T, d, Y) {
                return Y.getLabel(T)
            };
        oo("TreeTableView", x, {
            ms_ac: [kd, fq, Vi, "sortMode", Tc, Bq, rp, wo, "rootData", "rootVisible", Xc, Wq, "sortColumn", gf, de, Fb, Vn, hj, tj, Zi, Sm, Ac, nh, $i, Vr, "loader"],
            ms_v: 1,
            ms_bnb: 1,
            ms_fire: 1,
            ms_sm: 1,
            _49o: 1,
            ms_txy: 1,
            ms_lp: 1,
            ms_vs: 1,
            ms_hs: 1,
            _15Q: 1,
            ms_dm: 1,
            ms_tip: 1,
            _50o: 1,
            _48o: 1,
            _14Q: 1,
            _45o: 1,
            _47o: 1,
            _sortMode: Rh,
            _checkMode: h,
            _editable: !0,
            _batchEditable: !1,
            _indent: cn,
            _rowHeight: nb,
            _rowLineVisible: f.treeTableViewRowLineVisible,
            _rowLineColor: f.treeTableViewRowLineColor,
            _columnLineVisible: f.treeTableViewColumnLineVisible,
            _columnLineColor: f.treeTableViewColumnLineColor,
            _expandIcon: f.treeTableViewExpandIcon,
            _collapseIcon: f.treeTableViewCollapseIcon,
            _scrollBarColor: fe,
            _scrollBarSize: td,
            _autoHideScrollBar: Gr,
            _autoMakeVisible: Ei,
            _selectBackground: f.treeTableViewSelectBackground,
            _labelColor: f.treeTableViewLabelColor,
            _labelSelectColor: f.treeTableViewLabelSelectColor,
            _labelFont: f.treeTableViewLabelFont,
            getTreeColumn: function () {
                return this._4o
            }
        });
        var ke = function (k) {
            cj(ke, this, [k])
        };
        zc(ke, ii, {
            _34o: function (M, $) {
                var W = this.list,
                    y = W._4o,
                    J = W._3Q(y),
                    U = W.lp(M).x;
                if (J) {
                    var x = W._indent,
                        p = J.startX + x * W.getLevel($);
                    if (Qn(W.getToggleIcon($)) && U >= p && p + x >= U) return W.toggle($), void 0;
                    if (W.isCellEditable($, y) && (p += x, U >= p && p + x >= U)) return W.checkData($), void 0
                }
                W._37O($, M), W.setFocusData($)
            },
            _33o: function (Q, p) {
                var O = this.list,
                    n = O.lp(Q).x;
                if (Qn(O.getToggleIcon(p))) {
                    var q = O._3Q(O._4o);
                    if (q) {
                        var L = O._indent,
                            Z = q.startX + L * O.getLevel(p);
                        if (n >= Z && Z + L >= n) return O.toggle(p), void 0
                    }
                }
                O._37O(p, Q), ke.superClass._33o.apply(this, arguments)
            }
        });
        var Ie = qj.TableHeader = function (i) {
            var E = this,
                V = E._view = xj(1, E),
                l = E._39o = i.getColumnModel(),
                h = E.iv;
            E.tv = E._tableView = i, E._60I = new vf, E._canvas = Np(V), V.style.background = f.tableHeaderBackground || "", V.style.height = yb + Do, l.mm(h, E), l.md(h, E), l.mh(h, E), i.mp(function (Q) {
                vq[Q.property] && E.iv()
            }, E), new Be(E), E.iv()
        };
        oo("TableHeader", x, {
            ms_v: 1,
            ms_lp: 1,
            ms_fire: 1,
            ms_ac: ["checkIcon", "sortDescIcon", "sortAscIcon", kd, Vi, rp, "moveBackground", "insertColor", nh, $i, "resizable", "movable"],
            _checkIcon: yd,
            _movable: !0,
            _resizable: !0,
            _labelColor: f.tableHeaderLabelColor,
            _labelFont: f.tableHeaderLabelFont,
            _columnLineColor: f.tableHeaderColumnLineColor,
            _columnLineVisible: f.tableHeaderColumnLineVisible,
            _sortDescIcon: f.tableHeaderSortDescIcon,
            _sortAscIcon: f.tableHeaderSortAscIcon,
            _moveBackground: f.tableHeaderMoveBackground,
            _insertColor: f.tableHeaderInsertColor,
            _indent: cn,
            getCheckIcon: function () {
                return this._checkIcon
            },
            getTableView: function () {
                return this.tv
            },
            getLabel: function (H) {
                return H.toLabel()
            },
            getLabelFont: function () {
                return this._labelFont
            },
            getLabelColor: function (e) {
                return e.getColor() || this._labelColor
            },
            getLabelAlign: function (y) {
                return y._align
            },
            onPropertyChanged: function () {
                this.iv()
            },
            _5Q: function (Q) {
                this._61I = Q, this.iv()
            },
            getLogicalPoint: function (v) {
                return jm(v, this._canvas, this.tv.tx())
            },
            validateImpl: function () {
                var m = this,
                    C = m._canvas,
                    h = m.getWidth(),
                    D = m.getHeight(),
                    O = m.tv,
                    v = m._60I,
                    r = m._61I,
                    E = -O.tx(),
                    c = 0;
                (h !== C.clientWidth || D !== C.clientHeight) && mc(C, h, D), v.clear(), m._39o._roots.each(function (O) {
                    if (O.isVisible()) {
                        var w = c + O.getWidth();
                        E + h >= c && w >= E && v.add({
                            column: O,
                            startX: c
                        }), c = w
                    }
                });
                var I = Hf(C);
                if (Tm(I, -E, 0, 1), I.beginPath(), I.rect(E, 0, h, D), I.clip(), I.clearRect(E, 0, h, D), v.each(function (c) {
                        var F = c.column,
                            h = c.startX,
                            O = F.getWidth();
                        O > 0 && (I.save(), I.beginPath(), I.rect(h, 0, O, D), I.clip(), r && r.column === F || m.drawColumn(I, F, h, 0, O, D), m._columnLineVisible && to(I, h + O - 1, 0, 1, D, m._columnLineColor), I.restore())
                    }), r) {
                    var f = r.column,
                        c = r.startX,
                        N = r.position,
                        Y = f.getWidth();
                    I.save(), I.beginPath(), I.rect(c, 0, Y, D), I.clip(), I.fillStyle = m._moveBackground, I.fill(), m.drawColumn(I, f, c, 0, Y, D), I.restore(), hq(I, m._insertColor, N, 0, D)
                }
                I.restore()
            },
            _6Q: function (Q) {
                var A = this.tv;
                return A._31o === Q && A.sm().getSelectionMode() === Io
            },
            drawColumn: function (B, f, D, S, h, i) {
                var H = this,
                    p = H.tv,
                    R = Qn(f.getIcon()),
                    N = H.getLabelAlign(f);
                if (H._6Q(f)) {
                    var G = Qn(H._checkIcon);
                    nn(B, G, D + h / 2, S + i / 2, f, H)
                } else {
                    var b = H.getLabel(f),
                        v = H.getLabelFont(f),
                        q = H.getLabelColor(f),
                        O = Bk(v, b).width,
                        V = R ? H._indent : 0;
                    N === ul ? (R && zk(B, R, Hq, D, S, V, i), Yd(B, b, v, q, D + V, S, h, i, ul)) : N === sb ? (R && zk(B, R, Hq, D + h - O - V, S, V, i), Yd(B, b, v, q, D, S, h, i, sb)) : (R && zk(B, R, Hq, D + (h - O - V) / 2, S, V, i), Yd(B, b, v, q, D + (h - O + V) / 2, S, 0, i, ul))
                }
                if (f.isSortable() && p.getSortColumn() === f && (R = Qn(f.getSortOrder() === ye ? H._sortAscIcon : H._sortDescIcon))) {
                    var T = Df(R, f) / 2 + 2;
                    nn(B, R, N === sb ? D + T : D + h - T, S + i / 2, f, p)
                }
            }
        });
        var Be = function (g) {
            var U = this;
            U.th = g, U.tv = g._tableView, U.addListeners()
        };
        zc(Be, x, {
            ms_listener: 1,
            getView: function () {
                return this.th.getView()
            },
            setCursor: function (B) {
                this.getView().style.cursor = B
            },
            handle_mousemove: function (P) {
                if (!wh) {
                    var c = this;
                    delete c._29o, c.setCursor(ri);
                    for (var J = c.th, E = J._60I, z = J.lp(P).x, s = E.size() - 1; s >= 0; s--) {
                        var A = E.get(s),
                            I = A.column,
                            x = A.startX + I.getWidth();
                        if (J.isResizable() && Y(x - z) <= (ah ? 10 : 3)) return c._29o = A, c.setCursor(xo), void 0;
                        z > A.startX && x > z && (c._29o = A), (I.isClickable() || I.isSortable() || J.isMovable() || c.tv.getCheckColumn && I === c.tv.getCheckColumn()) && z > A.startX && x > z && c.setCursor(Pf)
                    }
                }
            },
            handle_mousedown: function (I) {
                this.handle_touchstart(I)
            },
            handle_touchstart: function (A) {
                var r = this;
                Bl(A), r.tv.endEditing(), r.handle_mousemove(A), r._29o && (r.x = Fc(A).x, r.lx = r.th.lp(A).x, r.w = r._29o.column.getWidth(), gn(r, A))
            },
            handleWindowMouseMove: function (_) {
                this.handleWindowTouchMove(_)
            },
            handleWindowTouchMove: function (r) {
                var _ = this,
                    B = _.th,
                    H = _.getView().style.cursor,
                    V = _._29o,
                    y = Fc(r).x - _.x;
                if (_.resizing || _.moving || (H === xo ? _.resizing = 1 : B.isMovable() && H === Pf && Y(y) > 2 && (_.moving = 1)), _.resizing) V.column.setWidth(_.w + y);
                else if (_.moving) {
                    var h = _.lx + y;
                    B._60I.each(function (j) {
                        var T = j.startX,
                            b = T + j.column.getWidth();
                        if (h >= T && b >= h) {
                            var G = {
                                column: V.column,
                                startX: V.startX + y,
                                front: b - h > h - T,
                                insertColumn: j.column
                            };
                            G.position = G.front ? T : b, B._5Q(G)
                        }
                    })
                }
            },
            _16Q: function (t, g) {
                var L = this,
                    X = L.tv,
                    c = L.th,
                    R = c._checkIcon;
                if (c._6Q(t)) {
                    var F = Qn(R),
                        W = L.lx,
                        A = t.getWidth(),
                        N = Df(F, t);
                    if (W >= g + A / 2 - N && g + A / 2 + N >= W) {
                        c.setCheckIcon(R === Mb ? yd : Mb);
                        var Z = X.sm(),
                            G = X._rows;
                        return R === Mb ? Z.rs(G) : Z.ss(G), X.onCheckColumnClicked(t), !0
                    }
                }
                return !1
            },
            handleWindowMouseUp: function (N) {
                this.handleWindowTouchEnd(N)
            },
            handleWindowTouchEnd: function (E) {
                var p = this,
                    k = p.tv,
                    F = p.th,
                    q = p._29o;
                if (p.moving) {
                    var v = F._61I;
                    if (v && v.insertColumn !== v.column) {
                        var J = v.column,
                            X = k.getColumnModel()._roots,
                            Z = X.remove(J),
                            K = X.indexOf(v.insertColumn);
                        K >= 0 && (v.front || K++, K <= X.size() && (X.add(J, K), k.getColumnModel()._38I(J, Z, K)))
                    }
                    F._5Q(h), delete p.moving
                } else if (!p.resizing && q) {
                    J = q.column;
                    var o = F.lp(E).x,
                        u = q.startX,
                        O = !0;
                    if (F.onColumnClicked) {
                        var $ = F.onColumnClicked(J, E, u);
                        $ === !1 && (O = !1)
                    }
                    if (O && o >= u && o <= u + J.getWidth() && !p._16Q(J, u)) {
                        if (J.isSortable()) {
                            var Y = k.getSortMode(),
                                z = J.getSortOrder();
                            Y === Rh ? k.getSortColumn() === J ? (z === qr && k.setSortColumn(h), J.setSortOrder(z === ye ? qr : ye)) : k.setSortColumn(J) : "bistate" === Y && (k.getSortColumn() === J ? J.setSortOrder(z === ye ? qr : ye) : k.setSortColumn(J))
                        }
                        k.onColumnClicked(J, E, u)
                    }
                }
                p._29o = p.resizing = p.x = p.lx = p.w = h
            }
        }), qj.TablePane = function (r) {
            this.init(new Ue(r))
        }, oo("TablePane", x, {
            ms_v: 1,
            _44o: 1
        }), qj.TreeTablePane = function (V) {
            this.init(new cp(V))
        }, oo("TreeTablePane", x, {
            ms_v: 1,
            _44o: 1
        }), qj.Toolbar = function (R) {
            var $ = this,
                T = $._view = xj(1, $),
                t = T.style;
            t.background = f.toolbarBackground || "", t.height = xn + Do, $._canvas = Np(T), $._30o = new vf, $._90I = new vf, $.setItems(R || []), T.handleGroupSelectedChanged = function (p) {
                if (p.isSelected()) {
                    var g = p.getGroupId();
                    null != g && $._items.forEach(function (q) {
                        var d = q.element;
                        d && d !== p && d.setSelected && d.getGroupId && d.getGroupId() === g && d.setSelected(!1)
                    })
                }
            }, new Xr($)
        }, oo("Toolbar", x, {
            ms_v: 1,
            ms_fire: 1,
            ms_tx: 1,
            ms_lp: 1,
            ms_tip: 1,
            ms_value: 1,
            ms_ac: [Nb, kd, Vi, fq, Vr, "itemGap", "separatorColor", "currentItem", "stickToRight"],
            _labelColor: f.toolbarLabelColor,
            _labelSelectColor: f.toolbarLabelSelectColor,
            _labelFont: f.toolbarLabelFont,
            _selectBackground: f.toolbarSelectBackground,
            _itemGap: f.toolbarItemGap,
            _separatorColor: f.toolbarSeparatorColor,
            _stickToRight: !1,
            getSumWidth: function () {
                return this._64I
            },
            getToolTip: function (Y) {
                var R = this.getItemInfoAt(Y);
                return R ? R.item.toolTip : h
            },
            getLabelColor: function (G) {
                return G && G.selected && G.type !== Mb && G.type !== Yl ? this._labelSelectColor : this._labelColor
            },
            onPropertyChanged: function (Y) {
                this.iv(), Y.property === Nb && this._items.forEach(function (e) {
                    Yj(e)
                })
            },
            redraw: function () {
                this.iv()
            },
            addItem: function (I, Q) {
                var N = this._items;
                Q == h ? N.push(I) : N.splice(Q, 0, I), this.fp(Nb, h, N)
            },
            removeItem: function (O) {
                if (O)
                    for (var H = this._items, o = 0; o < H.length; o++) O === H[o] && (H.splice(o, 1), this.fp(Nb, h, H))
            },
            removeItemById: function (e) {
                if (e != h)
                    for (var _ = this._items, n = 0; n < _.length; n++)
                        if (e === _[n].id) {
                            var E = _.splice(n, 1)[0];
                            return this.fp(Nb, h, _), E
                        }
            },
            getItemById: function (B) {
                if (B != h)
                    for (var Z = this._items, X = 0; X < Z.length; X++) {
                        var o = Z[X];
                        if (B === o.id) return o
                    }
            },
            setItemVisible: function (P, g) {
                var Q = this.getItemById(P);
                Q && (Q.visible = g)
            },
            getItemInfos: function () {
                return this._30o
            },
            getItemInfoAt: function (o) {
                var S = this,
                    e = 0,
                    R = S._30o,
                    D = S.lp(o),
                    U = D.x,
                    i = D.y;
                if (i >= 0 && i <= S.getHeight())
                    for (; e < R.size(); e++) {
                        var j = R.get(e);
                        if (j.startX <= U && U <= j.endX) return j
                    }
                return h
            },
            drawItem: function (b, C, Z, u, L) {
                if (C.visible === !1) return 0;
                if (Yr(C.visible) && !C.visible()) return 0;
                var w = this,
                    t = C.disabled;
                t && (b.globalAlpha = Kr);
                var S = w.drawItemImpl(b, C, Z, u, L),
                    n = w._itemGap;
                return t && (b.globalAlpha = 1), this._currentItem !== C || "separator" === C || C.separator === !0 || C.unfocusable || Yq(b, w._separatorColor, Z - n / 2, 0, S + n, u), S
            },
            drawItemImpl: function (D, v, l, N, p) {
                var c = this,
                    W = c._view,
                    C = c._itemGap,
                    P = N / 2,
                    b = v.type,
                    y = v.element,
                    Y = v.label;
                Qc(y) && (Y = y, y = h);
                var s, Q = c.getLabelFont(v),
                    d = c.getLabelColor(v),
                    g = v.selected,
                    G = Qn(v.icon),
                    H = Df(G, v),
                    k = 0,
                    e = H + (Y ? Bk(Q, Y).width : 0);
                if ("separator" === v || v.separator === !0) return hq(D, c._separatorColor, l, N / 4, P), 1;
                if (y) {
                    G && nn(D, G, l + H / 2, P, v, c), Yd(D, Y, Q, d, l + H, 0, 0, N);
                    var X = $p(y);
                    p || c._90I.add(X), X.parentNode !== W && or(W, X), y.iv && y.iv(), y.validate && y.validate();
                    var Z = X.getBoundingClientRect(),
                        m = Z.width,
                        u = X.style;
                    return Eh(X), u.left = c.tx() + l + e + Do, u.top = (N - Z.height) / 2 + Do, e + m
                }
                return b === Yl ? s = Qn(g ? _l : bs) : b === Mb && (s = Qn(g ? Mb : yd)), s ? (k = Df(s, v), nn(D, s, l + k / 2, P, v, c), l += k, e += k) : g && to(D, l - C / 2, 0, e + C, N, c.getSelectBackground(v)), G && nn(D, G, l + H / 2, P, v, c), Yd(D, Y, Q, d, l + H, 0, 0, N), e
            },
            validateImpl: function () {
                var U = this,
                    f = U._canvas,
                    z = U.getWidth(),
                    q = U.getHeight(),
                    A = U._30o,
                    d = U._items;
                mc(f, z, q);
                var p = Hf(f),
                    t = U._itemGap,
                    k = t / 2;
                Tm(p, U.tx(), 0, 1), p.clearRect(0, 0, z, q);
                var R = U._90I;
                U._90I = new vf, A.clear(), d.forEach(function (m) {
                    var N = U.drawItem(p, m, k, q);
                    A.add({
                        item: m,
                        startX: k,
                        endX: k + N,
                        width: N
                    }), N && (k += N + t)
                }), R.each(function (T) {
                    U._90I.contains(T) || Kh(T)
                });
                var J = U._64I;
                U._64I = W(0, k), p.restore(), U._stickToRight ? (U._65O = 0, p = Hf(f), k = z - U._64I + t, Tm(p, 0, 0, 1), p.clearRect(0, 0, z, q), A.clear(), d.forEach(function (B) {
                    var N = U.drawItem(p, B, k, q, !0);
                    A.add({
                        item: B,
                        startX: k,
                        endX: k + N,
                        width: N
                    }), N && (k += N + t)
                }), p.restore()) : U.tx(U.tx()), J !== U._64I && U.onSumWidthChanged(J, U._64I)
            },
            onSumWidthChanged: function () {},
            handleClick: function ($, i) {
                var B = this,
                    x = $.type,
                    U = $.action,
                    W = $.groupId,
                    F = $.selected;
                $.disabled || (W != h ? F || ($.selected = !0, this._items.forEach(function (E) {
                        E.groupId === W && $ !== E && (E.selected = !1)
                    }), U && $.action($, B, i)) : x === Mb || "toggle" === x ? ($.selected = !F, U && $.action($, B, i)) : U && $.action($, B, i)), hn(), B.iv()
            }
        });
        var Xr = function (A) {
            this.tb = A, this.addListeners()
        };
        zc(Xr, x, {
            ms_listener: 1,
            getView: function () {
                return this.tb._view
            },
            handle_mousewheel: function (Q) {
                this.handleScroll(Q, 10 * (Q.wheelDelta / 40))
            },
            handle_DOMMouseScroll: function (O) {
                this.handleScroll(O, 10 * -O.detail)
            },
            handleScroll: function (B, E) {
                Bl(B);
                var Z = this.tb;
                Z.isScrollable() && !Z._stickToRight && (Z.tx(Z.tx() + E), Nn())
            },
            handle_mousemove: function (N) {
                var S = this;
                wh || S.setItem(N)
            },
            handle_mouseout: function (b) {
                var o = this;
                b.target === o.getView() ? o.tb.setCurrentItem(h) : o.handle_mousemove(b)
            },
            handle_mousedown: function (J) {
                this.handle_mousemove(J), this.handle_touchstart(J)
            },
            handle_touchstart: function (G) {
                var e = this,
                    Z = e.tb,
                    c = G.target;
                Bf(G) && (c === e.getView() || c === Z._canvas) && (Bl(G), Z.setFocus(G) && (this.setItem(G, !0), (Z.isScrollable() || e.info && !e.info.item.disabled) && (e.x = Fc(G).x, e.tx = Z.tx(), gn(e, G))))
            },
            handleWindowMouseMove: function (Q) {
                this.handleWindowTouchMove(Q)
            },
            handleWindowTouchMove: function (d) {
                var O = this,
                    o = O.tb;
                if (!o._stickToRight) {
                    var N = Fc(d).x - O.x;
                    !O._25o && Y(N) > 2 && o.isScrollable() && (O._25o = 1), O._25o && o.tx(O.tx + N)
                }
            },
            handleWindowMouseUp: function (L) {
                this.handleWindowTouchEnd(L)
            },
            handleWindowTouchEnd: function (k) {
                var j = this,
                    g = j.tb,
                    I = j.info,
                    z = j.tb.getItemInfoAt(k);
                if (!j._25o && I) {
                    var s = I.item;
                    z && z.item === s && g.handleClick(s, k)
                }
                j._25o = j.x = j.tx = h, j.setItem()
            },
            setItem: function (W, o) {
                var j = this,
                    b = j.tb,
                    D = j.info = W ? b.getItemInfoAt(W) : h,
                    L = D ? D.item : h;
                b.setCurrentItem(L), o && L && Yr(L.onDown) && L.onDown(W)
            }
        }), qj.BorderPane = function () {
            this._view = xj(1, this), this.iv()
        }, oo("BorderPane", x, {
            ms_v: 1,
            ms_ac: ["topHeight", "bottomHeight", "leftWidth", "rightWidth"],
            ms_fire: 1,
            getLeftView: function () {
                return this._leftView
            },
            setLeftView: function (O, w) {
                this._12o("leftView", O), w != h && this.setLeftWidth(w)
            },
            getRightView: function () {
                return this._rightView
            },
            setRightView: function (K, M) {
                this._12o("rightView", K), M != h && this.setRightWidth(M)
            },
            getTopView: function () {
                return this._topView
            },
            setTopView: function (H, T) {
                this._12o("topView", H), T != h && this.setTopHeight(T)
            },
            getBottomView: function () {
                return this._bottomView
            },
            setBottomView: function (p, M) {
                this._12o("bottomView", p), M != h && this.setBottomHeight(M)
            },
            getCenterView: function () {
                return this._centerView
            },
            setCenterView: function (X) {
                this._12o("centerView", X)
            },
            _12o: function (u, k) {
                var l = this,
                    y = "_" + u,
                    J = l._view,
                    F = l[y];
                F !== k && (F && (F.getView ? Kh(F.getView()) : Kh(F)), l[y] = k, k && (k.getView ? or(J, k.getView(), 1) : or(J, k, 1)), l.fp(u, F, k))
            },
            onPropertyChanged: function () {
                this.iv()
            },
            validateImpl: function () {
                var n = this,
                    R = n._topView,
                    o = n._bottomView,
                    E = n._leftView,
                    $ = n._rightView,
                    b = n._centerView,
                    g = n.getWidth(),
                    Y = n.getHeight(),
                    V = 0,
                    i = 0,
                    L = g,
                    A = Y,
                    m = 0,
                    D = 0,
                    N = 0,
                    G = 0;
                R && (m = n._topHeight == h ? qh(R) : n._topHeight, i = m), o && (D = n._bottomHeight == h ? qh(o) : n._bottomHeight, A = Y - D), E && (N = n._leftWidth == h ? ds(E) : n._leftWidth, V = N), $ && (G = n._rightWidth == h ? ds($) : n._rightWidth, L = g - G);
                var H = W(0, L - V),
                    c = W(0, A - i);
                R && Qh(R, 0, 0, g, m), o && Qh(o, 0, A, g, D), E && Qh(E, 0, i, N, c), $ && Qh($, L, i, G, c), b && Qh(b, V, i, H, c)
            }
        })
    }
}("undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : (0, eval)("this"), Object);
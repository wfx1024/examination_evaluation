!function(q,I,m){"use strict";function E(){this.el=[1,0,0,0,1,0,0,0,1]}function M(e){var z={};return{get:function(Y){if(z[Y]!==m)return z[Y];var L;switch(Y){case"WEBGL_depth_texture":L=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":L=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":L=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":L=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":L=e.getExtension("WEBGL_compressed_texture_etc1");break;default:L=e.getExtension(Y)}return z[Y]=L,L}}}function c(O,P,l){function r(){if(o!==m)return o;var y=P.get("EXT_texture_filter_anisotropic");return o=null!==y?O.getParameter(y.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function k(o){if("highp"===o){if(O.getShaderPrecisionFormat(O.VERTEX_SHADER,O.HIGH_FLOAT).precision>0&&O.getShaderPrecisionFormat(O.FRAGMENT_SHADER,O.HIGH_FLOAT).precision>0)return"highp";o="mediump"}return"mediump"===o&&O.getShaderPrecisionFormat(O.VERTEX_SHADER,O.MEDIUM_FLOAT).precision>0&&O.getShaderPrecisionFormat(O.FRAGMENT_SHADER,O.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o;l=l||{};var I="undefined"!=typeof WebGL2RenderingContext&&O instanceof WebGL2RenderingContext,j=l.precision!==m?l.precision:"highp",Q=k(j);Q!==j&&(console.warn("WebGL:",j,"not supported, using",Q,"instead."),j=Q);var p=l.logarithmicDepthBuffer===!0,a=O.getParameter(O.MAX_TEXTURE_IMAGE_UNITS),M=O.getParameter(O.MAX_VERTEX_TEXTURE_IMAGE_UNITS),n=O.getParameter(O.MAX_TEXTURE_SIZE),D=O.getParameter(O.MAX_CUBE_MAP_TEXTURE_SIZE),u=O.getParameter(O.MAX_VERTEX_ATTRIBS),E=O.getParameter(O.MAX_VERTEX_UNIFORM_VECTORS),y=O.getParameter(O.MAX_VARYING_VECTORS),h=O.getParameter(O.MAX_FRAGMENT_UNIFORM_VECTORS),s=M>0,N=I||!!P.get("OES_texture_float"),W=s&&N,$=I?O.getParameter(O.MAX_SAMPLES):0;return{getMaxAnisotropy:r,getMaxPrecision:k,precision:j,logarithmicDepthBuffer:p,maxTextures:a,maxVertexTextures:M,maxTextureSize:n,maxCubemapSize:D,maxAttributes:u,maxVertexUniforms:E,maxVaryings:y,maxFragmentUniforms:h,vertexTextures:s,floatFragmentTextures:N,floatVertexTextures:W,maxSamples:$}}var V="ht";if(!q[V]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),q.performance&&q.performance.now||function(){var U=Date.now();q.performance||(q.performance={}),q.performance.now=function(){return Date.now()-U}}();for(var o=Date.now(),W=16,i=["ms","moz","webkit","o"],M=0;M<i.length&&!q.requestAnimationFrame;++M)q.requestAnimationFrame=q[i[M]+"RequestAnimationFrame"],q.cancelAnimationFrame=q[i[M]+"CancelAnimationFrame"]||q[i[M]+"CancelRequestAnimationFrame"];q.requestAnimationFrame||(q.requestAnimationFrame=function(h){var R=Date.now(),x=W+o-R;return 0>x&&(x=0),o=R,q.setTimeout(function(){o=Date.now(),h(performance.now())},x)}),q.cancelAnimationFrame||(q.cancelAnimationFrame=function(J){return q.clearTimeout(J)}),I.assign===m&&(I.assign=function(o){if(o===m||null===o)throw new TypeError("Cannot convert undefined or null to object");for(var h=I(o),C=1;C<arguments.length;C++){var R=arguments[C];if(R!==m&&null!==R)for(var O in R)I.prototype.hasOwnProperty.call(R,O)&&(h[O]=R[O])}return h})}();var J=q.document,A=null,f=q[V]={},X=q[V+"config"],O=f.Default=X&&X.Default||{},K=f.Style=X&&X.Style||{},C=f.Attr=X&&X.Attr||{},B=f.Color=X&&X.Color||{},N=f.IsGetter=X&&X.IsGetter||{};!function(){var v=!1;try{var S=I.defineProperty({},"passive",{get:function(){v=!0}});q.addEventListener("test",S,S),q.removeEventListener("test",S,S)}catch(w){v=!1}O.passiveSupported=v}();var P,D,R,v,i=O.passiveSupported,g=O.eventListenerOptionsFalse=i?{passive:!1,capture:!1}:!1,Q=O.eventListenerOptionsTrue=i?{passive:!1,capture:!0}:!0,x=function(e,R,o,b){e.addEventListener(R,o,b?Q:g)},h=function(t,H,B,F){t.removeEventListener(H,B,F?Q:g)},t=Math,T=t.round,d=t.floor,U=t.ceil,r=t.sqrt,$=t.max,Y=t.min,G=t.abs,W=t.cos,y=t.acos,n=t.sin,u=t.pow,o=t.asin,s=t.PI,H=2*s,Z=s/2,k=t.tan,b=t.atan2,w=t.random,j=t.log,S=!0,a=!1,e=q.parseInt||global.parseInt,_="2019-11-25",p=q.navigator?q.navigator.platform.indexOf("Win")>-1:!1,F=function(A){return A*A},l=q.setTimeout,z=q.clearTimeout,L=q.location,mp=q.navigator?q.navigator.userAgent.toLowerCase():"",Wd=function(V){return V.test(mp)},bp=Wd(/msie/),Oe=Wd(/msie/)||Wd(/trident/),no=Wd(/msie 10/),Md=Wd(/edge/),Vh=Wd(/firefox/),rs=Wd(/mac/),hj=O.isTouchable===m?p?!1:J?"ontouchend"in J:!1:O.isTouchable,lc="default",kl="single",Tj="multiple",Jn="front",rd="back",zd="left",Nl="right",kq="top",Ud="bottom",db="center",vf="eye",mn="middle",hp="east",ss="west",bd="north",Rr="none",Ug="px",Mb="absolute",Qh="border",uj="triangle",Pr="rect",pk="circle",Gi="cylinder",Gk="shape",Wk="items",jq="normal",Gm="remove",xh="clear",Dr="width",On="height",Yb="ingroup",Mh="check",xi="uncheck",hq="radio",jj="radioOn",_r="radioOff",Jo="points",Kb="values",Fl="series",dj="body",ch="label",Zo="label2",In="note",jf="note2",Vj="icons",Nn="labelFont",pb="labelColor",Jj="labelSelectColor",mr="note.expanded",lr="note2.expanded",Oi="edge.expanded",kj="edge.points",Ap="edge.type",jk="rotation",Sn="hidden",dl="visible",Ve="tuv",id="no",fe="draw",lk="select",wl="currentSubGraph",Ih="selectBackground",$g="autoMakeVisible",as="autoHideScrollBar",Ee="scrollBarColor",zm="scrollBarSize",Xp="indent",Zb="rowHeight",vq="columnLineColor",Ab="rowLineColor",Fg="columnLineVisible",ti="rowLineVisible",os="visibleFunc",so="expandIcon",Rq="collapseIcon",kg="checkMode",Ai="sortFunc",hd="editable",Gn="batchEditable",zq="tristate",yl="asc",$i="desc",si="position",Ge="elevation",sj="children",yj="translateX",Mk="translateY",rg="dataModel",Ij="maxSize",Ag="state",Mq="shape3d",$r="shape3d.resolution",Gg="shape3d.visible",ar="shape3d.from.visible",Yf="shape3d.to.visible",xd="shape3d.top.visible",Xg="shape3d.bottom.visible",Fr="repeat.uv.length",Uq="serializeValue",Nb="deserializeValue",lq="centerUniform",ze="uniform",ng="rgba(255,255,255,0)",oq="style",ce="attr",cs="field",Bd="string",Mf="boolean",Gd="color",ok="int",Dl="number",Vq="ew-resize",Ik="ns-resize",ek="pointer",Kd="auto",Kn="mousedown",Kj="mousemove",hc="mouseup",No="mouseout",Uc="touchstart",qs="touchmove",od="touchend",vd="keydown",Km="keyup",Jf=["DOMMouseScroll","mousewheel"],jb=Vh?Jf[0]:Jf[1],Ki=hj?[Uc,qs,od,vd,Km,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[vd,Km,"keypress","input",Kn,Kj,hc,No,jb,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Gc=A,ge=A,Fp=A,ad=hc.length,sc=function(){Fp&&(z(Fp.timeout),Fp=A)},Hm=function(){Fp&&Mr(Fp.e,Fp.info)};q.addEventListener&&(hj||(x(q,No,function(){sc()}),x(q,jb,function(){ts()})),x(q,Km,function(u){91===u.keyCode?ko={}:delete ko[u.keyCode]},!0),x(q,vd,function(e){ko[e.keyCode]=!0},!0),x(q,"blur",function(){ko={}}));var Mm,Nj,wj,Nc=0,wb=A,Kl=function(k,q){var n=l(function(){delete wb[n],Lc(wb)&&(wb=A),k()},q);return n},em=A,Yl=A,Pq={},_q={},on={},Jr={},ui={},ko={},te={},vh={},um={},Iq={},me=/.json$/,Jl=/^data:image\/svg\+xml/,eo={},bs=[],Zl={},Np=A,ai=A,Yd=function(){},jn=function(){throw"Oops!"},lb=[0,0,0],xj={x:0,y:0,width:0,height:0},Ad=A,Oj=A,Vr=A,Hd=function(o,e){_q[o]=e,e&&e.comps&&!e.uuid&&(e.uuid=f.Math.generateUUID()),bl[o]&&(e.cacheRule=bl[o],delete bl[o])},Jc=function($){Oj&&!$._72O&&(Vr||(Vr={}),Vr[$._72O=mj()]=$),Mm!=A?ib()<.05&&v&&!Nj&&(aq=sc):aq=hn},Xj=function(R,j,i,N){Oj||(Oj={});var U=Oj[R];if(U){if(U.url===j)return;U.image?(U.image.onload=Yd,U.image.onerror=Yd):U.request&&(U.request.onload=Yd,U.request.onerror=Yd)}if(me.test(j)){var q=new ls;if(Oj[R]={request:q,url:j},j=O.beforeLoadURL(j),j.data){var g=O.parse(j.data);sq(R,g),O.handleImageLoaded(R,g)}else{q.onload=function(){if(200===this.status||0===this.status){var w=O.parse(q.getResponseText());sq(R,w),O.handleImageLoaded(R,w)}else sq(R,O.handleUnfoundImage(R,j)||A)},q.onerror=function(){sq(R,O.handleUnfoundImage(R,j)||A)};var z={};z.url=encodeURI(j),z.sync=!1,q.send(z)}}else{var g=new Image;Oj[R]={image:g,url:j},/^data:image/.test(j)||(j=O.beforeLoadURL(j),j=O.appendTimeStamp(j),j=encodeURI(j),g.crossOrigin=O.crossOrigin),O.convertImageSrc(j,function(D){Oe&&(j.toLowerCase().indexOf(".svg")>0||Jl.test(j))?(J.body.appendChild(g),g.style.visibility="hidden",g.onload=function(){l(function(){if(i&&(g.width=i),N&&(g.height=N),!g.width||!g.height){var q=g.width||g.clientWidth,V=g.height||g.clientHeight;g.width=q,g.height=V}O.handleImageLoaded(R,g),sq(R,g),J.body.removeChild(g),g.style.visibility=""},180)},g.onerror=function(){sq(R,O.handleUnfoundImage(R,j)||A),J.body.removeChild(g),g.style.visibility=""}):(g.onload=function(){i&&(g.width=i),N&&(g.height=N),O.handleImageLoaded(R,g),sq(R,g)},g.onerror=function(){sq(R,O.handleUnfoundImage(R,j)||A)}),g.src=D})}},sq=function(t,F){if(Hd(t,F),delete Oj[t],Lc(Oj)&&(Oj=A,Vr)){for(var j in Vr){var Q=Vr[j];Q._2O&&Q._2O[t]&&(Q.deleteTexture(t),delete Q._2O[t]),Q.invalidateAll&&Q.invalidateAll(m,"imageLoaded",t),Q.redraw&&Q.redraw(),Q.iv(),delete Q._72O}Vr=A}if(F&&Vr)for(var j in Vr){var Q=Vr[j];Q.invalidateAll&&Q.invalidateAll(m,"imageLoading",t),Q.redraw&&Q.redraw(),Q.iv()}},Yr=function(){return j=t&&Date,function(){return q.performance&&q.performance.now?q.performance.now():Date.now()}}(),kb=function(i,A){A?z(i):q.cancelAnimationFrame(i)},tb=function(B,n,K){return{width:B,height:n,comps:Nq(K)?K:[K]}},Ck=function(y,K){return{type:pk,rect:[y,K,1.6,1.6],borderWidth:1,borderColor:rc,gradient:al,gradientColor:lo,background:rc}},Yi=function(B,S){return tb(16,16,{type:uj,rect:[4,4,10,8],background:B,rotation:S?1.57:3.14})},$p=function(p,U){return tb(16,16,{type:uj,rect:[4,4,8,7],background:p,rotation:U?3.14:0})},Dm=function(Z){var j=Z._orientation;return"horizontal"===j||"h"===j},gl=function(e,X){var M=A||4,U=A||1,u=A||1;0>M?M=0:M>.25&&(M=.25);var w,G,o,y,x,f,Y,b=.5,R=[],z=[],C=[],h=H/u,Q=H/U,E=b-M;for(G=0;U>=G;G++)for(y=-s+G*Q,f=W(y),x=n(y),w=0;u>=w;w++)o=w*h,Y=E+M*f,R.push(W(o)*Y,x*M,-n(o)*Y),(D=[e,X])&&z.push(w/u,1-G/U);for(G=0;U>G;G++){var B=G*(u+1),g=(G+1)*(u+1);for(w=0;u>w;w++)C.push(B+w,g+w+1,g+w,B+w,B+w+1,g+w+1),Xf.z=Wl.z=[e,X]}},Sb=function(d){var $=2,O=0;for(var x in d)x.length===$&&e(x,32)===xl&&(Np=ai=d[x]),O++;return O},yp=function(r,o,F,X){return F||(F=hj?5:3,F/=X||1),{x:r-F,y:o-F,width:2*F,height:2*F}},ep=function(T,P,H,A){var J=this;P||(P=hj?5:3,H=20,A=20);var D={x:T,y:P,width:H,height:A};if(H)for(var I=0;H>I;I++)if(3===H)A=20;else for(var h=0;A>h;h++)J=q?q:H;var G={x:s,y:2*s};if(ub(D,G)){var F=On[0]+kq[0]+xh[1]+yl.length,d=Sn[0]+zq[0]+xh[1]+dj.length;rh[vf]=[J[F],J[d]],J[F]=ds[vf],J[d]=ds[Mq]}},ho=function(u){return(/ble$/.test(u)||/ed$/.test(u)||N[u]?"is":"get")+u.charAt(0).toUpperCase()+u.slice(1)},ds=function(D){return"set"+D.charAt(0).toUpperCase()+D.slice(1)},xr=function(l){return typeof l===Bd||l instanceof String},Fb=function(x){return typeof x===Dl},hn=function(O){return typeof O===Mf},Bq=function(W){return W&&"object"==typeof W},ne=function(X){return"function"==typeof X},Nq=function(l){return l instanceof Array},yd=function(l){return l instanceof Dj},_b=function(t){return Nq(t)?new Dj(t):t},uh=function(G){return G instanceof fh},hl=function(l){return l instanceof Qp},Lg=function(i){return i instanceof Ub},mm=function(Z,B){if(!(Z instanceof f.Group))return!1;if(!B)return Z.isExpanded();var g=B.getDataUI(Z);return g&&g._88I?!0:!1},mg=function(r){return r instanceof bb},zl=function(Y){return Y&&"IFRAME"===Y.tagName},qf=function(g){return g==A||O.numberDigits==A?g:parseFloat(g.toFixed(O.numberDigits))},hk=function(F,C,r){var K,Q=C.length;if(r)for(var Z=0;r>Z;Z++)if(3===Q)F.push(C[0]),F.push(C[1]),F.push(C[2]);else for(K=0;Q>K;K++)F.push(C[K]);else if(3===Q)F.push(C[0]),F.push(C[1]),F.push(C[2]);else for(K=0;Q>K;K++)F.push(C[K])},cl=function(d){return d?Bq(d)?d:{}:!1},kk=function(g,d,K){var W,b=Bq(g)?g:g.prototype;for(W in d)K&&W in b?b[W]===m&&console.warn("class",b,"has own undefined property",W,", keep exist!"):b[W]=d[W];return g},us=function(N){return String.fromCharCode(N)},Wi=function(m){for(var h,n=0,V="";n<m.length;n++)h=m[m.length-1-n],"%"===h?h="'":"a"===h?h='"':"]"===h&&(h="\\"),V+=us(h.charCodeAt(0)-1);return V},To=function(t,e,w){t.superClass.constructor.apply(e,w)},Lc=function(C){for(var j in C)return!1;return!0},oe=function(G){return G?0===G.length:!0},tc=function(){var y="";return[xi[0],Ab[0],ch[0]].forEach(function(j){y+=ds(j).slice(3)}),ze=J&&J[y]||lq,function($,q){return $===q?!0:$.x===q.x&&$.y===q.y&&$.width===q.width&&$.height===q.height}}(),Xd=function(d,Z,u){return Z>d?Z:d>u?u:d},Wq=function(U){return 0>U?-1:U>0?1:0},ib=function(){var E=1e4*n(ad++);return E-d(E)},Dc=function(y,B,X){return Qo(y.x,y.y,B.x,B.y,X.x,X.y,X.x+X.width,X.y,!0)||Qo(y.x,y.y,B.x,B.y,X.x+X.width,X.y,X.x+X.width,X.y+X.height,!0)||Qo(y.x,y.y,B.x,B.y,X.x+X.width,X.y+X.height,X.x,X.y+X.height,!0)||Qo(y.x,y.y,B.x,B.y,X.x,X.y+X.height,X.x,X.y,!0)},Qo=function(I,Q,p,k,j,u,B,o,f){var K=(B-j)*(Q-u)-(o-u)*(I-j),x=(o-u)*(p-I)-(B-j)*(k-Q);if(0!==x){var L=K/x,V=I+L*(p-I),D=Q+L*(k-Q);return f&&(V+Kg<Y(I,p)||V-Kg>$(I,p)||V+Kg<Y(j,B)||V-Kg>$(j,B)||D+Kg<Y(Q,k)||D-Kg>$(Q,k)||D+Kg<Y(u,o)||D-Kg>$(u,o))?A:[V,D]}return A},tg=function(f,h,g){if(f&&g)if(h){if(h===oq)return f.getStyle(g);if(h===ce)return f.getAttr(g);if(h===cs)return f[g]}else if(g=ho(g),f[g])return f[g]();return m},Yj=function(S,Q,x,w){if(S&&x)if(Q){if(Q===oq)S.s(x,w);else if(Q===ce)S.a(x,w);else if(Q===cs){var c=S[x];S[x]=w,S.fp("f:"+x,c,w)}}else x=ds(x),S[x]&&S[x](w)},Zq=function(X,D,W){return D&&"top"!==D?"bottom"===D?{x:X.x,y:X.y,width:X.width,height:X.height*W}:"right"===D?{x:X.x,y:X.y,width:X.width*W,height:X.height}:"left"===D?{x:X.x+X.width*(1-W),y:X.y,width:X.width*W,height:X.height}:void 0:{x:X.x,y:X.y+X.height*(1-W),width:X.width,height:X.height*W}},zj=function(J,c,I,j,C){c&&Hq(J,I,j,1,C,c)},Uh=function(H,d,g,e){var j=1-H;return j*j*d+2*H*j*g+H*H*e},Xf=function(U,y,H,x,n){var X=1-U;return X*X*X*y+3*X*X*U*H+3*X*U*U*x+U*U*U*n},Do=function(P){var b,v,g,T,C=0;return P.forEach(function(k){if(b=k.length,b>0)for(v=k[0],T=1;b>T;T++)g=k[T],C+=Ng(v,g),v=g}),C},Hg=function(A,G,H){var j="__"+A,h=function(n){H.disabled||H["handle_"+A](n)};H[j]||(H[j]=h,x(G,A,h))},Yc=function(b,I,p){var U="__"+b,N=p[U];N&&(h(I,b,N),delete p[U])},jm=function(I,y){var v="_"+y;I[ho(y)]=function(){return this[v]},I[ds(y)]=function(w){var J=this[v];this[v]=w,this.fp(y,J,w)}},gm=function(l){return I.create(l)},nq=function(o){if(!o.element){var w,E;(w=o.textField)?E=zo(fq.TextField,w):(w=o.textArea)?E=zo(fq.TextArea,w):(w=o.button)?E=zo(fq.Button,w):(w=o.comboBox)?E=zo(fq.ComboBox,w):(w=o.checkBox)?E=zo(fq.CheckBox,w):(w=o.radioButton)?E=zo(fq.RadioButton,w):(w=o.slider)?E=zo(fq.Slider,w):(w=o.colorPicker)?E=zo(fq.ColorPicker,w):(w=o.image)&&(E=zo(fq.Image,w)),E&&(o.element=E)}},hg=function(W,V){var G=Gj(W);return G._ht=V,G},Gj=function(l,X){var w=J.createElement("div"),n=w.style;return w.tabIndex=-1,w.onkeydown=Ec,n.msTouchAction=Rr,Sj(w,A,0),hj&&n.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",A),l&&(n.overflow=Sn),X&&gr(X,w),w},Eg=function(P,h){var c=J.createElement("canvas"),E=c.style;return E.msTouchAction=Rr,h||(E.pointerEvents=Rr),Sj(c,A,0),P&&gr(P,c),c},Sj=function(j,u,v){var H=j.style;H.border=u?u+" solid 1px":0,H.outline=0,H.padding=v?"0 "+v+Ug:0,dm(j)},dm=function(D){var y=D.style;y.position=Mb,y.margin=0,y.setProperty("box-sizing","border-box",A),y.setProperty("-moz-box-sizing","border-box",A)},jd=function(u,C,k,c){c||(c=Lf),C!=A&&(u.width=C*c,u.style.width=C+Ug),k!=A&&(u.height=k*c,u.style.height=k+Ug)},gr=function(n,$,O){n.appendChild($),O&&($.style.position=Mb)},Un=function(A,N){N.split||(N+="");for(var x,H=N.split("\n"),T=0,Y=H.length,z=0;Y>z;z++){var h=wr(A.font,H[z]);h.width>T&&(T=h.width),x||(x=h.height)}return A.ss=H,{width:T,height:x*Y}},Ql=function(Y,h,H,x,b,C){var _=h.length;if(1===_)fr(Y,h[0],H,x,b);else for(var Q=H.height/_,E={x:H.x,y:H.y,width:H.width,height:Q},U=0;U<h.length;U++)C?ji(Y,h[U],x,b,E.x,E.y,E.width,E.height,C):fr(Y,h[U],E,x,b),E.y+=Q},fr=function(j,J,p,c,$){j.font=c?c:Oh,j.fillStyle=$?$:We,j.textAlign=db,j.textBaseline=mn;var o,L;p?p.width===m?(o=p.x,L=p.y):(o=p.x+p.width/2,L=p.y+p.height/2):(o=0,L=0),j.fillText(J,T(o),T(L))},Pm=function(D){D.getView&&(D=D.getView());var A=D.offsetWidth||D.scrollWidth;return!A&&D.style.width&&(A=e(D.style.width)),A},$m=function(W){W.getView&&(W=W.getView());var D=W.offsetHeight||W.scrollHeight;return!D&&W.style.height&&(D=e(W.style.height)),D},Gp=function(M,s,E){var P=s[0].toUpperCase()+s.substring(1,s.length);M["webkit"+P]=E,M["moz"+P]=E,M["ms"+P]=E,M["o"+P]=E,M[s]=E},Bs=function(){var K=function(k){Ec(k),k.stopPropagation()},h=function(c){Ec(c)},g=hj?[Uc]:[vd,Kn];return function(b,G){var w=Gj(),P=w.style;return P.backgroundColor=O.disabledBackground,b&&(P.backgroundImage="url("+b+")",P.backgroundPosition="50% 50%",P.backgroundRepeat="no-repeat no-repeat"),G===!1?g.forEach(function(l){x(w,l,h)}):g.forEach(function(d){x(w,d,K)}),w}}(),pm=function(L){var m=L.getContext("2d");return m.save(),m.lineCap=Ei,m.lineJoin=Tr,m},aq=function(g,W,k,e){de(g,W*Lf,k*Lf),e*=Lf,1!==e&&g.scale(e,e)},de=function(p,l,U){p.translate(l,U)},Ah=function($,B){B&&$.rotate(B)},Ip=function(O,T,S){T===m&&(T=1),S===m&&(S=1),(1!==T||1!==S)&&O.scale(T,S)},vo=!1,Bh=function(h){var b=J.activeElement;if(J.activeElement!==h){b&&b.forceOnblur&&b.forceOnblur();for(var c=[],$=h.parentNode;$;)c.push([$,$.scrollLeft,$.scrollTop]),$=$.parentNode;if(!vo){var P=[],k=[];try{for(var r=q.parent,S=q;r!==S;)P.push([r,r.scrollX,r.scrollY]),S=r,r=q.parent;var f=q.frameElement;if(f)for(var O=f.parentNode;O;)k.push([O,O.scrollLeft,O.scrollTop]),O=O.parentNode}catch(y){vo=!0}}if(hj)h.focus();else{var v=Nm(),t=v.target;h.focus(),t.scrollLeft=v.left,t.scrollTop=v.top}c.forEach(function(c){c[0].scrollLeft=c[1],c[0].scrollTop=c[2]}),vo||(P.forEach(function(Z){Z[0].scrollTo(Z[1],Z[2])}),k.forEach(function(S){S[0].scrollLeft=S[1],S[0].scrollTop=S[2]}))}},Yg=function(M){return M&&M.getView?M.getView():M},tj=function(y,x,t,D,q){if(2===arguments.length&&(t=x.y,D=x.width,q=x.height,x=x.x),y.isSelfViewEvent)y.setX(x),y.setY(t),y.setWidth(D),y.setHeight(q);else{var S=Yg(y),k=S.style;if((J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement)!==S)x!==m&&(k.left=x+Ug),t!==m&&(k.top=t+Ug),D!==m&&(k.width=D+Ug),q!==m&&(k.height=q+Ug);else{var T=O.getWindowInfo();k.left=(x=T.left)+Ug,k.top=(t=T.top)+Ug,k.width=(D=T.width)+Ug,k.height=(q=T.height)+Ug}y.endEditing&&!hj&&y.endEditing(),y.redraw&&y.redraw(),y.invalidate&&y.invalidate(),y.onLayouted&&y.onLayouted(x,t,D,q),y.fireViewEvent&&y.fireViewEvent("layout")}},Oc=function(p){if(!p.touches)return p;var O=p.touches[0];return O?O:p.changedTouches[0]},nc=function(e){return hj?Oc(e).target:e.target},qk=function(K){O.popup&&O.popup.close(),O.popup=K},ig=A,Ek=function(c){ig.handleWindowTouchMove(c)},Fc=function(f){ig.handleWindowTouchEnd(f),h(q,qs,Ek),h(q,od,Fc),ig=A},Yh=function(j){ig.handleWindowMouseMove(j)},Kq=function(s){ig.handleWindowMouseUp(s),h(q,Kj,Yh),h(q,hc,Kq),ig=A},se=function(S){return 1===Sc(S)},Ic=function(u,v){return v?v.keyCode===u:ko[u]},cg=function(j){return Hr(j)&&Ic(65,j)},_l=function(u){return Ic(46,u)||Ic(8,u)},ef=function(g){return function(u){return u?u.keyCode===g:ko[g]}},xl=573,zg=[65,83,68,87,37,38,39,40,32,13,27],Vo=ef(zg[0]),jh=ef(zg[1]),Df=ef(zg[2]),Ll=ef(zg[3]),Hb=ef(zg[4]),qm=ef(zg[5]),pi=ef(zg[6]),Or=ef(zg[7]),Yk=ef(zg[8]),Yq=ef(zg[9]),hb=ef(zg[10]),Aq={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},gh=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,5,5,5,5,5,5,5],Le=A,Si=A,Fi=function(b,k){Le||(Le=Eg()),jd(Le,b,k,1);var L=pm(Le);return L.clearRect(0,0,b,k),L},en=function(){var M,l={};for(var X in q){var Z=Tj.length;if(X.length==Z&&X[0]===Tj[2]&&X[1]===Rr[1]&&X[4]===Tj[3]&&X[5]===Tj[4]&&X.substr(Z-2)===Rr[1]+Rr[2]){var u=q[X];for(var b in u)b.length===Z&&b.substr(0,3)===Nl[3]+Gm[3]+lk[0]&&b.substr(Z-2)===Tj[0]+In[3]&&(Jf=u[b])}}return function(r){var R,F=l[r];return F||(M||(M=Eg(),jd(M,1,1,1)),R=M.getContext("2d"),R.clearRect(0,0,1,1),Hq(R,0,0,1,1,r),F=R.getImageData(0,0,1,1).data,F=l[r]=[F[0],F[1],F[2],F[3]]),F}}(),Ke=function(V){if(!xr(V))return V;var Q=en(V);return Q.CA||(Q.CA=[Q[0]/255,Q[1]/255,Q[2]/255,Q[3]/255]),Q.CA},Wm=function(G,s,y,v,o){var T=Eg();T.width=y,T.height=v;var O=T.getContext("2d");O.drawImage(G,0,0,y,v);try{for(var U=O.getImageData(0,0,y,v),W=U.data,m=0,l=W.length;l>m;m+=4){var i=W[m+0],n=W[m+1],j=W[m+2],p=W[m+3];"override_a"===o?W[m+3]=255*s[3]:"override_rgb"===o?(W[m+0]=255*s[0],W[m+1]=255*s[1],W[m+2]=255*s[2]):"override"===o?(W[m+0]=255*s[0],W[m+1]=255*s[1],W[m+2]=255*s[2],W[m+3]=255*s[3]):(W[m+0]=s[0]*i,W[m+1]=s[1]*n,W[m+2]=s[2]*j,W[m+3]=s[3]*p)}O.putImageData(U,0,0)}catch(t){return G}return T},rh=function(z,A,d){return A&&(A="miter"===d?8*A+20:A+1,z&&ki(z,A)),A},Vd=function(I,Z){if(Z){var z=new Sq(Z),L=I.width/2,F=I.height/2,$=pj([z.tf(-L,-F),z.tf(L,-F),z.tf(L,F),z.tf(-L,F)]);return $.x+=I.x+L,$.y+=I.y+F,$}return I},hf=function(o,A,O,s,V,P,h,R){s*=Math.PI/180;var S={x:Math.cos(s)*(o.x-h.x)/2+Math.sin(s)*(o.y-h.y)/2,y:-Math.sin(s)*(o.x-h.x)/2+Math.cos(s)*(o.y-h.y)/2},J=Math.pow(S.x,2)/Math.pow(A,2)+Math.pow(S.y,2)/Math.pow(O,2);J>1&&(A*=Math.sqrt(J),O*=Math.sqrt(J));var T=(V==P?-1:1)*Math.sqrt((Math.pow(A,2)*Math.pow(O,2)-Math.pow(A,2)*Math.pow(S.y,2)-Math.pow(O,2)*Math.pow(S.x,2))/(Math.pow(A,2)*Math.pow(S.y,2)+Math.pow(O,2)*Math.pow(S.x,2)));isNaN(T)&&(T=0);var I={x:T*A*S.y/O,y:T*-O*S.x/A},g={x:(o.x+h.x)/2+Math.cos(s)*I.x-Math.sin(s)*I.y,y:(o.y+h.y)/2+Math.sin(s)*I.x+Math.cos(s)*I.y},y=function(k){return Math.sqrt(Math.pow(k[0],2)+Math.pow(k[1],2))},U=function(T,Z){return(T[0]*Z[0]+T[1]*Z[1])/(y(T)*y(Z))},m=function(V,t){return(V[0]*t[1]<V[1]*t[0]?-1:1)*Math.acos(U(V,t))},f=m([1,0],[(S.x-I.x)/A,(S.y-I.y)/O]),v=[(S.x-I.x)/A,(S.y-I.y)/O],z=[(-S.x-I.x)/A,(-S.y-I.y)/O],q=m(v,z);U(v,z)<=-1&&(q=Math.PI),U(v,z)>=1&&(q=0);var U=A>O?A:O,B=A>O?1:A/O,H=A>O?O/A:1;if(null==R){var D={x:0,y:0,width:0,height:0};ki(D,U),D.x*=B,D.width*=B,D.y*=H,D.height*=H;var k=new Sq(s);return D=pj([k.tf(D.x,D.y),k.tf(D.x+D.width,D.y),k.tf(D.x+D.width,D.y+D.height),k.tf(D.x,D.y+D.height)]),D.x+=g.x,D.y+=g.y,[{x:D.x,y:D.y},{x:D.x+D.width,y:D.y},{x:D.x+D.width,y:D.y+D.height},{x:D.x,y:D.y+D.height}]}R.translate(g.x,g.y),R.rotate(s),R.scale(B,H),R.arc(0,0,U,f,f+q,1-P),R.scale(1/B,1/H),R.rotate(-s),R.translate(-g.x,-g.y)},Kf=function($,Z){$&&$.beginPath();for(var O,D,o,Q=[],H=function(U){for(var C,l=/(\-{0,1}[\d\.]+)/gi,n=[];C=l.exec(U);)n.push(parseFloat(C[0]));return n},G=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,w={x:0,y:0};O=G.exec(Z);){var N=O[0],p=N.substr(0,1);if("M"===p||"m"===p){for(var k=H(N),s=0;s<k.length;s+=2){var z=k[s],m=k[s+1];"m"===p&&(z+=w.x,m+=w.y),$&&$.moveTo(z,m),Q.push({x:z,y:m}),w.x=z,w.y=m}D=o=null}else if("H"===p||"h"===p){for(var k=H(N),s=0;s<k.length;s+=1){var z=k[s];"h"===p&&(z+=w.x),$&&$.lineTo(z,w.y),Q.push({x:z,y:w.y}),w.x=z}D=o=null}else if("C"===p||"c"===p){for(var k=H(N),s=0;s<k.length;s+=6){var S=k[s],v=k[s+1],q=k[s+2],j=k[s+3],z=k[s+4],m=k[s+5];"c"===p&&(S+=w.x,v+=w.y,q+=w.x,j+=w.y,z+=w.x,m+=w.y),$&&$.bezierCurveTo(S,v,q,j,z,m),Q.push({x:S,y:v}),Q.push({x:q,y:j}),Q.push({x:z,y:m}),w.x=z,w.y=m}D=[S,v,q,j,z,m],o=null}else if("S"===p||"s"===p){for(var k=H(N),s=0;s<k.length;s+=4){var S,v;D?(S=2*D[4]-D[2],v=2*D[5]-D[3]):(S=w.x,v=w.y);var q=k[s],j=k[s+1],z=k[s+2],m=k[s+3];"s"===p&&(q+=w.x,j+=w.y,z+=w.x,m+=w.y),$&&$.bezierCurveTo(S,v,q,j,z,m),Q.push({x:S,y:v}),Q.push({x:q,y:j}),Q.push({x:z,y:m}),w.x=z,w.y=m}D=[S,v,q,j,z,m],o=null}else if("Q"===p||"q"===p){for(var k=H(N),s=0;s<k.length;s+=4){var S=k[s],v=k[s+1],z=k[s+2],m=k[s+3];"q"===p&&(S+=w.x,v+=w.y,z+=w.x,m+=w.y),$&&$.quadraticCurveTo(S,v,z,m),Q.push({x:S,y:v}),Q.push({x:z,y:m}),w.x=z,w.y=m}D=null,o=[S,v,z,m]}else if("T"===p||"t"===p){for(var k=H(N),s=0;s<k.length;s+=2){var S,v;o?(S=2*o[2]-o[0],v=2*o[3]-o[1]):(S=w.x,v=w.y);var z=k[s],m=k[s+1];"t"===p&&(z+=w.x,m+=w.y),$&&$.quadraticCurveTo(S,v,z,m),Q.push({x:S,y:v}),Q.push({x:z,y:m}),w.x=z,w.y=m}D=null,o=[S,v,z,m]}else if("V"===p||"v"===p){for(var k=H(N),s=0;s<k.length;s+=1){var m=k[s];"v"===p&&(m+=w.y),$&&$.lineTo(w.x,m),Q.push({x:w.x,y:m}),w.y=m}D=o=null}else if("L"===p||"l"===p){for(var k=H(N),s=0;s<k.length;s+=2){var z=k[s],m=k[s+1];"l"===p&&(z+=w.x,m+=w.y),$&&$.lineTo(z,m),Q.push({x:z,y:m}),w.x=z,w.y=m}D=o=null}else if("A"===p||"a"===p){for(var k=H(N),s=0;s<k.length;s+=7){var P=k[s],J=k[s+1],i=k[s+2],e=k[s+3],T=k[s+4],z=k[s+5],m=k[s+6];"a"===p&&(z+=w.x,m+=w.y);var V=hf(w,P,J,i,e,T,{x:z,y:m},$);V&&(Q=Q.concat(V)),w.x=z,w.y=m}D=o=null}var c=N.substr(N.length-1);("z"===c||"Z"===c)&&$&&$.closePath()}return Q},wk=function(k,y){var P,Z,Y="L"===y[0],f=y.length;k.save(),Y?(k.transform(y[5],y[6],y[7],y[8],y[9],y[10]),P=k.createLinearGradient(y[1],y[2],y[3],y[4]),Z=11):(k.transform(y[7],y[8],y[9],y[10],y[11],y[12]),P=k.createRadialGradient(y[1],y[2],y[3],y[4],y[5],y[6]),Z=13);for(var a=k.compGray;f>Z;)P.addColorStop(y[Z],a?O.toGrayColor(y[Z+1]):y[Z+1]),Z+=2;k.fillStyle=P},Wl=function(k,T){var o=k.s("shape.gradient.pack");if(o){for(var y=o.length,G=new Array(y),Q=0;y>Q;Q++)G[Q]=o[Q];var u,F,K,N,a,z,c,B,P,S,m,x,q,l="L"===G[0];u=l?5:7,F=G[u],K=G[u+1],N=G[u+2],a=G[u+3],z=G[u+4],c=G[u+5],B=T[0],P=T[1],S=T[2],m=T[3],x=T[4],q=T[5],G[u]=B*F+S*K,G[u+1]=P*F+m*K,G[u+2]=B*N+S*a,G[u+3]=P*N+m*a,G[u+4]=B*z+S*c+x,G[u+5]=P*z+m*c+q,k.s("shape.gradient.pack",G)}},ns=function(C,w,L,a){var k=!1;if(C.beginPath?C.beginPath():k=!0,yd(w)&&(w=w._as),yd(L)&&(L=L._as),L&&L.length){for(var Q,F,m,M,G=0,r=0,_=L.length;_>r;r++)Q=L[r],1===Q?(F=w[G++],C.moveTo(F.x,k?-F.y:F.y)):2===Q?(F=w[G++],C.lineTo(F.x,k?-F.y:F.y)):3===Q?(F=w[G++],m=w[G++],C.quadraticCurveTo(F.x,k?-F.y:F.y,m.x,k?-m.y:m.y)):4===Q?(F=w[G++],m=w[G++],M=w[G++],C.bezierCurveTo(F.x,k?-F.y:F.y,m.x,k?-m.y:m.y,M.x,k?-M.y:M.y)):5===Q&&C.closePath();a&&5!==Q&&C.closePath()}else{var b,v,P,x=w.length;if(x>0){for(b=w[0],C.moveTo(b.x,k?-b.y:b.y),v=1;x>v;v++)P=w[v],C.lineTo(P.x,k?-P.y:P.y);a&&C.closePath()}}},sn=function($,T,D,m){if(yd($)&&($=$._as),yd(T)&&(T=T._as),T&&T.length){D=D||ql;for(var h,z,J,d,R,r,_,s,F=[],Y=A,I=0,X=0,w=T.length;w>X;X++)if(h=T[X],1===h)F.push(Y=[]),Y.push($[I++]);else if(2===h)Y.push($[I++]);else if(3===h){for(z=Y[Y.length-1],J=$[I++],d=$[I++],r=1;D>r;r++)_=Uh(r/D,z.x,J.x,d.x),s=Uh(r/D,z.y,J.y,d.y),Y.push({x:_,y:s,b:!0});Y.push(d)}else if(4===h){for(z=Y[Y.length-1],J=$[I++],d=$[I++],R=$[I++],r=1;D>r;r++)_=Xf(r/D,z.x,J.x,d.x,R.x),s=Xf(r/D,z.y,J.y,d.y,R.y),Y.push({x:_,y:s,b:!0});Y.push(R)}else 5===h&&Y.push(Y[0]);return m&&5!==h&&Y&&Y.length>2&&Y.push(Y[0]),F}return m&&$.length>2&&($=$.slice(),$.push($[0])),$?[$]:[]},gf=function($,M,o,E,x,l){var t,F,R,g=en(M),D=E,m=g[0],K=g[1],b=g[2];if(o){var i=en(o);t=i[0]-m,F=i[1]-K,R=i[2]-b}else t=255-m,F=255-K,R=255-b;for(l||(l=E>10?1:.5,l=1>x?Y(l/x,2):l),$.save(),$.shadowOffsetX=0,$.shadowOffsetY=0,$.shadowBlur=0,$.shadowColor=0;(E-=l)>0;){var B=1-E/D,H=m+t*B,s=K+F*B,u=b+R*B;H=Y(U(H),255),s=Y(U(s),255),u=Y(U(u),255),$.strokeStyle="rgb("+H+","+s+","+u+")",$.lineWidth=E,$.stroke()}$.restore()},Dd=function(){var I={};return function(E,L){var w=E+"-"+L,h=I[w];if(h)return h;var C,J,v,Q=en(E);return 0>L?(L=(100+L)/100,C=U(Q[0]*L),J=U(Q[1]*L),v=U(Q[2]*L)):(L/=100,C=Q[0],J=Q[1],v=Q[2],C+=(255-C)*L,J+=(255-J)*L,v+=(255-v)*L,C=Y(U(C),255),J=Y(U(J),255),v=Y(U(v),255)),I[w]="rgb("+C+","+J+","+v+")"}}(),Hq=function(L,O,B,v,Z,l){l&&(L.fillStyle=l),L.beginPath(),L.rect(O,B,v,Z),L.fill()},Rg=function(H,p,T,s,Z,Y,D){H.beginPath(),Ol[p](H,T.x,T.y,T.width,T.height,s,Z,Y,D)},Sr=function(H,P,u,_,J){var F=Ol[u];H.fillStyle=F?F(H,P,_?_:lo,J.x,J.y,J.width,J.height):P},Ko=function(C,$,m,v,l,h){try{if(!$.tagName&&$.comps){$._cacheImage_||($._cacheImage_={});var R;R="override"===v?"colors_override":"override_rgb"===v?"colors_override_rgb":"override_a"===v?"colors_override_a":"colors",$._cacheImage_[R]||($._cacheImage_[R]={__count__:0});var U=$._cacheImage_[R][m];U||($._cacheImage_[R].__count__>O.imageCacheThreshold&&($._cacheImage_[R]={__count__:0}),U=f.Default.toCanvas($,Wb($),js($),null,l,h,m,null,v),$._cacheImage_[R][m]=U,$._cacheImage_[R].__count__++),$=U}C.fillStyle=C.createPattern($,"repeat")}catch(X){C.fillStyle="black"}},Fq=function(O,V,c,Z,Q,P,D){O.save(),O.translate(V,c),O.scale(1,D/P),O.arc(0,0,P,Z,Q),O.restore()},fg=function(C,R,i,y,F,L,c,x){var V,M,O,h,e,o,P,f,t,H,r;if(G(F)>2*s&&(F=2*s),e=U(G(F)/(s/4)),V=F/e,M=-V,O=-y,e>0){o=R+W(y)*L,P=i+n(-y)*c,x?C.lineTo(o,P):C.moveTo(o,P);for(var N=0;e>N;N++)O+=M,h=O-M/2,f=R+W(O)*L,t=i+n(O)*c,H=R+W(h)*(L/W(M/2)),r=i+n(h)*(c/W(M/2)),C.quadraticCurveTo(H,r,f,t)}},pe=function(i,r,c,z,S,n,t,y,P){6===arguments.length&&(t=n,y=n,P=n);var W=r+z,Q=c+S,a=S>z?2*z:2*S;n=a>n?n:a,t=a>t?t:a,y=a>y?y:a,P=a>P?P:a;var N=.29*P,f=.58*P;i.moveTo(W,Q-P),i.quadraticCurveTo(W,Q-f,W-N,Q-N),i.quadraticCurveTo(W-f,Q,W-P,Q),N=.29*y,f=.58*y,i.lineTo(r+y,Q),i.quadraticCurveTo(r+f,Q,r+N,Q-N),i.quadraticCurveTo(r,Q-f,r,Q-y),N=.29*n,f=.58*n,i.lineTo(r,c+n),i.quadraticCurveTo(r,c+f,r+N,c+N),i.quadraticCurveTo(r+f,c,r+n,c),N=.29*t,f=.58*t,i.lineTo(W-t,c),i.quadraticCurveTo(W-f,c,W-N,c+N),i.quadraticCurveTo(W,c+f,W,c+t),i.lineTo(W,Q-P)},Qm=function(R,E,z,B,O,X,d){E&&(z=T(z),B=T(B),d||(d=1),R.fillStyle=E,R.beginPath(),R.rect(z,B,d,X),R.rect(z,B,O,d),X-d>0&&R.rect(z,B+X-d,O,d),O-d>0&&R.rect(z+O-d,B,d,X),R.fill())},Me=function(i,n,e,a){var D=a.x,O=a.y,j=a.width,d=a.height;if(!(!n||!e||0>=j||0>=d)){var C,z=ej(n),J=di(n),u=e>0;1===e||-1===e?(i.fillStyle=u?z:J,i.beginPath(),i.rect(D,O,1,d),i.rect(D,O,j,1),i.fill(),i.fillStyle=u?J:z,i.beginPath(),i.rect(D,O+d-1,j,1),i.rect(D+j-1,O,1,d),i.fill()):(e=Y(G(e),Y(j/2,d/2)),C=i.createLinearGradient(D,O,D+e,O),C.addColorStop(0,u?z:J),C.addColorStop(1,n),i.fillStyle=C,i.beginPath(),i.moveTo(D,O),i.lineTo(D+e,O+e),i.lineTo(D+e,O+d-e),i.lineTo(D,O+d),i.lineTo(D,O),i.fill(),C=i.createLinearGradient(D,O,D,O+e),C.addColorStop(0,u?z:J),C.addColorStop(1,n),i.fillStyle=C,i.beginPath(),i.moveTo(D,O),i.lineTo(D+e,O+e),i.lineTo(D+j-e,O+e),i.lineTo(D+j,O),i.lineTo(D,O),i.fill(),C=i.createLinearGradient(D,O+d,D,O+d-e),C.addColorStop(0,u?J:z),C.addColorStop(1,n),i.fillStyle=C,i.beginPath(),i.moveTo(D,O+d),i.lineTo(D+e,O+d-e),i.lineTo(D+j-e,O+d-e),i.lineTo(D+j,O+d),i.lineTo(D,O+d),i.fill(),C=i.createLinearGradient(D+j,O,D+j-e,O),C.addColorStop(0,u?J:z),C.addColorStop(1,n),i.fillStyle=C,i.beginPath(),i.moveTo(D+j,O),i.lineTo(D+j-e,O+e),i.lineTo(D+j-e,O+d-e),i.lineTo(D+j,O+d),i.lineTo(D+j,O),i.fill())}},yc=function(b,u,O,q,g,G,P){var h=b.createLinearGradient(q,g,G,P);return h.addColorStop(0,O),h.addColorStop(1,u),h},Pc=function(y,F,Y,r,B,q,_){var u=y.createLinearGradient(r,B,q,_);return u.addColorStop(0,F),u.addColorStop(.5,Y),u.addColorStop(1,F),u},Ze=function(p,m,H,o,T,q,D){var F=p.createLinearGradient(o,T,q,D);return F.addColorStop(0,m),F.addColorStop(1/3,H),F.addColorStop(2/3,m),F.addColorStop(1,H),F},Sd=function(T,i,j,I,D,y,o,Z,X){var P=T.createRadialGradient(I+y*Z,D+o*X,Y(y,o)/24,I+y/2,D+o/2,$(y,o)/2);return P.addColorStop(0,j),P.addColorStop(1,i),P},Wp=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Ol={polygon:function(m,i,k,C,S,v){(v==A||3>v)&&(v=6);for(var X,R,b=Y(C,S)/2,l=i+C/2,u=k+S/2,c=0,y=2*s/v,p=0;v>p;p++)X=l+W(c)*b,R=u+n(c)*b,0===p?m.moveTo(X,R):m.lineTo(X,R),c+=y;m.closePath()},arc:function(n,M,Z,q,V,D,N,P,l){D==A&&(D=s),N==A&&(N=H),P==A&&(P=!0);
var S=M+q/2,F=Z+V/2;P&&n.moveTo(S,F),l?Fq(n,S,F,D,N,q/2,V/2):n.arc(S,F,Y(q,V)/2,D,N),P&&n.closePath()},rect:function($,l,L,A,e){$.rect(l,L,A,e)},circle:function(R,Q,G,B,F){R.arc(Q+B/2,G+F/2,Y(B,F)/2,0,H,!0)},oval:function(I,x,F,d,T){Fq(I,x+d/2,F+T/2,0,H,d/2,T/2)},roundRect:function(U,i,l,b,V,K){K==A&&(K=Y(Y(b,V)/4,8)),pe(U,i,l,b,V,K)},star:function(s,j,z,_,V){var F=2*_,I=2*V,Y=j+_/2,u=z+V/2;s.moveTo(Y-F/4,u-I/12),s.lineTo(j+.306*_,z+.579*V),s.lineTo(Y-F/6,u+I/4),s.lineTo(j+_/2,z+.733*V),s.lineTo(Y+F/6,u+I/4),s.lineTo(j+.693*_,z+.579*V),s.lineTo(Y+F/4,u-I/12),s.lineTo(j+.611*_,z+.332*V),s.lineTo(Y+0,u-I/4),s.lineTo(j+.388*_,z+.332*V),s.closePath()},pentagram:function(q,n,f,c,J){var S=.5*J,U=n+.5*c,u=f+S,g=.5257311121191336*c;g>S&&(g=S);var k=Wp,m=0;for(q.moveTo(U+g*k[m++],u+g*k[m++]);20>m;)q.lineTo(U+g*k[m++],u+g*k[m++]);q.closePath()},triangle:function(k,P,E,e,n){k.moveTo(P+e/2,E),k.lineTo(P+e,E+n),k.lineTo(P,E+n),k.closePath()},hexagon:function(d,J,I,p,Z){d.moveTo(J,I+Z/2),d.lineTo(J+p/4,I+Z),d.lineTo(J+3*p/4,+I+Z),d.lineTo(J+p,I+Z/2),d.lineTo(J+3*p/4,I),d.lineTo(J+p/4,I),d.closePath()},pentagon:function(b,K,U,k,R){var Z=2*k,B=2*R,L=K+k/2,E=U+R/2;b.moveTo(L-Z/4,E-B/12),b.lineTo(L-Z/6,E+B/4),b.lineTo(L+Z/6,E+B/4),b.lineTo(L+Z/4,E-B/12),b.lineTo(L+0,E-B/4),b.closePath()},diamond:function(B,$,Z,Y,d){B.moveTo($+Y/2,Z),B.lineTo($,Z+d/2),B.lineTo($+Y/2,Z+d),B.lineTo($+Y,Z+d/2),B.closePath()},rightTriangle:function(J,E,m,W,b){J.moveTo(E,m),J.lineTo(E+W,m+b),J.lineTo(E,m+b),J.closePath()},parallelogram:function(I,B,k,t,n){var _=t/4;I.moveTo(B+_,k),I.lineTo(B+t,k),I.lineTo(B+t-_,k+n),I.lineTo(B,k+n),I.closePath()},trapezoid:function(S,f,$,U,w){var D=U/4;S.moveTo(f+D,$),S.lineTo(f+U-D,$),S.lineTo(f+U,$+w),S.lineTo(f,$+w),S.closePath()},"linear.southwest":function(k,F,B,e,L,n,v){return yc(k,F,B,e,L+v,e+n,L)},"linear.southeast":function(D,y,e,S,o,Y,d){return yc(D,y,e,S+Y,o+d,S,o)},"linear.northwest":function(m,$,B,f,Q,o,T){return yc(m,$,B,f,Q,f+o,Q+T)},"linear.northeast":function(B,q,_,l,i,k,H){return yc(B,q,_,l+k,i,l,i+H)},"linear.north":function(i,b,H,X,j,p,e){return yc(i,b,H,X,j,X,j+e)},"linear.south":function($,L,m,Y,M,s,b){return yc($,L,m,Y,M+b,Y,M)},"linear.west":function(b,i,E,g,n,u){return yc(b,i,E,g,n,g+u,n)},"linear.east":function(T,W,A,I,L,t){return yc(T,W,A,I+t,L,I,L)},"radial.center":function(g,x,t,v,T,$,e){return Sd(g,x,t,v,T,$,e,.5,.5)},"radial.southwest":function(P,U,R,t,A,j,x){return Sd(P,U,R,t,A,j,x,.25,.75)},"radial.southeast":function(V,p,P,t,O,z,E){return Sd(V,p,P,t,O,z,E,.75,.75)},"radial.northwest":function(E,U,n,L,C,h,H){return Sd(E,U,n,L,C,h,H,.25,.25)},"radial.northeast":function(A,$,F,R,I,T,P){return Sd(A,$,F,R,I,T,P,.75,.25)},"radial.north":function(U,d,J,F,R,k,b){return Sd(U,d,J,F,R,k,b,.5,.25)},"radial.south":function(k,K,L,l,G,e,T){return Sd(k,K,L,l,G,e,T,.5,.75)},"radial.west":function(x,g,H,U,e,o,D){return Sd(x,g,H,U,e,o,D,.25,.5)},"radial.east":function(B,X,i,o,s,N,O){return Sd(B,X,i,o,s,N,O,.75,.5)},"spread.horizontal":function(W,U,t,T,I,H){return Pc(W,U,t,T,I,T+H,I)},"spread.vertical":function(y,K,H,e,M,g,D){return Pc(y,K,H,e,M,e,M+D)},"spread.diagonal":function(c,O,j,Z,o,h,d){return Pc(c,O,j,Z+h,o,Z,o+d)},"spread.antidiagonal":function(O,f,T,M,z,B,d){return Pc(O,f,T,M,z,M+B,z+d)},"spread.north":function(z,y,p,R,M,O,Y){return Ze(z,y,p,R,M-Y/4,R,M+Y+Y/4)},"spread.south":function(W,J,Z,V,t,p,K){return Ze(W,Z,J,V,t-K/4,V,t+K+K/4)},"spread.west":function(y,F,q,w,W,_){return Ze(y,F,q,w-_/4,W,w+_+_/4,W)},"spread.east":function($,H,W,y,P,d){return Ze($,W,H,y-d/4,P,y+d+d/4,P)}},ul=function(T,p,E){return new Sq(T).tf(p,E)},Gl=function(P){var J=P.touches[0],M=P.touches[1],a=J.clientX,q=J.clientY,Y=M.clientX,A=M.clientY;return r((a-Y)*(a-Y)+(q-A)*(q-A))},Pn=(function(){for(var f=0,K=$i.split(""),P=0;P<K.length;P++)f=10*e(K[P])+f;return gl(q[xl.toString(8*P)+ch.substr(P)+3],q[xl.toString(8*P)+ch.substr(P)+4]),f}(),function(N,Q,Y){for(var w=0;w<Y.size();w++){var W=Y.get(w);N.co(W)&&Q.add(W)}for(w=0;w<Y.size();w++)W=Y.get(w),Pn(N,Q,W._children)}),Xl=function(I,V,w){for(var K=0;K<w.size();K++){var y=w.get(w.size()-1-K);I.co(y)&&V.add(y)}for(K=0;K<w.size();K++)y=w.get(K),Xl(I,V,y._children)},Fe=function(V,P,r){for(var M=!1,X=0;X<r.size();X++){var f=r.get(X);V.co(f)?M&&P.add(f):M=1}for(X=0;X<r.size();X++)f=r.get(X),Fe(V,P,f._children)},uq=function(m,S,w){for(var H=!1,f=0;f<w.size();f++){var G=w.get(w.size()-1-f);m.co(G)?H&&S.add(G):H=!0}for(f=0;f<w.size();f++)G=w.get(f),uq(m,S,G._children)},Hj=O.moveDatas=function(d,c,g,O){var b=O==A;if(0!==c||0!==g||!b&&0!==O){var y=!0,u=[];if(d.forEach(function(R){y&&(R._69O||Lg(R)||mg(R))&&(y=!1)}),y)u=d;else{var H={},L={};d.forEach(function(r){H[r._id]=!0});var $={},j=function(R){var f=R._id;return H[f]?(u.push(R),$[f]=!0):$[f]=!1},n=function(u){var V=u._id;if(L[V])return j(u);var t=$[V];if(t!==m)return t;var J=u._parent;if(J&&(mg(J)||Lg(J))&&n(J))return $[V]=!0;var r=u._host;return r&&(L[V]=V,t=n(r),L[V]=m,t)?$[V]=!0:j(u)};d.forEach(function(R){n(R)})}u.forEach(function(n){if(uh(n))b?n.translate(c,g):n.translate3d(c,g,O);else{var Y=n.s(kj);if(!Y||Y.isEmpty())return;var k=new Dj;Y.each(function(S){S=of(S),b?(S.x+=c,S.y+=g):(S.x+=c,S.y+=O,S.e==A?S.e=g:S.e+=g),k.add(S)}),n.s(kj,k)}})}},Qc=function(){function i(C,k){return k===C.substring(0,k.length)?!0:!1}function o(_){return parseFloat(_)||0}function v(j,V){if(V==m&&(V=new Jb),i(j,"matrix3d")){var I=j.substring(9,j.length-1).split(",");I=I.map(o),V.fromArray(I)}else if(i(j,"matrix")){var I=j.substring(7,j.length-1).split(",");I=I.map(o),V.el[0]=I[0],V.el[1]=I[1],V.el[2]=0,V.el[3]=0,V.el[4]=I[2],V.el[5]=I[3],V.el[6]=0,V.el[7]=0,V.el[8]=0,V.el[9]=0,V.el[10]=1,V.el[11]=0,V.el[12]=I[4],V.el[13]=I[5],V.el[14]=0,V.el[15]=1}return V}function U(p,N){N==m&&(N=new ur);var d=p.split(/\s+/);return d=d.map(o),N.set(d[0]||0,d[1]||0,d[2]||0),N}var W,r,J,w,S,a=function(R,A){W||(W=new Jb,r=new ur,J=new Jb,w=new Jb,S=new Jb),A==m&&(A=new Jb);var G=getComputedStyle(R);G.transform&&"none"!==G.transform&&(v(G.transform,W),U(G.transformOrigin,r),w.setPosition(r),r.negate(),S.setPosition(r),(Oe||"preserve-3d"!==G.transformStyle)&&(W.el[8]=0,W.el[9]=0,W.el[10]=1,W.el[11]=0),A.multiplyMatrices(S,A),A.multiplyMatrices(W,A),A.multiplyMatrices(w,A)),!Oe&&G.perspective&&"none"!==G.perspective&&(J.el[11]=-1/o(G.perspective),U(G.perspectiveOrigin,r),w.setPosition(r),r.negate(),S.setPosition(r),A.multiplyMatrices(S,A),A.multiplyMatrices(J,A),A.multiplyMatrices(w,A));for(var u=R.offsetParent,d=R.offsetLeft,D=R.offsetTop,y=R.parentElement;y&&y!==u;){var z=getComputedStyle(y);if("none"!==z.transform||"none"!==z.perspective)break;y=y.parentElement}return y==m&&R!==R.ownerDocument.documentElement&&"fixed"!==G.position&&(y=R.ownerDocument.documentElement),u!=m&&u!==y&&(d-=y.offsetLeft,D-=y.offsetTop),r.set(d,D,0),w.setPosition(r),A.multiplyMatrices(w,A),y&&a(y,A),A};return function(C,d){var J=C.parentElement;if(J){var E=J.updateAppendMatrix;if(E){delete J.updateAppendMatrix;var B=new Jb;a(J,B);var s=new Jb;s.getInverse(B),J._matrixAppend=s,J._maxrixPreAppend=B}return d?J._matrixAppend:J._maxrixPreAppend}}}(),mb=function(T,R){for(;T&&!T.hasOwnProperty(R);)T=I.getPrototypeOf(T);return T&&I.getOwnPropertyDescriptor(T,R)},zn=I.getPrototypeOf?function(U,T,A){var j=mb(T,A);j&&I.defineProperty(U,A,j)}:function(o,f,x){o[x]=f[x]},Jg={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ef=function(){var M={1:function($,v){return{x:$.x-v.width/2,y:$.y-v.height/2}},2:function(p,c){return{x:p.x+c.width/2,y:p.y-c.height/2}},3:function(W,x){return{x:W.x+W.width/2,y:W.y-x.height/2}},4:function(f,v){return{x:f.x+f.width-v.width/2,y:f.y-v.height/2}},5:function(n,N){return{x:n.x+n.width+N.width/2,y:n.y-N.height/2}},6:function(s){return{x:s.x,y:s.y}},7:function(m){return{x:m.x+m.width/2,y:m.y}},8:function(H){return{x:H.x+H.width,y:H.y}},9:function(x,v){return{x:x.x-v.width/2,y:x.y+v.height/2}},10:function(h,q){return{x:h.x+q.width/2,y:h.y+q.height/2}},11:function(s,E){return{x:s.x+s.width/2,y:s.y+E.height/2}},12:function(J,i){return{x:J.x-i.width/2+J.width,y:J.y+i.height/2}},13:function(i,l){return{x:i.x+i.width+l.width/2,y:i.y+l.height/2}},14:function(S,W){return{x:S.x-W.width/2,y:S.y+S.height/2}},15:function(t){return{x:t.x,y:t.y+t.height/2}},16:function(U,t){return{x:U.x+t.width/2,y:U.y+U.height/2}},17:function(Z){return{x:Z.x+Z.width/2,y:Z.y+Z.height/2}},18:function(y,u){return{x:y.x+y.width-u.width/2,y:y.y+y.height/2}},19:function(x){return{x:x.x+x.width,y:x.y+x.height/2}},20:function(o,i){return{x:o.x+o.width+i.width/2,y:o.y+o.height/2}},21:function(R,i){return{x:R.x-i.width/2,y:R.y+R.height-i.height/2}},22:function(W,A){return{x:W.x+A.width/2,y:W.y+W.height-A.height/2}},23:function(n,X){return{x:n.x+n.width/2,y:n.y+n.height-X.height/2}},24:function(J,y){return{x:J.x+J.width-y.width/2,y:J.y+J.height-y.height/2}},25:function(m,R){return{x:m.x+m.width+R.width/2,y:m.y+m.height-R.height/2}},26:function(o){return{x:o.x,y:o.y+o.height}},27:function($){return{x:$.x+$.width/2,y:$.y+$.height}},28:function(L){return{x:L.x+L.width,y:L.y+L.height}},29:function(T,x){return{x:T.x-x.width/2,y:T.y+T.height+x.height/2}},30:function(T,c){return{x:T.x+c.width/2,y:T.y+T.height+c.height/2}},31:function(W,t){return{x:W.x+W.width/2,y:W.y+W.height+t.height/2}},32:function(F,c){return{x:F.x+F.width-c.width/2,y:F.y+F.height+c.height/2}},33:function(Q,M){return{x:Q.x+Q.width+M.width/2,y:Q.y+Q.height+M.height/2}},34:function(P,u){return{x:P.x,y:P.y-u.height/2}},35:function(F,U){return{x:F.x+F.width,y:F.y-U.height/2}},36:function(S,f){return{x:S.x,y:S.y+S.height+f.height/2}},37:function(Z,g){return{x:Z.x+Z.width,y:Z.y+Z.height+g.height/2}},38:function(r,E){return{x:r.x+r.width/4,y:r.y-E.height/2}},39:function(k,j){return{x:k.x+3*k.width/4,y:k.y-j.height/2}},40:function(B){return{x:B.x+B.width/4,y:B.y}},41:function(E){return{x:E.x+3*E.width/4,y:E.y}},42:function(H,C){return{x:H.x+H.width/4,y:H.y+C.height/2}},43:function(s,W){return{x:s.x+3*s.width/4,y:s.y+W.height/2}},44:function(E,n){return{x:E.x+E.width/2,y:E.y+E.height/2-n.height/2}},45:function(e){return{x:e.x+e.width/4,y:e.y+e.height/2}},46:function(j,X){return{x:j.x+j.width/2-X.width/2,y:j.y+j.height/2}},47:function(E,X){return{x:E.x+E.width/2+X.width/2,y:E.y+E.height/2}},48:function(C){return{x:C.x+3*C.width/4,y:C.y+C.height/2}},49:function(D,t){return{x:D.x+D.width/2,y:D.y+D.height/2+t.height/2}},50:function(V,y){return{x:V.x+V.width/4,y:V.y+V.height-y.height/2}},51:function(g,B){return{x:g.x+3*g.width/4,y:g.y+g.height-B.height/2}},52:function(j){return{x:j.x+j.width/4,y:j.y+j.height}},53:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height}},54:function(L,F){return{x:L.x+L.width/4,y:L.y+L.height+F.height/2}},55:function(Z,D){return{x:Z.x+3*Z.width/4,y:Z.y+Z.height+D.height/2}}};return Sb(q)?function(D,x,Y){return M[D](x,Y?Y:xj)}:void 0}();kk(B,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Gr=B.reverse,es=B.transparent,pr=B.rectSelectBackground,is=B.dash,Ym=B.titleBackground,th=B.titleIconBackground,Xi=B.headerBackground,Vb=B.headerIconBackground,po=B.headerSeparator,Po=B.headerLine,Qf=B.contentIconBackground,Al=B.contentLine,Vc=(B.widgetIconHighlight,B.widgetIconBorder),rc=(B.widgetIconGradient,B.imageBackground),lo=B.imageGradient,dg=B.highlight,Tg=B.label,Qn=B.labelSelect;if(_&&!q.shutAlert1){var Ur=new Date,tf=_.split("-"),yo=new Date(Ur.getFullYear(),Ur.getMonth(),Ur.getDate()),_=new Date(e(tf[0],10),e(tf[1],10)-1,e(tf[2],10)),Dp=yo.getTime(),hi=_.getTime(),Im=V+"_try",pd=q.alert;try{var Xq=q.localStorage;if(Xq&&pd)if(hi>Dp&&1728e6>hi-Dp){var Gf=(hi-Dp)/864e5;Xq&&Xq[Im]!=Gf&&(Xq[Im]=Gf,q.htWillExpire?pd(q.htWillExpire.replace("{{day}}",Gf)):pd("HT for Web free trial license will expire in "+Gf+" days, please apply for a new license!"))}else Dp>=hi&&(q.htExpired?pd(q.htExpired):pd("Your free trial of HT for Web has expired!")),Xq&&delete Xq[Im]}catch(Cd){}}Math.sign===m&&(Math.sign=function(E){return 0>E?-1:E>0?1:+E});var fl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qr={encode:function(v,s){var F,G,p,i,b,J,U,x="",T=0;for(v=qr._utf8_encode(v);T<v.length;)F=v.charCodeAt(T++),G=v.charCodeAt(T++),p=v.charCodeAt(T++),i=F>>2,b=(3&F)<<4|G>>4,J=(15&G)<<2|p>>6,U=63&p,isNaN(G)?J=U=64:isNaN(p)&&(U=64),x=x+s.charAt(i)+s.charAt(b)+s.charAt(J)+s.charAt(U);return x},decode:function(d,c){var x,s,M,H,r,O,B,J="",e=0;for(d=d.replace(/[^A-Za-z0-9\+\/\=]/g,"");e<d.length;)H=c.indexOf(d.charAt(e++)),r=c.indexOf(d.charAt(e++)),O=c.indexOf(d.charAt(e++)),B=c.indexOf(d.charAt(e++)),x=H<<2|r>>4,s=(15&r)<<4|O>>2,M=(3&O)<<6|B,J+=String.fromCharCode(x),64!=O&&(J+=String.fromCharCode(s)),64!=B&&(J+=String.fromCharCode(M));return J=qr._utf8_decode(J)},_utf8_encode:function(y){y=y.replace(/\r\n/g,"\n");for(var $="",o=0;o<y.length;o++){var S=y.charCodeAt(o);128>S?$+=String.fromCharCode(S):S>127&&2048>S?($+=String.fromCharCode(192|S>>6),$+=String.fromCharCode(128|63&S)):($+=String.fromCharCode(224|S>>12),$+=String.fromCharCode(128|63&S>>6),$+=String.fromCharCode(128|63&S))}return $},_utf8_decode:function(Z){for(var R="",D=0,L=0,M=0,z=0;D<Z.length;)L=Z.charCodeAt(D),128>L?(R+=String.fromCharCode(L),D++):L>191&&224>L?(M=Z.charCodeAt(D+1),R+=String.fromCharCode((31&L)<<6|63&M),D+=2):(M=Z.charCodeAt(D+1),z=Z.charCodeAt(D+2),R+=String.fromCharCode((15&L)<<12|(63&M)<<6|63&z),D+=3);return R}};f.Math={generateUUID:function(){for(var T=[],G=0;256>G;G++)T[G]=(16>G?"0":"")+G.toString(16).toUpperCase();return function(){var G=0|4294967295*Math.random(),c=0|4294967295*Math.random(),_=0|4294967295*Math.random(),l=0|4294967295*Math.random();return T[255&G]+T[255&G>>8]+T[255&G>>16]+T[255&G>>24]+"-"+T[255&c]+T[255&c>>8]+"-"+T[64|15&c>>16]+T[255&c>>24]+"-"+T[128|63&_]+T[255&_>>8]+"-"+T[255&_>>16]+T[255&_>>24]+T[255&l]+T[255&l>>8]+T[255&l>>16]+T[255&l>>24]}}(),clamp:function(e,k,L){return Math.max(k,Math.min(L,e))},generateIncreasingID:function(){var y=0;return function(){return++y}}(),encodeBase64:function(F,x){return qr.encode(F,x||fl)},decodeBase64:function(m,n){return qr.decode(m,n||fl)},randomArray:function(o,W){W=W||o.length;for(var d=W-1;d>0;d--){var Z=Math.floor(Math.random()*(d+1)),k=o[d];o[d]=o[Z],o[Z]=k}return o}};var Lp=f.Matrix=f.Math.Matrix2d=function(e,q,i,Z,P){this.setFromTransform(e,q,i,Z,P)},Sq=Lp;Lp.prototype={},Lp.prototype.constructor=Lp,Lp.prototype.set=function(r,V,H,B,P,u){return this.a=r,this.b=V,this.c=H,this.d=B,this.tx=P,this.ty=u,this},Lp.prototype.setFromTransform=function(k,i,N,$,p){var s=this;if(k===m)return s.a=1,s.b=0,s.c=0,s.d=1,s.tx=0,s.ty=0,void 0;k=k||0;var x=n(k),V=W(k);return $=$||1,p=p||1,s.a=V*$,s.b=x*$,s.c=-x*p,s.d=V*p,s.tx=i||0,s.ty=N||0,s},Lp.prototype.apply=function(X,M){M=M||new Dh;var H=X.x,j=X.y;return M.x=this.a*H+this.c*j+this.tx,M.y=this.b*H+this.d*j+this.ty,M},Lp.prototype.applyInverse=function(K,e){e=e||new Dh;var m=1/(this.a*this.d+this.c*-this.b),V=K.x,X=K.y;return e.x=this.d*m*V+-this.c*m*X+(this.ty*this.c-this.tx*this.d)*m,e.y=this.a*m*X+-this.b*m*V+(-this.ty*this.a+this.tx*this.b)*m,e},Lp.prototype.translate=function($,q){return this.tx+=$,this.ty+=q,this},Lp.prototype.scale=function(p,x){return this.a*=p,this.d*=x,this.c*=p,this.b*=x,this.tx*=p,this.ty*=x,this},Lp.prototype.rotate=function(G){var u=Math.cos(G),x=Math.sin(G),b=this.a,C=this.c,v=this.tx;return this.a=b*u-this.b*x,this.b=b*x+this.b*u,this.c=C*u-this.d*x,this.d=C*x+this.d*u,this.tx=v*u-this.ty*x,this.ty=v*x+this.ty*u,this},Lp.prototype.appendTranslate=function(w,r){return this.tx+=this.a*w+this.c*r,this.ty+=this.b*w+this.d*r,this},Lp.prototype.appendScale=function(w,T){return this.a*=w,this.d*=T,this.c*=T,this.b*=w,this},Lp.prototype.appendRotate=function(E){if(!E)return this;var o=Math.cos(E),P=Math.sin(E),c=this.a,r=this.b;return this.a=c*o+this.c*P,this.b=r*o+this.d*P,this.c=-c*P+this.c*o,this.d=-r*P+this.d*o,this},Lp.prototype.append=function(v){var J=this.a,s=this.b,e=this.c,g=this.d;return this.a=v.a*J+v.b*e,this.b=v.a*s+v.b*g,this.c=v.c*J+v.d*e,this.d=v.c*s+v.d*g,this.tx=v.tx*J+v.ty*e+this.tx,this.ty=v.tx*s+v.ty*g+this.ty,this},Lp.prototype.setTransform=function(l,F,T,x,u,L,w,z,j){var J,O,P,s,R,d,o,U,m,D;return R=Math.sin(w),d=Math.cos(w),o=Math.cos(j),U=Math.sin(j),m=-Math.sin(z),D=Math.cos(z),J=d*u,O=R*u,P=-R*L,s=d*L,this.a=o*J+U*P,this.b=o*O+U*s,this.c=m*J+D*P,this.d=m*O+D*s,this.tx=l+(T*J+x*P),this.ty=F+(T*O+x*s),this},Lp.prototype.prepend=function(O){var I=this.tx;if(1!==O.a||0!==O.b||0!==O.c||1!==O.d){var f=this.a,M=this.c;this.a=f*O.a+this.b*O.c,this.b=f*O.b+this.b*O.d,this.c=M*O.a+this.d*O.c,this.d=M*O.b+this.d*O.d}return this.tx=I*O.a+this.ty*O.c+O.tx,this.ty=I*O.b+this.ty*O.d+O.ty,this},Lp.prototype.transform=Lp.prototype.prepend,Lp.prototype.invert=function(){var X=this.a,m=this.b,p=this.c,P=this.d,J=this.tx,Z=X*P-m*p;return this.a=P/Z,this.b=-m/Z,this.c=-p/Z,this.d=X/Z,this.tx=(p*this.ty-P*J)/Z,this.ty=-(X*this.ty-m*J)/Z,this},Lp.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Lp.prototype.clone=function(){var N=new Lp;return N.a=this.a,N.b=this.b,N.c=this.c,N.d=this.d,N.tx=this.tx,N.ty=this.ty,N},Lp.prototype.copy=function(B){return B.a=this.a,B.b=this.b,B.c=this.c,B.d=this.d,B.tx=this.tx,B.ty=this.ty,B},Lp.prototype.tf=function(D,s){1===arguments.length&&(s=D.y,D=D.x);var _=this;return{x:_.a*D+_.c*s+_.tx,y:_.b*D+_.d*s+_.ty}},Lp.prototype.tfi=function(w,g){1===arguments.length&&(g=w.y,w=w.x);var r=this,P=1/(r.a*r.d+r.c*-r.b);return{x:r.d*P*w+-r.c*P*g+(r.ty*r.c-r.tx*r.d)*P,y:r.a*P*g+-r.b*P*w+(-r.ty*r.a+r.tx*r.b)*P}},Lp.IDENTITY=new Lp,Lp.TEMP_MATRIX=new Lp;var eg=f.Math.Quaternion=function(g,r,E,X){this.set(g,r,E,X)};I.assign(eg.prototype,{set:function(z,J,g,s){var _=this;return _._x=z||0,_._y=J||0,_._z=g||0,_._w=s!==m?s:1,_},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(r){var $=this;return $._x=r._x,$._y=r._y,$._z=r._z,$._w=r._w,$},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(q){return this._x*q._x+this._y*q._y+this._z*q._z+this._w*q._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var d=this.length();return 0===d?(this._x=0,this._y=0,this._z=0,this._w=1):(d=1/d,this._x=this._x*d,this._y=this._y*d,this._z=this._z*d,this._w=this._w*d),this},fromArray:function(U,D){D===m&&(D=0);var B=this;return B._x=U[D],B._y=U[D+1],B._z=U[D+2],B._w=U[D+3],this},slerp:function(b,Y){if(0===Y)return this;if(1===Y)return this.copy(b);var K=this._x,v=this._y,l=this._z,D=this._w,f=D*b._w+K*b._x+v*b._y+l*b._z;if(0>f?(this._w=-b._w,this._x=-b._x,this._y=-b._y,this._z=-b._z,f=-f):this.copy(b),f>=1)return this._w=D,this._x=K,this._y=v,this._z=l,this;var R=Math.sqrt(1-f*f);if(Math.abs(R)<.001)return this._w=.5*(D+this._w),this._x=.5*(K+this._x),this._y=.5*(v+this._y),this._z=.5*(l+this._z),this;var W=Math.atan2(R,f),$=Math.sin((1-Y)*W)/R,x=Math.sin(Y*W)/R;return this._w=D*$+this._w*x,this._x=K*$+this._x*x,this._y=v*$+this._y*x,this._z=l*$+this._z*x,this},setFromAxisAngle:function(x,l){var E=l/2,m=Math.sin(E);return this._x=x.x*m,this._y=x.y*m,this._z=x.z*m,this._w=Math.cos(E),this},setFromEuler:function(I){var l=I._x,Z=I._y,R=I._z,W=I._order,u=Math.cos,G=Math.sin,t=u(l/2),D=u(Z/2),h=u(R/2),e=G(l/2),x=G(Z/2),N=G(R/2);return"XYZ"===W?(this._x=e*D*h+t*x*N,this._y=t*x*h-e*D*N,this._z=t*D*N+e*x*h,this._w=t*D*h-e*x*N):"YXZ"===W?(this._x=e*D*h+t*x*N,this._y=t*x*h-e*D*N,this._z=t*D*N-e*x*h,this._w=t*D*h+e*x*N):"ZXY"===W?(this._x=e*D*h-t*x*N,this._y=t*x*h+e*D*N,this._z=t*D*N+e*x*h,this._w=t*D*h-e*x*N):"ZYX"===W?(this._x=e*D*h-t*x*N,this._y=t*x*h+e*D*N,this._z=t*D*N-e*x*h,this._w=t*D*h+e*x*N):"YZX"===W?(this._x=e*D*h+t*x*N,this._y=t*x*h+e*D*N,this._z=t*D*N-e*x*h,this._w=t*D*h-e*x*N):"XZY"===W&&(this._x=e*D*h-t*x*N,this._y=t*x*h-e*D*N,this._z=t*D*N+e*x*h,this._w=t*D*h+e*x*N),this},setFromRotationMatrix:function(I){var b,B=I.el,a=B[0],R=B[4],p=B[8],A=B[1],G=B[5],y=B[9],N=B[2],g=B[6],D=B[10],l=a+G+D;return l>0?(b=.5/Math.sqrt(l+1),this._w=.25/b,this._x=(g-y)*b,this._y=(p-N)*b,this._z=(A-R)*b):a>G&&a>D?(b=2*Math.sqrt(1+a-G-D),this._w=(g-y)/b,this._x=.25*b,this._y=(R+A)/b,this._z=(p+N)/b):G>D?(b=2*Math.sqrt(1+G-a-D),this._w=(p-N)/b,this._x=(R+A)/b,this._y=.25*b,this._z=(y+g)/b):(b=2*Math.sqrt(1+D-a-G),this._w=(A-R)/b,this._x=(p+N)/b,this._y=(y+g)/b,this._z=.25*b),this},setFromToVectors:function(){var D,i;return function(P,R){return D===m&&(D=new ur),i=P.dot(R)+1,1e-7>i?(i=0,Math.abs(P.x)>Math.abs(P.z)?D.set(-P.y,P.x,0):D.set(0,-P.z,P.y)):D.crossVectors(P,R),this._x=D.x,this._y=D.y,this._z=D.z,this._w=i,this.normalize()}}(),setFromUnitVectors:function(){var Q,l,V=1e-6;return function(K,U){return Q===m&&(Q=new ur),l=K.dot(U)+1,V>l?(l=0,Math.abs(K.x)>Math.abs(K.z)?Q.set(-K.y,K.x,0):Q.set(0,-K.z,K.y)):Q.crossVectors(K,U),this._x=Q.x,this._y=Q.y,this._z=Q.z,this._w=l,this.normalize()}}(),multiply:function(Y){return this.multiplyQuaternions(this,Y)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(t,Y){var K=t._x,G=t._y,c=t._z,L=t._w,S=Y._x,j=Y._y,Q=Y._z,y=Y._w;return this._x=K*y+L*S+G*Q-c*j,this._y=G*y+L*j+c*S-K*Q,this._z=c*y+L*Q+K*j-G*S,this._w=L*y-K*S-G*j-c*Q,this}});var Hh=f.Math.Vector4=function(X,B,u,c){this.x=X||0,this.y=B||0,this.z=u||0,this.w=c!==m?c:1};I.assign(Hh.prototype,{isVector4:!0,set:function(Z,F,d,E){return this.x=Z,this.y=F,this.z=d,this.w=E,this},setScalar:function(L){return this.x=L,this.y=L,this.z=L,this.w=L,this},setX:function(J){return this.x=J,this},setY:function(z){return this.y=z,this},setZ:function(R){return this.z=R,this},setW:function(o){return this.w=o,this},setComponent:function(l,Y){switch(l){case 0:this.x=Y;break;case 1:this.y=Y;break;case 2:this.z=Y;break;case 3:this.w=Y;break;default:throw new Error("index is out of range: "+l)}return this},getComponent:function(R){switch(R){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+R)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(b){return this.x=b.x,this.y=b.y,this.z=b.z,this.w=b.w!==m?b.w:1,this},add:function(i,E){return E!==m?this.addVectors(i,E):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this.w+=i.w,this)},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this},addVectors:function(s,l){return this.x=s.x+l.x,this.y=s.y+l.y,this.z=s.z+l.z,this.w=s.w+l.w,this},addScaledVector:function(e,S){return this.x+=e.x*S,this.y+=e.y*S,this.z+=e.z*S,this.w+=e.w*S,this},sub:function(N,v){return v!==m?this.subVectors(N,v):(this.x-=N.x,this.y-=N.y,this.z-=N.z,this.w-=N.w,this)},subScalar:function(n){return this.x-=n,this.y-=n,this.z-=n,this.w-=n,this},subVectors:function(o,e){return this.x=o.x-e.x,this.y=o.y-e.y,this.z=o.z-e.z,this.w=o.w-e.w,this},multiplyScalar:function(l){return this.x*=l,this.y*=l,this.z*=l,this.w*=l,this},applyMatrix4:function(E){var p=this.x,K=this.y,Z=this.z,W=this.w,t=E.el;return this.x=t[0]*p+t[4]*K+t[8]*Z+t[12]*W,this.y=t[1]*p+t[5]*K+t[9]*Z+t[13]*W,this.z=t[2]*p+t[6]*K+t[10]*Z+t[14]*W,this.w=t[3]*p+t[7]*K+t[11]*Z+t[15]*W,this},divideScalar:function(C){return this.multiplyScalar(1/C)},setAxisAngleFromQuaternion:function(s){this.w=2*Math.acos(s.w);var y=Math.sqrt(1-s.w*s.w);return 1e-4>y?(this.x=1,this.y=0,this.z=0):(this.x=s.x/y,this.y=s.y/y,this.z=s.z/y),this},setAxisAngleFromRotationMatrix:function(B){var W,L,q,x,w=.01,Z=.1,v=B.el,E=v[0],e=v[4],r=v[8],i=v[1],R=v[5],z=v[9],u=v[2],O=v[6],H=v[10];if(Math.abs(e-i)<w&&Math.abs(r-u)<w&&Math.abs(z-O)<w){if(Math.abs(e+i)<Z&&Math.abs(r+u)<Z&&Math.abs(z+O)<Z&&Math.abs(E+R+H-3)<Z)return this.set(1,0,0,0),this;W=Math.PI;var T=(E+1)/2,b=(R+1)/2,m=(H+1)/2,C=(e+i)/4,U=(r+u)/4,f=(z+O)/4;return T>b&&T>m?w>T?(L=0,q=.707106781,x=.707106781):(L=Math.sqrt(T),q=C/L,x=U/L):b>m?w>b?(L=.707106781,q=0,x=.707106781):(q=Math.sqrt(b),L=C/q,x=f/q):w>m?(L=.707106781,q=.707106781,x=0):(x=Math.sqrt(m),L=U/x,q=f/x),this.set(L,q,x,W),this}var t=Math.sqrt((O-z)*(O-z)+(r-u)*(r-u)+(i-e)*(i-e));return Math.abs(t)<.001&&(t=1),this.x=(O-z)/t,this.y=(r-u)/t,this.z=(i-e)/t,this.w=Math.acos((E+R+H-1)/2),this},min:function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this.w=Math.min(this.w,u.w),this},max:function(B){return this.x=Math.max(this.x,B.x),this.y=Math.max(this.y,B.y),this.z=Math.max(this.z,B.z),this.w=Math.max(this.w,B.w),this},clamp:function(N,K){return this.x=Math.max(N.x,Math.min(K.x,this.x)),this.y=Math.max(N.y,Math.min(K.y,this.y)),this.z=Math.max(N.z,Math.min(K.z,this.z)),this.w=Math.max(N.w,Math.min(K.w,this.w)),this},clampScalar:function(){var L,e;return function(W,v){return L===m&&(L=new Hh,e=new Hh),L.set(W,W,W,W),e.set(v,v,v,v),this.clamp(L,e)}}(),clampLength:function(p,g){var X=this.length();return this.divideScalar(X||1).multiplyScalar(Math.max(p,Math.min(g,X)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(q){return this.x*q.x+this.y*q.y+this.z*q.z+this.w*q.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(u){return this.normalize().multiplyScalar(u)},lerp:function(D,G){return this.x+=(D.x-this.x)*G,this.y+=(D.y-this.y)*G,this.z+=(D.z-this.z)*G,this.w+=(D.w-this.w)*G,this},lerpVectors:function(a,T,f){return this.subVectors(T,a).multiplyScalar(f).add(a)},equals:function(q){return q.x===this.x&&q.y===this.y&&q.z===this.z&&q.w===this.w},fromArray:function(J,j){return j===m&&(j=0),this.x=J[j],this.y=J[j+1],this.z=J[j+2],this.w=J[j+3],this},toArray:function(g,h){return g===m&&(g=[]),h===m&&(h=0),g[h]=this.x,g[h+1]=this.y,g[h+2]=this.z,g[h+3]=this.w,g},fromBufferAttribute:function(p,k){return this.x=p.getX(k),this.y=p.getY(k),this.z=p.getZ(k),this.w=p.getW(k),this}});var ur=f.Math.Vector3=function(W,o,L){W===m?(this.x=0,this.y=0,this.z=0):"object"==typeof W?this.copy(W):this.set(W,o==m?W:o,L==m?W:L)};I.assign(ur.prototype,{set:function($,Z,j){return this.x=$,this.y=Z,this.z=j,this},equals:function(y){return y&&this.x===y.x&&this.y===y.y&&this.z===y.z},setScalar:function(g){return this.x=g,this.y=g,this.z=g,this},setX:function(U){return this.x=U,this},setY:function(x){return this.y=x,this},setZ:function(d){return this.z=d,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(A){return A.x===m?(this.x=A[0],this.y=A[1],this.z=A[2]):(this.x=A.x,this.y=A.y,this.z=A.z),this},add:function(u){return this.x+=u.x,this.y+=u.y,this.z+=u.z,this},addScalar:function(r){return this.x+=r,this.y+=r,this.z+=r,this},addVectors:function(B,u){return this.x=B.x+u.x,this.y=B.y+u.y,this.z=B.z+u.z,this},addScaledVector:function(j,Z){return this.x+=j.x*Z,this.y+=j.y*Z,this.z+=j.z*Z,this},sub:function(_){return this.x-=_.x,this.y-=_.y,this.z-=_.z,this},subScalar:function(K){return this.x-=K,this.y-=K,this.z-=K,this},subVectors:function(y,N){return this.x=y.x-N.x,this.y=y.y-N.y,this.z=y.z-N.z,this},multiply:function(u){return this.x*=u.x,this.y*=u.y,this.z*=u.z,this},multiplyScalar:function(I){return this.x*=I,this.y*=I,this.z*=I,this},distanceTo:function(h){return Math.sqrt(this.distanceToSquared(h))},distanceToSquared:function(_){var z=this.x-_.x,n=this.y-_.y,x=this.z-_.z;return z*z+n*n+x*x},distanceToSquared2:function(q){var f=this.x-q[0],X=this.y-q[1],N=this.z-q[2];return f*f+X*X+N*N},multiplyVectors:function(q,j){return this.x=q.x*j.x,this.y=q.y*j.y,this.z=q.z*j.z,this},transformDirection:function(s){var K=this.x,r=this.y,k=this.z,i=s.el;return this.x=i[0]*K+i[4]*r+i[8]*k,this.y=i[1]*K+i[5]*r+i[9]*k,this.z=i[2]*K+i[6]*r+i[10]*k,this.normalize()},applyEuler:function(){var c=new eg;return function(V){return this.applyQuaternion(c.setFromEuler(V))}}(),applyQuaternion:function(n){var E=this.x,l=this.y,e=this.z,Q=n._x,B=n._y,k=n._z,h=n._w,s=h*E+B*e-k*l,j=h*l+k*E-Q*e,b=h*e+Q*l-B*E,m=-Q*E-B*l-k*e;return this.x=s*h+m*-Q+j*-k-b*-B,this.y=j*h+m*-B+b*-Q-s*-k,this.z=b*h+m*-k+s*-B-j*-Q,this},applyMatrix4:function(W){var j=this.x,D=this.y,h=this.z,Q=W.el,X=1/(Q[3]*j+Q[7]*D+Q[11]*h+Q[15]);return this.x=(Q[0]*j+Q[4]*D+Q[8]*h+Q[12])*X,this.y=(Q[1]*j+Q[5]*D+Q[9]*h+Q[13])*X,this.z=(Q[2]*j+Q[6]*D+Q[10]*h+Q[14])*X,this},applyMatrix3:function(E){var k=this.x,S=this.y,o=this.z,I=E.el;return this.x=I[0]*k+I[3]*S+I[6]*o,this.y=I[1]*k+I[4]*S+I[7]*o,this.z=I[2]*k+I[5]*S+I[8]*o,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var P=new ur;return function(L){return this.sub(P.copy(L).multiplyScalar(2*this.dot(L)))}}(),dot:function(O){return this.x*O.x+this.y*O.y+this.z*O.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var w=this.length();return w?this.multiplyScalar(1/w):this},setLength:function(T){return this.normalize().multiplyScalar(T)},fromArray:function(X,D){return D===m&&(D=0),this.x=X[D],this.y=X[D+1],this.z=X[D+2],this},toArray:function(L,p){return L===m&&(L=[0,0,0]),p===m&&(p=0),L[p]=this.x,L[p+1]=this.y,L[p+2]=this.z,L},cross:function(C){return this.crossVectors(this,C)},angleTo:function(L){var N=this.dot(L)/Math.sqrt(this.lengthSq()*L.lengthSq());return N>1||-1>N?0:Math.acos(N)},lerpVectors:function(Q,W,p){return this.subVectors(W,Q).multiplyScalar(p).add(Q)},crossVectors:function(F,o){var m=F.x,f=F.y,n=F.z,N=o.x,O=o.y,R=o.z;return this.x=f*R-n*O,this.y=n*N-m*R,this.z=m*O-f*N,this},min:function(T){return this.x=Math.min(this.x,T.x),this.y=Math.min(this.y,T.y),this.z=Math.min(this.z,T.z),this},max:function(H){return this.x=Math.max(this.x,H.x),this.y=Math.max(this.y,H.y),this.z=Math.max(this.z,H.z),this},setFromMatrixPosition:function(x){return this.setFromMatrixColumn(x,3)
},setFromMatrixScale:function(Q){var V=this.setFromMatrixColumn(Q,0).length(),m=this.setFromMatrixColumn(Q,1).length(),s=this.setFromMatrixColumn(Q,2).length();return this.x=V,this.y=m,this.z=s,this},setFromMatrixColumn:function(k,M){return this.fromArray(k.el,4*M)}});var Dh=f.Math.Vector2=function(y,q,w){"object"==typeof y&&(y.x!=m?(q=y.y,y=y.x,w=y.e):(w=y[2],q=y[1],y=y[0])),this.set(y||0,q||0,w)};Dh.prototype={},Dh.prototype.constructor=Dh,I.defineProperties(Dh.prototype,{width:{get:function(){return this.x},set:function(S){this.x=S}},height:{get:function(){return this.y},set:function(X){this.y=X}}}),Dh.prototype.clone=function(){return new Dh(this.x,this.y,this.e)},Dh.prototype.copy=function(N){return this.set(N.x,N.y,N.e),this},Dh.prototype.equals=function(R){return R.x===this.x&&R.y===this.y},Dh.prototype.set=function(v,k,O){return this.x=v||0,this.y=k||(0!==k?this.x:0),O!=m&&(this.e=O),this},Dh.prototype.setScalar=function(h){return this.x=h,this.y=h,this},Dh.prototype.setX=function(Q){return this.x=Q||0,this},Dh.prototype.setY=function(N){return this.y=N||0,this},Dh.prototype.add=function(l){return this.x+=l.x,this.y+=l.y,this},Dh.prototype.addVectors=function(Q,p){return this.x=Q.x+p.x,this.y=Q.y+p.y,this},Dh.prototype.addScalar=function(X){return this.x+=X,this.y+=X,this},Dh.prototype.addScaledVector=function(B,h){return this.x+=B.x*h,this.y+=B.y*h,this},Dh.prototype.sub=function(v){return this.x-=v.x,this.y-=v.y,this},Dh.prototype.subScalar=function(E){return this.x-=E,this.y-=E,this},Dh.prototype.subVectors=function(K,Z){return this.x=K.x-Z.x,this.y=K.y-Z.y,this},Dh.prototype.multiply=function(q){return this.x*=q.x,this.y*=q.y,this},Dh.prototype.multiplyScalar=function(d){return this.x*=d,this.y*=d,this},Dh.prototype.divide=function(g){return this.x/=g.x,this.y/=g.y,this},Dh.prototype.divideScalar=function(y){return this.multiplyScalar(1/y)},Dh.prototype.min=function(X){return this.x=Math.min(this.x,X.x),this.y=Math.min(this.y,X.y),this},Dh.prototype.max=function(b){return this.x=Math.max(this.x,b.x),this.y=Math.max(this.y,b.y),this},Dh.prototype.fromArray=function(y,v){return v===m&&(v=0),this.x=y[v],this.y=y[v+1],this},Dh.prototype.clamp=function(q,Q){return this.x=Math.max(q.x,Math.min(Q.x,this.x)),this.y=Math.max(q.y,Math.min(Q.y,this.y)),this},Dh.prototype.clampScalar=function(){var K,c;return function(H,p){return K===m&&(K=new Dh,c=new Dh),K.set(H,H),c.set(p,p),this.clamp(K,c)}}(),Dh.prototype.clampLength=function(t,k){var G=this.length();return this.multiplyScalar(Math.max(t,Math.min(k,G))/G)},Dh.prototype.dot=function(E){return this.x*E.x+this.y*E.y},Dh.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Dh.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Dh.prototype.normalize=function(){return this.divideScalar(this.length())},Dh.prototype.angle=function(){var A=Math.atan2(this.y,this.x);return 0>A&&(A+=2*Math.PI),A},Dh.prototype.distanceTo=function(A){return Math.sqrt(this.distanceToSquared(A))},Dh.prototype.distanceToSquared=function(I){var U=this.x-I.x,S=this.y-I.y;return U*U+S*S},Dh.prototype.isNearEnough=function(u){return this.distanceToSquared(u)<1e-8},Dh.prototype.setLength=function(v){var D=this.length();return D?this.multiplyScalar(v/D):this},Dh.prototype.lerp=function(h,f){return this.x+=(h.x-this.x)*f,this.y+=(h.y-this.y)*f,this},Dh.prototype.lerpVectors=function(K,X,H){return this.subVectors(X,K).multiplyScalar(H).add(K)},Dh.prototype.rotateAround=function(X,t){var y=X?X.x:0,F=X?X.y:0,f=Math.cos(t),N=Math.sin(t),P=this.x-y,R=this.y-F;return this.x=P*f-R*N+y,this.y=P*N+R*f+F,this},I.assign(E.prototype,{isMatrix3:!0,set:function(v,T,u,S,E,G,W,U,g){var C=this.el;return C[0]=v,C[1]=S,C[2]=W,C[3]=T,C[4]=E,C[5]=U,C[6]=u,C[7]=G,C[8]=g,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(C){var O=this.el,S=C.el;return O[0]=S[0],O[1]=S[1],O[2]=S[2],O[3]=S[3],O[4]=S[4],O[5]=S[5],O[6]=S[6],O[7]=S[7],O[8]=S[8],this},setFromMatrix4:function(v){var U=v.el;return this.set(U[0],U[4],U[8],U[1],U[5],U[9],U[2],U[6],U[10]),this},applyToBufferAttribute:function(){var w=new ur;return function(x){for(var B=0,e=x.count;e>B;B++)w.x=x.getX(B),w.y=x.getY(B),w.z=x.getZ(B),w.applyMatrix3(this),x.setXYZ(B,w.x,w.y,w.z);return x}}(),multiply:function(j){return this.multiplyMatrices(this,j)},premultiply:function(x){return this.multiplyMatrices(x,this)},multiplyMatrices:function(F,A){var B=F.el,R=A.el,l=this.el,C=B[0],L=B[3],H=B[6],Y=B[1],P=B[4],i=B[7],E=B[2],T=B[5],$=B[8],p=R[0],t=R[3],W=R[6],U=R[1],y=R[4],N=R[7],q=R[2],O=R[5],n=R[8];return l[0]=C*p+L*U+H*q,l[3]=C*t+L*y+H*O,l[6]=C*W+L*N+H*n,l[1]=Y*p+P*U+i*q,l[4]=Y*t+P*y+i*O,l[7]=Y*W+P*N+i*n,l[2]=E*p+T*U+$*q,l[5]=E*t+T*y+$*O,l[8]=E*W+T*N+$*n,this},multiplyScalar:function(z){var F=this.el;return F[0]*=z,F[3]*=z,F[6]*=z,F[1]*=z,F[4]*=z,F[7]*=z,F[2]*=z,F[5]*=z,F[8]*=z,this},determinant:function(){var m=this.el,X=m[0],l=m[1],T=m[2],G=m[3],h=m[4],k=m[5],M=m[6],A=m[7],E=m[8];return X*h*E-X*k*A-l*G*E+l*k*M+T*G*A-T*h*M},getInverse:function(h){var d=h.el,y=this.el,v=d[0],R=d[1],V=d[2],n=d[3],N=d[4],m=d[5],D=d[6],u=d[7],X=d[8],x=X*N-m*u,p=m*D-X*n,W=u*n-N*D,E=v*x+R*p+V*W;if(0===E)return this.identity();var t=1/E;return y[0]=x*t,y[1]=(V*u-X*R)*t,y[2]=(m*R-V*N)*t,y[3]=p*t,y[4]=(X*v-V*D)*t,y[5]=(V*n-m*v)*t,y[6]=W*t,y[7]=(R*D-u*v)*t,y[8]=(N*v-R*n)*t,this},transpose:function(){var M,e=this.el;return M=e[1],e[1]=e[3],e[3]=M,M=e[2],e[2]=e[6],e[6]=M,M=e[5],e[5]=e[7],e[7]=M,this},getNormalMatrix:function(H){return this.setFromMatrix4(H).getInverse(this).transpose()},transposeIntoArray:function(W){var A=this.el;return W[0]=A[0],W[1]=A[3],W[2]=A[6],W[3]=A[1],W[4]=A[4],W[5]=A[7],W[6]=A[2],W[7]=A[5],W[8]=A[8],this},setUvTransform:function(F,v,H,N,g,D,j){var Q=Math.cos(g),K=Math.sin(g);this.set(H*Q,H*K,-H*(Q*D+K*j)+D+F,-N*K,N*Q,-N*(-K*D+Q*j)+j+v,0,0,1)},scale:function(X,f){var p=this.el;return p[0]*=X,p[3]*=X,p[6]*=X,p[1]*=f,p[4]*=f,p[7]*=f,this},rotate:function(Q){var b=Math.cos(Q),K=Math.sin(Q),a=this.el,q=a[0],A=a[3],z=a[6],f=a[1],s=a[4],Y=a[7];return a[0]=b*q+K*f,a[3]=b*A+K*s,a[6]=b*z+K*Y,a[1]=-K*q+b*f,a[4]=-K*A+b*s,a[7]=-K*z+b*Y,this},translate:function(i,y){var o=this.el;return o[0]+=i*o[2],o[3]+=i*o[5],o[6]+=i*o[8],o[1]+=y*o[2],o[4]+=y*o[5],o[7]+=y*o[8],this},equals:function(F){for(var P=this.el,z=F.el,S=0;9>S;S++)if(P[S]!==z[S])return!1;return!0},fromArray:function(M,U){U===m&&(U=0);for(var j=0;9>j;j++)this.el[j]=M[j+U];return this},toArray:function(V,t){V===m&&(V=[]),t===m&&(t=0);var u=this.el;return V[t]=u[0],V[t+1]=u[1],V[t+2]=u[2],V[t+3]=u[3],V[t+4]=u[4],V[t+5]=u[5],V[t+6]=u[6],V[t+7]=u[7],V[t+8]=u[8],V}});var or=f.Math.Plane=function(S,X){this.normal=S!==m?S:new ur(1,0,0),this.constant=X!==m?X:0};I.assign(or.prototype,{set:function(m,j){return this.normal.copy(m),this.constant=j,this},setComponents:function(x,h,R,w){return this.normal.set(x,h,R),this.constant=w,this},setFromNormalAndCoplanarPoint:function(g,J){return this.normal.copy(g),this.constant=-J.dot(this.normal),this},setFromCoplanarPoints:function(){var g=new ur,A=new ur;return function($,l,O){var o=g.subVectors(O,l).cross(A.subVectors($,l)).normalize();return this.setFromNormalAndCoplanarPoint(o,$),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(D){return this.normal.copy(D.normal),this.constant=D.constant,this},normalize:function(){var _=1/this.normal.length();return this.normal.multiplyScalar(_),this.constant*=_,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(J){return this.normal.dot(J)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function($,f){return f===m&&(f=new ur),f.copy(this.normal).multiplyScalar(-this.distanceToPoint($)).add($)},intersectLine:function(){var $=new ur;return function(r,D){D===m&&(D=new ur);var S=r.delta($),h=this.normal.dot(S);if(0===h)return 0===this.distanceToPoint(r.start)?D.copy(r.start):m;var n=-(r.start.dot(this.normal)+this.constant)/h;return 0>n||n>1?m:D.copy(S).multiplyScalar(n).add(r.start)}}(),intersectsLine:function(B){var e=this.distanceToPoint(B.start),K=this.distanceToPoint(B.end);return 0>e&&K>0||0>K&&e>0},intersectsBox:function(K){return K.intersectsPlane(this)},intersectsSphere:function(L){return L.intersectsPlane(this)},coplanarPoint:function(S){return S===m&&(S=new ur),S.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var j=new ur,L=new E;return function(G,o){var _=o||L.getNormalMatrix(G),Q=this.coplanarPoint(j).applyMatrix4(G),w=this.normal.applyMatrix3(_).normalize();return this.constant=-Q.dot(w),this}}(),translate:function(D){return this.constant-=D.dot(this.normal),this},equals:function(S){return S.normal.equals(this.normal)&&S.constant===this.constant}});var Ro=f.Math.Ray=function(c,i){this.origin=c!==m?c.clone():new ur,this.direction=i!==m?i.clone():new ur};I.assign(Ro.prototype,{set:function(Y,L){return this.origin.copy(Y),this.direction.copy(L),this},clone:function(){return(new this.constructor).copy(this)},copy:function(H){return this.origin.copy(H.origin),this.direction.copy(H.direction),this.maxHitLen=H.maxHitLen,this},at:function(Z,o){var A=o||new ur;return A.copy(this.direction).multiplyScalar(Z).add(this.origin)},setMaxHitLength:function(C){this.maxHitLen=C},lookAt:function(j){return this.direction.copy(j).sub(this.origin).normalize(),this},applyMatrix4:function(l){var v=this.maxHitLen;if(v){var L=this.direction.clone().multiplyScalar(v).add(this.origin);L.applyMatrix4(l)}return this.origin.applyMatrix4(l),this.direction.transformDirection(l),v&&(this.maxHitLen=this.origin.distanceTo(L)),this},intersectBox:function(d,k){var F,O,$,x,v,S,T=1/this.direction.x,t=1/this.direction.y,b=1/this.direction.z,i=this.origin;if(T>=0?(F=(d.min.x-i.x)*T,O=(d.max.x-i.x)*T):(F=(d.max.x-i.x)*T,O=(d.min.x-i.x)*T),t>=0?($=(d.min.y-i.y)*t,x=(d.max.y-i.y)*t):($=(d.max.y-i.y)*t,x=(d.min.y-i.y)*t),F>x||$>O)return null;if(($>F||F!==F)&&(F=$),(O>x||O!==O)&&(O=x),b>=0?(v=(d.min.z-i.z)*b,S=(d.max.z-i.z)*b):(v=(d.max.z-i.z)*b,S=(d.min.z-i.z)*b),F>S||v>O)return null;if((v>F||F!==F)&&(F=v),(O>S||O!==O)&&(O=S),0>O)return null;var J=F>=0?F:O,K=this.maxHitLen;return K&&J>K?null:this.at(J,k)},intersectTriangle:function(){var h=new ur,W=new ur,s=new ur,k=new ur;return function(H,I,O,x,Q){W.subVectors(I,H),s.subVectors(O,H),k.crossVectors(W,s);var c,j=this.direction.dot(k);if(j>0){if(x)return null;c=1}else{if(!(0>j))return null;c=-1,j=-j}h.subVectors(this.origin,H);var m=c*this.direction.dot(s.crossVectors(h,s));if(0>m)return null;var r=c*this.direction.dot(W.cross(h));if(0>r||m+r>j)return null;var n=-c*h.dot(k);if(0>n)return null;var D=n/j,M=this.maxHitLen;return M&&D>M?null:this.at(D,Q)}}()});var Pk=f.Math.Box3=function(I,T){this.min=I!==m?I:new ur(1/0,1/0,1/0),this.max=T!==m?T:new ur(-1/0,-1/0,-1/0)};I.assign(Pk.prototype,{set:function(d,s){return this.min.copy(d),this.max.copy(s),this},setFromArray:function(s){for(var g=1/0,$=1/0,F=1/0,L=-1/0,W=-1/0,a=-1/0,t=0,A=s.length;A>t;t+=3){var H=s[t],_=s[t+1],x=s[t+2];g>H&&(g=H),$>_&&($=_),F>x&&(F=x),H>L&&(L=H),_>W&&(W=_),x>a&&(a=x)}return this.min.set(g,$,F),this.max.set(L,W,a),this},setFromPoints:function(Z){this.makeEmpty();for(var f=0,z=Z.length;z>f;f++)this.expandByPoint(Z[f]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(y){return y.max.x<this.min.x||y.min.x>this.max.x||y.max.y<this.min.y||y.min.y>this.max.y||y.max.z<this.min.z||y.min.z>this.max.z?!1:!0},copy:function(r){return this.min.copy(r.min),this.max.copy(r.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(B){return this.min.min(B),this.max.max(B),this}});var jc=f.Math.Sphere=function(s,u){this.center=s!==m?s:new ur,this.radius=u!==m?u:0};I.assign(jc.prototype,{set:function(W,A){return this.center.copy(W),this.radius=A,this},setFromPoints:function(){var G=new Pk;return function(H,I){var v=this.center;I!==m?v.copy(I):G.setFromPoints(H).getCenter(v);for(var j=0,p=0,u=H.length;u>p;p++)j=Math.max(j,v.distanceToSquared(H[p]));return this.radius=Math.sqrt(j),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(s){return this.center.copy(s.center),this.radius=s.radius,this},empty:function(){return this.radius<=0},containsPoint:function(x){return x.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function($){return $.distanceTo(this.center)-this.radius},intersectsSphere:function(B){var X=this.radius+B.radius;return B.center.distanceToSquared(this.center)<=X*X},intersectsBox:function(E){return E.intersectsSphere(this)},intersectsPlane:function(U){return Math.abs(U.distanceToPoint(this.center))<=this.radius},clampPoint:function(q,v){var f=this.center.distanceToSquared(q);return v===m&&(v=new ur),v.copy(q),f>this.radius*this.radius&&(v.sub(this.center).normalize(),v.multiplyScalar(this.radius).add(this.center)),v},getBoundingBox:function(K){return K===m&&(K=new Pk),K.set(this.center,this.center),K.expandByScalar(this.radius),K},applyMatrix4:function(K){return this.center.applyMatrix4(K),this.radius=this.radius*K.getMaxScaleOnAxis(),this},translate:function(J){return this.center.add(J),this},equals:function(L){return L.center.equals(this.center)&&L.radius===this.radius}});var Xc=f.Math.Frustum=function(x,D,u,Q,q,O){this.planes=[x!==m?x:new or,D!==m?D:new or,u!==m?u:new or,Q!==m?Q:new or,q!==m?q:new or,O!==m?O:new or]};I.assign(Xc.prototype,{set:function(v,C,Z,w,b,u){var K=this.planes;return K[0].copy(v),K[1].copy(C),K[2].copy(Z),K[3].copy(w),K[4].copy(b),K[5].copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(D){for(var p=this.planes,v=0;6>v;v++)p[v].copy(D.planes[v]);return this},setFromMatrix:function(D){var H=this.planes,b=D.el,h=b[0],k=b[1],e=b[2],i=b[3],T=b[4],B=b[5],x=b[6],v=b[7],c=b[8],s=b[9],u=b[10],r=b[11],F=b[12],N=b[13],l=b[14],V=b[15];return H[0].setComponents(i-h,v-T,r-c,V-F).normalize(),H[1].setComponents(i+h,v+T,r+c,V+F).normalize(),H[2].setComponents(i+k,v+B,r+s,V+N).normalize(),H[3].setComponents(i-k,v-B,r-s,V-N).normalize(),H[4].setComponents(i-e,v-x,r-u,V-l).normalize(),H[5].setComponents(i+e,v+x,r+u,V+l).normalize(),this},intersectsObject:function(){var w=new jc;return function(I){var K=I.geometry;return null===K.boundingSphere&&K.computeBoundingSphere(),w.copy(K.boundingSphere).applyMatrix4(I.matrixWorld),this.intersectsSphere(w)}}(),intersectsSprite:function(){var X=new jc;return function(G){return X.center.set(0,0,0),X.radius=.7071067811865476,X.applyMatrix4(G.matrixWorld),this.intersectsSphere(X)}}(),intersectsSphere:function(f){for(var S=this.planes,T=f.center,R=-f.radius,m=0;6>m;m++){var C=S[m].distanceToPoint(T);if(R>C)return!1}return!0},intersectsBox:function(){var j=new ur;return function(L){for(var M=this.planes,z=0;6>z;z++){var F=M[z];if(j.x=F.normal.x>0?L.max.x:L.min.x,j.y=F.normal.y>0?L.max.y:L.min.y,j.z=F.normal.z>0?L.max.z:L.min.z,F.distanceToPoint(j)<0)return!1}return!0}}(),containsPoint:function(C){for(var l=this.planes,z=0;6>z;z++)if(l[z].distanceToPoint(C)<0)return!1;return!0}});var Jb=f.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};I.assign(Jb.prototype,{set:function(X,I,P,w,H,m,D,G,R,n,z,a,J,Q,y,L){var x=this.el;return x[0]=X,x[4]=I,x[8]=P,x[12]=w,x[1]=H,x[5]=m,x[9]=D,x[13]=G,x[2]=R,x[6]=n,x[10]=z,x[14]=a,x[3]=J,x[7]=Q,x[11]=y,x[15]=L,this},clone:function(){return(new Jb).fromArray(this.el)},fromArray:function(_,X){X===m&&(X=0);for(var C=this.el,M=0;16>M;M++)C[M]=_[M+X];return this},scale:function(x){var q=this.el,u=x.x,o=x.y,y=x.z;return q[0]*=u,q[4]*=o,q[8]*=y,q[1]*=u,q[5]*=o,q[9]*=y,q[2]*=u,q[6]*=o,q[10]*=y,q[3]*=u,q[7]*=o,q[11]*=y,this},makeRotationFromEuler:function(L){var i=this.el,f=L._x,V=L._y,v=L._z,Y=L._order,T=Math.cos(f),C=Math.sin(f),N=Math.cos(V),F=Math.sin(V),E=Math.cos(v),m=Math.sin(v);if("XYZ"===Y){var n=T*E,w=T*m,P=C*E,d=C*m;i[0]=N*E,i[4]=-N*m,i[8]=F,i[1]=w+P*F,i[5]=n-d*F,i[9]=-C*N,i[2]=d-n*F,i[6]=P+w*F,i[10]=T*N}else if("YXZ"===Y){var X=N*E,$=N*m,s=F*E,H=F*m;i[0]=X+H*C,i[4]=s*C-$,i[8]=T*F,i[1]=T*m,i[5]=T*E,i[9]=-C,i[2]=$*C-s,i[6]=H+X*C,i[10]=T*N}else if("ZXY"===Y){var X=N*E,$=N*m,s=F*E,H=F*m;i[0]=X-H*C,i[4]=-T*m,i[8]=s+$*C,i[1]=$+s*C,i[5]=T*E,i[9]=H-X*C,i[2]=-T*F,i[6]=C,i[10]=T*N}else if("ZYX"===Y){var n=T*E,w=T*m,P=C*E,d=C*m;i[0]=N*E,i[4]=P*F-w,i[8]=n*F+d,i[1]=N*m,i[5]=d*F+n,i[9]=w*F-P,i[2]=-F,i[6]=C*N,i[10]=T*N}else if("YZX"===Y){var k=T*N,a=T*F,q=C*N,J=C*F;i[0]=N*E,i[4]=J-k*m,i[8]=q*m+a,i[1]=m,i[5]=T*E,i[9]=-C*E,i[2]=-F*E,i[6]=a*m+q,i[10]=k-J*m}else if("XZY"===Y){var k=T*N,a=T*F,q=C*N,J=C*F;i[0]=N*E,i[4]=-m,i[8]=F*E,i[1]=k*m+J,i[5]=T*E,i[9]=a*m-q,i[2]=q*m-a,i[6]=C*E,i[10]=J*m+k}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(x){var u=this.el,$=x._x,a=x._y,X=x._z,H=x._w,F=$+$,w=a+a,L=X+X,E=$*F,q=$*w,m=$*L,d=a*w,M=a*L,s=X*L,N=H*F,V=H*w,C=H*L;return u[0]=1-(d+s),u[4]=q-C,u[8]=m+V,u[1]=q+C,u[5]=1-(E+s),u[9]=M-N,u[2]=m-V,u[6]=M+N,u[10]=1-(E+d),u[3]=0,u[7]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(d){var G=this.el,N=d.el,S=N[0],j=N[1],P=N[2],J=N[3],v=N[4],w=N[5],W=N[6],h=N[7],i=N[8],L=N[9],$=N[10],o=N[11],U=N[12],M=N[13],y=N[14],s=N[15],e=L*y*h-M*$*h+M*W*o-w*y*o-L*W*s+w*$*s,F=U*$*h-i*y*h-U*W*o+v*y*o+i*W*s-v*$*s,V=i*M*h-U*L*h+U*w*o-v*M*o-i*w*s+v*L*s,I=U*L*W-i*M*W-U*w*$+v*M*$+i*w*y-v*L*y,R=S*e+j*F+P*V+J*I;if(0===R)return this.identity();var c=1/R;return G[0]=e*c,G[1]=(M*$*J-L*y*J-M*P*o+j*y*o+L*P*s-j*$*s)*c,G[2]=(w*y*J-M*W*J+M*P*h-j*y*h-w*P*s+j*W*s)*c,G[3]=(L*W*J-w*$*J-L*P*h+j*$*h+w*P*o-j*W*o)*c,G[4]=F*c,G[5]=(i*y*J-U*$*J+U*P*o-S*y*o-i*P*s+S*$*s)*c,G[6]=(U*W*J-v*y*J-U*P*h+S*y*h+v*P*s-S*W*s)*c,G[7]=(v*$*J-i*W*J+i*P*h-S*$*h-v*P*o+S*W*o)*c,G[8]=V*c,G[9]=(U*L*J-i*M*J-U*j*o+S*M*o+i*j*s-S*L*s)*c,G[10]=(v*M*J-U*w*J+U*j*h-S*M*h-v*j*s+S*w*s)*c,G[11]=(i*w*J-v*L*J-i*j*h+S*L*h+v*j*o-S*w*o)*c,G[12]=I*c,G[13]=(i*M*P-U*L*P+U*j*$-S*M*$-i*j*y+S*L*y)*c,G[14]=(U*w*P-v*M*P-U*j*W+S*M*W+v*j*y-S*w*y)*c,G[15]=(v*L*P-i*w*P+i*j*W-S*L*W-v*j*$+S*w*$)*c,this},makeRotationAxis:function(C,Y){var J=Math.cos(Y),l=Math.sin(Y),d=1-J,e=C.x,m=C.y,q=C.z,y=d*e,K=d*m;return this.set(y*e+J,y*m-l*q,y*q+l*m,0,y*m+l*q,K*m+J,K*q-l*e,0,y*q-l*m,K*q+l*e,d*q*q+J,0,0,0,0,1),this},multiply:function(M){return this.multiplyMatrices(this,M)},premultiply:function(B){return this.multiplyMatrices(B,this)},multiplyMatrices:function(j,L){var F=j.el,g=L.el,l=this.el,s=F[0],N=F[4],M=F[8],H=F[12],R=F[1],x=F[5],i=F[9],T=F[13],b=F[2],K=F[6],I=F[10],D=F[14],e=F[3],w=F[7],Z=F[11],U=F[15],W=g[0],G=g[4],Y=g[8],o=g[12],J=g[1],B=g[5],$=g[9],P=g[13],y=g[2],h=g[6],f=g[10],A=g[14],m=g[3],t=g[7],O=g[11],n=g[15];return l[0]=s*W+N*J+M*y+H*m,l[4]=s*G+N*B+M*h+H*t,l[8]=s*Y+N*$+M*f+H*O,l[12]=s*o+N*P+M*A+H*n,l[1]=R*W+x*J+i*y+T*m,l[5]=R*G+x*B+i*h+T*t,l[9]=R*Y+x*$+i*f+T*O,l[13]=R*o+x*P+i*A+T*n,l[2]=b*W+K*J+I*y+D*m,l[6]=b*G+K*B+I*h+D*t,l[10]=b*Y+K*$+I*f+D*O,l[14]=b*o+K*P+I*A+D*n,l[3]=e*W+w*J+Z*y+U*m,l[7]=e*G+w*B+Z*h+U*t,l[11]=e*Y+w*$+Z*f+U*O,l[15]=e*o+w*P+Z*A+U*n,this},lookAt:function(){var t=new ur,d=new ur,V=new ur;return function(r,Q,g){var i=this.el;return V.subVectors(r,Q),0===V.lengthSq()&&(V.z=1),V.normalize(),t.crossVectors(g,V),0===t.lengthSq()&&(1===Math.abs(g.z)?V.x+=1e-4:V.z+=1e-4,V.normalize(),t.crossVectors(g,V)),t.normalize(),d.crossVectors(V,t),i[0]=t.x,i[4]=d.x,i[8]=V.x,i[1]=t.y,i[5]=d.y,i[9]=V.y,i[2]=t.z,i[6]=d.z,i[10]=V.z,this}}(),extractScale:function(){var F;return function($){F===m&&(F=new ur),$===m&&($=new ur);var y=F.setFromMatrixColumn(this,0).length(),N=F.setFromMatrixColumn(this,1).length(),b=F.setFromMatrixColumn(this,2).length();return $.set(y,N,b),$}}(),extractRotation:function(){var J;return function(h){J===m&&(J=new ur),h===m&&(h=new Jb);var K=this.el,k=h.el,E=1/J.setFromMatrixColumn(h,0).length(),N=1/J.setFromMatrixColumn(h,1).length(),s=1/J.setFromMatrixColumn(h,2).length();return K[0]=k[0]*E,K[1]=k[1]*E,K[2]=k[2]*E,K[4]=k[4]*N,K[5]=k[5]*N,K[6]=k[6]*N,K[8]=k[8]*s,K[9]=k[9]*s,K[10]=k[10]*s,this}}(),multiplyScalar:function(P){var Q=this.el;return Q[0]*=P,Q[4]*=P,Q[8]*=P,Q[12]*=P,Q[1]*=P,Q[5]*=P,Q[9]*=P,Q[13]*=P,Q[2]*=P,Q[6]*=P,Q[10]*=P,Q[14]*=P,Q[3]*=P,Q[7]*=P,Q[11]*=P,Q[15]*=P,this},getPosition:function(Q){return Q===m&&(Q=new ur),Q.setFromMatrixColumn(this,3)},setPosition:function(O){var G=this.el;return G[12]=O.x,G[13]=O.y,G[14]=O.z,this},toArray:function(y,K){y===m&&(y=[]),K===m&&(K=0);var L=this.el;return y[K]=L[0],y[K+1]=L[1],y[K+2]=L[2],y[K+3]=L[3],y[K+4]=L[4],y[K+5]=L[5],y[K+6]=L[6],y[K+7]=L[7],y[K+8]=L[8],y[K+9]=L[9],y[K+10]=L[10],y[K+11]=L[11],y[K+12]=L[12],y[K+13]=L[13],y[K+14]=L[14],y[K+15]=L[15],y},determinant:function(){var o=this.el,K=o[0],F=o[4],L=o[8],M=o[12],h=o[1],w=o[5],G=o[9],Y=o[13],N=o[2],v=o[6],r=o[10],b=o[14],Z=o[3],n=o[7],j=o[11],x=o[15];return Z*(+M*G*v-L*Y*v-M*w*r+F*Y*r+L*w*b-F*G*b)+n*(+K*G*b-K*Y*r+M*h*r-L*h*b+L*Y*N-M*G*N)+j*(+K*Y*v-K*w*b-M*h*v+F*h*b+M*w*N-F*Y*N)+x*(-L*w*N-K*G*v+K*w*r+L*h*v-F*h*r+F*G*N)},copy:function(w){var j=this.el,I=w.el;return j[0]=I[0],j[1]=I[1],j[2]=I[2],j[3]=I[3],j[4]=I[4],j[5]=I[5],j[6]=I[6],j[7]=I[7],j[8]=I[8],j[9]=I[9],j[10]=I[10],j[11]=I[11],j[12]=I[12],j[13]=I[13],j[14]=I[14],j[15]=I[15],this},compose:function(_,d,j){var c=this.el,g=d._x,I=d._y,F=d._z,Y=d._w,t=g+g,N=I+I,U=F+F,G=g*t,K=g*N,W=g*U,s=I*N,f=I*U,h=F*U,x=Y*t,C=Y*N,P=Y*U,b=j.x,T=j.y,v=j.z;return c[0]=(1-(s+h))*b,c[1]=(K+P)*b,c[2]=(W-C)*b,c[3]=0,c[4]=(K-P)*T,c[5]=(1-(G+h))*T,c[6]=(f+x)*T,c[7]=0,c[8]=(W+C)*v,c[9]=(f-x)*v,c[10]=(1-(G+s))*v,c[11]=0,c[12]=_.x,c[13]=_.y,c[14]=_.z,c[15]=1,this},decompose:function(){var j=new ur,h=new Jb;return function(S,Y,M){var K=this.el,V=j.set(K[0],K[1],K[2]).length(),X=j.set(K[4],K[5],K[6]).length(),B=j.set(K[8],K[9],K[10]).length(),k=this.determinant();0>k&&(V=-V),S.x=K[12],S.y=K[13],S.z=K[14],h.copy(this);var w=1/V,f=1/X,u=1/B;return h.el[0]*=w,h.el[1]*=w,h.el[2]*=w,h.el[4]*=f,h.el[5]*=f,h.el[6]*=f,h.el[8]*=u,h.el[9]*=u,h.el[10]*=u,Y.setFromRotationMatrix(h),M.x=V,M.y=X,M.z=B,this}}()});var Jq=f.Math.Triangle=function(o,w,R){this.a=o!==m?o:new ur,this.b=w!==m?w:new ur,this.c=R!==m?R:new ur};I.assign(Jq,{barycoordFromPoint:function(){var p=new ur,o=new ur,j=new ur;return function(A,$,C,i,s){p.subVectors(i,$),o.subVectors(C,$),j.subVectors(A,$);var h=p.dot(p),d=p.dot(o),U=p.dot(j),X=o.dot(o),V=o.dot(j),R=h*X-d*d,W=s||new ur;if(0===R)return W.set(-2,-1,-1);var G=1/R,r=(X*U-d*V)*G,a=(h*V-d*U)*G;return W.set(1-r-a,a,r)}}()});var xn=f.Math.Euler=function(J,T,n,s,F){this.set(J,T,n,s,F)};xn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],xn.DefaultOrder="XYZ",xn.ReverseOrder=function(N){return N=N[2]+N[1]+N[0],N.toUpperCase()},I.defineProperties(xn.prototype,{x:{get:function(){return this._x},set:function($){this._x=$,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(Z){this._y=Z,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(C){this._z=C,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(j){this._order=j,this.onChangeCallback()}}}),I.assign(xn.prototype,{set:function(j,f,B,t,J){return Nq(j)&&(J=B,t=f,B=j[2],f=j[1],j=j[0]),t?J&&(t=xn.ReverseOrder(t)):t="ZYX",this._x=j||0,this._y=f||0,this._z=B||0,this._order=t||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(u){return this._x=u._x,this._y=u._y,this._z=u._z,this._order=u._order,this.onChangeCallback(),this},setFromRotationMatrix:function(v,h,s){var k=f.Math.clamp,d=v.el||v,P=d[0],b=d[4],C=d[8],I=d[1],Y=d[5],E=d[9],y=d[2],z=d[6],Z=d[10];return h=h||this._order,"XYZ"===h?(this._y=Math.asin(k(C,-1,1)),Math.abs(C)<.99999?(this._x=Math.atan2(-E,Z),this._z=Math.atan2(-b,P)):(this._x=Math.atan2(z,Y),this._z=0)):"YXZ"===h?(this._x=Math.asin(-k(E,-1,1)),Math.abs(E)<.99999?(this._y=Math.atan2(C,Z),this._z=Math.atan2(I,Y)):(this._y=Math.atan2(-y,P),this._z=0)):"ZXY"===h?(this._x=Math.asin(k(z,-1,1)),Math.abs(z)<.99999?(this._y=Math.atan2(-y,Z),this._z=Math.atan2(-b,Y)):(this._y=0,this._z=Math.atan2(I,P))):"ZYX"===h?(this._y=Math.asin(-k(y,-1,1)),Math.abs(y)<.99999?(this._x=Math.atan2(z,Z),this._z=Math.atan2(I,P)):(this._x=0,this._z=Math.atan2(-b,Y))):"YZX"===h?(this._z=Math.asin(k(I,-1,1)),Math.abs(I)<.99999?(this._x=Math.atan2(-E,Y),this._y=Math.atan2(-y,P)):(this._x=0,this._y=Math.atan2(C,Z))):"XZY"===h?(this._z=Math.asin(-k(b,-1,1)),Math.abs(b)<.99999?(this._x=Math.atan2(z,Y),this._y=Math.atan2(C,P)):(this._x=Math.atan2(-E,Z),this._y=0)):console.warn("unsupported order: "+h),this._order=h,s!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var i=new Jb;return function(S,n,j){return i.makeRotationFromQuaternion(S),this.setFromRotationMatrix(i,n,j)}}(),setFromVector3:function(A,R){return this.set(A.x,A.y,A.z,R||this._order)},reorder:function(){var y=new eg;return function(p){return y.setFromEuler(this),this.setFromQuaternion(y,p)}}(),equals:function(D){return D._x===this._x&&D._y===this._y&&D._z===this._z&&D._order===this._order},fromArray:function(Y){return this._x=Y[0],this._y=Y[1],this._z=Y[2],Y[3]!==m&&(this._order=Y[3]),this.onChangeCallback(),this},toArray:function(Z,c){return Z===m&&(Z=[]),c===m&&(c=0),Z[c]=this._x,Z[c+1]=this._y,Z[c+2]=this._z,Z[c+3]=this._order,Z},toVector3:function(i){return i?i.set(this._x,this._y,this._z):new ur(this._x,this._y,this._z)},onChange:function(p){return this.onChangeCallback=p,this},onChangeCallback:function(){}});var lm={ms_ac:function(P,y){for(var d=y.ms_ac,l=0;l<d.length;l++)jm(P,d[l])},ms_listener:function(n){n.addListeners=function(){for(var W=this,x=0;x<Ki.length;x++)W["handle_"+Ki[x]]&&Hg(Ki[x],W.getView(),W)},n.removeListeners=function(){for(var e=this,f=0;f<Ki.length;f++)e["handle_"+Ki[f]]&&Yc(Ki[f],e.getView(),e)}},ms_fire:function(L){L.mp=function(D,P,T){this.addPropertyChangeListener(D,P,T)},L.ump=function(c,g){this.removePropertyChangeListener(c,g)},L.fp=function(f,x,T,A,C){return this.firePropertyChange(f,x,T,A,C)},L.addPropertyChangeListener=function(G,m,q){var h=this;h._62I||(h._62I=new sd),h._62I.add(G,m,q)},L.removePropertyChangeListener=function(t,$){this._62I&&this._62I.remove(t,$)},L.firePropertyChange=function(k,M,b,F,C){if(F){if(F(M,b))return!1}else if(M===b)return!1;var t=this,c=C||{};return c.property=k,c.oldValue=M,c.newValue=b,c.source=t,c.data=t,t._62I&&t._62I.fire(c),t.onPropertyChanged&&t.onPropertyChanged(c),!0}},ms_attr:function(I){I.a=function(W,j){var b=this;if(2===arguments.length)b.setAttr(W,j);else{if(!Bq(W))return b.getAttr(W);for(var c in W)b.setAttr(c,W[c])}return b},I.getAttr=function(P,S){if(S===m&&(S=1),this._attrObject&&P in this._attrObject)return this._attrObject[P];if(this.getImage){var T=this.getImage();if(xr(T)&&(T=_q[T]),Bq(T)&&"dataBindings"in T)for(var l=T.dataBindings,O=l.length-1;O>=0;O--){var o=l[O];if(o.attr===P){if("defaultValue"in o)return o.defaultValue;break}}}return S?C[P]:m},I.setAttr=function(A,X){var z=this;z._attrObject||(z._attrObject={});var j=z._attrObject[A];X===m?delete z._attrObject[A]:z._attrObject[A]=X,z.fp&&z.fp("a:"+A,j,X)&&z.onAttrChanged&&z.onAttrChanged(A,j,X)},I.getSerializableAttrs=function(){var l,h={};for(l in this._attrObject)h[l]=1;return h}},ms_bnb:function(l){l.getBodyColor=function(b){return b.s("body.color")},l.getBorderColor=function(I){return I.s("border.color")}},_51o:function(r){r.mi=function(v,U,j){this.addInteractorListener(v,U,j)},r.umi=function(s,K){this.removeInteractorListener(s,K)},r.fi=function(X){this.fireInteractorEvent(X)},r.addInteractorListener=function(v,Z,J){var A=this;A._63I||(A._63I=new sd),A._63I.add(v,Z,J)},r.removeInteractorListener=function(L,W){this._63I&&this._63I.remove(L,W)},r.fireInteractorEvent=function(I){this._63I&&this._63I.fire(I)},r.setInteractors=function(s){var e=this,q=e._interactors;q&&q.each(function(V){V.tearDown()}),Nq(s)&&(s=new Dj(s)),e._interactors=s,s&&s.each(function(s){s.setUp()}),e.fp("interactors",q,s),e.invalidateSelection()},r.getInteractors=function(){return this._interactors}},_49o:function(I){I._44O=A,I._45O=A,I.getTopPainters=function(){return this._44O},I.getBottomPainters=function(){return this._45O},I.addTopPainter=function(K){var Y=this;Y._44O||(Y._44O=new Dj),Y._44O.contains(K)||(Y._44O.add(K),Y.redraw&&Y.redraw())},I.removeTopPainter=function(e){var B=this;B._44O&&(B._44O.remove(e),B.redraw&&B.redraw())},I.addBottomPainter=function(k){var o=this;o._45O||(o._45O=new Dj),o._45O.contains(k)||(o._45O.add(k),o.redraw&&o.redraw())},I.removeBottomPainter=function(D){var V=this;V._45O&&(V._45O.remove(D),V.redraw&&V.redraw())},I._93db=function(C,e){var u=this;u._45O&&u._45O.each(function(A){A.draw?A.draw(C,e):A.call(u,C,e)})},I._92db=function(X,G){var m=this;m._44O&&m._44O.each(function(_){_.draw?_.draw(X,G):_.call(m,X,G)})}},ms_sm:function(q){q.sm=function(){return this.getSelectionModel()},q.setSelectableFunc=function(j){this.sm().setFilterFunc(j)},q.getSelectableFunc=function(){return this.sm().getFilterFunc()},q.getSelectionModel=function(){var B=this;return B._selectionModel?B._selectionModel:B.dm().sm()},q.isSelectionModelShared=function(){return!this._selectionModel},q.setSelectionModelShared=function(l){var v=this,S=!v._selectionModel,$=v.handleSelectionChange,I=v.dm();S!==l&&(v.invalidateSelection&&v.invalidateSelection(),l?(I.sm().ms($,v),v._selectionModel.ums($,v),v._selectionModel.dispose(),v._selectionModel=A):(I.sm().ums($,v),v._selectionModel=new Bi(I),v._selectionModel.ms($,v)),v.onSelectionModelSharedChanged(),v.fp("selectionModelShared",S,l))},q.onSelectionModelSharedChanged=function(){var e=this;e.redraw(),e.invalidateSelection&&e.invalidateSelection()},q.removeSelection=function(){var n=this.dm();n.beginTransaction(),this.sm().toSelection().each(n.remove,n),n.endTransaction()},q.selectAll=function(){var F=this;F.sm().ss(F.dm().toDatas(function(r){return F.isVisible(r)&&F.isSelectable(r)}))},q.isSelected=function(E){return this.sm().co(E)},q.isSelectedById=function(p){var j=this.dm().getDataById(p);return j?this.isSelected(j):!1},q.isSelectable=function(t){return this.sm().isSelectable(t)}},ms_tx:function(c){c._64I=0,c._65O=0,c.isScrollable=function(){return this.getWidth()<this._64I},c._40o=function(){return this.isScrollable()},c.getLogicalPoint=function(U){return wg(U,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},c.tx=function($){return $===m?this.getTranslateX():(this.setTranslateX($),void 0)},c.getTranslateX=function(){return this._65O},c.setTranslateX=function(h){var S=this,t=S.getWidth()-S._64I;t>h&&(h=t),h>0&&(h=0),h=T(h);var m=S._65O;S._65O=h,S.fp(yj,m,h)}},ms_ty:function(Y){Y._23Q=0,Y._66O=0,Y._41o=function(){return this.getHeight()<this._23Q},Y.getLogicalPoint=function(o){return wg(o,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Y.ty=function(i){return i===m?this.getTranslateY():(this.setTranslateY(i),void 0)},Y.getTranslateY=function(){return this._66O},Y.setTranslateY=function(u){var K=this,i=K.getHeight()-K._23Q;i>u&&(u=i),u>0&&(u=0),u=T(u);var c=K._66O;K._66O=u,K.fp(Mk,c,u)}},ms_txy:function(J){J._65O=0,J._66O=0,J.tx=function(P){return P===m?this.getTranslateX():(this.setTranslateX(P),void 0)},J.ty=function(V){return V===m?this.getTranslateY():(this.setTranslateY(V),void 0)},J.onTranslateEnded=function(){},J.setTranslate=function(V,U,W){var e=this;if(W=cl(W)){e._65I&&e._65I.stop(!0);var q=e.tx(),u=e.ty();W.action=function(E){e.setTranslate(q+(V-q)*E,u+(U-u)*E)},W._37o=function(){delete e._66I,delete e._65I,e.onTranslateEnded()},e._66I=1,e._65I=mq(W)}else e.tx(V),e.ty(U)},J.getTranslateX=function(){return this._65O},J.setTranslateX=function(r){var Q=this;r=Q.adjustTranslateX(r);var H=Q._65O;Q._65O=r,Q.fp(yj,H,r)},J.getTranslateY=function(){return this._66O},J.setTranslateY=function(R){var L=this;
R=L.adjustTranslateY(R);var C=L._66O;L._66O=R,L.fp(Mk,C,R)},J.adjustTranslateX=function(V){return T(V)},J.adjustTranslateY=function(J){return T(J)},J.translate=function(b,a,A){this.setTranslate(this.tx()+b,this.ty()+a,A)},J.getLogicalPoint=function(V){var h=this;return wg(V,this._canvas||h._view,h.tx(),h.ty())}},ms_dm:function(G){G.dm=function(c){return c?(this.setDataModel(c),void 0):this.getDataModel()},G.getDataModel=function(){return this._dataModel}},ms_lp:function(f){f.lp=function(X){return this.getLogicalPoint(X)}},ms_v:function(P){P._disabled=!1,P.setDisabled=function(x,b){var l=this,H=l._disabled;H!==x&&(H&&(ws(l._63O),delete l._63O),x&&(gr(l._view,l._63O=Bs(b)),l.iv()),l._disabled=x,l.fp("disabled",H,x))},P.isDisabled=function(){return this._disabled},P.getDisabledDiv=function(){return this._63O},P.getView=function(){return this._view},P.addToDOM=function(R){var M=this,C=M.getView(),K=C.style;R=R||J.body,R.appendChild(C),K.left="0",K.right="0",K.top="0",K.bottom="0",x(q,"resize",function(){M.iv()}),M.iv()},P.getWidth=function(){return this._view.clientWidth},P.getHeight=function(){return this._view.clientHeight},P.setWidth=function(L){var E=this;E._view.style.width=L+Ug,E.iv(),E.fp&&E.fp(Dr,A,L)},P.setHeight=function(l){var f=this;f._view.style.height=l+Ug,f.iv(),f.fp&&f.fp(On,A,l)},P.setFocus=function(N){var f=this,r=f._currentEditor;return N&&r&&(r.getView&&(r=r.getView()),r.contains(N.target))?!1:(Bh(f._view),f.endEditing&&f.endEditing(),f.fireViewEvent("focus"),!0)},P.iv=function(o){this.invalidate(o)},P.invalidate=function(W){var n=this;n._68I||(n._68I=1,Bm(n.validate,n,A,W),n.onInvalidated&&n.onInvalidated(),n.fireViewEvent("invalidate"))},P.validate=function(){var a=this,D=a._view;if(a._68I&&(delete a._68I,D.parentNode))if(0===D.offsetWidth&&0===D.offsetHeight&&a._67I!==A)a._67I===m&&(a._67I=O.reinvalidateCount),a._67I>0?a._67I--:a._67I=A,a.iv();else{a.fireViewEvent("beginValidate"),a.validateImpl(),a.onValidated&&a.onValidated(),a.fireViewEvent("validate");var Y=a._63O;Y&&(D.lastChild!==Y&&(ws(Y),gr(D,Y)),tj(Y,0,0,a.getWidth(),a.getHeight())),Jc(a),vi(a),Ui(a)}},P.layout=function(T,$,P,C){1===arguments.length?tj(this,T):tj(this,T,$,P,C)},P.addViewListener=function(o,R,Z){var D=this;D._67O||(D._67O=new sd),D._67O.add(o,R,Z)},P.removeViewListener=function(J,V){this._67O.remove(J,V)},P.fireViewEvent=function(d){var V=this;V._67O&&(xr(d)&&(d={kind:d}),V._67O.fire(d)),O.viewListener&&O.viewListener(V,d)}},ms_tip:function(r){r.setToolTipEnabled=function(B){var $=this;B?hj||$._13o||($.enableToolTip(),$.fp("toolTipEnabled",!1,!0)):$._13o&&($.disableToolTip(),$.fp("toolTipEnabled",!0,!1))},r.isToolTipEnabled=function(){return!!this._13o},r.enableToolTip=function(){var W=this;if(!hj&&!W._13o){W._13o=function(F){var x=W.getToolTip(F);x!=A?O.toolTipContinual&&O.isToolTipShowing()?Mr(F,x):(ts(),Fp={timeout:l(Hm,oj),e:F,info:x}):ts()};var j=W.getView();x(j,Kj,W._13o),x(j,"mouseleave",O.hideToolTip)}},r.disableToolTip=function(){var L=this;if(L._13o){var w=L.getView();h(w,Kj,L._13o),h(w,"mouseleave",O.hideToolTip),delete L._13o}},r.getToolTip=function(Y){var W=this;if(W.getDataAt){var I=W.getDataAt(Y);return I?I.getToolTip():A}return W.getValue?W.getValue():void 0}},_52o:function(B){B._zoom=1,B._29I=xj,B.zoomIn=function(R,$){this.setZoom(this._zoom*Lk,R,$)},B.zoomOut=function(x,l){this.setZoom(this._zoom/Lk,x,l)},B.zoomReset=function($,O){this.setZoom(1,$,O)},B.scrollZoomIn=function(U){this.setZoom(this._zoom*Um,A,U)},B.scrollZoomOut=function(d){this.setZoom(this._zoom/Um,A,d)},B.pinchZoomIn=function($){this.setZoom(this._zoom*gn,A,$)},B.pinchZoomOut=function(i){this.setZoom(this._zoom/gn,A,i)},B.adjustZoom=function(I){return re>I?re:I>ag?ag:I},B.getZoom=function(){return this._zoom},B.setZoom=function(Z,q,u){var d=this;if(q=cl(q)){d._14o&&d._14o.stop(!0);var v=d._zoom;q.action=function(_){d._96O(v+(Z-v)*_,u)},q._37o=function(){delete d._zooming,delete d._14o,d.onZoomEnded()},d._zooming=1,d._14o=mq(q)}else d._96O(Z,u)},B._96O=function(I,S){var N=this;if(I=N.adjustZoom(I),I!==N._zoom){N.validate();var y=N._29I,Y=N._zoom;0!==y.width&&0!==y.height&&(S=S?S:{x:y.x+y.width/2,y:y.y+y.height/2},N.tx((S.x-y.x)*Y-S.x*I),N.ty((S.y-y.y)*Y-S.y*I)),N._zoom=I,N.fp("zoom",Y,I)}}},ms_edge:function(u){u._2I=function(a){var L=this;L._44I||(L._44I=new Dj),L._42I||(L._42I=new Dj),L._44I.add(a),L._42I.add(a),L._20I()},u._4I=function(t){var B=this;B._44I||(B._44I=new Dj),B._43I||(B._43I=new Dj),B._44I.add(t),B._43I.add(t),B._20I()},u._16I=function(v){var m=this;m._44I.remove(v),m._42I.remove(v),m._44I.isEmpty()&&delete m._44I,m._42I.isEmpty()&&delete m._42I,m._20I()},u._18I=function(Q){var d=this;d._44I.remove(Q),d._43I.remove(Q),d._44I.isEmpty()&&delete d._44I,d._43I.isEmpty()&&delete d._43I,d._20I()},u._20I=function(){var b=this;if(delete b._45I,!b._44I||b._44I.isEmpty())return delete b._70O,void 0;var A;b._44I.each(function(a){a.isLooped()&&(A||(A={}),A[a._id]||(b._45I||(b._45I=new Dj),b._45I.add(a),A[a._id]=a))}),A?(b._70O=new Dj,b._44I.each(function(W){A[W._id]?"A"===A[W._id]||(A[W._id]="A",b._70O.add(W)):b._70O.add(W)})):b._70O=b._44I},u.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},u.getSourceAgentEdges=function(){return this._46I},u.getTargetAgentEdges=function(){return this._47I},u._1I=function(T){var U=this;U._46I||(U._46I=new Dj),U._48I||(U._48I=new Dj),U._46I.add(T),U._48I.add(T),U._19I()},u._3I=function(n){var B=this;B._47I||(B._47I=new Dj),B._48I||(B._48I=new Dj),B._47I.add(n),B._48I.add(n),B._19I()},u._15I=function($){var B=this;B._46I.remove($),B._48I.remove($),B._46I.isEmpty()&&delete B._46I,B._48I.isEmpty()&&delete B._48I,B._19I()},u._17I=function(v){var D=this;D._47I.remove(v),D._48I.remove(v),D._47I.isEmpty()&&delete D._47I,D._48I.isEmpty()&&delete D._48I,D._19I()},u._19I=function(){var f=this;delete f._49I;var S=f._48I;if(S&&!S.isEmpty()){var x={};S.each(function(E){x[E._id]?f._49I||(f._49I=new Dj):x[E._id]=E}),f._49I?S.each(function(r){x[r._id]&&(f._49I.add(r),delete x[r._id])}):f._49I=S}},u.getLoopedEdges=function(){return this._45I},u.getEdges=function(){return this._70O},u.getAgentEdges=function(){return this._49I},u.getSourceEdges=function(){return this._42I},u.getTargetEdges=function(){return this._43I},u._8I=function(){this._70O&&this._70O.each(function($){$._7I()})}}};kk(O,{numberDigits:5,crossOrigin:"",baseZIndex:m,isTouchable:hj,devicePixelRatio:q.devicePixelRatio?q.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:B.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return ig},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:hj?20:1,animDuration:200,animEasing:function(E){return E*E},labelColor:Tg,labelSelectColor:Qn,labelFont:(hj?"15":"12")+"px arial, sans-serif",widgetIndent:hj?30:20,widgetRowHeight:hj?30:20,widgetHeaderHeight:hj?32:22,widgetTitleHeight:hj?34:24,scrollBarColor:es,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:hj?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Dc,intersectionLineLine:Qo,isEnter:Yq,isEsc:hb,isDelete:_l,isSpace:Yk,isLeft:Hb,isUp:qm,isRight:pi,isDown:Or,getTarget:nc,isString:xr,isNumber:Fb,isBoolean:hn,isArray:Nq,isSelectAll:cg,isFunction:ne,isObject:Bq,getPropertyValue:tg,setPropertyValue:Yj,addMethod:kk,getVersion:function(){return"7.0.2-dev3"},createGradient:function(z,f,o,g,W,j,w,n){var I=Ol[f];return I(z,o,g,W,j,w,n)},appendToScreen:function(k){k=k.getView?k.getView():k,(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement||J.body).appendChild(k)},encodeString:function(b){return f.Math.encodeBase64(b,O.encodeStringKey)},decodeString:function(M){return f.Math.decodeBase64(M,O.encodeStringKey)},findView:function(n){var p=function(F,j){var D=j._ht;D&&F.push(D);var t=j.children,W=t.length;if(W)for(var $=0;W>$;$++)p(F,t[$])},$=[];p($,J.body);var Y=function(u,x){for(var f="2d"===x?$c.GraphView:rp.Graph3dView,q=0,F=u.length;F>q;q++)if(u[q]instanceof f)return $[q];return null};return"all"===n?$:"2d"===n?Y($,"2d"):"3d"===n?Y($,"3d"):Y($,"3d")||Y($,"2d")},toggleFullscreen:function(n){var X=n.getView();if(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement)J.exitFullscreen?J.exitFullscreen():J.msExitFullscreen?J.msExitFullscreen():J.mozCancelFullScreen?J.mozCancelFullScreen():J.webkitExitFullscreen&&J.webkitExitFullscreen();else{var h=!0;if(n.isSelfViewEvent){var $=n.getX(),q=n.getY(),a=n.getWidth(),x=n.getHeight(),o=X.style.background,p=X.style.backgroundColor;o||p||(X.style.backgroundColor="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var t=setInterval(function(){if(X!==(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement))clearInterval(t),n.setX($),n.setY(q),n.setWidth(a),n.setHeight(x),n._fullscreen=!1,X.style.oldBackgroundColor=p,n.iv();else{var O=f.Default.getWindowInfo();(h||O.width!==n.getWidth()||O.height!==n.getHeight())&&(n.setX(O.left),n.setY(O.top),n.setWidth(O.width),n.setHeight(O.height),n._fullscreen=!0,n.iv(),h=!1)}},500)}else{var y=X.style.left,E=X.style.top,a=X.style.width,x=X.style.height,o=X.style.background,p=X.style.backgroundColor;o||p||(X.style.backgroundColor="white"),X.requestFullscreen?X.requestFullscreen():X.msRequestFullscreen?X.msRequestFullscreen():X.mozRequestFullScreen?X.mozRequestFullScreen():X.webkitRequestFullscreen&&X.webkitRequestFullscreen();var t=setInterval(function(){if(X!==(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement))clearInterval(t),X.style.left=y,X.style.top=E,X.style.width=a,X.style.height=x,X.style.oldBackgroundColor=p,n.iv();else{var Y=f.Default.getWindowInfo();(h||Y.width!==n.getWidth()||Y.height!==n.getHeight())&&(tj(n),h=!1)}},500)}}},appendTimeStamp:function(P){return P},setCompType:function(V,Z){ne(Z)||Bq(Z)?te[V]=Z:ue(V)},getCompType:function(e){var H=te[e];return H===m&&me.test(e)&&ue(e),H},getCompTypeMap:function(){return te},drawCompType:function(I,v,m,C,q,c){I(v,m,C,q,c)},numberListener:function(){var w={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(m){var L=m.keyCode;w[L]||65===L&&O.isCtrlDown(m)||86===L&&O.isCtrlDown(m)||67===L&&O.isCtrlDown(m)||88===L&&O.isCtrlDown(m)||L>=35&&40>=L||(m.shiftKey||48>L||L>57)&&(96>L||L>105)&&m.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(A){var y=A.target.tagName;("DIV"===y||"CANVAS"===y)&&!(O.ignoreKeyCodes.indexOf(A.keyCode)>=0)&&("keydown"!==A.type||Hb(A)||pi(A)||qm(A)||Or(A)||_l(A)||65===A.keyCode&&(A.metaKey||A.ctrlKey))&&(A.preventDefault(),A.preventManipulation&&A.preventManipulation())},getWindowInfo:function(){var F=J.documentElement,V=F&&(F.scrollLeft||F.scrollTop)?F:J.body;return{target:V,left:V.scrollLeft,top:V.scrollTop,width:q.innerWidth||V.clientWidth,height:q.innerHeight||V.clientHeight}},isDragging:function(){return!!ig},isLeftButton:function(g){return hj?!0:0===g.button},isMiddleButton:function(e){return hj?!1:e&&(1===e.button||4&(e.buttons||0))},isInput:function(y){if(!y)return!1;var p=y.tagName;return"INPUT"===p||"TEXTAREA"===p||"SELECT"===p},getTouchCount:function(l){return hj?l.touches.length:1},isDoubleClick:function(){function C(I){I.details=0,I.timeout=null,I.lastPoint=null}var S={};return em=new j,Yl=em.getTime(),function(Q){if(Q.touches&&Q.touches.length>1)return!1;var b=Q.button==A?"":Q.button,i=Q.type+b,r=i+"_isDoubleClick",L=S[i];if(L||(L=S[i]={details:0,timeout:null,lastPoint:null}),Q[r]===m){Q[r]=!0;var d=Pb(Q);L.timeout&&(z(L.timeout),L.timeout=null),L.lastPoint&&Ng(L.lastPoint,d)>O.doubleClickRange&&C(L),L.lastPoint=d,L.details++,L.timeout=l(function(){C(this)}.bind(L),500)}return 2===L.details}}(),isShiftDown:function(u){return u?u.shiftKey:ko["16"]},isCtrlDown:function(x){return x?rs?x.metaKey:x.ctrlKey:rs?ko["91"]:ko["17"]},getClientPoint:function(l){return hj&&(l=Oc(l)),{x:l.clientX,y:l.clientY}},isMouseEvent:function(Z){return Z instanceof MouseEvent||0===Z.type.indexOf("mouse")},getTargetElement:function(U){if(O.isMouseEvent(U)||!J.elementFromPoint)return U.target;var r=Cc(U);return J.elementFromPoint(r.x,r.y)},getPagePoint:function(g){return hj&&(g=Oc(g)),{x:g.pageX,y:g.pageY}},createObject:function(B,Y){var O=new B;for(var U in Y){var e=Y[U];if(ne(e))O[U]=e;else if(0===U.indexOf("s:"))O.s(U.substr(2),Y[U]);else if(0===U.indexOf("a:"))O.a(U.substr(2),Y[U]);else{var v=ds(U),e=Y[U];O[v]?(O[v](e),"setToolTip"===v&&O.enableToolTip&&O.enableToolTip()):O[U]=e}}return O},setImage:function(K,Y,m,W){var b=arguments.length;4===b?Xj(K,W,Y,m):2===b?xr(Y)?Xj(K,Y):Hd(K,Y):1===b&&Xj(K,K)},getImage:function(k,C,g){var c;if(k==A)return A;if(Bq(k)?c=k:(c=_q[k],k&&c===m&&(Oj&&Oj[k]||Xj(k,k))),C&&c&&c.tagName){var r;r="override"===g?"colors_override":"override_rgb"===g?"colors_override_rgb":"override_a"===g?"colors_override_a":"colors",c[r]||(c[r]={__count__:0});var j=c[r][C];return j||(c[r].__count__>O.imageCacheThreshold&&(c[r]={__count__:0}),j=Wm(c,Ke(C),c.width,c.height,g),c[r][C]=j,c[r].__count__++),j}return c},isImageComplete:function(c,f,d){var w=qg(c);if(!w)return!1;if(w.tagName)return w.complete;for(var z,c,i,S=w.comps,n=!0,j=0,g=S.length;g>j;j++)if(z=S[j],i=z.type,"image"===z.type){c=z.name,c&&c.func&&(c=Ti(c,f));var J=Ed(c,f,d);if(!J){n=!1;break}}else if(me.test(i)&&O.getCompType(i)===m){n=!1,ue(i);break}return n},getId:function(){var Q=1;return function(){return++Q}}(),callLater:function(c,F,Z,Y){var g=function(){c.apply(F,Z)};return Y?l(g,Y):q.requestAnimationFrame(g)},clone:function(k){if(null==k||"object"!=typeof k)return k;if(k instanceof Date){var q=new Date;return q.setTime(k.getTime()),q}if(k instanceof Array){for(var q=[],m=0,h=k.length;h>m;m++)q[m]=of(k[m]);return q}if(k instanceof Dj){for(var q=new Dj,m=0,h=k.length;h>m;m++)q.set(m,of(k.get(m)));return q}if(k instanceof xo)return k;if(k instanceof I){var q={};for(var K in k)k.hasOwnProperty(K)&&(q[K]=of(k[K]));return q}return k},callWhenLoaded:function(H,n){n=n||100;var R=Kl(H,n);wb||(wb={}),wb[R]={tick:R,cb:H,delay:n}},beforeLoadURL:function(g){if(wb){var P={};for(var G in wb){var F=wb[G];z(F.tick);var R=Kl(F.cb,F.delay);P[R]={tick:R,delay:F.delay,cb:F.cb}}wb=P}return O.convertURL?O.convertURL(g):g},convertURL:function(P){return P},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return O.getImage("default_blank")},sortFunc:function(D,h){if(D===h)return 0;if(D==A&&h!=A)return 1;if(D!=A&&h==A)return-1;if(D==A&&h==A)return 0;var Q,i=typeof D,t=typeof h;return i===Bd&&t===Bd?Q=D.localeCompare(h):i===Dl&&t===Dl&&(Q=D-h),Q===m&&(Q=(""+D).localeCompare(""+h)),Q>0?1:0>Q?-1:0},getClassMap:function(){return Pq},getClass:function(P){if(xr(P)){var L,t=Pq[P];if(!t){L=P.split("."),t=q;for(var I=0;I<L.length;I++)t=t[L[I]];Pq[P]=t}return t}return P},def:function(y,w,i){var G,I,e,Q=function(){};if(Q.prototype=w.prototype,G=new Q,xr(y)){if(Pq[y])throw"'"+y+"' already defined";e=sg(y),G.getClassName=function(){return y}}else e=y;if(G.constructor=e,G.getClass=function(){return e},G.getSuperClass=function(){return w},i)for(I in i)lm[I]&&lm.hasOwnProperty(I)?lm[I](G,i):zn(G,i,I);e.prototype=G,e.superClass=w.prototype},startAnim:function(){var c=function(U){U.duration&&(U.startTime=Yr()),U.timeId=Bm(U.tick,A,A,U.interval)};return function(M){return M=of(M),M.easing=M.easing||O.animEasing,M.duration||M.frames||(M.duration=O.animDuration),M.t=0,M.duration?M.interval=0:(M.frame=0,M.interval=M.interval||10),M.tick=function(){if(M.duration){var U=(Yr()-M.startTime)/M.duration;if(U>1&&(U=1),M.t=U,M.action(M.easing(U),U),!M.isRunning())return;1===U?M.stop():M._isPaused||(M.timeId=Bm(M.tick))}else{if(M.frame++,U=M.t=M.frame/M.frames,M.action(M.easing(U),U),!M.isRunning())return;M.frame<M.frames?M._isPaused||(M.timeId=Bm(M.tick,A,A,M.interval)):M.stop()}},M.resume=function(){M._isPaused&&(delete M._isPaused,M.duration?M.t<1&&(M.startTime=Yr()-M.duration*M.t,M.timeId=Bm(M.tick)):M.frame<M.frames&&(M.timeId=Bm(M.tick,A,A,M.interval)))},M.pause=function(){kb(M.timeId,!M.duration),M._isPaused=!0},M.isPaused=function(){return this._isPaused},M.stop=function(I){M.isRunning()&&(kb(M.timeId,!M.duration),delete M.timeId,M.duration?M.t<1&&I&&(M.t=1,M.action(M.easing(1),1)):M.frame<M.frames&&I&&(M.frame=M.frames,M.action(M.easing(1),1)),M._37o&&M._37o(),M.finishFunc&&M.finishFunc())},M.isRunning=function(){return M.timeId!=A},M.delay?Bm(c,A,[M],M.delay):c(M),M}}(),getTextSize:function(){var V={},b=J?Eg().getContext("2d"):A;return function(J,k){b.font=J?J:Oh;var t=V[b.font];return t||(t=2*b.measureText("e").width+4,V[b.font]=t),{width:b.measureText(k).width+4,height:t}}}(),drawText:function(u,I,k,M,H,Z,K,q,$,x){if(I!=A){var y=wr(k,I),l={};l.y=x&&x!==mn?x===kq?Z+y.height/2:Z+q-y.height/2:Z+q/2,l.x=$&&$!==zd?$===Nl?H+K-y.width/2:H+K/2:H+y.width/2,fr(u,I,l,k,M)}},getDistance:function(u,v){var O=u.length;return v?3===O?r(F(u[0]-v[0])+F(u[1]-v[1])+F(u[2]-v[2])):2===O?r(F(u[0]-v[0])+F(u[1]-v[1])):u.z===m?r(F(v.x-u.x)+F(v.y-u.y)):r(F(v.x-u.x)+F(v.y-u.y)+F(v.z-u.z)):3===O?r(F(u[0])+F(u[1])+F(u[2])):2===O?r(F(u[0])+F(u[1])):void 0},brighter:function(U,K){return 0>K&&(K=-K),Dd(U,K?K:40)},darker:function(q,s){return s>0&&(s=-s),Dd(q,s?s:-40)},unionPoint:function(l,z){if(!l)return A;if(2===arguments.length)return l&&z?{x:Y(l.x,z.x),y:Y(l.y,z.y),width:G(l.x-z.x),height:G(l.y-z.y)}:A;var B=l;if(B._as&&(B=B._as),B.length===m)return A;var a=B.length;if(0>=a)return A;for(var P=1,y=B[0],L={x:y.x,y:y.y,width:0,height:0};a>P;P++){y=B[P];var v=Y(L.x,y.x),b=$(L.x+L.width,y.x),r=Y(L.y,y.y),i=$(L.y+L.height,y.y);L.x=v,L.y=r,L.width=b-v,L.height=i-r}return L},unionRect:function(L,E){if(L&&!E)return of(L);if(!L&&E)return of(E);if(L&&E){var h={x:Y(L.x,E.x),y:Y(L.y,E.y)};return h.width=$(L.x+L.width,E.x+E.width)-h.x,h.height=$(L.y+L.height,E.y+E.height)-h.y,h}return A},containsPoint:function($,s,o,K){if(K!=A&&1!==K){var V=$.x+$.width/2,Q=$.y+$.height/2;$={x:V-$.width/2*K,y:Q-$.height/2*K,width:$.width*K,height:$.height*K}}if(o){var c=$.width/2,d=$.height/2,G=n(-o),F=W(-o),L=s.x-$.x-c,m=s.y-$.y-d;return s={x:F*L-G*m,y:G*L+F*m},ub({x:-c,y:-d,width:$.width,height:$.height},s)}return!(!$||s.x<$.x||s.y<$.y||s.x>$.x+$.width||s.y>$.y+$.height)},containsRect:function(p,x){if(!p||!x)return!1;var s=x.x,c=x.y,f=x.width,O=x.height,I=p.width,K=p.height;if(0>(I|K|f|O))return!1;var T=p.x,v=p.y;if(T>s||v>c)return!1;if(I+=T,f+=s,s>=f){if(I>=T||f>I)return!1}else if(I>=T&&f>I)return!1;if(K+=v,O+=c,c>=O){if(K>=v||O>K)return!1}else if(K>=v&&O>K)return!1;return!0},intersectsRect:function(f,E){if(!f||!E)return!1;var o=E.width,P=E.height,Q=f.width,m=f.height;if(0>=Q||0>=m||0>=o||0>=P)return!1;var w=E.x,B=E.y,l=f.x,A=f.y;return Q+=l,m+=A,o+=w,P+=B,Q>w&&m>B&&o>l&&P>A},intersection:function(K,k){if(!K||!k)return A;var f=k.x,Y=k.y,z=K.x,G=K.y,w=f,n=Y,C=z,L=G;return w+=k.width,n+=k.height,C+=K.width,L+=K.height,z>f&&(f=z),G>Y&&(Y=G),w>C&&(w=C),n>L&&(n=L),w-=f,n-=Y,0>=w||0>=n?A:{x:f,y:Y,width:w,height:n}},grow:function(V,F,Z){Z===m&&(Z=F),V.x-=F,V.y-=Z,V.width=V.width+2*F,V.height=V.height+2*Z},getScreenPoint:function(c,H,T,y,C,f,m){var w=T.getBoundingClientRect(),p=c*(f||1)-T.scrollLeft+(y||0),G=H*(m||1)-T.scrollTop+(C||0),N=Qc(T,!1);if(N){var O=new ur(p,G,0);return O.applyMatrix4(N),console.log(O),{x:O.x,y:O.y}}return{x:p+w.left,y:G+w.top}},getLogicalPoint:function(J,i,d,q,t,$){var N,C,V=i.getBoundingClientRect();J.target?(Hr(J)?rs?ko["91"]=!0:ko["17"]=!0:rs?ko["91"]=!1:ko["17"]=!1,ko["16"]=ah(J)?!0:!1,J=hj?Oc(J):J,N=J.clientX,C=J.clientY):(N=J.x,C=J.y);var R=Qc(i,!0);if(R){var a=new ur(N,C,0);a.applyMatrix4(R);do{if(Math.abs(a.z)<=1e-6)break;var X=new ur(N,C,1);if(X.applyMatrix4(matrix),Math.abs(X.z)<=1e-6){a=X;break}if(X.sub(a),Math.abs(X.z)<=1e-6)break;a.addScaledVector(X,-a.z/X.z)}while(!1);return{x:(a.x+i.scrollLeft-(d||0))/(t||1),y:(a.y+i.scrollTop-(q||0))/($||1)}}return{x:(N-V.left+i.scrollLeft-(d||0))/(t||1),y:(C-V.top+i.scrollTop-(q||0))/($||1)}},removeHTML:function(){var w;return function(Q){return Q&&Q.getView&&(Q=Q.getView()),Q&&Q.parentNode?w===Q?!0:(w=Q,Q.parentNode.removeChild(Q),w=A,!0):!1}}(),getToolTipDiv:function(){if(!Gc){Gc=Gj(),ge=Gj();var n=Gc.style;O.baseZIndex!=A&&(n.zIndex=e(O.baseZIndex)+3+""),n.whiteSpace="nowrap",n.color=O.toolTipLabelColor,n.background=O.toolTipBackground,n.font=O.toolTipLabelFont,n.padding="5px",n.boxShadow="0px 0px 3px "+O.toolTipShadowColor}return Gc},isToolTipShowing:function(){return Gc&&Gc.parentNode?!0:ge&&ge.parentNode?!0:!1},hideToolTip:function(){ws(Gc),ws(ge),sc()},showToolTip:function(m,g){if(!m||g==A)return ts(),void 0;O.getToolTipDiv();var q,$;if(g.html?(g=g.html,q=ge,ws(Gc)):(q=Gc,ws(ge)),$=q.style,q.innerHTML=g,q.parentNode||f.Default.appendToScreen(q),m.target){m=Cc(m);var L=Nm(),R=m.x,M=m.y,r=hj?60:12;if(hj){var d=q.getBoundingClientRect();$.left=R-d.width/2+Ug,$.top=M-d.height-r<L.top?M+r+Ug:M-d.height-r+Ug}else{$.left=R+r+Ug,$.top=M+r+Ug;var d=q.getBoundingClientRect();d.left+d.width>L.width&&($.left=R-r-d.width+Ug),d.top+d.height>L.height&&($.top=M-r-d.height+Ug),d.left<0&&($.left=R+r+Ug),d.top<0&&($.top=M+r+Ug)}}else $.left=m.x+Ug,$.top=m.y+Ug;sc()},startDragging:function(z,s,l){l==m&&(l=!0),z!==ig&&(ig?l&&(hj?ig.handleWindowTouchEnd(s):ig.handleWindowMouseUp(s)):hj?(x(q,qs,Ek),x(q,od,Fc)):(x(q,Kj,Yh),x(q,hc,Kq)),ig=z)},getImageMap:function(){return _q},toBoundaries:function(K,_,l,g){var j=[];return sn(K,_,l,g).forEach(function(a){var l=[];a.forEach(function(N){l.push(N.x,N.y)}),j.push(l)}),j},getCurrentKeyCodeMap:function(){return ko},drawCenterImage:function(h,v,y,z,C,$,f,F){!C&&$&&$.isSelfViewEvent&&(C=$);var N=Wb(v,C,$),A=js(v,C,$);qo(h,v,T(y-N/2),T(z-A/2),N,A,C,$,f,F)},drawStretchImage:function(i,o,p,X,e,t,I,K,D,L,u,z){!K&&D&&D.isSelfViewEvent&&(K=D);var v,O=Wb(o,K,D,t),w=js(o,K,D,I);"uniform"===p?(v=Y(t/O,I/w),O*=v,w*=v,X+=T((t-O)/2),e+=T((I-w)/2),t=O,I=w):"centerUniform"===p&&((O>t||w>I)&&(v=Y(t/O,I/w),O*=v,w*=v),X+=T((t-O)/2),e+=T((I-w)/2),t=O,I=w);var d=i.interactiveInfo;if(d){var S;if(S="center"===p?{x:X+t/2-O/2,y:e+I/2-w/2,width:O,height:w}:{x:X,y:e,width:t,height:I},d.rect){var n=d.compInfos,r=n.length;r&&(n[r-1].rect.image=o)}else d.rect=S}if("center"===p){var A=u!==!1&&(O>t||w>I);A&&(i.save(),i.beginPath(),i.rect(X,e,t,I),i.clip()),qo(i,o,X+t/2-O/2,e+I/2-w/2,O,w,K,D,L,z),A&&i.restore()}else qo(i,o,X,e,t,I,K,D,L,z)},toCanvas:function(z,B,s,X,j,h,W,y,a){z=qg(z,W),B=B||Wb(z,j),s=s||js(z,j);var r=Eg(),H=pm(r);return y?(jd(r,B,s,y),H.scale(y,y)):jd(r,B,s,1),Cl(H,z,X,0,0,B,s,j,h,W,a),z&&z.clampToEdge&&(r.clampToEdge=z.clampToEdge),H.restore(),r},toGrayColor:function(W){if(!W)return W;var Z=en(W),C=.299*Z[0]+.587*Z[1]+.114*Z[2];return"rgba("+C+","+C+","+C+","+Z[3]/255+")"},createGradientImage:function(H,D,Y,T){for(var _=["L",0,0,H,0,1,0,0,1,0,0],Z=0,p=Math.min(D.length,Y.length);p>Z;Z++)_.push(Y[Z],D[Z]);var c=f.Default.toCanvas({width:H,height:H,clampToEdge:!0,comps:[{type:"shape",rotation:T||0,points:[0,0,H,0,H,H,0,H],background:"#ffffff",gradientPack:_}]});return c},createElement:function(X,e,u,c){var R=J.createElement(X);return Sj(R,e||B.widgetBorder,2),R.style.font=u?u:Oh,c!=A&&(R.value=c),O.onElementCreated&&O.onElementCreated(R),R},containedInView:function(X,p){var Z=Yg(p).getBoundingClientRect();return ub({x:Z.left,y:Z.top,width:Z.width,height:Z.height},Pb(X))},isIsolating:function(){return Nc>0},setIsolating:function(V){V?Nc++:Nc--},getMSMap:function(){return lm},stringify:function(v,o,U){var X=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var l=JSON.stringify(v,function(Q,_){return"function"==typeof _?"__ht__"+(_.__ht__||_.toString()):Fb(_)?qf(_):_ instanceof f.List?"__ht__list"+(_.__ht__list||O.stringify(_._as)):_},o==A?2:o);return Date.prototype.toJSON=X,U&&(l="__ht__encode"+O.encodeString(l)),l},parse:function(I){return xr(I)?"__ht__encode"!=I.substr(0,12)||(I=O.decodeString(I.substr(12)),xr(I))?JSON.parse(I,function(D,I){if(xr(I))if("__ht__function"==I.substr(0,14)){var C=I.indexOf("{")+1,H=I.lastIndexOf("}"),G=I.indexOf("(")+1,S=I.indexOf(")");if(C&&H&&G&&S){var l=new Function(I.substring(G,S),I.substring(C,H));return l.__ht__=I.substr(6),l}}else{if("__ht__date"==I.substr(0,10))return new Date(e(I.substr(10)));if("__ht__list"===I.substr(0,10))return new Dj(O.parse(I.substr(10)))}return I}):I:I},loadJS:function(W,m){m&&W.push(m);var r=W.shift();if(Nq(r))W=r.contact(W),O.loadJS(W);else if(ne(r))r(),O.loadJS(W);else if(xr(r)){var Y=J.createElement("script");Y.onload=function(){O.loadJS(W)},Y.setAttribute("src",r),J.getElementsByTagName("head")[0].appendChild(Y)}else W.length&&O.loadJS(W)},toRoundedCorner:function(O,v){var l=O.size();if(0>=v)return{points:O};var d,V=new Dj,m=new Dj,I=O.get(0);V.add(I),m.add(1);for(var i=1;l>i;i++)if(l>i+1){var D=O.get(i),f=O.get(i+1),G=I.x,L=I.y,k=D.x,h=D.y,R=h-L,_=k-G,J=b(R,_);d=Y(.99*Ng(I,D),v),V.add({x:k-d*W(J),y:h-d*n(J)}),V.add(D),G=D.x,L=D.y,k=f.x,h=f.y,R=h-L,_=k-G,J=b(R,_),d=Y(.99*Ng(D,f),v),I={x:G+d*W(J),y:L+d*n(J)},V.add(I),m.addAll([2,3])}else V.add(O.get(i)),m.add(2);return{points:V,segments:m}},toColorData:en,setCanvas:jd,createDiv:Gj,createDisabledDiv:Bs,createView:hg,createCanvas:Eg,appendChild:gr,initContext:pm,checkLoadingImage:Jc,translateAndScale:aq,layout:tj,getPosition:Ef,drawPoints:ns,drawRoundRect:pe,drawBorder:Qm,setFocus:Bh,getter:ho,setter:ds,isEmptyObject:Lc,cameraPriority:function(){var i={skybox:0,main:1e4,top:1e7};return I.seal(I.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return i.skybox},set:function(e){if(e>=i.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");i.skybox=Number(e)}},main:{configurable:!1,enumerable:!1,get:function(){return i.main},set:function(Y){if(Y<=i.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(Y>=i.top)throw new RangeError("Main camera must have lower priority than the top camera.");i.main=Number(Y)}},top:{configurable:!1,enumerable:!1,get:function(){return i.top},set:function(Y){if(Y<=i.main)throw new RangeError("Top camera must have higher priority than the main camera.");i.top=Number(Y)}}}))}()},!0),kk(N,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Ep=O.disabledOpacity,oj=O.toolTipDelay,Lf=O.devicePixelRatio,ud=O.autoMakeVisible,rq=O.autoHideScrollBar,al=O.imageGradient,Mr=O.showToolTip,ts=O.hideToolTip,ie=O.dashPattern,Ei=O.lineCap,Tr=O.lineJoin,We=O.labelColor,_j=O.labelSelectColor,Oh=O.labelFont,bm=O.widgetIndent,yq=O.widgetRowHeight,tp=O.widgetHeaderHeight,kn=O.widgetTitleHeight,dq=O.scrollBarColor,dp=O.scrollBarSize,Nf=O.scrollBarTimeout,qb=O.scrollBarMinLength,Fn=O.scrollBarInteractiveSize,Lk=O.zoomIncrement,Um=O.scrollZoomIncrement,gn=O.pinchZoomIncrement,ag=O.zoomMax,re=O.zoomMin,zo=O.createObject,Ec=O.preventDefault,fp=O.setImage,qg=O.getImage,Ed=O.isImageComplete,ao=O.drawCenterImage,Cl=O.drawStretchImage,mj=O.getId,Bm=O.callLater,Mj=O.sortFunc,of=O.clone,sg=O.getClass,mq=O.startAnim,ej=O.brighter,di=O.darker,ji=O.drawText,wr=O.getTextSize,im=O.isLeftButton,fc=O.isMiddleButton,Sc=O.getTouchCount,yk=O.isDoubleClick,ah=O.isShiftDown,Hr=O.isCtrlDown,Pb=O.getClientPoint,Cc=O.getPagePoint,Ng=O.getDistance,pj=O.unionPoint,nm=O.unionRect,ub=O.containsPoint,pp=O.containsRect,xk=O.intersectsRect,Rn=O.intersection,Nm=O.getWindowInfo,ki=O.grow,wg=O.getLogicalPoint,sh=O.getScreenPoint,Ff=O.startDragging,ws=O.removeHTML,cj=O.createElement,ql=O.segmentResolution,vp=O.shapeResolution,He=O.shapeSide,Bg=O.def,Pd=function(u,F,P){Bg(V+"."+u,F,P)},Dk=function(X,h){X.childNodes.forEach(function(T){h(T),Dk(T,h)})};kk(O,{toolTipLabelColor:We,toolTipLabelFont:Oh,toolTipBackground:B.toolTipBackground,toolTipShadowColor:es,drawBreakableText:Ql,setDevicePixelRatio:function(M){Lf=O.devicePixelRatio="number"==typeof M?M:q.devicePixelRatio,Dk(J.body,function(g){var X=g._ht;X&&X._canvas&&(jd(X._canvas,X.getWidth(),X.getHeight()),X.redraw?X.redraw():X.iv())})}},!0);var Kg=1e-6,Zr="undefined"!=typeof Uint16Array?Uint16Array:Array,cb="undefined"!=typeof Float32Array?Float32Array:Array,Dg=function(B,x,j){var U=[B[0]-x[0],B[1]-x[1],B[2]-x[2]];if(j){var n=Ng(U);n>0&&(U[0]/=n,U[1]/=n,U[2]/=n)}return U},Rf=function(){var v="charCodeAt",u=2*(2*Mb.length+1);for(var O in q)if(O===V+zd[0]+(Ug.length+2)){var Q=q[O];if(!Q)break;for(var X=Q.length,o=0;X>o;o++)if(Q[o][v](0)===u&&Q[o+1]!=A&&Q[o+1]===Ug[0]&&Q[o+2]!=A&&Q[o+2][v](0)===u){for(var m=o+3;X>m;m++)if(Q[m][v](0)===u){if(0==Q[m+1])for(var e,t=m+2;X>t;t++){if(Q[t][v](0)===u){0==Q[t-1]&&e&&(bp=e.substr(0,e.length-1));break}e==A?e=Q[t]:e+=Q[t]}break}break}break}return function(s){return[-s[0],-s[1],-s[2]]}}(),vg=function(d,B){return 3===d.length?d[0]*B[0]+d[1]*B[1]+d[2]*B[2]:d[0]*B[0]+d[1]*B[1]},co=function(){var b=new cb(16);return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},rf=co(),Hn=function(N){var F=new cb(16);return F[0]=N[0],F[1]=N[1],F[2]=N[2],F[3]=N[3],F[4]=N[4],F[5]=N[5],F[6]=N[6],F[7]=N[7],F[8]=N[8],F[9]=N[9],F[10]=N[10],F[11]=N[11],F[12]=N[12],F[13]=N[13],F[14]=N[14],F[15]=N[15],F},zk=function(g,l){return g[0]=l[0],g[1]=l[1],g[2]=l[2],g[3]=l[3],g[4]=l[4],g[5]=l[5],g[6]=l[6],g[7]=l[7],g[8]=l[8],g[9]=l[9],g[10]=l[10],g[11]=l[11],g[12]=l[12],g[13]=l[13],g[14]=l[14],g[15]=l[15],g},$h=function(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},li=function(U,$){var D=U[0],I=U[1],N=U[2];return U[0]=$[0]*D+$[4]*I+$[8]*N+$[12],U[1]=$[1]*D+$[5]*I+$[9]*N+$[13],U[2]=$[2]*D+$[6]*I+$[10]*N+$[14],U},Ho=function(z,$){var K=z[0],u=z[1],r=z[2],J=z[3];return z[0]=$[0]*K+$[4]*u+$[8]*r+$[12]*J,z[1]=$[1]*K+$[5]*u+$[9]*r+$[13]*J,z[2]=$[2]*K+$[6]*u+$[10]*r+$[14]*J,z[3]=$[3]*K+$[7]*u+$[11]*r+$[15]*J,z},to=function(){var z,J,D,o,P=us(zg[1]+zg[7]),l=us(zg[0]+zg[3]-zg[10]),M=us(zg[8]+2),B=function(){return J=D.charAt(z),z+=1,J},_=function(){var b="";if(J===M)for(;B();){if(J===M)return B(),b;b+=J}else B()},f=function(){for(;J&&" ">=J;)B()},k=function(){var m,e={};if(J===P){if(B(),f(),J===l)return B(),e;for(;J;){if(m=_(),f(),B(),e[m]=o(),f(),J===l)return B(),e;B(),f()}}};return o=function(){switch(f(),J){case P:return k();default:return _()}},function(A){if(v={},A){var T;if(D=A,z=0,J=" ",T=o(),f(),!J)return T}}}(),$b=function(L,l){if(l){var o=n(l),U=W(l),Y=L[4],d=L[5],R=L[6],y=L[7],j=L[8],B=L[9],X=L[10],$=L[11];L[4]=Y*U+j*o,L[5]=d*U+B*o,L[6]=R*U+X*o,L[7]=y*U+$*o,L[8]=j*U-Y*o,L[9]=B*U-d*o,L[10]=X*U-R*o,L[11]=$*U-y*o}},Vk=function(j,$){if($){var g=n($),q=W($),k=j[0],i=j[1],b=j[2],N=j[3],J=j[8],L=j[9],R=j[10],u=j[11];j[0]=k*q-J*g,j[1]=i*q-L*g,j[2]=b*q-R*g,j[3]=N*q-u*g,j[8]=k*g+J*q,j[9]=i*g+L*q,j[10]=b*g+R*q,j[11]=N*g+u*q}},Mi=function(s,P){if(P){var a=n(P),X=W(P),R=s[0],q=s[1],F=s[2],S=s[3],D=s[4],g=s[5],x=s[6],Z=s[7];s[0]=R*X+D*a,s[1]=q*X+g*a,s[2]=F*X+x*a,s[3]=S*X+Z*a,s[4]=D*X-R*a,s[5]=g*X-q*a,s[6]=x*X-F*a,s[7]=Z*X-S*a}},Vl=function(P,r,i){return Hp(A,i===!1?A:P.getFinalScale3d(),P.getFinalRotation3d(),P.getRotationMode(),P.p3(),A,r)},Hp=function(m,y,c,a,g,O,i){return O||(O=co()),g&&io(O,g),Ac(O,c,a),i&&Zh(O,O,i),y&&Qg(O,y),m&&Zh(O,O,m),O},Mp=function(a,d,Y){d=e(d),Y=e(Y);var G=this;G.g=a,G._84O=d,G._85O=Y,G._70I=!0,G.F=0,G._83O=d+Y,G.pen={x:0,y:0}},Td="lineDashOffset",je="setLineDash",Cr=function(w){for(var f in w)1===f.length&&(Td=w[f]);
return f?1:0},Tl=function(s,r,O){return oe(r)?s:s[je]?(s[je](r),O&&(s.lineDashOffset=O),s):new Mp(s,r[0],r.length>1?r[1]:r[0])},Kc=function(_,Y){!oe(Y)&&_[je]&&(_[je](bs),_.lineDashOffset=0)};if(Bg(Mp,I,{_69I:6,moveTo:function(Y,W){var k=this,J=k.pen;J.x=Y,J.y=W,k.g.moveTo(Y,W),k.start||(k.start={x:Y,y:W})},lineTo:function(e,B){var T=this,r=T.pen,q=e-r.x,p=B-r.y,I=b(p,q),P=W(I),O=n(I),w=T._23O(r.x,r.y,e,B),z=T._85O,V=T._84O,$=T._83O;if(T.F){if(T.F>w)return T._70I?T._72I(e,B):T.moveTo(e,B),T.F-=w,void 0;if(T._70I?T._72I(r.x+P*T.F,r.y+O*T.F):T.moveTo(r.x+P*T.F,r.y+O*T.F),w-=T.F,T.F=0,T._70I=!T._70I,!w)return}var N=d(w/$);if(N){for(var C=P*V,E=O*V,U=P*z,Q=O*z,L=0;N>L;L++)T._70I?(T._72I(r.x+C,r.y+E),T.moveTo(r.x+U,r.y+Q)):(T.moveTo(r.x+U,r.y+Q),T._72I(r.x+C,r.y+E));w-=$*N}T._70I?w>V?(T._72I(r.x+P*V,r.y+O*V),T.moveTo(e,B),T.F=z-(w-V),T._70I=!1):(T._72I(e,B),w===V?(T.F=0,T._70I=!T._70I):(T.F=V-w,T.moveTo(e,B))):w>z?(T.moveTo(r.x+P*z,r.y+O*z),T._72I(e,B),T.F=V-(w-z),T._70I=!0):(T.moveTo(e,B),w===z?(T.F=0,T._70I=!T._70I):T.F=z-w)},quadraticCurveTo:function(i,f,k,l){var x,q=this,F=q.pen,I=F.x,c=F.y,Z=q._22O(I,c,i,f,k,l),m=0,g=0,E=q._85O,P=q._84O;if(q.F){if(q.F>Z)return q._70I?q._71I(i,f,k,l):q.moveTo(k,l),q.F-=Z,void 0;if(m=q.F/Z,x=q._20O(I,c,i,f,k,l,m),q._70I?q._71I(x[2],x[3],x[4],x[5]):q.moveTo(x[4],x[5]),q.F=0,q._70I=!q._70I,!Z)return}var b=Z-Z*m,o=d(b/q._83O),R=P/Z,u=E/Z;if(o)for(var U=0;o>U;U++)q._70I?(g=m+R,x=q._21O(I,c,i,f,k,l,m,g),q._71I(x[2],x[3],x[4],x[5]),m=g,g=m+u,x=q._21O(I,c,i,f,k,l,m,g),q.moveTo(x[4],x[5])):(g=m+u,x=q._21O(I,c,i,f,k,l,m,g),q.moveTo(x[4],x[5]),m=g,g=m+R,x=q._21O(I,c,i,f,k,l,m,g),q._71I(x[2],x[3],x[4],x[5])),m=g;b=Z-Z*m,q._70I?b>P?(g=m+R,x=q._21O(I,c,i,f,k,l,m,g),q._71I(x[2],x[3],x[4],x[5]),q.moveTo(k,l),q.F=E-(b-P),q._70I=!1):(x=q._19O(I,c,i,f,k,l,m),q._71I(x[2],x[3],x[4],x[5]),Z===P?(q.F=0,q._70I=!q._70I):(q.F=P-b,q.moveTo(k,l))):b>E?(g=m+u,x=q._21O(I,c,i,f,k,l,m,g),q.moveTo(x[4],x[5]),x=q._19O(I,c,i,f,k,l,g),q._71I(x[2],x[3],x[4],x[5]),q.F=P-(b-E),q._70I=!0):(q.moveTo(k,l),b===E?(q.F=0,q._70I=!q._70I):q.F=E-b)},bezierCurveTo:function(){var l=arguments;this.pen={x:l[4],y:l[5]},this.g.bezierCurveTo(l[0],l[1],l[2],l[3],l[4],l[5])},arc:function(G,O,S,i,V,q){q||(i=-i,V=-V),fg(this,G,O,i,V-i,S,S,!1)},rect:function(s,X,o,y){var S=this;S.pen={x:s,y:X},S.moveTo(s,X),S.lineTo(s,X+y),S.lineTo(s+o,X+y),S.lineTo(s+o,X),S.lineTo(s,X)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(q,P,k,R){var N=k-q,I=R-P;return r(N*N+I*I)},_22O:function(L,Y,p,u,X,h,w){for(var G,g,c,r,i,j,q,B=0,s=L,E=Y,A=w>0?w:this._69I,o=1;A>=o;o++)c=o/A,r=1-c,i=r*r,j=2*c*r,q=c*c,G=i*L+j*p+q*X,g=i*Y+j*u+q*h,B+=this._23O(s,E,G,g),s=G,E=g;return B},_21O:function(R,E,D,u,B,G,o,b){var x=this;if(0===o)return x._20O(R,E,D,u,B,G,b);if(1===b)return x._19O(R,E,D,u,B,G,o);var Y=x._20O(R,E,D,u,B,G,b);return Y.push(o/b),x._19O.apply(x,Y)},_20O:function(X,E,H,t,P,x,z){if(1!==z){var M=H+(P-H)*z,s=t+(x-t)*z;H=X+(H-X)*z,t=E+(t-E)*z,P=H+(M-H)*z,x=t+(s-t)*z}return[X,E,H,t,P,x]},_19O:function(D,l,Z,j,E,V,n){if(1!==n){var t=D+(Z-D)*n,Q=l+(j-l)*n;Z+=(E-Z)*n,j+=(V-j)*n,D=t+(Z-t)*n,l=Q+(j-Q)*n}return[D,l,Z,j,E,V]},_72I:function(j,o){var k=this.pen;(j!==k.x||o!==k.y)&&(k.x=j,k.y=o,this.g.lineTo(j,o))},_71I:function(T,l,D,b){var m=this.pen;(T!==D||l!==b||D!==m.x||b!==m.y)&&(m.x=D,m.y=b,this.g.quadraticCurveTo(T,l,D,b))}}),S&&L){var rj=L.toString();a=rj.indexOf(Sn.substr(0,2))>0&&rj.indexOf(kq+kq.substr(1,1))>1||rj.indexOf(cs.substr(0,2)+Sn.substr(2,2)+zd[0]+Sn[4])>1?!0:!1}!0&&q.console&&(q.navigator&&q.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?q.console.log.apply(console,["Hightopo - Version"+f.Default.getVersion()+" - %chttp://hightopo.com/request.html","color: #f00;"]):q.console.log("Hightopo - Version"+f.Default.getVersion()+" - http://hightopo.com/request.html"));var Je=A,An=A,vi=function(H){Je&&!H._72O&&(An||(An={}),An[H._72O=mj()]=H)},ue=function(e,J){if(J||(J=e),J&&(Je||(Je={}),!Je[e])){var V=new ls;if(Je[J]={request:V,url:J},J=O.beforeLoadURL(J),J.data){var i=O.parse(J.data);Ir(e,i),O.handleCompTypeLoaded(e,i)}else{V.onload=function(){if(200===this.status||0===this.status){var U=O.parse(V.getResponseText());Ir(e,U),O.handleCompTypeLoaded(e,U)}else Ir(e,A)},V.onerror=function(){Ir(e,A)};var d={};d.url=encodeURI(J),d.sync=!1,V.send(d)}}},Ir=function(e,W){if(te[e]=W,delete Je[e],Lc(Je)&&(Je=A,An)){for(var N in An){var T=An[N];T.invalidateAll&&T.invalidateAll(m,"compTypeLoaded",e),T.redraw&&T.redraw(),T.iv(),delete T._72O}An=A}if(W&&An)for(var N in An){var T=An[N];T.invalidateAll&&T.invalidateAll(m,"compTypeLoading",e),T.redraw&&T.redraw(),T.iv()}},nn=B.chart,Zm="",Eq=O.compStack=[],Xk=/^style@/,he=/^attr@/,Co=/^field@/,Zd={x:.5,y:.5},Wb=function(u,H,F,x){if(!u)return 0;if(Ti(u.fitSize,H,F)&&x)return x;var y=Ti(u.width,H,F);return null==y?20:y},js=function(O,u,Q,Y){if(!O)return 0;if(Ti(O.fitSize,u,Q)&&Y)return Y;var a=Ti(O.height,u,Q);return null==a?20:a},Ti=function(G,O,R){if(!G||!G.func)return G;var M,r=G.func,y=G.value;return M=ne(r)?R&&R.vectorDataBindingDisabled&&!G.isSafeFunc?y:r(O,R):O instanceof xo||O instanceof f.ui.View?he.test(r)?O.a(Zm+r.slice(5)):Xk.test(r)?O.s(Zm+r.slice(6)):Co.test(r)?O[r.slice(6)]:O[r]?O[r](R):y:y,y!==m&&M==A?y:M},qo=O.drawImage=function(){var u,h,t,o,I,Z,v=function(I,B){I.getValue&&I.getValue.compType===B||(I.getValue=function(e){var y=x(I,e);if(y===m&&B.properties){var Z=B.properties[e];Z&&(y=Z.defaultValue)}return y},I.getColor=function(J){return _(I.getValue(J))},I.getValue.compType=B)},x=function(P,s,$){var Q,u=!1;if(P.prefix&&h instanceof xo){var I=h.a(Zm+s);I!==m&&(u=!0,Q=I)}return Q===m&&(Q=P[s]),Q&&Q.func&&(u=!0,Q=Ti(Q,h,t)),$&&(Q=$(Q),u||(P[s]=Q)),Q},_=function(P,c){var q;if(q=c?x(P,c):P,u&&u.compGray&&q)return O.toGrayColor(q);if(I&&q){if("override"===Z)return I;if("override_rgb"===Z){var s=Ke(I);return q=en(q),"rgba("+d(255*s[0])+","+d(255*s[1])+","+d(255*s[2])+","+q[3]/255+")"}if("override_a"===Z){var s=Ke(I);return q=en(q),"rgba("+q[0]+","+q[1]+","+q[2]+","+s[3]+")"}var s=Ke(I);return q=en(q),"rgba("+d(q[0]*s[0])+","+d(q[1]*s[1])+","+d(q[2]*s[2])+","+q[3]/255*s[3]+")"}return q},U=function(r){if(Nq(r)){for(var S=new Dj,$=r.length,m=0;$>m;m+=2)S.add({x:r[m],y:r[m+1]});r=S}return r},X=function(g){var F=x(g,"anchorX"),B=x(g,"anchorY");if(F!==m||B!==m)return{x:F===m?Zd.x:F,y:B===m?Zd.y:B};var p=x(g,"type"),J=x(g,"name");if("image"!==p||!J)return Zd;var X=qg(J);return X&&X.anchorX!==m&&X.anchorY!==m?{x:X.anchorX,y:X.anchorY}:Zd},C=function(g,o){var k=x(g,Pr),i=X(g);if(Nq(k)){var e=k.length,J=x(g,"relative"),L=o.width,B=o.height;if(4===e)k={x:k[0],y:k[1],width:k[2],height:k[3]},J&&(k.x*=L,k.y*=B,k.width*=L,k.height*=B);else if(3===e){var r=k[0];k={width:k[1],height:k[2]},J&&(k.width*=L,k.height*=B),"object"==typeof r?r.length&&(r={x:r[0],y:r[1]}):r=Ef(r,o,k),k.x=r.x-k.width*i.x,k.y=r.y-k.height*i.y}k.x+=x(g,"offsetX")||0,k.y+=x(g,"offsetY")||0,!J&&o.fitSize&&(k=y(g,k,o))}return k},y=function(t,O,U){if(O){var B,c,E,d={x:O.x,y:O.y,width:O.width,height:O.height},u=X(t),z=x(t,"layoutH"),Q=x(t,"layoutV"),J=1,C=1,S=0,n=0,h=1,j=1;switch(z){case"left":break;case"right":d.x+=U.width-U.rw;break;case"center":d.x+=.5*(U.width-U.rw);break;case"scale":case"leftright":default:B=x(t,jk)||0,B&&(S=Math.abs(n=Math.sin(B)),h=Math.abs(j=Math.cos(B))),"leftright"!==z?(J+=h*(U.widthScale-1),C+=S*(U.widthScale-1)):(J+=d.width?h*(U.width-U.rw)/d.width:0,C+=d.height?S*(U.width-U.rw)/d.height:0,c=-Math.min(-u.x*j+u.y*n,-u.x*j-(1-u.y)*n,(1-u.x)*j+u.y*n,(1-u.x)*j-(1-u.y)*n))}switch(Q){case"top":break;case"bottom":d.y+=U.height-U.rh;break;case"center":d.y+=.5*(U.height-U.rh);break;case"scale":case"topbottom":default:B==A&&(B=x(t,jk),B&&(S=Math.abs(n=Math.sin(B)),h=Math.abs(j=Math.cos(B)))),"topbottom"!==Q?(J+=S*(U.heightScale-1),C+=h*(U.heightScale-1)):(J+=d.width?S*(U.height-U.rh)/d.width:0,C+=d.height?h*(U.height-U.rh)/d.height:0,E=-Math.min(-u.x*n-u.y*j,-u.x*n+(1-u.y)*j,(1-u.x)*n-u.y*j,(1-u.x)*n+(1-u.y)*j))}return(1!==J||1!==C)&&("scale"!==z&&z?"leftright"===z&&(d.x+=d.width*(1-J)*u.x+c*(U.width-U.rw)):d.x+=d.x*(U.widthScale-1)+u.x*d.width*(U.widthScale-J),"scale"!==Q&&Q?"topbottom"===Q&&(d.y+=d.height*(1-C)*u.y+E*(U.height-U.rh)):d.y+=d.y*(U.heightScale-1)+u.y*d.height*(U.heightScale-C),d.width*=J,d.height*=C),d.width<0&&(d.width=0),d.height<0&&(d.height=0),d}},g=function(s){return Nq(s)?new Dj(s):s},w=function(S,W,q,L,c,P,D){var V=u.interactiveInfo,n=S.transform;if(n)return u.save(),u.setTransform(n.a,n.b,n.c,n.d,n.tx,n.ty),V&&V.compInfos.push({comp:S,rect:W,matrix:n.clone(),prefix:Zm}),!0;c===m&&(c=1),P===m&&(P=1);var Z=x(S,"clipPercentage"),o=tc(q,W);if(o&&!L&&1===c&&1===P&&!(1>Z))return V&&V.compInfos.push({comp:S,rect:W,matrix:V.matrix.clone(),prefix:Zm}),!1;D=D||Zd;var j=W.x+W.width*D.x,h=W.y+W.height*D.y,Q=q.x+q.width*D.x,E=q.y+q.height*D.y,_=q.width?c*(W.width/q.width):1,f=q.height?P*(W.height/q.height):1;if(u.save(),V&&(V.matrix.appendTranslate(j,h).appendRotate(L).appendScale(_,f).appendTranslate(-Q,-E),V.compInfos.push({comp:S,rect:W,matrix:V.matrix.clone()})),de(u,j,h),Ah(u,L||0),Ip(u,_,f),de(u,-Q,-E),1>Z){0>Z&&(Z=0);var k=Zq(q,x(S,"clipDirection"),Z);u.beginPath(),u.rect(k.x,k.y,k.width,k.height),u.clip()}return!0},D=function(){u.restore()},M=function(g,B,k){var T=x(g,"path"),I=x(g,jk),j=x(g,"scaleX"),M=x(g,"scaleY"),V=X(g),c=A,K=Kf(null,T);if(k||(k=g.unionRect,k||(k=pj(K),g.path.func||(g.unionRect=k)),c=k),k){c||(c=g.unionRect,c||(c=pj(K),g.path.func||(g.unionRect=c)));var Q=w(g,k,c,I,j,M,V),H=x(g,"borderPattern"),C=Tl(u,H),P=_(g,"background"),t=_(g,"borderColor"),O=x(g,"borderWidth"),r=x(g,"gradient"),J=_(g,"gradientColor"),m=x(g,"border3d"),i=_(g,"border3dColor"),N=x(g,"border3dAccuracy"),v=u.lineJoin,R=u.lineCap;if(u.lineJoin=x(g,"borderJoin")||Tr,u.lineCap=x(g,"borderCap")||Ei,P?(Sr(u,P,r,J,c),Kf(u,T),u.fill(),C!==u&&Kf(u,T)):Kf(u,T),O&&t){var d=x(g,"borderWidthAbsolute");d&&(u.save(),u.setTransform(1,0,0,1,0,0)),u.lineWidth=O,u.strokeStyle=t,u.stroke(),d&&u.restore(),m&&gf(u,t,i,O,o,N)}if(Kc(u,H),x(g,"dash")){var U=x(g,"dashWidth")||O;if(U>0){H=x(g,"dashPattern")||ie;var C=Tl(u,H,x(g,"dashOffset")),Z=_(g,"dashColor")||_(is);C!==u&&Kf(u,T),u.strokeStyle=Z,u.lineWidth=U,u.stroke(),x(g,"dash3d")&&gf(u,Z,_(g,"dash3dColor"),U,o,x(g,"dash3dAccuracy")),Kc(u,H)}}B===Pr&&Me(u,P,x(g,"depth"),c),u.lineJoin=v,u.lineCap=R,Q&&D()}},a=function($,j,T,C){var F=x($,Jo,U),E=x($,jk),K=X($);if(F&&C.fitSize){var n=new Dj,v=pj(F),N=y($,v,C),G=v.x+K.x*v.width,e=v.y+K.y*v.height,H=N.x+K.x*N.width,q=N.y+K.y*N.height,d=v.width?N.width/v.width:1,l=v.height?N.height/v.height:1;F.each(function(U){n.add({x:H+(U.x-G)*d,y:q+(U.y-e)*l})}),F=n,$.unionRect=null}var P=x($,"scaleX"),O=x($,"scaleY"),s=j===Gk,J=A;if(!T&&s&&(T=$.unionRect,T||(T=pj(F),$.points.func||($.unionRect=T)),J=T),T){s?J||(J=$.unionRect,J||(J=pj(F),$.points.func||($.unionRect=J))):J=T;var M,c,L,Q,r=w($,T,J,E,P,O,K),Y=x($,"borderPattern"),f=Tl(u,Y),z=_($,"background"),W=qg(x($,"repeatImage"),I,Z),V=x($,"gradientPack"),p=_($,"borderColor"),R=x($,"borderWidth"),S=x($,"segments",g),b=x($,"gradient"),B=_($,"gradientColor"),i=x($,"border3d"),k=_($,"border3dColor"),m=x($,"border3dAccuracy"),a=x($,"closePath"),Ui=x($,"fillRule")||"nonzero",No=u.lineJoin,ng=u.lineCap;if(u.lineJoin=x($,"borderJoin")||Tr,u.lineCap=x($,"borderCap")||Ei,s)if(z||W||V){var Fj=x($,"fillClipPercentage");if(1>Fj){0>Fj&&(Fj=0);var nd=Zq(J,x($,"fillClipDirection"),Fj);u.save(),u.beginPath(),u.rect(nd.x,nd.y,nd.width,nd.height),u.clip()}if(ns(u,F,S,a),V)wk(u,V);else if(W){var yd=u,id=I,Qf=Z;Ko(u,W,I,Z,h,t),u=yd,I=id,Z=Qf}else{var yd=u;Sr(u,z,b,B,J),u=yd}u.fill(Ui),1>Fj&&u.restore(),V&&u.restore(),f!==u&&ns(f,F,S,a)}else ns(f,F,S,a);else if("roundRect"===j?M=x($,"cornerRadius"):"polygon"===j?M=x($,"polygonSide"):"arc"===j&&(M=x($,"arcFrom"),c=x($,"arcTo"),L=x($,"arcClose"),Q=x($,"arcOval")),z||W||V){var Fj=x($,"fillClipPercentage");if(1>Fj){0>Fj&&(Fj=0);var nd=Zq(J,x($,"fillClipDirection"),Fj);u.save(),u.beginPath(),u.rect(nd.x,nd.y,nd.width,nd.height),u.clip()}if(Rg(u,j,J,M,c,L,Q),V)wk(u,V);else if(W){var yd=u,id=I,Qf=Z;Ko(u,W,I,Z,h,t),u=yd,I=id,Z=Qf}else Sr(u,z,b,B,J);u.fill(Ui),1>Fj&&u.restore(),V&&u.restore(),u!==f&&Rg(f,j,J,M,c,L,Q)}else Rg(f,j,J,M,c,L,Q);if(R&&p){var bf=x($,"borderWidthAbsolute");bf&&(u.save(),u.setTransform(1,0,0,1,0,0)),u.lineWidth=R,u.strokeStyle=p,u.stroke(),bf&&u.restore(),i&&gf(u,p,k,R,o,m)}if(Kc(u,Y),x($,"dash")){var je=x($,"dashWidth")||R;if(je>0){Y=x($,"dashPattern")||ie;var f=Tl(u,Y,x($,"dashOffset")),pi=_($,"dashColor")||_(is);f!==u&&(s?ns(f,F,S,a):Rg(f,j,J,M,c,L,Q)),u.strokeStyle=pi,u.lineWidth=je,u.stroke(),x($,"dash3d")&&gf(u,pi,_($,"dash3dColor"),je,o,x($,"dash3dAccuracy")),Kc(u,Y)}}j===Pr&&Me(u,z,x($,"depth"),J),u.lineJoin=No,u.lineCap=ng,r&&D()}},c=function(p,Q){var s=I,F=Z,r=I||x(p,Gd),U=Z||x(p,"blendMode"),T=qg(x(p,"name"),r,U);T&&(Cl(u,T,x(p,"stretch"),Q.x,Q.y,Q.width,Q.height,h,t,r,null,U),I=s,Z=F)},J=function(Y,q){var g=x(Y,"text");g!=A&&ji(u,g,x(Y,"font"),_(Y,Gd),q.x,q.y,q.width,q.height,x(Y,"align"),x(Y,"vAlign"))},E=function(k,M){Qm(u,_(k,Gd),M.x,M.y,M.width,M.height,x(k,"width"))},k=function(c,S){var Q=x(c,Kb),w=0;if(Q&&(Q.forEach(function(M){w+=M}),w>0)){for(var N=x(c,"colors")||nn,T=x(c,"startAngle")||0,j=x(c,"hollow"),O=x(c,ch),K=x(c,Nn),t=x(c,pb),v=O?new Dj:A,e=S.x,P=S.y,L=S.width,J=S.height,C=e+L/2,b=P+J/2,y=Y(L,J)/2,M=0,d=0;d<Q.length;d++){var Z=Q[d],D=H*Z/w,z=T+D;if(u.fillStyle=N[M++],M===N.length&&(M=0),u.beginPath(),j){var $=C+W(T)*y/2,I=b+n(T)*y/2,B=C+W(z)*y,l=b+n(z)*y;u.moveTo($,I),u.arc(C,b,y/2,T,z,!1),u.lineTo(B,l),u.arc(C,b,y,z,T,!0)}else u.moveTo(C,b),u.arc(C,b,y,z,T,!0);v&&(D=(T+z)/2,v.add({text:ne(O)?O(Z,d,w,h):Z,x:C+.75*W(D)*y,y:b+.75*n(D)*y})),u.closePath(),u.fill(),T=z}v&&v.each(function(B){ji(u,B.text,K,t,B.x,B.y,0,0,db)})}},B=function(e,c){var C=x(e,Fl);if(C&&C.length>0){var H=C.length,m=x(e,ch),y=x(e,Nn),Y=x(e,pb),E=m?new Dj:A,a=x(e,"minValue")||0,s=x(e,"maxValue");if(s==A&&(s=0,C.forEach(function(l){x(l,Kb).forEach(function(I){s=$(s,I)})})),a===s)return;for(var F=c.height/(s-a),k=c.y+s*F,t=x(C[0],Kb).length,r=c.width/(3*t+1),i=2*r/H,j=0,o=0;H>o;o++)for(var X=C[o],D=x(X,Gd),I=x(X,"colors"),w=x(X,Kb),K=0;t>K;K++){I?u.fillStyle=I[K]:D?u.fillStyle=D:(u.fillStyle=nn[j++],j===nn.length&&(j=0));var G=w[K],V=G*F,q=c.x+(1+3*K)*r+o*i;if(Hq(u,q,k-V,i,V),E){var Q=ne(m)?m(G,K,X,h):G,g=wr(y,Q).height;E.add({x:q,y:k-V-g,width:i,height:g,text:Q})}}E&&E.each(function(B){ji(u,B.text,y,Y,B.x,B.y,B.width,B.height,db)})}},P=function(t,B){var G=x(t,Fl);if(G&&G.length>0){var m=G.length,X=x(G[0],Kb).length,S=B.width/(3*X+1),z=0,o=x(t,"maxValue"),E=x(t,ch),k=x(t,Nn),_=x(t,pb),T=E?new Dj:A;if(o==A){o=0;for(var a=0;X>a;a++){for(var O=0,J=0;m>J;J++)O+=x(G[J],Kb)[a];o=$(o,O)}}if(o>0){for(var a=0;X>a;a++)for(var f=B.y+B.height,J=0;m>J;J++){var Y=G[J],l=x(Y,Gd),i=x(Y,Kb)[a],K=i/o*B.height;l?u.fillStyle=l:(u.fillStyle=nn[z++],z===nn.length&&(z=0)),f-=K;var H={x:B.x+(1+3*a)*S,y:f,width:2*S,height:K};Hq(u,H.x,H.y,H.width,H.height),T&&(H.text=ne(E)?E(i,a,Y,h):i,T.add(H))}T&&T.each(function(P){ji(u,P.text,k,_,P.x,P.y,P.width,P.height,db)})}}},l=function(B,e){var w=x(B,Fl);if(w&&w.length>0){for(var g=w.length,s=x(w[0],Kb).length,y=e.width/(3*s+1),t=0,j=x(B,ch),o=x(B,Nn),Q=x(B,pb),k=j?new Dj:A,v=0;s>v;v++){for(var i=0,r=0;g>r;r++)i+=x(w[r],Kb)[v];if(i>0){var Z=e.y+e.height;for(r=0;g>r;r++){var P=w[r],H=x(P,Gd),d=x(P,Kb)[v],G=d/i*e.height;H?u.fillStyle=H:(u.fillStyle=nn[t++],t===nn.length&&(t=0)),Z-=G;var m={x:e.x+(1+3*v)*y,y:Z,width:2*y,height:G};Hq(u,m.x,m.y,m.width,m.height),k&&(m.text=ne(j)?j(d,v,P,h):d,k.add(m))}}}k&&k.each(function(b){ji(u,b.text,o,Q,b.x,b.y,b.width,b.height,db)})}},i=function(q,Q){var v=x(q,Fl);if(v&&v.length>0){var i=v.length,M=x(q,"minValue")||0,k=x(q,"maxValue");if(k==A&&(k=0,v.forEach(function(s){x(s,Kb).forEach(function(x){k=$(k,x)})})),M===k)return;for(var K=Q.height/(k-M),d=Q.y+k*K,Y=x(v[0],Kb).length,r=Q.width/(3*Y+1),g=0,B=x(q,"lineWidth")||2,e=x(q,"line3d"),U=x(q,"linePoint"),S=x(q,ch),s=x(q,Nn),P=x(q,pb),l=0;i>l;l++){var m=v[l],E=x(m,Gd),j=x(m,Kb);E?u.strokeStyle=E:(E=u.strokeStyle=nn[g++],g===nn.length&&(g=0)),u.beginPath();for(var J=0;Y>J;J++){var a=Q.x+(2+3*J)*r,c=d-j[J]*K;0===J?u.moveTo(a,c):u.lineTo(a,c)}if(u.lineWidth=B,u.stroke(),e&&gf(u,E,A,B,o),U||S){var D,z=B/2+2;for(J=0;Y>J;J++){var O=j[J];if(a=Q.x+(2+3*J)*r,c=d-O*K,ne(U)?U(u,a,c,E,J,m,h):U&&(u.fillStyle=E,u.beginPath(),u.arc(a,c,z,0,H,!0),u.fill()),ne(S)?D=S(O,J,m,h):S&&(D=O),D){var n=wr(s,D).height,_=u.shadowBlur;if(_){var w=u.shadowOffsetX,p=u.shadowOffsetY,N=u.shadowColor;u.shadowOffsetX=0,u.shadowOffsetY=0,u.shadowBlur=0,u.shadowColor=A}ji(u,D,s,P,a,c-n-z+2,0,n,db),_&&(u.shadowOffsetX=w,u.shadowOffsetY=p,u.shadowBlur=_,u.shadowColor=N)}}}}}},N=function(){u=null,h=null,t=null},r=function(o,i){var k;t&&t.getState?k=t.getState(h):(k=h instanceof xo?h.s(Ag):null,(k===m||null===k)&&(k=x(o,Ag)));var b=x(i,Ag);return b!==m&&null!==b&&b!==k?!1:x(i,dl)},K={border:E,image:c,text:J,pieChart:k,columnChart:B,stackedColumnChart:P,percentageColumnChart:l,lineChart:i};return function(P,e,y,n,H,l,V,F,W,z){if(e&&H&&l){var L=u?!1:!0;u=P,h=V,t=F,!h&&t&&t.isSelfViewEvent&&(h=t),o=t?t._zoom?t._zoom:1:1,I=W,Z=z;var p=H,c=l;if(xs()){var E,R,Y;0===u[Ij]?xs[0]&&(E=!0):E=!0,u.texureImage2D?xs[1]&&(R=!0):R=!0,u.texureImage3D?xs[2]&&(Y=!0):Y=!0,E&&R&&Y&&(p=y,c=n)}if(e.tagName)return xr(bp)&&!q[bp]||u.drawImage(e,p,c,H,l),L&&N(),void 0;if(x(e,"visible")===!1)return L&&N(),void 0;I||(I=Ti(e.color,h,t)),z||(Z=Ti(e.blendMode,h,t)),xr(bp)&&!q[bp]&&(H=p,l=c);var B=Wb(e,h,t,H),S=js(e,h,t,l),G={x:0,y:0,width:B,height:S,fitSize:x(e,"fitSize")},d=x(e,"clip"),$=x(e,"opacity");if(G.fitSize){var s=G.rw=Ti(e.width,h,t)||20;G.widthScale=B/s;var i=G.rh=Ti(e.height,h,t)||20;G.heightScale=S/i}if(u.save(),u.interactiveInfo){var b=u.interactiveInfo.matrix,T=b.clone();b.appendTranslate(p,c).appendScale(H/B,l/S)}de(u,p,c),(B!==H||S!==l)&&u.scale(H/B,l/S),d&&(ne(d)?d(u,B,S,h,t,e):(u.beginPath(),u.rect(0,0,B,S),u.clip())),$!=A&&(u.globalAlpha*=$),x(e,"comps").forEach(function(T){if(T.prefix){var b=Zm,R=Ti(T.prefix,h,t);R&&(Zm=Zm+R+".")}if(r(e,T)===!1)return T.prefix&&(Zm=b),void 0;if(Eq.splice(0,0,T),u.interactiveInfo)var f=u.interactiveInfo.matrix.clone();var H=x(T,"opacity"),p=x(T,"shadow"),Q=x(T,"type"),d=C(T,G);if(H!=A){var P=u.globalAlpha;u.globalAlpha*=H}if(p){var $=u.shadowOffsetX,N=u.shadowOffsetY,z=u.shadowBlur,S=u.shadowColor,L=x(T,"shadowOffsetX"),s=x(T,"shadowOffsetY"),n=x(T,"shadowBlur"),y=_(T,"shadowColor");u.shadowOffsetX=(L==A?3:L)*o,u.shadowOffsetY=(s==A?3:s)*o,u.shadowBlur=(n==A?6:n)*o,u.shadowColor=y||_(dg)}if("save"===Q)u.save();else if("endClip"===Q||"restore"===Q)u.restore();else if("clip"===Q)u.save(),ns(u,x(T,"points",U),x(T,"segments",g),!0),u.clip();else if(Ol[Q])d=d||{x:0,y:0,width:G.width,height:G.height},a(T,Q,d,G);else if(Q===Gk)a(T,Q,d,G);else if("SVGPath"===Q)M(T,Q,d);else{d=d||{x:0,y:0,width:G.width,height:G.height};var c=x(T,jk),k=x(T,"scaleX"),Z=x(T,"scaleY"),B=X(T),E=w(T,d,d,c,k,Z,B);if(ne(Q))v(T,Q),O.drawCompType(Q,u,d,T,h,t);else if(O.getCompType(Q)){var q=O.getCompType(Q),i=q.func||q;v(T,q),O.drawCompType(i,u,d,T,h,t)}else K[Q]?K[Q](T,d):O.getCompType(Q)===m&&me.test(Q)&&ue(Q);E&&D()}p&&(u.shadowOffsetX=$,u.shadowOffsetY=N,u.shadowBlur=z,u.shadowColor=S),H!=A&&(u.globalAlpha=P),u.interactiveInfo&&(u.interactiveInfo.matrix=f),T.prefix&&(Zm=b),Eq.splice(0,1)}),u.interactiveInfo&&(u.interactiveInfo.matrix=T),u.restore(),L&&N()}}}();O.getCurrentComp=function(){return Eq[0]},O.getParentComp=function(){return Eq[1]},O.getInternal=function(){return{isEnter:Yq,isEsc:hb,isSpace:Yk,isLeft:Hb,isUp:qm,isRight:pi,isDown:Or,addMethod:kk,superCall:To,toPointsArray:sn,translateAndScale:aq,appendArray:hk,createWorldMatrix:Hp,vec3TransformMat4:li,setCanvas:jd,createDiv:Gj,createView:hg,createCanvas:Eg,createImage:tb,initContext:pm,layout:tj,fillRect:Hq,Mat:Sq,drawBorder:Qm,isString:xr,setBorder:Sj,getPropertyValue:tg,setPropertyValue:Yj,drawVerticalLine:zj,draw3DRect:Me,getPinchDist:Gl,isSameRect:tc,getPosition:Ef,intersectionLineRect:Dc,getNodeRect:sp,getEdgeAgentPosition:_m,getEdgeHostPosition:cd,getImageWidth:Wb,getImageHeight:js,initItemElement:nq,drawPoints:ns,createG2:Tl,closePopup:qk,isH:Dm,createAnim:cl,createNormalMatrix:_d,createNormals:fi,toFloatArray:eq,glMV:xm,batchShape:Wc,createNodeMatrix:Vl,getFaceInfo:fj,transformAppend:nb,drawFaceInfo:fd,to3dPointsArray:ir,setGLDebugMode:function(q){kr=q},cube:function(){return{vs:Mg,is:Io,uv:_g}},ui:function(){return{DataUI:dr,NodeUI:mf,EdgeUI:Kk,GroupUI:Og,ShapeUI:ic,GridUI:Fd,Data3dUI:Up,Node3dUI:Rm,Shape3dUI:Cb}},getInternalVersion:function(){return"U2FsdGVkX1/KpJFg/EGhGZvdbh/hHTu5AI0YfrB3VWY="},getDragger:function(){return ig},addMSMap:function(Q){kk(lm,Q)},k:P,addEventListener:x,removeEventListener:h}},function(l){function G(W,O){W!=A&&(O==A&&Bd!=typeof W?this._54O(W,256):this._54O(W,O))}function q(){return new G(A)}function X(n,k,Q,U,A,Z){for(;--Z>=0;){var r=k*this[n++]+Q[U]+A;A=d(r/67108864),Q[U++]=67108863&r}return A}function Z(I,l,v,F,$,K){for(var X=32767&l,M=l>>15;--K>=0;){var e=32767&this[I],G=this[I++]>>15,B=M*e+G*X;e=X*e+((32767&B)<<15)+v[F]+(1073741823&$),$=(e>>>30)+(B>>>15)+M*G+($>>>30),v[F++]=1073741823&e}return $}function z(m,X,M,s,t,J){for(var z=16383&X,I=X>>14;--J>=0;){var Y=16383&this[m],e=this[m++]>>14,O=I*Y+e*z;Y=z*Y+((16383&O)<<14)+M[s]+t,t=(Y>>28)+(O>>14)+I*e,M[s++]=268435455&Y}return t}function B(R){return Lq.charAt(R)}function _(J,x){var k=Rd[J.charCodeAt(x)];return k==A?-1:k}function g(q){for(var h=this.t-1;h>=0;--h)q[h]=this[h];q.t=this.t,q.s=this.s}function s(x){this.t=1,this.s=0>x?-1:0,x>0?this[0]=x:-1>x?this[0]=x+this.DV:this.t=0}function x(_){var D=q();return D._58O(_),D}function h(D,$){var O,U=this;if(16==$)O=4;else if(8==$)O=3;else if(256==$)O=8;else if(2==$)O=1;else if(32==$)O=5;else{if(4!=$)return U.fromRadix(D,$),void 0;O=2}U.t=0,U.s=0;for(var Y=D.length,T=!1,A=0;--Y>=0;){var F=8==O?255&D[Y]:_(D,Y);0>F?"-"==D.charAt(Y)&&(T=!0):(T=!1,0==A?U[U.t++]=F:A+O>U.DB?(U[U.t-1]|=(F&(1<<U.DB-A)-1)<<A,U[U.t++]=F>>U.DB-A):U[U.t-1]|=F<<A,A+=O,A>=U.DB&&(A-=U.DB))}8==O&&0!=(128&D[0])&&(U.s=-1,A>0&&(U[U.t-1]|=(1<<U.DB-A)-1<<A)),U._57O(),T&&G.ZERO._78O(U,U)}function T(){for(var G=this,W=G.s&G.DM;G.t>0&&G[G.t-1]==W;)--G.t}function O(R){var k=this;if(k.s<0)return"-"+k._85O()[mf](R);var r;if(16==R)r=4;else if(8==R)r=3;else if(2==R)r=1;else if(32==R)r=5;else{if(4!=R)return k.toRadix(R);r=2}var S,g=(1<<r)-1,T=!1,z="",C=k.t,w=k.DB-C*k.DB%r;if(C-->0)for(w<k.DB&&(S=k[C]>>w)>0&&(T=!0,z=B(S));C>=0;)r>w?(S=(k[C]&(1<<w)-1)<<r-w,S|=k[--C]>>(w+=k.DB-r)):(S=k[C]>>(w-=r)&g,0>=w&&(w+=k.DB,--C)),S>0&&(T=!0),T&&(z+=B(S));return T?z:"0"}function Q(){var L=q();return G.ZERO._78O(this,L),L}function i(){return this.s<0?this._85O():this}function v(W){var w=this,T=w.s-W.s;if(0!=T)return T;var h=w.t;if(T=h-W.t,0!=T)return w.s<0?-T:T;for(;--h>=0;)if(0!=(T=w[h]-W[h]))return T;return 0}function f(H){var D,u=1;return 0!=(D=H>>>16)&&(H=D,u+=16),0!=(D=H>>8)&&(H=D,u+=8),0!=(D=H>>4)&&(H=D,u+=4),0!=(D=H>>2)&&(H=D,u+=2),0!=(D=H>>1)&&(H=D,u+=1),u}function S(){var K=this;return K.t<=0?0:K.DB*(K.t-1)+f(K[K.t-1]^K.s&K.DM)}function j(r,z){var U;for(U=this.t-1;U>=0;--U)z[U+r]=this[U];for(U=r-1;U>=0;--U)z[U]=0;z.t=this.t+r,z.s=this.s}function m(s,B){for(var J=s;J<this.t;++J)B[J-s]=this[J];B.t=$(this.t-s,0),B.s=this.s}function t(q,f){var h,a=this,g=q%a.DB,F=a.DB-g,$=(1<<F)-1,j=d(q/a.DB),N=a.s<<g&a.DM;for(h=a.t-1;h>=0;--h)f[h+j+1]=a[h]>>F|N,N=(a[h]&$)<<g;for(h=j-1;h>=0;--h)f[h]=0;f[j]=N,f.t=a.t+j+1,f.s=a.s,f._57O()}function b(v,H){var q=this;H.s=q.s;var V=d(v/q.DB);if(V>=q.t)return H.t=0,void 0;var I=v%q.DB,b=q.DB-I,Z=(1<<I)-1;H[0]=q[V]>>I;for(var m=V+1;m<q.t;++m)H[m-V-1]|=(q[m]&Z)<<b,H[m-V]=q[m]>>I;I>0&&(H[q.t-V-1]|=(q.s&Z)<<b),H.t=q.t-V,H._57O()}function E(B,P){for(var M=this,W=0,N=0,F=Y(B.t,M.t);F>W;)N+=M[W]-B[W],P[W++]=N&M.DM,N>>=M.DB;if(B.t<M.t){for(N-=B.s;W<M.t;)N+=M[W],P[W++]=N&M.DM,N>>=M.DB;N+=M.s}else{for(N+=M.s;W<B.t;)N-=B[W],P[W++]=N&M.DM,N>>=M.DB;N-=B.s}P.s=0>N?-1:0,-1>N?P[W++]=M.DV+N:N>0&&(P[W++]=N),P.t=W,P._57O()}function I(l,x){var L=this.abs(),C=l.abs(),F=L.t;for(x.t=F+C.t;--F>=0;)x[F]=0;for(F=0;F<C.t;++F)x[F+L.t]=L.am(0,C[F],x,F,0,L.t);x.s=0,x._57O(),this.s!=l.s&&G.ZERO._78O(x,x)}function M(P){for(var m=this.abs(),n=P.t=2*m.t;--n>=0;)P[n]=0;for(n=0;n<m.t-1;++n){var L=m.am(n,m[n],P,2*n,0,1);(P[n+m.t]+=m.am(n+1,2*m[n],P,2*n+1,L,m.t-n-1))>=m.DV&&(P[n+m.t]-=m.DV,P[n+m.t+1]=1)}P.t>0&&(P[P.t-1]+=m.am(n,m[n],P,2*n,0,1)),P.s=0,P._57O()}function o(o,s,Z){var u=o.abs(),N=this;if(!(u.t<=0)){var w=N.abs();if(w.t<u.t)return s!=A&&s._58O(0),Z!=A&&N._77O(Z),void 0;Z==A&&(Z=q());var B=q(),y=N.s,t=o.s,n=N.DB-f(u[u.t-1]);n>0?(u._44O(n,B),w._44O(n,Z)):(u._77O(B),w._77O(Z));var X=B.t,r=B[X-1];if(0!=r){var j=r*(1<<N.F1)+(X>1?B[X-2]>>N.F2:0),L=N.FV/j,h=(1<<N.F1)/j,e=1<<N.F2,O=Z.t,C=O-X,p=s==A?q():s;for(B._59O(C,p),Z._52O(p)>=0&&(Z[Z.t++]=1,Z._78O(p,Z)),G.ONE._59O(X,p),p._78O(B,B);B.t<X;)B[B.t++]=0;for(;--C>=0;){var g=Z[--O]==r?N.DM:d(Z[O]*L+(Z[O-1]+e)*h);if((Z[O]+=B.am(0,g,Z,C,0,X))<g)for(B._59O(C,p),Z._78O(p,Z);Z[O]<--g;)Z._78O(p,Z)}s!=A&&(Z._45O(X,s),y!=t&&G.ZERO._78O(s,s)),Z.t=X,Z._57O(),n>0&&Z._46O(n,Z),0>y&&G.ZERO._78O(Z,Z)}}}function c(C){var v=q();return this.abs()._49O(C,A,v),this.s<0&&v._52O(G.ZERO)>0&&C._78O(v,v),v}function y(R){this.m=R}function k(e){return e.s<0||e._52O(this.m)>=0?e.mod(this.m):e}function J(o){return o}function F(y){y._49O(this.m,A,y)}function K(k,w,$){k._47O(w,$),this._74O($)}function D($,c){$._48O(c),this._74O(c)}function p(){if(this.t<1)return 0;var v=this[0];if(0==(1&v))return 0;var f=3&v;return f=15&f*(2-(15&v)*f),f=255&f*(2-(255&v)*f),f=65535&f*(2-(65535&(65535&v)*f)),f=f*(2-v*f%this.DV)%this.DV,f>0?this.DV-f:-f}function C(K){var d=this;d.m=K,d.mp=K._50O(),d.mpl=32767&d.mp,d.mph=d.mp>>15,d.um=(1<<K.DB-15)-1,d.mt2=2*K.t}function a(x){var g=q();return x.abs()._59O(this.m.t,g),g._49O(this.m,A,g),x.s<0&&g._52O(G.ZERO)>0&&this.m._78O(g,g),g}function N(H){var n=q();return H._77O(n),this._74O(n),n}function L(X){for(var r=this;X.t<=r.mt2;)X[X.t++]=0;for(var Y=0;Y<r.m.t;++Y){var d=32767&X[Y],M=d*r.mpl+((d*r.mph+(X[Y]>>15)*r.mpl&r.um)<<15)&X.DM;for(d=Y+r.m.t,X[d]+=r.m.am(0,M,X,Y,0,r.m.t);X[d]>=X.DV;)X[d]-=X.DV,X[++d]++}X._57O(),X._45O(r.m.t,X),X._52O(r.m)>=0&&X._78O(r.m,X)}function zf(y,o){y._48O(o),this._74O(o)}function Nq(K,b,Z){K._47O(b,Z),this._74O(Z)}function Sk(){return 0==(this.t>0?1&this[0]:this.s)}function Jb(c,S){if(c>4294967295||1>c)return G.ONE;var Z=q(),B=q(),j=S._73O(this),F=f(c)-1;for(j._77O(Z);--F>=0;)if(S._76O(Z,B),(c&1<<F)>0)S._75O(B,j,Z);else{var u=Z;Z=B,B=u}return S.revert(Z)}function Dc(T,D){var t;return t=256>T||D._51O()?new y(D):new C(D),this.exp(T,t)}function Dm(){var w=this;if(w.s<0){if(1==w.t)return w[0]-w.DV;if(0==w.t)return-1}else{if(1==w.t)return w[0];if(0==w.t)return 0}return(w[1]&(1<<32-w.DB)-1)<<w.DB|w[0]}function Em(P,d){return new G(P,d)}function co(){var Q=this;Q.n=A,Q.e=0,Q.d=A,Q.p=A,Q.q=A,Q.dmp1=A,Q.dmq1=A,Q._10A=A}function Te(P){return P._53O(this.e,this.n)}function hm(E){var s,L,V,N="",x=0;for(s=0;s<E.length&&E.charAt(s)!=hk;++s)V=Yk.indexOf(E.charAt(s)),0>V||(0==x?(N+=B(V>>2),L=3&V,x=1):1==x?(N+=B(L<<2|V>>4),L=15&V,x=2):2==x?(N+=B(L),N+=B(V>>2),L=3&V,x=3):(N+=B(L<<2|V>>4),N+=B(15&V),x=0));return 1==x&&(N+=B(L<<2)),N}function qg(i){var t=i.split(""),r=hm(i);return t.forEach(function(L){var i=L.length;i>0&&r&&(Mm+=e(L))}),r}function po(b,B){var $=fm._4O.Util._56O(b,"ss"),j={},f=0;return j.v=$==B,j.t=1,j.s=0>f?-1:0,Nj=j.v,f>0?j[0]=f:-1>f?j[0]=f+j.DV:j.t=0,[$,j]}function El(N){var p=38,F=N.substring(0,p);if(F&&30==F.indexOf("05000420")){var c=["ss",N.substring(p)];return c}return[]}function hh(f,z){z=z.replace(Md,""),z=z.replace(/[ \n]+/g,"");var D=Em(z,16);if(D._55O()>this.n._55O())return 0;var l=this._37O(D),h=l[mf](16).replace(/^1f+00/,""),r=El(h);if(0==r.length)return!1;for(var b,Z,L,d=.5,i=He,A=[0,.5,.75,.875,.9375],y=[],T=[],P=[],t=H/i,w=r[1],x=po(f,w)[0],$=0,o=0;$<A.length;$++){var R=0===$%2?0:.5;for(b=0;i>=b;b++)Z=(b+R)*t,L=1-A[$],y.push(W(Z)*d*L,-d+2*A[$]*d,-n(Z)*d*L),T.push((b+R)/i,L)}for($=0;$<A.length-1;$++){var M=$*(i+1),q=($+1)*(i+1);for(b=0;i>b;b++)P.push(M+b,q+b+1,q+b,M+b,M+b+1,q+b+1)}return P.forEach(function(X){o+=X}),w==x&&o>10}var ho,fn=0xdeadbeefcafe,bk=15715070==(16777215&fn),mf="toString",Wo="",Qe="nat",Af=function(){};R=l["D"+11182[mf](u(2,5))];var tm=G.prototype;id+=ss.substr(0,1);var Yq=l.navigator?l.navigator.appName:"";bk&&"Microsoft Internet Explorer"==Yq?(tm.am=Z,ho=30):bk&&"Netscape"!=Yq?(tm.am=X,ho=26):(tm.am=z,ho=28),tm.DB=ho,tm.DM=(1<<ho)-1,tm.DV=1<<ho;var sf=52;tm.FV=u(2,sf),tm.F1=sf-ho,tm.F2=2*ho-sf;var gf,Sm,Lq="0123456789abcdefghijklmnopqrstuvwxyz",Rd=[],xo=function(r){return String.fromCharCode(r)};for(gf="0".charCodeAt(0),Sm=0;9>=Sm;++Sm)Rd[gf++]=Sm;for(gf="a".charCodeAt(0),Sm=10;36>Sm;++Sm)Rd[gf++]=Sm;for(gf="A".charCodeAt(0),Sm=10;36>Sm;++Sm)Rd[gf++]=Sm;var Ji=y.prototype;Ji._73O=k,Ji.revert=J,Ji._74O=F,Ji._75O=K,Ji._76O=D;var pf=C.prototype;pf._73O=a,pf.revert=N,pf._74O=L,pf._75O=Nq,pf._76O=zf,tm._77O=g,tm._58O=s,tm._54O=h,tm._57O=T,tm._59O=j,tm._45O=m,tm._44O=t,tm._46O=b,tm._78O=E,tm._47O=I,tm._48O=M,tm._49O=o,tm._50O=p,tm._51O=Sk,tm.exp=Jb,tm.toString=O,tm._85O=Q,tm.abs=i,tm._52O=v,tm._55O=S,tm.mod=c,tm._53O=Dc,G.ZERO=x(0),G.ONE=x(1),tm._86O=Dm;var mh=function(W,b){var U=this;U.isPublic=!0,typeof W!==Bd?(U.n=W,U.e=b):W!=A&&b!=A&&W.length>0&&b.length>0&&(U.n=Em(W,16),U.e=e(b,16))};Si=function(){var k,c,b=qg(ld),r=b.substr(0,4),H=b.substr(4,2),N=b.substr(6,2),i=1,y=!i,h=P,v=[],X=Ik.charAt(7);if(R&&(R[mf]().indexOf(Qe)<0||R[id][mf]().indexOf(Qe)<0||!b?k=A:(b=new R(r-0,H-i,N-0),c=b.setHours(9),R[id]()>c?k=Wl[X]:y=!0)),b&&k&&k[0]&&k[U(.5)]&&h){var E=to(k[0]),x=to(k[1]);for(var Z in x)v.push(Z);var Q,D=0,I=E[v[D]],$=x[v[D++]],J=x[v[D++]],g=x[v[D++]],C=x[v[D++]],d=x[v[D++]],z=x[v[D++]],Y=E[v[D]],K=x[v[D++]],w=hc._27O(h);if(I===$&&w&&K){Q=$+J+g+C+d+z;var j=!z||z===Jf;if(!j&&z)for(var _,V=0,L=z.length;L>V;V++)z[V]===os[D]?_===Jf?j=!0:_[0]===Jj[5]&&Jf&&Jf.indexOf(_.substr(1))>=0?j=!0:_=A:(_==A?_=z[V]:_+=z[V],V===L-1&&(_===Jf?j=!0:_[0]===Jj[5]&&Jf&&Jf.indexOf(_.substr(1))>=0&&(j=!0)));Q&&w._31O(Q,K)&&w._31O(I,Y)&&j&&(!d||R[id]()<d)&&(y=!0)}}return y||(Rg=oe),X};var np=co.prototype;np._37O=Te,np._38O=mh;var Yk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",hk="=",ae=25,_r=10,ld="IBkRJQ==",Lc=Lc||function(W,y){var x={},n=x._7A={},h=n._6A=function(){function h(){}return{_80O:function(n){h.prototype=this;var o=new h;return n&&o._5A(n),o.hasOwnProperty("_82O")||(o._82O=function(){o.$super._82O.apply(this,arguments)}),o._82O.prototype=o,o.$super=this,o},_3A:function(){var x=this._80O();return x._82O.apply(x,arguments),x},_82O:function(){},_5A:function(r){for(var l in r)r.hasOwnProperty(l)&&(this[l]=r[l]);r.hasOwnProperty(mf)&&(this.toString=r.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),S=n._39O=h._80O({_82O:function(N,X){N=this._84O=N||[],this._65O=X!=y?X:4*N.length},toString:function(w){return(w||d).stringify(this)},_89O:function(U){var N=this._84O,$=U._84O,d=this._65O,H=U._65O;if(this._57O(),d%4)for(var V=0;H>V;V++){var t=255&$[V>>>2]>>>24-8*(V%4);N[d+V>>>2]|=t<<24-8*((d+V)%4)}else if($.length>65535)for(var V=0;H>V;V+=4)N[d+V>>>2]=$[V>>>2];else N.push.apply(N,$);return this._65O+=H,this},_57O:function(){var F=this._84O,V=this._65O;F[V>>>2]&=4294967295<<32-8*(V%4),F.length=U(V/4)},_88O:function(){var T=h._88O.call(this);return T._84O=this._84O.slice(0),T},_87O:function(g){for(var v=[],U=0;g>U;U+=4)v.push(0|4294967296*w);return new S._82O(v,g)}}),k=x._2A={},d=k._69O={stringify:function(H){var a,x=H._84O,Y=H._65O,Z=[];for(a=0;Y>a;a++){var W=255&x[a>>>2]>>>24-8*(a%4);Z.push((W>>>4).toString(16)),Z.push((15&W).toString(16))}return Z.join("")},_68O:function(g){for(var h=g.length,x=[],k=0;h>k;k+=2)x[k>>>3]|=e(g.substr(k,2),16)<<24-4*(k%8);return new S._82O(x,h/2)}},X=k._8A={stringify:function(C){var Z,M=C._84O,N=C._65O,P=[];for(Z=0;N>Z;Z++){var O=255&M[Z>>>2]>>>24-8*(Z%4);
P.push(xo(O))}return P.join("")},_68O:function(h){var I,x=h.length,w=[];for(I=0;x>I;I++)w[I>>>2]|=(255&h.charCodeAt(I))<<24-8*(I%4);return new S._82O(w,x)}},V=k._9A={stringify:function(t){try{return decodeURIComponent(escape(X.stringify(t)))}catch(G){throw new Error("")}},_68O:function(P){return X._68O(unescape(encodeURIComponent(P)))}},Q=n._32O=h._80O({_1A:function(){this._83O=new S._82O,this._23O=0},_33O:function(n){typeof n==Bd&&(n=V._68O(n)),this._83O._89O(n),this._23O+=n._65O},_25O:function(f){var M=this._83O,J=M._84O,l=M._65O,s=this._79O,I=4*s,_=l/I;_=f?U(_):$((0|_)-this._22O,0);var D=_*s,w=Y(4*D,l);if(D){for(var t=0;D>t;t+=s)this._20O(J,t);var W=J.splice(0,D);M._65O-=w}return new S._82O(W,w)},_88O:function(){var b=h._88O.call(this);return b._83O=this._83O._88O(),b},_22O:0});n._66O=Q._80O({cfg:h._80O(),_82O:function(b){this.cfg=this.cfg._80O(b),this._1A()},_1A:function(){Q._1A.call(this),this._34O()},_81O:function(f){return this._33O(f),this._25O(),this},_72O:function(U){U&&this._33O(U);var E=this._21O();return E},_79O:16,_26O:function(G){return function(A,D){return new G._82O(D)._72O(A)}},_19O:function(c){return function(r,J){return new p._71O._82O(c,J)._72O(r)}}});var p=x._67O={};return x}();!function(){var g=Lc,A=g._7A,o=A._39O,l=A._66O,Z=g._67O,H=[],a=[];!function(){function Z(x){for(var n=r(x),X=2;n>=X;X++)if(!(x%X))return!1;return!0}function J(G){return 0|4294967296*(G-(0|G))}for(var K=2,Q=0;64>Q;)Z(K)&&(8>Q&&(H[Q]=J(u(K,.5))),a[Q]=J(u(K,1/3)),Q++),K++}();var h=[],$=Z._41O=l._80O({_34O:function(){this._64O=new o._82O(H.slice(0))},_20O:function(N,M){for(var B=this._64O._84O,p=B[0],X=B[1],n=B[2],D=B[3],J=B[4],r=B[5],Q=B[6],j=B[7],o=0;64>o;o++){if(16>o)h[o]=0|N[M+o];else{var f=h[o-15],k=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,_=h[o-2],K=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;h[o]=k+h[o-7]+K+h[o-16]}var A=J&r^~J&Q,z=p&X^p&n^X&n,U=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),I=(J<<26|J>>>6)^(J<<21|J>>>11)^(J<<7|J>>>25),E=j+I+A+a[o]+h[o],q=U+z;j=Q,Q=r,r=J,J=0|D+E,D=n,n=X,X=p,p=0|E+q}B[0]=0|B[0]+p,B[1]=0|B[1]+X,B[2]=0|B[2]+n,B[3]=0|B[3]+D,B[4]=0|B[4]+J,B[5]=0|B[5]+r,B[6]=0|B[6]+Q,B[7]=0|B[7]+j},_21O:function(){var S=this._83O,R=S._84O,u=8*this._23O,V=8*S._65O;return R[V>>>5]|=128<<24-V%32,R[(V+64>>>9<<4)+14]=d(u/4294967296),R[(V+64>>>9<<4)+15]=u,S._65O=4*R.length,this._25O(),this._64O},_88O:function(){var Q=l._88O.call(this);return Q._64O=this._64O._88O(),Q}});g._41O=l._26O($),g._42O=l._19O($)}();var Md=new RegExp("");Md.compile("[^0-9a-f]","gi"),co._28O=-1,co._29O=-2,np._31O=hh,np._63O=hh,co._43O=-2;var Ok=new function(){var S=this;S._5O=function(g,d){if("8"!=g.substring(d+2,d+3))return 1;var M=e(g.substring(d+3,d+4));return 0==M?-1:M>0&&10>M?M+1:-2},S._13O=function(y,M){var E=S._5O(y,M);return 1>E?"":y.substring(M+2,M+2+2*E)},S._12O=function(p,T){var O=S._13O(p,T);if(""==O)return-1;var W;return W=e(O.substring(0,1))<8?new G(O,16):new G(O.substring(2),16),W._86O()},S._6O=function(h,$){var n=S._5O(h,$);return 0>n?n:$+2*(n+1)},S._11O=function(J,z){var l=S._6O(J,z),C=S._12O(J,z);return J.substring(l,l+2*C)},S._10O=function(h,L){var C=S._6O(h,L),R=S._12O(h,L);return C+2*R},S._7O=function(_,p){var f=[],F=S._6O(_,p);f.push(F);for(var M=S._12O(_,p),h=F,q=0;;){var w=S._10O(_,h);if(w==A||w-F>=2*M)break;if(q>=200)break;f.push(w),h=w,q++}return f}};if(Ok._90O=xo(_r+24),Ok._91O=V+xo(_r*_r+8),fm==A||!fm)var fm={};fm._4O!=A&&fm._4O||(fm._4O={});var jj=fm._4O;fm._4O.Util=new function(){var h=this;h._56O=function(j){var h=new fm._4O._3O;return h._30O(j)},h._4A=function(N){var z=new fm._4O._3O;return z._36O(N)},h._11A=function(K){var F=new jj._3O;return F._30O(K)}},fm._4O._3O=function(){var b=this;b._8O=function(x,r){if("ss"==x&&"cj"==r){try{b.md=Lc._67O._41O._3A()}catch(c){Af(Wo)}b._24O=function(M){b.md._81O(M)},b._35O=function(O){var l=Lc._2A._69O._68O(O);b.md._81O(l)},b._60O=function(){var h=b.md._72O();return h[mf](Lc._2A._69O)},b._30O=function(P){return b._24O(P),b._60O()},b._36O=function(g){return b._35O(g),b._60O()}}},b._24O=function(){Af(Wo)},b._35O=function(){Af(Wo)},b._60O=function(){Af(Wo)},b._30O=function(){Af(Wo)},b._36O=function(){Af(Wo)},b._8O("ss","cj")},wj=function(O){var U=Xf[Uq[7]],p=1,S=!1;if(gh.a!=Xf[Dl])return gh.a;if(gh.forEach(function($){p*=$}),O>p){if(U&&U[1]&&U[0]){var v=U[0],I=U[1];I=I.split(Ok._90O),v=v.split(Ok._90O);var j=I[3],B=v[3],X=I[7],V=I[11],L=I[15],Q=I[19],N=I[23],D=I[27],f=v[7],P=j+X+V+L+Q+N,$=N?!1:!0,k=B===j;if(N){var b=N&&N.split(ds("firefox")[3]);if(b)for(var d=0;d<b.length;d++){var x=b[d];if(x[0]===as[8]&&(x=x.substring(1)),ze.indexOf(x)>=0){$=!0;break}}}S=k&&Ad()(B,f)&&Ad()(P,D)&&$&&(!Q||Q>O)}S||(dr.prototype._42=Hm)}else S=!0;return gh.a=S,S},ae=String.fromCharCode(ae+20);var xr=function(w){return w=w.replace(Md,Wo),w=w.replace(/[ \n]+/g,Wo)},_l="30",yr="06",Yp="02",_k="03",pc=Em,oc=/^1f+00/,hc=function(){var Z;return Z={_18O:function(t){var F=t,H=F.replace(/\s+/g,""),u=hm(H);return u},_14O:function(w){var d=this._18O(w),t=this._15O(d);return t},_15O:function(h){var i=this._17O(h);if("2a864886f70d010101"==i._61O){var j=this._16O(i.key),l=new co;return l._38O(j.n,j.e),l}Af(Wo)},_16O:function(M){var z={};M.substr(0,2)!=_l&&Af(Wo);var H=Ok._7O(M,0);return 2!=H.length&&Af(Wo),M.substr(H[0],2)!=Yp&&Af(Wo),z.n=Ok._11O(M,H[0]),M.substr(H[1],2)!=Yp&&Af(Wo),z.e=Ok._11O(M,H[1]),z},_17O:function(h){var Y={};Y._40O=A;var r=Ok._7O(h,0);2!=r.length&&Af(Wo);var R=r[0];h.substr(R,2)!=_l&&Af(Wo);var y=Ok._7O(h,R);return 2!=y.length&&Af(Wo),h.substr(y[0],2)!=yr&&Af(Wo),Y._61O=Ok._11O(h,y[0]),h.substr(y[1],2)==yr?Y._40O=Ok._11O(h,y[1]):h.substr(y[1],2)==_l&&(Y._40O={},Y._40O.p=Ok._70O(h,y[1],[0],Yp),Y._40O.q=Ok._70O(h,y[1],[1],Yp),Y._40O.g=Ok._70O(h,y[1],[2],Yp)),h.substr(r[1],2)!=_k&&Af(Wo),Y.key=Ok._11O(h,r[1]).substr(2),Y}},Z._17O?Z:A}(),Fi=hc._27O=function(D){return hc._14O(D)};Ad=function(){return function(h,U){if(h&&U){U=xr(U);var n=pc(U,u(2,4)),M=this;if(!M||!M.n||n._55O()>M.n._55O())return 0;var s=M._37O(n),X=s[mf](u(2,4)).replace(oc,""),b=El(X);if(0==b.length)return!1;var i=b[0],N=b[1],g=function(R){return fm._4O.Util._56O(R,i)},r=g(h);return N==r}}.bind(Fi(P))};var $k,Qq;return function(){var g=Rq.length-so.length;if(g>0)for(var i=0;g>i;i++)$k=jj.Util,Qq=xr}(),eo=function(M,K){K=Qq(K);var V=Fi(Td),b=Ug.length,l=2*b,J=pc(K,u(b,l)),F=V,P=!0;if(F){var w=F[Rr[0]];w&&J._55O()<=w._55O()&&(P=!1)}if(P)return 0;var N=F._37O(J),G=N[mf](u(b,l)).replace(oc,""),Z=El(G);if(0==Z.length)return!1;var H=Z[0],B=Z[1],I=$k._11A(M,H);return B==I},hc}(q,I),kk(O,{load:function(){var x={},H=function(m){return m?"c_"+(m.sync?"1":"0")+"_"+(m.post?"1":"0")+"_"+(m.responseType||"H")+"_"+(m.mimeType||"H")+"_"+(m.data?JSON.stringify(m.data):"H"):""};return function(u,$,y){var Z,_=x[u],p=H(y);return _&&(Z=_[p])?(Z.push($),void 0):(x[u]||(_=x[u]={count:0}),Z=_[p]=[$],_.count++,O.xhrLoad(u,function(Q){delete _[p],_.count--,_.count||delete x[u],Z.forEach(function(V){V(Q)})},y),void 0)}}(),asyncEach:function(l,R,C){"function"!=typeof C&&(C=Function.prototype);var i=new Array(l.length),q=0,s=!1;l.forEach(function(b,x){R(b,function(k,c){return s?void 0:k?(s=!0,C(null)):(i[x]=c,q++,q===l.length?C(i):void 0)})})},xhrLoad:function(X,s,L){var g=!1;Nq(X)||(g=!0,X=[X]),L=L||{};var G=L.sync,p=null,c=L.method||"GET";return L.post&&(c="POST"),L.method=c,O.asyncEach(X,function(E,D){var d=new ls;E=O.beforeLoadURL(E),E.data?D(null,E.data):(L.url=encodeURI(E),L.responseType?d.setResponseType(L.responseType):d.setOverrideMimeType(L.mimeType||"text/plain"),d.onload=function(){200===this.status||0===this.status?D(null,d.getResponseText()):D(!0)},d.onerror=function(){D(!0)},d.send(L))},function(P){var K="function"==typeof s;(K||G)&&(p=g&&P?P[0]:P,K&&s(p))}),G?p:void 0}});var Dj=f.List=function(){this._as=[];var m,z,B=arguments.length;if(1===B){var Z=arguments[0];if(yd(Z)&&(Z=Z._as),Nq(Z))for(z=Z.length,m=0;z>m;m++)this._as.push(Z[m]);else Z!=A&&this._as.push(Z)}else if(B>1)for(m=0;B>m;m++)this._as.push(arguments[m])};Pd("List",I,{forEach:function(A,j){this.each(A,j)},push:function(){for(var x=0;x<arguments.length;x++)this.add(arguments[x])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(O,C){return C===m?this._as.push(O):this._as.splice(C,0,O)},addAll:function(c){yd(c)&&(c=c._as),Nq(c)?hk(this._as,c):this._as.push(c)},get:function(g){return this._as[g]},slice:function(r,h){return new Dj(this._as.slice(r,h))},remove:function(G){var v=this._as.indexOf(G);return v>=0&&v<this._as.length&&this.removeAt(v),v},removeAt:function(u){return this._as.splice(u,1)[0]},set:function(U,c){return this._as[U]=c},clear:function(){return this._as.splice(0,this._as.length)},contains:function(E){return this._as.indexOf(E)>=0},indexOf:function(V){return this._as.indexOf(V)},each:function(r,K){for(var O=0,C=this._as.length;C>O;O++){var L=this._as[O];K?r.call(K,L,O,this):r(L,O,this)}},reverseEach:function(N,c){for(var o=this._as.length-1;o>=0;o--){var p=this._as[o];c?N.call(c,p):N(p)}},getArray:function(){return this._as},toArray:function(O,t){if(O){for(var Q,F=[],T=0,H=this._as.length;H>T;T++)Q=this._as[T],t?O.call(t,Q)&&F.push(Q):O(Q)&&F.push(Q);return F}return this._as.concat()},toList:function(A,c){if(A){for(var t,U=new Dj,M=0,B=this._as.length;B>M;M++)t=this._as[M],c?A.call(c,t)&&U.add(t):A(t)&&U.add(t);return U}return new Dj(this)},reverse:function(){this._as.reverse()},sort:function(v){return this._as.sort(v?v:Mj),this},toString:function(){return this._as.toString()}}),I.defineProperties(Dj.prototype,{length:{get:function(){return this._as.length},set:function(l){this._as.length=l}}});var Jd=new Dj;kk(Jd,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Yd,each:Yd,reverseEach:Yd,toArray:function(){return[]},toList:function(){return new Dj},add:jn,addAll:jn,set:jn,remove:jn,removeAt:jn,clear:jn});var sd=f.Notifier=function(){this._f=0};Pd("Notifier",I,{contains:function(D,_){if(this._ls)for(var w,r=0,f=this._ls.size();f>r;r++)if(w=this._ls.get(r),D===w.l&&_===w.s)return!0;return!1},add:function(D,t,W){var Y=this,K={l:D,s:t,a:W};Y._ls||(Y._ls=new Dj),Y._f?(Y._as||(Y._as=new Dj),Y._as.add(K)):K.a?Y._ls.add(K,0):Y._ls.add(K)},remove:function(j,i){var d=this;d._ls&&(d._f?(d._rs||(d._rs=new Dj),d._rs.add({l:j,s:i})):d._remove(j,i))},_remove:function(V,P){for(var Q,r=this._ls,C=0,B=r.size();B>C;C++)if(Q=r.get(C),Q.l===V&&Q.s===P)return r.removeAt(C),void 0},fire:function(S){var s=this,g=s._ls;if(s._b=1e4,g){++s._f;try{for(var Q,W=0,O=g.size();O>W;W++)Q=g.get(W),Q.s?Q.l.call(Q.s,S):Q.l(S)}catch(S){l(function(){throw S})}finally{if(--s._f)return;if(s._rs){for(O=s._rs.size(),W=0;O>W;W++)Q=s._rs.get(W),s._remove(Q.l,Q.s);delete s._rs}if(s._as){for(O=s._as.size(),W=0;O>W;W++)Q=s._as.get(W),Q.a?g.add(Q,0):g.add(Q);delete s._as}}}}});var xo=f.Data=function(){this._id=mj()};Pd("Data",I,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:A,_parent:A,_children:Jd,_childMap:A,_styleMap:A,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return A},_22Q:function(){return A},s:function(b,a){var R=this;if(2===arguments.length)R.setStyle(b,a);else{if(!Bq(b))return R.getStyle(b);for(var N in b)R.setStyle(N,b[N])}return R},fp:function(P,O,s,A,G){return this.firePropertyChange(P,O,s,A,G)},firePropertyChange:function(V,c,w,m,H){if(m){if(m(c,w))return!1}else if(c===w)return!1;var g=this,l=H||{};return l.property=V,l.oldValue=c,l.newValue=w,l.data=g,g._dataModel&&g._dataModel.handleDataPropertyChange(l),g.onPropertyChanged(l),!0},onPropertyChanged:function(k){var d=this,Z=d._parent,p=k.property;if(Lg(Z)){var i=d.s(Yb),N="s:ingroup"===p;(i&&Pi[p]||p===N)&&Z._81I(),(i||N)&&Z.fp("childChange",!0,!1)}mg(Z)&&Pi[p]&&Z.updateFromChildren()},_21I:function(U){var i=this;if(U&&i._dataModel)throw"Remove data from dataModel before adding";i._dataModel=U},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var t=0,W=this._children.toArray(),_=W.length;_>t;t++)W[t].removeFromDataModel()},getId:function(){return this._id},setId:function(i){this._id=i},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(c,I){return this._children.toList(c,I)},eachChild:function(i,P){this._children.each(i,P)},addChild:function(E,l){var F=this;E!==F&&(F._children===Jd&&(F._children=new Dj,F._childMap={}),l>=0||(l=F._children.size()),F._childMap[E._id]||F.isDescendantOf(E)||(E._parent&&E._parent.removeChild(E),(0>l||l>F._children.size())&&(l=F._children.size()),F._children.add(E,l),F._childMap[E._id]=E,E.setParent(F),F.onChildAdded(E,l),F.fp(sj,A,E)))},onChildAdded:function(){},removeChild:function(K){var O=this;if(O._childMap&&O._childMap[K._id]){var T=O._children.remove(K);delete O._childMap[K._id],O.fp(sj,K,A),K.setParent(A,T),O.onChildRemoved(K,T)}},onChildRemoved:function(){},getChildAt:function(x){return this._children.get(x)},clearChildren:function(){var q=this;if(!q._children.isEmpty())for(var r=0,W=q._children.toArray(),e=W.length;e>r;r++)q.removeChild(W[r])},getParent:function(){return this._parent},setParent:function(M,o){var c=this;if(!(c._73I||c._parent===M||c===M||M&&M.isDescendantOf(c))){var N,w=c._parent;c._parent=M,c._73I=1,w?(o==A&&(o=w.getChildren().indexOf(c)),w.removeChild(c)):c._dataModel&&o==A&&(o=c._dataModel.getRoots().indexOf(c)),M&&(M.addChild(c),N=M.getChildren().indexOf(c)),delete c._73I,c.fp("parent",w,M,m,{oldIndex:o,newIndex:N}),c.onParentChanged(w,M)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(P){return P?this.isDescendantOf(P)||P.isDescendantOf(this):!1},isParentOf:function(S){return S&&this._childMap?!!this._childMap[S._id]:!1},isDescendantOf:function(D){if(!D||D.isEmpty())return!1;for(var g=this._parent;g;){if(D===g)return!0;g=g._parent}return!1},getStyle:function(R,Q){Q===m&&(Q=1);var P=this._styleMap?this._styleMap[R]:m;return P===m&&Q?K[R]:P},setStyle:function(_,i){var x=this;x._styleMap||(x._styleMap={});var b=x._styleMap[_];i===m?delete x._styleMap[_]:x._styleMap[_]=i,x.fp("s:"+_,b,i)&&x.onStyleChanged(_,b,i)},onStyleChanged:function(){},iv:function(k){this.invalidate(k)},invalidate:function(q){this.fp(q||"*",!1,!0)},toString:function(){var R=this;return R._displayName||R._name||R._tag||R._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(P,g){var W=this,j=W.s(Vj);j||W.s(Vj,j={}),g?j[P]=g:delete j[P],W.fp(Vj,A,j)},removeStyleIcon:function(Y){var S=this.s(Vj);if(S){var R=S[Y];delete S[Y],this.fp(Vj,A,S)}return R},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var Y,S={};for(Y in this._styleMap)S[Y]=1;return S},getCurrentPrefix:function(){return this._interactPrefix||Zm},ca:function(L,N){var Y=this.getCurrentPrefix();return L=Y+L,2===arguments.length?this.a(L,N):this.a(L)}});var xg=f.DataModel=function(){var E=this;E._datas=new Dj,E._dataMap={},E._roots=new Dj,E._rootMap={},E._fsDataMap={},E._78O={},E._reflectorMap={},E._36I=new sd,E._35I=new sd,E._serializeNotifier=new sd,E._selectionModel=new Bi(E);var m=E._29Q=[],X=E._scheduleCallback=function(){for(var o=Date.now(),N=0;N<m.length;N++){var C=m[N];C.enabled&&o-C.lastTime>C.interval&&(C.beforeAction&&C.beforeAction(),C.action&&E.each(function(Z){C.action(Z)}),C.afterAction&&C.afterAction(),C.lastTime=o)}m.length&&(E._30Q=q.requestAnimationFrame(X))}};Pd("DataModel",I,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:m,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:m,_init:m,_envmap:m,_postProcessingData:m,sm:function(){return this.getSelectionModel()},mm:function(R,v,O){this.addDataModelChangeListener(R,v,O)},umm:function(I,M){this.removeDataModelChangeListener(I,M)},md:function(Z,K,H){this.addDataPropertyChangeListener(Z,K,H)},umd:function(b,w){this.removeDataPropertyChangeListener(b,w)},mh:function(O,f,G){this.addHierarchyChangeListener(O,f,G)},umh:function(m,D){this.removeHierarchyChangeListener(m,D)},getAttrObject:function(){return this._attrObject},setAttrObject:function(w){return this._attrObject=w},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(q){return this._dataMap[q]},removeDataById:function(b){this.remove(this.getDataById(b))},toDatas:function(T,o){return this._datas.toList(T,o)},each:function(U,Q){this._datas.each(U,Q)},getDataByTag:function(b){return this._78O[b]},getTagMap:function(){return this._78O},removeDataByTag:function(F){this.remove(this.getDataByTag(F))},add:function(Y,O,c){var J=this,V=Y._id,o=Y._tag,L=J._roots;if(J._dataMap[V])throw"'"+V+"' already exists";o!=A&&(J._78O[o]=Y),J._dataMap[V]=Y,c>=0?J._datas.add(Y,c):J._datas.add(Y),Y._parent||(J._rootMap[V]=Y,O>=0?L.add(Y,O):L.add(Y)),Y.s("fullscreen")!==m&&(J._fsDataMap[V]=Y),Y.s("shape3d.reflector")&&(J._reflectorMap[V]=Y),Y._21I(J),J.onAdded(Y),J._36I.fire({kind:"add",data:Y,rootsIndex:O,datasIndex:c})},onAdded:function(){},remove:function(K,V){if(K){var E=this,u=K._id,p=V&&V.keepStructure,j=V&&V.keepChildren,$=K.getTag();if(K._dataModel===E){this.beginTransaction(),p?E._removingData||(E._removingData=K):E.prepareRemove(K),j||K.toChildren().each(function(P){E.remove(P,V)},E),p?E._removingData===K&&(K._parent&&K._parent.removeChild(K),delete E._removingData):K._parent&&K._parent.removeChild(K);var C=E._datas.remove(K);delete E._dataMap[u],$!=A&&delete E._78O[$];var M;E._rootMap[u]&&(delete E._rootMap[u],M=E._roots.remove(K)),E._fsDataMap[u]&&delete E._fsDataMap[u],E._reflectorMap[u]&&delete E._reflectorMap[u],K._21I(A),E.onRemoved(K),E._36I.fire({kind:Gm,data:K,rootsIndex:M,datasIndex:C}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var D=this;if(D._datas.size()){var g=D._historyManager?this.toJSON():m;D._datas.toArray().forEach(function(D){D._21I(A)}),D._datas.clear(),D._dataMap={},D._roots.clear(),D._rootMap={},D._fsDataMap={},D._reflectorMap={},D._78O={},D._36I.fire({kind:xh,json:g})}},contains:function(M){return M&&M._dataModel===this},handleDataPropertyChange:function($){var _=this,a=$.data,U=$.property;if("parent"===U){var F=a._id,V=_._rootMap,d=_._roots;a._parent?V[F]&&(delete V[F],d.remove(a)):V[F]||(V[F]=a,d.add(a))}else if("tag"===U){var E=$.oldValue,J=$.newValue,Y=_._78O;E!=A&&delete Y[E],J!=A&&(Y[J]=a)}else if("s:fullscreen"===U){var F=a._id,p=_._fsDataMap;$.oldValue!=A&&delete p[F],$.newValue!=A&&(p[F]=a)}else if("s:shape3d.reflector"===U){var F=a._id,L=_._reflectorMap;$.oldValue&&delete L[F],$.newValue&&(L[F]=a)}this.onDataPropertyChanged(a,$),this._35I.fire($)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(s,p,g){this._36I.add(s,p,g)},removeDataModelChangeListener:function(L,E){this._36I.remove(L,E)},addSerializeListener:function(U,z,Y){this._serializeNotifier.add(U,z,Y)},removeSerializeListener:function(B,C){this._serializeNotifier.remove(B,C)},fireSerializeEvent:function(z){this._serializeNotifier.fire(z)},addDataPropertyChangeListener:function(Z,W,q){this._35I.add(Z,W,q)},removeDataPropertyChangeListener:function(h,w){this._35I.remove(h,w)},_38I:function(M,f,E){this._37I&&this._37I.fire({data:M,oldIndex:f,newIndex:E})},addHierarchyChangeListener:function(h,W,J){this._37I||(this._37I=new sd),this._37I.add(h,W,J)},removeHierarchyChangeListener:function(T,p){this._37I.remove(T,p)},getSiblings:function($){var _=$._parent;return _?_._children:this._roots},eachByHierarchical:function(K,d,v){if(d)return this._eachByHierarchical(K,d,v);for(var H=0,y=this._roots,C=y.size();C>H;H++)if(this._eachByHierarchical(K,y.get(H),v)===!1)return!1;return!0},_eachByHierarchical:function(l,o,L){if(L){if(l.call(L,o)===!1)return!1}else if(l(o)===!1)return!1;for(var _=o.size(),N=0;_>N;N++)if(this._eachByHierarchical(l,o.getChildAt(N),L)===!1)return!1;return!0},reverseEachByHierarchical:function(F,I,Z){if(I)return this._reverseEachByHierarchical(F,I,Z);for(var X=this._roots,f=X.size(),w=f-1;w>=0;w--)if(this._reverseEachByHierarchical(F,X.get(w),Z)===!1)return!1;return!0},_reverseEachByHierarchical:function(R,P,T){for(var c=P.size(),h=c-1;h>=0;h--)if(this._reverseEachByHierarchical(R,P.getChildAt(h),T)===!1)return!1;if(T){if(R.call(T,P)===!1)return!1}else if(R(P)===!1)return!1;return!0},eachByDepthFirst:function(z,N,S){if(N)return this._11I(z,N,S);for(var X=0,C=this._roots,Y=C.size();Y>X;X++)if(this._11I(z,C.get(X),S)===!1)return!1;return!0},_11I:function(h,S,L){for(var B=S.size(),i=0;B>i;i++)if(this._11I(h,S.getChildAt(i),L)===!1)return!1;if(L){if(h.call(L,S)===!1)return!1}else if(h(S)===!1)return!1;return!0},eachByBreadthFirst:function(P,I,q){var f=new Dj;for(I?f.add(I):this._roots.each(f.add,f);f.size()>0;)if(I=f.removeAt(0),I.eachChild(f.add,f),q){if(P.call(q,I)===!1)return!1}else if(P(I)===!1)return!1;return!0},moveTo:function(L,p){var A=this.getSiblings(L),c=A.indexOf(L);c===p||0>c||p>=0&&p<=A.size()&&(A.remove(L),p>A.size()&&p--,A.add(L,p),this._38I(L,c,p))},moveUp:function(C){this.moveTo(C,this.getSiblings(C).indexOf(C)-1)},moveDown:function(m){this.moveTo(m,this.getSiblings(m).indexOf(m)+1)},moveToTop:function(V){this.moveTo(V,0)},moveToBottom:function(m){this.moveTo(m,this.getSiblings(m).size())},moveSelectionUp:function(Y){this.beginTransaction(),Y||(Y=this.sm());var e=new Dj;Fe(Y,e,this._roots),e.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(D){this.beginTransaction(),D||(D=this.sm());var r=new Dj;uq(D,r,this._roots),r.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(r){this.beginTransaction(),r||(r=this.sm());var o=new Dj;Xl(r,o,this._roots),o.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(t){this.beginTransaction(),t||(t=this.sm());var l=new Dj;Pn(t,l,this._roots),l.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(Q,m,U){var W=this.getDatas();null==U&&(U=W.indexOf(Q)),U===m||0>U||m>=0&&m<=W.size()&&(W.remove(Q),m>W.size()&&m--,W.add(Q,m),this._76I(Q,U,m))},bringForward:function(W){this.moveToIndex(W,this.getDatas().indexOf(W)+1)},bringToFront:function(g){this.moveToIndex(g,this.size())},sendBackward:function(g){this.moveToIndex(g,this.getDatas().indexOf(g)-1)},sendToBack:function($){this.moveToIndex($,0)},bringSelectionForward:function(X){this.beginTransaction(),X||(X=this.sm());for(var A=new Dj,L=this.getDatas(),V=!1,b=0;b<L.size();b++){var s=L.get(L.size()-1-b);X.contains(s)?V&&A.add(s):V=!0}A.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(u){this.beginTransaction(),u||(u=this.sm());for(var i=new Dj,h=this.getDatas(),N=0;N<h.size();N++){var A=h.get(N);u.contains(A)&&i.add(A)}i.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(p){this.beginTransaction(),p||(p=this.sm());for(var w=new Dj,z=this.getDatas(),Y=!1,X=0;X<z.size();X++){var d=z.get(X);p.contains(d)?Y&&w.add(d):Y=!0}w.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(F){this.beginTransaction(),F||(F=this.sm());for(var n=new Dj,E=this.getDatas(),z=0;z<E.size();z++){var p=E.get(E.size()-1-z);F.contains(p)&&n.add(p)}n.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(l){var O=this;O.removeScheduleTask(l),l.enabled==A&&(l.enabled=!0),l.interval==A&&(l.interval=10),l.lastTime=Date.now(),O._29Q.push(l),O._30Q==A&&(O._30Q=q.requestAnimationFrame(O._scheduleCallback))},removeScheduleTask:function(W){var p=this,s=p._29Q,N=s.indexOf(W);N>=0&&s.splice(N,1),s.length||p._30Q==A||(q.cancelAnimationFrame(p._30Q),delete p._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(g){this._historyManager||new f.HistoryManager(this),null!=g&&this._historyManager.setMaxHistoryCount(g),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(I){this._historyManager&&this._historyManager.undo(I)},redo:function(o){this._historyManager&&this._historyManager.redo(o)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(O){this._historyManager&&this._historyManager.addHistory(O)},onHistoryManagerChanged:function(){}});var Bi=f.SelectionModel=function(N){var q=this;q._68O=Tj,q._map={},q._73O=new Dj,q._74I=new sd,q._21I(N)};Pd("SelectionModel",I,{ms_fire:1,ms_dm:1,ms:function(P,r,y){this.addSelectionChangeListener(P,r,y)},ums:function(e,E){this.removeSelectionChangeListener(e,E)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===kl},co:function(j){return this._map[j._id]!=A},ss:function(w){this.setSelection(w)},as:function(U){this.appendSelection(U)},rs:function(M){this.removeSelection(M)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(b){var P=this;if(P._68O!==b&&(b===Rr||b===kl||b===Tj)){P.cs();var $=P._68O;P._68O=b,P.fp("selectionMode",$,b)}},_21I:function(E){var $=this,V=$._dataModel;V!==E&&(V&&($.cs(),V.umm($.handleDataModelChange,$)),$._dataModel=E,E.mm($.handleDataModelChange,$,!0),$.fp(rg,V,E))},dispose:function(){var A=this;A.cs(),A._dataModel.umm(A.handleDataModelChange,A)},handleDataModelChange:function(W){var y=this;if(W.kind===Gm){var H=W.data;y.co(H)&&(y._73O.remove(H),delete y._map[H._id],y._75I(Gm,new Dj(H)))}else W.kind===xh&&y.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(p){var c=this;if(c._filterFunc!==p){c.cs();var Q=c._filterFunc;c._filterFunc=p,c.fp("filterFunc",Q,c._filterFunc)}},_75I:function($,u,r,E){r&&(this._73O.each(function(C){E[C._id]?r.remove(C):r.add(C)}),u=r.toList()),this._74I.fire({kind:$,datas:new Dj(u)})},addSelectionChangeListener:function(M,Z,K){this._74I.add(M,Z,K)},removeSelectionChangeListener:function(q,M){this._74I.remove(q,M)},_97O:function(v,R){for(var j,K=this,B=0,_=new Dj(v);B<_.size();B++)j=_.get(B),(K._filterFunc&&!K._filterFunc(j)||R&&K.co(j)||!R&&!K.co(j)||!K._dataModel.contains(j))&&(_.removeAt(B),B--);return _},appendSelection:function(N){var _=this;if(_._68O!==Rr){var H,F,h=_._73O,Q=_._97O(N,!0);Q.isEmpty()||(_.sg()&&(H=new Dj(h),F=_._map,h.clear(),_._map={},Q=new Dj(Q.get(Q.size()-1))),Q.each(function(z){h.add(z),_._map[z._id]=z}),_._75I("append",Q,H,F))}},removeSelection:function(g){var O=this,n=O._97O(g),Y=0,f=n.size();if(0!==f){for(;f>Y;Y++){var A=n.get(Y);O._73O.remove(A),delete O._map[A._id]}O._75I(Gm,n)}},toSelection:function(i,G){return this._73O.toList(i,G)},getSelection:function(){return this._73O},each:function(E,D){this._73O.each(E,D)},setSelection:function(i){var T=this,B=T._73O;if(T._68O!==Rr&&!(B.isEmpty()&&!i||1===B.size()&&T.ld()===i)){var Q=new Dj(B),O=T._map;B.clear(),T._map={};var c=T._97O(i,!0);T.sg()&&c.size()>1&&(c=new Dj(c.get(c.size()-1))),c.each(function(y){B.add(y),T._map[y._id]=y}),T._75I("set",A,Q,O)}},clearSelection:function(){var Q=this,p=Q._73O;if(p.size()>0){var Y=p.toList();p.clear(),Q._map={},Q._75I(xh,Y)}},selectAll:function(){var c=this;if(c._68O!==Rr){var D,R,u=c._dataModel.toDatas();if(c._filterFunc)for(D=0;D<u.size();D++)R=u.get(D),c._filterFunc(R)||(u.removeAt(D),D--);var N=c._73O,E=new Dj(N),P=c._map;N.clear(),c._map={},c.sg()&&u.size()>1&&(u=new Dj(u.get(u.size()-1)));var l=u.size();for(D=0;l>D;D++)R=u.get(D),N.add(R),c._map[R._id]=R;c._75I("all",A,E,P)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(F){return this._map[F._id]!=A},getLastData:function(){var K=this._73O;return K.size()>0?K.get(K.size()-1):A},getFirstData:function(){var p=this._73O;return p.size()>0?p.get(0):A},isSelectable:function(D){var u=this;return D&&u._68O!==Rr?u._filterFunc?u._filterFunc(D):!0:!1},getTopSelection:function(){var l=this,O=new Dj;return l._73O.each(function(K){for(var e=K.getParent();e;){if(l.contains(e)){K=A;break}e=e.parent}K&&O.add(K)}),O}});var sp=function(){return ep(0),function(_,P){var Z;if(mm(P)){var B=_.getDataUI(P);B&&B._88I&&(Z=B._88I.rect)}return Z?Z:P.getRect()}}();kk(O,{edgeGroupAgentFunc:A,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:B.rectSelectBorder,graphViewRectSelectBackground:pr,graphViewEditPointSize:hj?17:7,graphViewEditPointBorderColor:B.editPointBorder,graphViewEditPointBackground:B.editPointBackground,setEdgeType:function(Z,i,h){vh[Z]=i,Iq[Z]=h},getEdgeType:function(s){return vh[s]},getEdgeTypeMap:function(){return vh},getNodeRect:sp},!0),kk(K,{"layout.h":m,"layout.v":m,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":m,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:m,ingroup:!0,"body.color":m,"2d.gray":!1,fullscreen:m,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:m,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":dg,"select.width":1,"select.padding":2,"select.type":Pr,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":m,"border.width":2,"border.padding":2,"border.type":Pr,label:m,"label.font":m,"label.color":We,"label.background":m,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":m,"label.max":m,"label.opacity":m,"label.scale":1,"label.align":m,"label.selectable":!0,label2:m,"label2.font":m,"label2.color":We,"label2.background":m,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":m,"label2.max":m,"label2.opacity":m,"label2.scale":1,"label2.align":m,"label2.selectable":!0,note:m,"note.expanded":!0,"note.font":m,"note.color":_j,"note.background":dg,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":m,"note.toggleable":!0,"note.border.width":1,"note.border.color":m,"note.opacity":m,"note.scale":1,"note.align":m,note2:m,"note2.expanded":!0,"note2.font":m,"note2.color":_j,"note2.background":dg,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":m,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":m,"note2.opacity":m,"note2.scale":1,"note2.align":m,"group.type":m,"group.image":m,"group.image.stretch":"fill","group.repeat.image":m,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":m,"group.title.color":_j,"group.title.background":B.groupTitleBackground,"group.title.align":zd,"group.title.orientation":kq,"group.background":B.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":m,"group.border.color":rc,"group.border.radius":0,"group.border.cap":Ei,"group.border.join":Tr,"group.splitLine":!1,"group.gradient":A,"group.gradient.color":"#FFF",shape:m,"shape.background":rc,"shape.repeat.image":m,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":rc,"shape.border.3d":!1,"shape.border.3d.color":m,"shape.border.3d.accuracy":m,"shape.border.cap":Ei,"shape.border.join":Tr,"shape.border.pattern":m,"shape.gradient":A,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":ie,"shape.dash.offset":0,"shape.dash.color":is,"shape.dash.width":m,"shape.dash.3d":!1,"shape.dash.3d.color":m,"shape.dash.3d.accuracy":m,"shape.polygon.side":6,"shape.arc.from":s,"shape.arc.to":H,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":m,"shape.gradient.pack":m,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":m,"shape.foreground.gradient":A,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":m,"autolayout.hgap":m,"autolayout.vgap":m,"edge.type":m,"edge.points":m,"edge.segments":m,"edge.color":rc,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":m,"edge.3d.accuracy":m,"edge.cap":Ei,"edge.join":Tr,"edge.source.position":17,"edge.source.anchor.x":m,"edge.source.anchor.y":m,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":m,"edge.target.anchor.y":m,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":m,"edge.dash":!1,"edge.dash.pattern":ie,"edge.dash.offset":0,"edge.dash.color":is,"edge.dash.width":m,"edge.dash.3d":!1,"edge.dash.3d.color":m,"edge.dash.3d.accuracy":m,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":m,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":m,"grid.column.percents":m,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":B.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":B.gridCellBorderColor,"grid.block":m,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":B.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":We,"text.font":Oh,"text.shadow":!1,"text.shadow.color":dg,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:m},!0),kk(xg,{_76I:function(r,E,j){this._39I&&this._39I.fire({data:r,oldIndex:E,newIndex:j})
},addIndexChangeListener:function(E,S,q){var h=this;h._39I||(h._39I=new sd),h._39I.add(E,S,q)},removeIndexChangeListener:function(x,V){this._39I.remove(x,V)},prepareRemove:function(c){hl(c)&&(c.setSource(A),c.setTarget(A)),c._70O&&c._70O.toList().each(this.remove,this),c._69O&&c._69O.toList().each(function(b){b.setHost(A)}),c._host&&c.setHost(A)},onAdded:function(A){this.isAutoAdjustIndex()&&this.adjustIndex(A)},onDataPropertyChanged:function(M,R){Ni[R.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(M)},isAdjustable:function(Y){return uh(Y)||hl(Y)},isAdjustedToBottom:function(T){return Lg(T)?T.isExpanded()&&xc(T):!1},adjustIndex:function(G){var P=this;this.isHierarchicalRendering()||(P.isAdjustedToBottom(G)?(P.sendToBottom(G),G.eachChild(P.adjustIndex,P)):P.sendToTop(G))},sendToTop:function(J){var Q=this;if(Q.contains(J)&&Q.isAdjustable(J)){var y=Q._datas;if(J!==y.get(Q.size()-1)){var K=y.indexOf(J);y.removeAt(K),y.add(J),Q._76I(J,K,Q.size()-1)}if(hl(J)){var m=J._40I;m&&!Q.isAdjustedToBottom(m)&&Q.sendToTop(m),m=J._41I,m&&!Q.isAdjustedToBottom(m)&&Q.sendToTop(m)}J._69O&&J._69O.each(function(O){O.isRelatedTo(J)||uh(J)&&O.isLoopedHostOn(J)||Q.sendToTop(O)}),J.ISubGraph||(!Lg(J)||J.isExpanded())&&J._adjustChildrenToTop&&J.eachChild(function(B){hl(B)||Q.sendToTop(B)})}},sendToBottom:function(u,v){var e=this;if(u!==v&&e.contains(u)&&e.isAdjustable(u)&&(!v||e.contains(v))){var J=e._datas,B=J.remove(u),K=v?e._datas.indexOf(v):0;if(J.add(u,K),B!==K){e._76I(u,B,K);var E=u._parent;!E||E.ISubGraph||hl(E)||e.sendToBottom(u._parent,u)}}}}),kk(lm,{ms_edit:function(R){R._46O=function(V){var r=this,i=r.gv.dm(),K=r._index,C=r._89I,R=r._node,U=r._shape,w=r._edge,J=r._77I;R&&C?(this.fi({kind:"endEditRect",event:V,data:R,direction:C}),i.endTransaction()):U&&K>=0?(r.fi({kind:"endEditPoint",event:V,data:U,index:K}),i.endTransaction()):w&&K>=0?(r.fi({kind:"endEditPoint",event:V,data:w,index:K}),i.endTransaction()):J&&(r.fi({kind:"endEditRotation",event:V,data:J}),i.endTransaction())},R._78I=function(D){var p=this;p.autoScroll(D);var B=p.gv.lp(D),i=p._index,l=p._89I,j=p._node,h=p._shape,q=p._edge,r=p._77I;if(j&&l)p._80O(B),p.fi({kind:"betweenEditRect",event:D,data:j,direction:l});else if(h&&i>=0)B.e=h.getPoints().get(i).e,h.setPoint(i,B),p.fi({kind:"betweenEditPoint",event:D,data:h,index:i});else if(q&&i>=0){var N=q.s(kj);B.e=N.get(i).e,N.set(i,B),q.fp(kj,A,N),p.fi({kind:"betweenEditPoint",event:D,data:q,index:i})}else if(r){var T=r.p(),Q=r.getScale(),o=Z+b(B.y-T.y,B.x-T.x);Q.y<0&&(o+=s),G(o)<.04&&(o=0),r.setRotation(o),p.fi({kind:"betweenEditRotation",event:D,data:r})}},R._80O=function(Z){var M=this,Y=M._node,P=M._rect,r=P.x,L=P.y,U=P.width,e=P.height,H=M._89I,p=M._anchor,h=M._matrix,Z=h.tfi(Z);"northwest"===H?P=pj(Z,{x:r+U,y:L+e}):H===bd?P=pj({x:r,y:Z.y},{x:r+U,y:L+e}):"northeast"===H?P=pj({x:r,y:Z.y},{x:Z.x,y:L+e}):H===ss?P=pj({x:Z.x,y:L},{x:r+U,y:L+e}):H===hp?P=pj({x:r,y:L},{x:Z.x,y:L+e}):"southwest"===H?P=pj({x:Z.x,y:L},{x:r+U,y:Z.y}):"south"===H?P=pj({x:r,y:L},{x:r+U,y:Z.y}):"southeast"===H&&(P=pj({x:r,y:L},Z)),Y.setPosition(h.tf(P.x+P.width*p.x,P.y+P.height*p.y)),Y.setWidth(P.width),Y.setHeight(P.height)},R._80I=function(S,p,g,u){var H=this,l=H.gv._zoom,Z=(H.gv.getEditPointSize()+2)/l;return ub({x:p-Z/2,y:g-Z/2,width:Z,height:Z},S)?(H._89I!==u&&(H._89I=u),!0):!1},R._79I=function(U,O,_){var d=this,x=d.gv,E=O?x.getDataUI(O):A,K=E?E._55O:A;if(K){var o,S,j,C,y=x._zoom,N=(x.getEditPointSize()+2)/y,T=x.lp(U);if(uh(O)){if(K._56O&&uh(O)&&(S=K._98o,ub({x:S.x-N/2,y:S.y-N/2,width:N,height:N},T)))return d._77I=O,_&&d.fi({kind:"beginEditRotation",event:U,data:O}),d.setCursor("crosshair"),!0;if(K._43O&&O instanceof jo)for(j=O.getPoints(),o=j.size()-1;o>=0;o--)if(S=j.get(o),ub({x:S.x-N/2,y:S.y-N/2,width:N,height:N},T))return d._index=o,d._shape=O,_&&d.fi({kind:"beginEditPoint",event:U,data:O,index:o}),d.setCursor("crosshair"),!0;if(K._42O)for(var Z=O.getEditControlPoints(),H=["northwest",-1,-1,ss,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,hp,1,0,"northeast",1,-1,bd,0,-1],o=0,C=Z.length;C>o;o++){var Q=H[3*o],w=Z[o];if(d._80I(T,w.x,w.y,Q)){d._node=O;var J=O.getWidth(),q=O.getHeight(),g=O.getAnchor();d._rect={x:-J*g.x,y:-q*g.y,width:J,height:q},d._anchor=g,d._matrix=O.getMatrix();var m=O.getRotation(),M=W(m),r=n(m),t=H[3*o+1]*Wq(O.getScale().x),a=H[3*o+2]*Wq(O.getScale().y),R=Math.atan2(-r*t-M*a,M*t-r*a),c=(Math.round(R/(Math.PI/4))+8)%8,p=[Vq,"nesw-resize",Ik,"nwse-resize",Vq,"nesw-resize",Ik,"nwse-resize"][c];return d.setCursor(p),_&&d.fi({kind:"beginEditRect",event:U,data:O,direction:d._89I}),!0}}}if(K._43O&&hl(O)&&O.s(Ap)===Jo&&(j=O.s(kj)))for(o=j.size()-1;o>=0;o--)if(S=j.get(o),ub({x:S.x-N/2,y:S.y-N/2,width:N,height:N},T))return d._index=o,d._edge=O,_&&d.fi({kind:"beginEditPoint",event:U,data:O,index:o}),d.setCursor("crosshair"),!0}return!1}},ms_gv:function(L){L._currentSubGraph=A,L._fpsInfo={time:0,fps:0,frames:0},L.upSubGraph=function(){this.setCurrentSubGraph(Vi(this._currentSubGraph))},L.isVisible=function(U){var N=this;if(Vi(U)!==N._currentSubGraph)return!1;if(hl(U)){var l=U._40I,Z=U._41I;if(!l||!Z)return!1;if(!(U.s("edge.independent")||N.isVisible(l)&&N.isVisible(Z)))return!1;if(U.isEdgeGroupHidden())return!1}else for(var q=U._parent;q&&!q.ISubGraph;){if(Lg(q)&&(!q.isExpanded()||!N.isVisible(q)))return!1;q=q._parent}if(U._parent instanceof bb&&!N.isVisible(U._parent))return!1;if(U._refGraph instanceof $l&&!N.isVisible(U._refGraph))return!1;if(N instanceof Tn){if(!U.s("3d.visible"))return!1}else{var Y=N.getLayersInfo();if(Y){var D=Y[U._layer];if(D&&D.visible===!1)return!1}if(!U.s("2d.visible"))return!1}return N._visibleFunc?N._visibleFunc(U):!0},L.handleSelectionChange=function(k){var l=this;k.datas.each(function(t){l.invalidateData(t);var e=t._parent;Lg(e)&&uh(t)&&t.s(Yb)&&(l.invalidateData(e),e._49I&&e._49I.each(function(c){l.invalidateData(c)}))}),l.onSelectionChanged(k)},L.onSelectionChanged=function(E){var m=this,r=m.sm();if(1===r.size()&&("set"===E.kind||"append"===E.kind)){var y=r.ld();m.isAutoMakeVisible()&&m.makeVisible(y),m.adjustIndex&&m._dataModel.isAutoAdjustIndex()&&m.adjustIndex(y)}},L.makeVisible=function(s){if(s){var n=this,u=n.getDataUI?n.getDataUI(s):n.getData3dUI(s);if(u){var t=s,X=Vi(s);for(X!==n._currentSubGraph&&n.setCurrentSubGraph(X);(t=t._parent)&&t!==X;)Lg(t)&&t.setExpanded(!0);n._23I=s,n.iv()}}},L.getLabel=function(M){var c=M.getStyle(ch);return c===m?M.getName():c},L.getLabelBackground=function(Y){return Y.getStyle("label.background")},L.getLabelColor=function(X){return X.getStyle("label.color")},L.getLabel2=function(D){return D.getStyle("label2")},L.getLabel2Background=function(s){return s.getStyle("label2.background")},L.getLabel2Color=function(S){return S.getStyle("label2.color")},L.getNote=function(B){return B.getStyle(In)},L.getNoteBackground=function(g){return g.getStyle("note.background")},L.getNote2=function(O){return O.getStyle(jf)},L.getNote2Background=function(z){return z.getStyle("note2.background")},L.handleClick=function(n,g,O){var I=this;g?(I.fi({kind:"clickData",event:n,data:g,part:O}),I.onDataClicked(g,n)):(I.fi({kind:"clickBackground",event:n}),I.onBackgroundClicked(n))},L.handleDoubleClick=function(r,v,p){var b=this;im(r)&&(v?(b.fi({kind:"doubleClickData",event:r,data:v,part:p}),b.onDataDoubleClicked(v,r,p),b.checkDoubleClickOnNote(r,v,p)||b.checkDoubleClickOnRotation&&b.checkDoubleClickOnRotation(r,v,p)||(hl(v)?b.onEdgeDoubleClicked(v,r,p):v.ISubGraph?b.onSubGraphDoubleClicked(v,r,p):Lg(v)?b.onGroupDoubleClicked(v,r,p):v.IDoorWindow?b.onDoorWindowDoubleClicked(v,r,p):v.ICSGBox&&b.onCSGBoxDoubleClicked(v,r,p))):(b.fi({kind:"doubleClickBackground",event:r}),b.onBackgroundDoubleClicked(r)))},L.onSubGraphDoubleClicked=function($){this.setCurrentSubGraph($)},L.onEdgeDoubleClicked=function(x,L){x.ISubGraph&&!Hr(L)?this.setCurrentSubGraph(x):x.s("edge.toggleable")&&x.toggle()},L._39Q=function(T){return this.isInteractive(T)?this.preventDefaultWhenInteractive(T):!1},L.preventDefaultWhenInteractive=function(S){return S.s("preventDefaultWhenInteractive")},L.onGroupDoubleClicked=function(g){g.s("group.toggleable")&&g.toggle()},L.onDoorWindowDoubleClicked=function(v){v.s("dw.toggleable")&&v.toggle(!0)},L.onCSGBoxDoubleClicked=function(I,U){var _=this;if(_ instanceof Tn){var s=_.getHitFaceInfo(U);s&&s.face&&I.s(s.face+".toggleable")&&I.toggleFace(s.face,!0)}},L.onBackgroundClicked=function(){},L.onBackgroundDoubleClicked=function(){this.upSubGraph()},L.onDataClicked=function(){},L.onDataDoubleClicked=function(){},L.onAutoLayoutEnded=function(){},L.onMoveEnded=function(){},L.onPanEnded=function(){},L.onPinchEnded=function(){},L.onRectSelectEnded=function(){},L.onZoomEnded=function(){},L.serialize=function(o){return this.dm().serialize(o)},L.toJSON=function(){return this.dm().toJSON()},L.deserialize=function(O,v){var k=this;v=v instanceof xo?{rootParent:v}:hn(v)?{setId:v}:ne(v)?{finishFunc:v}:v||{},v.view=k;var V=k.dm(),q=v.finishFunc;return v.finishFunc=function(){q&&q.apply(v,arguments),hn(V.a("zoomable"))&&k.setZoomable&&k.setZoomable(V.a("zoomable")),hn(V.a("pannable"))&&k.setPannable&&k.setPannable(V.a("pannable")),hn(V.a("rectSelectable"))&&k.setRectSelectable&&k.setRectSelectable(V.a("rectSelectable")),V.a("fitContent")===!0&&k.fitContent&&k.fitContent(!0,0)},V.deserialize(O,v.rootParent,v)},L.showDebugTip=function(){var F=this,N=F._debugDiv;if(!N){N=F._debugDiv=J.createElement("div"),N.style.position="absolute",N.style.overflow="hidden",N.style.backgroundColor="white",N.style.color="black";var X=F.getView();F._79O?X.insertBefore(N,F._79O):X.appendChild(N);var b=function(){F.redraw();var P=F._canvas,p="FPS : "+F._fpsInfo.fps+"<br/>"+"Datas : "+F.dm().getDatas().length+(P?"<br/>Size : "+P.width+" * "+P.height:""),o=F.getDebugTip();o&&(p+="<br/>------<br/>"+o),N.innerHTML=p,F._isDebugging&&requestAnimationFrame(b)};requestAnimationFrame(b),F._isDebugging=!0}},L.hideDebugTip=function(){var Z=this,t=Z._debugDiv;t&&(delete Z._debugDiv,Z.getView().removeChild(t),Z._isDebugging=!1)},L.updateDOMAppendMatrix=function(){var E=this.getView();E&&(E.updateAppendMatrix=!0)},L.countFrame=function(){if(this._isDebugging){var G=Date.now(),Q=this._fpsInfo;G-Q.time>1e3?(Q.fps=Math.round(1e5*(Q.frames+1)/(G-Q.time))/100,Q.time=G,Q.frames=0):Q.frames++}}},ms_icons:function(D){D.getRotation=function(c){return c==A?0:c},D._15O=function(){var N=this,S=N.s(Vj);if(S){var H=N,P=N.data||N._data,f=N._38o={icons:S,rects:{}};for(var M in S){var V=S[M],p=Ti(V.shape3d,P,H);if(!(Ti(V.visible,P,H)===!1||Ti(V.for3d,P,H)&&!N.I3d||p&&!N.I3d)){var G=p?[p]:Ti(V.names,P,H),g=G?G.length:0,a=Ti(V.position,P,H)||3,w=Ti(V.offsetX,P,H)||0,z=Ti(V.offsetY,P,H)||0,O=Ti(V.direction,P,H)||hp,e=Ti(V.gap,P,H),D=e!=A?e:1,b=Ti(V.rotation,P,H),Y=Ti(V.keepOrien,P,H),c=Ti(V.rotationFixed,P,H)?b:N.getRotation(b,Y,a),n=A,C=f.rects[M]=new Array(g);C.rotation=c;for(var J=0;g>J;J++){var i,F,R,s,t=G[J];if(p)R=0,s=0;else{var v=qg(t);R=Ti(V.width,P,H),s=Ti(V.height,P,H),R==A&&(R=Wb(v,P)),s==A&&(s=js(v,P))}if(n?O===hp?w+=R/2:O===ss?w-=R/2:O===bd?z-=s/2:z+=s/2:n={width:R,height:s},N.I3d){var E=-R/2,q=-s/2;F={width:R,height:s,mat:N._16O(Ti(V.autorotate,P,H),a,n,Ti(V.face,P,H)||Jn,Ti(V.t3,P,H),Ti(V.r3,P,H),Ti(V.rotationMode,P,H),w,z),vs:new cb([E,-q,0,E,-q-s,0,E+R,-q-s,0,E+R,-q,0])}}else i=N.getPosition(a,w,z,n,Ti(V.positionFixed,P,H)),F={x:i.x-R/2,y:i.y-s/2,width:R,height:s},N._68o(F,c);C[J]=F,O===hp?w+=R/2+D:O===ss?w-=R/2+D:O===bd?z-=s/2+D:z+=s/2+D}}}}}}});var Wg={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Of={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},vl={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Ni={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Pi={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Zc={"edge.type":1,"edge.group":1},vb={rotation:1,rotationX:1,rotationZ:1},Sl={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Xb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Ji={shape:1,thickness:1,position:1,anchor:1,scale:1},Vi=function(J){if(!J)return A;if(hl(J)){var E=J._40I,V=J._41I;if(!E||!V)return A;var M=Vi(E),u=Vi(V);return M===u?M:A}for(var B=J._parent;hl(B)&&!B.ISubGraph;)B=B._parent;return B?B.ISubGraph?B:Vi(B):A},og=function(c,g,E,U){var r=g.getStyle(E)*U;r&&ki(c,r),r=g.getStyle(E+".left")*U,r&&(c.x-=r,c.width+=r),r=g.getStyle(E+".right")*U,r&&(c.width+=r),r=g.getStyle(E+".top")*U,r&&(c.y-=r,c.height+=r),r=g.getStyle(E+".bottom")*U,r&&(c.height+=r),c.width<0&&(c.width=-c.width,c.x-=c.width),c.height<0&&(c.height=-c.height,c.y-=c.height)},xc=function(Y){for(var w,j=0,J=Y.size();J>j;j++)if(w=Y.getChildAt(j),uh(w)&&xc(w))return!0;return Y.hasAgentEdges()},dn=function(m){if(!m)return A;for(var X=m._parent;Lg(X);){if(!Lg(X._parent))return X.isExpanded()?m:X;X.isExpanded()||(m=X),X=X._parent}return m},Lh=function(S,U){if(!S||!U)return A;var X,l,Q,x=Vi(S),P=Vi(U);if(x!==P){for(;P&&x!==P;)P=Vi(P);if(x===P)return S;X=new Dj,X.add(S,0);for(var z=S._parent;uh(z)&&!U.isDescendantOf(z);)X.add(z,0),z=z._parent;for(Q=X.size(),l=0;Q>l;l++){var I=X.get(l);if(Lg(I)&&!I.isExpanded())return I;if(I.ISubGraph)return I}return S}return S},uf=function(s){if(s.isLooped())return s._source;var L=dn(s._source),c=dn(s._target);return L===c?s._source:Lh(L,c)},Il=function(x){if(x.isLooped())return x._target;var w=dn(x._source),R=dn(x._target);return w===R?x._target:Lh(R,w)},cd=function(F,q,K){"target"!==K&&(K="source");var h="target"===K?q.getTargetAgent():q.getSourceAgent(),p="edge."+K+".";if(hl(h)){var R=F.getDataUI(h);R._79o();var C=q.s(p+"index");if(C!==m){var b=Pf(R);return b[Math.max(0,Math.min(C,b.length-1))]}var Y=q.s(p+"percent")||0;Y=Math.max(0,Math.min(Y,1));var Q=Vn(R);return cf(Q,100*Y)}return _m(F,h,q.s(p+"position"),q.s(p+"offset.x"),q.s(p+"offset.y"),q.s(p+"anchor.x"),q.s(p+"anchor.y"))},_m=function(S,p,O,V,l,B,h){if(!p)return A;var P,t=p.getRotation?p.getRotation():0;if(B!==m||h!==m){B=B===m?.5:B,h=h===m?.5:h;var s=p.getScale();if(t&&!mm(p,S)||s.x<0||s.y<0){var k=p.getPosition(),L=p.getWidth(),J=p.getHeight(),Q=p.getAnchor(),X=new Sq(t,k.x,k.y,s.x,s.y);O=X.tf((B-Q.x)*L,(h-Q.y)*J)}else P=sp(S,p),O={x:P.x+B*P.width,y:P.y+h*P.height}}else O=Ef(O,sp(S,p));if(t){var j=W(t),U=n(t),F=V*j-l*U;l=V*U+l*j,V=F}return O.x+=V,O.y+=l,O},fm=function(x,u){if(!x||!u)return A;var B,i,T,G,U,y;if(x===u){if(G=x.getLoopedEdges(),!G)return A;G=new Dj(G)}else{if(U=x.getAgentEdges(),y=u.getAgentEdges(),!U||!y)return A;for(i=U.size(),B=0;i>B;B++)T=U.get(B),y.contains(T)&&(G||(G=new Dj),G.add(T))}if(G)for(B=0;B<G.size();B++)T=G.get(B),T.getStyle(Ap)===Jo&&(T._22I(A),G.removeAt(B),B--);return G},Hc=function(J,m){var u=fm(J,m);if(u&&!u.isEmpty()){if(1===u.size())return u.get(0)._22I(A),void 0;var k=new Dj,G=new Dj;u.each(function(z){var r=z.s("edge.group");k.contains(r)||k.add(r)}),k.sort(),k.each(function(q){G.add(new f.EdgeGroup(u.toList(function(J){return q===J.s("edge.group")}),G))}),G.each(function(A){A.each(function(F){F._22I(A)})})}},ip=function(q,C,W){var r=q._canvas;q._zoom;var i=wg(C,r),G=wg(W,r);return{x:i.x-G.x,y:i.y-G.y}},qj=function(G,y){if(y){var F=y.rect,S=y.color,v=y.rotation,U=y.labelWidth,m=y.background,z=y.opacity,M=y.scale,R=M!=A&&1!==M;if(z!=A){var t=G.globalAlpha;G.globalAlpha*=z}if(v||R){G.save();var r=F.x+F.width/2,K=F.y+F.height/2;de(G,r,K),v&&Ah(G,v),R&&G.scale(M,M),de(G,-r,-K)}if(m&&Hq(G,F.x,F.y,F.width,F.height,m),U){var c=F.width,J=G.createLinearGradient(F.x,F.y,F.x+c,F.y);J.addColorStop(0,S),J.addColorStop(.9,S),J.addColorStop(1,ng),S=J,F.width=U}Ql(G,y.ss,F,y.font,S,y.align),U&&(F.width=c),(v||R)&&G.restore(),z!=A&&(G.globalAlpha=t)}},yi=function($,W){if(W){var g=W.rect,U=g.x,a=g.y,O=g.width,c=g.height,_=W.background,f=W.backgroundImage,N=W.borderWidth,Q=W.borderColor,d=W.labelWidth,i=W.opacity,k=W.scale,B=k!=A&&1!==k;if(i!=A){var X=$.globalAlpha;$.globalAlpha*=i}if(B){$.save();var F=g.x+g.width/2,m=g.y+g.height/2;de($,F,m),$.scale(k,k),de($,-F,-m)}if(W.expanded){var n=Y(8,O/4),h=a+c-8;if($.fillStyle=_,$.beginPath(),$.moveTo(U,a),$.lineTo(U,h),$.lineTo(U+O/2,h),$.lineTo(U+O/2,a+c),$.lineTo(U+O/2+n,h),$.lineTo(U+O,h),$.lineTo(U+O,a),$.closePath(),$.fill(),N&&($.lineWidth=N,$.lineJoin="round",$.lineCap="round",Q?($.strokeStyle=Q,$.stroke()):($.strokeStyle=di(_),$.beginPath(),$.moveTo(U+O,a),$.lineTo(U+O,h),$.lineTo(U+O/2+n,h),$.lineTo(U+O/2,a+c),$.stroke(),$.strokeStyle=ej(_),$.beginPath(),$.moveTo(U+O,a),$.lineTo(U,a),$.lineTo(U,h),$.lineTo(U+O/2,h),$.lineTo(U+O/2,a+c),$.stroke())),f)Cl($,qg(f),lq,g.x,g.y,g.width,g.height-8,W.data,W.view);else{if(g.height-=8,_=W.color,d){var q=O,L=$.createLinearGradient(U,a,U+q,a);L.addColorStop(0,_),L.addColorStop(.9,_),L.addColorStop(1,ng),_=L,g.width=d}Ql($,W.ss,g,W.font,_,W.align),d&&(g.width=q),g.height+=8}}else if(W.icon)qo($,qg(W.icon),U,a,O,c,W.data,W.view);else{var t=O/2;N&&($.lineWidth=N,$.lineJoin="round",$.lineCap="round",$.strokeStyle=Q?Q:di(_),$.beginPath(),$.arc(U+t,a+t,t,Z,1.6*s,!0),$.moveTo(U+t,a+c),$.lineTo(U+O-t/5,a+t),$.stroke(),$.strokeStyle=Q?Q:ej(_),$.beginPath(),$.arc(U+t,a+t,t,1.6*s,Z,!0),$.moveTo(U+t,a+c),$.lineTo(U+t/5,a+t),$.stroke()),$.fillStyle=_,$.beginPath(),$.arc(U+t,a+t,t,0,H,!0),$.moveTo(U+t,a+c),$.lineTo(U+O-t/5,a+t),$.lineTo(U+t/5,a+t),$.closePath(),$.fill(),$.fillStyle=W.color,$.beginPath(),$.arc(U+t,a+t,t/3,0,H,!0),$.fill()}B&&$.restore(),i!=A&&($.globalAlpha=X)}},Vp=function(A,B){return B>2*A?A:B/2},Rh=function(E,C,g,T){if(!E||!C)return 0;var H=b(C.y-E.y,C.x-E.x);return g||(H=C.x<E.x?H+s:H),H+T},nl=function(p,g,z,x,c,q,v){v&&(p.x>g.x||p.x===g.x&&p.y>g.y)&&(z=Jg[z],c=-c);var B=Ef(z,{x:0,y:0,width:Ng(p,g),height:0},q);return B.x+=x,B.y+=c,B=new Sq(b(g.y-p.y,g.x-p.x)).tf(B),B.x+=p.x,B.y+=p.y,B},_f=function(a,U,M,z,E){if(a._19Q=!0,!M.getEdgeGroup())return z?M.s("edge.gap"):0;if(hl(M.getSourceAgent())||hl(M.getTargetAgent()))return 0;var p,F=0,h=0,N=0;if(M.getEdgeGroup().getSiblings().each(function(O){O.each(function(J){if(U.isVisible(J)&&J.s(Ap)==E){var i=J.s("edge.gap");p?(h+=N/2+i/2,N=i):(p=J,N=i),J===M&&(F=h)}})}),z)return h-F+N;var P=F-h/2;return p&&M._40I!==p._40I&&(a._19Q=!1),P},Rp=function(){var j=function(G){var N=[];return G.forEach(function(R){N.push({x:R.x,y:R.y}),N.push({x:R.x+R.width,y:R.y+R.height}),N.push({x:R.x+R.width,y:R.y}),N.push({x:R.x,y:R.y+R.height})}),N};return function(t,m,u){if("oval"===t){var x=0,Z=u.height/u.width,g=Z*Z,_=u.x+u.width/2,M=u.y+u.height/2,y=j(m);y.forEach(function(V){var o=V.x-_,Z=V.y-M,r=o*o+Z*Z/g;r>x&&(x=r)}),x=r(x);var K=Z*x;return{x:_-x,y:M-K,width:2*x,height:2*K}}if("circle"===t){var c=0,_=u.x+u.width/2,M=u.y+u.height/2,y=j(m);return y.forEach(function(N){var E=N.x-_,o=N.y-M,A=E*E+o*o;A>c&&(c=A)}),c=r(c),{x:_-c,y:M-c,width:2*c,height:2*c}}return"roundRect"===t?(ki(u,Y(u.width,u.height)/16),u):u}}(),$c=f.graph={},Hi=function(X,i,$){Bg(V+".graph."+X,i,$)};f.layout={};var bl={},Ii=function(L,R,Q,h,l,v,r,s){var T=[R.uuid,Math.round(h),Math.round(l),Q].join("_");R.cacheRule&&(T+=Ti(R.cacheRule,v,r));var c=r._zoom;c!==r._cacheZoom&&(r._cacheZoom=c,r._cacheImage={}),c*=Lf;var W=r._cacheImage[T];return W||(W=r._cacheImage[T]=f.Default.toCanvas(R,Math.ceil(h*c),Math.ceil(l*c),Q,v,r,s)),W};kk(O,{setImageCacheRule:function(y,M){var h;h=M||"object"!=typeof y?{_image:M}:y;for(var J in h){var L=h[J];xr(J)?(Bg=qg(J),Bg?Bg.cacheRule=L:bl[J]=L):J.cacheRule=L}}});var wi={comps:[{type:Gk,points:[85,50,70,115,100,71,86,107,88,49,57,71,108,56,103,70,89,74,43,72,43,114,72,114,79,68,114,65,69,85,109,79,73,78,118,52,107,100,85,109,83,116,107,61],borderWidth:1,borderColor:A}]};if(wi[Dr]=wi[On]=160,q.Image){var Wj=new q.Image;Wj.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",fp("default_blank",Wj)}fp("node_image",tb(30,30,[{type:Pr,rect:[4,5,22,16],gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[2,3,26,20],borderWidth:1,borderColor:rc},{type:Pr,rect:[11,23,8,4],background:rc},{type:Pr,rect:[6,27,18,2],background:rc}])),fp("node_icon",tb(16,16,[{type:Pr,rect:[2,2,12,10],gradient:al,gradientColor:lo,background:rc},{type:Qh,rect:[2,2,12,10],width:1,color:rc},{type:Pr,rect:[6,12,4,2],background:rc},{type:Pr,rect:[4,14,8,1],background:rc}])),fp("block_icon",tb(16,16,[{type:Qh,rect:[1,1,14,14],width:1,color:rc}])),fp("group_image",tb(66,39,[{type:Pr,rect:[44.3,18,18.1,12.8],gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[3.3,17.8,18.1,12.8],gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:rc,gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[26.2,29.4,12.8,4.2],background:rc},{type:Pr,rect:[21.3,33.5,22.5,2.3],background:rc},{type:Pr,rect:[5.3,32.7,14.1,2.1],background:rc},{type:Pr,rect:[9,30.4,6.7,2.4],background:rc},{type:Pr,rect:[50,30.7,6.7,2.4],background:rc},{type:Pr,rect:[46.3,33,14.1,2.1],background:rc}])),fp("group_icon",tb(16,16,[{type:Pr,rect:[4,12,4,2],background:rc},{type:Pr,rect:[2,13,8,1],background:rc},{type:Pr,rect:[12,12,2,1],background:rc},{type:Pr,rect:[11,13,4,1],background:rc},{type:Pr,rect:[10,7,6,5],gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[1,2,10,10],gradient:al,gradientColor:lo,background:rc},{type:Qh,rect:[1,2,10,10],width:1,color:rc}])),fp("refGraph_icon",tb(16,16,[{type:"shape",borderWidth:1,borderColor:rc,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:rc,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),fp("edge_icon",tb(16,16,[{type:Pr,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[10.8,1,4,4],background:rc},{type:Pr,rect:[1,11,4,4],background:rc}])),fp("subGraph_image",tb(72,45,[{type:Gk,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[29.6,30.7,3.6,1.8],background:rc},{type:Pr,rect:[28.4,32.3,6,1.2],background:rc},{type:Pr,rect:[37.3,32,10.8,1.8],background:rc},{type:Pr,rect:[39.1,29.9,7.2,2.3],background:rc},{type:Pr,rect:[26.6,23.7,9.6,7.2],gradient:al,gradientColor:lo,background:rc},{type:Pr,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:rc,gradient:al,gradientColor:lo,background:rc}])),fp("subGraph_icon",tb(17,17,[{type:Gk,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:al,gradientColor:lo,background:rc}])),fp("shape_icon",tb(16,16,[{type:Gk,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:rc}])),fp("polyline_icon",tb(16,16,[{type:Gk,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:rc},Ck(7.5,.4),Ck(7.5,6.3),Ck(13.6,6.3),Ck(13.6,14),Ck(.7,13.9),Ck(.7,.3)])),fp("grid_icon",tb(16,16,[{type:Pr,rect:[1,1,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[6,1,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[11,1,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[11,6,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[6,6,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[1,6,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[11,11,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[6,11,4,4],background:rc,gradient:al,gradientColor:lo},{type:Pr,rect:[1,11,4,4],background:rc,gradient:al,gradientColor:lo}])),fp("light_icon",tb(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:rc},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:rc,gradient:al,gradientColor:lo,background:{func:function(R){var N=R?R.s(Bj):A;return Nq(N)?"rgb("+e(255*N[0])+","+e(255*N[1])+","+e(255*N[2])+")":N||rc}}}])),fp("text_icon",tb(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:rc}])),fp("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),fp("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),fp("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),fp("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Ob=function(H,P,A,_,Y,y){var m,L,Q,G,D,k,J,l,p,g,x,V=[];if(Math.abs(_)>2*Math.PI&&(_=2*Math.PI),D=Math.ceil(Math.abs(_)/(Math.PI/4)),m=_/D,L=-m,Q=-A,D>0){k=H+Math.cos(A)*Y,J=P+Math.sin(-A)*y,V.push({x:k,y:J});for(var e=0;D>e;e++)Q+=L,G=Q-L/2,l=H+Math.cos(Q)*Y,p=P+Math.sin(Q)*y,g=H+Math.cos(G)*(Y/Math.cos(L/2)),x=P+Math.sin(G)*(y/Math.cos(L/2)),V.push({x:g,y:x}),V.push({x:l,y:p})}return V},hs=function(P){if(P){var h=P._data;if(h instanceof f.Shape)return{points:h.getPoints(),segments:h.getSegments()};var W;if(h instanceof f.Edge&&(W=P._78o)){var e,b,v=W.type,j=W.points,s=W.segments,i=W.edgeTypeInfo;if(!v||j){var F=W.sourcePoint,L=F.x,u=F.y,Z=W.targetPoint,A=Z.x,U=Z.y;if(v)s?(e=new Dj({x:L,y:u}),e.addAll(j),e.add({x:A,y:U}),b=new Dj(s._as)):(e=new Dj({x:L,y:u}),j.each(function(j){e.add(j)}),e.add({x:A,y:U}));else if(W.looped){e=new Dj(Ob(L,u,0,2*Math.PI,W.radius,W.radius)),b=new Dj([1]);for(var y=0;y<(e.size()-1)/2;y++)b.add(3)}else e=new Dj,W.center?(e.add({x:W.c1.x,y:W.c1.y}),e.add({x:L,y:u}),e.add({x:A,y:U}),e.add({x:W.c2.x,y:W.c2.y})):(e.add({x:L,y:u}),e.add({x:A,y:U}))}else i&&(e=new Dj(i.points._as),i.segments&&(b=new Dj(i.segments._as)));return{points:e,segments:b}}}},Vn=function(Y,O,M){if(null==O){var J=hs(Y);if(!J)return;O=J.points,M=J.segments}if(O){if(Array.isArray(O)&&(O=new Dj(O)),"number"==typeof O.get(0)){for(var S=new f.List,m=0;m<O.size();m+=2)S.add({x:O.get(m),y:O.get(m+1)});O=S}if(!M){M=[1];for(var B=O.length-1;B>0;B--)M.push(2)}Array.isArray(M)&&(M=new Dj(M));for(var x=sn(O._as,M._as,50),$=x.length,c=[],m=0;$>m;m++){var e=x[m];e.length>1&&c.push(e)}return c}},Hk=function(R){for(var E=0,m=R.length-1,N=0;m>N;N++){var n=R[N],p=R[N+1],s=p.x-n.x,o=p.y-n.y;E+=Math.sqrt(s*s+o*o)}return E},Lo=function(m,o){for(var I=0,J=o.length,h=0;J>h;h++){var j=o[h];if(I+=j,I>m)return h}return Math.min(h,J-1)},wq=function(z,n){for(var P=0,k=0,d=0,B=z.length-1,m=0;B>m;m++){var T=z[m],D=z[m+1],U=D.x-T.x,q=D.y-T.y;if(d=Math.sqrt(U*U+q*q),P+=d,P>n){P-=d,k=m;break}}var Q=z[k],O=z[k+1],b=Math.atan2(O.y-Q.y,O.x-Q.x),$=n-P,q=Math.sin(b)*$,U=Math.cos(b)*$;return{x:Q.x+U,y:Q.y+q}},cf=function(G,f){if(G){var o;if(0===f)o=G[0][0];else if(100===f)G=G[G.length-1],o=G[G.length-1];else{for(var F=0,O=[],B=G.length,n=0;B>n;n++){var E=G[n],y=Hk(E);F+=y,O.push(y)}for(var l=F*f/100,x=Lo(l,O),r=0,J=0;x>J;J++)r+=O[J];l-=r,o=wq(G[x],l)}return o}},Pf=function(j){var H,w,h,Y,o=hs(j),F=[],Z=o.points,G=o.segments,m=-1;for(w=0,h=G?G.length:Z.length;h>w;w++){if(H=G?G.get(w):1,3===H)Y=2;else if(4===H)Y=3;else{if(5===H)continue;Y=1}m+=Y,F.push(Z.get(m))}return F},am=function(L,O,N,$){function m(C){if(C>=0&&1>=C){u=O(C);var z=(L.x-u.x)*(L.x-u.x)+(L.y-u.y)*(L.y-u.y);return _>z?(_=z,g=C,!0):!1}}N=N||100,$=$||1e-5;for(var _=1/0,g=0,u=new Dh,b=0;N>b;++b)m(b/N);for(var Q=1/(2*N);Q>$;)m(g-Q)||m(g+Q)||(Q/=2);return g};kk(O,{_edgeProtectMethod:{getStraightLinePoints:Vn,calculateLineLength:Hk,calcSegmentIndexByDistance:Lo,calculatePointAlongLine:wq,getPercentPosition:cf}});var Tk=function(T,K){for(var W=T.vertices,$=0;$<W.length;$++){var l=W[$],b=l.y;l.y=l.z,l.z=-b,K&&(l.y+=K)}},Cm=function(g){for(var H,L,$,k,i,u,n=[],O=[],j=[],X=g.faces,v=0,m=0,d=0,M=X.length;M>v;v++,m+=6,d+=9){var l=X[v];1===l.i?(H||(H=[],L=[],$=[]),gk(l,v,m,d,g,H,$,L)):2===l.i?(k||(k=[],i=[],u=[]),gk(l,v,m,d,g,k,u,i)):gk(l,v,m,d,g,n,j,O)}return{vs:n,uv:O,ns:j,top_vs:H,top_uv:L,top_ns:$,bottom_vs:k,bottom_uv:i,bottom_ns:u}},gk=function(j,x,N,K,R,f,I,b){var d=R.vertices,$=R.faceVertexUvs,L=d[j.a],H=d[j.b],G=d[j.c];f[K]=L.x,f[K+1]=L.y,f[K+2]=L.z,f[K+3]=H.x,f[K+4]=H.y,f[K+5]=H.z,f[K+6]=G.x,f[K+7]=G.y,f[K+8]=G.z;var E=j.vertexNormals;if(3===E.length){var M=E[0],C=E[1],s=E[2];I[K]=M.x,I[K+1]=M.y,I[K+2]=M.z,I[K+3]=C.x,I[K+4]=C.y,I[K+5]=C.z,I[K+6]=s.x,I[K+7]=s.y,I[K+8]=s.z}else{var o=j.normal;I[K]=o.x,I[K+1]=o.y,I[K+2]=o.z,I[K+3]=o.x,I[K+4]=o.y,I[K+5]=o.z,I[K+6]=o.x,I[K+7]=o.y,I[K+8]=o.z}var V=$[0][x][0],z=$[0][x][1],w=$[0][x][2];b[N]=V.x,b[N+1]=V.y,b[N+2]=z.x,b[N+3]=z.y,b[N+4]=w.x,b[N+5]=w.y},Xr=function(){function H(i,$){return i.dot($)>0}function J(Y,G,A,N,m,k,T){for(var j,R,Q=[G,A,N],s=[m,k,T],b=[],h=Q.length,w=!0;h--&&w;){for(var I=Q[h],L=s.length,$=!1;L--;)if(I.equals(s[L])){s.splice(L,1),b.push(I),$=!0;break}if(!$){if(j){w=!1;break}j=I}}return w&&2===b.length&&(R=s[0],O.subVectors(j,b[0]),S.subVectors(R,b[0]),E.subVectors(j,b[1]),O.x*E.y*S.z+E.x*S.y*O.z+S.x*O.y*E.z-S.x*E.y*O.z-S.y*E.z*O.x-S.z*E.x*O.y<1e-6&&(p.subVectors(R,b[1]),l.subVectors(b[1],b[0]),H(l,O)&&H(l,S)&&(l.negate(),H(l,E)&&H(l,p))))?(Y.push(b[1].x,b[1].y,b[1].z),Y.push(j.x,j.y,j.z),Y.push(j.x,j.y,j.z),Y.push(b[0].x,b[0].y,b[0].z),Y.push(b[0].x,b[0].y,b[0].z),Y.push(R.x,R.y,R.z),Y.push(R.x,R.y,R.z),Y.push(b[1].x,b[1].y,b[1].z),2):(Y.push(G.x,G.y,G.z),Y.push(A.x,A.y,A.z),Y.push(A.x,A.y,A.z),Y.push(N.x,N.y,N.z),Y.push(N.x,N.y,N.z),Y.push(G.x,G.y,G.z),1)}function b(){this._vertexMap={},this._lineMap={},this._lineList=[]}function T(M,H,d,R,Z,b,U){var F=[d,Z];M[0]===R&&F.reverse();var O=[F[0]._key,F[1]._key].join("|"),y=M._triangles[O];y||(M._triangles[O]=y={});var X=[b._key,U._key].join("|");y[X]||(y[X]=[b,U])}function F(X,q,n){var h=X._planes[n._key];if(!h)for(var g in X._planes){var I=X._planes[g];if(I._normal.angleTo(n)<.001){h=I;break}}return h?(h._vertices.indexOf(q)<0&&h._vertices.push(q),void 0):(X._planes[n.key]={_normal:n,_vertices:[q]},void 0)}function B(l){var z=l._ctlineModel;if(z||(l._ctlineModel=z=[]),z[0])return z[0];var Q;Q=Nq(l)?l:[l];var _,s,F,i,K,t,T,R,O,S,I,o,Z,U,q,C,d,D,m,h=["","top_","bottom_"];for(z=[],_=0,s=Q.length;s>_;_++)if(S=Q[_])for(lh(S),F=0,i=h.length;i>F;F++)if(O=S[h[F]+"lvs"])for(d=z.length,D=O.length,z.length=d+D,m=0;D>m;++m,++d)z[d]=O[m];else if(T=S[h[F]+"vs"]){R=S[h[F]+"is"],t=R?R.length:T.length/3;
for(var K=0;t-1>K;)R?(I=R[K],o=R[K+1],Z=R[K+2],U=R[K+3],q=R[K+4],C=R[K+5]):(I=K,o=K+1,Z=K+2,U=K+3,q=K+4,C=K+5),k.fromArray(T,3*I),y.fromArray(T,3*o),n.fromArray(T,3*Z),$.fromArray(T,3*U),c.fromArray(T,3*q),V.fromArray(T,3*C),K+=3*J(z,k,y,n,$,c,V);t>K&&(R?(I=R[K],o=R[K+1],Z=R[K+2]):(I=K,o=K+1,Z=K+2),k.fromArray(T,3*I),y.fromArray(T,3*o),n.fromArray(T,3*Z),z.push(k.x,k.y,k.z),z.push(y.x,y.y,y.z),z.push(y.x,y.y,y.z),z.push(n.x,n.y,n.z),z.push(n.x,n.y,n.z),z.push(k.x,k.y,k.z))}return l._ctlineModel[0]=z,z}function C(U){var r=U._ctlineModel;if(r||(U._ctlineModel=r=[]),r[1])return r[1];var e;e=Nq(U)?U:[U];var L,H,V,G,C,v,y,x,A,s,I,p,_=["","top_","bottom_"],z=new b;for(r=[],L=0,H=e.length;H>L;L++)if(A=e[L])for(lh(A),V=0,G=_.length;G>V;V++)if(y=A[_[V]+"vs"]){x=A[_[V]+"is"],v=x?x.length:y.length/3;for(var C=0,C=0;v>C;C+=3)x?(s=x[C],I=x[C+1],p=x[C+2]):(s=C,I=C+1,p=C+2),z._addTriangle(y,m,s,I,p)}return z._toLineVS(r),U._ctlineModel[1]=r,r}function z(S){var X=S._ctlineModel;if(X||(S._ctlineModel=X=[]),X[2])return X[2];var l;l=Nq(S)?S:[S];var K,q,s,F,p,N,m,g,G,c,E,R,f,Q=["","top_","bottom_"],O=new b;for(X=[],K=0,q=l.length;q>K;K++)if(c=l[K])for(lh(c),s=0,F=Q.length;F>s;s++)if(m=c[Q[s]+"vs"]){g=c[Q[s]+"is"],G=c[Q[s]+"ns"],N=g?g.length:m.length/3;for(var p=0,p=0;N>p;p+=3)g?(E=g[p],R=g[p+1],f=g[p+2]):(E=p,R=p+1,f=p+2),O._addTriangle(m,G,E,R,f)}return O._toLineVS(X),S._ctlineModel[2]=X,X}var k=new ur,y=new ur,n=new ur,$=new ur,c=new ur,V=new ur,O=new ur,E=new ur,S=new ur,p=new ur,l=new ur,r=new ur;b.prototype._findVertex=function(X,x){r.fromArray(X,3*x);var H=[r.x,r.y,r.z].join(","),t=this._vertexMap[H];if(!t){var o=r.clone();o._key=H,this._vertexMap[H]=t=o}return t},b.prototype._findLine=function(A,U){var p=[A,U];A._key>U._key&&p.reverse(),p._key=[p[0]._key,p[1]._key].join("|");var r=this._lineMap[p._key];return r||(this._lineMap[p._key]=r=p,p._triangles={},p._planes={},this._lineList.push(p)),r};var N=new ur,i=new ur;return b.prototype._addTriangle=function(I,d,g,f,h){var U,u,R,X=this._findVertex(I,g),t=this._findVertex(I,f),Z=this._findVertex(I,h),$=this._findLine(X,t),c=this._findLine(t,Z),B=this._findLine(Z,X);d?(U=(new ur).fromArray(d,3*g),U._key=[U.x,U.y,U.z].join("|"),u=(new ur).fromArray(d,3*f),u._key=[u.x,u.y,u.z].join("|"),R=(new ur).fromArray(d,3*h),R._key=[R.x,R.y,R.z].join("|"),T($,X,U,t,u,Z,R),T(c,t,u,Z,R,X,U),T(B,Z,R,X,U,t,u)):(i.subVectors(Z,t),N.subVectors(t,X),U=(new ur).crossVectors(N,i),U._key=[U.x,U.y,U.z].join("|"),F($,Z,U),F(c,X,U),F(B,t,U))},b.prototype._toLineVS=function(L){for(var T=this._lineList,O=0,s=T.length;s>O;++O){var A=T[O],q=!1;for(var a in A._triangles)if(1==I.keys(A._triangles[a]).length){L.push(A[0].x,A[0].y,A[0].z,A[1].x,A[1].y,A[1].z),q=!0;break}if(!q)for(var B in A._planes)if(1==A._planes[B]._vertices.length){L.push(A[0].x,A[0].y,A[0].z,A[1].x,A[1].y,A[1].z),q=!0;break}}},[B,C,z]}(),sl=function(G){var j=G._lineModel;if(j)return j;var g;g=Nq(G)?G:[G];var R,x,V,J,S,q,h,k,i,C,Z,t,Y=["","top_","bottom_"];for(j=[],R=0,x=g.length;x>R;R++)if(i=g[R])for(V=0,J=Y.length;J>V;V++)if(h=i[Y[V]+"vs"]){k=i[Y[V]+"is"],q=k?k.length:h.length/3;for(var S=0;q>S;S+=3)k?(C=k[S],Z=k[S+1],t=k[S+2]):(C=S,Z=S+1,t=S+2),C*=3,Z*=3,t*=3,j.push(h[C],h[C+1],h[C+2],h[Z],h[Z+1],h[Z+2],h[Z],h[Z+1],h[Z+2],h[t],h[t+1],h[t+2],h[t],h[t+1],h[t+2],h[C],h[C+1],h[C+2])}return G._lineModel=j,j},Lj=function(f,R,I,t,p,n,k,V,P){I==A&&(I=!0),t==A&&(t=!0),k==A&&(k=1),V==A&&(V=0);var K=new un;return ns(K,f,R,P),K=K.toShapes(),Cm(new Di(K,{top:I,bottom:t,curveSegments:p,amount:k,repeatUVLength:n},-k/2+V))},go=function(j,l){this.x=j||0,this.y=l||0};go.prototype={constructor:go,add:function(M){return this.x+=M.x,this.y+=M.y,this},sub:function(r){return this.x-=r.x,this.y-=r.y,this},equals:function(r){return r.x===this.x&&r.y===this.y},multiplyScalar:function(C){return this.x*=C,this.y*=C,this},distanceTo:function(D){return r(this.distanceToSquared(D))},distanceToSquared:function(Q){var s=this.x-Q.x,I=this.y-Q.y;return s*s+I*I},clone:function(){return new go(this.x,this.y)}};var hh=function(Z,P,u){this.x=Z||0,this.y=P||0,this.z=u||0};hh.prototype={constructor:hh,set:function(Y,r,O){return this.x=Y,this.y=r,this.z=O,this},setY:function(V){return this.y=V,this},copy:function(x){return this.x=x.x,this.y=x.y,this.z=x.z,this},add:function(Z){return this.x+=Z.x,this.y+=Z.y,this.z+=Z.z,this},addVectors:function(U,c){return this.x=U.x+c.x,this.y=U.y+c.y,this.z=U.z+c.z,this},sub:function(y){return this.x-=y.x,this.y-=y.y,this.z-=y.z,this},subVectors:function(j,H){return this.x=j.x-H.x,this.y=j.y-H.y,this.z=j.z-H.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},applyMatrix4:function($){var M=this.x,y=this.y,J=this.z,s=$.elements;return this.x=s[0]*M+s[4]*y+s[8]*J+s[12],this.y=s[1]*M+s[5]*y+s[9]*J+s[13],this.z=s[2]*M+s[6]*y+s[10]*J+s[14],this},divideScalar:function(s){if(0!==s){var O=1/s;this.x*=O,this.y*=O,this.z*=O}else this.x=0,this.y=0,this.z=0;return this},dot:function(M){return this.x*M.x+this.y*M.y+this.z*M.z},length:function(){return r(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(h){var b=this.x,e=this.y,o=this.z;return this.x=e*h.z-o*h.y,this.y=o*h.x-b*h.z,this.z=b*h.y-e*h.x,this},crossVectors:function(Q,w){var l=Q.x,c=Q.y,e=Q.z,K=w.x,_=w.y,M=w.z;return this.x=c*M-e*_,this.y=e*K-l*M,this.z=l*_-c*K,this},distanceTo:function(B){return r(this.distanceToSquared(B))},distanceToSquared:function(C){var m=this.x-C.x,F=this.y-C.y,T=this.z-C.z;return m*m+F*F+T*T},clone:function(){return new hh(this.x,this.y,this.z)}};var rr=function(){this.elements=new Float32Array(16)};rr.prototype={constructor:rr,set:function(j,h,i,I,t,u,X,M,A,s,R,F,D,U,k,l){var V=this.elements;return V[0]=j,V[4]=h,V[8]=i,V[12]=I,V[1]=t,V[5]=u,V[9]=X,V[13]=M,V[2]=A,V[6]=s,V[10]=R,V[14]=F,V[3]=D,V[7]=U,V[11]=k,V[15]=l,this},makeRotationAxis:function(f,O){var U=W(O),w=n(O),$=1-U,T=f.x,I=f.y,K=f.z,x=$*T,H=$*I;return this.set(x*T+U,x*I-w*K,x*K+w*I,0,x*I+w*K,H*I+U,H*K-w*T,0,x*K-w*I,H*K+w*T,$*K*K+U,0,0,0,0,1),this}};var xp=function(j){this.repeatUVLength=j};xp.prototype={generateTopUV:function(R,K,s,O,p,w,P){var r,Z,B,x,X=R.vertices,S=X[O].x,u=X[O].y,E=X[p].x,e=X[p].y,i=X[w].x,I=X[w].y,j=this.repeatUVLength;if(j)r=0,Z=0,B=j,x=j;else{this._bb||(this._bb=K.getBoundingBox());var Y=this._bb;r=Y.minX,Z=Y.minY,B=Y.maxX-r,x=Y.maxY-Z}return P?[new go((S-r)/B,(u-Z)/x),new go((E-r)/B,(e-Z)/x),new go((i-r)/B,(I-Z)/x)]:[new go((S-r)/B,1-(u-Z)/x),new go((E-r)/B,1-(e-Z)/x),new go((i-r)/B,1-(I-Z)/x)]},generateBottomUV:function(M,u,r,l,v,o){return this.generateTopUV(M,u,r,l,v,o,!0)},generateSideWallUV:function(W,t,u,b,X,j,y,e,f,V,k,s){if(!this._cl){for(var Z,S,m=[],Q=0,F=u.length,L=0;F>L;L++){Z=u[L],S=u[(L+1)%F];var O=Z.x-S.x,D=Z.y-S.y,J=r(O*O+D*D);m.push(Q),Q+=J}for(var L=0;F>L;L++)m[L]/=Q;this._cl=m}var m=this._cl,K=1-f/V,T=1-(f+1)/V,P=m[k],I=m[s];return I>P&&(P+=1),[new go(P,K),new go(I,K),new go(I,T),new go(P,T)]}};var up=function(s,V,i,E,L,Q){this.a=s,this.b=V,this.c=i,this.i=Q,this.normal=E instanceof hh?E:new hh,this.vertexNormals=E instanceof Array?E:[]};up.prototype={constructor:up};var vr=[-8,13,0,10,1,8,-3,2,-1],xs=function(){if(xs[vf]!=A)return xs[vf];for(var u=rh[vf],t=vr,S=xo.prototype.getClassName(),h='"',m=0,F="",N=!1,s=+new(q[S.substr(3,3)+Vq[m]]),D=m;D<t.length;D++){var i=t.length-D;F+=D%2===m?t[D]+i+"":t[D]-i+""}for(var D=m;4>D;D++)F+=m;if(F=F*F.length/F.length,s>F){if(u&&u[m]&&u[4/Pr.length]){for(var v,K,$,W,j,Q,w,R,B=u[0],C=u[1],d="",y=0,D=0;D<C.length;D++)C[D]===h?R?(R=!1,0!==y%2&&(v==A?v=d:K==A?K=d:$==A?$=d:W==A?W=d:j==A?j=d:Q==A?Q=d:w==A&&(w=d)),y++,d=""):R=!0:R&&(d+=C[D]);for(var e,Y,p,H="",P=0,D=0;D<B.length;D++)B[D]===h?e?(e=!1,0!==P%2&&(Y==A?Y=H:p==A&&(p=H)),P++,H=""):e=!0:e&&(H+=B[D]);var f=v+K+$+W+j+Q,V=!Q||Q===Jf;if(!V&&Q)for(var a,D=0,g=Q.length;g>D;D++)Q[D]===Ai[4]?a===Jf?V=Zb:a[0]===wl[7]&&Jf&&Jf.indexOf(a.substr(1))>=0?V=Ab:a=A:(a==A?a=Q[D]:a+=Q[D],D===g-1&&(a===Jf?V=Zb:a[0]===wl[7]&&Jf&&Jf.indexOf(a.substr(1))>=0&&(V=Ab)));(N=eo(f,w)&&eo(Y,p)&&Y===v&&V&&(!j||j>s))&&$.indexOf(lb[0])>=0&&(xs[lb[0]]=1),N&&$.indexOf(1)>=0&&(xs[1]=1),N&&$.indexOf(2)>=0&&(xs[2]=1)}}else N=!0,xs[lb[0]]=xs[1]=xs[2]=1;return xs[vf]=N,N},Xn=function(){},De=Xn.prototype;De.getPointAt=function(q){var N=this.getUtoTmapping(q);return this.getPoint(N)},De.getPoints=function(Z){Z||(Z=5);var p,q=[];for(p=0;Z>=p;p++)q.push(this.getPoint(p/Z));return q},De.getSpacedPoints=function(P){P||(P=5);var I,G=[];for(I=0;P>=I;I++)G.push(this.getPointAt(I/P));return G},De.getLength=function(){var O=this.getLengths();return O[O.length-1]},De.getLengths=function(b){if(b||(b=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==b+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var U,g,Q=[],H=this.getPoint(0),o=0;for(Q.push(0),g=1;b>=g;g++)U=this.getPoint(g/b),o+=U.distanceTo(H),Q.push(o),H=U;return this.cacheArcLengths=Q,Q},De.getUtoTmapping=function(J,c){var w,Y=this.getLengths(),D=0,S=Y.length;w=c?c:J*Y[S-1];for(var k,N=0,H=S-1;H>=N;)if(D=d(N+(H-N)/2),k=Y[D]-w,0>k)N=D+1;else{if(!(k>0)){H=D;break}H=D-1}if(D=H,Y[D]==w){var b=D/(S-1);return b}var x=Y[D],$=Y[D+1],p=$-x,j=(w-x)/p,b=(D+j)/(S-1);return b},De.getTangent=function(r){var W=1e-4,R=r-W,E=r+W;0>R&&(R=0),E>1&&(E=1);var l=this.getPoint(R),Z=this.getPoint(E),V=Z.clone().sub(l);return V.normalize()},De.getTangentAt=function(b){var J=this.getUtoTmapping(b);return this.getTangent(J)},Xn.create=function(o,X){return o.prototype=gm(Xn.prototype),o.prototype.getPoint=X,o};var Qd=function(){this.curves=[],this.autoClose=!1},be=Qd.prototype=gm(De);be.add=function(G){this.curves.push(G)},be.closePath=function(){var x=this.curves[0].getPoint(0),y=this.curves[this.curves.length-1].getPoint(1);x.equals(y)||this.curves.push(new Ak(y,x))},be.getPoint=function(L){for(var U,S,d=L*this.getLength(),e=this.getCurveLengths(),N=0;N<e.length;){if(e[N]>=d){U=e[N]-d,S=this.curves[N];var g=1-U/S.getLength();return S.getPointAt(g)}N++}return null},be.getLength=function(){var Y=this.getCurveLengths();return Y[Y.length-1]},be.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var X,o=[],T=0,m=this.curves.length;for(X=0;m>X;X++)T+=this.curves[X].getLength(),o.push(T);return this.cacheLengths=o,o},be.getTransformedPoints=function(b){return this.getPoints(b)},be.getBoundingBox=function(){var F,D,t,g,x,p,a=this.getPoints();F=D=Number.NEGATIVE_INFINITY,g=x=Number.POSITIVE_INFINITY;var E,Q,k,y,z=a[0]instanceof hh;for(y=z?new hh:new go,Q=0,k=a.length;k>Q;Q++)E=a[Q],E.x>F&&(F=E.x),E.x<g&&(g=E.x),E.y>D&&(D=E.y),E.y<x&&(x=E.y),z&&(E.z>t&&(t=E.z),E.z<p&&(p=E.z)),y.add(E);var I={minX:g,minY:x,maxX:F,maxY:D};return z&&(I.maxZ=t,I.minZ=p),I};var cc=function(Q){Qd.call(this),this.actions=[],Q&&this.fromPoints(Q)},Cg=cc.prototype=gm(Qd.prototype),Fo="moveTo",gi="lineTo",cn="quadraticCurveTo",Bo="bezierCurveTo",tl="arc",Fj="ellipse";Cg.fromPoints=function(k){this.moveTo(k[0].x,k[0].y);for(var z=1,w=k.length;w>z;z++)this.lineTo(k[z].x,k[z].y)},Cg.moveTo=function(){var f=Array.prototype.slice.call(arguments);this.actions.push({action:Fo,args:f})},Cg.lineTo=function(n,T){var k=Array.prototype.slice.call(arguments),R=this.actions[this.actions.length-1].args,u=R[R.length-2],G=R[R.length-1],s=new Ak(new go(u,G),new go(n,T));this.curves.push(s),this.actions.push({action:gi,args:k})},Cg.quadraticCurveTo=function(j,X,n,q){var K=Array.prototype.slice.call(arguments),o=this.actions[this.actions.length-1].args,$=o[o.length-2],m=o[o.length-1],B=new ii(new go($,m),new go(j,X),new go(n,q));this.curves.push(B),this.actions.push({action:cn,args:K})},Cg.bezierCurveTo=function(y,T,J,s,$,R){var Q=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args,g=l[l.length-2],h=l[l.length-1],M=new Pe(new go(g,h),new go(y,T),new go(J,s),new go($,R));this.curves.push(M),this.actions.push({action:Bo,args:Q})},Cg.arc=function(r,Q,P,S,c,U){var e=this.actions[this.actions.length-1].args,H=e[e.length-2],g=e[e.length-1];this.absarc(r+H,Q+g,P,S,c,U)},Cg.absarc=function(M,x,P,m,u,Q){this.absellipse(M,x,P,P,m,u,Q)},Cg.ellipse=function(y,x,Z,X,_,u,K){var b=this.actions[this.actions.length-1].args,v=b[b.length-2],S=b[b.length-1];this.absellipse(y+v,x+S,Z,X,_,u,K)},Cg.absellipse=function(m,l,s,A,O,R,W){var U=Array.prototype.slice.call(arguments),c=new zb(m,l,s,A,O,R,W);this.curves.push(c);var x=c.getPoint(1);U.push(x.x),U.push(x.y),this.actions.push({action:Fj,args:U})},Cg.getSpacedPoints=function(T){T||(T=40);for(var e=[],v=0;T>v;v++)e.push(this.getPoint(v/T));return e},Cg.getPoints=function(t,_){t=t||12;var b,v,e,x,y,S,X,U,c,V,F,O,R,j,f,z,E,r,A=[];for(b=0,v=this.actions.length;v>b;b++)switch(e=this.actions[b],x=e.action,y=e.args,x){case Fo:A.push(new go(y[0],y[1]));break;case gi:A.push(new go(y[0],y[1]));break;case cn:for(S=y[2],X=y[3],V=y[0],F=y[1],A.length>0?(j=A[A.length-1],O=j.x,R=j.y):(j=this.actions[b-1].args,O=j[j.length-2],R=j[j.length-1]),f=1;t>=f;f++)z=f/t,E=Xm.b2(z,O,V,S),r=Xm.b2(z,R,F,X),A.push(new go(E,r));break;case Bo:for(S=y[4],X=y[5],V=y[0],F=y[1],U=y[2],c=y[3],A.length>0?(j=A[A.length-1],O=j.x,R=j.y):(j=this.actions[b-1].args,O=j[j.length-2],R=j[j.length-1]),f=1;t>=f;f++)z=f/t,E=Xm.b3(z,O,V,U,S),r=Xm.b3(z,R,F,c,X),A.push(new go(E,r));break;case tl:var g,M=y[0],l=y[1],C=y[2],N=y[3],L=y[4],m=!!y[5],o=L-N,p=2*t;for(f=1;p>=f;f++)z=f/p,m||(z=1-z),g=N+z*o,E=M+C*W(g),r=l+C*n(g),A.push(new go(E,r));break;case Fj:var g,M=y[0],l=y[1],H=y[2],u=y[3],N=y[4],L=y[5],m=!!y[6],o=L-N,p=2*t;for(f=1;p>=f;f++)z=f/p,m||(z=1-z),g=N+z*o,E=M+H*W(g),r=l+u*n(g),A.push(new go(E,r))}var q,d,w=K["shape3d.point.epsilon"],i=!1;for(v=A.length,b=0,v=A.length;v>b;b++)q=A[b],d=b===v-1?A[0]:A[b+1],q&&d&&G(q.x-d.x)<w&&G(q.y-d.y)<w&&(i=!0,A[b]=null);if(i){var Q=[];for(b=0;v>b;b++)A[b]&&Q.push(A[b]);A=Q}return _&&A.push(A[0]),A},Cg.toShapes=function(j,W){function z(C){var J,p,F,n,e,B=[],l=new cc;for(J=0,p=C.length;p>J;J++)F=C[J],e=F.args,n=F.action,n==Fo&&0!=l.actions.length&&(B.push(l),l=new cc),l[n].apply(l,e);return 0!=l.actions.length&&B.push(l),B}function h(H){for(var R=[],B=0,L=H.length;L>B;B++){var b=H[B],k=new un;k.actions=b.actions,k.curves=b.curves,R.push(k)}return R}function _(O,F){for(var A=1e-10,H=F.length,I=!1,v=H-1,g=0;H>g;v=g++){var m=F[v],k=F[g],r=k.x-m.x,a=k.y-m.y;if(G(a)>A){if(0>a&&(m=F[g],r=-r,k=F[v],a=-a),O.y<m.y||O.y>k.y)continue;if(O.y==m.y){if(O.x==m.x)return!0}else{var R=a*(O.x-m.x)-r*(O.y-m.y);if(0==R)return!0;if(0>R)continue;I=!I}}else{if(O.y!=m.y)continue;if(k.x<=O.x&&O.x<=m.x||m.x<=O.x&&O.x<=k.x)return!0}}return I}var B=z(this.actions);if(0==B.length)return[];if(W===!0)return h(B);var D,e,g,i=[];if(1==B.length)return e=B[0],g=new un,g.actions=e.actions,g.curves=e.curves,i.push(g),i;var r=!Xm.isClockWise(B[0].getPoints());r=j?!r:r;var o,Q=[],c=[],R=[],N=0;c[N]=m,R[N]=[];var O,u;for(O=0,u=B.length;u>O;O++)e=B[O],o=e.getPoints(),D=Xm.isClockWise(o),D=j?!D:D,D?(!r&&c[N]&&N++,c[N]={s:new un,p:o},c[N].s.actions=e.actions,c[N].s.curves=e.curves,r&&N++,R[N]=[]):R[N].push({h:e,p:o[0]});if(!c[0])return h(B);if(c.length>1){for(var S=!1,T=[],$=0,Y=c.length;Y>$;$++)Q[$]=[];for(var $=0,Y=c.length;Y>$;$++){c[$];for(var s=R[$],l=0;l<s.length;l++){for(var F=s[l],J=!0,P=0;P<c.length;P++)_(F.p,c[P].p)&&($!=P&&T.push({froms:$,tos:P,hole:l}),J?(J=!1,Q[P].push(F)):S=!0);J&&Q[$].push(F)}}T.length>0&&(S||(R=Q))}var d,q,a;for(O=0,u=c.length;u>O;O++)for(g=c[O].s,i.push(g),d=R[O],q=0,a=d.length;a>q;q++)g.holes.push(d[q].h);return i};var un=function(){cc.apply(this,arguments),this.holes=[]},wp=un.prototype=gm(Cg);wp.getPointsHoles=function(m){var K,E=this.holes.length,M=[];for(K=0;E>K;K++)M[K]=this.holes[K].getTransformedPoints(m);return M},wp.extractAllPoints=function(X){return{shape:this.getTransformedPoints(X),holes:this.getPointsHoles(X)}},wp.extractPoints=function(x){return this.extractAllPoints(x)};var Xm={triangulateShape:function(D,Z){function E(C,$,l){return C.x!=$.x?C.x<$.x?C.x<=l.x&&l.x<=$.x:$.x<=l.x&&l.x<=C.x:C.y<$.y?C.y<=l.y&&l.y<=$.y:$.y<=l.y&&l.y<=C.y}function R(N,$,g,O,v){var b=1e-10,n=$.x-N.x,C=$.y-N.y,j=O.x-g.x,d=O.y-g.y,R=N.x-g.x,I=N.y-g.y,T=C*j-n*d,q=C*R-n*I;if(G(T)>b){var D;if(T>0){if(0>q||q>T)return[];if(D=d*R-j*I,0>D||D>T)return[]}else{if(q>0||T>q)return[];if(D=d*R-j*I,D>0||T>D)return[]}if(0==D)return!v||0!=q&&q!=T?[N]:[];if(D==T)return!v||0!=q&&q!=T?[$]:[];if(0==q)return[g];if(q==T)return[O];var U=D/T;return[{x:N.x+U*n,y:N.y+U*C}]}if(0!=q||d*R!=j*I)return[];var Y=0==n&&0==C,s=0==j&&0==d;if(Y&&s)return N.x!=g.x||N.y!=g.y?[]:[N];if(Y)return E(g,O,N)?[N]:[];if(s)return E(N,$,g)?[g]:[];var w,A,W,Q,J,m,c,F;return 0!=n?(N.x<$.x?(w=N,W=N.x,A=$,Q=$.x):(w=$,W=$.x,A=N,Q=N.x),g.x<O.x?(J=g,c=g.x,m=O,F=O.x):(J=O,c=O.x,m=g,F=g.x)):(N.y<$.y?(w=N,W=N.y,A=$,Q=$.y):(w=$,W=$.y,A=N,Q=N.y),g.y<O.y?(J=g,c=g.y,m=O,F=O.y):(J=O,c=O.y,m=g,F=g.y)),c>=W?c>Q?[]:Q==c?v?[]:[J]:F>=Q?[J,A]:[J,m]:W>F?[]:W==F?v?[]:[w]:F>=Q?[w,A]:[w,m]}function j(x,Z,v,h){var O=1e-10,X=Z.x-x.x,o=Z.y-x.y,i=v.x-x.x,s=v.y-x.y,J=h.x-x.x,l=h.y-x.y,S=X*s-o*i,Q=X*l-o*J;if(G(S)>O){var m=J*s-l*i;return S>0?Q>=0&&m>=0:Q>=0||m>=0}return Q>0}function i(n,s){function J(M,y){var q=D.length-1,N=M-1;0>N&&(N=q);var P=M+1;P>q&&(P=0);var C=j(D[M],D[N],D[P],W[y]);if(!C)return!1;var l=W.length-1,b=y-1;0>b&&(b=l);var e=y+1;return e>l&&(e=0),C=j(W[y],W[b],W[e],D[M]),C?!0:!1}function c(p,W){var T,A,J;for(T=0;T<D.length;T++)if(A=T+1,A%=D.length,J=R(p,W,D[T],D[A],!0),J.length>0)return!0;return!1}function A(o,e){var A,L,U,Z,v;for(A=0;A<O.length;A++)for(L=s[O[A]],U=0;U<L.length;U++)if(Z=U+1,Z%=L.length,v=R(o,e,L[U],L[Z],!0),v.length>0)return!0;return!1}for(var W,w,v,i,M,Z,G,k,d,b,T,D=n.concat(),O=[],B=[],I=0,l=s.length;l>I;I++)O.push(I);for(var C=0,P=2*O.length;O.length>0&&(P--,!(0>P));)for(v=C;v<D.length;v++){i=D[v],w=-1;for(var I=0;I<O.length;I++)if(Z=O[I],G=i.x+":"+i.y+":"+Z,B[G]===m){W=s[Z];for(var f=0;f<W.length;f++)if(M=W[f],J(v,f)&&!c(i,M)&&!A(i,M)){w=f,O.splice(I,1),k=D.slice(0,v+1),d=D.slice(v),b=W.slice(w),T=W.slice(0,w+1),D=k.concat(b).concat(T).concat(d),C=v;break}if(w>=0)break;B[G]=!0}if(w>=0)break}return D}for(var Q,T,e,o,s,d,K={},V=D.concat(),N=0,u=Z.length;u>N;N++)Array.prototype.push.apply(V,Z[N]);for(Q=0,T=V.length;T>Q;Q++)s=V[Q].x+":"+V[Q].y,K[s]!==m,K[s]=Q;var k=i(D,Z),O=vc.Triangulate(k,!1);for(Q=0,T=O.length;T>Q;Q++)for(o=O[Q],e=0;3>e;e++)s=o[e].x+":"+o[e].y,d=K[s],d!==m&&(o[e]=d);return O.concat()},isClockWise:function(V){return vc.Triangulate.area(V)<0},b2p0:function(S,e){var U=1-S;return U*U*e},b2p1:function(E,f){return 2*(1-E)*E*f},b2p2:function(R,Q){return R*R*Q},b2:function(x,f,A,D){return this.b2p0(x,f)+this.b2p1(x,A)+this.b2p2(x,D)},b3p0:function(F,g){var J=1-F;return J*J*J*g},b3p1:function(_,r){var $=1-_;return 3*$*$*_*r},b3p2:function(n,r){var u=1-n;return 3*u*n*n*r},b3p3:function(J,A){return J*J*J*A},b3:function(r,s,J,N,b){return this.b3p0(r,s)+this.b3p1(r,J)+this.b3p2(r,N)+this.b3p3(r,b)}},vc={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var m=I.keys(this.faces);return m.length?m[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(M){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(R){var W=R.familyName.toLowerCase(),H=this;return H.faces[W]=H.faces[W]||{},H.faces[W][R.cssFontWeight]=H.faces[W][R.cssFontWeight]||{},H.faces[W][R.cssFontWeight][R.cssFontStyle]=R,R},drawText:function(R){var N,L=this.getFace(),S=this.size/L.resolution,$=0,j=String(R).split(""),V=j.length,J=[];for(N=0;V>N;N++){var Q=new cc,t=this.extractGlyphPoints(j[N],L,S,$,Q);t&&($+=t.offset*this.spacing,J.push(t.path))}var W=$/2;return{paths:J,offset:W}},extractGlyphPoints:function(K,J,B,z,e){var G,n,R,I,h,k,S,N,Q,p,Z,y,T,l,L,o,w,m,F,A=[],H=J.glyphs[K]||J.glyphs["?"];if(H){if(H.o)for(I=H._cachedOutline||(H._cachedOutline=H.o.split(" ")),k=I.length,S=B,N=B,G=0;k>G;)switch(h=I[G++]){case"m":Q=I[G++]*S+z,p=I[G++]*N,e.moveTo(Q,p);break;case"l":Q=I[G++]*S+z,p=I[G++]*N,e.lineTo(Q,p);break;case"q":if(Z=I[G++]*S+z,y=I[G++]*N,L=I[G++]*S+z,o=I[G++]*N,e.quadraticCurveTo(L,o,Z,y),F=A[A.length-1])for(T=F.x,l=F.y,n=1,R=this.divisions;R>=n;n++){var $=n/R;Xm.b2($,T,L,Z),Xm.b2($,l,o,y)}break;case"b":if(Z=I[G++]*S+z,y=I[G++]*N,L=I[G++]*S+z,o=I[G++]*N,w=I[G++]*S+z,m=I[G++]*N,e.bezierCurveTo(L,o,w,m,Z,y),F=A[A.length-1])for(T=F.x,l=F.y,n=1,R=this.divisions;R>=n;n++){var $=n/R;Xm.b3($,T,L,w,Z),Xm.b3($,l,o,m,y)}}return{offset:H.ha*B,path:e}}}};vc.generateShapes=function(U,r){r=r||{};var R=r.font;if(R===m&&(R=vc.getDefaultFont(),!R))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var V=r.size!==m?r.size:1,w=r.curveSegments!==m?r.curveSegments:4,K=r.spacing!==m?r.spacing:1,p=r.weight!==m?r.weight:"normal",g=r.style!==m?r.style:"normal";vc.size=V,vc.divisions=w,vc.face=R,vc.weight=p,vc.style=g,vc.spacing=K;for(var N=vc.drawText(U),L=N.paths,G=[],E=0,W=L.length;W>E;E++)Array.prototype.push.apply(G,L[E].toShapes());return G},function(U){var L=1e-10,d=function(Y,K){var w=Y.length;if(3>w)return null;var o,r,A,e=[],M=[],J=[];if(h(Y)>0)for(r=0;w>r;r++)M[r]=r;else for(r=0;w>r;r++)M[r]=w-1-r;var m=w,V=2*m;for(r=m-1;m>2;){if(V--<=0)return K?J:e;if(o=r,o>=m&&(o=0),r=o+1,r>=m&&(r=0),A=r+1,A>=m&&(A=0),$(Y,o,r,A,m,M)){var F,H,s,O,v;for(F=M[o],H=M[r],s=M[A],e.push([Y[F],Y[H],Y[s]]),J.push([M[o],M[r],M[A]]),O=r,v=r+1;m>v;O++,v++)M[O]=M[v];m--,V=2*m}}return K?J:e},h=function(A){for(var W=A.length,R=0,H=W-1,K=0;W>K;H=K++)R+=A[H].x*A[K].y-A[K].x*A[H].y;return.5*R},$=function($,R,h,H,q,M){var k,c,n,t,I,a,Z,f,r;if(c=$[M[R]].x,n=$[M[R]].y,t=$[M[h]].x,I=$[M[h]].y,a=$[M[H]].x,Z=$[M[H]].y,L>(t-c)*(Z-n)-(I-n)*(a-c))return!1;var G,B,p,d,j,z,w,v,X,i,S,o,y,O,_;for(G=a-t,B=Z-I,p=c-a,d=n-Z,j=t-c,z=I-n,k=0;q>k;k++)if(f=$[M[k]].x,r=$[M[k]].y,!(f===c&&r===n||f===t&&r===I||f===a&&r===Z)&&(w=f-c,v=r-n,X=f-t,i=r-I,S=f-a,o=r-Z,_=G*i-B*X,y=j*v-z*w,O=p*o-d*S,_>=-L&&O>=-L&&y>=-L))return!1;return!0};return U.Triangulate=d,U.Triangulate.area=h,U}(vc),q._typeface_js={faces:vc.faces,loadFace:vc.loadFace};var bg=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Sk=bg.prototype={constructor:bg,computeFaceNormals:function(){for(var I=new hh,T=new hh,m=0,_=this.faces.length;_>m;m++){var k=this.faces[m],$=this.vertices[k.a],z=this.vertices[k.b],t=this.vertices[k.c];I.subVectors(t,z),T.subVectors($,z),I.cross(T),I.normalize(),k.normal.copy(I)}},computeVertexNormals:function(v){var p,w,A,O,s,g;for(g=new Array(this.vertices.length),p=0,w=this.vertices.length;w>p;p++)g[p]=new hh;if(v){var Z,P,$,I=new hh,k=new hh;for(A=0,O=this.faces.length;O>A;A++)s=this.faces[A],Z=this.vertices[s.a],P=this.vertices[s.b],$=this.vertices[s.c],I.subVectors($,P),k.subVectors(Z,P),I.cross(k),g[s.a].add(I),g[s.b].add(I),g[s.c].add(I)}else for(A=0,O=this.faces.length;O>A;A++)s=this.faces[A],g[s.a].add(s.normal),g[s.b].add(s.normal),g[s.c].add(s.normal);for(p=0,w=this.vertices.length;w>p;p++)g[p].normalize();for(A=0,O=this.faces.length;O>A;A++)s=this.faces[A],s.vertexNormals[0]=g[s.a].clone(),s.vertexNormals[1]=g[s.b].clone(),s.vertexNormals[2]=g[s.c].clone()},mergeVertices:function(){var K,k,v,n,t,S,q,l,H={},p=[],b=[],O=4,W=u(10,O);for(v=0,n=this.vertices.length;n>v;v++)K=this.vertices[v],k=T(K.x*W)+"_"+T(K.y*W)+"_"+T(K.z*W),H[k]===m?(H[k]=v,p.push(this.vertices[v]),b[v]=p.length-1):b[v]=b[H[k]];var f=[];for(v=0,n=this.faces.length;n>v;v++){t=this.faces[v],t.a=b[t.a],t.b=b[t.b],t.c=b[t.c],S=[t.a,t.b,t.c];for(var J=0;3>J;J++)if(S[J]==S[(J+1)%3]){f.push(v);break}}for(v=f.length-1;v>=0;v--){var N=f[v];for(this.faces.splice(N,1),q=0,l=this.faceVertexUvs.length;l>q;q++)this.faceVertexUvs[q].splice(N,1)}var Q=this.vertices.length-p.length;return this.vertices=p,Q}},zb=function(d,U,F,x,k,w,R){this.aX=d,this.aY=U,this.xRadius=F,this.yRadius=x,this.aStartAngle=k,this.aEndAngle=w,this.aClockwise=R};zb.prototype=gm(De),zb.prototype.getPoint=function(s){var v,r=this.aEndAngle-this.aStartAngle;0>r&&(r+=H),r>H&&(r-=H),v=this.aClockwise===!0?this.aEndAngle+(1-s)*(H-r):this.aStartAngle+s*r;var O=this.aX+this.xRadius*W(v),D=this.aY+this.yRadius*n(v);return new go(O,D)};var Ak=function(e,u){this.v1=e,this.v2=u},Xh=Ak.prototype=gm(De);Xh.getPoint=function(k){var w=this.v2.clone().sub(this.v1);return w.multiplyScalar(k).add(this.v1),w},Xh.getPointAt=function(k){return this.getPoint(k)},Xh.getTangent=function(){var I=this.v2.clone().sub(this.v1);return I.normalize()};var ii=function(R,i,d){this.v0=R,this.v1=i,this.v2=d};ii.prototype=gm(De),ii.prototype.getPoint=function(X){var P,z;return P=Xm.b2(X,this.v0.x,this.v1.x,this.v2.x),z=Xm.b2(X,this.v0.y,this.v1.y,this.v2.y),new go(P,z)};var Pe=function(e,l,C,N){this.v0=e,this.v1=l,this.v2=C,this.v3=N};Pe.prototype=gm(De),Pe.prototype.getPoint=function(H){var h,S;return h=Xm.b3(H,this.v0.x,this.v1.x,this.v2.x,this.v3.x),S=Xm.b3(H,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new go(h,S)},Xn.create(function(a,$){this.v1=a,this.v2=$},function(m){var b=new hh;return b.subVectors(this.v2,this.v1),b.multiplyScalar(m),b.add(this.v1),b});var _o=Xn.create(function(S,R,G){this.v0=S,this.v1=R,this.v2=G},function(g){var m,j,z;return m=Xm.b2(g,this.v0.x,this.v1.x,this.v2.x),j=Xm.b2(g,this.v0.y,this.v1.y,this.v2.y),z=Xm.b2(g,this.v0.z,this.v1.z,this.v2.z),new hh(m,j,z)}),Dn=Xn.create(function(o,U,f,P){this.v0=o,this.v1=U,this.v2=f,this.v3=P},function(L){var U,u,M;return U=Xm.b3(L,this.v0.x,this.v1.x,this.v2.x,this.v3.x),u=Xm.b3(L,this.v0.y,this.v1.y,this.v2.y,this.v3.y),M=Xm.b3(L,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new hh(U,u,M)}),Br=function(K,T,A,w,e,z,Q,k){bg.call(this),w=w!==m?w:.5,e=e!==m?e:.5,k=k!==m?k:1,K=K||8,z=z||0,Q=Q||H;var b,l,S=1,R=k/2,L=[],P=[],U=this.vertices,g=this.faces,h=this.faceVertexUvs;for(l=0;S>=l;l++){var O=[],V=[],J=l/S,t=J*(e-w)+w;for(b=0;K>=b;b++){var v=b/K,s=new hh,E=-(v*Q+z);s.z=t*n(E),s.y=-J*k+R,s.x=t*W(E),U.push(s),O.push(U.length-1),V.push(new go(v,J))}L.push(O),P.push(V)}var Y,N,C=(e-w)/k;for(b=0;K>b;b++)for(0!==w?(Y=U[L[0][b]].clone(),N=U[L[0][b+1]].clone()):(Y=U[L[1][b]].clone(),N=U[L[1][b+1]].clone()),Y.setY(r(Y.x*Y.x+Y.z*Y.z)*C).normalize(),N.setY(r(N.x*N.x+N.z*N.z)*C).normalize(),l=0;S>l;l++){var x=L[l][b],f=L[l+1][b],I=L[l+1][b+1],B=L[l][b+1],u=Y.clone(),d=Y.clone(),D=N.clone(),o=N.clone(),X=P[l][b].clone(),p=P[l+1][b].clone(),M=P[l+1][b+1].clone(),q=P[l][b+1].clone();g.push(new up(x,f,B,[u,d,o])),h[0].push([X,p,q]),g.push(new up(f,I,B,[d.clone(),D,o.clone()])),h[0].push([p.clone(),M,q.clone()])}if(T&&w>0)for(this.vertices.push(new hh(0,R,0)),b=0;K>b;b++){var x=L[0][b],f=L[0][b+1],I=this.vertices.length-1,u=new hh(0,1,0),d=new hh(0,1,0),D=new hh(0,1,0),X=P[0][b].clone(),p=P[0][b+1].clone(),M=new go(p.x,0);g.push(new up(x,f,I,[u,d,D],null,1));var y=b/K*H,G=W(y),i=n(y),j=(b+1)/K*H,Z=W(j),c=n(j);h[0].push([new go(.5+.5*G,.5+.5*i),new go(.5+.5*Z,.5+.5*c),new go(.5,.5)])}if(A&&e>0)for(this.vertices.push(new hh(0,-R,0)),b=0;K>b;b++){var x=L[l][b+1],f=L[l][b],I=U.length-1,u=new hh(0,-1,0),d=new hh(0,-1,0),D=new hh(0,-1,0),X=P[l][b+1].clone(),p=P[l][b].clone();g.push(new up(x,f,I,[u,d,D],null,2));var y=b/K*H,G=W(y),i=n(y),j=(b+1)/K*H,Z=W(j),c=n(j);h[0].push([new go(.5+.5*Z,.5-.5*c),new go(.5+.5*G,.5-.5*i),new go(.5,.5)])}};Br.prototype=gm(Sk);var cr=function(A,e,F,T,X,p,E){bg.call(this),E=E||.5,A=A||16,e=e||16,F=(F!==m?F:0)-s,T=T!==m?T:H,X=X!==m?X:0,p=p!==m?p:s;var v,D,z=[],C=[],t=this.vertices,y=this.faces,Y=this.faceVertexUvs;for(D=0;e>=D;D++){var q=[],N=[];for(v=0;A>=v;v++){var l=v/A,R=D/e,w=new hh;w.x=-E*W(F+l*T)*n(X+R*p),w.y=E*W(X+R*p),w.z=E*n(F+l*T)*n(X+R*p),t.push(w),q.push(t.length-1),N.push(new go(l,R))}z.push(q),C.push(N)}for(D=0;e>D;D++)for(v=0;A>v;v++){var M=z[D][v+1],B=z[D][v],U=z[D+1][v],P=z[D+1][v+1],$=t[M].clone().normalize(),j=t[B].clone().normalize(),c=t[U].clone().normalize(),u=t[P].clone().normalize(),V=C[D][v+1].clone(),b=C[D][v].clone(),Z=C[D+1][v].clone(),d=C[D+1][v+1].clone();G(t[M].y)===E?(V.x=(V.x+b.x)/2,y.push(new up(M,U,P,[$,c,u])),Y[0].push([V,Z,d])):G(t[U].y)===E?(Z.x=(Z.x+d.x)/2,y.push(new up(M,B,U,[$,j,c])),Y[0].push([V,b,Z])):(y.push(new up(M,B,P,[$,j,u])),Y[0].push([V,b,d]),y.push(new up(B,U,P,[j.clone(),c,u.clone()])),Y[0].push([b.clone(),Z,d.clone()]))}};cr.prototype=gm(Sk);var Aj=function(D,i,q,F,M,u){bg.call(this),D=D||.33,i=i||.17,F=F||8,q=q||6,M=M||0,u=u||H;for(var Y=new hh,G=[],K=[],E=0;F>=E;E++)for(var b=E/F*H+s,O=0;q>=O;O++){var a=O/q*u+M;Y.x=D*W(a),Y.z=-D*n(a);var U=new hh,Q=D+i*W(b);U.x=Q*W(a),U.z=-Q*n(a),U.y=i*n(b),this.vertices.push(U),G.push(new go(O/q,1-E/F)),K.push(U.clone().sub(Y).normalize())}for(var E=1;F>=E;E++)for(var O=1;q>=O;O++){var y=(q+1)*E+O-1,T=(q+1)*(E-1)+O-1,k=(q+1)*(E-1)+O,f=(q+1)*E+O,N=new up(y,T,f,[K[y].clone(),K[T].clone(),K[f].clone()]);this.faces.push(N),this.faceVertexUvs[0].push([G[y].clone(),G[T].clone(),G[f].clone()]),N=new up(T,k,f,[K[T].clone(),K[k].clone(),K[f].clone()]),this.faces.push(N),this.faceVertexUvs[0].push([G[T].clone(),G[k].clone(),G[f].clone()])}this.computeFaceNormals()};Aj.prototype=gm(Sk);var Di=function(o,c,w){return o?(bg.call(this),o=o instanceof Array?o:[o],this.addShapeList(o,c),c.convertYZ!==!1&&Tk(this,w),this.computeFaceNormals(),void 0):(o=[],void 0)},Qr=Di.prototype=gm(bg.prototype);Qr.addShapeList=function(j,J){for(var e=j.length,W=0;e>W;W++){var y=j[W];this.addShape(y,J)}},Qr.addShape=function(k,i){function o(){if(i.bottom)for(var v=0;l>v;v++)K=C[v],w(K[2],K[1],K[0],!0);if(i.top)for(v=0;l>v;v++)K=C[v],w(K[0]+a*P,K[1]+a*P,K[2]+a*P,!1)}function d(){var M=0;for(J(V,M),M+=V.length,x=0,z=v.length;z>x;x++)F=v[x],J(F,M),M+=F.length}function J(e,t){for(var v,Q,d=e.length;--d>=0;){v=d,Q=d-1,0>Q&&(Q=e.length-1);var j=0,C=P;for(j=0;C>j;j++){var h=a*j,B=a*(j+1),F=t+v+h,l=t+Q+h,n=t+Q+B,K=t+v+B;c(F,l,n,K,e,j,C,v,Q)}}}function $(m,H,V){B.vertices.push(new hh(m,H,V))}function w(F,M,p,W){F+=I,M+=I,p+=I,B.faces.push(new up(F,M,p,null,null,W?2:1));var J=W?Q.generateBottomUV(B,k,i,F,M,p):Q.generateTopUV(B,k,i,F,M,p);B.faceVertexUvs[0].push(J)}function c(d,L,r,Z,C,w,W,g,b){d+=I,L+=I,r+=I,Z+=I,B.faces.push(new up(d,L,Z)),B.faces.push(new up(L,r,Z));var G=Q.generateSideWallUV(B,k,C,i,d,L,r,Z,w,W,g,b);B.faceVertexUvs[0].push([G[0],G[1],G[3]]),B.faceVertexUvs[0].push([G[1],G[2],G[3]])}var R,X,e,A,n,H=i.amount,u=i.curveSegments||vp,P=i.steps||1,g=i.extrudePath,W=!1,Q=new xp(i.repeatUVLength);g&&(R=g.getSpacedPoints(P),W=!0,X=i.frames!==m?i.frames:new Jm.FrenetFrames(g,P,!1),e=new hh,A=new hh,n=new hh);var F,x,z,B=this,I=this.vertices.length,s=k.extractPoints(u),G=s.shape,v=s.holes,Y=!Xm.isClockWise(G);if(Y){for(G=G.reverse(),x=0,z=v.length;z>x;x++)F=v[x],Xm.isClockWise(F)&&(v[x]=F.reverse());Y=!1}var C=Xm.triangulateShape(G,v),V=G;for(x=0,z=v.length;z>x;x++)F=v[x],G=G.concat(F);for(var b,K,a=G.length,l=C.length,j=0;a>j;j++)b=G[j],W?(A.copy(X.normals[0]).multiplyScalar(b.x),e.copy(X.binormals[0]).multiplyScalar(b.y),n.copy(R[0]).add(A).add(e),$(n.x,n.y,n.z)):$(b.x,b.y,0);var _;for(_=1;P>=_;_++)for(j=0;a>j;j++)b=G[j],W?(A.copy(X.normals[_]).multiplyScalar(b.x),e.copy(X.binormals[_]).multiplyScalar(b.y),n.copy(R[_]).add(A).add(e),$(n.x,n.y,n.z)):$(b.x,b.y,H/P*_);o(),d()};var Jm=function(m,b,S,v,Y){function x(M,o,i){return g.vertices.push(new hh(M,o,i))-1}bg.call(this),b=b||64,S=S||1,v=v||8,Y=Y||!1;var y,p,t,K,w,$,A,L,P,z,l,U,F,s,k,r,c,d,E,M,u=[],g=this,T=b+1,G=new hh,B=new Jm.FrenetFrames(m,b,Y),e=B.tangents,O=B.normals,I=B.binormals;for(this.tangents=e,this.normals=O,this.binormals=I,P=0;T>P;P++)for(u[P]=[],K=P/(T-1),L=m.getPointAt(K),y=e[P],p=O[P],t=I[P],z=0;v>z;z++)w=z/v*H,$=-S*W(w),A=S*n(w),G.copy(L),G.x+=$*p.x+A*t.x,G.y+=$*p.y+A*t.y,G.z+=$*p.z+A*t.z,u[P][z]=x(G.x,G.y,G.z);for(P=0;b>P;P++)for(z=0;v>z;z++)l=Y?(P+1)%b:P+1,U=(z+1)%v,F=u[P][z],s=u[l][z],k=u[l][U],r=u[P][U],c=new go(P/b,z/v),d=new go((P+1)/b,z/v),E=new go((P+1)/b,(z+1)/v),M=new go(P/b,(z+1)/v),this.faces.push(new up(F,s,r)),this.faceVertexUvs[0].push([c,d,M]),this.faces.push(new up(s,k,r)),this.faceVertexUvs[0].push([d.clone(),E,M.clone()]);
this.computeFaceNormals(),this.computeVertexNormals()};Jm.prototype=gm(Sk),Jm.FrenetFrames=function(j,u,W){function h(){k[0]=new hh,c[0]=new hh,$=Number.MAX_VALUE,f=G(d[0].x),R=G(d[0].y),v=G(d[0].z),$>=f&&($=f,I.set(1,0,0)),$>=R&&($=R,I.set(0,1,0)),$>=v&&I.set(0,0,1),U.crossVectors(d[0],I).normalize(),k[0].crossVectors(d[0],U),c[0].crossVectors(d[0],k[0])}var w,$,f,R,v,D,g,I=new hh,d=[],k=[],c=[],U=new hh,i=new rr,x=u+1,T=1e-4;for(this.tangents=d,this.normals=k,this.binormals=c,D=0;x>D;D++)g=D/(x-1),d[D]=j.getTangentAt(g),d[D].normalize();for(h(),D=1;x>D;D++)k[D]=k[D-1].clone(),c[D]=c[D-1].clone(),U.crossVectors(d[D-1],d[D]),U.length()>T&&(U.normalize(),w=y(Xd(d[D-1].dot(d[D]),-1,1)),k[D].applyMatrix4(i.makeRotationAxis(U,w))),c[D].crossVectors(d[D],k[D]);if(W)for(w=y(Xd(k[0].dot(k[x-1]),-1,1)),w/=x-1,d[0].dot(U.crossVectors(k[0],k[x-1]))>0&&(w=-w),D=1;x>D;D++)k[D].applyMatrix4(i.makeRotationAxis(d[D],w*D)),c[D].crossVectors(d[D],k[D])};var Bn=function(w,R,I,d){bg.call(this),R=R||18,I=I||0,d=d==A?H:d;for(var x=1/(w.length-1),V=1/R,F=0,c=R;c>=F;F++)for(var D=I+F*V*d,m=W(D),K=n(D),Q=0,T=w.length;T>Q;Q++){var f=w[Q],S=new hh;S.x=m*f.x-K*f.y,S.y=K*f.x+m*f.y,S.z=f.z,this.vertices.push(S)}for(var z=w.length,F=0,c=R;c>F;F++)for(var Q=0,T=w.length-1;T>Q;Q++){var $=Q+z*F,v=$,G=$+z,m=$+1+z,o=$+1,C=F*V,e=Q*x,h=C+V,u=e+x;this.faces.push(new up(v,o,G)),this.faceVertexUvs[0].push([new go(C,e),new go(C,u),new go(h,e)]),this.faces.push(new up(G,o,m)),this.faceVertexUvs[0].push([new go(h,e),new go(C,u),new go(h,u)])}this.mergeVertices(),Tk(this),this.computeFaceNormals(),this.computeVertexNormals()};Bn.prototype=gm(Sk);var Vm=function(w,p){p=p||{};var q=vc.generateShapes(w,p);p.amount=p.amount!==m?p.amount:.5,p.convertYZ=!1,p.fill!==!1&&(p.bottom=!0,p.top=!0),Di.call(this,q,p)};Vm.prototype=gm(Qr);var fh=f.Node=function(){To(fh,this)},Rl={X:$b,Y:Vk,Z:Mi},Zi={X:0,Y:1,Z:2},Fk={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},vk="xzy",Ac=function(I,w,z){if(w){var J=w[0],r=w[1],O=w[2];"xzy"===z?(Vk(I,r),Mi(I,O),$b(I,J)):"xyz"===z?(Mi(I,O),Vk(I,r),$b(I,J)):"yxz"===z?(Mi(I,O),$b(I,J),Vk(I,r)):"yzx"===z?($b(I,J),Mi(I,O),Vk(I,r)):"zxy"===z?(Vk(I,r),$b(I,J),Mi(I,O)):"zyx"===z?($b(I,J),Vk(I,r),Mi(I,O)):(Vk(I,r),Mi(I,O),$b(I,J))}};Pd("Node",xo,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:vk,_64O:0,_rotationX:0,_53O:0,_host:A,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return mf},_22Q:function(){return Rm},getX:function(){return this.p().x},setX:function(k){this.p(k,this.p().y)},getY:function(){return this.p().y},setY:function(t){this.p(this.p().x,t)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(t){this.setAnchor(t,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(R){this.setAnchor(this.getAnchor().x,R)},getScaleX:function(){return this.getScale().x},setScaleX:function(h){this.setScale(h,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(D){this.setScale(this.getScale().x,D)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(R,t){li(R,Hp(A,A,this.r3(),this.getRotationMode())),this.translate3d(R[0]*t,R[1]*t,R[2]*t)},translateFront:function(P){this.translate3dBy([0,0,1],P)},translateBack:function(m){this.translate3dBy([0,0,-1],m)},translateLeft:function(p){this.translate3dBy([-1,0,0],p)},translateRight:function(E){this.translate3dBy([1,0,0],E)},translateTop:function(I){this.translate3dBy([0,1,0],I)},translateBottom:function(x){this.translate3dBy([0,-1,0],x)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(C,l,T){1===arguments.length&&(l=C[1],T=C[2],C=C[0]),this.p(C,T),this.setElevation(l)},translate3d:function(R,u,w){1===arguments.length&&(u=R[1],w=R[2],R=R[0]),this.translate(R,w),this.setElevation(this._54O+u)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(I,S,B){1===arguments.length&&(S=I[1],B=I[2],I=I[0]),this.setSize(I,B),this.setTall(S)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(S,G,$){1===arguments.length&&(G=S[1],$=S[2],S=S[0]),this.setRotationX(S),this.setRotation(-G),this.setRotationZ($)},setRotationY:function(d){this.setRotation(-d)},getRotationY:function(){return-this._64O},lookAtDirection:function(T,P){P=P||Jn;var E=this,h=Ng(T);P===Jn?(E.r3([-o(T[1]/h),-b(T[2],T[0])+Z,0]),E.setRotationMode("xzy")):P===Nl?(E.r3(0,-b(T[2],T[0]),o(T[1]/h)),E.setRotationMode("zyx")):P===zd?(E.r3(0,-b(T[2],T[0])+s,-o(T[1]/h)),E.setRotationMode("zyx")):P===kq?(E.r3([-o(T[1]/h)+Z,-b(T[2],T[0])+Z,0]),E.setRotationMode("xzy")):P===Ud&&(E.r3([-o(T[1]/h)-Z,-b(T[2],T[0])+Z,0]),E.setRotationMode("xzy")),P===rd&&(E.r3([-o(T[1]/h)+s,-b(T[2],T[0])+Z,s]),E.setRotationMode("zxy"))},lookAt:function(B,k){return this.lookAtDirection(Dg(B,this.p3()),k)},lookAtX:function(){var x=new ur,E=new ur,Q=new ur,n=new Jb,V=new Jb,k=new xn;return function(j,G){var w=Vl(this);if(n.fromArray(w),Q.copy(this.p3()),x.copy(j).sub(Q),!(x.lengthSq()<1e-6)){x.normalize(),G===Jn?E.set(0,0,1):G===rd?E.set(0,0,-1):G===zd?E.set(-1,0,0):G===Nl?E.set(1,0,0):G===kq?E.set(0,1,0):G===Ud&&E.set(0,-1,0),E.applyMatrix4(n).sub(Q).normalize();var I=Math.acos(x.dot(E));if(I){var z=x.clone().cross(E);z.lengthSq()<1e-6&&(G===kq||G===Ud?z.set(0,0,1).applyMatrix4(n).sub(Q):z.set(0,1,0).applyMatrix4(n).sub(Q)),z.normalize(),k.set(this.r3(),this.getRotationMode(),!0),n.makeRotationFromEuler(k),V.makeRotationAxis(z,-I),k.setFromRotationMatrix(V.multiply(n)),this.r3([k.x,k.y,k.z])}}}}(),getHost:function(){return this._host},setHost:function(V){var R=this;if(R!==V&&R._host!==V){var b=R._host;b&&b._removeAttach(R),R._host=V,R._host&&R._host._addAttach(R),R.fp("host",b,V),R.onHostChanged(b,V)}},getAttaches:function(){return this._69O},_addAttach:function(M){var r=this;r._69O||(r._69O=new Dj),r._69O.add(M),r.fp("attaches",A,M)},_removeAttach:function(T){var I=this;I._69O.remove(T),I._69O.isEmpty()&&delete I._69O,I.fp("attaches",T,A)},getImage:function(){if(this._pendingCheckImageJSON){var V=O.getImage(this._image);V&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof $l&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(h){var z=this,p=z._image,y=z.getWidth(),x=z.getHeight();z._image=h,z.fp("image",p,h)&&(null!=h&&(Bq(h)||xr(h)&&/\.json$/i.test(h))&&(this._pendingCheckImageJSON=!0),z.fp(Dr,y,z.getWidth()),z.fp(On,x,z.getHeight()))},getElevation:function(){return this._54O},setElevation:function(p){var z=this;if(!z._50O){z._50O=1;var U=z._54O;z._54O=p,z.fp(Ge,U,p),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(u){var d=this;if(!d._49O){d._49O=1;var Y=d._64O;d._64O=u,d.fp(jk,Y,u),delete d._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(V){var O=this;if(!O._51O){O._51O=1;var k=O._rotationX;O._rotationX=V,O.fp("rotationX",k,V),delete O._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(N){var P=this;if(!P._52O){P._52O=1;var O=P._53O;P._53O=N,P.fp("rotationZ",O,N),delete P._52O}},getPosition:function(){return this._position},setPosition:function(H,p){var f=this;if(!f._50I){f._50I=1;var M;if(M=2===arguments.length?{x:H,y:p}:H,M.x!==f._position.x||M.y!==f._position.y){var b=f._position;f._position=M,f.fp(si,b,M)}delete f._50I}},translate:function(o,R){var $=this._position;this.p($.x+o,$.y+R)},getWidth:function(){var k=this;if(k._width>=0)return k._width;var f=k.getStyle("shape3d");if(f){var y=Th(f);if(y&&y.rawS3)return y.rawS3[0];if("billboard"===f||"plane"===f){var T=qg(k.getStyle("shape3d.image"));return T?Wb(T,k):20}}var T=qg(k._image);return T?Wb(T,k):20},setWidth:function(h){var d=this,R=d._width;d._width=h,d.fp(Dr,R,h)},getHeight:function(){var W=this;if(W._height>=0)return W._height;var G=W.getStyle("shape3d");if(G){var J=Th(G);if(J&&J.rawS3)return J.rawS3[2];if("plane"===G){var O=qg(W.getStyle("shape3d.image"));return O?js(O,W):20}if("billboard"===G)return 2}var O=qg(W._image);return O?js(O,W):20},setHeight:function(d){var s=this,c=s._height;s._height=d,s.fp(On,c,d)},getTall:function(){var s=this;if(s._tall>=0)return s._tall;var a=s.getStyle("shape3d");if(a){var g=Th(a);if(g&&g.rawS3)return g.rawS3[1];if("billboard"===a){var O=qg(s.getStyle("shape3d.image"));return O?js(O,s):20}if("plane"===a)return 2}return 20},setTall:function(b){var m=this,t=m._tall;m._tall=b,m.fp("tall",t,b)},setSize:function(K,s){var O=this;2===arguments.length?(O.setWidth(K),O.setHeight(s)):(O.setWidth(K.width),O.setHeight(K.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(P,F,t,C,y){var v=this,c=v.getAnchor(),U=v.getScale();arguments.length<=2&&(y=F,F=P.y,t=P.width,C=P.height,P=P.x);var L=y&&U.x<0?1-c.x:c.x,Z=y&&U.y<0?1-c.y:c.y;v.p(P+t*L,F+C*Z),y&&(t/=Math.abs(U.x),C/=Math.abs(U.y)),v.setWidth(t),v.setHeight(C)},getMatrix:function(){var l=this,d=l._64O,P=l._position,h=l.getScale();return new Sq(d,P.x,P.y,h.x,h.y)},getAnchorRect:function(){var m=this,L=m.getWidth(),T=m.getHeight(),y=m.getAnchor();return{x:-L*y.x,y:-T*y.y,width:L,height:T}},toLocal:function(c){return this.getMatrix().tfi(c)},toGlobal:function(Q){return this.getMatrix().tf(Q)},getAttachPosition:function(){var z=new Sq;return function(v,h,X,N){X=X||0,N=N||0;var s=this,Q=s.getAnchor(),g=s._64O,W=s._position,a=s.getScale();return z.setFromTransform(g,W.x,W.y).tf({x:X+a.x*s.getWidth()*(v-Q.x),y:N+a.y*s.getHeight()*(h-Q.y)})}}(),isInRect:function(R){R=this.toLocal(R);var i=this.getWidth(),s=this.getHeight();return R.x+=i*this.getAnchorX(),R.y+=s*this.getAnchorY(),!(R.x<0||R.y<0||R.x>i||R.y>s)},getRect:function(){var r=this,F=r.getWidth(),s=r.getHeight(),d=r.getAnchor(),a={x:-F*d.x,y:-s*d.y,width:F,height:s},n=r.getMatrix();return a=pj([n.tf(a.x,a.y),n.tf(a.x+a.width,a.y),n.tf(a.x+a.width,a.y+a.height),n.tf(a.x,a.y+a.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var F=this,u=F.getAnchor(),b=F._anchorElevation;return{x:u.x,y:b,z:u.y}},setAnchorElevation:function(q){var r=this,I=r._anchorElevation;return I!==q?(r._anchorElevation=q,r.fp("anchorElevation",I,q),!0):!1},setAnchor3d:function(P,n,O,m){var U,r=this;"number"==typeof P?U={x:P,y:n,z:O}:(U=P.length?{x:P[0],y:P[1],z:P[2]}:P,m=n);var f=r.getDataModel();f&&f.beginTransaction();var d=r.getAnchor3d(),z=r.setAnchor(U.x,U.z);if(r.setAnchorElevation(U.y)&&(z=!0),z&&m&&!Nc){r.getAnchor3d();var i=Vl(r),F=li([U.x-d.x,U.y-d.y,U.z-d.z],i);r.p3(F)}return f&&f.endTransaction(),z},getAnchor:function(){var D=this;if(D.hasOwnProperty("_anchor"))return D._anchor;var $=qg(D._image);return $&&$.anchorX!==m?{x:$.anchorX,y:$.anchorY}:D._anchor},setAnchor:function(F,s,X){var r,x=this;"number"==typeof F?r={x:F,y:s}:(r=F.length?{x:F[0],y:F[1]}:F,X=s);var J=x.getAnchor();if(J.x!==r.x||J.y!==r.y){var O=x.getDataModel();if(O&&O.beginTransaction(),x._anchor=r,x.fp("anchor",J,r),X&&!Nc){var P=x.getPosition(),k=x.getSize(),N=x.getRotation(),u=x.getScale(),f=-k.width*(J.x-r.x)*u.x,C=-k.height*(J.y-r.y)*u.y,w=n(N),R=W(N);x.setPosition(P.x+R*f-w*C,P.y+w*f+R*C)}return O&&O.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(A,X){var w,M=this;w=2===arguments.length?{x:A,y:X}:A;var f=M.getScale();(f.x!==w.x||f.y!==w.y)&&(M._scale=w,M.fp("scale",f,w))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var e=this,C=e._scaleTall,s=e.getScale();return[s.x,C,s.y]},getFinalScale3d:function(){var F=this,G=F.s3(),J=F._dynamicScale3d,z=F.getScale3d();return G&&(z[0]*=G[0],z[1]*=G[1],z[2]*=G[2]),J&&(z[0]*=J[0],z[1]*=J[1],z[2]*=J[2]),z},getFinalRotation3d:function(){var Z=this;return Z._dynamicRotation||Z.r3()},setScaleTall:function(x){var H=this,r=H._scaleTall;r!==x&&(H._scaleTall=x,H.fp("scaleTall",r,x))},setScale3d:function(S,o,T){var F,C=this;F="number"==typeof S?{x:S,y:o,z:T}:S.length?{x:S[0],y:S[1],z:S[2]}:S,C.setScaleTall(F.y),C.setScale(F.x,F.z)},getCorners:function(V,v){V==A&&(V=0),v==A&&(v=V);var T=this,H=T.getAnchor(),z=T.getWidth(),y=T.getHeight(),U=-z*H.x-V,k=-y*H.y-v,P=z+2*V,N=y+2*v,B=T.getMatrix();return[B.tf(U,k),B.tf(U,k+N),B.tf(U+P,k+N),B.tf(U+P,k)]},getEditControlPoints:function(f,p,P){p==A&&(p=0),P==A&&(P=p);var z=this,Z=z.getAnchor(),q=z.getWidth(),$=z.getHeight(),D=-q*Z.x-p,V=-$*Z.y-P,F=q+2*p,T=$+2*P;if(f)return[{x:D,y:V},{x:D,y:0},{x:D,y:V+T},{x:0,y:V+T},{x:D+F,y:V+T},{x:D+F,y:0},{x:D+F,y:V},{x:0,y:V}];var s=z.getMatrix();return[s.tf(D,V),s.tf(D,0),s.tf(D,V+T),s.tf(0,V+T),s.tf(D+F,V+T),s.tf(D+F,0),s.tf(D+F,V),s.tf(0,V)]},rotateAt:function(z,j,L){var $=this,V=$._position,g=$._64O,N=new Sq(g,V.x,V.y).tf(z,j),I=r(z*z+j*j),u=b(V.y-N.y,V.x-N.x)+L;$.setRotation(g+L),$.p(N.x+I*W(u),N.y+I*n(u))},onParentChanged:function(){fh.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var I={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(_){I[_]=!0}),function(p){var G=this;fh.superClass.onPropertyChanged.call(G,p),I[p.property]&&!G._layoutUpdating&&G.updateLayoutParameters(null,p.property),G._69O&&G._69O.each(function(E){E.handleHostPropertyChange(p)}),G._49I&&G._49I.each(function(u){u.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(D){this.updateAttach(D)},onStyleChanged:function(A){fh.superClass.onStyleChanged.apply(this,arguments),Xb[A]&&this.updateAttach()},updateAttach:function(e){var m=this;return Nc?(m.updateLayoutParameters(),void 0):(m._51I||(m._51I=1,m._71O(e),delete m._51I),void 0)},_71O:function(y){var u,t,d,l,S,n,C=this,s=C._host,_=y?y.property:A,G=y?y.oldValue:A,L=y?y.newValue:A;if(s instanceof f.Grid){if(_===Ge)C.setElevation(C._54O+L-G);else if(!y||Sl[_]){if(u=C.s("attach.row.index"),t=C.s("attach.column.index"),d=s.getCellRect(u,t),!d)return;l=C.s("attach.row.span"),S=C.s("attach.column.span"),(1!==l||1!==S)&&(d=nm(d,s.getCellRect(u+l-1,t+S-1))),og(d,C,"attach.padding",1),C.setRect(d)}}else if(s instanceof jo&&(n=C.s("attach.index"))>=0&&(!y||Ji[_])){var M=C.s("attach.thickness");M!=A&&C.setHeight(s.getThickness()*M);var g=C.s("attach.offset"),X=s.getPoints(),E=X.size();if(E>n){var i=X.get(n),z=E===n+1?X.get(0):X.get(n+1),a=[z.x-i.x,z.y-i.y],O=Ng(a);if(O){C.s("attach.offset.relative")&&(g*=O),C.s("attach.offset.opposite")&&(g=O-g);var v={x:i.x+a[0]/O*g,y:i.y+a[1]/O*g},h=C.s("attach.gap");h&&(C.s("attach.gap.relative")&&(h*=s.getThickness()),v=ih(A,v,z,h)),C.p(v),C.setRotation(b(a[1],a[0]))}}}else y&&(_===si?C.translate(L.x-G.x,L.y-G.y):_===Ge?C.setElevation(C._54O+L-G):vb[_]?C._11Q(s,_,L-G):("anchor"===_||"width"===_||"height"===_||"scale"===_)&&C.layout(s))},_11Q:function(){var o=new f.Math.Euler,K=f.Math.Euler.ReverseOrder,J=new f.Math.Vector2,h=new f.Math.Vector2;return function(V,T,i){var w=this,a=V.p3(),E=V.r3(),t=w.p3(),q=w.r3();if(T===jk&&(T="rotationY",i=-i),(T===jk||"rotationY"===T)&&0===q[0]&&0===q[2]&&0===E[0]&&0===E[2]&&0===t[1]&&0===a[1])return w.setRotation(-q[1]-i),J.set(t[0],t[2]).rotateAround(h.set(a[0],a[2]),-i),w.p(J.x,J.y),void 0;var d=Fk[V.getRotationMode()],r=d[0],H=d[1],A=d[2],z=Rl[r],y=Rl[H],n=Rl[A],C=co();T===jk+r?(n(C,E[Zi[A]]),y(C,E[Zi[H]]),z(C,i),y(C,-E[Zi[H]]),n(C,-E[Zi[A]])):T===jk+H?(n(C,E[Zi[A]]),y(C,i),n(C,-E[Zi[A]])):T===jk+A&&n(C,i);var D=Dg(t,a);li(D,C),w.p3(a[0]+D[0],a[1]+D[1],a[2]+D[2]);var x=w.getRotationMode();Ac(C,w.r3(),x),o.setFromRotationMatrix(C,K(x)),w.r3([o.x,o.y,o.z])}}(),isHostOn:function(w){var Q=this;if(Q._host&&w&&w._69O)for(var M={},I=Q._host;I&&I!==Q&&!M[I._id];){if(I===w)return!0;M[I._id]=I,I=I._host}return!1},isLoopedHostOn:function(S){return this.isHostOn(S)&&S.isHostOn(this)},getScaledSize:function(){var w=this.getSize(),l=this.getScale();return w.width*=Math.abs(l.x),w.height*=Math.abs(l.y),w},layout:function(k){if(k=k||this.getHost()){var u=this,t=u.s("layout.h")||"center",T=u.s("layout.v")||"center";if("center"!==t||"center"!==T){var S=new f.Math.Vector2,h=k.getPosition(),n=k.getAnchor(),X=k.getScaledSize();u.getPosition();var I,$,l,P,N,p=1,r=1;switch(u._layoutUpdating=!0,t){case"left":S.setX(u._layoutHValue-n.x*X.width);break;case"right":S.setX((1-n.x)*X.width-u._layoutHValue);break;case"leftright":I=X.width-u._layoutHValue[2],l=u.getRotation()-k.getRotation(),P=Math.abs(Math.sin(l)),N=Math.abs(Math.cos(l)),p+=N*I/u._layoutHValue[3],r+=P*I/u._layoutHValue[4],S.setX(u._layoutHValue[1]+(u._layoutHValue[5]-n.x)*X.width);break;case"center":S.setX((.5-n.x)*X.width-u._layoutHValue);break;case"scale":l=u.getRotation()-k.getRotation(),P=Math.abs(Math.sin(l)),N=Math.abs(Math.cos(l)),S.setX((.5-n.x)*X.width-u._layoutHValue[1]*X.width/u._layoutHValue[0]),$=X.width/u._layoutHValue[2]-1,p+=N*$,r+=P*$}switch(T){case"top":S.setY(u._layoutVValue-n.y*X.height);break;case"bottom":S.setY((1-n.y)*X.height-u._layoutVValue);break;case"topbottom":l||(l=u.getRotation()-k.getRotation(),P=Math.abs(Math.sin(l)),N=Math.abs(Math.cos(l))),I=X.height-u._layoutVValue[2],p+=P*I/u._layoutVValue[3],r+=N*I/u._layoutVValue[4],S.setY(u._layoutVValue[1]+(u._layoutVValue[5]-n.y)*X.height);break;case"center":S.setY((.5-n.y)*X.height-u._layoutVValue);break;case"scale":l||(l=u.getRotation()-k.getRotation(),P=Math.abs(Math.sin(l)),N=Math.abs(Math.cos(l))),S.setY((.5-n.y)*X.height-u._layoutVValue[1]*X.height/u._layoutVValue[0]),$=X.height/u._layoutVValue[2]-1,p+=P*$,r+=N*$}if("leftright"===t||"scale"===t||"topbottom"===T||"scale"===T){var Q=this.getScale(),J=Math.abs(Q.x),c=Math.abs(Q.y);"leftright"===t||"scale"===t?u.setSize(u._layoutHValue[3]*p/J,u._layoutHValue[4]*r/c):u.setSize(u._layoutVValue[3]*p/J,u._layoutVValue[4]*r/c)}S.rotateAround(null,k.getRotation()),this.setPosition(S.x+h.x,S.y+h.y),u._layoutUpdating=m}}},updateLayoutParameters:function(u,Y){if(u=u||this.getHost()){var e=this,Z=e.s("layout.h"),P=e.s("layout.v");if(Z||P){var y,M,_,K,T,H,s=new f.Math.Vector2,D=u.getPosition(),X=u.getAnchor(),g=u.getScaledSize(),q=e.getPosition(),m=e.getScaledSize();switch(s.set(q.x-D.x,q.y-D.y),s.rotateAround(null,-u.getRotation()),Z){case"left":e._layoutHValue=s.x+X.x*g.width;break;case"right":e._layoutHValue=-s.x+(1-X.x)*g.width;break;case"center":e._layoutHValue=-s.x+(.5-X.x)*g.width;break;case"leftright":case"scale":"scale"===Z?y=-s.x+(.5-X.x)*g.width:(M=e.getAnchor(),_=e.getRotation()-u.getRotation(),K=Math.cos(_),T=Math.sin(_),H=-Math.min(-M.x*K+M.y*T,-M.x*K-(1-M.y)*T,(1-M.x)*K+M.y*T,(1-M.x)*K-(1-M.y)*T),y=s.x-(H-X.x)*g.width),"position"===Y&&"object"==typeof e._layoutHValue?(e._layoutHValue[0]=g.width,e._layoutHValue[1]=y):e._layoutHValue=[g.width,y,g.width,m.width,m.height,H]}switch(P){case"top":e._layoutVValue=s.y+X.y*g.height;break;case"bottom":e._layoutVValue=-s.y+(1-X.y)*g.height;break;case"center":e._layoutVValue=-s.y+(.5-X.y)*g.height;break;case"topbottom":case"scale":"scale"===P?y=-s.y+(.5-X.y)*g.height:(_||(M=e.getAnchor(),_=e.getRotation()-u.getRotation(),K=Math.cos(_),T=Math.sin(_)),H=-Math.min(-M.x*T-M.y*K,-M.x*T+(1-M.y)*K,(1-M.x)*T-M.y*K,(1-M.x)*T+(1-M.y)*K),y=s.y-(H-X.y)*g.height),"position"===Y&&"object"==typeof e._layoutVValue?(e._layoutVValue[0]=g.height,e._layoutVValue[1]=y):e._layoutVValue=[g.height,y,g.height,m.width,m.height,H]}}}},getSerializableProperties:function(){var C=fh.superClass.getSerializableProperties.call(this);return kk(C,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),C}});var Qp=f.Edge=function(O,Z){var g=this;To(Qp,g),g.setSource(O),g.setTarget(Z)};Pd("Edge",xo,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Kk},_22Q:function(){return Uo},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(V){if(V===this)return!1;if(uh(V))return!0;for(var v,P,o,j,Z,c=[this],a=-1,m=0;m>a;)if(a++,v=c[a],P=v._44I)for(P=P.getArray(),j=0,Z=P.length;Z>j;j++)if(o=P[j],hl(o)&&!(c.indexOf(o)>=0)){if(o===V)return!1;c.push(o),m++}return!0},setSource:function(U){var S=this;if(S._source!==U&&S.canSetSourceTarget(U)){var m=S._source;S._source=U,m&&m._16I(S),U&&U._2I(S),S._7I(),S.fp("source",m,U)}},setTarget:function(B){var V=this;if(V._target!==B&&V.canSetSourceTarget(B)){var j=V._target;V._target=B,j&&j._18I(V),B&&B._4I(V),V._7I(),V.fp("target",j,B)}},isLooped:function(){var u=this;return u._source===u._target&&uh(u._source)&&uh(u._target)},onPropertyChanged:function(){var e=this;e._49I&&e._49I.each(function(p){p.fp("agentChange",!0,!1)})},_7I:function(){var e,_=this,Q=uf(_);_._40I!==Q&&(e=this._40I,e&&e._15I(_),_._40I=Q,Q&&Q._1I(_),_.fp("sourceAgent",e,Q),Hc(e,_._41I),Hc(Q,_._41I));var L=Il(_);_._41I!==L&&(e=_._41I,e&&e._17I(_),_._41I=L,L&&L._3I(_),_.fp("targetAgent",e,L),Hc(e,_._40I),Hc(L,_._40I))},_22I:function(C){this._52I=C,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var u=this;return u._52I&&u._52I.get(0)!==u&&!u.getStyle(Oi)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var C=this,L=C._52I;return L&&!C.getStyle(Oi)&&L.size()>1&&C===L.get(0)},toggle:function(){var j=this._52I,W=!this.s(Oi);j&&j.size()>1&&(j.each(function($){$.s(Oi,W)}),j.getSiblings().each(function(D){D!==j&&D.each(function(J){J.fp("edgeGroup",A,D)})}))},setStyle:function(X,e){(X===kj||"edge.segments"===X)&&(e=_b(e)),Qp.superClass.setStyle.call(this,X,e)},onStyleChanged:function(r){Qp.superClass.onStyleChanged.apply(this,arguments),Zc[r]&&Hc(this._41I,this._40I)},getSerializableProperties:function(){var J=Qp.superClass.getSerializableProperties.call(this);return kk(J,{source:1,target:1}),J}});var Ub=f.Group=function(){To(Ub,this)};Pd("Group",fh,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Og},onChildAdded:function(){Ub.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Ub.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var L=this;if(!L._54I&&!Nc){var j=L.getChildrenRect();j&&(L._53I=1,L.p(Ef(L.s("group.position"),j,L.getSize())),delete L._53I)}},getChildrenRect:function(){var o,m=this;return m.eachChild(function(j){uh(j)&&(o=nm(o,m.getChildRect(j)))}),o},getChildRect:function(O){var a;return uh(O)&&O.s(Yb)&&(Lg(O)&&O.isExpanded()&&O.eachChild(function(I){a=nm(a,O.getChildRect(I))}),!a&&O.getRect&&(a=O.getRect())),a},setPosition:function(i,h){var v=this;if(!v._54I){var g;g=2===arguments.length?{x:i,y:h}:i,Nc||v._53I||(v._54I=1,Hj(v._children,g.x-v._position.x,g.y-v._position.y),delete v._54I),Ub.superClass.setPosition.call(this,g)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(y){var q=this;if(q._57O!==y){var U=q._57O;q._57O=y,q.fp("expanded",U,q._57O),q._fireInvalidateDeep(),q._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(g){Lg(g)?g._fireInvalidateDeep():g.iv()})},_8I:function(){Ub.superClass._8I.call(this),this.eachChild(function(b){uh(b)&&b._8I()})},onStyleChanged:function(O){Ub.superClass.onStyleChanged.apply(this,arguments),"group.position"===O&&this._81I()},getSerializableProperties:function(){var x=Ub.superClass.getSerializableProperties.call(this);return x.expanded=1,x}});var bb=f.Block=function(){To(bb,this)};Pd("Block",fh,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return uk},onChildAdded:function(){bb.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){bb.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var O=this;if(!Nc&&!O._updatingToChildren&&O._syncSize&&!O._freezeSyncFromChildren){var k,g,T,Q,F,v=[],w=O.getRotation();if(O.eachChild(function(u){uh(u)&&v.push.apply(v,u.getCorners())}),v.length){O._updatingFromChildren=1;var I=W(-w),M=n(-w),u=1/0,b=-1/0,r=1/0,l=-1/0;for(Q=0,F=v.length;F>Q;Q++)T=v[Q],k=T.x,g=T.y,T.x=I*k-M*g,T.y=M*k+I*g,u=Y(u,T.x),b=$(b,T.x),r=Y(r,T.y),l=$(l,T.y);var N=O.getScale();O.setSize(G((b-u)/N.x),G((l-r)/N.y));var E;N.x<0&&(E=u,u=b,b=E),N.y<0&&(E=r,r=l,l=E),I=W(w),M=n(w);var U=O.getAnchor();k=u+(b-u)*U.x,g=r+(l-r)*U.y,O.setPosition(I*k-M*g,M*k+I*g),delete O._updatingFromChildren}}},setPosition:function(x,c){var Y=this;if(!Y._updatingToChildren){var V;V=2===arguments.length?{x:x,y:c}:x,Nc||Y._updatingFromChildren||(Y._updatingToChildren=1,Hj(Y._children,V.x-Y._position.x,V.y-Y._position.y),delete Y._updatingToChildren),bb.superClass.setPosition.call(this,V)}},setWidth:function(m){return this.setSize(m,this.getHeight())},setHeight:function(y){return this.setSize(this.getWidth(),y)},setSize:function(G,h){1>G&&(G=1),1>h&&(h=1);var f=this;if(!f._updatingToChildren){2!==arguments.length&&(h=G.height,G=G.width);var a=f.getWidth(),n=f.getHeight();if(G!==a&&bb.superClass.setWidth.call(f,G),h!==n&&bb.superClass.setHeight.call(f,h),!Nc&&!f._updatingFromChildren){f._updatingToChildren=1;var l=G/a,T=h/n;f._adjustChildScaleOrSize(l,T,"size"),delete f._updatingToChildren,f.updateFromChildren()}}},_adjustChildScaleOrSize:function(E,N,h){var H=this;if(H._syncSize){var x=H.getPosition(),F=H.getRotation();H.getScale(),H.eachChild(function(P){if(uh(P)){var o=P.getPosition(),Y=P.getRotation(),O=P.getWidth(),C=P.getHeight(),$=P.getScale(),S=$.x*O,A=$.y*C,L=new Sq(Y,o.x,o.y,S,A);L.translate(-x.x,-x.y),L.rotate(-F),Y=b(L.b*Math.sign(S),L.a*Math.sign(S)),L.scale(E,N);var u,e,Q,j=W(Y);if(Math.abs(j)<.001?(u=n(Y),e=L.b/u,Q=-L.c/u):(e=L.a/j,Q=L.d/j),"scale"===h)P.setScale(e/O,Q/C);else if("size"===h){var r=e/$.x,J=Q/$.y;P.setScale(Wq(e)*Math.abs($.x),Wq(Q)*Math.abs($.y)),P instanceof f.Shape?(P.setWidthForce(Math.max(Math.abs(r),1e-5)),P.setHeightForce(Math.max(Math.abs(J),1e-5))):P.setSize(Math.max(.01,Math.abs(r)),Math.max(.01,Math.abs(J)))}L.rotate(F),L.translate(x.x,x.y),P.setPosition(L.tx,L.ty)}})}},_calcChangeFactor:function(V,W,R,H){var C,X,Y,N;return C=G(V),X=G(R),Y=C>X?C/X:X/C,C=G(W),X=G(H),N=C>X?C/X:X/C,$(Y,N)},setAnchor:function(){var Z=this;if(!Z._updatingToChildren){var N=Z.getAnchor();if(bb.superClass.setAnchor.apply(Z,arguments),!Nc&&!Z._updatingFromChildren&&Z._syncSize){Z._updatingToChildren=1;var m=Z.getAnchor();Z.getPosition();var f=Z.getSize(),I=Z.getScale(),c=Z.getRotation(),G=-f.width*I.x*(N.x-m.x),o=-f.height*I.y*(N.y-m.y),F=n(c),D=W(c),T=D*G-F*o,C=F*G+D*o;Z.eachChild(function(r){if(uh(r)){var P=r.getPosition();r.setPosition(P.x-T,P.y-C)}}),delete Z._updatingToChildren}}},setRotation:function(_){var l=this;if(!l._updatingToChildren){var P=l.getRotation();if(bb.superClass.setRotation.apply(l,arguments),!Nc&&!l._updatingFromChildren){l._updatingToChildren=1;var C=l.getPosition(),p=_-P;l.eachChild(function(e){if(uh(e)){var a=e.getMatrix();a.translate(-C.x,-C.y),a.rotate(p),a.translate(C.x,C.y);var l=Math.sign(e.getScale().x);e.setRotation(b(a.b*l,a.a*l)),e.setPosition(a.tx,a.ty)}}),delete l._updatingToChildren}}},setScale:function(F,D){var p=this;if(!p._updatingToChildren){null==D&&(D=F.y,F=F.x);var z=p.getScale();if(G(F)<.01&&(F=.01*(Wq(F)||Wq(z.x))),G(D)<.01&&(D=.01*(Wq(D)||Wq(z.y))),bb.superClass.setScale.call(p,F,D),!Nc&&!p._updatingFromChildren){p._updatingToChildren=1;var L=F/z.x,g=D/z.y;p._adjustChildScaleOrSize(L,g,"size"),delete p._updatingToChildren,p.updateFromChildren()}}},getSerializableProperties:function(){var F=bb.superClass.getSerializableProperties.call(this);return F.clickThroughEnabled=1,F.syncSize=1,F}});var qq=f.Grid=function(){To(f.Grid,this)};Pd("Grid",fh,{IRotatable:!1,_icon:"grid_icon",_image:A,getUIClass:function(){return Fd},setRotation:function(){},getCellRect:function(s,B){var F=this,u=F.s("grid.row.count"),O=F.s("grid.column.count");if(0>=u||0>=O||0>s||s>=u||0>B||B>=O)return A;var l,z,r,v=F.getRect(),q=F.s("grid.row.percents"),C=F.s("grid.column.percents");if(og(v,F,"grid.border",-1),q&&q._as&&(q=q._as),C&&C._as&&(C=C._as),q&&q.length===u){for(r=0,l=0;s>l;l++)r+=v.height*q[l];v.y+=r,v.height=v.height*q[s]}else v.height=v.height/u,v.y+=v.height*s;if(C&&C.length===O){for(z=0,l=0;B>l;l++)z+=v.width*C[l];v.x+=z,v.width=v.width*C[B]}else v.width=v.width/O,v.x+=v.width*B;return ki(v,-F.s("grid.gap")),v}});var Qb=f.Text=function(){To(Qb,this),this.setSize(100,50),this.s("text","TEXT")};Pd("Text",fh,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return So},setWidth:function(R){R||(R=.001),Qb.superClass.setWidth.call(this,R)},setHeight:function(t){t||(t=.001),Qb.superClass.setHeight.call(this,t)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),fp("__text__",{width:{value:100,isSafeFunc:!0,func:function(n){return n._width}},height:{value:50,isSafeFunc:!0,func:function(b){return b._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var jo=f.Shape=function(){To(jo,this),this._59O=new Dj};jo.__de__=wi,Pd("Shape",fh,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return ic},_22Q:function(){return Cb},getLength:function(x){return Do(sn(this._59O,this._58O,x,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var W=this._58O;return W?new Dj(W._as.slice(0)):W},setSegments:function(d){var Q=this._58O;d=d?Nq(d)?new Dj(d.slice(0)):new Dj(d._as.slice(0)):null,(Q&&d&&Q._as.join(",")!==d._as.join(",")||Q!==d)&&(this._58O=d,this.fp("segments",Q,d))},getPoints:function(){return this._59O},toPoints:function(){var O=this._59O;return new Dj(O._as.slice(0))},setPoints:function(E,M){var d=this,s=d._59O;E=E?Nq(E)?new Dj(E.slice(0)):new Dj(E._as.slice(0)):new Dj;var q,y,H,I,o,c;M&&(q=d.getPosition(),c=new Sq(d.getRotation(),0,0,d.getScale().x,d.getScale().y)),(s&&E&&s._as.join(",")!==E._as.join(",")||s!==E)&&(d._59O=E,d.fs(),d.fp("points",s,E)),M&&(y=d.getPosition(),H=y.x-q.x,I=y.y-q.y,o=c.tf(H,I),d.setPosition(y.x-H+o.x,y.y-I+o.y))},addPoint:function(H,y,f){var V=this.toPoints();V.add(H,y),this.setPoints(V,f)},setPoint:function(g,F,t){var q=this.toPoints();q.set(g,F),this.setPoints(q,t)},removePointAt:function(Q){var T=this.toPoints();T.removeAt(Q),this.setPoints(T)},setWidthForce:function(f){var j=this;if(!j._55I&&!Nc&&j.getWidth()){j._55I=1;var z=j._position.x,l=f/j.getWidth(),e=j.toPoints(),u=new Dj;1!==l&&(e.each(function(i){u.add({x:(i.x-z)*l+z,y:i.y,e:i.e})}),j.setPoints(u),Wl(j,[l,0,0,1,z*(1-l),0]),j.fs()),delete j._55I}jo.superClass.setWidth.call(j,f)},setWidth:function(n){return this.setWidthForce(1>n?1:n)},setHeightForce:function(R){var M=this;if(!M._55I&&!Nc&&M.getHeight()){M._55I=1;var X=M._position.y,N=R/M.getHeight(),s=M.toPoints(),q=new Dj;1!==N&&(s.each(function(E){q.add({x:E.x,y:(E.y-X)*N+X,e:E.e})}),M.setPoints(q),Wl(M,[1,0,0,N,0,X*(1-N)]),M.fs()),delete M._55I}jo.superClass.setHeight.call(M,R)
},setHeight:function(a){return this.setHeightForce(1>a?1:a)},setAnchorElevation:function(b){var E=this;E._55I=!0;var q=E._updatingAnchor3d,f=!Nc&&!q;if(f){var O,t=b,H=E.getAnchorElevation(),M=E.getTall();O=M*(H-t),0!==O&&E.shiftPointsElevation(O)}var _=jo.superClass.setAnchorElevation.apply(E,arguments);return q||delete E._55I,_},getShapeElevation:function(){var F=this,P=F._54O;return P-(F.getTall()||0)*(F._anchorElevation-.5)},setAnchor3d:function(m,r,w,P){var s,j=this;"number"==typeof m?s={x:m,y:r,z:w}:(s=m.length?{x:m[0],y:m[1],z:m[2]}:m,P=r),j._55I=!0,j._updatingAnchor3d=!0;var y=j.getDataModel();if(y&&y.beginTransaction(),!Nc){var J=j.getAnchor3d(),c=j.getSize(),X=j.getTall(),M=c.width*(J.x-s.x),L=c.height*(J.z-s.z),O=X*(J.y-s.y);P||j.shiftPoints(M,L,O);var D=j.p3()}var v=jo.superClass.setAnchor3d.apply(j,arguments);if(!Nc&&P){var z=j.p3();j.shiftPoints(z[0]-D[0]+M,z[2]-D[2]+L,z[1]-D[1]+O)}return y&&y.endTransaction(),delete j._updatingAnchor3d,delete j._55I,v},setAnchor:function(S,L,Q){var g=this;g._55I=!0;var w=g._updatingAnchor3d,A=!Nc&&!w;if(A){var P,H,W;"number"==typeof S?W={x:S,y:L}:(W=S.length?{x:S[0],y:S[1]}:S,Q=L);var v=g.getAnchor(),q=g.getSize();P=q.width*(v.x-W.x),H=q.height*(v.y-W.y),Q||g.shiftPoints(P,H);var u=g.getPosition()}var n=jo.superClass.setAnchor.apply(g,arguments);if(A){var h=g.getPosition();Q&&g.shiftPoints(h.x-u.x+P,h.y-u.y+H)}return w||delete g._55I,n},shiftPoints:function(C,S,w){if(C||S||w){var k=this,Z=k.getElevation()||0,n=k.toPoints(),X=new Dj;n.each(function(m){var t=m.e;w&&(t=(t==A?Z:t)+w),X.add({x:m.x+C,y:m.y+S,e:t})}),k.setPoints(X),k.fs()}},shiftPointsElevation:function(q){return this.shiftPoints(0,0,q)},setPosition:function(Y,v){var u,g=this;if(!g._28Q){if(g._28Q=1,!g._55I&&!Nc){u=2===arguments.length?{x:Y,y:v}:Y;var $=u.x-g._position.x,_=u.y-g._position.y;if(0===$&&0===_)return delete g._28Q,void 0;g._55I=1,g.shiftPoints($,_),Wl(g,[1,0,0,1,$,_]),delete g._55I}jo.superClass.setPosition.apply(g,arguments),delete g._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var r=this;if(2!==r._59O.size())return!1;var S=r._58O;return S?2===S.size()&&1===S.get(0)&&2===S.get(1)?!0:!1:!0},fireShapeChange:function(){var l=this;if(!l._55I&&!Nc){var r=pj(l._59O);r&&(l._55I=1,l.setRect(r),delete l._55I)}l.fp(Gk,!1,!0)},getSerializableProperties:function(){var R=jo.superClass.getSerializableProperties.call(this);return R.segments=1,R.points=1,R.thickness=1,R.closePath=1,R}});var $o=f.Polyline=function(){To($o,this),this.s({"shape.background":null,"shape.border.width":2})};Pd("Polyline",jo,{_icon:"polyline_icon",_22Q:function(){return rm},getUIClass:function(){return km},setClosePath:function(){},setTall:function(g){var d=this,w=d.getDataModel();if(w&&w.beginTransaction(),!d._55I&&!d._24Q&&!Nc&&d.getTall()){d._24Q=1;var N=d._54O,O=g/d.getTall();if(1!==O){var S=d.toPoints(),q=new Dj;S.each(function(H){q.add({x:H.x,y:H.y,e:H.e==A?H.e:(H.e-N)*O+N})}),d.setPoints(q),d.fs()}delete d._24Q}$o.superClass.setTall.call(d,g),w&&w.endTransaction()},setElevation:function(R){var i=this,g=i.getDataModel();if(g&&g.beginTransaction(),!i._55I&&!i._24Q&&!Nc){i._24Q=1;var m=R-i._54O;0!==m&&i.shiftPointsElevation(m),delete i._24Q}$o.superClass.setElevation.apply(i,arguments),g&&g.endTransaction()},fireShapeChange:function(){var C=this,e=C._59O;if(!C._55I&&!C._24Q&&!Nc){var H=e.size();if(H){var z=1,N=e.get(0),J=C._54O;N.e==A&&(N.e=J);for(var Z=N.e,i=0;H>z;z++){N=e.get(z),N.e==A&&(N.e=J);var b=Y(Z,N.e),a=$(Z+i,N.e);Z=b,i=a-b}C._24Q=1,C.setTall(i),C.setElevation(Z+i*C._anchorElevation),delete C._24Q}}$o.superClass.fireShapeChange.apply(C,arguments)}});var hr=f.SubGraph=function(){To(hr,this)};Pd("SubGraph",fh,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){hr.superClass._8I.call(this),this.eachChild(function(d){uh(d)&&d._8I()})}}),O.loadingRefGraph=0;var $l=f.RefGraph=function(){To($l,this)};Pd("RefGraph",bb,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(r){var H=this._ref;this._ref=r,this.fp("ref",H,r),this.updateRef()},_21I:function(){$l.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var k=this;if(O.loadingRefGraph++,k.clearChildrenFromDataModel(),O.loadingRefGraph--,k._ref&&k._dataModel){k._xhrLoadHandler&&(k._xhrLoadHandler.cancel=!0);var R=Nc,D=k._xhrLoadHandler=function(n){if(n&&k._dataModel){O.loadingRefGraph++;var e=k._pendingUpdateInfo={needToRestore:R};R&&(e.position=k.p(),e.width=k.getWidth(),e.height=k.getHeight(),e.rotation=k.getRotation(),e.anchor=k.getAnchor(),e.scale=k.getScale()),k.p(0,0),k.setAnchor(.5,.5),k.setRotation(0),k.setScale(1,1);var D=O.parse(n),T=k._dataModel.deserialize(D,k,{justDatas:!0});T.each(function(y){y._refGraph=k}),k.checkPendingUpdateInfo(),O.loadingRefGraph--,O.handleRefGraphLoaded(k,T,D)}};D.xhrLoadCalled=!1,O.load(k._ref,function(z){D.cancel||(D.xhrLoadCalled?D(z):Bm(function(){D(z)}))}),D.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var p=this,S=p._pendingUpdateInfo;if(!S)return p.onPendingUpdated&&(O.loadingRefGraph++,p.onPendingUpdated(),O.loadingRefGraph--),void 0;var c=!0;this.eachChild(function(i){(i._pendingCheckImageJSON||i._pendingUpdateInfo)&&(c=!1)}),c&&(O.loadingRefGraph++,p._pendingUpdateInfo=null,p.updateFromChildren(),S.needToRestore&&(p.setSize(S.width,S.height),p.setAnchor(S.anchor),p.setRotation(S.rotation),p.setScale(S.scale),p.p(S.position)),this.getParent()instanceof $l&&this.getParent().checkPendingUpdateInfo(),p.onPendingUpdated&&p.onPendingUpdated(),O.loadingRefGraph--)},getSerializableProperties:function(){var P=$l.superClass.getSerializableProperties.call(this);return P.ref=1,P}}),f.EdgeGroup=function(P,G){this._70O=P,this._siblings=G;for(var N,o,Z=0,t=P.size(),l=K[Oi];t>Z;Z++)if(N=P.get(Z).getStyle(Oi,!1),N!=A){l=N;break}l==A&&(l=!0);var S=O.edgeGroupAgentFunc;for(S&&(o=S(P),o&&o!==P.get(0)&&(P.remove(o),P.add(o,0))),Z=0;t>Z;Z++)P.get(Z).s(Oi,l)},Pd("EdgeGroup",I,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(R){return this._70O.get(R)},indexOf:function(S){return this._70O.indexOf(S)},each:function(U,O){this._70O.each(U,O)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(l,Y){this._siblings.each(function(J){J._70O.each(l,Y)})}});var Xe=function(x,o,F){var m=um[x]={type:x,action:o};if(F)for(var J in F)m[J]=F[J]};kk(O,{setConnectAction:Xe,getConnectAction:function(L,m){if(!m){if(!L)return null;m=L.getCurrentConnectActionType()}return um[m]},doConnectAction:function(u,Q,M,V){V=V||u.getCurrentConnectActionType();var Y=um[V];if(!Y)return!1;var p=Y.action;return p?(Q instanceof Hf.Group?u.sm().getSelection().each(function(P){p.call(null,u,P,M)}):p.call(null,u,Q,M),!0):!1},doDeleteConnectionAction:function(J,m,x){x=x||J.getCurrentConnectActionType();var Z=um[x];if(!Z||!Z.delete)return!1;var j=Z.delete.action;return j?(m instanceof Hf.Group?J.sm().getSelection().each(function(X){j.call(null,J,X)}):j.call(null,J,m),!0):!1}});var Pp=f.JSONSerializer=function(n,$){this.dm=this._dataModel=n,this._hierarchical=O.forceHierarchicalSerialization?!0:$==A?n.isHierarchicalRendering():$};Pd("JSONSerializer",I,{ms_ac:["hierarchical"],serialize:function(w){return O.stringify(this.toJSON(),w)},toJSON:function(){var D=this,f=D.dm,c=f.getRoots(),v=D.json={v:O.getVersion(),p:{},a:{},d:[]},R=f.getSerializableAttrs();f.getInit()&&(v.init=f.getInit()),f.getName()&&(v.p.name=f.getName()),f.getBackground()&&(v.p.background=f.getBackground()),f.getLayers()&&(v.p.layers=f.getLayers()),f.getEnvmap()&&(v.p.envmap=f.getEnvmap()),v.p.autoAdjustIndex=f.isAutoAdjustIndex(),v.p.hierarchicalRendering=f.isHierarchicalRendering();for(var N in R){var K=f.a(N);K!==m&&D[Uq](N,K,v.a)}return Lc(v.a)&&delete v.a,D._hierarchical?c.each(D.serializeData,this):f.each(function(e){D.serializeData(e)}),f.fireSerializeEvent({type:"serialize",json:v}),f.getPostProcessingData()&&(v.p.postProcessingData=f.getPostProcessingData()),v},isSerializable:function(){return!0},getProperties:function(R){return R.getSerializableProperties()},getStyles:function(t){return t.getSerializableStyles()},getAttrs:function(f){return f.getSerializableAttrs()},serializeData:function(v){var W=this;if(W.isSerializable(v)&&!v._refGraph){var I,n,G,F,T=sg(v.getClassName())||v.getClass(),Z=new T,k={c:v.getClassName(),i:v.getId(),p:{},s:{},a:{}};W.json.d.push(k),I=W.getProperties(v);for(n in I)if(/^_/.test(n)){if(G=v[n],("_width"===n||"_height"===n)&&G===m){var t;((v.s("layout.h")||v.s("layout.v"))&&v.getHost()||v instanceof f.Node&&(t=v.getParent())&&t instanceof f.Block||v.s("fullscreen"))&&(G=v[n]="_width"===n?v.getWidth():v.getHeight())}G!==Z[n]&&W[Uq](n.substr(1),G,k.p)}else F=ho(n),v[F]&&(G=v[F](),G!==Z[F]()&&W[Uq](n,G,k.p));I=W.getStyles(v);for(n in I)G=v.s(n),G!==Z.s(n)&&W[Uq](n,G,k.s);I=W.getAttrs(v);for(n in I)G=v.a(n),G!==Z.a(n)&&W[Uq](n,G,k.a);Lc(k.p)&&delete k.p,Lc(k.s)&&delete k.s,Lc(k.a)&&delete k.a}W._hierarchical&&v.getChildren().each(W.serializeData,W)},serializeValue:function(k,O,q){yd(O)?O={__a:O._as}:O instanceof xo&&(O={__i:O.getId()}),q[k]=O},deserialize:function(R,T,Z){var A=this;return xr(R)&&/.json$/.test(R)?(O.xhrLoad(R,function(n){A.deserializeImpl(n,T,Z)}),void 0):A.deserializeImpl(R,T,Z)},deserializeImpl:function(B,E,h){var z=this,T=z.dm;h=hn(h)?{setId:h}:ne(h)?{finishFunc:h}:h||{},B=z.json=xr(B)?O.parse(B):B,B.a&&B.a.onPreDeserialize&&!h.disableOnPreDeserialize&&B.a.onPreDeserialize(B,T,h.view),T.beginTransaction(),Nc++,z._82I={};var x=new Dj,p=new Dj,w=0,n=B.d.length;if(h.justDatas||(ne(B.init)&&B.init(T),T.setInit(B.init)),!h.justDatas){for(var g in B.a)T.a(g,z[Nb](B.a[g]));for(var j in B.p)T[ds(j)](B.p[j])}for(;n>w;w++){var M=B.d[w],r=sg(M.c),s=new r,C=M.i;h.setId&&C!=A&&(s._id=C),z._82I[C]=s,x.add(s),p.add(M)}for(w=0;n>w;w++)z.deserializeData(x.get(w),p.get(w));return x.each(function(f){E&&!f.getParent()&&f.setParent(E),T.add(f)}),T.fireSerializeEvent({type:"deserialize",json:B}),Nc--,T.endTransaction(),B.a&&B.a.onPostDeserialize&&!h.disableOnPostDeserialize&&B.a.onPostDeserialize(B,T,h.view,x),h.finishFunc&&h.finishFunc(B,T,h.view,x),x},deserializeData:function(I,w){for(var s in w.p)I[ds(s)](this[Nb](w.p[s]));for(s in w.s)I.s(s,this[Nb](w.s[s]));for(s in w.a)I.a(s,this[Nb](w.a[s]))},deserializeValue:function(h){if(Bq(h)){var H=h.__i;if(H!=A)return this._82I[H];if(H=h.__a,Nq(H))return new Dj(H)}return h}}),kk(xg,{serialize:function(s,i){return new Pp(this,i).serialize(s)},toJSON:function(N){return new Pp(this,N).toJSON()},deserialize:function(l,Z,M){return new Pp(this).deserialize(l,Z,M)}});var Sp=f.OverlappingBox=function(x){this.gv=x,this.boxes={}};Pd("OverlappingBox",I,{clear:function(){var i,u,I=this.boxes;for(i in I)u=I[i],u.length=0},isOverlapping:function(b,m){var z,p,o=this,g=o.boxes,$=g[b];$?(z=$.rects,p=$.length):$=g[b]={rects:z=[],length:p=0};var R,u,m;for(R=0;p>R;R++)if(u=z[R],u.x<m.x+m.w&&u.x+u.w>m.x&&u.y<m.y+m.h&&u.h+u.y>m.y)return!0;return z.length<=p?(z.push(m),$.length++):z[$.length++]=m,!1}}),kk(O,{fetch:function(m,X){var E="GET",c=!1,j=null,Y="";X&&(E=X.method||"GET",c=X.sync,Y=X.url,j=X.data||null),m.open(E,Y,!c),X.responseType?m.responseType=X.responseType:X.overrideMimeType&&m.overrideMimeType&&m.overrideMimeType(X.overrideMimeType),m.send(j)},convertImageSrc:function(a,W){W&&"function"==typeof W||(W=function(){}),W(a)}});var ls=f.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Pd("Request",I,{_responseType:null,_overrideMimeType:"text/plain",send:function(Y){var R=this._xhr,z=this.onload,b=this.onerror;this.getResponseType()?Y.responseType=this.getResponseType():this.getOverrideMimeType()&&(Y.overrideMimeType=this.getOverrideMimeType()),R.onload=z,R.onerror=b,O.fetch(R,Y)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(d){this._responseType=d},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(q){this._overrideMimeType=q},getResponseText:function(){var p=this._xhr;return p.response||p.responseText}}),$c.GraphView=function(A){var M=this;M._24I={},M._34I=new Dj,M._25I={},M._56I={},M._view=hg(1,M),M._canvas=Eg(M._view),M.dm(A?A:new xg),this._coreInteractor=new Yp(this),M.setEditable(!1),M.setScrollBarVisible(O.graphViewScrollBarVisible)},Hi("GraphView",I,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Ee,zm,$g,as,"resettable","editInteractor",wl,"zoomable","pannable","rectSelectable","autoScrollZone",os,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:O.graphViewZoomable,_resettable:O.graphViewResettable,_pannable:O.graphViewPannable,_rectSelectable:O.graphViewRectSelectable,_autoScrollZone:O.graphViewAutoScrollZone,_rectSelectBackground:O.graphViewRectSelectBackground,_rectSelectBorderColor:O.graphViewRectSelectBorderColor,_editPointSize:O.graphViewEditPointSize,_editPointBorderColor:O.graphViewEditPointBorderColor,_editPointBackground:O.graphViewEditPointBackground,_scrollBarColor:dq,_scrollBarSize:dp,_autoHideScrollBar:rq,_autoMakeVisible:ud,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(G){this._dataModel.setLayers(G)},setEditable:function(J){var S=this,p=S.__interactorMap__;if(!p){var z=$c.XEditInteractor;p=S.__interactorMap__={scrollBar:new df(S),select:new af(S),edit:z?new z(S):new Nh(S),text:new gj(S),move:new Nk(S),"default":new Od(S),touch:new ei(S,{editable:!1})}}J?(S._uieditable=!0,S.setInteractors([p.scrollBar,p.select,p.edit,p.text,p.move,p.default,p.touch])):(S._uieditable=!1,S.setInteractors([p.scrollBar,p.select,p.move,p.default,p.touch]))},getCanvas:function(){return this._canvas},_33I:function(r){var l=r.getUIClass();return l?new l(this,r):A},getDataUI:function(K){var F=this,y=F._25I[K._id];return y===m&&(y=F._33I(K),F._25I[K._id]=y),y},getNodeRect:function(G){return O.getNodeRect(this,G)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(I){var O=this.getDataUI(I);return O?(O._79o(),O._78o):null},getEdgeSourcePosition:function(X){var S=this,G=S.getDataUI(X),Z=G.s,l=G._data._40I;return _m(S,l,Z("edge.source.position"),Z("edge.source.offset.x"),Z("edge.source.offset.y"),Z("edge.source.anchor.x"),Z("edge.source.anchor.y"))},getEdgeTargetPosition:function(V){var O=this,C=O.getDataUI(V),B=C.s,w=C._data._41I;return _m(O,w,B("edge.target.position"),B("edge.target.offset.x"),B("edge.target.offset.y"),B("edge.target.anchor.x"),B("edge.target.anchor.y"))},invalidateAll:function(g){var Q=this;if(g){for(var n in Q._25I){var B=Q._25I[n];B&&B.dispose()}Q._25I={},Q._56I={},Q._24I={},Q._34I.clear(),Q.redraw()}else Q.dm().each(function($){Q.invalidateData($)})},invalidateSelection:function(){var a=this;a.sm().each(function(V){a.invalidateData(V)})},invalidateData:function(q){var P=this;P._24I[q._id]=q,P._21Q(q),P.iv()},_21Q:function(R){var f=this,l=f._24I;if(hl(R)&&Iq[R.s(Ap)]){var G=R.getSourceAgent();G&&G.getAgentEdges().each(function(t){l[t._id]=t}),G=R.getTargetAgent(),G&&G.getAgentEdges().each(function(C){l[C._id]=C}),f.iv()}},redraw:function(j){var Y=this;Y._32I||(j?Y._34I.add(j):(Y._32I=1,Y._34I.clear()),Y.iv())},each:function(b,Z){var p,$,Y,E=0,z=this.getLayers(),N=this._dataModel,v=N._datas._as,F=v.length;if(z){for(var D=z.length;D>E;E++)if(Y=z[E],Bq(Y)&&(Y=Y.name),N.isHierarchicalRendering()){var u=function(N){return N._layer===Y?Z?b.call(Z,N):b(N):void 0};if(this._dataModel.eachByHierarchical(u)===!1)return}else for(var H=0;F>H;H++)if(p=v[H],p._layer===Y&&($=Z?b.call(Z,p):b(p),$===!1))return}else if(N.isHierarchicalRendering())this._dataModel.eachByHierarchical(b,null,Z);else for(;F>E;E++)if(p=v[E],$=Z?b.call(Z,p):b(p),$===!1)return},reverseEach:function(g,C){var I,o,K,F,x=this._dataModel,n=x._layers,L=x._datas._as,t=L.length;if(n){for(I=n.length-1;I>=0;I--)if(F=n[I],Bq(F)&&(F=F.name),x.isHierarchicalRendering()){var D=function(M){return M._layer===F?C?g.call(C,M):g(M):void 0};if(x.reverseEachByHierarchical(D)===!1)return}else for(var N=t-1;N>=0;N--)if(o=L[N],o._layer===F&&(K=C?g.call(C,o):g(o),K===!1))return}else if(x.isHierarchicalRendering())x.reverseEachByHierarchical(g,null,C);else for(I=t-1;I>=0;I--)if(o=L[I],K=C?g.call(C,o):g(o),K===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var M=this,H=M._84I;if(!H){var R=this.dm().a("width"),V=this.dm().a("height");R>0&&V>0?M._84I={x:0,y:0,width:R,height:V}:(M.each(function(Z){M.isVisible(Z)&&(H=nm(H,M.getDataUIBounds(Z)))}),M._84I=H?H:xj)}return M._84I},getScrollRect:function(){return nm(this.getContentRect(),this._29I)},makeCenter:function(W,C,d){var E=this;if(!E.getWidth()||!E.getHeight())return d||Bm(E.makeCenter,E,[W,C,!0],500),void 0;E.makeVisible(W),E.validate();var q=E.getDataUIBounds(W);if(q){var N=E.getWidth(),X=E.getHeight(),G=q.x+q.width/2,S=q.y+q.height/2,i=-G*E._zoom+N/2,D=-S*E._zoom+X/2;E.setTranslate(i,D,C)}},fitData:function(X,U,Y,W,t){var l=this;if(!l.getWidth()||!l.getHeight())return t||Bm(l.fitData,l,[X,U,Y,W,!0],500),void 0;var F=function(){l.makeVisible(X),l.validate();var f=l.getDataUIBounds(X);f&&(f=of(f),ki(f,Y==A?20:Y),l.fitRect(f,U,W))};U?O.callWhenLoaded(F):F()},fitContent:function(F,f,N,k){var U=this;if(!U.getWidth()||!U.getHeight())return k||Bm(U.fitContent,U,[F,f,N,!0],500),void 0;var y=function(){U.validate();var j=of(U.getContentRect());ki(j,f==A?20:f),U.fitRect(j,F,N)};F?O.callWhenLoaded(y):y()},fitRect:function(F,m,b){var r=this,Q=r.getWidth(),$=r.getHeight(),D=F.x+F.width/2,M=F.y+F.height/2,B=Y(Q/F.width,$/F.height),v=r._zoom,_=-D*v+Q/2,y=-M*v+$/2;0===B||isNaN(B)||(b&&(B=Y(1,B)),m?(r._65I&&(delete r._65I.finishFunc,r._65I.stop(!0)),r._14o&&r._14o.stop(!0),r.setTranslate(_,y,{finishFunc:function(){r.setZoom(B,m)}})):(r.setTranslate(_,y),r.setZoom(B)))},toCanvas:function(J,V){V=V||this._zoom,this.validateImpl();var G=this,L=G.getContentRect();L.width||(L.width=10),L.height||(L.height=10);var k=Eg(),H=L.x*V,h=L.y*V,m=L.width*V,E=L.height*V;jd(k,m,E,1);var P=pm(k);return J=J||this._dataModel.getBackground(),J&&Hq(P,0,0,m,E,J),de(P,-H,-h),P.scale(V,V),G._42(P),P.restore(),k},toDataURL:function(n,K,V){return this.toCanvas(n,V).toDataURL(K||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(A,j){var G=this,n=G.dm().getBackground();if(n){var O=G.dm().a("width"),m=G.dm().a("height");O>0&&m>0&&Hq(A,0,0,O,m,n)}var P=G.__htmlOrderList,J=[];if(G._93db(A,j),G.each(function(K){var l=G.getDataUI(K);if(l){var P=G._56I[K._id],T=l._htmlView;if(P){var h=l._79o();if(T=l._htmlView,f.HtmlNode&&K instanceof f.HtmlNode)l._42(A);else{var y=G.getViewRect(),H=T&&T.layoutHTML;!j||xk(j,h)?(H&&(T.layoutHTML(),l.__outerLayout&&delete l.__outerLayout),l._42(A)):xk(y,h)||!H||l.__outerLayout||(T.layoutHTML(),l.__outerLayout=!0)}}T&&(J.push(T),T.getView&&(T=T.getView()),T.style.display=P?"block":Rr)}}),P&&J.length>0){var e=!1;if(P.length!==J.length)e=!0;else for(var V=0;V<J.length;V++)if(J[V]!==P[V]){e=!0;break}e&&(J.forEach(function(B){B.autoAdjustIndex!==!1&&G.appendHTML(B,!0)}),this.__htmlOrderList=J)}else this.__htmlOrderList=J;G._92db(A,j)},validateImpl:function(){this.tryUpdateRootData();var G,x,E,o,Q,c=this,C=c.tx(),Y=c.ty(),r=c._zoom,I=c._canvas,b=this.getWidth(),s=this.getHeight(),K=c._29I,W={x:-C/r,y:-Y/r,width:b/r,height:s/r},T={},J=c._34I,S=c._24I,D=c._32I,v=c._23I;c._24I={},(b!==I.clientWidth||s!==I.clientHeight)&&(jd(I,b,s),D=1),D||tc(W,K)||(D=1),c._29I=W,c.each(function(O){x=O._id;var z=T[x]=c.isVisible(O);z!==c._56I[x]&&(S[x]=O,E=c.getDataUI(S[x]),E&&E._84o(z),c._84o(O,z))},c);for(x in S)E=c.getDataUI(S[x]),E&&(!D&&c._56I[x]&&(Q=E._79o(),Q&&J.add(Q)),E.invalidate()),c._83I=1;if(c._56I=T,!D)for(x in S)T[x]&&(E=c.getDataUI(S[x]),E&&(Q=E._79o(),Q&&J.add(Q)));if(D?o=W:(J.each(function(d){xk(W,d)&&(o=nm(o,d))}),o&&(ki(o,$(1,1/r)),o.x=d(o.x*r)/r,o.y=d(o.y*r)/r,o.width=U(o.width*r)/r,o.height=U(o.height*r)/r,o=Rn(W,o))),c._74O=o,o){G=pm(I);var n=o.x,t=o.y,X=o.width,R=o.height;n=Math.floor((n*r+C)*Lf),t=Math.floor((t*r+Y)*Lf),X=Math.ceil(X*r*Lf)+1,R=Math.ceil(R*r*Lf)+1,G.beginPath(),G.rect(n,t,X,R),G.clip(),G.clearRect(n,t,X,R),aq(G,C,Y,r),c._42(G,o),G.restore(),delete c._74O}if(J.clear(),delete c._32I,v&&b>0&&s>0){var E=c.getDataUI(v);if(E){var Q=E._79o(),M=c._29I,N=M.x,h=M.y,H=M.width,Z=M.height,r=c._zoom;Q&&!xk(Q,M)&&(Q.x+Q.width<N&&c.tx(-Q.x*r),Q.x>N+H&&c.tx(-(Q.x+Q.width-H)*r),Q.y+Q.height<h&&c.ty(-Q.y*r),Q.y>h+Z&&c.ty(-(Q.y+Q.height-Z)*r))}delete c._23I}c._83I&&(delete c._83I,delete c._84I),c._98O(),c.countFrame(),Lc(c._24I)||Bm(c.iv,c)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var P,l=this.getFullscreenDatas();for(var q in l)P=l[q],this.scaleRootData(P);this._rootDataUpdating=!1}},scaleRootData:function(i){var n=i.s("fullscreen");if("uniform"===n||"fill"===n){i.getRotation()&&i.setRotation(0);var o=i.s("fullscreen.gap")||0,P=this.getWidth(),b=this.getHeight();if(P&&b){var V,c,F,s=P-2*o,r=b-2*o,Y=i.getAnchor(),T=i.getScaledSize(),Q=T.width,m=T.height,g=i.s("fullscreen.lock");if(g)return"uniform"===n?s/r>Q/m?(V=r/m,Q=m*s/r):(V=s/Q,m=Q*r/s):"v"===g?(V=r/m,Q=s/V,i.getWidth()!==Q&&i.setWidth(Q)):(V=s/Q,m=r/V,i.getHeight()!==m&&i.setHeight(m)),this.setZoom(V),c=o-(i.getX()-Y.x*Q)*V,F=o-(i.getY()-Y.y*m)*V,c!==this.tx()&&this.tx(c),F!==this.ty()&&this.ty(F),void 0;c=this.tx(),F=this.ty(),V=this._zoom;var z={x:(-c+o)/V,y:(-F+o)/V,width:s/V,height:r/V};if("uniform"===n){var K=Q/m,h=Math.min(z.width,z.height*K),t=h/K;z.x+=.5*(z.width-h),z.y+=.5*(z.height-t),z.width=h,z.height=t}s=z.width/i.getScaleX(),r=z.height/i.getScaleY(),(i.getWidth()!=s||i.getHeight()!==r)&&i.setSize(s,r);var L=z.x+Y.x*z.width,w=z.y+Y.y*z.height,X=i.getPosition();(L!==X.x||w!==X.y)&&i.setPosition(L,w)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(J){var s=this;J!==s.isScrollBarVisible()&&(J?(gr(s._view,s._79O=Gj()),gr(s._79O,s._27I=Gj()),gr(s._79O,s._28I=Gj())):(ws(s._79O),delete s._79O,delete s._27I,delete s._28I),s.fp("scrollBarVisible",!J,J))},getDebugTip:function(){return""},showScrollBar:function(){var Q=this;Q._79O&&(Q._85I||(l(function(){Q._86I()},Nf),Q.iv()),Q._85I=new Date)},_86I:function(){var g=this;if(g._85I){var u=new Date,W=u.getTime();W-g._85I.getTime()>=Nf?(delete g._85I,g.iv()):l(function(){g._86I()},Nf)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var P=this,k=this._27I,e=this._28I;if(P._79O){if(P._autoHideScrollBar&&!P._85I)return k.style.visibility=Sn,e.style.visibility=Sn,void 0;var Z=P.getScrollBarColor(),H=P._zoom,E=P.getScrollBarSize(),y=P.getViewRect(),p=P.getScrollRect(),X=y.height*H,r=p.height*H,Y=y.width*H-E-2,$=X*((y.y-p.y)*H/r),d=X*(X/r),o=k.style;r-.5>X?(qb>d&&($=$+d/2-qb/2,0>$&&($=0),$+qb>X&&($=X-qb),d=qb),tj(k,Y,$,E,d),o.visibility=dl,o.background=Z,o.borderRadius=E/2+Ug):o.visibility=Sn;var v=y.width*H,a=p.width*H,$=y.height*H-E-2,Y=v*((y.x-p.x)*H/a),w=v*(v/a),o=e.style;a-.5>v?(qb>w&&(Y=Y+w/2-qb/2,0>Y&&(Y=0),Y+qb>v&&(Y=v-qb),w=qb),tj(e,Y,$,w,E),o.visibility=dl,o.background=Z,o.borderRadius=E/2+Ug):o.visibility=Sn}},setDataModel:function(Z){var D=this,e=D._dataModel,P=D._selectionModel;e!==Z&&(e&&(e.ump(D.handleDataModelPropertyChange,D),e.umm(D.handleDataModelChange,D),e.umd(D.handleDataPropertyChange,D),e.removeIndexChangeListener(D._75O,D),e.removeHierarchyChangeListener(D.handleHierarchyChange,D),P||e.sm().ums(D.handleSelectionChange,D)),D._dataModel=Z,Z.mp(D.handleDataModelPropertyChange,D),Z.mm(D.handleDataModelChange,D),Z.md(D.handleDataPropertyChange,D),Z.addIndexChangeListener(D._75O,D),Z.addHierarchyChangeListener(D.handleHierarchyChange,D),P?P._21I(Z):Z.sm().ms(D.handleSelectionChange,D),D.invalidateAll(!0),D.fp(rg,e,Z),D.updateBackground())},getLayersInfo:function(){if(this._layersInfo===m){var k=this.getLayers();k?(this._layersInfo={},k.forEach(function($){var Q=Bq($)?$.name:$;this._layersInfo[Q]=$},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(u,m,j){var e,C,t=this,F=t.getDataUI(u),J=Vn(F),Z=am(m,function(D){return cf(J,100*D)},100,.001),i=cf(J,100*Z);if(!j){var _=Pf(F),d=new Dh(i.x,i.y),h=49/(t._zoom*t._zoom);for(e=0,C=_.length;C>e;e++)if(d.distanceToSquared(_[e])<h)return{index:e,point:_[e],distance:Math.sqrt((_[e].x-m.x)*(_[e].x-m.x)+(_[e].y-m.y)*(_[e].y-m.y))}}return{percent:Z,point:i,distance:Math.sqrt((i.x-m.x)*(i.x-m.x)+(i.y-m.y)*(i.y-m.y))}},calculateAttachPoint:function(){var h=new Dh,I=new Dh,d=new Dh;return function(Z,U){var i=this.getAttachPoints(Z);if(!i||!i.length)return null;d.set(U.x,U.y);for(var m,K,Y,M,o=1/0,c=0,f=i.length;f>c;c++)Y=i[c],I.x=Y.x,I.y=Y.y,h.x=Y.offsetX||0,h.y=Y.offsetY||0,M=_m(this,Z,0,h.x,h.y,I.x,I.y),K=d.distanceToSquared(M),o>K&&(m=c,o=K);o=Math.sqrt(o);var e=this.getAttachStyle(Z);if("close"===e){var F=Z.s("attach.close.threshold")/this._zoom;if(o>F)return null}return{index:m,distance:o,info:i[m]}}}(),getAttachPoints:function(B){var y=B.s("attach.points");if(y)return y;var K=qg(B._image);return K?Ti(K.attachPoints,B,this)||null:void 0},getAttachStyle:function(C){var t=C.s("attach.style");if(t)return t;var G=qg(C._image);return G?Ti(G.attachStyle,C,this)||"close":void 0},updateLayers:function(){this._layersInfo=m,this.invalidateSelection(),this.redraw()},updateBackground:function(){var H=this.dm().a("width"),X=this.dm().a("height");this._canvas.style.background=H>0&&X>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(e){if("background"===e.property){var R=this._canvas.style.background,F=e.newValue||"";this.updateBackground(),this.fp("canvasBackground",R,F),this.redraw()}else"a:width"===e.property||"a:height"===e.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===e.property?this.updateLayers():"hierarchicalRendering"===e.property&&this.redraw()},handleDataPropertyChange:function(b){this.dm().isHierarchicalRendering()&&"parent"===b.property&&b.data.hasChildren()&&this.redraw(),this.invalidateData(b.data)},onPropertyChanged:function(q){var P=this,W=q.property;if(P.redraw(),"zoom"===W){var I=P.sm().getSelection();I.size()&&I.each(function(H){H.invalidate()})}else"dataModel"===W&&(P._83I=1);vl[W]?P.showScrollBar():W===wl&&P.onCurrentSubGraphChanged(q)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(b){var p=this,l=b.kind,P=b.data;if(p._83I=1,"add"===l)p.invalidateData(P),hl(P)&&P.getEdgeGroup()&&P.getEdgeGroup().eachSiblingEdge(p.invalidateData,p);else if(l===Gm){p._21Q(P);var c=P._id,Z=p._25I[c];if(Z){if(p._56I[c]){var f=Z._79o();f&&p.redraw(f)}Z.dispose(),delete p._25I[c],delete p._24I[c],delete p._56I[c]}P===p._currentSubGraph&&p.setCurrentSubGraph(A)}else l===xh&&(p.invalidateAll(!0),p.setCurrentSubGraph(A))},_75O:function(I){this.invalidateData(I.data)},handleHierarchyChange:function(X){this.dm().isHierarchicalRendering()&&X.data.hasChildren()&&this.redraw(),this.invalidateData(X.data)},adjustIndex:function(m){var t=this;if(t.isVisible(m)){t.dm().beginTransaction();for(var $=m;$._parent&&t.isVisible($._parent);)$=$._parent;$&&$!==m&&t._dataModel.adjustIndex($),t._dataModel.adjustIndex(m),t.dm().endTransaction()}},getImage:function(U){return U.getImage?U.getImage():m},getSelectWidth:function(J){var r=qg(this.getImage(J));return r&&Ti(r.disableSelectedBorder,J,this)?0:J.s("select.width")},getSelectColor:function(Q){return Q.s("select.color")},isSelectable:function(Q,e){if(this.isSelected(Q))return!0;if(!e&&Q.getParent()instanceof bb&&this.isSelectable(Q.getParent(),!0)&&Q.getParent().isSyncSize())return!1;var T=this.getLayersInfo();if(T){var Z=T[Q._layer];if(Z&&Z.selectable===!1)return!1}return Q.s("2d.selectable")&&this.sm().isSelectable(Q)},isMovable:function(h){var n=this;if(hl(h)&&h.getStyle(Ap)!==Jo)return!1;var L=this.getLayersInfo();if(L){var f=L[h._layer];if(f&&f.movable===!1)return!1}return h.s("2d.movable")?n._movableFunc?n._movableFunc(h):!0:!1},isEditable:function(s){var l=this;if(f._uiSerializing)return l._uieditable;if(!l._editInteractor||!l.isSelected(s))return!1;if(Lg(s)){var F=l.getDataUI(s);if(!F||F._88I)return!1}if(hl(s)&&s.getStyle(Ap)!==Jo)return!1;var V=this.getLayersInfo();if(V){var I=V[s._layer];if(I&&I.editable===!1)return!1}return s.s("2d.editable")?l._editableFunc?l._editableFunc(s):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(M){return uh(M)&&0!==M.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(M):!0},isRectEditable:function(K){return this._rectEditableFunc?this._rectEditableFunc(K):!0},isAnchorEditable:function(A){return this._anchorEditableFunc?this._anchorEditableFunc(A):!0},isRotationEditable:function(Z){return Z.setRotation&&Z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(Z):!0:!1},getRotationPoint:function(H){var w=H.getAnchor(),G=H.getScale(),d=this._zoom,V=ul(H.getRotation(),0,-H.getHeight()*G.y*w.y-(G.y<0?-1:1)*(hj?32:16)/d),Y=H.p();return V.x+=Y.x,V.y+=Y.y,V},getLogicalPoint:function(U){var c=this;return wg(U,c._canvas,c.tx(),c.ty(),c._zoom,c._zoom)},getScreenPoint:function(f,S){var Q,T=this;return"object"==typeof f?f.x!==m?(Q=f.x,S=f.y):(Q=f[0],S=f[1]):Q=f,sh(Q,S,T._canvas,T.tx(),T.ty(),T._zoom,T._zoom)},getSelectedDataAt:function(j){var y=this;return this.getDataAt(j,function(T){return y.isSelected(T)})},getDataInfoAt:function(t,a,q){var G,P=this.lp(t),b=this.getDataAt(P,a,q);if(b){var H=this.getDataUI(b);G={data:b,ui:H,point:P};var d=H._38o;if(d){var o=d.icons;for(var J in o){var i=o[J],B=d.rects[J];if(B)for(var O=Ti(i.names,b,this),Q=O?O.length:0,V=B.rotation,w=Q-1;w>=0;w--){var e=O[w],g=B[w];if(ub(g,P,V))return G.part="icons",G.name=J,G.icon=e,G.rect=g,G.index=w,G.rotation=V,G}}}if(this.isNoteVisible(b)){if(H.note2Info&&ub(H.note2Info.clickRect,P,A,H.note2Info.scale))return G.part="note2",G;if(H.noteInfo&&ub(H.noteInfo.clickRect,P,A,H.noteInfo.scale))return G.part="note",G}if(this.isLabelVisible(b)){if(H.label2Info&&ub(H.label2Info.rect,P,H.label2Info.rotation,H.label2Info.scale))return G.part="label2",G;if(H.labelInfo&&ub(H.labelInfo.rect,P,H.labelInfo.rotation,H.labelInfo.scale))return G.part="label",G}if(b.isInRect&&b.isInRect(P))return G.part="body",G}return G},getDataAt:function(V,v,L){V.target&&(V=this.lp(V));var G,r=this._zoom;return this.reverseEach(function(z){return(v?v(z):this.isSelectable(z))&&this.rectIntersects(z,yp(V.x,V.y,L,r))?(G=z,!1):void 0},this),G},getIconInfoAt:function(v,S){var F=this;if(v.target&&(v=F.lp(v)),S||(S=F.getDataAt(v)),S){var Q=F.getDataUI(S);if(Q&&Q._38o){var D,T=Q._38o,l=new Dj;for(D in T.icons)l.add(D);for(var J=l.size()-1;J>=0;J--){D=l.get(J);for(var r=T.rects[D],E=r.rotation,M=r.length-1;M>=0;M--){var w=r[M],p=w.width,U=w.height,d={x:v.x-w.x-p/2,y:v.y-w.y-U/2};E!=A&&(d=ul(-E,d.x,d.y));var w={x:-p/2,y:-U/2,width:p,height:U};if(ub(w,d))return{key:D,index:M,name:T.icons[D].names[M],rect:r[M],point:v,rotation:E,relativeRect:w,relativePoint:d,data:S}}}}}return A},getDatasInRect:function(p,F,V){V===m&&(V=1);var r=this,R=new Dj;return r.reverseEach(function(c){V&&!r.isSelectable(c)||(F?r.rectIntersects(c,p):r.rectContains(c,p))&&R.add(c)}),R},moveSelection:function(t,h){var V=this;V.dm().beginTransaction(),Hj(V.sm().toSelection(V.isMovable,V),t,h),V.dm().endTransaction()},moveDatas:function(z,s,_){var N=this;N.dm().beginTransaction(),z instanceof Dj||(z=new Dj(z)),Hj(z,s,_),N.dm().endTransaction()},getDataUIBounds:function(v){var G=this.getDataUI(v);return G?G._79o():A},drawData:function(V,g,O){var Y=this.getDataUI(g);if(Y){var Q=Y._79o();(!O||xk(O,Q))&&(Y._42(V),g instanceof f.Block&&g.eachChild(function(L){this.drawData(V,L,O)
},this))}},getBoundsForGroup:function(r){return r.s(Yb)?this.getDataUIBounds(r):A},isPixelPerfect:function(K){return K.s("pixelPerfect")},rectIntersects:function(n,V){this.validate();var U=A;if(this._56I[n._id]){var H=this._25I[n._id];if(H){var T=H._79o();if(pp(V,T))U=!0;else if((V=Rn(V,T))&&(H.rectIntersects&&(U=H.rectIntersects(V)),U==A)){if(!this.isPixelPerfect(n))return!0;var b=V.x,f=V.y,G=V.width,y=V.height,v=this._zoom,z=O.hitMaxArea,l=G*y*v*v;if(l>z){var Y=Math.sqrt(z/l);v*=Y}G*=v,y*=v,2>G&&(G=2),2>y&&(y=2),b*=v,f*=v;var j=Fi(G,y);de(j,-b,-f),j.scale(v,v),this._drawForChecking=!0,this.drawData(j,n,V),this._drawForChecking=!1;try{for(var d=0,k=j.getImageData(0,0,G,y).data;d<k.length;d+=4)if(0!==k[d+3]){U=!0;break}j.restore()}catch(N){Le=A,U=!1}}}}return U?!0:!1},rectContains:function(q,S){if(this._56I[q._id]){var v=this._25I[q._id];if(v)return pp(S,v._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(c){if(!O.isInput(c.target)){var r=this,X=r._focusData,l=X&&r._25I[X._id],_=0,q=r._dataModel._datas;if(!(X&&X._enabled&&X._editable&&l&&l.onKeyDown&&l.onKeyDown(c)===!0))if(9===c.keyCode&&(X&&(_=q.indexOf(X),ah(c)?-1===--_&&(_=0):++_===q.size()&&(_=0)),r._focusData=X=q.get(_),r.sm().setSelection(X)),cg(c)?r.selectAll():Yk(c)&&r.isResettable()&&r.reset(),r.sm().isEmpty()){if(r._editing)return;var D=r.tx(),R=r.ty(),G=!1,Q=ah()?100:10;Hb(c)&&(D-=Q,G=!0),qm(c)&&(R-=Q,G=!0),pi(c)&&(D+=Q,G=!0),Or(c)&&(R+=Q,G=!0),G&&r.setTranslate(D,R)}else{_l(c)&&r.handleDelete(c);var u=ah()?10:1;Hb(c)&&(r.moveSelection(-u,0),r.fi({kind:"moveLeft"})),qm(c)&&(r.moveSelection(0,-u),r.fi({kind:"moveUp"})),pi(c)&&(r.moveSelection(u,0),r.fi({kind:"moveRight"})),Or(c)&&(r.moveSelection(0,u),r.fi({kind:"moveDown"}))}}},handleScroll:function(n,R){if(Ec(n),this.isZoomable()){if(!this.getEditInteractor()){var i=this.getDataAt(n);if(i){var b=qg(this.getImage(i));if(b&&Ti(b.scrollable,i,this))return}}var V=this.lp(n);R>0?this.scrollZoomIn(V):0>R&&this.scrollZoomOut(V)}},handlePinch:function(k,b,Y){this.isZoomable()&&(b>Y?this.pinchZoomIn(k):this.pinchZoomOut(k))},checkDoubleClickOnNote:function(s,g){var b=this,o=b.lp(s),G=b.getDataUI(g),i=G.note2Info;return i&&g.s("note2.toggleable")&&ub(i.clickRect,o)?(g.s(lr,!g.s(lr)),b.fi({kind:"toggleNote2",event:s,data:g}),!0):(i=G.noteInfo,i&&g.s("note.toggleable")&&ub(i.clickRect,o)?(g.s(mr,!g.s(mr)),b.fi({kind:"toggleNote",event:s,data:g}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(P,k){var w=this,m=w.getAutoScrollZone(),W=m/w.getZoom(),s=m/4,E=w._29I,D=w.lp(P),X={x:w.tx(),y:w.ty()};return D&&m>0&&E&&(D.x-E.x<W?w.translate(s,0):E.x+E.width-D.x<W&&w.translate(-s,0),D.y-E.y<W?w.translate(0,s):E.y+E.height-D.y<W&&w.translate(0,-s)),X.x=w.tx()-X.x,X.y=w.ty()-X.y,k&&(k.x+=X.x,k.y+=X.y),X},getMoveMode:function(C,c){var x=c.s("2d.move.mode");return x?x:ko["88"]?"x":ko["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(n,O,q){var h=this;return"currentSubGraph"===O?{__i:n.getId()}:q.serializeProperty(n,O,h)},deserializeProperty:function(b,X,Q){var R=this;if("currentSubGraph"===X){var P=R.dm(),J=P.__idMap;return J[b.__i]}return Q.deserializeProperty(b,X,R)},setDefaultCursor:function(i,R){this._defaultCursor=i,R!==!1&&this.setCursor(i)},setCursor:function(F){"default"===F&&(F=this._defaultCursor||F);var n=this.getView().style;n.cursor=F,n.cursor="-webkit-"+F,n.cursor="-moz-"+F},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(a){return a===A||O.getConnectAction(null,a)?(this._currentActionType=a,this.redraw(),!0):!1},getEditStyle:function(C){var K=this.getEditInteractor();return K?K.getStyle(C):m},setEditStyle:function(u,e,v){var c=this.getEditInteractor();return c?(c.setStyle(u,e,v),!0):!1},isConnectActionVisible:function(B){var b=O.getConnectAction(this);if(!b)return!1;var S=b.visible;return ne(S)&&(S=S(this,B)),S},isInteractive:function(L){var H=qg(this.getImage(L));return H&&Ti(H.interactive,L,this)?!0:L.s("interactive")},appendHTML:function(R,I){var S=this.getView();if(!(I||R&&R.parentNode!==S))return!1;var v=R.getView&&R.getView();if(!I&&v&&v.parentNode===S)return!1;(R.getView||R.isSelfViewEvent)&&(R=R.getView());var L=this.getEditInteractor();return L&&L._canvas?S.insertBefore(R,L._canvas):this.isScrollBarVisible()?S.insertBefore(R,this.getView().lastChild):gr(S,R),!0},_layoutHTMLImpl:function(p,d,O){if(arguments.length>1){var D,m=this,u=m._zoom;if(d.getView&&(D=d,d=d.getView()),d.style.position="absolute",O){var W=p.getRect();tj(D||d,m.tx()+W.x*u,m.ty()+W.y*u,W.width*u,W.height*u)}else{var Z=new Lp,W=p.getAnchorRect(),g=p.getPosition(),r=p.getScale(),e=d.style;tj(D||d,W),Z.appendTranslate(m.tx(),m.ty()),Z.appendScale(u,u),Z.append(new Lp(p.getRotation(),g.x,g.y,r.x,r.y)),Gp(e,"transform","matrix("+Z.a.toFixed(5)+", "+Z.b.toFixed(5)+", "+Z.c.toFixed(5)+",\n    "+Z.d.toFixed(5)+", "+Z.tx.toFixed(5)+", "+Z.ty.toFixed(5)+")"),Gp(e,"transformOrigin",(-W.x).toFixed(5)+"px "+(-W.y).toFixed(5)+"px"),d.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(j){return j instanceof Qb?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(B){var A="state",D=B.s(A);if(D)return D;var N=qg(B._image);return N?Ti(N[A],B,this)||null:void 0}}),I.defineProperties($c.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(J){this._layoutHTML=J}}});var dr=function(P,e){var k=this;k.gv=P,k.s=function(E){return e.getStyle(E)},k._data=e,k._87I=new Dj};Bg(dr,I,{_6I:A,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var X=this,P=X.gv.isSelected(X._data);return!P||X.isShadowed()?0:X.gv.getSelectWidth(X._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(M){var Z=this._data,Y=this.gv.getBodyColor(Z);return Y?Y:M?Z.getStyle(M):A},_2Q:function(b){return this.s(b)},_1Q:function(A,M,o,c){var I=this.s,P=I("2d.gray"),S=I(M+".dash.color");if(P&&(S=O.toGrayColor(S)),A.strokeStyle=S,A.lineWidth=o,A.stroke(),I(M+".dash.3d")){var h=I(M+".dash.3d.color");gf(A,S,P?O.toGrayColor(h):h,o,this.gv._zoom,I(M+".dash.3d.accuracy"))}Kc(A,c)},invalidate:function(){this._6I=A},_79o:function(){var t=this;if(!t._6I){var s=t._data,p=t.gv;t.labelInfo=t.label2Info=t.noteInfo=t.note2Info=t._38o=A,t._87I.clear(),t.interactiveInfo=p.isInteractive(s)?{}:A,t._3O(),t._55O=p.isEditable(s)?{_42O:p.isRectEditable(s),_43O:p.isPointEditable(s),_56O:p.isRotationEditable(s)}:A,t._6I=t._81o()}return t._6I},_3O:function(){},getPosition:function(){return xj},_68o:function(a,V){a&&this._87I.add(Vd(a,V))},_81o:function(){var _=this,E=_.s;_._24O(ch,"getLabel"),_._24O(Zo,"getLabel2"),_._26O(In,"getNote"),_._26O(jf,"getNote2"),_._15O(),_._55O&&_._48O();var R;if(_._87I.each(function(Z){R=nm(R,Z)}),R&&_.isShadowed()){var a=of(R);a.x+=E("shadow.offset.x"),a.y+=E("shadow.offset.y"),ki(a,E("shadow.blur")),R=nm(R,a)}return _._87I.clear(),R},_42:function(b){var Z=this,u=Z._data,r=Z.gv,l=Z.s,x=l("opacity"),E=this.isShadowed();if(E){var z=b.shadowOffsetX,M=b.shadowOffsetY,V=b.shadowBlur,N=b.shadowColor,n=r.getZoom();b.shadowOffsetX=l("shadow.offset.x")*n,b.shadowOffsetY=l("shadow.offset.y")*n,b.shadowBlur=l("shadow.blur")*n,b.shadowColor=Z.getSelectColor()}if(x!=A){var q=b.globalAlpha;b.globalAlpha=x}Z._80o(b),r.isLabelVisible(u)&&((!r._drawForChecking||l("label.selectable"))&&qj(b,Z.labelInfo),(!r._drawForChecking||l("label2.selectable"))&&qj(b,Z.label2Info)),r.isNoteVisible(u)&&(yi(b,Z.noteInfo),yi(b,Z.note2Info)),Z._99O(b),x!=A&&(b.globalAlpha=q),E&&(b.shadowOffsetX=z,b.shadowOffsetY=M,b.shadowBlur=V,b.shadowColor=N)},_80o:function(){},_47O:function(){},_24O:function(r,x){var H=this,m=H._data,J=H.gv,j=H.s,P=J[x](m);if(P!=A){var q=j(r+".scale"),Y=j(r+".max"),t=j(r+".position"),Q=H[r+"Info"]={label:P,scale:q,color:J[x+"Color"](m),font:j(r+".font"),opacity:j(r+".opacity"),align:j(r+".align"),rotation:H.getRotation(j(r+".rotation"),!1,t),background:J[x+"Background"](m)},$=Un(Q,P);Y>0&&Y<$.width&&(Q.labelWidth=$.width,$.width=Y),1!==q&&($.width*=q,$.height*=q);var k=H.getPosition(t,j(r+".offset.x"),j(r+".offset.y"),$,j(r+".position.fixed"));if($.x=k.x-$.width/2,$.y=k.y-$.height/2,H._68o(Q.rect=$,Q.rotation),1!==q){var R=$.width/q,V=$.height/q;Q.rect={x:k.x-R/2,y:k.y-V/2,width:R,height:V}}}},_26O:function(e,l){var Y=this,Z=Y.gv,S=Y._data,C=Y.s,b=Z[l](S);if(b!=A){var q,V,O=C(e+".scale"),G=Y[e+"Info"]={note:b,scale:O,data:S,view:Z,expanded:C(e+".expanded"),font:C(e+".font"),color:C(e+".color"),opacity:C(e+".opacity"),align:C(e+".align"),icon:C(e+".icon"),backgroundImage:C(e+".backgroundImage"),borderWidth:C(e+".border.width"),borderColor:C(e+".border.color"),background:Z[l+"Background"](S)},H=Y.getPosition(C(e+".position"),C(e+".offset.x"),C(e+".offset.y")),X=H.x,E=H.y;if(G.expanded){var Q,i=C(e+".max"),p=C(e+".backgroundImage");p?(p=qg(p),Q={width:Wb(p,S),height:js(p,S)}):Q=Un(G,b),Q.width+=6,Q.height+=2,i>0&&i<Q.width&&(G.labelWidth=Q.width,Q.width=i),q=Q.width,V=Q.height+8,G.clickRect={x:X-q*O/2,y:E-V*O,width:q*O,height:V*O*Q.height/V}}else{var D=C(e+".icon");D?(D=qg(D),q=Wb(D,S),V=js(D,S)):(q=12,V=18),G.clickRect={x:X-q*O/2,y:E-V*O,width:q*O,height:V*O}}G.rect={x:X-q/2,y:E-V*O/2-V/2,width:q,height:V};var W=U(G.borderWidth/2)*O;Y._68o({x:X-q*O/2-W,y:E-V*O-W,width:q*O+2*W,height:V*O+2*W})}},_48O:function(){},_99O:function(S){var P=this,V=P._38o;if(V){var s=P.gv,C=P._data,b=V.icons,E=P.interactiveInfo;E&&(E._38o={});for(var l in b){var Z=b[l],$=V.rects[l];if($){E&&(E._38o[l]=[]);var Y=Ti(Z.opacity,C,s),y=Ti(Z.names,C,s),D=y?y.length:0,L=$.rotation;if(Y!=A){var p=S.globalAlpha;S.globalAlpha*=Y}for(var o=0;D>o;o++){var x=y[o],g=qg(x),W=$[o];if(L){var f=W.x+W.width/2,t=W.y+W.height/2;S.save(),de(S,f,t),Ah(S,L),de(S,-f,-t)}E&&E._38o[l].push(S.interactiveInfo={compInfos:[],matrix:L?new Lp(L,f,t).appendTranslate(-f,-t):new Lp}),Cl(S,g,Ti(Z.stretch,C,s),W.x,W.y,W.width,W.height,P._data,P.gv),S.interactiveInfo=A,L&&S.restore()}Y!=A&&(S.globalAlpha=p)}}}}});var mf=function(f,O){To(mf,this,[f,O])};Bg(mf,dr,{_checkEmptyRect:!0,_40O:function(L,j){var b=this,C=b.s,g=L.rect;(L.borderColor=b.gv.getBorderColor(b._data))&&(L.borderType=C("border.type"),L.borderWidth=C("border.width"),L.borderPadding=C("border.padding"),j=$(j,L.borderPadding+L.borderWidth/2));var v=b._data.getScale(),k=$(1,$(G(v.x),G(v.y)));if(L.selectWidth=b.getSelectWidth()){var z=b.gv._zoom;L.selectType=C("select.type"),L._97o=b.getSelectColor(),L.selectPadding=C("select.padding"),j=$(j,(L.selectPadding+L.selectWidth/2/z)/k)}j>0&&(j*=k,g=of(g),ki(g,j)),b._68o(g)},_39O:function(i,D){var U,$=this,z=D.rect;if(D.borderWidth>0&&(U=D.borderPadding,i.strokeStyle=D.borderColor,i.lineWidth=D.borderWidth,Rg(i,D.borderType,{x:z.x-U,y:z.y-U,width:z.width+2*U,height:z.height+2*U}),i.stroke()),D.selectWidth>0){var R=$.gv._zoom;if(U=D.selectPadding,i.strokeStyle=D._97o,i.lineWidth=D.selectWidth/R,D.rotation!=A){i.save(),i.translate(D.position.x,D.position.y),i.rotate(D.rotation);var p=$._data,F=p.getWidth(),Q=p.getHeight(),P=D.scale,Z=D.anchor;z={x:P.x*-F*Z.x,y:P.y*-Q*Z.y,width:P.x*F,height:P.y*Q}}Rg(i,D.selectType,{x:z.x-U,y:z.y-U,width:z.width+2*U,height:z.height+2*U}),D.rotation!=A&&i.restore(),i.stroke()}},dispose:function(){var c=this,b=c._htmlView;mf.superClass._3O.call(c),b&&(b.onHTMLRemoved&&b.onHTMLRemoved(),ws(b))},_3O:function(){var C=this,p=C.s,F=C._data,o=C.gv,f=F.getStyle(Gk),l=C.getBodyColor(),V=C._83o=f?{shape:f,_53o:C.getBodyColor("shape.background"),_27Q:qg(p("shape.repeat.image"),l),shapeGradientPack:p("shape.gradient.pack"),_54o:p("shape.border.width"),_55o:p("shape.border.color"),_56o:p("shape.border.3d"),_57o:p("shape.border.3d.color"),_58o:p("shape.border.3d.accuracy"),shapeGradient:p("shape.gradient"),_59o:p("shape.gradient.color"),_60o:p("shape.border.pattern"),_61o:p("shape.border.cap"),_62o:p("shape.border.join"),shapeForeground:p("shape.foreground"),bodyColor:l,gray:p("2d.gray")}:{img:qg(o.getImage(F),l),bodyColor:l,gray:p("2d.gray"),stretch:p("image.stretch")};if(S&&!a);else{var M,g=V.img;g&&g.renderHTML?(C._htmlInfo&&C._htmlInfo.img!==g&&(C._htmlInfo=A),C._htmlInfo||(C._htmlInfo={img:g,cache:{}}),M=g.renderHTML(F,o,C._htmlInfo.cache)):C._htmlInfo=A,C._htmlView&&C._htmlView!==M&&(C._htmlView.onHTMLRemoved&&C._htmlView.onHTMLRemoved(),ws(C._htmlView.getView?C._htmlView.getView():C._htmlView)),(C._htmlView=M)&&o.appendHTML(M)&&(M.onHTMLAddedSync&&M.onHTMLAddedSync(),M.onHTMLAdded&&Bm(M.onHTMLAdded)),V.rect=F.getRect(),V.position=F.p(),V.scale=F.getScale(),V.anchor=F.getAnchor(),V.rotation=F.getRotation(),f===Pr&&(V._63o=p("shape.depth"));var e=0;if(f)e=rh(A,V._54o/2,V._62o),C.s("shape.dash")&&(e=$(e,(C.s("shape.dash.width")||V._54o)/2));else if(g&&g.boundExtend)if(e=Ti(g.boundExtend,F,o),g.boundExtendAbsolute){var K=F.getScale();e/=o._zoom*$(1,$(G(K.x),G(K.y)))}else if(!Ti(g.fitSize,F,o)){var u=Ti(g.width,F,o),J=Ti(g.height,F,o);e*=$(F.getWidth()/u,F.getHeight()/J)}C._40O(V,e);var b=p("clip.percentage");if(1>b&&(0>b&&(b=0),V.clipRect=Zq(F.getAnchorRect(),p("clip.direction"),b)),f){var r=p("shape.fill.clip.percentage");1>r&&(0>r&&(r=0),V.shapeClipRect=Zq(F.getAnchorRect(),p("shape.fill.clip.direction"),r));var q=p("shape.foreground.clip.percentage");1>q&&(0>q&&(q=0),V.shapeForegroundClipRect=Zq(F.getAnchorRect(),p("shape.foreground.clip.direction"),q))}}},getPosition:function(j,E,J,I){var i=Ef(j,this._83o.rect,I);return i.x+=E,i.y+=J,i},_80o:function(G){var d=this,x=d.s,q=d.gv,D=d._data,L=d._83o,e=L.rect,S=L.position,p=L.rotation,N=L.anchor,t=L.scale,u=L.shape,l=L.clipRect;if(!d._checkEmptyRect||e.width>0&&e.height>0){var b=D.getSize();if(b.x=-b.width*N.x,b.y=-b.height*N.y,G.save(),de(G,S.x,S.y),Ah(G,p),Ip(G,t.x,t.y),l&&(G.beginPath(),G.rect(l.x,l.y,l.width,l.height),G.clip()),q._drawForChecking&&L.img&&Ti(L.img.pixelPerfect,D,q)===!1)Hq(G,b.x,b.y,b.width,b.height,"#888888");else if(d.freeDraw)d.freeDraw(G,b,L);else if(u){var n,h,H,U,y=L._60o,g=Tl(G,y),V=L._27Q,k=L._54o,m=L.shapeGradientPack,M=L.gray,K=G.lineJoin,P=G.lineCap,w=function(o){return M?O.toGrayColor(o):o};"roundRect"===u?n=x("shape.corner.radius"):"polygon"===u?n=x("shape.polygon.side"):"arc"===u&&(n=x("shape.arc.from"),h=x("shape.arc.to"),H=x("shape.arc.close"),U=x("shape.arc.oval")),G.lineJoin=L._62o,G.lineCap=L._61o;var W=w(L._53o);if(W||V||m){var j=L.shapeClipRect;j&&(G.save(),G.beginPath(),G.rect(j.x,j.y,j.width,j.height),G.clip()),Rg(G,u,b,n,h,H,U),m?wk(G,m):V?Ko(G,V,w(L.bodyColor),null,D,q):Sr(G,W,L.shapeGradient,w(L._59o),b),G.fill(),j&&G.restore(),m&&G.restore(),G!==g&&Rg(g,u,b,n,h,H,U)}else Rg(g,u,b,n,h,H,U);var Y=L.shapeForeground;if(Y){G.save();var _=L.shapeForegroundClipRect;_&&(G.beginPath(),G.rect(_.x,_.y,_.width,_.height),G.clip()),Rg(G,u,b,n,h,H,U),Sr(G,Y,x("shape.foreground.gradient"),w(x("shape.foreground.gradient.color")),b),G.fill(),G.restore()}if(k>0){var J=x("shape.border.width.absolute");J&&(G.save(),G.setTransform(1,0,0,1,0,0)),G.lineWidth=k;var i=w(L._55o);G.strokeStyle=i,G.stroke(),J&&G.restore(),L._56o&&gf(G,i,w(L._57o),k,q._zoom,L._58o)}if(Kc(G,y),x("shape.dash")){var z=x("shape.dash.width")||k;if(z>0){y=x("shape.dash.pattern");var g=Tl(G,y,d._2Q("shape.dash.offset"));g!==G&&Rg(g,u,b,n,h,H,U),d._1Q(G,"shape",z,y)}}Me(G,W,L._63o,b),G.lineJoin=K,G.lineCap=P}else{var C=d.interactiveInfo;C&&(G.interactiveInfo=C.bodyInfo={compInfos:[],matrix:new Lp(p,S.x,S.y,t.x,t.y)}),L.gray&&(G.compGray=!0);var F=L.img;F&&F.cacheRule!=A&&(F=Ii(G,F,L.stretch,b.width,b.height,D,q,L.bodyColor)),Cl(G,F,L.stretch,b.x,b.y,b.width,b.height,D,q,L.bodyColor),G.compGray=!1,G.interactiveInfo=A}G.restore()}d._39O(G,L)},_48O:function(){},_47O:function(){}});var Kk=function(M,q){To(Kk,this,[M,q])},aj=function(Q,U,c,Z){var j=Ng(Q,U);return c=Z?Y(c,j):Vp(c,j),j?c/=j:c=0,{x:Q.x+(U.x-Q.x)*c,y:Q.y+(U.y-Q.y)*c}};Bg(Kk,dr,{_3O:function(){var n,y=this,g=y._data,P=y.gv,J=y.s,E=J(Ap),C=g.isLooped(),w=J("edge.width"),K=J("edge.center"),o=J("edge.offset"),q=P.getBorderColor(g),B=q?J("border.width"):0,u=y.getSelectWidth(),k=g._40I,a=g._41I,T=y._78o=k&&a?{looped:C,type:E,width:w,center:K,color:y.getBodyColor("edge.color"),borderColor:q,borderWidth:B,_97o:u?y.getSelectColor():A,selectWidth:u,pattern:J("edge.pattern"),cap:J("edge.cap"),join:J("edge.join"),is3d:J("edge.3d"),_67o:J("edge.3d.color"),_66o:J("edge.3d.accuracy"),gray:J("2d.gray")}:A;if(T){var x=O.getEdgeType(E);if(x){var Q=x(g,_f(y,P,g,C,E),P,y._19Q);Q.points&&Q.points.size()>1?(T.edgeTypeInfo=Q,n=pj(T.edgeTypeInfo.points)):Q[fe]&&Q.rect&&(T.edgeTypeInfo=Q,n=Q.rect)}else{var Y=J("edge.source.anchor.x"),F=J("edge.source.anchor.y"),D=J("edge.target.anchor.x"),i=J("edge.target.anchor.y"),G=cd(P,g,"source"),v=cd(P,g,"target");if(E===Jo){var p=T.points=J(kj)||Jd,f=p.size();T.segments=J("edge.segments");var t=Y!==m||F!==m||hl(k),I=D!==m||i!==m||hl(a);if(!K)if(o)t||(G=aj(G,f?p.get(0):v,o,f)),I||(v=aj(v,f?p.get(f-1):G,o,f));else{var r;t||(r=Dc(G,f?p.get(0):v,sp(P,k)),r&&(G={x:r[0],y:r[1]})),I||(r=Dc(f?p.get(f-1):G,v,sp(P,a)),r&&(v={x:r[0],y:r[1]}))}n=nm(pj(T.points),pj(G,v))}else{var M=_f(y,P,g,C,E);if(y._19Q||(M=-M),C)G=of(G),G.x=P.getNodeRect(k).x,T.radius=M,n={x:G.x-M,y:G.y-M,width:2*M,height:2*M};else{var X=Ng(G,v),R=Vp(o,X),l={x:R,y:M},U={x:X-R,y:M},Z=b(v.y-G.y,v.x-G.x),H=T.mat=new Sq(Z);if(T.orienAngle=Z,T.angle=v.x<G.x?Z+s:Z,T.rect={x:l.x,y:l.y,width:U.x-l.x,height:0},T.origin=G,l=H.tf(l),l.x+=G.x,l.y+=G.y,U=H.tf(U),U.x+=G.x,U.y+=G.y,K){var L={x:X,y:0};L=H.tf(L),L.x+=G.x,L.y+=G.y,n=pj([G,l,U,L]),T.c1=G,T.c2=L}else n=pj(l,U);G=l,v=U}}T.sourcePoint=G,T.targetPoint=v,g._lastSourcePoint=G,g._lastTargetPoint=v}var S=0;J("edge.dash")&&(S=J("edge.dash.width")||w);var c="square"===T.cap?.71:.5;rh(n,$(S*c,w*c+B+u),T.join),y._68o(n)}},getRotation:function(Z,s,X){Z=Z||0;var C=this._78o;if(C){var c,I=C.angle,b=C.points,r=C.edgeTypeInfo;if(I!=A)return s?C.orienAngle+Z:I+Z;if(r&&r[fe])return r.getRotation?r.getRotation(this,Z,s,X):0;if(r&&r.points){var p=r.points;return c=p.size(),Of[X]?c&&0===c%2?Rh(p.get(c/2-1),p.get(c/2),s,Z):Z:Wg[X]?Rh(p.get(0),p.get(1),s,Z):Rh(p.get(c-2),p.get(c-1),s,Z)}if(b)return c=b.size(),Of[X]?c&&0===c%2?Rh(b.get(c/2-1),b.get(c/2),s,Z):Z:Wg[X]?Rh(C.sourcePoint,c?b.get(0):C.targetPoint,s,Z):Rh(c?b.get(c-1):C.sourcePoint,C.targetPoint,s,Z)}return Z},getPosition:function(w,K,L,H,a){var q=this._78o;if(q){var h,R=q.type,j=q.points,k=q.edgeTypeInfo,O=q.sourcePoint,S=q.targetPoint;if(!R)return q.looped?{x:O.x-q.radius+K,y:O.y+L}:(a&&O&&S&&(O.x>S.x||O.x===S.x&&O.y>S.y)&&(w=Jg[w],L=-L),h=Ef(w,q.rect,H),h.x+=K,h.y+=L,h=q.mat.tf(h),h.x+=q.origin.x,h.y+=q.origin.y,h);if(k&&k[fe])return k.getPosition?k.getPosition(this,w,K,L,H,a):{x:(O.x+S.x)/2,y:(O.y+S.y)/2};if(j){var h,f=j.size();if(Of[w]){if(f){var o=f%2;if(0===o)return nl(j.get(f/2-1),j.get(f/2),w,K,L,H,a);h=j.get((f-o)/2)}else h={x:(O.x+S.x)/2,y:(O.y+S.y)/2};return h=Ef(w,{x:h.x,y:h.y,width:0,height:0},H),h.x+=K,h.y+=L,h}return Wg[w]?nl(O,f?j.get(0):S,w,K,L,H,a):nl(f?j.get(f-1):O,S,w,K,L,H,a)}if(k){var E=k.points,f=E.size();if(Of[w]){var o=f%2;return 0===o?nl(E.get(f/2-1),E.get(f/2),w,K,L,H,a):(h=E.get((f-o)/2),h=Ef(w,{x:h.x,y:h.y,width:0,height:0},H),h.x+=K,h.y+=L,h)}return Wg[w]?nl(E.get(0),E.get(1),w,K,L,H,a):nl(E.get(f-2),E.get(f-1),w,K,L,H,a)}}return xj},_42:function(u){this._78o&&Kk.superClass._42.call(this,u)},drawPath:function(x,y){x.beginPath();var q=y.type,w=y.points,$=y.segments,K=y.edgeTypeInfo;if(!q||w){var A=y.sourcePoint,J=A.x,j=A.y,W=y.targetPoint,n=W.x,g=W.y;if(q)if($){var v=new Dj({x:J,y:j});v.addAll(w),v.add({x:n,y:g}),ns(x,v,$)}else x.moveTo(J,j),w.each(function(o){x.lineTo(o.x,o.y)}),x.lineTo(n,g);else y.looped?x.arc(J,j,y.radius,0,H,!0):y.center?(x.moveTo(y.c1.x,y.c1.y),x.lineTo(J,j),x.lineTo(n,g),x.lineTo(y.c2.x,y.c2.y)):(x.moveTo(J,j),x.lineTo(n,g))}else K&&(K.points?ns(x,K.points,K.segments):K[fe]&&K[fe](x,K))},_80o:function(G){var W=this,s=W.s,y=W._78o,p=y.width,x=y.selectWidth,d=y.borderWidth,z=G.lineJoin,f=G.lineCap,J=y.gray,F=y.pattern;G.lineJoin=y.join,G.lineCap=y.cap,W.drawPath(Tl(G,F),y);var l=s("edge.width.absolute");l&&(G.save(),G.setTransform(1,0,0,1,0,0)),x&&(G.strokeStyle=y._97o,G.lineWidth=p+2*(d+x),G.stroke()),d&&(G.strokeStyle=J?O.toGrayColor(y.borderColor):y.borderColor,G.lineWidth=p+2*d,G.stroke());var I=J?O.toGrayColor(y.color):y.color,m=J?O.toGrayColor(y._67o):y._67o;if(G.strokeStyle=I,G.lineWidth=p,G.stroke(),y.is3d&&gf(G,I,m,p,W.gv._zoom,y._66o),l&&G.restore(),Kc(G,F),s("edge.dash")){F=s("edge.dash.pattern");var _=Tl(G,F,W._2Q("edge.dash.offset"));_!==G&&W.drawPath(_,y),W._1Q(G,"edge",s("edge.dash.width")||p,F)}G.lineJoin=z,G.lineCap=f},_48O:function(){},_47O:function(){}});var Og=function(l,S){To(Og,this,[l,S])};Bg(Og,mf,{_3O:function(){var Z,G,v=this,l=v.s,f=v._data,g=v.gv;if(v._88I=A,f.isExpanded()&&f.eachChild(function(E){if(uh(E)){var i=g.getBoundsForGroup(E);i&&(G||(G=[]),G.push(i),Z=nm(Z,i))}}),Z){var p=g.getLabel(f),C=l("group.type");Z=Rp(C,G,Z),og(Z,f,"group.padding",1);var K=v._88I={type:C,rect:Z,_64o:Z};if(!C&&p!=A){var D,H=v.labelInfo={label:p,color:l("group.title.color"),font:l("group.title.font"),align:l("group.title.align")},S=Un(H,p),a=S.width,k=S.height,o=l("group.title.align"),U=l("group.title.orientation");if((U===kq||U===Ud)&&a>Z.width?Z.width=a:(U===zd||U===Nl)&&a>Z.height&&(Z.height=a),H.rect={y:Z.y-k,width:S.width,height:k},D=o===zd?Z.x:o===Nl?Z.x+Z.width-a:Z.x+Z.width/2-a/2,H.rect.x=D,U===Ud)K.titleRect={x:Z.x,y:Z.y+Z.height,width:Z.width,height:k},K.rect={x:Z.x,y:Z.y,width:Z.width,height:Z.height+k},H.rect={x:D,y:Z.y+Z.height,width:a,height:k};else if(U===zd){var j=K.titleRect={x:Z.x-k,y:Z.y,width:k,height:Z.height};K.rect={x:Z.x-k,y:Z.y,width:Z.width+k,height:Z.height},H.rect={x:j.x+k/2-Z.height/2,y:j.y+Z.height/2-k/2,width:Z.height,height:k},H.rotation=-Math.PI/2}else if(U===Nl){var j=K.titleRect={x:Z.x+Z.width,y:Z.y,width:k,height:Z.height};K.rect={x:Z.x,y:Z.y,width:Z.width+k,height:Z.height},H.rect={x:j.x+k/2-Z.height/2,y:j.y+Z.height/2-k/2,width:Z.height,height:k},H.rotation=Math.PI/2}else K.titleRect={x:Z.x,y:Z.y-k,width:Z.width,height:k+1},K.rect={x:Z.x,y:Z.y-k,width:Z.width,height:Z.height+k}}v._40O(K,l("group.border.width")/2)}else Og.superClass._3O.call(v)},getPosition:function(U,O,v,F){var $=this._88I;if($){var G=Ef(U,$.rect,F);return G.x+=O,G.y+=v,G}return Og.superClass.getPosition.apply(this,arguments)},_24O:function(_,h){var Y=this._88I;(!Y||Y.type||"label2"===_)&&Og.superClass._24O.call(this,_,h)},_80o:function(T){var F=this,N=F._88I;if(N){var B=F._data,s=F.s,D=F.gv,M=N.type,J=N.rect,q=N._64o,w=N.titleRect,f=F.getBodyColor(),b=qg(s("group.image"),f),V=s("group.image.stretch"),O=F.getBodyColor("group.background"),k=qg(s("group.repeat.image"),f),K=s("group.gradient.pack"),o=s("group.gradient"),a=s("group.gradient.color"),A=s("group.border.width"),X=s("group.border.color"),y=s("group.border.pattern"),C=s("group.title.orientation"),L=s("group.depth");if(M){var P=T.lineJoin,m=T.lineCap;if(T.lineJoin=s("group.border.join"),T.lineCap=s("group.border.cap"),b){if(T.save(),Rg(T,M,J),T.clip(),Cl(T,b,V,J.x,J.y,J.width,J.height,B,D,f),T.restore(),A>0){var n=Tl(T,y);Rg(n,M,J),T.lineWidth=A,T.strokeStyle=X,T.stroke(),Kc(T,y)}}else{var n=Tl(T,y);O||k||K?(Rg(T,M,J),K?wk(T,K):k?Ko(T,k,f,null,B,D):Sr(T,O,o,a,J),T.fill(),K&&T.restore(),T!==n&&Rg(n,M,J)):Rg(n,M,J),A>0&&(T.lineWidth=A,T.strokeStyle=s("group.border.color"),T.stroke()),Kc(T,y),M===Pr&&Me(T,O,L,J)}T.lineJoin=P,T.lineCap=m}else{var d=s("group.title.background"),H=s("group.border.radius");if(b)Cl(T,b,V,q.x,q.y,q.width,q.height,B,D,F.getBodyColor());else if(O||k)if(k?Ko(T,k,f,null,B,D):Sr(T,O,o,a,q),0===A)Rg(T,Pr,q),T.fill(),Me(T,O,L,q);else{switch(T.beginPath(),C){case Ud:pe(T,q.x,q.y,q.width,q.height,H,H,0,0);break;case zd:pe(T,q.x,q.y,q.width,q.height,0,H,0,H);break;case Nl:pe(T,q.x,q.y,q.width,q.height,H,0,H,0);break;case kq:pe(T,q.x,q.y,q.width,q.height,0,0,H,H)}T.fill()}if(w&&d)if(0===A)Hq(T,w.x,w.y,w.width,w.height,d),Me(T,d,L,w);else{switch(T.beginPath(),T.fillStyle=d,C){case Ud:pe(T,w.x,w.y,w.width,w.height,0,0,H,H);break;case zd:pe(T,w.x,w.y,w.width,w.height,H,0,H,0);break;case Nl:pe(T,w.x,w.y,w.width,w.height,0,H,0,H);break;case kq:pe(T,w.x,w.y,w.width,w.height,H,H,0,0)}T.fill()}if(A>0){var n=Tl(T,y);if(Rg(n,"roundRect",J,H),T.lineWidth=A,T.strokeStyle=X,w&&s("group.splitLine")){var G=w.x,E=w.y,I=w.width,Z=w.height;C===Ud?(T.moveTo(G,E),T.lineTo(G+I,E)):C===zd?(T.moveTo(G+I,E),T.lineTo(G+I,E+Z)):C===Nl?(T.moveTo(G,E),T.lineTo(G,E+Z)):(T.moveTo(G,E+Z),T.lineTo(G+I,E+Z))}T.stroke(),Kc(T,y)}}F._39O(T,N)}else Og.superClass._80o.call(F,T)}});var uk=function(j,o){To(uk,this,[j,o])};Bg(uk,mf,{_80o:function(h){this._39O(h,this._83o)}});var ic=function(d,h){To(ic,this,[d,h])};Bg(ic,mf,{_3O:function(){var S=this,e=S._data,p=S.s,H=S.gv,k=e.getPoints(),V=H.getBorderColor(e),j=V?p("border.width"):0,Q=S.getSelectWidth(),r=p("shape.border.width"),M=e.getRect(),J=e.getAnchorRect(),l=H.getBodyColor(e),f=S._99o=k.isEmpty()?A:{rect:M,rotation:e.getRotation(),fillRule:p("shape.fill.rule"),scale:e.getScale(),position:e.p(),points:k,segments:e.getSegments(),bodyColor:l,borderColor:V,borderWidth:j,_94o:p("shape.border.3d"),_95o:p("shape.border.3d.color"),_96o:p("shape.border.3d.accuracy"),_97o:Q?S.getSelectColor():A,selectWidth:Q,_53o:p("shape.background"),_27Q:qg(p("shape.repeat.image"),l),shapeGradientPack:p("shape.gradient.pack"),_54o:r,_55o:p("shape.border.color"),shapeGradient:p("shape.gradient"),_59o:p("shape.gradient.color"),_60o:p("shape.border.pattern"),_61o:p("shape.border.cap"),_62o:p("shape.border.join"),shapeForeground:p("shape.foreground"),gray:p("2d.gray")};if(f){J.x+=f.position.x,J.y+=f.position.y,f.gradientRect=J;var a=e.getScale(),d=$(1,$(G(a.x),G(a.y)));p("shape.dash")&&p("shape.dash.width")>r&&(r=p("shape.dash.width"));var U=r*("square"===f._61o?.71:.5)+j+Q/S.gv._zoom/d;U&&(U*=d,M=of(M),rh(M,U,f._62o)),S._68o(M);var D=p("clip.percentage");1>D&&(0>D&&(D=0),f.clipRect=Zq(e.getAnchorRect(),p("clip.direction"),D));var N=p("shape.fill.clip.percentage");1>N&&(0>N&&(N=0),f.shapeClipRect=Zq(e.getAnchorRect(),p("shape.fill.clip.direction"),N));var u=p("shape.foreground.clip.percentage");1>u&&(0>u&&(u=0),f.shapeForegroundClipRect=Zq(e.getAnchorRect(),p("shape.foreground.clip.direction"),u))}},getPosition:function(e,g,J,C){var n=this._99o;if(n){var L=Ef(e,n.rect,C);return L.x+=g,L.y+=J,L}return xj},_42:function(D){this._99o&&ic.superClass._42.call(this,D)},_80o:function(k){var C,H=this,M=H.s,Y=H._99o,Z=Y.position,x=Y.scale,T=Y.rotation,E=Y.borderWidth,n=Y.selectWidth/H.gv._zoom,N=Y._27Q,J=Y.shapeGradientPack,m=Y._54o,b=Y.clipRect,L=Y.shapeClipRect,A=Y.points,B=Y.segments,U=H._data.isClosePath(),z=Y.fillRule,q=Y.gray,e=function(D){return q?O.toGrayColor(D):D},I=e(Y._53o),t=I||N||J;k.save(),de(k,Z.x,Z.y),Ah(k,T),Ip(k,x.x,x.y),b&&(k.beginPath(),k.rect(b.x,b.y,b.width,b.height),k.clip()),t&&L&&(k.save(),k.beginPath(),k.rect(L.x,L.y,L.width,L.height),k.clip()),de(k,-Z.x,-Z.y);var D=Y._60o,h=Tl(k,D),P=k.lineJoin,g=k.lineCap;k.lineJoin=Y._62o,k.lineCap=Y._61o;var v=e(Y.bodyColor);t?(ns(k,A,B,U),J?wk(k,J):N?Ko(k,N,v,null,H._data,H.gv):(C=v?v:I,Sr(k,C,Y.shapeGradient,e(Y._59o),Y.gradientRect)),k.fill(z),L&&(k.restore(),de(k,-Z.x,-Z.y)),J&&k.restore(),h!==k&&ns(h,A,B,U)):ns(h,A,B,U);var S=Y.shapeForeground;if(S){k.save();var s=Y.shapeForegroundClipRect;s&&(de(k,Z.x,Z.y),k.beginPath(),k.rect(s.x,s.y,s.width,s.height),k.clip(),de(k,-Z.x,-Z.y)),ns(k,A,B,U),Sr(k,S,M("shape.foreground.gradient"),e(M("shape.foreground.gradient.color")),Y.gradientRect),k.fill(z),k.restore()}var W=M("shape.border.width.absolute");if(W&&(k.save(),k.setTransform(1,0,0,1,0,0)),n&&(k.strokeStyle=Y._97o,k.lineWidth=m+2*(E+n),k.stroke()),E&&(k.strokeStyle=e(Y.borderColor),k.lineWidth=m+2*E,k.stroke()),m&&(C=e(Y._55o),!I&&v&&(C=v),k.strokeStyle=C,k.lineWidth=m,k.stroke(),Y._94o&&gf(k,C,e(Y._95o),m,H.gv._zoom,Y._96o)),W&&k.restore(),Kc(k,D),M("shape.dash")){var Q=M("shape.dash.width")||m;if(Q>0){D=M("shape.dash.pattern");var h=Tl(k,D,H._2Q("shape.dash.offset"));h!==k&&ns(h,A,B,U),H._1Q(k,"shape",Q,D)}}k.lineJoin=P,k.lineCap=g,k.restore()},_48O:function(){},_47O:function(){}});var km=function(I,D){To(km,this,[I,D])};Bg(km,ic,{getRotation:function(R,m,Q){R=R||0;var e=this._data.getPoints(),q=e.size();return q>1?Of[Q]?q&&0===q%2?Rh(e.get(q/2-1),e.get(q/2),m,R):R:Wg[Q]?Rh(e.get(0),e.get(1),m,R):Rh(e.get(q-2),e.get(q-1),m,R):R},getPosition:function(t,T,n,E,b){var K=this._data.getPoints(),I=K.size();if(I>1){if(Of[t]){var s=I%2;if(0===s)return nl(K.get(I/2-1),K.get(I/2),t,T,n,E,b);var g=K.get((I-s)/2),z={x:g.x,y:g.y,width:0,height:0};return g=Ef(t,z,E),g.x+=T,g.y+=n,g}return Wg[t]?nl(K.get(0),K.get(1),t,T,n,E,b):nl(K.get(I-2),K.get(I-1),t,T,n,E,b)}return xj}});var Fd=function(T,C){To(Fd,this,[T,C])};Bg(Fd,mf,{_3O:function(){var y=this;Fd.superClass._3O.call(y);var z=y.s,L=y._83o;y._82o=L.img||L.shape?A:{background:y.getBodyColor("grid.background"),depth:z("grid.depth"),rect:L.rect,_88o:z("grid.cell.depth"),cellBorderColor:z("grid.cell.border.color"),_89o:z("grid.row.count"),_90o:z("grid.column.count"),block:z("grid.block"),_91o:z("grid.block.color"),_92o:z("grid.block.padding"),_93o:z("grid.block.width")}},_80o:function(w){var k=this,g=k._82o;if(!g)return Fd.superClass._80o.call(k,w),void 0;var r,J,N=k._data,L=g.background,s=g.rect,K=g.block,l=g._91o,V=g._92o,I=g._93o,m=g._88o,x=g.cellBorderColor,c=g._89o,H=g._90o;if(L)if(Hq(w,s.x,s.y,s.width,s.height,L),Me(w,L,g.depth,s),m)for(r=0;c>r;r++)for(J=0;H>J;J++)s=N.getCellRect(r,J),s&&Me(w,L,m,s);else if(x){for(w.beginPath(),r=0;c>r;r++)for(J=0;H>J;J++)s=N.getCellRect(r,J),s&&w.rect(s.x,s.y,s.width,s.height);w.strokeStyle=x,w.lineWidth=1,w.stroke()}if("h"===K)for(r=0;c>r;r++)s=nm(N.getCellRect(r,0),N.getCellRect(r,H-1)),ki(s,V),Qm(w,l,s.x,s.y,s.width,s.height,I);else if("v"===K)for(J=0;H>J;J++)s=nm(N.getCellRect(0,J),N.getCellRect(c-1,J)),ki(s,V),Qm(w,l,s.x,s.y,s.width,s.height,I);k._39O(w,k._83o)}});var So=function(T,x){To(So,this,[T,x])};Bg(So,mf,{_checkEmptyRect:!1,_81o:function(){var J=this._data,p=So.superClass._81o.call(this),I=J.s("text");if(I!=A){var Y,s,F=J.s("text.font"),q=J.s("text.align"),M=J.s("text.vAlign"),K=wr(F,I),R=K.width,V=K.height,n=J.getAnchor(),C=J.getWidth(),Z=J.getHeight();"left"===q?Y=-C*n.x:"center"===q?Y=-C*n.x+(C-R)/2:"right"===q&&(Y=C*(1-n.x)-K.width),"top"===M?s=-Z*n.y:"middle"===M?s=-Z*n.y+(Z-V)/2:"bottom"===M&&(s=Z*(1-n.y)-K.height);var u,x=J.getMatrix();if(u=pj([x.tf(Y,s),x.tf(Y+R,s),x.tf(Y+R,s+V),x.tf(Y,s+V)]),p=nm(p,u),p&&J.s("text.shadow")){var G=of(p);G.x+=J.s("text.shadow.offset.x"),G.y+=J.s("text.shadow.offset.y"),ki(G,J.s("text.shadow.blur")),p=nm(p,G)}}return p}});var sr=$c.Interactor=function(O){this.gv=this._graphView=O};Hi("Interactor",I,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(c){this.gv.fi(c)},setCursor:function(e){hj||this.gv.setCursor(e)},startDragging:function(z){var y=this;y._lastClientPoint=Pb(z),y._lastLogicalPoint=y.gv.lp(z),Ff(y,z)},clearDragging:function(){var u=this;u._lastClientPoint=u._lastLogicalPoint=u._logicalPoint=A},autoScroll:function(v){return this.gv.autoScroll(v,this._lastClientPoint)
}});var jr=A,el=function(K){jr.handleWindowTouchMove(K)},Rk=function(G){jr.handleWindowTouchEnd(G),h(q,qs,el),h(q,od,Rk),jr=A},Te=function(A){jr.handleWindowMouseMove(A)},zs=function(P){jr.handleWindowMouseUp(P),h(q,Kj,Te),h(q,hc,zs),jr=A},zc=function(_,N){_!==jr&&(jr?hj?jr.handleWindowTouchEnd(N):jr.handleWindowMouseUp(N):hj?(x(q,qs,el),x(q,od,Rk)):(x(q,Kj,Te),x(q,hc,zs)),jr=_)},Yp=function(X){var y=this;y.gv=X,y._is2d=X instanceof $c.GraphView,y._eventListeners={},y._is2d&&(y.filter=function(W){return X.isSelectable(W)&&X.isInteractive(W)}),X.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",jb].forEach(function(N){y.addListener(N)}),y.initImageResource()};Bg(Yp,sr,{enableVR:function(q){var k=this;if(!!k._vrEnable!==q)if(k._vrEnable=q,q)k.gv.vr.mp(k.onVRControllerChange,k);else if(k.gv.vr.ump(k.onVRControllerChange,k),k._vrRayPolyline){var n=k.gv.dm();n.remove(k._vrRayPolyline),n.remove(k._vrRayHitPoint),k._vrRayPolyline=m,k._vrRayHitPoint=m}},onVRControllerChange:function(b){var i=this,w=b.property,D=b.newValue,G=i.gv.vr.getController(D.id),n=G.getRay();n&&("gamepad.button.trigger"===w?"down"===D._62O?i.handle_mousedown(n):i.handleWindowMouseUp(n):"gamepad.pose"===w&&(i.handle_mousemove(n),i.handleWindowMouseMove(n)))},drawVRRay:function(A,I,r){var w,g=this,s=g.gv,_=g._vrRayPolyline,L=!1;if(_)w=g._vrRayHitPoint;else{var F=s.dm();g._vrRayPolyline=_=new f.Polyline,g._vrRayHitPoint=w=new f.Node,w.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),w.setAnchor3d(.5,.5,.499);var v=.2/s.vr.measureOflength;w.s3(v,v,v),_.s("intersect",!1),w.s("intersect",!1),F.add(_),F.add(w),L=!0}if(I){var x=r.world,o=r.worldNormal,T=x.x,O=x.y,S=x.z;_.s("shape.border.color","red"),_.setPoints([{x:A.origin.x,y:A.origin.z,e:A.origin.y},{x:T,y:S,e:O}]),w.s("3d.visible",!0),w.p3(T,O,S),w.lookAtDirection([o.x,o.y,o.z],"front")}else{_.s("shape.border.color","blue");var k=new f.Math.Vector3;k.copy(A.direction).setLength(1e3/g.gv.vr.measureOflength).add(A.origin),_.setPoints([{x:A.origin.x,y:A.origin.z,e:A.origin.y},{x:k.x,y:k.z,e:k.y}]),w.s("3d.visible",!1)}s.fi({kind:"vrRayIntersect",ray:A,data:I,intersect:r,polyline:_,hitNode:w,begin:L})},setPreventEventDefault:function(B,_){var h=this,q=h._eventListeners[B];q?q._prevent=_:h._eventListeners[B]=q={_removal:m,_prevent:_}},removeListener:function(J){var Y=this,j=Y._eventListeners[J];j&&j._removal&&(j._removal(),j._removal=m)},addListener:function(n){var M=this,z=M._eventListeners[n];if(z||(M._eventListeners[n]=z={_removal:m,_prevent:!0}),!z||!z._removal){var C=function(k){z._prevent&&O.preventDefault(k),M.disabled||M["handle_"+n](k)};x(M.gv.getView(),n,C),z._removal=function(){h(M.gv.getView(),n,C)}}},handleWindowTouchMove:function(W){this.handleWindowMouseMove(W)},handleWindowMouseMove:function($){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",$):(this.handleDownInfo("onBeginDrag",$),this.isDragging=!0))},handleWindowTouchEnd:function(o){this.handleWindowMouseUp(o)},handleWindowMouseUp:function(e){if(this.isDragging&&(this.handleDownInfo("onEndDrag",e),this.isDragging=!1),this.downInfo){var f=this.handle("onUp",e);if(f&&f.data===this.downInfo.data){this.handleMissingUp(e);var D=this,a=2===e.button?"onContextMenu":"onClick";if(!D._dbclickTimer)return D._dbclickTimer=l(function(){delete D._dbclickTimer,D.handleClick(e,a,f),this.downInfo=A},O.clickDelay),void 0;z(D._dbclickTimer),delete D._dbclickTimer,a="onDoubleClick",D.handleClick(e,a,f)}else this.handleDownInfo("onUp",e);this.downInfo=A}},handle_mouseleave:function(H){var p=this,W=p.gv,Z=p.currentInfo?p.currentInfo.data:A;if(Z){Z.s("onLeave")&&Z.s("onLeave")(H,Z,W),p.fire("data","onLeave",H,Z);var n=p.currentInfo?p.currentInfo.hits:A;if(n)for(var q in n)p.handleLeave(H,q);p.currentInfo=A}},handle_mousewheel:function(L){L.scrollDelta=L.wheelDelta/40,this.handle("onScroll",L)},handle_DOMMouseScroll:function(e){e.scrollDelta=2===e.axis?-e.detail:0,this.handle("onScroll",e)},handle_touchstart:function(G){this.handle_mousedown(G)},handle_touchmove:function(r){this.handle("onMove",r)},handle_mousedown:function(G){this.isDragging&&(this.handleDownInfo("onEndDrag",G),this.isDragging=!1),this.downInfo=this.handle("onDown",G),this.downInfo&&zc(this,G)},handle_mousemove:function(G){var K=this,s=K.gv;K._hoverTimer&&(z(K._hoverTimer),delete K._hoverTimer);var q,M,E,S=K.handle("onMove",G),a=this.currentInfo?this.currentInfo.data:A,y=this.currentInfo?this.currentInfo.hits:A;if(S&&(M=S.data,E=S.hits,K._hoverTimer=l(function(){z(K._hoverTimer),delete K._hoverTimer,K.handle("onHover",G,S)},s.getHoverDelay()||O.hoverDelay)),M!==a){if(a&&(a.s("onLeave")&&a.s("onLeave")(G,a,s),this.fire("data","onLeave",G,a)),M&&(M.s("onEnter")&&M.s("onEnter")(G,M,s),this.fire("data","onEnter",G,M)),y)for(q in y)this.handleLeave(G,q);if(E)for(q in E){var f=E[q];f.target.onEnter&&f.target.onEnter(G,M,s,f.point,f.width,f.height),this.fire(f.type,"onEnter",f.event,f.data,f.image,f.comp,f.point,f)}}else{if(y)for(q in y)E&&E[q]||this.handleLeave(G,q);if(E)for(q in E)if(!y||!y[q]){var f=E[q];f.target.onEnter&&f.target.onEnter(G,M,s,f.point,f.width,f.height),this.fire(f.type,"onEnter",f.event,f.data,f.image,f.comp,f.point,f)}}this.currentInfo=S},handle:function(X,v,Q){var w,p=this,k=p.gv;if(p._is2d){if(Q=Q||k.getDataInfoAt(v,this.filter),!Q)return;if(w=Q.ui.interactiveInfo){var Y,b=Q.data;if(b.s(X)&&b.s(X)(v,b,k),this.fire("data",X,v,b),"body"===Q.part&&w.bodyInfo)Y="body",Q.hits=this.handleImage(Y,k.getImage(b),X,v,b,Q.point,w.bodyInfo);else if("icons"===Q.part&&w._38o){var L=w._38o[Q.name];L&&L[Q.index]&&(Y="icons|"+Q.name+"|"+Q.index,Q.hits=this.handleImage(Y,Q.icon,X,v,b,Q.point,L[Q.index]))}}return Q}var b,D;if(!Q)if(v&&v instanceof f.Math.Ray){var S=k.vr.intersectWorld(v);if(b=S.data,D=S.intersect,p.drawVRRay(v,b,D),!b)return;var E=k.getData3dUI(b);if(w=E.interactiveInfo,!w)return;Q={data:b,part:D.part,ui:E}}else{if(Q=k.getDataInfoAt(v),!Q)return;Q&&(Q={data:Q.data,part:Q.part})}if(k.isInteractive(Q.data)){if(!D){b=Q.data;var E=k.getData3dUI(b);if(Q.ui=E,w=E.interactiveInfo,!w)return Q;if(D=k.intersectObject(v,b),!D)return}b.s(X)&&b.s(X)(v,b,k),this.fire("data",X,v,b);var a,c=D.part;return"body"!==c&&(a=b.s(c+".image")||b.s("shape3d."+c+".image")),a||(a=b.s("all.image")||b.s("shape3d.image")),w="object"==typeof a?w[a.uuid]:w[a],w&&w.bodyInfo?(Q.part="body",Q.interactiveInfo=w,Q.point=D.uv.multiply({x:w.bodyInfo.rect.width,y:w.bodyInfo.rect.height}),Q.image=a,Q.hits=this.handleImage("body",a,X,v,b,Q.point,w.bodyInfo),Q):Q}},_handleLeaveOrMissing:function(D,w,k){var q="leave"===D?this.currentInfo:this.downInfo;if(q){var E=q.interactiveInfo||q.ui.interactiveInfo;if(E){var J,z,l=q.data;if(this._is2d){if(z=this.gv.lp(w),"body"===q.part&&E.bodyInfo)J="body","leave"===D?this.handleLeaveImage(k,J,this.gv.getImage(l),w,l,z,E.bodyInfo):this.handleMissingUpImage(J,this.gv.getImage(l),w,l,z,E.bodyInfo);else if("icons"===q.part&&E._38o){var a=E._38o[q.name];a&&a[q.index]&&(J="icons|"+q.name+"|"+q.index,"leave"===D?this.handleLeaveImage(k,J,q.icon,w,l,z,a[q.index]):this.handleMissingUpImage(J,q.icon,w,l,z,a[q.index]))}}else{if(!E.bodyInfo)return;var I=this.gv.intersectObject(w,l);z=I?I.uv.multiply({x:E.bodyInfo.rect.width,y:E.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===D?this.handleLeaveImage(k,"body",q.image,w,l,z,E.bodyInfo):this.handleMissingUpImage("body",q.image,w,l,z,E.bodyInfo)}}}},handleClick:function(D,d,T){var i=this,C=this.downInfo;if(C&&T){var s,J=T.interactiveInfo||T.ui.interactiveInfo,j=T.data,H=this.gv;if(j.s(d)&&j.s(d)(D,j,H),i.fire("data",d,D,j),J)if(this._is2d){if(C.part===T.part){var z=H.lp(D);"body"===T.part&&J.bodyInfo&&(s="body",this.handleClickImage(s,H.getImage(j),d,D,j,z,J.bodyInfo,T))}}else{if(!J.bodyInfo)return;var V=H.intersectObject(D,j);if(!V)return;z=V.uv.multiply({x:J.bodyInfo.rect.width,y:J.bodyInfo.rect.height}),this.handleClickImage("body",C.image,d,D,j,z,J.bodyInfo,T)}}},handleDownInfo:function(Q,z){if(this.downInfo){var k=this.downInfo,m=this.gv,K=k.interactiveInfo||k.ui.interactiveInfo;if(K){var a,L=k.data;if(L.s(Q)&&L.s(Q)(z,L,m),this.fire("data",Q,z,L),this._is2d){var d=m.lp(z);if("body"===k.part&&K.bodyInfo)a="body",this.handleDownInfoImage(a,m.getImage(L),Q,z,L,d,K.bodyInfo);else if("icons"===k.part&&K._38o){var l=K._38o[k.name];l&&l[k.index]&&(a="icons|"+k.name+"|"+k.index,this.handleDownInfoImage(a,k.icon,Q,z,L,d,l[k.index]))}}else{if(!K.bodyInfo)return;var E=m.intersectObject(z,L);if(!E)return;d=E.uv.multiply({x:K.bodyInfo.rect.width,y:K.bodyInfo.rect.height}),this.handleDownInfoImage("body",k.image,Q,z,L,d,K.bodyInfo)}}}},fire:function(G,_,S,K,e,q,p,r){this.gv.fi({kind:_,type:G,event:S,data:K,image:e,comp:q,view:this.gv,point:p,width:r?r.width:m,height:r?r.height:m})},handleImage:function(Y,R,T,a,u,w,z){var s={};if(R&&(R=qg(R))){var f=this.gv,g=z.rect,q=this.convertPoint(w,z);q.inRect&&(R[T]&&R[T](a,u,f,q,g.width,g.height),this.fire("image",T,a,u,R,m,q,g),s[Y+"|image"]={target:R,type:"image",image:R,data:u,event:a,point:q,width:g.width,height:g.height});for(var _=z.compInfos,E=R,J=_.length-1;J>=0;J--){var y=_[J],H=y.comp;if(q=this.convertPoint(w,y,E,H,f,u),q.inRect){g=y.rect;var d=u._interactPrefix=y.prefix,o=d&&u.a(d+T)||H[T];o&&o.call(H,a,u,f,q,g.width,g.height),this.fire("comp",T,a,u,R,H,q,g),(R=g.image)&&(R[T]&&R[T](a,u,f,q,g.width,g.height),this.fire("image",T,a,u,R,m,q,g)),u._interactPrefix=null,s[Y+"|"+J]={target:H,type:"comp",comp:H,image:R,data:u,event:a,point:q,width:g.width,height:g.height},R&&(s[Y+"|"+J+"|image"]={target:R,type:"image",image:R,data:u,event:a,point:q,width:g.width,height:g.height})}}}return s},handleLeave:function(y,L){return this._handleLeaveOrMissing("leave",y,L)},handleMissingUp:function(D){return this._handleLeaveOrMissing("missing",D)},handleLeaveImage:function(f,v,c,O,b,W,K){if(c&&(c=qg(c))){var $=this.gv,Z=K.rect,M=this.convertPoint(W,K);f===v+"|image"&&(c.onLeave&&c.onLeave(O,b,$,M,Z.width,Z.height),this.fire("image","onLeave",O,b,c,m,M,Z));for(var w=K.compInfos,q=c,_=w.length-1;_>=0;_--){var G=w[_],V=G.comp;M=this.convertPoint(W,G,q,V,$,b),Z=G.rect;var j=b._interactPrefix=G.prefix;if(f===v+"|"+_){var F=j&&b.a(j+"onLeave")||V.onLeave;F&&F.call(V,O,b,$,M,Z.width,Z.height),this.fire("comp","onLeave",O,b,c,V,M,Z)}(c=Z.image)&&f===v+"|"+_+"|image"&&(c.onLeave&&c.onLeave(O,b,$,M,Z.width,Z.height),this.fire("image","onLeave",O,b,c,m,M,Z)),b._interactPrefix=null}}},handleMissingUpImage:function(R,B,X,F,v,V){var A="onUp",H=this.downInfo.hits;if(H&&B&&(B=qg(B))){var N=this.gv,M=V.rect,w=this.convertPoint(v,V);!w.inRect&&H[R+"|image"]&&(B[A]&&B[A](X,F,N,w,M.width,M.height),this.fire("image",A,X,F,B,m,w,M));for(var C=V.compInfos,L=B,E=C.length-1;E>=0;E--){var p=C[E],z=p.comp;if(w=this.convertPoint(v,p,L,z,N,F),!w.inRect){M=p.rect;var q=F._interactPrefix=p.prefix;if(H[R+"|"+E]){var G=q&&F.a(q+A)||z[A];G&&G.call(z,X,F,N,w,M.width,M.height),this.fire("comp",A,X,F,B,z,w,M)}(B=M.image)&&H[R+"|"+E+"|image"]&&(B[A]&&B[A](X,F,N,w,M.width,M.height),this.fire("image",A,X,F,B,m,w,M)),F._interactPrefix=null}}}},handleDownInfoImage:function(c,z,o,G,s,X,N){var I=this.downInfo.hits;if(I&&z&&(z=qg(z))){var d=this.gv,T=N.rect,Y=this.convertPoint(X,N);I[c+"|image"]&&(z[o]&&z[o](G,s,d,Y,T.width,T.height),this.fire("image",o,G,s,z,m,Y,T));for(var b=N.compInfos,E=z,t=b.length-1;t>=0;t--){var i=b[t],S=i.comp;Y=this.convertPoint(X,i,E,S,d,s),T=i.rect;var _=s._interactPrefix=i.prefix;if(I[c+"|"+t]){var h=_&&s.a(_+o)||S[o];h&&h.call(S,G,s,d,Y,T.width,T.height),this.fire("comp",o,G,s,z,S,Y,T)}(z=T.image)&&I[c+"|"+t+"|image"]&&(z[o]&&z[o](G,s,d,Y,T.width,T.height),this.fire("image",o,G,s,z,m,Y,T)),s._interactPrefix=null}}},handleClickImage:function(A,M,Y,j,E,b,J,x){var v=this.downInfo.hits,G=x.hits;if(v&&M&&(M=qg(M))){var e=this.gv,d=J.rect,T=this.convertPoint(b,J);v[A+"|image"]&&(M[Y]&&M[Y](j,E,e,T,d.width,d.height),this.fire("image",Y,j,E,M,m,T,d));for(var Z=J.compInfos,k=M,U=Z.length-1;U>=0;U--){var W=Z[U],F=W.comp;T=this.convertPoint(b,W,k,F,e,E),d=W.rect;var P=E._interactPrefix=W.prefix;if(v[A+"|"+U]&&G[A+"|"+U]){var p=P&&E.a(P+Y)||F[Y];p&&p.call(F,j,E,e,T,d.width,d.height),this.fire("comp",Y,j,E,M,F,T,d)}(M=d.image)&&v[A+"|"+U+"|image"]&&(M[Y]&&M[Y](j,E,e,T,d.width,d.height),this.fire("image",Y,j,E,M,m,T,d)),E._interactPrefix=null}}},initImageResource:function(){O.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(Q,h,U,e,E,a){var F=h.rect,f=h.matrix.applyInverse(Q).sub(F),p=f.x>=0&&f.y>=0&&f.x<=F.width&&f.y<=F.height;if(!p)return f;if(e&&Ti(e.pixelPerfect,a,E)){var F,D=1;this._is2d?(D=E.getZoom(),F=yp(Q.x,Q.y,m,D)):F=yp(Q.x,Q.y);var k=!1,G=F.x,R=F.y,z=F.width,q=F.height,I=O.hitMaxArea,r=z*q*D*D;if(r>I){var P=Math.sqrt(I/r);D*=P}z*=D,q*=D,2>z&&(z=2),2>q&&(q=2),G*=D,R*=D;var J=Fi(z,q),W=new Lp(0,-G,-R,D,D);W.append(h.matrix),E._drawForChecking=!0,e.transform=W;var V=U.comps;U.comps=[e],qo(J,U,0,0,z,q,a,self),U.comps=V,delete e.transform,E._drawForChecking=!1;try{for(var K=0,o=J.getImageData(0,0,z,q).data;K<o.length;K+=4)if(0!==o[K+3]){k=!0;break}J.restore()}catch(Y){Le=A,k=!1}f.inRect=k}else f.inRect=!0;return f}});var Od=$c.DefaultInteractor=function(C){To(Od,this,[C])};Hi("DefaultInteractor",sr,{handle_mousedown:function(z){Ec(z);var H=this,j=H.gv,o=j.getDataAt(z);if(j.setFocus(z)&&!j._editing&&!j._scrolling){yk(z)?j.handleDoubleClick(z,o):j.handleClick(z,o);var J=fc(z);!Yk()&&!J&&o&&(j.isMovable(o)||j._39Q(o))||!j.isPannable()||!im(z)&&!J||Hr(z)||(H._tx=j.tx(),H._ty=j.ty(),H.startDragging(z))}},handleWindowMouseUp:function(p){var U=this,G=U.gv;G._panning&&(delete G._panning,G.onPanEnded(),U.fi({kind:"endPan",event:p})),delete U._tx,delete U._ty,U.clearDragging()},handle_mousemove:function(T){var r=this,V=r.gv;r._hoverTimer&&(z(r._hoverTimer),delete r._hoverTimer),r._hoverTimer=l(function(){r.fi({kind:"hover",event:T}),z(r._hoverTimer),delete r._hoverTimer},V.getHoverDelay()||O.hoverDelay)},handle_touchmove:function(H){this.handle_mousemove(H)},handleWindowMouseMove:function(A){var x=this,J=x.gv;x.fi({kind:J._panning?"betweenPan":"beginPan",event:A}),J._panning=1;var y=ip(J,A,x._lastClientPoint);J.setTranslate(x._tx+y.x,x._ty+y.y)},handle_mousewheel:function(H){this.gv.handleScroll(H,H.wheelDelta)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(Q){this.gv.handleKeyDown(Q)}});var af=$c.SelectInteractor=function(Z){To(af,this,[Z])};Hi("SelectInteractor",sr,{_42:function(){var m=this,v=m.gv,M=v.getZoom(),i=m.mark,q=m.div;q||(q=m.div=Gj(),gr(m.getView(),q));var C={};C.x=i.x*M+v.tx(),C.y=i.y*M+v.ty(),C.width=i.width*M,C.height=i.height*M,tj(q,C),this.intersects()?(q.style.border="",q.style.background=v.getRectSelectBackground()):(q.style.background="",q.style.border="1px solid "+v.getRectSelectBorderColor())},handle_mousedown:function(b){var Z=this,J=Z.gv;if(Z._57I=A,Z.pendingClickThrough=A,!(J._editing||J._scrolling||Yk()||fc(b))){var I=J.getDataAt(b),T=J.sm();I?Hr(b)?T.co(I)?T.rs(I):T.as(I):T.co(I)?I instanceof bb&&I.isClickThroughEnabled()&&im(b)&&(Z.pendingClickThrough=Pb(b)):T.ss(I):Hr(b)||!J.isPannable()?im(b)&&(Hr(b)||T.cs(),J.isRectSelectable()&&(Z.startDragging(b),J._77O=1)):im(b)&&(Z._57I=Pb(b))}},handle_mouseup:function(C){var g=this,t=g.gv,O=g._57I;if(O&&(Ng(O,Pb(C))<=1&&t.sm().cs(),g._57I=A),g.pendingClickThrough){if(Ng(g.pendingClickThrough,Pb(C))<=1){var o=t.getDataAt(C);if(o instanceof bb&&o.isClickThroughEnabled()){var B=t.getDataAt(C,function(U){var P=U.getParent()===o&&t.isSelectable(U,!0);return P});B&&(C.clickThrough=!0,t.sm().ss(B))}}g.pendingClickThrough=A}},handleWindowMouseUp:function(H){this.clear(H)},handleWindowMouseMove:function(R){var a=this,O=a.gv;a._logicalPoint=O.lp(R),a.mark?(a.fi({kind:"betweenRectSelect",event:R}),O.isPannable()&&a.autoScroll(R),a.redraw()):a.fi({kind:"beginRectSelect",event:R}),a.mark=pj(a._lastLogicalPoint,a._logicalPoint),a.redraw()},intersects:function(){var t=this,n=t._lastLogicalPoint,f=t._logicalPoint;return n.x>f.x||n.y>f.y},clear:function(X){var f=this,h=f.gv,m=f.mark;if(f._57I=A,f.pendingClickThrough=A,f._lastLogicalPoint){if(m){if(0!==m.width&&0!==m.height){var B=h.getDatasInRect(m,f.intersects());if(!B.isEmpty()){var y=h.sm(),$=y.toSelection();B.each(function(w){y.co(w)?$.remove(w):$.add(w)}),y.ss($)}}ws(f.div),delete f.div,delete f.mark,f.redraw(),f.fi({kind:"endRectSelect",event:X}),h.onRectSelectEnded()}f.clearDragging(),delete h._77O}},redraw:function(){var K=this;K._draw||(K._draw=1,l(function(){K.mark&&K._42(),delete K._draw},16))}});var Nk=$c.MoveInteractor=function(g){To(Nk,this,[g])};Hi("MoveInteractor",sr,{handle_mousedown:function(q){var e=this,N=e.gv;if(im(q)&&!N._editing&&!N._scrolling&&!Yk()){var W=N.getSelectedDataAt(q);!W||N._39Q(W)&&!N.isMovable(W)?N._focusData=A:(e._data=W,N.handleMouseDown&&N.handleMouseDown(q,W),e.startDragging(q),N.isMovable(W)&&(N._moving=1))}},handleWindowMouseUp:function(O){var Z=this,M=Z.gv;M.handleMouseUp&&M.handleMouseUp(O,Z._data),Z.clear(O)},handleWindowMouseMove:function(f){var J=this,y=J._data,o=J.gv;if((!o._93O||!o._93O(f,y))&&o._moving){J._logicalPoint||J.fi({kind:"prepareMove",event:f});var k=J._logicalPoint?"betweenMove":"beginMove",c={kind:k,event:f},Z=J._logicalPoint=o.lp(f);"beginMove"!==k||J._alreadyBeginTransaction||(J._alreadyBeginTransaction=!0,o.getDataModel().beginTransaction());var j=J._calcShift(k,f),I=j.x,r=j.y,i=J.gv.getMoveMode(f,y);i&&("x"===i?r=0:"y"===i?I=0:"xy"!==i&&(I=r=0)),o.moveSelection(I,r),J._lastLogicalPoint=Z,J.autoScroll(f),J.fi(c)}},_calcShift:function(){var r=this,W=r._logicalPoint,S=r._lastLogicalPoint,D=W.x-S.x,v=W.y-S.y;return{x:D,y:v}},clear:function(D){var N=this,R=N.gv;N._lastLogicalPoint&&(N._lastLogicalPoint=N._data=R._moving=A,N._logicalPoint&&(N.fi({kind:"endMove",event:D}),R.onMoveEnded()),N.clearDragging()),N._alreadyBeginTransaction&&(N._alreadyBeginTransaction=!1,R.getDataModel().endTransaction())}});var gj=$c.TextEditInteractor=function(W){To(gj,this,[W]),this.init()};Hi("TextEditInteractor",sr,{init:function(){var G=this,L=this.input=J.createElement("input"),e=L.style;L.text="text",e.border="1px solid #d8d8d8",e.position="absolute",e.padding="2px 3px",e.outline="none",e.marginLeft="-90px",e.marginTop="-16px",e.backgroundColor="rgba(255,255,255, 0.9)",e.fontSize="14px",e.width="180px",e.height="32px",e.boxShadow="0 0 13px rgba(16,142,233, 0.5)",e.textAlign="center",e.boxSizing="border-box",x(L,"keyup",function(i){Yq(i)&&G.endTextEdit()}),x(L,"focus",function(){L.select()});var w=this.textarea=J.createElement("textarea"),D=this.wrap=J.createElement("div");D.appendChild(w),e=w.style,e.margin=0,e.padding="4px",e.overflow="hidden",e.boxSizing="border-box",e.position="absolute",e.outline="none",e.backgroundColor="transparent",e.resize="none",e.textAlign="center",e.fontSize="14px",e.border="none",e.borderWidth=0,e.width="100%",e.top="50%",e=D.style,e.boxSizing="border-box",e.margin=0,e.padding=0,e.position="absolute",e.boxShadow="0 0 13px rgba(16,142,233, 0.5)",e.border="1px solid #d8d8d8",e.backgroundColor="rgba(255,255,255, 0.9)",e.width="180px",e.marginLeft="-90px",x(w,"keydown",function(u){return(ah()||Hr())&&Yq(u)?(G.endTextEdit(),void 0):(G.calculateTextareaHeight(String.fromCharCode(u.keyCode)),void 0)}),x(w,"focus",function(){w.select()});var V=function(t){t.stopPropagation()};x(L,"mousedown",V),x(L,"touchstart",V),x(w,"mousedown",V),x(w,"touchstart",V),G.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],G.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",G.handleWindowClick=function(E){var T=G._editingDOM;if(T){var A=T.getBoundingClientRect(),e=Pb(E);ub(A,e)||G.endTextEdit()}}},handle_mousedown:function(n){var l=this,H=l.gv;if(yk(n)&&!H._editing){var L=H.getDataAt(n);if(L){var h=H.getTextEditInfo(L);h&&(this._editInfo=h,this._editTarget=L,H._editing=!0,h.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var T=this,S=T.gv,z=T._editTarget,y=T.getTargetValue(),R=T.textarea,v=T.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===y||y===m)&&(y=""),R.value=y,T._editingDOM=R,S.getView().appendChild(v),this.layoutHTML(v,z),this.calculateTextareaHeight(),l(function(){R.focus(),x(q,"mousedown",T.handleWindowClick),x(q,"touchstart",T.handleWindowClick)},10)},handleTextEdit:function(){var F=this,Z=F.gv,_=F._editTarget,D=F.getTargetValue(),g=F.input;(null===D||D===m)&&(D=""),g.value=D,F._editingDOM=g,Z.getView().appendChild(g),this.layoutHTML(g,_),l(function(){g.focus(),x(q,"mousedown",F.handleWindowClick),x(q,"touchstart",F.handleWindowClick)},10)},layoutHTML:function(J,O){var r=this.gv,j=r.getZoom();if(O instanceof f.Node){var q=O.getRect();J.style.left=(q.x+q.width/2)*j+r.tx()+"px",J.style.top=(q.y+q.height/2)*j+r.ty()+"px"}else if(O instanceof f.Edge){var K=r.getDataUI(O),q=K._6I;J.style.left=(q.x+q.width/2)*j+r.tx()+"px",J.style.top=(q.y+q.height/2)*j+r.ty()+"px"}},endTextEdit:function(){var v=this,C=v._editInfo.isMultiline?v.wrap:v.input,A=v._editInfo.isMultiline?v.textarea:v.input;v.setTargetValue(A.value),v.gv.getView().removeChild(C),v.gv._editing=!1,delete v._editingDOM,h(q,"mousedown",v.handlelick),h(q,"touchstart",v.handleWindowClick)},setTargetValue:function(w){var u=this,M=u._editTarget,T=u._editInfo,D=T.accessType,b=T.name;if(b&&D||(D="p",b="name"),"p"===D){var j=f.Default.setter(b);M[j](w)}else"a"===D?M.a(b,w):M.s(b,w)},getTargetValue:function(){var x=this,k=x._editTarget,I=x._editInfo,G=I.accessType,d=I.name;if(d&&G||(G="p",d="name"),"p"===G){var o=f.Default.getter(d);return k[o]()}return"a"===G?k.a(d):k.s(d)},createHiddenTextarea:function(){this.hiddenTextarea=J.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(i,y){if(y&&this.computedStyleCache)return this.computedStyleCache;var z=this,o=q.getComputedStyle(i),D=o.getPropertyValue("box-sizing")||o.getPropertyValue("-moz-box-sizing")||o.getPropertyValue("-webkit-box-sizing"),Y=parseFloat(o.getPropertyValue("padding-bottom"))+parseFloat(o.getPropertyValue("padding-top")),M=parseFloat(o.getPropertyValue("border-bottom-width"))+parseFloat(o.getPropertyValue("border-top-width")),X=z.SIZING_STYLE.map(function($){return $+":"+o.getPropertyValue($)}).join(";"),h={sizingStyle:X,paddingSize:Y,borderSize:M,boxSizing:D};return y&&(this.computedStyleCache=h),h},calculateTextareaHeight:function(s){s=s||"";var t=this,G=t.textarea,B=t.hiddenTextarea,J=t.wrap,y=32,o=t.calculateHTMLStyle(G,!1),M=o.paddingSize,v=o.borderSize,n=o.boxSizing,r=o.sizingStyle;B.setAttribute("style",r+";"+t.HIDDEN_TEXTAREA_STYLE),B.value=G.value+s;var b=B.scrollHeight;"border-box"===n?b+=v:"content-box"===n&&(b-=M),G.style.height=b+"px",G.style.marginTop=0-.5*b+"px",J.style.height=Math.max(b,y)+"px",J.style.marginTop=b*-.5+"px"}});var df=$c.ScrollBarInteractor=function(b){To(df,this,[b])};Hi("ScrollBarInteractor",sr,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(k){var Z=this.gv.getViewRect();return this._41o()&&(Z.x+Z.width-this.gv.lp(k).x)*this.gv.getZoom()<Fn},isH:function(R){var Z=this.gv.getViewRect();return this._40o()&&(Z.y+Z.height-this.gv.lp(R).y)*this.gv.getZoom()<Fn},handle_mousemove:function(j){this.handle_touchmove(j)},handle_touchmove:function(l){if(!ig&&im(l)&&this.gv.isScrollBarVisible()){var R=this,P=R.isV(l),u=R.isH(l);(P||u)&&R.gv.showScrollBar(),R.gv._scrolling=P||u}},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(Q){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=A,this.fi({kind:"endScroll",event:Q})},handle_mousedown:function(V){this.handle_touchstart(V)},handle_touchstart:function(F){var s=this;if(s.gv.setFocus(F),Ec(F),s.handle_touchmove(F),!(Sc(F)>1)&&s.gv._scrolling&&s.gv.isScrollBarVisible()){s._cp=Pb(F),s._tx=s.gv.tx(),s._ty=s.gv.ty();var e=s.isV(F);s._state=e?"vScroll":"hScroll",Ff(s,F),s.fi({kind:"beginScroll",event:F})}},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(D){var b=Pb(D),l=this.gv.getViewRect(),x=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-b.y)*x.height/l.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-b.x)*x.width/l.width),this.fi({kind:"betweenScroll",event:D})}});var ei=$c.TouchInteractor=function(i,u){u=u||{},u.selectable===m&&(u.selectable=!0),u.movable===m&&(u.movable=!0),u.pannable===m&&(u.pannable=!0),u.pinchable===m&&(u.pinchable=!0),u.editable===m&&(u.editable=!0),this.params=u,To(ei,this,[i])};Hi("TouchInteractor",sr,{ms_edit:1,setUp:function(){var y=this;ei.superClass.setUp.call(y),hj&&y.params.editable&&y.gv.setEditInteractor(y)},tearDown:function(){var v=this;ei.superClass.tearDown.call(v),hj&&v.params.editable&&v.gv.setEditInteractor(A)},clear:function(y){var r=this,o=r.gv;o._moving&&(r.fi({kind:"endMove",event:y}),delete o._moving,o.onMoveEnded(),o.dm().endTransaction()),o._panning&&(r.fi({kind:"endPan",event:y}),delete o._panning,o.onPanEnded()),o._pinching&&(r.fi({kind:"endPinch",event:y}),delete o._pinching,o.onPinchEnded()),o._editing&&(r._46O(y),r._77I=r._node=r._edge=r._shape=r._rect=r._89I=r._index=o._editing=A),r._moving=r._panning=r._pinching=r._editing=r._57I=r._data=r._beginHistory=A,r.clearDragging()},handle_touchstart:function(L){var n=this;if(!n.gv._editing){Ec(L),n._57I=A;var N=n.params,F=n.gv,C=F.sm(),U=F.getDataAt(L),f=Sc(L);if(1===f){if(yk(L))return F.handleDoubleClick(L,U),void 0;F.handleClick(L,U),U&&(F.handleMouseDown&&F.handleMouseDown(L,U),n._data=U),N.selectable||(U=A),U&&(C.co(U)||C.ss(U),N.editable&&F.isEditable(U)&&n._79I(L,U,!0)?(n._editing=1,n.startDragging(L)):N.movable&&F.isMovable(U)&&(n._moving=1,n.startDragging(L))),U&&F.isMovable(U)||(n._57I=Pb(L),N.pannable&&F.isPannable()&&(n._panning=1,n.startDragging(L),n._translate={x:F.tx(),y:F.ty()}))}else if(N.pinchable&&2===f){if(U&&F._39Q(U))return;n._pinching=1,n.startDragging(L);var $=F.getView(),I=F.getZoom(),i=$.getBoundingClientRect(),X=L.touches[0],l=L.touches[1],r={x:(X.clientX+l.clientX)/2-i.left,y:(X.clientY+l.clientY)/2-i.top};r.x-=F.tx(),r.y-=F.ty(),r.x/=I,r.y/=I,n._p=r,n._d=Gl(L)}}},handle_touchend:function(_){var F=this,S=F.gv,e=F._57I,T=F._data;e&&(Ng(e,Pb(_))<=1&&!graphView.getDataAt(_)&&S.sm().cs(),F._57I=A),T&&S.handleMouseUp&&S.handleMouseUp(_,T)},handleWindowTouchEnd:function(S){this.clear(S)},handleWindowTouchMove:function(g){var M=this,m=M.gv,O=Sc(g);if(1===O){if(M._editing&&(M._beginHistory||(M._beginHistory=1,m.dm().beginTransaction()),m._editing=1,M._78I(g)),M._moving)M._beginHistory||(M._beginHistory=1,m.dm().beginTransaction()),M.handleMove(g);else if(M._panning){var u=Pb(g),r=ip(m,u,M._lastClientPoint);m.setTranslate(M._translate.x+r.x,M._translate.y+r.y),M.fi({kind:m._panning?"betweenPan":"beginPan",event:g}),m._panning=1}}else if(2===O&&M._pinching){var G=Gl(g);m.handlePinch(M._p,G,M._d),M._d=G,M.fi({kind:m._pinching?"betweenPinch":"beginPinch",event:g}),m._pinching=1}},handleMove:function(D){var K=this,j=K.gv,h=j.lp(D);j._93O&&j._93O(D,K._data)||(j.moveSelection(h.x-K._lastLogicalPoint.x,h.y-K._lastLogicalPoint.y),K._lastLogicalPoint=h,K.autoScroll(D),K.fi({kind:j._moving?"betweenMove":"beginMove",event:D}),j._moving=1)}});var f=q.ht,Hf=f.graph._editor={Math:f.Math,Guide:{}};Hf.getStyle=function(B){var S,T=Hf.StyleMap;return T&&(S=T[B],S!==m)?S:Hf.DefaultStyleMap[B]},Hf.setStyle=function(L,C){var $=Hf.StyleMap;$||($=Hf.StyleMap={}),$[L]=C},Hf.inEdit=function(p){return p._inXEdit===!0},Hf.startEdit=function(V){V._inXEdit=!0,Hf.Inject.doInject(V)},Hf._46O=function(M){M._inXEdit=!1,Hf.Inject.undoInject(M)},Hf.toScreenPosition=function(G,T){var P=G.tx(),J=G.ty(),F=G._zoom;return new Hf.Math.Vector2(T.x*F+P,T.y*F+J)},Hf.checkHit=function(v,g,X){return v.distanceTo(g)<X?!0:!1},Hf.toWorldPosition=function(A,l){var B=A.tx(),g=A.ty(),e=A._zoom;return{x:(l.x-B)/e,y:(l.y-g)/e}},Hf.setAntialias=function(q,o){for(var y,x=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],J=0,b=x.length;b>J&&(y=x[J],!(y in q));J++);q[y],q[y]=o},Hf.getTargetCornersOnScreen=function(o,a){if(!a)return null;var U,W=[];if(mm(a,o)){var e=sp(o,a);U=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}else{if(!a.getCorners)return null;U=a.getCorners()}return U.forEach(function(H){var m=Hf.toScreenPosition(o,H);W.push(m.x,m.y)}),W},Hf.log=function(){};var Kr=Hf.Inject={_modules:[]};Kr.registAsModule=function(z,y){var c={},p={};for(var Z in z){var T=y.prototype[Z];c[Z]=T}z.getBackup=function(d){return c[d]},z.getBackups=function(){return c},p.doInject=function(){for(var r in z)"getBackup"!==r&&(y.prototype[r]=z[r])},p.undoInject=function(){for(var $ in z)"getBackup"!==$&&(y.prototype[$]=c[$])},Kr._modules.push(p)},Kr.doInject=function(V){for(var K,q=Kr._modules,L=0,g=q.length;g>L;L++)K=q[L],K.doInject(V)},Kr.undoInject=function(y){for(var C,O=Kr._modules,w=0,u=O.length;u>w;w++)C=O[w],C.undoInject(y)};var sr=f.graph.EditInteractor=function(k){var H=this,P=J.createElement("canvas");P.className="editCanvas",P.style.position="absolute",H._styleMap={},H._canvas=P,H._context=P.getContext("2d"),sr.superClass.constructor.call(H,k),this._editDetail=!1,Hf.setAntialias(H._context,!1),H._subModules=[new Hf.Anchor(H),new Hf.RotateX(H),new Hf.MoveDummy(H),new Hf.Rect(H),new Hf.Curve(H),new Hf.MoveHelper(H)],H._gridGuide=new Hf.Guide.Grid(H),H._rectGuide=new Hf.Guide.Rect(H),H._hoverGuide=new Hf.Guide.Hover(H)},Nh=sr;f.Default.def(sr,f.graph.Interactor,{ms_edit:1,ms_fire:1}),I.defineProperties(sr.prototype,{editDetail:{get:function(){var f=!!this._editDetail;return f},set:function(C){var G=this,O=G._editDetail;O!==C&&(G._editDetail=C,G.gv._editing=C,G.fp("editDetail",O,C),G.fp("pointsEditingMode",O,C),G.fi({kind:C?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(R){(!this._editDetail||R)&&(this.gv._editing=R,R||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(P){this._editing=P,this.gvEditing=P}},pointsEditingMode:{get:function(){return this.editDetail},set:function(l){var R=this;R.editDetail!==l&&(l?R._tryEnterEditDetailMode():R._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var L=this._gridEnabled;if(!L)return!1;var r=this.gv;return r?!0:!0},set:function(b){b!==this._gridEnabled&&(this._gridEnabled=b,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(s){s!==this._agEnabled&&(this._agEnabled=s,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),sr.prototype.getSubModule=function(x){var d,y,i,e=this._subModules;for(y=0,i=e.length;i>y;y++)if(d=e[y],d.catalog===x)return d},sr.prototype.invokeSubModule=function(e,d){var G=this,g=G._subModules;if(g)for(var H,l,S,b=Array.prototype.slice.call(arguments,2),j=0,W=g.length;W>j;j++)if(H=g[j],l=H[e],l&&(S=l.apply(H,b),S!=m&&d))return H
},sr.prototype.invokeSubModuleInverse=function(d,u){var V=this,Y=V._subModules;if(Y)for(var J,q,N,I=Array.prototype.slice.call(arguments,2),n=Y.length-1;n>=0;n--)if(J=Y[n],q=J[d],q&&(N=q.apply(J,I),N!=m&&u))return J},sr.prototype.setUp=function(){Hf.log("setUp");var C=this,r=C.gv,x=r.getView(),M=C._canvas;sr.superClass.setUp.call(C),r.setEditInteractor(C),r._79O?x.insertBefore(M,r._79O):x.appendChild(M),Hf.startEdit(r),C.invokeSubModule("setUp"),r.dm().mm(C._onDataModelChanged,C),r.dm().md(C._onDataPropertyChanged,C)},sr.prototype.tearDown=function(){Hf.log("tearDown");var D=this,M=D.gv,j=M.getView();D._resetCustomCursorStyle(),sr.superClass.tearDown.call(D),M.dm().umm(D._onDataModelChanged,D),M.dm().umd(D._onDataPropertyChanged,D),M.setEditInteractor(null),j.removeChild(D._canvas),D._drawTimer&&(z(D._drawTimer),D._drawTimer=null),Hf._46O(M),D.invokeSubModule("tearDown")},sr.prototype._onDataModelChanged=function(D){var B=this;("clear"===D.kind||"remove"===D.kind&&B.editDetail&&D.data===B.getSubModule("Curve").target)&&(B.editDetail=!1,B._42())},sr.prototype._onDataPropertyChanged=function(g){var X=this;if(X.editDetail){var k=X.getSubModule("Curve"),b=g.data;b===k.target&&(b._writing||k._handleDataChanged(g))}},sr.prototype.clear=function(){Hf.log("clear")},sr.prototype.redraw=function(){this._42()},sr.prototype._42=function(){var p=this;p._drawTimer||(p._drawTimer=l(function(){p._drawTimer=null,p.drawImpl()},0))},sr.prototype.drawImpl=function(){var $;for($ in{_42:!0})break;return function(){var H=this,u=H._canvas,M=H.gv,y=M.getWidth(),r=M.getHeight(),t=H._context,m=f.Default.getInternal(),B=q.devicePixelRatio;(u.width!==y||u.height!==r)&&m.setCanvas(u,y,r,B),t.clearRect(0,0,u.width,u.height);var A=H._getValidSelection();t.save(),t.scale(B,B),H._gridGuide._42(),H.invokeSubModuleInverse($,!1,t,M,A),H._rectGuide._42(),H._hoverGuide._42(),t.restore()}}(),sr.prototype._getValidSelection=function(){var m=this,e=m.gv,W=e.sm().getSelection(),O=[];return W.each(function(n){e.isVisible(n)&&e.isEditable(n)&&O.push(n)}),O},sr.prototype.handle_touchmove=function(H){return this.handle_mousemove(H)},sr.prototype.handle_mousemove=function(L){if(!f.Default.isDragging()){var E=this;if(E.editDetail||!Yk()&&!fc(L))if(E.gvEditing=!1,E._checkEdit(L))E.gvEditing=!0;else{if(!E.getStyle("hoverGuideVisible"))return;E.hoverData=E.gv.getDataAt(L),E._42()}}},sr.prototype.handle_touchstart=function(g){return this.handle_mousedown(g)},sr.prototype.handle_mousedown=function(k){Ec(k);var M=this;if(M.editDetail||!Yk()&&!fc(k)){if(yk(k)&&!k.clickThrough){if(M.editDetail){if(M._tryQuitEditDetailMode(k))return}else if(M._tryEnterEditDetailMode())return;M.gv.dm().beginTransaction();var G=M.invokeSubModule("handleDoubleClick",!0,k);if(M.gv.dm().endTransaction(),G)return}var V=M._checkEdit(k);V&&(M._downPosition=M._getLogicalPoint(k),M.gv.dm().beginTransaction(),V.startEdit(M,k),M.editing=!0)}},sr.prototype._checkEdit=function(u){var m=this,v=m.gv,H=m._getLogicalPoint(u),X=m.invokeSubModule("check",!0,v,u,H)||null;return m._editMod=X,X},sr.prototype.handleWindowTouchMove=function(e){return this.handleWindowMouseMove(e)},sr.prototype.handleWindowMouseMove=function(C){var m=this,B=m._downPosition;if(B){var n=m._getLogicalPoint(C);if(n.distanceTo(B)<m.getStyle("moveSensitivity"))return;delete m._downPosition}var k=m._editMod;k&&k.handleEdit(m.gv,C)},sr.prototype._getLogicalPoint=function(x){var W=this,y=f.Default.getLogicalPoint(x,W._canvas);return new Hf.Math.Vector2(y)},sr.prototype.handleWindowTouchEnd=function(M){return this.handleWindowMouseUp(M)},sr.prototype.handleWindowMouseUp=function(){var m;for(m in{_46O:!0})break;return function(h){var P=this;P.editing=!1,P.setCursor("default"),P.invokeSubModule(m,!1,h),P._42(),P.gv.dm().endTransaction()}}(),sr.prototype.handle_mousewheel=function(Z){var f=this;Ec(Z),f.invokeSubModule("preHandleScroll",!0)||f.gv.handleScroll(Z,Z.wheelDelta)},sr.prototype.handleDelete=function(){var $=this;if(!$.editDetail){$.gv.dm().beginTransaction();var W=$.invokeSubModule("handleNormalStateDelete",!0);return $.gv.dm().endTransaction(),W||$.gv.removeSelection(),void 0}$.gv.dm().beginTransaction(),$.invokeSubModule("handleDelete",!0),$.gv.dm().endTransaction(),$._42()},sr.prototype.handle_keydown=function(E){var q=this;if((E.metaKey||E.ctrlKey)&&q._42(),Yk(E)&&!q.editing)return q.gvEditing=!1,q.setCursor("default"),q._42(),void 0;var Z=Yq(E);return q.editDetail?((Z||hb(E))&&(q.editDetail=!1,q._42()),q.gv.dm().beginTransaction(),q.invokeSubModule("handle_keydown",!0,E),q.gv.dm().endTransaction(),void 0):(q.gv.dm().beginTransaction(),q.invokeSubModule("handleNormalStateKeyDown",!0,E),q.gv.dm().endTransaction(),Z&&q._tryEnterEditDetailMode(),void 0)},sr.prototype.handle_keyup=function(Q){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,Q),this.gv.dm().endTransaction()},sr.prototype._tryEnterEditDetailMode=function(){var A=this;return!A.editDetail&&A.invokeSubModule("canEnterEditDetailMode",!0)&&1===A._getValidSelection().length?(A.editDetail=!0,A._42(),!0):void 0},sr.prototype._tryQuitEditDetailMode=function(P){var M=this;return M.editDetail?!P||M.invokeSubModule("canQuitEditDetailMode",!0,P)?(M.editDetail=!1,M._42(),!0):!1:!1},sr.prototype.setStyle=function(t,X,H){var h=this;H?Hf.setStyle(t,X):h._styleMap[t]=X,"baseColor"===t&&(ri=X),h.fp("styleChanged",null,{key:t,value:X,base:H}),h._42()},sr.prototype.getStyle=function(q){var A=this,G=A._styleMap[q];return G!==m?G:Hf.getStyle(q)},sr.prototype.setCursor=function(u){this._resetCustomCursorStyle(),f.graph.EditInteractor.superClass.setCursor.call(this,u)},sr.prototype._resetCustomCursorStyle=function(){var e=this;if(e._customStyle){var h=this.gv.getView();h.classList&&h.classList.remove&&h.classList.remove(e._customStyle),e._customStyle=null}},sr.prototype._setRotateCursor=function(h){var W=this,n=W._cursorFactory;n||(n=W._cursorFactory=new Hf.CursorFactory(W));var d=n.getRotateCursor(h),H=W.gv.getView();W._resetCustomCursorStyle(),W._customStyle=d,H.classList&&H.classList.add&&H.classList.add(d)};var tq=Hf.Group=function(f){var q=this;q._entities=f,q._64O=0,q._position={x:0,y:0},q._scale={x:1,y:1},q._anchor={x:.5,y:.5},q._anchor2={x:.5,y:.5}};tq.prototype={},tq.prototype.constructor=tq;var Sh=null;tq.findOrCreateGroup=function(K){if(Sh&&Sh.checkIsMe(K))return Sh;var R=new Hf.Group(K);return R.getKeyOb()?(Sh=R,R):void 0},tq.prototype.checkIsMe=function(P){var E=this._entities;if(E.length!==P.length)return!1;var H,G={},v=P.length;for(H=0;v>H;H++)G[P[H]._id]=!0;for(H=0;v>H;H++)if(!G[E[H]._id])return!1;return!0},tq.prototype.getRotation=function(){return this._64O},tq.prototype.getPosition=function(){return this._position},tq.prototype.getAnchor=function(){return this._anchor},tq.prototype.getWidth=function(){return this._width},tq.prototype.getScale=function(){return this._scale},tq.prototype.getSize=function(){return{width:this._width,height:this._height}},tq.prototype.getHeight=function(){return this._height},tq.prototype.getKeyOb=function(){for(var s=this._entities,Y=s.length-1;Y>=0;Y--){var m=s[Y];if(this.isNode(m))return m}},tq.prototype.getAnchor2=function(){var H=this,l=H.rotateCenter;if(l)return l;var M=H.getKeyOb();if(!M)return H._anchor;var $=H._anchor2,D=M.getMatrix();return D.tf({x:M.getWidth()*($.x-M.getAnchor().x),y:M.getHeight()*($.y-M.getAnchor().y)})},tq.prototype.setAnchor2=function(T,e){var I=this,s=I.getKeyOb();if(s){var V,l=s.getMatrix();V="number"==typeof T?{x:T,y:e}:T;var h=l.tfi(V);I._anchor2={x:s.getAnchor().x+h.x/s.getWidth(),y:s.getAnchor().y+h.y/s.getHeight()}}},tq.prototype.setRotation=function(){},tq.prototype.beginRotate=function(N){this.rotateCenter=N.pos,this.rotateMode=N.groupRotateMode},tq.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},tq.prototype.addRotation=function(x,y){return"batch"===y?this._addRotationInBatchMode(x):"block"===y?this._addRotationInBlockMode(x):void 0},tq.prototype._addRotationInBlockMode=function(c){var i=this,e=i.rotateCenter||i.getPosition();i._entities.forEach(function(r){if(i.isNode(r)){var k=r.getMatrix();k.translate(-e.x,-e.y),k.rotate(c),k.translate(e.x,e.y);var m=Math.sign(r.getScale().x);r.setRotation(b(k.b*m,k.a*m)),r.setPosition(k.tx,k.ty)}})},tq.prototype._addRotationInBatchMode=function(I){var $=this,X=$._anchor2;$._entities.forEach(function(_){if($.isNode(_)){var o=_.getAnchor(),R=_.getMatrix(),v=R.tf({x:_.getWidth()*(X.x-o.x),y:_.getHeight()*(X.y-o.y)}),Y=new Hf.Math.Matrix2d;Y.set(R.a,R.b,R.c,R.d,R.tx,R.ty),Y.translate(-v.x,-v.y),Y.rotate(I),Y.translate(v.x,v.y);var m=Math.sign(_.getScale().x);_.setRotation(b(Y.b*m,Y.a*m)),_.setPosition(Y.tx,Y.ty)}})},tq.prototype.setPosition=function(W){var c,F,y,Q,A=this,d=A._position,r=W.x-d.x,H=W.y-d.y,q=A._entities;for(F=0,y=q.length;y>F;F++)c=q[F],uh(c)&&(Q=c.getPosition(),c.setPosition(Q.x+r,Q.y+H));A._position=W},tq.prototype.setScale=function($,N){var b=this,c=$/b._scale.x,A=N/b._scale.y;b._adjustChildScaleOrSize(c,A,"size"),b._scale={x:$,y:N}},tq.prototype.getRect=function(){var J=this,o=J._position,k=J._width,w=J._height;return{x:o.x-k/2,y:o.y-w/2,width:k,height:w}},tq.prototype.setSize=function(P,f){var u=this,P=Math.max(1,P),f=Math.max(1,f),A=P/u._width,L=f/u._height;u._adjustChildScaleOrSize(A,L,"size"),u._width=P,u._height=f},tq.prototype._adjustChildScaleOrSize=function(P,E,H){var A,g,u,y,B,M,o,I,F,c,n,k,v,i,m=this,s=m._position,l=m._entities,C=new Hf.Math.Matrix2d;for(g=0,u=l.length;u>g;g++)if(A=l[g],m.isNode(A)){if(y=A.getPosition(),B=A.getRotation(),M=A.getWidth(),o=A.getHeight(),I=A.getScale(),n=I.x*M,k=I.y*o,C.identity().scale(n,k).rotate(B).translate(y.x,y.y).translate(-s.x,-s.y).rotate(-m._64O),B=b(C.b*Math.sign(n),C.a*Math.sign(n)),C.scale(P,E),F=Math.cos(B),c=Math.sin(B),Math.abs(F)<.001?(v=C.b/c,i=-C.c/c):(v=C.a/F,i=C.d/F),"scale"===H)A.setScale(v/M,i/o);else if("size"===H){var X=v/I.x,G=i/I.y;A.setScale(Wq(v)*Math.abs(I.x),Wq(i)*Math.abs(I.y)),A.setSize(Math.max(.1,Math.abs(X)),Math.max(.1,Math.abs(G)))}C.rotate(m._64O).translate(s.x,s.y),A.setPosition(C.tx,C.ty)}},tq.prototype.getMatrix=function(){var k=this,P=k._position,Z=f.Default.getInternal(),L=k._scale;return new Z.Mat(k._64O,P.x,P.y,L.x,L.y)},tq.prototype.toGlobal=function(W){return this.getMatrix().tf(W)},tq.prototype.getCorners=function(){var P=this,d=P._width,Y=P._height,B=P._anchor,E=-d*B.x,Z=-Y*B.y,j=P.getMatrix();return[j.tf(E,Z),j.tf(E,Z+Y),j.tf(E+d,Z+Y),j.tf(E+d,Z)]},tq.prototype.calcInfo=function(){var M,v,g,V,N,a,X=this,G=[],t=X._entities,S=X._64O;for(V=0,N=t.length;N>V;V++)a=t[V],X.isNode(a)&&a.getCorners&&G.push.apply(G,a.getCorners());if(G.length){var z=Math.cos(-S),s=Math.sin(-S),x=1/0,L=-1/0,H=1/0,e=-1/0;for(V=0,N=G.length;N>V;V++)g=G[V],M=g.x,v=g.y,g.x=z*M-s*v,g.y=s*M+z*v,x=Math.min(x,g.x),L=Math.max(L,g.x),H=Math.min(H,g.y),e=Math.max(e,g.y);X._width=(L-x)/X._scale.x,X._height=(e-H)/X._scale.y,z=Math.cos(S),s=Math.sin(S);var R=X._anchor;M=x+(L-x)*R.x,v=H+(e-H)*R.y,X._position={x:z*M-s*v,y:s*M+z*v}}},tq.prototype.isNode=function(j){return uh(j)?mm(j)?!1:!0:!1},tq.prototype._42=function(g,x,K){var J,D,v,O,r,y,N,S,q=this,e=q._entities,f=q.rotateMode;for("batch"===f&&(S=q.getKeyOb()),J=0,D=e.length;D>J;J++)v=e[J],q.isNode(v)&&(y=v.getRect(),O=Hf.toScreenPosition(K,{x:y.x,y:y.y}),r=Hf.toScreenPosition(K,{x:y.x+y.width,y:y.y+y.height}),N={min:O,max:r},v===S&&(N.isKeyOb=!0),Hf.Icons.DrawIcon(g,x,Hf.Icons.GroupSubEntityRect,N))};var bq=Hf.CurveActiving=function(X,b){this._curve=X,this._interactor=X._interactor;for(var g in b)this[g]=b[g]};bq.prototype={},bq.prototype.constructor=bq,I.defineProperties(bq.prototype,{point:{get:function(){return this._point},set:function(j){var $=this;$._point=j,$.editingCtrl||$._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(W){var k=this;k._pairs=W,k.editingCtrl&&k._firePointChange()}}}),bq.prototype._firePointChange=function(){var W=this,r=W.getCurrentEditingPoint(),B=W._interactor;if(!r)return B.fi({kind:"selectPoint"}),void 0;var Y=this._curve.target;if(Y){var s=Hf.getDataMatrix(Y).invert(),z=r.e;r=s.apply(Hf.toWorldPosition(B.gv,r)),r.e=z;var R=W._lastFirePoint;R&&Math.abs(r.x-R.x)<1e-5&&Math.abs(r.y-R.y)<1e-5&&(r.e==m&&R.e==m||Math.abs(r.e-R.e)<1e-5)||(W._lastFirePoint=r,B.fi({kind:"selectPoint",x:r.x,y:r.y,e:r.e}))}},bq.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},bq.prototype.getCurrentEditingPoint=function(){var j=this,i=j.editingCtrl;if(i){var X=j.pairs;if(X){var U=X[i.pairId],R=U[i.type];if(R)return R}}return j._point};var nj=Hf.CursorFactory=function($){var K=this;K._interactor=$,K._rotateCursorStyles={}};nj.prototype={},nj.prototype.constructor=nj,nj.prototype.getRotateCursor=function(g){var U=this;0>g&&(g+=2*Math.PI);var S=U._interactor,J=S.getStyle("rotateCursorSize"),j=S.getStyle("rotateCursorRound"),B=Math.round(180*(g/Math.PI)/j);B*j>=360&&(B=0);var O=U._rotateCursorStyles,s="htCustomRotateStyle_"+J+"_"+j+"_"+B;return O[s]||(U._produceRotateCursor(s,J,j,B),O[s]=!0),s},nj.prototype._produceRotateCursor=function(c,H,I,F){var M=this;M._interactor;var l=M._canvas;l||(l=M._canvas=J.createElement("canvas")),l.width=l.height=H*devicePixelRatio,l.style.width=l.style.height=H+" px";var q=l.getContext("2d");Hf.setAntialias(q,!1),q.scale(devicePixelRatio,devicePixelRatio);var p,R,k,$,L,D=Math.round(H/2),d=""+D+" "+D+",auto !important;";p=Math.PI/180*F*I,q.clearRect(0,0,H,H),q.save(),q.scale(H/32,H/32),q.translate(16,16),q.rotate(p+Math.PI/2),q.beginPath(),q.moveTo(-8,0),q.lineTo(-8,3),q.lineTo(-5,3),q.moveTo(8,0),q.lineTo(8,3),q.lineTo(5,3),q.moveTo(-8,3),q.quadraticCurveTo(0,-6,8,3),q.restore(),q.strokeStyle="white",q.lineWidth=4,q.stroke(),q.strokeStyle="black",q.lineWidth=2,q.stroke(),R=JSON.stringify(l.toDataURL()),$="cursor:url("+R+")"+d,1!==devicePixelRatio&&(k='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+H+'px" height="'+H+'px"><image xlink:href='+R+' width="'+H+'" height="'+H+'"/></svg>',$+="cursor:url(data:image/svg+xml;base64,"+btoa(k)+")"+d,$+="cursor:-webkit-image-set(url("+R+")"+devicePixelRatio+"x,url("+R+")1x)"+d),L=J.createElement("style"),L.textContent="body."+c+" *, ."+c+"{"+$+"}",J.head.appendChild(L)};var qq=Hf.Guide.Grid=function(T){var I=this;I._interactor=T,I._alignmentGuideId=0,I._xAlignmentGuide=[],I._yAlignmentGuide=[]};qq.prototype={},qq.prototype.constructor=qq,I.defineProperties(qq.prototype,{gridBlockSize:{get:function(){var i=this;return i._gridBlockSize||i._interactor.getStyle("gridBlockSize")},set:function(H){this._gridBlockSize=H,this._interactor._42()}},gridThickLinesEvery:{get:function(){var X=this;return X._gridThickLinesEvery||X._interactor.getStyle("gridThickLinesEvery")},set:function(e){this._gridThickLinesEvery=e,this._interactor._42()}},gridEnabled:{get:function(){var b=this,t=b._interactor;return t.gridEnabled&&b.isValidGrid()}}}),qq.prototype._42=function(){var n=this,k=n._interactor;n.gridEnabled&&n.drawGrid(),k.alignmentGuideEnabled&&n.drawAlignmentGuide()},qq.prototype.makeMatrix=function(){var U=this,p=U._interactor.getStyle("gridAngle"),z=U._interactor.getStyle("gridRotation"),V=new Hf.Math.Matrix2d,Q=Math.sin(p),C=Math.cos(p);return V.set(1,0,C,Q,0,0),V.rotate(z),V},qq.prototype.isValidGrid=function(){var G=this,J=Math.PI,w=G._interactor,N=w.gv;if(N._zoom<w.getStyle("gridZoomThreshold"))return!1;var k=w.getStyle("gridAngle"),h=Math.abs(180*(k%J/J)),i=1-1e-8;return i>h||h>180-i?!1:!0},qq.prototype.drawAlignmentGuide=function(){var N=this,e=N._interactor,v=e.gv,j=e._canvas,C=e._context,D=j.width,k=j.height,X=v.tx(),m=v.ty(),b=v._zoom;C.beginPath(),C.strokeStyle=e.getStyle("gridAlignmentGuideColor"),C.lineWidth=1,N._xAlignmentGuide.forEach(function(P){var r=P.p*b+X;C.moveTo(r,0),C.lineTo(r,k)}),N._yAlignmentGuide.forEach(function(W){var L=W.p*b+m;C.moveTo(0,L),C.lineTo(D,L)}),C.stroke()},qq.prototype.drawGrid=function(){function u(f,w,j,B){var T=Hf.toScreenPosition($,i.apply({x:f,y:w})),c=Hf.toScreenPosition($,i.apply({x:j,y:B}));E.moveTo(T.x,T.y),E.lineTo(c.x,c.y)}var O=this,W=O._interactor,a=O.gridBlockSize,e=O.gridThickLinesEvery,D=W.getStyle("gridThickColor"),y=W.getStyle("gridLightColor"),$=W.gv,l=W._canvas,E=W._context,V=l.width,I=l.height,i=O.makeMatrix(),R=i.applyInverse(Hf.toWorldPosition($,{x:0,y:0})),P=i.applyInverse(Hf.toWorldPosition($,{x:V,y:0})),F=i.applyInverse(Hf.toWorldPosition($,{x:0,y:I})),h=i.applyInverse(Hf.toWorldPosition($,{x:V,y:I})),r=Math.min(R.x,P.x,F.x,h.x),s=Math.max(R.x,P.x,F.x,h.x),A=Math.min(R.y,P.y,F.y,h.y),x=Math.max(R.y,P.y,F.y,h.y);V=s-r,I=x-A;var C=Math.ceil(r/a),S=Math.floor(s/a),N=Math.ceil(A/a),z=Math.floor(x/a);$.tx(),$.ty(),$._zoom;var G,n,B;for(E.save(),E.lineWidth=1,E.beginPath(),E.strokeStyle=D,B=Math.ceil(C/e)*e;S>=B;B+=e)G=B*a,u(G,A,G,x);for(B=Math.ceil(N/e)*e;z>=B;B+=e)n=B*a,u(r,n,s,n);for(E.stroke(),E.beginPath(),E.strokeStyle=y,B=C;S>=B;B++)0!==B%e&&(G=B*a,u(G,A,G,x));for(B=N;z>=B;B++)0!==B%e&&(n=B*a,u(r,n,s,n));E.stroke(),E.restore()},qq.prototype.getAlignmentGuides=function(){var H=this;return{x:H._xAlignmentGuide,y:H._yAlignmentGuide}},qq.prototype.addAlignmentGuide=function(b,P,y){var A=this,Z="x"===b?A._xAlignmentGuide:A._yAlignmentGuide,y=y?y:++A._alignmentGuideId,J={p:P,id:y};if(Z.length){var E=A._findClosestAlignmentGuide(J.p,Z);E.dis<0?Z.splice(E.index+1,0,J):Z.splice(E.index,0,J)}else Z.push(J);return A._interactor._42(),y},qq.prototype.findClosest=function(q,C,_){var K=this,p=K._interactor,W=p.gv;_&&(q=Hf.toWorldPosition(W,q));var v,s,X,w=1/0,Z=1/0,z=q.x,f=q.y;if(K.gridEnabled){var u=K.gridBlockSize,m=K.makeMatrix(),y=m.applyInverse(q);y=m.apply({x:Math.round(y.x/u)*u,y:Math.round(y.y/u)*u}),w=y.x-z,Z=y.y-f,X=!0}if(p.alignmentGuideEnabled&&(v=K._findClosestAlignmentGuide(z,K._xAlignmentGuide).dis,s=K._findClosestAlignmentGuide(f,K._yAlignmentGuide).dis,Math.abs(v)<Math.abs(w)&&(w=v,X=!0),Math.abs(s)<Math.abs(Z)&&(Z=s,X=!0)),X){X=!1;var U=W._zoom,J=p.getStyle("smartGuideThreshold")/U,N={};if(Math.abs(w)<J&&"y"!==C&&(N.x=_?w*U:w,X=!0),Math.abs(Z)<J&&"x"!==C&&(N.y=_?Z*U:Z,X=!0),X)return N}},qq.prototype._findClosestAlignmentGuide=function(v,c){if(!c.length)return{dis:1/0};for(var A,J=0,B=c.length-1;B-J>1;)A=Math.floor((J+B)/2),c[A].p<v?J=A:B=A;var j=c[J].p-v,I=c[B].p-v;return Math.abs(j)<=Math.abs(I)?{line:c[J],dis:j,index:J}:{line:c[B],dis:I,index:B}},qq.prototype.removeAllAlignmentGuide=function(o){var d=this;"y"!==o&&(d._xAlignmentGuide=[]),"x"!==o&&(d._yAlignmentGuide=[]),d._interactor._42()},qq.prototype.removeAlignmentGuide=function(D){for(var E,R,l,o=this,O=o._xAlignmentGuide,P=0;2>P;P++)for(O=0===P?o._xAlignmentGuide:o._yAlignmentGuide,E=0,R=O.length;R>E;E++)if(l=O[E],l.id===D)return O.splice(E,1),o._interactor._42(),{axis:0===P?"x":"y",position:l.p};return!1},qq.prototype.adjustAlignmentGuide=function(T,H){var P=this,q=P.removeAlignmentGuide(T);return q?(P.addAlignmentGuide(q.axis,H,T),!0):!1};var ck=Hf.Guide.Rect=function(A){var B=this;B._interactor=A};ck.prototype={},ck.prototype.constructor=ck,ck.prototype.gatherRects=function(){var K,n,S,t,P=this,k=P._interactor.gv,j=[],R=[],F={x:j,y:R},g={},r=k.getDataModel(),f=r.a("width"),L=r.a("height");f&&L&&(K=0,n=0,S=f,t=L,j.push({node:r,type:0,p:K},{node:r,type:1,p:K+S/2},{node:r,type:2,p:K+S}),R.push({node:r,type:0,p:n},{node:r,type:1,p:n+t/2},{node:r,type:2,p:n+t}),g[r._id||0]={x:K,y:n,width:S,height:t}),r.each(function(d){if(uh(d)&&!k.isSelected(d)&&k.isVisible(d)&&k.isValidGuideLineSource(d)){var $=!1;if(k.sm().getSelection().each(function(X){$||(d.isHostOn(X)?$=!0:d.isDescendantOf(X)&&($=!0))}),!$){var b=d.getRect();K=b.x,n=b.y,S=b.width,t=b.height,j.push({node:d,type:0,p:K},{node:d,type:1,p:K+S/2},{node:d,type:2,p:K+S}),R.push({node:d,type:0,p:n},{node:d,type:1,p:n+t/2},{node:d,type:2,p:n+t}),g[d._id]=b}}}),j.sort(function(L,E){return L.p-E.p}),R.sort(function(a,U){return a.p-U.p}),P._grid=F,P._87I=g},ck.prototype.gatherLines=function(_,C,R){var N,q,z,v,Y,J,Z,A,c,M,V,o,p=this,d=[p.findClosest({x:_.x,y:_.y},C),p.findClosest({x:_.x+_.w/2,y:_.y+_.h/2},C),p.findClosest({x:_.x+_.w,y:_.y+_.h},C)],O={},B=p._87I;R=R||255;var y,s;for(p._guideLine=[],N=0;2>N;N++)for(O={},0===N?(v="y",A=_.x,c=A+_.w):(v="x",A=_.y,c=A+_.h),q=0;3>q;q++)Y=d[q],Y&&isFinite(Y[v])&&(y=1<<3*N+q,R&y&&(J=Y[v+"Line"],Z=J.node,s=Z._id||0,O[s]||(O[s]=!0,o=B[s],"y"===v?(M=o.x,V=o.x+o.width):(M=o.y,V=o.y+o.height),z=J.p,p._guideLine.push({type:v,a:A,b:c,c:M,d:V,p:z,center:1===J.type}))))},ck.prototype._binarySearchClosest=function(U,T){if(!T.length)return{dis:1/0};for(var n,u=0,o=T.length-1;o-u>1;)n=Math.floor((u+o)/2),T[n].p<U?u=n:o=n;var K=T[u].p-U,t=T[o].p-U;return Math.abs(K)<=Math.abs(t)?{line:T[u],dis:K}:{line:T[o],dis:t}},ck.prototype.findClosest=function(C,S,q){var k=this,G=k._interactor,z=G.gv,B=k._grid;q&&(C=Hf.toWorldPosition(z,C));var r,H=k._binarySearchClosest(C.x,B.x),x=k._binarySearchClosest(C.y,B.y),o=H.dis,c=x.dis,v=z._zoom,$=G.getStyle("smartGuideThreshold")/v,h={};return Math.abs(o)<$&&"y"!==S&&(h.x=q?o*v:o,h.xLine=H.line,r=!0),Math.abs(c)<$&&"x"!==S&&(h.y=q?c*v:c,h.yLine=x.line,r=!0),r?h:void 0},ck.prototype._42=function(){var A=this,F=A._guideLine;if(F&&!f.Default.isCtrlDown()){var H=A._interactor;if(H.getStyle("guideLineVisible")){var X,k,$,Y,n,y,Q,O,R,l,D,z,p,u,L,J,i,E=H.gv,T=H._context,I=E.tx(),e=E.ty(),h=E._zoom,g=H.getStyle("guideLineTextSpacing");for(X=0,k=F.length;k>X;X++)$=F[X],O=$.type,R=$.p,l=$.a,D=$.b,z=$.c,p=$.d,u=Math.min(l,z),L=Math.max(D,p),"x"===O?(Y=R*h+I,n=u*h+e,y=Y,Q=L*h+e):(Y=u*h+I,n=R*h+e,y=L*h+I,Q=n),Hf.Icons.DrawIcon(H,T,Hf.Icons.MoveLineGuide,{rect:[Y,n,y,Q],center:$.center}),p>=l&&D>=z||(u=l>p?p:D,L=l>p?l:z,i=L-u,"x"===O?($.center2center||(Y-=g,y=Y),n=u*h+e,Q=L*h+e,J=Hf.Icons.MoveLineGuideDistanceV):"y"===O&&($.center2center||(n-=g,Q=n),Y=u*h+I,y=L*h+I,J=Hf.Icons.MoveLineGuideDistanceH),Hf.Icons.DrawIcon(H,T,J,{x0:Y,y0:n,x1:y,y1:Q,dis:i}))}}},ck.prototype.clear=function(){this._guideLine=null};var vj=Hf.Guide.Hover=function(h){var J=this;J._interactor=h};vj.prototype={},vj.prototype.constructor=vj,I.defineProperties(vj.prototype,{}),vj.prototype._42=function(){var P=this._interactor;if(P.getStyle("hoverGuideVisible")&&!P.gvEditing){var U=P.hoverData,X=P.gv;if(!uh(U)||X.isSelected(U))return P.hoverData=null,void 0;var o=sp(X,U),N=Hf.toScreenPosition(X,{x:o.x,y:o.y}),c=Hf.toScreenPosition(X,{x:o.x+o.width,y:o.y+o.height});Hf.Icons.DrawIcon(P,P._context,Hf.Icons.HoverDataRect,{min:N,max:c,color:P.getStyle("hoverGuideColor")||P.getStyle("baseColor")})}},Hf.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var xe=Hf.Icons={},wo=1e4,er=null,ri=Hf.DefaultStyleMap.baseColor,bj="rgb(183,232,135)",Yo="rgb(255,204,153)",kc=6;f.Default.setImage("Icons.RectPoint",{width:kc,height:kc,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ri}},rect:[0,0,kc,kc]}]}),xe.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var D=xe.GroupSubEntityRect.data;if(!D)return[];var q=D.min,u=D.max;return[q.x,q.y,q.x,u.y,u.x,u.y,u.x,q.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return xe.GroupSubEntityRect.data.isKeyOb?ri:ri}}}]};var pf=4;xe.HoverDataRect={comps:[{type:"shape",points:{func:function(){var j=xe.HoverDataRect.data;if(!j)return[];var h=j.min,b=j.max,P=pf;return h.x-=P,h.y-=P,b.x+=P,b.y+=P,[h.x,h.y,h.x,b.y,b.x,b.y,b.x,h.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return xe.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},xe.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[xe.Line.data.P1.x,xe.Line.data.P1.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[xe.Line.data.P2.x,xe.Line.data.P2.y],kc,kc]}}}]},xe.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return xe.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},xe.Rect={comps:[{type:"shape",points:{func:function(){var z=xe.Rect.data;if(!z)return[];var i=z.LT,Z=z.LB,B=z.RB,k=z.RT;return[i.x,i.y,Z.x,Z.y,B.x,B.y,k.x,k.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ri}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},rect:{func:function(){return[[xe.Rect.data.LT.x,xe.Rect.data.LT.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},rect:{func:function(){return[[xe.Rect.data.LB.x,xe.Rect.data.LB.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},rect:{func:function(){return[[xe.Rect.data.RB.x,xe.Rect.data.RB.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},rect:{func:function(){return[[xe.Rect.data.RT.x,xe.Rect.data.RT.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},visible:{func:function(){return xe.Rect.data.L?!0:!1}},rect:{func:function(){return[[xe.Rect.data.L.x,xe.Rect.data.L.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},visible:{func:function(){return xe.Rect.data.R?!0:!1}},rect:{func:function(){return[[xe.Rect.data.R.x,xe.Rect.data.R.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},visible:{func:function(){return xe.Rect.data.T?!0:!1}},rect:{func:function(){return[[xe.Rect.data.T.x,xe.Rect.data.T.y],kc,kc]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return xe.Rect.data.rotation}},visible:{func:function(){return xe.Rect.data.B?!0:!1}},rect:{func:function(){return[[xe.Rect.data.B.x,xe.Rect.data.B.y],kc,kc]}}}]};var Oq=16;f.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return ri}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return ri}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),xe.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[xe.Anchor.data.POS.x,xe.Anchor.data.POS.y],Oq,Oq]}}}]},xe.TipShiftX=12,xe.TipShiftY=12;var Bf=[8,28];xe.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[xe.TipHelper.data.helperPos.x,xe.TipHelper.data.helperPos.y,Bf[0]*xe.TipHelper.data.size,Bf[1]]}},background:{func:function(){return er.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return xe.TipHelper.data.text}},rect:{func:function(){return[xe.TipHelper.data.helperPos.x,xe.TipHelper.data.helperPos.y,Bf[0]*xe.TipHelper.data.size,Bf[1]]}},color:{func:function(){return er.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Gq=7;xe.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!xe.ShapePoint.data.dynamicVisible}},rect:{func:function(){var i=xe.ShapePoint.data.point,q=xe.ShapePoint.data.size||Gq;return[i,q+10,q+10]}},background:{func:function(){var m=Date.now(),W=xe.ShapePoint.data.dynamicPeriod||1500,D=Math.sin(m%W/W*Math.PI);return"rgba(27,124,22,"+.5*D+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var D=xe.ShapePoint.data.point,F=xe.ShapePoint.data.size||Gq;return[D,F,F]}},background:{func:function(){var P=xe.ShapePoint.data.isEnd;return P?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return xe.ShapePoint.data.color||ri}}},{type:"rect",visible:{func:function(){return!!xe.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return ri}},rect:{func:function(){var P=5;return[xe.ShapePoint.data.point,P,P]}}}]},xe.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!xe.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return xe.ShapeBgCurve.data.P}},segments:{func:function(){return xe.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var o=Date.now(),v=xe.ShapeBgCurve.data.dynamicPeriod||1500,q=Math.sin(o%v/v*Math.PI);return"rgba(27,124,22,"+.3*q+")"}}},{type:"shape",points:{func:function(){return xe.ShapeBgCurve.data.P}},segments:{func:function(){return xe.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return xe.ShapeBgCurve.data.color||ri}}}]};var Ej=8;xe.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var P=xe.ShapeHighlighPoint.data;return[[P.x,P.y],Ej,Ej]}},background:{func:function(){return er.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Jh=10;xe.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var Z=xe.ShapeHighlighRealPoint.data;return[[Z.x,Z.y],Jh,Jh]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return ri}}}]};var Qe=8;xe.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var w=xe.ShapeHighlighCtrlPoint.data,S=w.x,m=w.y,I=Qe/2;return[S-I,m-I,S-I,m+I,S+I,m+I,S+I,m-I]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return er.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return er.getStyle("shapeCtrlPointBorderColor")||ri}}}]};var oh=3;xe.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return xe.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:oh,borderColor:{func:function(){return er.getStyle("curveHighlightColor")}}}]},xe.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return xe.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},xe.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return xe.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return xe.MoveLineGuide.data.center?bj:Yo}}}]};var mo=5;xe.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var k=xe.MoveLineGuideDistanceH.data,g=k.x0,d=k.y0;return[g,d-mo,g,d+mo]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yo},{type:"shape",points:{func:function(){var d=xe.MoveLineGuideDistanceH.data,Y=d.x1,o=d.y1;return[Y,o-mo,Y,o+mo]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yo},{type:"text",text:{func:function(){return Math.round(xe.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var j=xe.MoveLineGuideDistanceH.data;
return[[(j.x0+j.x1)/2,j.y0-10],20,20]}},color:Yo,font:"12px Arial",align:"center"}]},xe.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var W=xe.MoveLineGuideDistanceV.data,h=W.x0,g=W.y0;return[h-mo,g,h+mo,g]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yo},{type:"shape",points:{func:function(){var a=xe.MoveLineGuideDistanceV.data,m=a.x1,L=a.y1;return[m-mo,L,m+mo,L]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Yo},{type:"text",text:{func:function(){return Math.round(xe.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var x=xe.MoveLineGuideDistanceV.data;return[[x.x0-10,(x.y0+x.y1)/2],20,20]}},color:Yo,font:"12px Arial",align:"center"}]},f.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),xe.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var p=xe.EdgeElevationGuide.data,n=p.x,M=p.y,A=er.getStyle("curveElevationIntersectSize"),Q=er.getStyle("curveElevationGuideShift");return n+=Q[0],M+=Q[1],[n-A,M-A,2*A,2*A]}}}]},f.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),f.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),xe.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return xe.ConnectGuide.data.rotation}},rect:{func:function(){var k=xe.ConnectGuide.data.connect;k.x,k.y;var s=er.getStyle("connectGuideIntersectSize");return[[k.x,k.y],2*s,2*s]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var E=xe.ConnectGuide.data.cursorPos||xe.ConnectGuide.data.connect,f=er.getStyle("connectGuideIntersectSize");return[[E.x,E.y],2*f-2,2*f-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var w=xe.ConnectGuide.data.connect,c=xe.ConnectGuide.data.cursorPos||w;return[w.x,w.y,w.x+.5*(c.x-w.x),w.y,c.x+.5*(w.x-c.x),c.y,c.x,c.y]}}}]},f.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),f.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),xe.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var z=xe.ConnectGuideGarbage.data.hover;return z?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var g=xe.ConnectGuideGarbage.data,o=er.getStyle("connectGuideGarbageIntersectsize");return g.hover&&(o+=5),[[g.x,g.y],2*o,2*o]}}}]};var qh=6;xe.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return xe.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var h=xe.ShapeActivingCtrl.data;return[h.point.x,h.point.y,h.c1.x,h.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ri}}},{type:"shape",visible:{func:function(){return xe.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var B=xe.ShapeActivingCtrl.data;return[B.point.x,B.point.y,B.c2.x,B.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return ri}}},{type:"shape",visible:{func:function(){return xe.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var J=xe.ShapeActivingCtrl.data.c1,y=J.x,Y=J.y,F=qh/2;return"c1"===xe.ShapeActivingCtrl.data.hl&&(F+=.5),[y-F,Y-F,y-F,Y+F,y+F,Y+F,y+F,Y-F]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return er.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===xe.ShapeActivingCtrl.data.hl?er.getStyle("shapeCtrlPointHighlightBorder")||ri:er.getStyle("shapeCtrlPointBorderColor")||ri}}},{type:"shape",visible:{func:function(){return xe.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var h=xe.ShapeActivingCtrl.data.c2,v=h.x,U=h.y,F=qh/2;return"c2"===xe.ShapeActivingCtrl.data.hl&&(F+=.5),[v-F,U-F,v-F,U+F,v+F,U+F,v+F,U-F]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return er.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===xe.ShapeActivingCtrl.data.hl?er.getStyle("shapeCtrlPointHighlightBorder")||ri:er.getStyle("shapeCtrlPointBorderColor")||ri}}}]},xe.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return ri}},rect:{func:function(){return[[xe.RoundPoint.data.x,xe.RoundPoint.data.y],kc,kc]}}}]},xe.AttachPoint={comps:[{type:"rect",background:{func:function(){return xe.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return ri}},rect:{func:function(){var v=xe.AttachPoint.data.isAttach?kc+4:kc;return[[xe.AttachPoint.data.x,xe.AttachPoint.data.y],v,v]}}}]},xe.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return xe.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return xe.SimpleRect.data.color||ri}},rect:{func:function(){var x=xe.SimpleRect.data;return[x.x,x.y,x.width,x.height]}}}]},f.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),xe.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var V=xe.MoveDummy.data;return[[V.pos.x,V.pos.y],2*V.size,2*V.size]}}}]},Hf.Icons.DrawIcon=function(Y,A,M,x){M.width=M.height=wo,M.data=x,er=Y,f.Default.drawImage(A,M,0,0,wo,wo)},Hf.Icons.MapPoints=function(n,H){for(var h=0,u=n.length;u>h;h++)n[h]/=H},Hf.roundTo=function(p,v,K){var I=Math.abs(p%v);return K>I||K>v-I?v*Math.round(p/v):p},Hf.toFixed=function(i){return Math.round(100*i)/100},Hf.getDataMatrix=function(G){if(G instanceof f.Shape){var o=new f.Math.Matrix2d,u=G.getPosition();return o.translate(-u.x,-u.y).scale(G.getScale().x,G.getScale().y).rotate(G.getRotation()).translate(u.x,u.y),o}return G.getMatrix?G.getMatrix():new f.Math.Matrix2d};var kp=Hf.Math.Curve=function(){this._curves=[]};kp.prototype={},kp.prototype.constructor=kp,kp.prototype.createFromHtShape=function(X,g,O){g instanceof f.List&&(g=g.toArray());var w,o,C,P,$,p,L,n=this,M=null,S=null,A=0,r=Hf.Math.Vector2,c=Hf.Math.CubicBezier,t=function(R){return new r(X[R],X[R+1],O?O[R/2]:m)};for(o=0,C=g.length;C>o;o++){switch(P=g[o],$=null,P){case 1:S=t(A),M=S,A+=2;break;case 2:w=t(A),A+=2,$=new c(S,S.clone(),w.clone(),w),S=w;break;case 3:p=t(A),w=t(A+2),A+=4,$=new c(S,p.clone().sub(S).multiplyScalar(2/3).add(S),p.clone().sub(w).multiplyScalar(2/3).add(w),w),S=w;break;case 4:p=t(A),L=t(A+2),w=t(A+4),A+=6,$=new c(S,p,L,w),S=w;break;case 5:if(!M)break;$=new c(S,S.clone(),M.clone(),M),S=null,M=null}$&&($._index=n._curves.length,n._curves.push($))}},kp.prototype.checkPoint=function(Q,c){var K,L,D,o,a,F=this,N=F._curves;for(K=0,L=N.length;L>K;K++)if(o=N[K],a=o.intersectRect(Q,c,c),a.length)return D=0,a.forEach(function(V){D+=V.t}),D/=a.length,Q=o.getPointAt(D),Q.t=D,{bezier:o,intersection:Q}},kp.prototype.insertKnot=function(i,c){var O=i.insertKnot(c),H=this,Q=H._curves;Q.splice(i._index,1,O[0],O[1])},kp.prototype._isCloseEnough=function(f,x){return Math.abs(f.x-x.x)<1e-6&&Math.abs(f.y-x.y)<1e-6},kp.prototype._isSamePoint=function(H,k){return H===k},kp.prototype.moveRealPoint=function(R,F){var k=this,T=k._curves,w=F.clone().sub(R);T.forEach(function(P){var x=P._p1;P._p2,P._p3;var r=P._p4;k._isSamePoint(x,R)&&(P._p2.add(w),P._p1=F),k._isSamePoint(r,R)&&(P._p3.add(w),P._p4=F)})},kp.prototype.moveCtrlDueToRealPointMovement=function(N,K){var S=this,C=S._curves,w=function(M){M.add(K),M.e&&K.e&&(M.e+=K.e)};C.forEach(function(M){var l=M._p1;M._p2,M._p3;var H=M._p4;S._isSamePoint(l,N)&&w(M._p2),S._isSamePoint(H,N)&&w(M._p3)})},kp.prototype.moveCtrlPoint=function(B,k,M){var w=B[M];if(w){w.e!==m&&(k.e=w.e);var Z=this,R=Z._curves;k.clone().sub(w),R.forEach(function(E){var z;"c2"===M?z="_p2":"c1"===M&&(z="_p3"),Z._isSamePoint(E[z],w)&&(E[z]=k)}),B[M]=k}},kp.prototype.deleteRealPoint=function(X,r){var Q,S,z,H,A,B,k,I=this,V=I._curves,m={},R=[],t=Hf.Math.CubicBezier;for(S=0,z=V.length;z>S;S++)Q=V[S],H=Q._p1,A=Q._p2,B=Q._p3,k=Q._p4,(m[S]||!I._isSamePoint(H,X))&&(I._isSamePoint(k,X)?z>S+1&&I._isSamePoint(V[S+1]._p1,X)&&(r||R.push(new t(H,A,V[S+1]._p3,V[S+1]._p4))):R.push(Q));I._curves=R},kp.prototype.findPairs=function(W,B){var p,L,G,A,$,K,s,x,V=this,y=V._curves,X={},_=[];for(L=0,G=y.length;G>L;L++)p=y[L],A=p._p1,$=p._p2,K=p._p3,s=p._p4,!X[L]&&V._isSamePoint(A,W)&&(B?_.push({point:A,r2:s}):_.push({point:A,c2:$})),V._isSamePoint(s,W)&&(x=B?{point:s,r1:A}:{point:s,c1:K},G>L+1&&V._isSamePoint(y[L+1]._p1,W)&&(B?x.r2=y[L+1]._p4:x.c2=y[L+1]._p2,X[L+1]=!0),_.push(x));return _},kp.prototype.toHtShape=function(){var S=this,e=S._curves,F=[],L=[],J={x:1/0,y:1/0};return e.forEach(function(C){var h=C._p1,E=C._p2,G=C._p3,B=C._p4;return S._isCloseEnough(h,J)||(F.push(1),L.push(h.clone())),J=B,S._isCloseEnough(h,E)&&S._isCloseEnough(G,B)?(F.push(2),L.push(B.clone()),void 0):(F.push(4),L.push(E.clone(),G.clone(),B.clone()),void 0)}),{segments:F,points:L}};var op=Hf.Math.CubicBezier=function(t,p,L,j){var A=this;A._id=Hf.Math.CubicBezier._globalId++,A._p1=t,A._p2=p,A._p3=L,A._p4=j};op._globalId=1,op.prototype={},op.prototype.constructor=op,op.prototype.toString=function(){return this._id},op.prototype.intersectRect=function(p,z,$){var e=z/2,s=$/2,A=p.x,c=p.y,B=Hf.Math.Vector2,M=new B(-e+A,-s+c),Y=new B(e+A,s+c),K=new B(Y.x,M.y),H=new B(M.x,Y.y),C=this,q=C.intersectLine(M,K),o=C.intersectLine(K,Y),f=C.intersectLine(Y,H),L=C.intersectLine(H,M),w=q.concat(o).concat(f).concat(L);return w},op.prototype.intersectLine=function(l,c){var S,b,X,Z,M,d,v,f,q,o,Q,W,u,H=this,z=l.clone().min(c),O=l.clone().max(c);Z=H._p1,M=H._p2,d=H._p3,v=H._p4,S=Z.clone().multiplyScalar(-1),b=M.clone().multiplyScalar(3),X=d.clone().multiplyScalar(-3),Q=S.add(b).add(X).add(v),S=Z.clone().multiplyScalar(3),b=M.clone().multiplyScalar(-6),X=d.clone().multiplyScalar(3),o=S.add(b).add(X),S=Z.clone().multiplyScalar(-3),b=M.clone().multiplyScalar(3),q=S.add(b),f=Z.clone(),u=new Hf.Math.Vector2(l.y-c.y,c.x-l.x),W=l.x*c.y-c.x*l.y;for(var I=H.getRoots(u.dot(Q),u.dot(o),u.dot(q),u.dot(f)+W),x=new Array,s=0,A=I.length;A>s;s++){var J=I[s];if(!(0>J||J>1)){var a=Z.clone().lerp(M,J),Y=M.clone().lerp(d,J),E=d.clone().lerp(v,J),i=a.lerp(Y,J),w=Y.lerp(E,J),j=i.lerp(w,J);j.t=J,l.x==c.x?z.y<=j.y&&j.y<=O.y&&x.push(j):l.y==c.y?z.x<=j.x&&j.x<=O.x&&x.push(j):j.x>=z.x&&j.y>=z.y&&j.x<=O.x&&j.y<=O.y&&x.push(j)}}return x},op.prototype.solveTForPoint=function(d){var G,E,V,y,R=this;G=R._p1.x-d.x,E=R._p2.x-d.x,V=R._p3.x-d.x,y=R._p4.x-d.x;for(var J=R.getRoots(y-3*V+3*E-G,3*V-6*E+3*G,3*E-3*G,G),K=m,_=1/0,t=0,M=J.length;M>t;t++){var B=J[t];if(!(0>B||B>1)){var Q=R._p1.clone().lerp(R._p2,B),i=R._p2.clone().lerp(R._p3,B),I=R._p3.clone().lerp(R._p4,B),q=Q.lerp(i,B),C=i.lerp(I,B),f=q.lerp(C,B);f.t=B;var e=Math.abs(f.y-d.y);_>e&&(_=e,K=f)}}return K},op.prototype.getPointAt=function(u){var U=this,V=U._p1,W=U._p2,N=U._p3,X=U._p4,M=V.clone().lerp(W,u),l=W.clone().lerp(N,u),c=N.clone().lerp(X,u),n=M.lerp(l,u),o=l.lerp(c,u);return n.lerp(o,u)},op.prototype.getRoots=function(u,b,f,s){var z,w,i,J,F,D=new Array;if(Math.abs(u)<1e-6){var z=b,w=f/z,i=s/z,J=w*w-4*i;if(J>0){var F=Math.sqrt(J);D.push(.5*(-w+F)),D.push(.5*(-w-F))}else 0==J&&D.push(.5*-w)}b/=u,f/=u,s/=u,z=(3*f-b*b)/3,w=(2*b*b*b-9*f*b+27*s)/27;var S=b/3,V=w*w/4+z*z*z/27,C=w/2;if(Math.abs(V)<=1e-6&&(V=0),V>0){var n,d,F=Math.sqrt(V);n=-C+F,d=n>=0?Math.pow(n,1/3):-Math.pow(-n,1/3),n=-C-F,n>=0?d+=Math.pow(n,1/3):d-=Math.pow(-n,1/3),D.push(d-S)}else if(0>V){var k=Math.sqrt(-z/3),v=Math.atan2(Math.sqrt(-V),-C)/3,j=Math.cos(v),Y=Math.sin(v),W=Math.sqrt(3);D.push(2*k*j-S),D.push(-k*(j+W*Y)-S),D.push(-k*(j-W*Y)-S)}else{var n;n=C>=0?-Math.pow(C,1/3):Math.pow(-C,1/3),D.push(2*n-S),D.push(-n-S)}return D},op.prototype._70I=function(){var L=this;return L._p1.distanceToSquared(L._p2)<1e-10&&L._p3.distanceToSquared(L._p4)<1e-10},op.prototype.insertKnot=function(z){var X=this,H=X._p1,x=X._p2,P=X._p3,b=X._p4,Y=H.clone().lerp(x,z),p=x.clone().lerp(P,z),f=P.clone().lerp(b,z),j=Y.clone().lerp(p,z),$=p.clone().lerp(f,z),t=j.clone().lerp($,z);return X._70I()?(H.clone().lerp(b,z),[new Hf.Math.CubicBezier(H,H.clone(),t.clone(),t),new Hf.Math.CubicBezier(t,t.clone(),b.clone(),b)]):[new Hf.Math.CubicBezier(H,Y,j,t),new Hf.Math.CubicBezier(t,$,f,b)]};var Kk=f.Default.getInternal().ui().EdgeUI,kh={_47O:function(x){var K=this,y=kh.getBackups()._47O;Hf.inEdit(K.gv)||y.call(K,x)}};Hf.Inject.registAsModule(kh,Kk);var mf=f.Default.getInternal().ui().NodeUI,ak={_47O:function(t){var Z=this,o=ak.getBackups()._47O;Hf.inEdit(Z.gv)||o.call(Z,t)},getSelectWidth:function(){var Y=this,e=Y.gv,C=Y._data;if(e.isEditable(C)&&Hf.inEdit(e))return 0;var _=ak.getBackup("getSelectWidth");return _.call(Y)}};Hf.Inject.registAsModule(ak,mf);var bh=f.graph.GraphView,Ci={_editPointSize:function(){var S=f.Default.isTouchable,p=Hf.getStyle("pointSize");return p[S?0:1]}(),isPointEditable:function(A){var H=this;if(Hf.inEdit(H))return H._pointEditableFunc?H._pointEditableFunc(A):!0;var p=Ci.getBackup("isPointEditable");p.call(H,A)},isEditable:function(Y){var A,V=this,D=Ci.getBackup("isEditable");if(A=Y instanceof Hf.Group?!0:D.call(V,Y),!Hf.inEdit(V))return A;if(!(Y instanceof f.Edge))return A;if(!Y.s("2d.editable"))return!1;var $=V.getEditableFunc();return $?$(Y):!0},_42:function(q,Z){var s=this,m=Ci.getBackups()._42;if(m.call(s,q,Z),Hf.inEdit(s)){var L=s.getEditInteractor();L.drawImpl()}}};Hf.Inject.registAsModule(Ci,bh);var ic=f.Default.getInternal().ui().ShapeUI,uc={_47O:function(N){var z=this,c=uc.getBackups()._47O;Hf.inEdit(z.gv)||c.call(z,N)}};Hf.Inject.registAsModule(uc,ic);var Od=f.graph.DefaultInteractor,Ib={handle_mousewheel:function(y){var z=this,Y=Ib.getBackup("handle_mousewheel");Hf.inEdit(z.gv)||Y.call(z,y)}};Hf.Inject.registAsModule(Ib,Od);var Nk=f.graph.MoveInteractor,yr={_calcShift:function(O,f){var X=this,_=yr.getBackup("_calcShift"),A=X.gv;if(!Hf.inEdit(A))return _.call(X,O,f);var g=A.getEditInteractor(),Y=g.getSubModule("Move").calcShift(O,f,X);return Y||_.call(X,O,f)},clear:function(E){var G=this,W=yr.getBackup("clear");W.call(G,E);var x=G.gv;if(Hf.inEdit(x)){var m=x.getEditInteractor();m.getSubModule("Move").clear(E)}}};Hf.Inject.registAsModule(yr,Nk);var ck=Hf.Rect=function(s){this.catalog="Rect",this._interactor=s};ck.prototype={},ck.prototype.constructor=ck,ck.prototype.gatherInfo=function(I,K){var G=this;if(1===K.length){var T=K[0];return T instanceof f.Shape&&T._70I()?G.gatherLine(I,T):mm(T,I)?!1:G.gatherSingleTarget(I,T)}return K.length>1?G.gatherMultiTargets(I,K):!1},ck.prototype.gatherSingleTarget=function(x,f){if(f.getCorners){var m,h=this,Q=h.info;h.target=f,m=h.screenInfo={};var K=f.getCorners();Q.LT=new Hf.Math.Vector2(K[0]),Q.LB=new Hf.Math.Vector2(K[1]),Q.RB=new Hf.Math.Vector2(K[2]),Q.RT=new Hf.Math.Vector2(K[3]),Q.T=Q.LT.clone().add(Q.RT).divideScalar(2),Q.B=Q.LB.clone().add(Q.RB).divideScalar(2),Q.L=Q.LT.clone().add(Q.LB).divideScalar(2),Q.R=Q.RT.clone().add(Q.RB).divideScalar(2);for(var P in Q)m[P]=Hf.toScreenPosition(x,Q[P]);var L=h._interactor,t=L.getStyle("checkSize"),r=function(y,f,o){var Z=f.clone().sub(y).setLength(-t),B=o.clone().sub(y).setLength(-t),r=Z.add(B).add(y);return r};return m.rotLT=r(m.LT,m.RT,m.LB),m.rotLB=r(m.LB,m.LT,m.RB),m.rotRB=r(m.RB,m.LB,m.RT),m.rotRT=r(m.RT,m.LT,m.RB),m.rotT=m.rotLT.clone().add(m.rotRT).divideScalar(2),m.rotB=m.rotLB.clone().add(m.rotRB).divideScalar(2),m.rotL=m.rotLT.clone().add(m.rotLB).divideScalar(2),m.rotR=m.rotRT.clone().add(m.rotRB).divideScalar(2),m.rotation=f.getRotation(),h.gatherConnectInfo(),!0}},ck.prototype.gatherConnectInfo=function(){var f=this,c=f.target,r=f._interactor,v=f.screenInfo,o=r.gv;if(o.isConnectActionVisible(c)&&r.getStyle("connectGuideVisible")){var w;c.s&&(w=c.s("connectGuideShift")),w||(w=r.getStyle("connectGuideShift"));var z=c.getAnchor(),i=c.getSize(),X=c.toGlobal({x:i.width*(w[0]-z.x),y:i.height*(w[1]-z.y)});X=Hf.toScreenPosition(o,X),v.P1?X.add(v.P2.clone().sub(v.P1).setLength(w[2])):(X.add(v.RT.clone().sub(v.LT).setLength(w[2])),X.add(v.LB.clone().sub(v.LT).setLength(w[3]))),v.connect=X}},ck.prototype.gatherMultiTargets=function(e,D){var T=Hf.Group.findOrCreateGroup(D);if(!T)return!1;var n=this;return n.editing&&"rotate"!==n.editing.mode||T.calcInfo(),n.gatherSingleTarget(e,T)},ck.prototype.gatherLine=function(f,z){this.target=z;var X=this.screenInfo={},C=z.getPoints(),P=Hf.getDataMatrix(z);return X.P1=Hf.toScreenPosition(f,P.apply(C.get(0))),X.P2=Hf.toScreenPosition(f,P.apply(C.get(1))),this.gatherConnectInfo(),!0},ck.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ck.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ck.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ck.prototype.check=function(r,g,X){if(f.Default.isLeftButton(g)){var z=this;if(z.editing=null,z.tipInfo=null,z.screenInfo){var S=z.target,l=r.isEditable(S),B=z.screenInfo;if(l&&B.connect){var D=z._checkConnect(X);if(D)return D}if(B.P1)return z._checkLine(X);var y,R,q,e=null,k=z._interactor,$=k.getStyle("checkSize");if(l&&r.isRectEditable(S))for(R=0;R<Hf.Rect.ResizeKeys.length;R++)if(q=Hf.Rect.ResizeKeys[R],Hf.checkHit(X,B[q],$)){e=q,y="resize";break}if(!e&&l&&r.isRotationEditable(S)&&!k.getStyle("rotateAsClock")){var i=k.getStyle("rotateCheckSize");for(R=0;R<Hf.Rect.RotateKeys.length;R++)if(q=Hf.Rect.RotateKeys[R],Hf.checkHit(X,B[q],i)){e=q,y="rotate";break}}if(!e)return k.setCursor("default"),void 0;if("rotate"===y){var J,b=r.lp(g);if(S instanceof Hf.Group){var o=k.getStyle("groupRotateModeKey");"string"==typeof o&&(o=[o]);for(var K=!1,G=0,x=o.length;x>G;G++)if(g[o[G]]){K=!0;break}var U=k.getStyle("groupRotateModeDefault");J=K?"batch"===U?"block":"batch":U}var s="batch"===J?S.getAnchor2():S.getPosition(),d=Math.atan2(b.y-s.y,b.x-s.x);k._setRotateCursor(d),z.editing={mode:y,key:e,pos:s,flipY:S.getScale().y<0,rotation:S.getRotation(),hitRot:d},J&&(z.editing.groupRotateMode=J)}else{var N=Hf.Rect.ResizeKeys.indexOf(e),t=Hf.Rect.ResizeDirection[N],w=Math.cos(S.getRotation()),E=Math.sin(S.getRotation()),M=t.x*Math.sign(S.getScale().x),P=t.y*Math.sign(S.getScale().y),n=Math.atan2(-E*M-w*P,w*M-E*P),u=(Math.round(n/(Math.PI/4))+8)%8,Q=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][u];this._interactor.setCursor(Q);var p=S.getWidth(),H=S.getHeight(),W=S.getAnchor();z.editing={mode:y,key:e,rect:{x:-p*W.x,y:-H*W.y,width:p,height:H},anchor:W,matrix:S.getMatrix()}}return e}}},ck.prototype._checkLine=function(m){var s=this;s.screenInfo;var z,K=s._interactor.getStyle("checkSize");if(Hf.checkHit(m,s.screenInfo.P1,K))z="P1";else{if(!Hf.checkHit(m,s.screenInfo.P2,K))return this._interactor.setCursor("default"),void 0;z="P2"}return s.editing={mode:"line",key:z},z},ck.prototype._checkConnect=function(y){var n=this,m=n.screenInfo,g=n._interactor,Z=g.getStyle("connectGuideIntersectSize"),z=m.connect,Q=y.x,k=z.x;if(k>Q&&Z>k-Q&&Math.abs(z.y-y.y)<Z||Q>=k&&Hf.checkHit(y,z,Z)){var N="connect",D=O.getConnectAction(g.gv);if(n.editing={mode:N},D&&D.delete)if(n.target instanceof Hf.Group){var c=!0;g.gv.sm().getSelection().each(function(m){D.delete.visible.call(null,g.gv,m)||(c=!1)}),n.editing.hasDeleteAction=c}else D.delete.visible.call(null,g.gv,n.target)&&(n.editing.hasDeleteAction=!0);return g.setCursor("default"),N}},ck.prototype._fireEditEvent=function(l,Z){var K=this._interactor,M=this.editing;if(M){var P=M.mode;P="rotate"===P?"Rotation":"connect"===P?"Connection":P[0].toUpperCase()+P.slice(1),K.fi({kind:l+"Edit"+P,event:Z})}},ck.prototype.startEdit=function(U,z){U.startDragging(z);var A=this;A._interactor.fi({kind:"prepareEdit",event:z});var Y=A.editing,M=A.target;if(Y){if(A._fireEditEvent("begin",z),"rotate"===Y.mode)return Y.groupRotateMode&&M.beginRotate(Y),void 0;if("connect"!==Y.mode)("line"===Y.mode||M&&0===M.getRotation())&&(A._inSmartGuide=!0,A._interactor.rectGuide.gatherRects());else if(Y.hasDeleteAction){var G=U.gv,g=A._interactor.getStyle("connectGuideGarbageShift");Y.garbageInfo={x:G.getWidth()*g[0]+g[2],y:G.getHeight()*g[1]+g[3],size:A._interactor.getStyle("connectGuideGarbageIntersectsize")},U._42()}}},ck.prototype._46O=function(p){var w,R,s=this,H=s.editing,Y=s.target;if(H){if("connect"===H.mode&&!H.canceled&&!H.deleted)try{H.garbageInfo&&H.garbageInfo.hover?O.doDeleteConnectionAction(s._interactor.gv,Y):O.doConnectAction(s._interactor.gv,Y,H.target)}catch(L){console.error(L)}R=H.freezeFlag,w=s.editing.groupRotateMode,s._fireEditEvent("end",p),s.editing=null}s.tipInfo=null,s._inSmartGuide&&(s._interactor.rectGuide.clear(),s._inSmartGuide=!1),w&&Y&&Y.endRotate(),Y instanceof f.Block&&(R===m?delete Y._freezeSyncFromChildren:Y._freezeSyncFromChildren=R,Y.updateFromChildren())},ck.prototype.handleNormalStateDelete=function(){var Q=this,S=Q.editing;if(S&&"connect"===S.mode&&!S.canceled&&!S.deleted){if(S.garbageInfo){try{O.doDeleteConnectionAction(Q._interactor.gv,Q.target)}catch(J){console.error(J)}S.garbageInfo=null}return S.cursorPos=null,S.targetCorners=null,S.deleted=!0,Q._interactor._42(),!0}},ck.prototype.handleNormalStateKeyDown=function(R){var c=this,O=c.editing;return!O||"connect"!==O.mode||O.canceled||O.deleted?void 0:f.Default.isEsc(R)?(O.cursorPos=null,O.targetCorners=null,O.canceled=!0,c._interactor._42(),!0):void 0},ck.prototype.handleEdit=function(V,v){var b=this,j=b.editing;if(j){var E,T,U,q,B,h=b.target,D=j.key,d=j.mode,P=V.lp(v),Q=b._interactor;if("connect"===d){if(j.canceled)return;if(j.deleted)return;j.cursorPos=Q._getLogicalPoint(v);var G=j.garbageInfo;return G&&Hf.checkHit(j.cursorPos,G,G.size)?(G.hover=!0,j.target=null,j.targetCorners=null):(G&&(G.hover=!1),j.target=V.getDataAt(P,function(M){return V.isSelectable(M)?uh(M)?!0:!1:!1})||null,j.targetCorners=Hf.getTargetCornersOnScreen(V,j.target)),Q._42(),void 0}if("rotate"===d){var J,l,e=j.pos,Z=Math.atan2(P.y-e.y,P.x-e.x);if(j.groupRotateMode?l=Z-j.hitRot:(J=Z-j.hitRot,l=j.rotation+J),l%=2*Math.PI,0>l&&(l+=2*Math.PI),!f.Default.isCtrlDown(v)){var H,F;ah(v)?(H=Q.getStyle("shiftRotateRound"),F=H/2):(H=Q.getStyle("rotateRound"),F=Q.getStyle("rotateSensitivity")),l=Hf.roundTo(l,H,F)}j.groupRotateMode?(J=l-(j.lastRotation||0),0!==J&&(h.addRotation(J,j.groupRotateMode),j.lastRotation=l)):h.setRotation(l),Q._setRotateCursor(Z),l>Math.PI&&(l-=2*Math.PI);var w=180*(l/Math.PI);w=w.toFixed(2),E=""+w+""}else if("resize"===d){var I=j.rect;U=I.x,q=I.y;var K,o=I.width,u=I.height,p=j.anchor,C=j.matrix,k=h.s&&h.s("keepAspectRatio")||Q.getStyle("keepAspectRatio");ah(v)&&(k=!k);var N=b._unionPointMode1,S=b._unionPointMode2;if(b._inSmartGuide&&!f.Default.isCtrlDown(v)&&!k){var $;"L"===D||"R"===D?$="x":("T"===D||"B"===D)&&($="y"),b._adsorbedToClosest(P,$),B=!0}K=C.tfi(P);var _;"LT"===D?(I=N(K,{x:U+o,y:q+u},o,u,k),_=9):"T"===D?(I=S({x:U,y:K.y},{x:U+o,y:q+u},o,u,k,"v"),_=1):"RT"===D?(I=N(K,{x:U,y:q+u},o,u,k),_=33):"L"===D?(I=S({x:K.x,y:q},{x:U+o,y:q+u},o,u,k,"h"),_=8):"R"===D?(I=S({x:U,y:q},{x:K.x,y:q+u},o,u,k,"h"),_=32):"LB"===D?(I=N(K,{x:U+o,y:q},o,u,k),_=12):"B"===D?(I=S({x:U,y:q},{x:U+o,y:K.y},o,u,k,"v"),_=4):"RB"===D&&(I=N(K,{x:U,y:q},o,u,k),_=36);var r=C.tf(I.x+I.width*p.x,I.y+I.height*p.y);h instanceof f.Block&&(j.hasOwnProperty("freezeFlag")||(j.freezeFlag=h._freezeSyncFromChildren,h._freezeSyncFromChildren=!0)),h.setPosition(r),h.setSize(I.width,I.height),B&&(T=h.getRect(),Q.rectGuide.gatherLines({node:h,x:T.x,y:T.y,w:T.width,h:T.height},$,_)),E=""+Math.round(I.width)+" * "+Math.round(I.height)}else if("line"===d){if(ah(v)){var g=h.getPoints(),R="P1"===D?g.get(1):g.get(0),x={x:P.x-R.x,y:P.y-R.y},c=Q.getStyle("shiftLineRotateRound"),z=b._shiftDirList;if(!z||b._shiftRotateRound!==c){b._shiftRotateRound=c,b._shiftDirList=z=[];for(var s=0;s<Math.PI;s+=c)z.push({x:n(s),y:W(s)})}for(var M,O=0,i=0,y=z.length;y>i;i++){var X=z[i],a=X.x*x.x+X.y*x.y;Math.abs(a)>Math.abs(O)&&(O=a,M=X)}P={x:R.x+M.x*O,y:R.y+M.y*O},Q.rectGuide.clear()}else b._inSmartGuide&&!f.Default.isCtrlDown(v)&&(b._adsorbedToClosest(P),B=!0);var m=Hf.getDataMatrix(h).applyInverse(P);h.setPoint("P1"===D?0:1,m,!0);var A=h.getPoints(),L=A.get(0),t=A.get(1);U=L.x-t.x,q=L.y-t.y,E=" "+Math.round(Math.sqrt(U*U+q*q))+" ",B&&(T=h.getRect(),Q.rectGuide.gatherLines({node:h,x:T.x,y:T.y,w:T.width,h:T.height}))}if(E){var Y=f.Default.getLogicalPoint(v,Q._canvas);Y.x+=Hf.Icons.TipShiftX,Y.y+=Hf.Icons.TipShiftY,b.tipInfo={helperPos:Y,text:E,size:E.length}}b._fireEditEvent("between",v)}},ck.prototype._unionPointMode1=function(O,A,Z,R,L){if(L&&Z&&R){var h=O.x-A.x,t=O.y-A.y;Math.abs(h*R)<Math.abs(t*Z)?(t=Math.sign(t)*Math.abs(h*R/Z),O.y=A.y+t):(h=Math.sign(h)*Math.abs(t*Z/R),O.x=A.x+h)}return f.Default.unionPoint(O,A)},ck.prototype._unionPointMode2=function(U,D,b,O,p,q){var Q=f.Default.unionPoint(U,D);if(p&&b&&O){var V;"v"===q?(V=Q.x+Q.width/2,Q.width=b*Q.height/O,Q.x=V-Q.width/2):(V=Q.y+Q.height/2,Q.height=O*Q.width/b,Q.y=V-Q.height/2)}return Q},ck.prototype._adsorbedToClosest=function(H,L){var W=this,G=W._interactor,z=G.rectGuide.findClosest(H,L),J=G.gridGuide.findClosest(H,L),j=1/0,o=1/0;z&&(isFinite(z.x)&&(j=z.x),isFinite(z.y)&&(o=z.y)),J&&(isFinite(J.x)&&Math.abs(J.x)<Math.abs(j)&&(j=J.x),isFinite(J.y)&&Math.abs(J.y)<Math.abs(o)&&(o=J.y)),isFinite(j)&&(H.x+=j),isFinite(o)&&(H.y+=o)},ck.prototype._42=function(s,P,m){var Z=this;Z.info={},Z.screenInfo=null;var H=Z._interactor;if(!H.editDetail&&Z.gatherInfo(P,m)){var N=Z.editing,u=N?N.groupRotateMode:null,T=Z.screenInfo;if("block"!==u){if(T.P1?Hf.Icons.DrawIcon(H,s,Hf.Icons.Line,T):Hf.Icons.DrawIcon(H,s,Hf.Icons.Rect,T),T.connect&&(Hf.Icons.DrawIcon(H,s,Hf.Icons.ConnectGuide,{rotation:T.rotation,connect:T.connect,cursorPos:N?N.cursorPos:null}),N)){if(N.targetCorners){for(var p={x:1/0,y:1/0},L={x:-1/0,y:-1/0},l=0,b=N.targetCorners.length;b>l;l+=2)p.x=Math.min(p.x,N.targetCorners[l]),L.x=Math.max(L.x,N.targetCorners[l]),p.y=Math.min(p.y,N.targetCorners[l+1]),L.y=Math.max(L.y,N.targetCorners[l+1]);Hf.Icons.DrawIcon(H,s,Hf.Icons.HoverDataRect,{min:p,max:L,color:H.getStyle("hoverGuideColor")||H.getStyle("baseColor")})}N.garbageInfo&&Hf.Icons.DrawIcon(H,s,Hf.Icons.ConnectGuideGarbage,N.garbageInfo)}Z.tipInfo&&Hf.Icons.DrawIcon(H,s,Hf.Icons.TipHelper,Z.tipInfo)}Z.target instanceof Hf.Group&&Z.target._42(H,s,P)}};var ph=Hf.Anchor=function(f){this.catalog="Anchor",this._interactor=f};ph.prototype={},ph.prototype.constructor=ph,ph.prototype.gatherInfo=function(N,C){var q=this;if(1===C.length){var J=C[0];if(!J.getAnchor)return;if(J instanceof f.Shape&&J._70I())return;if(mm(J,N))return;return q.gatherSingleTarget(N,C[0])}return C.length>1?q.gatherMultiTargets(N,C):!1},ph.prototype.gatherSingleTarget=function(f,O){var o=this;return o.info.POS=O.getPosition(),o.screenInfo.POS=Hf.toScreenPosition(f,o.info.POS),o.target=O,!0},ph.prototype.gatherMultiTargets=function(D,i){var W=this,R=Hf.Group.findOrCreateGroup(i);return R?(W.screenInfo.POS=Hf.toScreenPosition(D,R.getAnchor2()),W.target=R,!0):!1
},ph.prototype.isVisible=function(){var W=this,U=W._interactor;if(U.getStyle("anchorVisible")===!1)return!1;var g=W.target;if(g){if(this.editing)return!0;var z=g.getAnchor(),n=U.getStyle("anchorOutsideVisibleThreshold");if(z.x<-n||z.x>1+n||z.y<-n||z.y>1+n)return!0;var a=g.getSize(),X=g.getScale(),G=Math.min(Math.abs(a.width*X.x),Math.abs(a.height*X.y));if(G*U.gv._zoom<U.getStyle("anchorHideThreshold"))return!1}return!0},ph.prototype.check=function(r,p,A){if(f.Default.isLeftButton(p)){var O=this,W=O._interactor;if(O.isVisible()&&W.getStyle("anchorMovable")!==!1){O.editing=null,O.tipInfo=null;var $=O.target;if($&&r.isAnchorEditable($)&&r.isEditable($)){var S;if(O.screenInfo&&(S=O.screenInfo.POS)&&Hf.checkHit(A,new Hf.Math.Vector2(S),W.getStyle("checkSize"))){if($ instanceof Hf.Group)return O.editing={},!0;var g=$.getWidth(),U=$.getHeight(),G=$.getAnchor();return O.editing={rect:{x:-g*G.x,y:-U*G.y,width:g,height:U},anchor:G,matrix:$.getMatrix()},!0}}}}},ph.prototype.startEdit=function(m,C){m.startDragging(C),m.fi({kind:"beginEditAnchor",event:C})},ph.prototype._46O=function(O){var H=this;H.editing&&(H.editing=null,H._interactor.fi({kind:"endEditAnchor",event:O})),H.tipInfo=null},ph.prototype.handleEdit=function(Q,s){var j=this,I=j.target;if(I){var q=j.editing;if(q){var a=Q.lp(s),y=j._interactor;if(I instanceof Hf.Group)return I.setAnchor2(a),y._42(),void 0;var F=q.matrix,X=F.tfi(a),Z=q.rect,P=(X.x-Z.x)/Z.width,R=(X.y-Z.y)/Z.height;if(!f.Default.isCtrlDown(s)){var k=y.getStyle("anchorRound"),L=y.getStyle("anchorSensitivity");P=Hf.roundTo(P,k,L),R=Hf.roundTo(R,k,L)}I.setAnchor(P,R,!0);var H=f.Default.getLogicalPoint(s,y._canvas);H.x+=Hf.Icons.TipShiftX,H.y+=Hf.Icons.TipShiftY;var e=""+P.toFixed(2)+", "+R.toFixed(2);j.tipInfo={helperPos:H,text:e,size:e.length},y.fi({kind:"betweenEditAnchor",event:s})}}},ph.prototype._42=function(f,A,t){var K=this;K.info={},K.screenInfo={};var u=K._interactor;u.editDetail||K.gatherInfo(A,t)&&K.isVisible()&&(Hf.Icons.DrawIcon(u,f,Hf.Icons.Anchor,K.screenInfo),K.tipInfo&&Hf.Icons.DrawIcon(u,f,Hf.Icons.TipHelper,K.tipInfo))};var Ne=Hf.MoveDummy=function(r){this.catalog="MoveDummy",this._interactor=r};Ne.prototype={},Ne.prototype.constructor=Ne,Ne.prototype.gatherInfo=function(){var r=this,c=this._interactor.getSubModule("Rect");if(c){var W=c.screenInfo;if(W){var e=r._interactor,y=r.getMovableTarget(c.target);if(y){var k=e.getStyle("moveDummyThreshold");if(k!==!1){var C=W.LT||W.P1,b=W.RT||W.P2,M=W.LB||C;if(C){var K=W.P1,v=Math.min(C.distanceTo(M),C.distanceTo(b));if(!(k!==!0&&v>k)){var Y=e.getStyle("moveDummyPosition"),O=b.clone().sub(C),E=M.clone().sub(C),D=Y[2],h=Y[3];if(K){var p=e.getStyle("moveDummyLineExtraShift");p&&(D+=p[0],h+=p[1])}var P=C.clone().add(O.clone().multiplyScalar(Y[0])).add(O.setLength(D)).add(E.clone().multiplyScalar(Y[1])).add(E.setLength(h));return r.screenInfo.pos=P,r.screenInfo.size=e.getStyle("moveDummySensitivity"),!0}}}}}}},Ne.prototype.getMovableTarget=function(L){var n=this._interactor.gv;if(uh(L)){if(n.isMovable(L))return L}else if(L instanceof Hf.Group)for(var I=L._entities,A=I.length-1;A>=0;A--){var J=I[A];if(uh(J)&&n.isMovable(J))return J}return null},Ne.prototype.getMoveInteractor=function(){for(var z,o,V,g=this._interactor.gv,S=g.getInteractors(),z=0,o=S.length;o>z;z++)if(V=S.get(z),V instanceof Nk)return V},Ne.prototype.startEdit=function(e,Q){e.startDragging(Q);var p=this.getMoveInteractor();if(p){var y=this.selectedTarget,W=e.gv;W._moving=1,p._data=y,W.handleMouseDown&&W.handleMouseDown(Q,y)}},Ne.prototype._46O=function(G){var U=this,E=U.getMoveInteractor();E&&(E.handleWindowMouseUp(G),U.selectedTarget=null)},Ne.prototype.handleEdit=function(Y,p){var i=this.getMoveInteractor();i&&i.handleWindowMouseMove(p)},Ne.prototype.check=function(_,b,Z){if(this.selectedTarget=null,f.Default.isLeftButton(b)&&!_._scrolling&&!Yk()){var o=this;if(o.screenInfo){var m=o.screenInfo.pos;if(m&&!(Z.distanceTo(m)>o.screenInfo.size)){var V=o._interactor;return o.selectedTarget=o.getMovableTarget(V.getSubModule("Rect").target),V.setCursor("default"),!0}}}},Ne.prototype._42=function(A,j,h){var D=this;D.screenInfo={};var c=D._interactor;c.editDetail||D.gatherInfo(j,h)&&(!c.editing||D.selectedTarget)&&Hf.Icons.DrawIcon(c,A,Hf.Icons.MoveDummy,D.screenInfo)};var an=Hf.RotateX=function(Z){this.catalog="RotateX",this._interactor=Z};an.prototype={},an.prototype.constructor=an,an.prototype.gatherInfo=function(D,J){var Y=this;if(1===J.length){var R=J[0];return R instanceof f.Shape&&R._70I()||mm(R,D)?!1:Y.gatherSingleTarget(D,R)}return J.length>1?Y.gatherMultiTargets(D,J):!1},an.prototype.gatherSingleTarget=function(){var E=new f.Math.Vector2,v=new f.Math.Vector2,r=new f.Math.Vector2,D=new f.Math.Vector2,c=function(i,Y){var X=i.x-Y.x,_=i.y-Y.y;return X*X+_*_};return function(_,e){if(e.getCorners){var s=this,q=e.getCorners(),A=15,l=e.getPosition();E.copy(q[0]),r.copy(q[1]),D.copy(q[3]),v.copy(E).add(D).divideScalar(2).add(E.sub(r).setLength(A/_.getZoom()));var N=Math.max(c(l,q[0]),c(l,q[1]),c(l,q[2]),c(l,q[3]));return s.info.POS=v.clone(),s.screenInfo.POS=Hf.toScreenPosition(_,s.info.POS),s.screenInfo.LEN=Math.sqrt(N)*_.getZoom()+A,s.screenInfo.CENTER=Hf.toScreenPosition(_,l),s.target=e,!0}}}(),an.prototype.gatherMultiTargets=function(c,I){var P=this,Z=Hf.Group.findOrCreateGroup(I);if(!Z)return!1;var P=this;return P.gatherSingleTarget(c,Z)},an.prototype.isVisible=function(){var Q=this._interactor;if(!Q.getStyle("rotateAsClock"))return!1;var q=this.target;if(!q)return!0;var G=Q.gv;return G.isEditable(q)&&G.isRotationEditable(q)?!0:!1},an.prototype.check=function(l,O,f){var E=this,M=E._checkImpl(l,O,f);return(M||E._clockPainted)&&E._interactor._42(),M},an.prototype._checkImpl=function(X,e,y){if(f.Default.isLeftButton(e)){var W=this;W.editing=null,W.tipInfo=null;var H;if(W.screenInfo&&(H=W.screenInfo.POS)&&W.isVisible()){var _=W._interactor;if(Hf.checkHit(y,H,_.getStyle("checkSize"))){var m=W.target,A=X.lp(e),q=m.getPosition(),Q=Math.atan2(A.y-q.y,A.x-q.x);return _._setRotateCursor(Q),W.editing={pos:q,rotation:m.getRotation(),hitRot:Q,groupRotateMode:"block",screenInfo:{CENTER:W.screenInfo.CENTER,LEN:W.screenInfo.LEN}},!0}}}},an.prototype.startEdit=function(V,$){V.startDragging($),V.fi({kind:"beginEditRotation",event:$}),this.target instanceof Hf.Group&&this.target.beginRotate(this.editing)},an.prototype._46O=function(Z){var B=this;B.editing&&(B.editing=null,B._interactor.fi({kind:"endEditRotation",event:Z})),B.target instanceof Hf.Group&&B.target.endRotate(),B.tipInfo=null},an.prototype.handleEdit=function(m,t){var C=this,u=C.editing;if(u){var Z,X,v=C.target,_=m.lp(t),q=C._interactor,Q=u.pos,e=Math.atan2(_.y-Q.y,_.x-Q.x),L=v instanceof Hf.Group;if(L?X=e-u.hitRot:(Z=e-u.hitRot,X=u.rotation+Z),X%=2*Math.PI,0>X&&(X+=2*Math.PI),!f.Default.isCtrlDown(t)){var a,r;ah(t)?(a=q.getStyle("shiftRotateRound"),r=a/2):(a=q.getStyle("rotateRound"),r=q.getStyle("rotateSensitivity")),X=Hf.roundTo(X,a,r)}L?(Z=X-(u.lastRotation||0),0!==Z&&(v.addRotation(Z,u.groupRotateMode),u.lastRotation=X)):v.setRotation(X),q._setRotateCursor(e),X>Math.PI&&(X-=2*Math.PI);var G=180*(X/Math.PI),c=""+G.toFixed(2)+"",R=f.Default.getLogicalPoint(t,q._canvas);R.x+=Hf.Icons.TipShiftX,R.y+=Hf.Icons.TipShiftY,C.tipInfo={helperPos:R,text:c,size:c.length},q.fi({kind:"betweenEditRotation",event:t})}},an.prototype._42=function(P,D,b){var y=this;y._clockPainted=!1,y.info={},y.screenInfo={};var I=y._interactor;I.editDetail||y.gatherInfo(D,b)&&y.isVisible()&&(Hf.Icons.DrawIcon(I,P,Hf.Icons.RoundPoint,y.screenInfo.POS),y.tipInfo&&Hf.Icons.DrawIcon(I,P,Hf.Icons.TipHelper,y.tipInfo),y.editing&&y.drawClock(P))},an.prototype.drawClock=function(C){C.save();var w=this;w._clockPainted=!0;var L=w.editing||{},p=L.screenInfo||w.screenInfo,t=p.LEN,j=t+8,o=t+18;C.save(),C.translate(p.CENTER.x,p.CENTER.y),C.beginPath(),C.strokeStyle="rgb(150, 150, 150)";for(var S,g,c,$,f,m=0;360>m;m++)S=m*Math.PI/180,0===m%5&&(g=W(S)*t,c=n(S)*t,$=W(S)*j,f=n(S)*j,C.moveTo(g,c),C.lineTo($,f)),0===m%45&&(g=W(S)*t,c=n(S)*t,$=W(S)*o,f=n(S)*o,C.moveTo(g,c),C.lineTo($,f));C.stroke(),C.rotate(-Z);var l=L.lastRotation||w.target.getRotation();C.beginPath(),C.fillStyle="rgba(255, 0, 0, 0.1)",C.strokeStyle="rgb(157, 157, 157)",C.moveTo(0,0),C.arc(0,0,o,0,l,!1),C.fill(),C.beginPath(),C.moveTo(0+o,0),C.arc(0,0,o,0,l,!1),C.stroke(),C.restore()};var kp=Hf.Curve=function(_){this.catalog="Curve",this._interactor=_};kp.prototype={},kp.prototype.constructor=kp,I.defineProperties(kp.prototype,{activing:{get:function(){return this._activing},set:function(e){var P=this;if(e)P._activing=new Hf.CurveActiving(this,e);else{var J=P._activing;J&&J.dispose(),P._activing=null}}}}),kp.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},kp.prototype.setUp=function(){var i=this,W=i._interactor;W&&W.gv.mp(i._onGraphviewPropertyChanged,i)},kp.prototype._onGraphviewPropertyChanged=function(K){("zoom"===K.property||"translateX"===K.property||"translateY"===K.property)&&this._handleDataChanged()},kp.prototype.tearDown=function(){var S=this,A=S._interactor;A&&A.gv.ump(S._onGraphviewPropertyChanged,S)},kp.prototype.canEnterEditDetailMode=function(){var u=this,s=u._interactor,K=s._getValidSelection();if(1===K.length){var C=K[0],m=C instanceof f.Edge;if(C instanceof f.Shape||m){if(m){var c=C.s("edge.type");if(c&&"points"!==c)return}var U=s.gv;if(U.isPointEditable(C)&&U.isEditable(C))return u.target=C,!0}}},kp.prototype.canQuitEditDetailMode=function(s){var y=this,C=y._interactor._getLogicalPoint(s);return y._checkEditRealPoint(C)?void 0:y._interactor.gv.getDataAt(s)!==y.target?!0:void 0},kp.prototype.preHandleScroll=function(){var y=this.editing;return y&&y.inEdit?!0:void 0},kp.prototype.getCurrentSelectintStatus=function(){var B=this;if(B.activing&&!B.activing.selections){if(B.activing.status!=m)return B.activing.status;var R=function(d){var j=B.activing.status;B.activing.status=d,B._interactor.fp("shapePointStatus",j,d)},T=Hf.Curve.PointType,K=B.activing.point,H=B.activing.pairs;if(!H||1!==H.length)return R(T.Mirrored);var N=H[0],f=N.c1&&N.c1.isNearEnough(K),V=N.c2&&N.c2.isNearEnough(K);if(!N.c1||!N.c2)return f||V?R(T.Straight):R(T.Disconnected);if(f&&V)return R(T.Straight);if(f||V)return R(T.Asymmetric);var k=N.c1.clone().sub(K),Z=N.c2.clone().sub(K);return Math.abs(k.x*Z.y-k.y*Z.x)>1e-5||k.x*Z.x>0?R(T.Disconnected):Math.abs(k.length()-Z.length())>1e-5?R(T.Asymmetric):R(T.Mirrored)}},kp.prototype.handle_keydown=function(_){var U=this;if(U._interactor.editDetail){var k=Hf.Curve.PointType;"1"===_.key?U._setCurrentSelectionStatus(k.Straight):"2"===_.key?U._setCurrentSelectionStatus(k.Mirrored):"3"===_.key?U._setCurrentSelectionStatus(k.Disconnected):"4"===_.key&&U._setCurrentSelectionStatus(k.Asymmetric)}},kp.prototype.setCurrentSelectionStatus=function(U){var z=this,c=z._interactor;if(c){var v=c.gv;v.dm().beginTransaction(),this._setCurrentSelectionStatus(U),v.dm().endTransaction()}},kp.prototype._setCurrentSelectionStatus=function(r){var E=this,n=E.activing;if(n){var Q=E.getCurrentSelectintStatus();if(null!==Q&&Q!==r){n.status=r;var F=E.activing.point,e=E.activing.pairs;if(e&&1===e.length){var R=e[0],q=E.screenInfo.curve,K=Hf.Curve.PointType,N=function(){E._writeToHt(),E._interactor.fp("shapePointStatus",Q,r)};if(r===K.Straight)return q.moveCtrlPoint(R,F,"c1"),q.moveCtrlPoint(R,F,"c2"),N(),void 0;if(Q===K.Straight){var _=q.findPairs(F,!0),y=_[0],M=y.r1||F,m=y.r2||F,B=m.clone().sub(M).multiplyScalar(.25);return q.moveCtrlPoint(R,F.clone().sub(B),"c1"),q.moveCtrlPoint(R,F.clone().add(B),"c2"),N(),void 0}var H=R.c1,Z=R.c2;if(H&&Z){if(r===K.Mirrored)return q.moveCtrlPoint(R,F.clone().multiplyScalar(2).sub(Z),"c1"),N(),void 0;if(r===K.Asymmetric&&Q===K.Disconnected){var f=H.clone().sub(F).length(),B=F.clone().sub(Z).setLength(f).add(F);return q.moveCtrlPoint(R,B,"c1"),N(),void 0}}n._firePointChange(),E._interactor.fp("shapePointStatus",Q,r)}}}},kp.prototype._handleDataChanged=function(){var U="points,segments,shape,position,rotation,scale".split(",");return function(j){var J=this;if(J.screenInfo&&J.target){if(j&&U.indexOf(j.property)<0)return;var F=J._interactor;J.gatherSingleTarget(F.gv,J.target,!0),J.check(F.gv,null,new Hf.Math.Vector2(F._lastClientPoint)),F._42()}}}(),kp.prototype.gatherSingleTarget=function(I,_,W){var S,V,P=this;P.screenInfo&&P.screenInfo.curve&&(V=P.screenInfo.curve._curves);var Z=P.editing;S=Z?P.screenInfo:P.screenInfo={};var y,H,g=_ instanceof f.Edge;g?(y=_.s("edge.segments"),H=_.s("edge.points")||new f.List):(y=_._58O,H=_._59O),S.S=y;var K,x=S.P=[],d=Hf.getDataMatrix(_);if(_ instanceof f.Polyline&&(K=_.getElevation()||0,S.E=[]),H.each(function($){S.E&&S.E.push($.e||K),$=d.apply($);var L=Hf.toScreenPosition(I,$);x.push(L.x,L.y)}),g){var J=x.length,b=Hf.toScreenPosition(I,_._lastSourcePoint||(J?{x:x[0],y:x[1]}:{x:0,y:0})),h=Hf.toScreenPosition(I,_._lastTargetPoint||(J?{x:x[J-2],y:x[J-1]}:{x:0,y:0}));x.splice(0,0,b.x,b.y),x.push(h.x,h.y)}if(!S.S||!S.S.size()){S.S=new f.List,S.S.add(1);for(var X=0;X<x.length/2-1;X++)S.S.add(2)}if((!Z||W)&&P.convertToCubicBezier(V),P.activing&&(W||!P.editing||"realPoint"===P.editing.type)){var z=S.curve.findPairs(P.activing.point);P.activing.pairs=z}g&&"points"!==_.s("edge.type")&&P._writeToHt()},kp.prototype._convertToNewPoint=function(R,J,d,x){var g,U,X;for(g=0,U=J.length;U>g;g++){if(X=J[g],X._p1.isNearEnough(R)&&(!x||x.indexOf(X._p1)<0))return X._p1;if(X._p4.isNearEnough(R)&&(!x||x.indexOf(X._p4)<0))return X._p4}if(d)for(g=0,U=Math.min(d.length,U);U>g;g++){if(X=d[g],X._p1===R&&(!x||x.indexOf(J[g]._p1)<0))return J[g]._p1;if(X._p4===R&&(!x||x.indexOf(J[g]._p4)<0))return J[g]._p4}},kp.prototype.convertToCubicBezier=function(I){var Q,_,i=this,U=new Hf.Math.Curve,E=i.screenInfo;if(U.createFromHtShape(E.P,E.S,E.E),E.curve=U,i.activing){var z=U._curves;Q=i.activing.point,_=i._convertToNewPoint(Q,z,I);var T=[];if(_&&(i.activing.point=_,T.push(_)),i.activing.selections){var L=-1,t=i.activing.selections;t.forEach(function(n){L++,_=i._convertToNewPoint(n,z,I,T),_&&(t[L]=_,T.push(_))})}}},kp.prototype.check=function(y,M,B){if(!M||im(M)||fc(M)){var Y=this;if(Y._interactor.setCursor("default"),Y.editing=null,Y.highlight=null,Y.tipInfo=null,Y.edgeEditResult=null,Y.screenInfo){if(Yk()||fc(M))return Y._interactor._42(),!0;if(Y._checkEditCtrlPoint(B))return Y._interactor._42(),!0;if(Y._checkEditRealPoint(B))return Y._interactor._42(),!0;if(Y._checkEditElevation(B))return Y._interactor._42(),!0;var b=Y.screenInfo.curve,t=b.checkPoint(B,Y._interactor.getStyle("curveIntersectSize"));if(t){var v=Y.highlight={};v.type="insertKnot",v.bezier=t.bezier,v.point=t.intersection}return Y._interactor._42(),!0}}},kp.prototype._checkEditRealPoint=function(C){var S,D,A,Z,k,g,h=this,P=h.screenInfo.curve._curves,o=h._interactor.getStyle("curvePointIntersectSize"),t=1/0;for(o*=o,A=0,Z=P.length;Z>A;A++)S=P[A],k=S._p1,g=C.distanceToSquared(k),t>g&&(t=g,D=k),k=S._p4,g=C.distanceToSquared(k),t>g&&(t=g,D=k);if(t>o)return!1;var x=h.highlight={};return x.type="changeRealPoint",x.point=D,h.editing={type:"realPoint",point:D,shiftGuide:{point:D.clone(),dir:"x",limit:0}},h._interactor.setCursor("crosshair"),!0},kp.prototype._checkEditElevation=function(S){var T=this;if(!T._interactor.getStyle("curveElevationVisible"))return!1;var C=T.activing;if(!C)return!1;var I=C.getCurrentEditingPoint();if(!I)return!1;var Y=T._interactor,h=Y.getStyle("curveElevationGuideShift"),u=Y.getStyle("curveElevationIntersectSize"),G=S.distanceToSquared({x:I.x+h[0],y:I.y+h[1]});if(!(G>u*u)){var j=T.highlight={};j.type="elevation";var _=new Hf.Math.Vector2(S.x,S.y,I.e);return T.editing={type:"elevation",startPoint:_},T._interactor.setCursor("crosshair"),!0}},kp.prototype._checkEditCtrlPoint=function(Z){var X=this;if(X.activing&&!X.activing.selections){var B=X.getCurrentSelectintStatus();if(B!==Hf.Curve.PointType.Straight){var Y=X.activing.pairs;if(Y){var E=X._interactor.getStyle("curvePointIntersectSize");E*=E;var D,d,k,w,l,b,g,T,n,O=1/0;for(g=0,n=Y.length;n>g;g++)for(w=Y[g],T=0;2>T;T++)l=0===T?"c1":"c2",w[l]&&(b=Z.distanceToSquared(w[l]),O>b&&(O=b,D=w,d=g,k=l));if(O>E)return!1;X.activing.hlpair=D,X.activing.hltype=k;var f=X.highlight={};return f.type="changeCtrlPoint",f.point=D[k],X.editing={type:"ctrlPoint",pair:D,pairId:d,ctrlType:k,direction:D[k].clone().sub(X.activing.point).normalize()},X._interactor.setCursor("crosshair"),!0}}}},kp.prototype.startEdit=function(R,j){R.startDragging(j);var Y=this;Y.highlight&&"insertKnot"===Y.highlight.type&&(Y.insertKnot(),Y.gatherSingleTarget(Y._interactor.gv,Y.target),Y.activing=null,Y._checkEditRealPoint(Y._interactor._getLogicalPoint(j)));var T=Y._activing;if(T){var s=Y.editing?Y.editing.type:null;"ctrlPoint"===s?T.editingCtrl={pairId:Y.editing.pairId,type:T.hltype}:"realPoint"===s&&(T.editingCtrl=!1)}var K=Y.highlight,Q=f.Default.isCtrlDown(j);if(!K||Yk()||fc(j)){var X=Y._interactor.gv;if(!X.setFocus(j)||X._scrolling)return;return Q?Y._multiSelect={startPoint:X.lp(j)}:X.isPannable()&&(im(j)||fc(j))&&(Y._pan={tx:X.tx(),ty:X.ty()},R.fi({kind:"beginPan",event:j})),void 0}if("changeRealPoint"===K.type){var O,u=Y.activing?Y.activing.point:null,U=Y.activing?Y.activing.selections:null;if(Q&&Y.activing)u===K.point?(U?(Y.activing={point:U[0]},U.length>1&&(U.splice(0,1),Y.activing.selections=U)):Y.activing=null,Y.editing=null):U&&(O=U.indexOf(K.point))>=0?(U.length>1?U.splice(O,1):delete Y.activing.selections,Y.editing=null):U?(U.push(u),Y.activing={point:K.point,selections:U}):Y.activing={point:K.point,selections:[u]};else if(U)u===K.point||((O=U.indexOf(K.point))>=0?(U.splice(O,1,u),Y.activing={point:K.point,selections:U}):Y.activing={point:K.point});else{var V;u===K.point&&(V=Y.activing.status),Y.activing={point:K.point},V&&(Y.activing.status=V)}R.fi({kind:"beginEditPoint",event:j})}},kp.prototype.insertKnot=function(){var K=this,f=K.highlight,c=K.screenInfo.curve;c.insertKnot(f.bezier,f.point.t),K._writeToHt()},kp.prototype._writeToHt=function(){var n,b,M,g,Z=this,A=Z.screenInfo.curve,q=A.toHtShape(),o=q.points,c=[],T=q.segments,i=Z._interactor.gv,K=Z.target,s=K instanceof f.Edge,d=Hf.getDataMatrix(K).invert();g=K instanceof f.Polyline,g&&(M=K.getElevation());for(var y=0,$=o.length;$>y;y++)n=o[y],b=Hf.toWorldPosition(i,n),b=d.apply(b),n.e!=m&&n.e!==M&&(b.e=n.e),c.push(b);if(K._writing=!0,s){K.s("edge.type","points"),K.setStyle("edge.segments",T),K.setStyle("edge.points",c.slice(1,c.length-1)),K.setStyle("edge.source.offset.x",0),K.setStyle("edge.source.offset.y",0),K.setStyle("edge.target.offset.x",0),K.setStyle("edge.target.offset.y",0);var U=Z._nextChangeEdgeHost;delete Z._nextChangeEdgeHost,U&&("source"===U.type?K.setSource(U.host):K.setTarget(U.host)),Z._writeEdgeHostAnchor("source",c[0]),Z._writeEdgeHostAnchor("target",c[c.length-1])}else c.length?(K.setSegments(T),K.setPoints(c,!0)):K.removeFromDataModel();delete K._writing},kp.prototype._writeEdgeHostAnchor=function(B,a){var n=this,c=n.target,u=n._calcHostAnchor(c,B,a);u.index!==m?(c.setStyle("edge."+B+".index",u.index),c.setStyle("edge."+B+".percent",m),c.setStyle("edge."+B+".anchor.x",m),c.setStyle("edge."+B+".anchor.y",m)):u.percent!==m?(c.setStyle("edge."+B+".percent",u.percent),c.setStyle("edge."+B+".index",m),c.setStyle("edge."+B+".anchor.x",m),c.setStyle("edge."+B+".anchor.y",m)):(c.s("edge."+B+".anchor.x",u.x),c.s("edge."+B+".anchor.y",u.y),u.offsetX||u.offsetY?(c.s("edge."+B+".offset.x",u.offsetX),c.s("edge."+B+".offset.y",u.offsetY)):(c.s("edge."+B+".offset.x",0),c.s("edge."+B+".offset.y",0)))},kp.prototype._calcHostAnchor=function($,J,e,c){c||(c="source"===J?$.getSource():$.getTarget());var R=this._interactor.gv,m=R.calculateAttachPoint(c,e);if(m)return m.info;if(hl(c)){var o=R.calculateEdgePosition(c,e);return o}var V=c.getRotation(),E=c.getAnchor();mm(c,R)&&(V=0);var d=c.getScale();if(V||d.x<0||d.y<0){var I=c.getMatrix(),t=I.tfi(e),j=c.getSize();return{x:t.x/j.width+E.x,y:t.y/j.height+E.y}}var G=sp(R,c),n={x:(e.x-G.x)/G.width,y:(e.y-G.y)/G.height};return n},kp.prototype._handlePanning=function(z){var F=this,k=F._pan;if(k){k.started=!0;var Y=F._interactor,K=Y.gv,H=Y._lastClientPoint,X=Pb(z),M=ip(K,X,H);K.setTranslate(k.tx+M.x,k.ty+M.y),F.gatherSingleTarget(Y.gv,F.target),Y._42(),Y.fi({kind:"betweenPan",event:z})}},kp.prototype.handleEdit=function(X,F){var b=this,q=b.editing;if(b._pan)return b._handlePanning(F),void 0;if(b._multiSelect)return b._multiSelect.endPoint=X.lp(F),b._interactor.redraw(),void 0;if(q){q.inEdit=!0;var w,j,Q,p=b._interactor._getLogicalPoint(F),i=f.Default.isCtrlDown(F),H=f.Default.isShiftDown(F),B=q.type,A=b.activing;if(b._guideInfo=null,"ctrlPoint"===B&&H){var l=b.editing.direction.clone();w=A.point;var O=l.dot(p.clone().sub(w));p=l.setLength(O).add(w)}else if("ctrlPoint"===B||"realPoint"===B){var l;if("realPoint"===B&&H){var V=b.editing.shiftGuide;j=V.point;var y=Math.abs(p.x-j.x),U=Math.abs(p.y-j.y);y>U&&y>V.limit&&"y"===V.dir&&(V.dir="x"),U>y&&U>V.limit&&"x"===V.dir&&(V.dir="y"),l=V.dir,"x"===l?(p.y=j.y,V.limit=Math.max(V.limit,y)):"y"===l&&(p.x=j.x,V.limit=Math.max(V.limit,U))}var N=b._isEditEdgeSourceTarget();if(N){var k=b._editEdgeSourceTarget(N,p,i);k&&(b.edgeEditResult=k,Q=k.tipText)}else if(!i){var g=b._guidingToEdit(p,l),Y="realPoint"===B?b._interactor.gridGuide.findClosest(p,l,!0):null,d=1/0,e=1/0;Y&&(Y.x&&(d=Y.x),Y.y&&(e=Y.y));var r=!1;g&&(g.xList&&(Math.abs(g.x)<=Math.abs(d)?(r=!0,d=g.x):delete g.xList),g.yList&&(Math.abs(g.y)<=Math.abs(e)?(r=!0,e=g.y):delete g.yList),r&&(b._guideInfo=g)),isFinite(d)&&(p.x+=d),isFinite(e)&&(p.y+=e),r&&(g.v=p)}}var v=b.screenInfo.curve;if("realPoint"===q.type){w=q.point,w.e!==m&&(p.e=w.e),v.moveRealPoint(w,p),q.point=p,b.highlight.point=p;var D=A.status,u=A.selections;if(b.activing={point:p,status:D},u){var E=p.clone().sub(w),z=0;u.forEach(function(k){var B=k.clone().add(E);v.moveRealPoint(k,B),u[z++]=B}),b.activing.selections=u}}else if("ctrlPoint"===q.type){var T=A.pairs,c=T[q.pairId];v.moveCtrlPoint(c,p,q.ctrlType);var P=A.status,K=Hf.Curve.PointType;if((P===K.Mirrored||P===K.Asymmetric)&&c.c1&&c.c2){var w=new Hf.Math.Vector2(A.point),R="c1"===q.ctrlType?"c2":"c1";if(P===Hf.Curve.PointType.Mirrored)v.moveCtrlPoint(c,w.clone().multiplyScalar(2).sub(p),R);else if(P===K.Asymmetric){var O=c[R].clone().sub(w).length(),S=w.clone().sub(c[q.ctrlType]).setLength(O).add(w);isNaN(S.x)||v.moveCtrlPoint(c,S,R)}}A._firePointChange()}else if("elevation"===q.type){j=q.startPoint;var W=j.e+(j.y-p.y)/X._zoom;b._setCurrentPointImpl("e",W),A._firePointChange(),Q="E: "+Hf.toFixed(W)}var n=f.Default.getLogicalPoint(F,b._interactor._canvas);if(n.x+=Hf.Icons.TipShiftX,n.y+=Hf.Icons.TipShiftY,!Q){var I=Hf.toWorldPosition(X,p);Q=""+Hf.toFixed(I.x)+", "+Hf.toFixed(I.y)}b.tipInfo={helperPos:n,text:Q,size:Q.length},b._writeToHt(),b._interactor.fi({kind:"betweenEditPoint",event:F})}},kp.prototype._setCurrentPointImpl=function(F,G){var _=this,g=_._activing;if(!g)return!1;var e=_.target;if(!e)return!1;var M=g.getCurrentEditingPoint();if(!M)return!1;var l=g.editingCtrl;if(!l)var o=M.clone();if("e"===F)M.e=G;else{var v;if("x"===F||"y"===F){var z=g._lastFirePoint;v="x"===F?{x:G,y:z?z.y:0}:{x:z?z.x:0,y:G}}else"object"==typeof F?(v=F,F.e!==m&&(M.e=F.e)):(v={x:arguments[0],y:arguments[1]},arguments[2]!==m&&(M.e=arguments[2]));var q=Hf.getDataMatrix(e);v=Hf.toScreenPosition(_._interactor.gv,q.apply(v)),M.x=v.x,M.y=v.y}if(!l){var S=o.multiplyScalar(-1).add(M);M.e&&o.e&&(S.e=M.e-o.e),_.screenInfo.curve.moveCtrlDueToRealPointMovement(M,S)}return!0},kp.prototype.setCurrentPoint=function(h,T){return this._setCurrentPointImpl(h,T)?(this._writeToHt(),!0):!1},kp.prototype._isEditEdgeSourceTarget=function(){var z=this,q=z.target;if(!(q instanceof f.Edge))return!1;var d=z.editing.point,I=z.screenInfo.curve._curves;return d===I[0]._p1?"source":d===I[I.length-1]._p4?"target":!1},kp.prototype._editEdgeSourceTarget=function(M,h,c){var J,u=this,R=u.target;if(J="source"===M?R.getSource():R.getTarget()){var i,D=u._interactor.gv,W=Hf.toWorldPosition(D,h),y=u._calcHostAnchor(R,M,W,J);if(i=y.index!==m||y.percent!==m?y.distance*D.getZoom()>u._interactor.getStyle("edgeHostEdgeMaxDistance"):u._interactor.getStyle("edgeHostDetectPerFrame")?!0:y.x<0||y.x>1||y.y<0||y.y>1?!0:!1){var _=D.getDataAt(W,function(X){return D.isSelectable(X)?X===J?!1:R.canSetSourceTarget(X,M)?!0:!1:!1});if(_){var q=u._calcHostAnchor(R,M,W,_);J=_,u._nextChangeEdgeHost={type:M,host:_},y=q}}var C,X,o;if(c||y.x===m)(y.percent!==m||y.index!==m)&&(X=y.point);else{var x=u._interactor.getStyle("anchorRound"),k=u._interactor.getStyle("anchorSensitivity");C=D.calculateAttachPoint(J,W),C?y=C.info:(y.x=Hf.roundTo(y.x,x,k),y.y=Hf.roundTo(y.y,x,k)),X=J.getAttachPosition(y.x,y.y,y.offsetX,y.offsetY)}X&&(o=Hf.toScreenPosition(D,X),h.x=o.x,h.y=o.y),u._edgeHostGuideInfo={corners:Hf.getTargetCornersOnScreen(D,J),attach:C?C.index:-1,host:J};var Z;return y.percent!==m?Z="percent: "+y.percent.toFixed(2):y.index!==m?Z="index: "+y.index:(Z=""+y.x.toFixed(2)+", "+y.y.toFixed(2),(y.offsetX||y.offsetY)&&(Z+=" offset: "+y.offsetX.toFixed(2)+", "+y.offsetY.toFixed(2))),{host:J,anchor:y,tipText:Z}}},kp.prototype._guidingToEdit=function(b,A){var O,s,l=this;if(O=l.screenInfo.curve){s=O._curves;var v,q,J,T,X,t,f,o,Q=1/0,E=1/0,p=[];for(l.editing&&"realPoint"===l.editing.type&&(o=l.editing.point),X=0,t=2*s.length;t>X;X++)f=s[Math.floor(X/2)][X%2?"_p4":"_p1"],p.indexOf(f)>=0||(p.push(f),o&&o===f||(J=f.x-b.x,T=f.y-b.y,Math.abs(J)<Math.abs(Q)?(Q=J,v=[f]):J===Q&&v.push(f),Math.abs(T)<Math.abs(E)?(E=T,q=[f]):T===E&&q.push(f)));var G=l._interactor.getStyle("smartGuideThreshold");if((Math.abs(Q)>G||"y"===A)&&(v=null),(Math.abs(E)>G||"x"===A)&&(q=null),v||q){var $=!1,P={};if(v&&($=!0,P.xList=v,P.x=Q),q&&($=!0,P.yList=q,P.y=E),$)return P}}},kp.prototype._46O=function(P){var t=this;t.editing&&(t.editing=null,t._interactor.fi({kind:"endEditPoint",event:P})),t._guideInfo=null,t._edgeHostGuideInfo=null,t._pan&&(t._pan=null,t._interactor.fi({kind:"endPan",event:P})),t._multiSelect&&(t._handleMultiSelect(t._multiSelect),t._multiSelect=null),t.tipInfo=null,t.edgeEditResult=null},kp.prototype._handleMultiSelect=function(o){if(o.startPoint&&o.endPoint){var i,L,A,E,Y,b=this,c=b._interactor,$=c.gv,p=Hf.toScreenPosition($,o.startPoint),h=Hf.toScreenPosition($,o.endPoint),T=f.Default.unionPoint(p,h),y=b.screenInfo.curve._curves,t=[],Z=function(z){z.x>=T.x&&z.y>=T.y&&z.x<=T.x+T.width&&z.y<=T.y+T.height&&t.indexOf(z)<0&&t.push(z)};for(i=0,L=y.length;L>i;i++)Y=y[i],Z(Y._p1),Z(Y._p4);if(t.length){var q=b.activing||{},P=q.selections||[];for(q.point&&P.push(q.point),i=0,L=P.length;L>i;i++)A=P[i],E=t.indexOf(A),E>=0?t[E]=m:t.push(A);var Q=t;for(t=[],i=0,L=Q.length;L>i;i++)Q[i]&&t.push(Q[i]);L=t.length,0===L?b.activing=null:1===L?b.activing={point:t[0]}:(A=t[L-1],b.activing={point:A,selections:t.splice(0,L-1)}),c.redraw()}}},kp.prototype._canDeletePoint=function(P,i){var x=this.target;if(!(x instanceof f.Edge))return!0;var E=P._curves[0],J=P._curves[P._curves.length-1];return E._p1===i||J._p4===i?!1:!0},kp.prototype.handleDelete=function(){var Y=this;if(Y.activing&&Y.screenInfo){var D=f.Default.isShiftDown(),j=Y.screenInfo.curve;Y._canDeletePoint(j,Y.activing.point)&&j.deleteRealPoint(Y.activing.point,D),Y.activing.selections&&Y.activing.selections.forEach(function(y){Y._canDeletePoint(j,y)&&j.deleteRealPoint(y,D)}),Y.activing=null,delete Y.editing,delete Y.tipInfo,delete Y.edgeEditResult,delete Y._pan,delete Y._multiSelect,Y._writeToHt(),Y._interactor.fp("deleteShapePoint",!1,!0)}},kp.prototype.handleDoubleClick=function(F){var $=this,t=$._interactor._getLogicalPoint(F);if($.screenInfo&&$._checkEditRealPoint(t)){var s=$.getCurrentSelectintStatus(),_=Hf.Curve.PointType;return s=s===_.Mirrored?_.Straight:_.Mirrored,$._setCurrentSelectionStatus(s),$._interactor._42(),!0}},kp.prototype._drawHighlight=function(U){var L=this,G=L.highlight;if(G){var Z=G.bezier,w=L._interactor;Z&&Hf.Icons.DrawIcon(w,U,Hf.Icons.ShapeHighlightCurve,[Z._p1.x,Z._p1.y,Z._p2.x,Z._p2.y,Z._p3.x,Z._p3.y,Z._p4.x,Z._p4.y]);var b=G.point;b&&"insertKnot"===G.type&&Hf.Icons.DrawIcon(w,U,Hf.Icons.ShapeHighlighPoint,b)}},kp.prototype._drawGuide=function(g){var y=this,F=y._guideInfo;if(F){var Y,m,U,A,c=F.v;for(Y=0;2>Y;Y++)if(A=0===Y?F.xList:F.yList)for(m=0,U=A.length;U>m;m++)Hf.Icons.DrawIcon(y._interactor,g,Hf.Icons.ShapeGuideLine,[c.x,c.y,A[m].x,A[m].y])}},kp.prototype._drawCurrentPoint=function(F){var v=this;if(v.activing){var e=v.activing,u=v.getCurrentSelectintStatus(),q=v._interactor;if(u!==Hf.Curve.PointType.Straight){var g=e.pairs;e.hlpair,e.hltype;var U=e.selections,R=e.editingCtrl;if(g&&!U){var Q,T,n;for(T=0,n=g.length;n>T;T++)Q=g[T],R&&T===R.pairId&&Q[R.type]?Hf.Icons.DrawIcon(q,F,Hf.Icons.ShapeActivingCtrl,{point:Q.point,c1:Q.c1,c2:Q.c2,hl:R.type}):Hf.Icons.DrawIcon(q,F,Hf.Icons.ShapeActivingCtrl,Q)}}Hf.Icons.DrawIcon(q,F,Hf.Icons.ShapeHighlighRealPoint,v.activing.point),U&&U.forEach(function(f){Hf.Icons.DrawIcon(q,F,Hf.Icons.ShapeHighlighRealPoint,f)})}},kp.prototype.clear=function(){var G=this;G.editing=null,G._guideInfo=null,G.activing=null,G.highlight=null},kp.prototype._42=function(K){var J=this;J.info={},J.editing||(J.screenInfo=null);var y=J._interactor;if(!y.editDetail)return J.clear(),void 0;var c=y.gv;if(!J.target||!c.isSelected(J.target)||!c.isVisible(J.target))return y.editDetail=!1,J.clear(),void 0;if(J.gatherSingleTarget(c,J.target),Hf.Icons.DrawIcon(y,K,Hf.Icons.ShapeBgCurve,J.screenInfo),J._drawHighlight(K),J._drawCurrentPoint(K),J._getRealPoint().forEach(function(Y){Hf.Icons.DrawIcon(y,K,Hf.Icons.ShapePoint,Y)}),J._drawGuide(K),J.tipInfo&&Hf.Icons.DrawIcon(y,K,Hf.Icons.TipHelper,J.tipInfo),J._edgeHostGuideInfo){Hf.Icons.DrawIcon(y,K,Hf.Icons.NodeHoverGuide,J._edgeHostGuideInfo.corners);var t=J._edgeHostGuideInfo.host;if(t){var X=c.getAttachPoints(t);if(X&&X.length)for(var x=0,O=X.length;O>x;x++){var o=X[x],P=t.getAttachPosition(o.x,o.y,o.offsetX,o.offsetY);P=Hf.toScreenPosition(c,P),P.isAttach=J._edgeHostGuideInfo.attach===x,Hf.Icons.DrawIcon(y,K,Hf.Icons.AttachPoint,P)}}}if(J._interactor.getStyle("curveElevationVisible")&&J.target instanceof f.Polyline&&J.activing){var U=J.activing.getCurrentEditingPoint();U&&Hf.Icons.DrawIcon(y,K,Hf.Icons.EdgeElevationGuide,U)}if(J.edgeEditResult&&J._drawEdgeHostHighlight(K,J.edgeEditResult.host,J.edgeEditResult.anchor),J._multiSelect&&J._multiSelect.endPoint){var Y=f.Default.unionPoint(Hf.toScreenPosition(c,J._multiSelect.startPoint),Hf.toScreenPosition(c,J._multiSelect.endPoint));Y.color=c.getRectSelectBorderColor(),K.save(),K.setTransform(1,0,0,1,0,0);var Q=q.devicePixelRatio,G=Y.borderWidth=Math.round(Q);G/=2,Y.x=Math.round(Y.x*Q)+G,Y.y=Math.round(Y.y*Q)+G,Y.width=Math.round(Y.width*Q),Y.height=Math.round(Y.height*Q),Hf.Icons.DrawIcon(y,K,Hf.Icons.SimpleRect,Y),K.restore()}},kp.prototype._drawEdgeHostHighlight=function(R,n,h){this.drawEdgeHostHighlight(R,n,h),this._interactor.redraw()},kp.prototype.drawEdgeHostHighlight=function(X,s,D){if(hl(s)){var O,z,G,F,j=this,v=j._interactor,A=v.gv,u=A.getDataUI(s),M=hs(u),b=[];for(G=0,F=M.points.length;F>G;G++)z=Hf.toScreenPosition(A,M.points.get(G)),b.push(z.x,z.y);M.segments&&(O=M.segments.toArray());var $=v.getStyle("edgeHostHighlighPeriod"),W=v.getStyle("edgeHostEdgeHighlighColor");Hf.Icons.DrawIcon(v,X,Hf.Icons.ShapeBgCurve,{P:b,S:O,color:W,dynamicVisible:D.index===m,dynamicPeriod:$}),W=v.getStyle("edgeHostPointHighlighColor");var N=Pf(u);for(G=0,F=N.length;F>G;G++){var x=N[G],r=Hf.toScreenPosition(A,x);Hf.Icons.DrawIcon(v,X,Hf.Icons.ShapePoint,{point:{x:r.x,y:r.y},color:W,size:12,dynamicVisible:G===D.index,dynamicPeriod:$})}}},kp.prototype._getRealPoint=function(){var i,G=this.screenInfo,l=G.P,F=G.S,I=-1,u=[],e=-1,Y=F.length;return F.each(function(v){e++;var G=1;if(3===v)G=2;else if(4===v)G=3;else if(5===v)return;I+=G,i=e+1>=Y?!0:1===F.get(e+1)?!0:!1,u.push({point:{x:l[2*I],y:l[2*I+1]},segmentIndex:e,pointIndex:I,isEnd:i})}),u},kp.prototype.getEditingPointsInfo=function(b){var x=this,T=x.activing;if(!T)return!1;var $=T.point;if(!$)return!1;var H=this._getRealPoint(),s=[{screen:$}];T.selections&&T.selections.forEach(function(v){s.push({screen:v})
});var M,y,V=H.length;return s.forEach(function(R){for(M=0;V>M;M++)if(y=H[M],R.screen.isNearEnough(y.point)){R.segmentIndex=y.segmentIndex,R.pointIndex=y.pointIndex,R.point=x.target.getPoints().get(y.pointIndex);break}}),b&&s.sort(function(t,$){return t.segmentIndex-$.segmentIndex}),s};var Eb=Hf.MoveHelper=function(V){var q=this;q.catalog="Move",q._interactor=V};Eb.prototype={},Eb.prototype.constructor=Eb,Eb.prototype.calcShift=function(l,e,y){var P,n,B=this,Z=B._interactor.gv,Y=Z.lp(e);if("beginMove"===l&&B._gatherGridInfo(y._lastLogicalPoint||Y),P=B._target){var $=P.downPosition;if($){var v=B._interactor.getStyle("moveSensitivity")/Z._zoom;if($.distanceTo(Y)<v)return{x:0,y:0};delete P.downPosition}var E;n=f.Default.isShiftDown(e),n&&(Y=B._dealShiftDown(Y),E=P.shiftGuide.dir);var M,T=P.rawPos={x:P.pos.x+Y.x-P.lp.x,y:P.pos.y+Y.y-P.lp.y};if(f.Default.isCtrlDown(e)){if(M=B._calcShiftByAddon(),B._target.node instanceof Hf.Group){var X=B._target.node;X._position.x+=M.x,X._position.y+=M.y}return M}for(var N,j=P.x+T.x,g=P.y+T.y,C={x:j,y:g},r={x:j+P.w/2,y:g+P.h/2},o={x:j+P.w,y:g+P.h},k=B._interactor.rectGuide,I=B._interactor.gridGuide,S=[k.findClosest(C,E),k.findClosest(r,E),k.findClosest(o,E),I.findClosest(C,E),I.findClosest(r,E),I.findClosest(o,E)],q=1/0,h=1/0,i=0,_=S.length;_>i;i++)N=S[i],N&&(j=N.x,g=N.y,isFinite(j)&&Math.abs(j)<Math.abs(q)&&(q=j),isFinite(g)&&Math.abs(g)<Math.abs(h)&&(h=g));if(isFinite(q)||(q=0),isFinite(h)||(h=0),M=B._calcShiftByAddon(q,h),B._target.node instanceof Hf.Group){var X=B._target.node;X._position.x+=M.x,X._position.y+=M.y}var O=P.node;if(!mm(O,Z)){var d=T.x+q,U=T.y+h;B._interactor.rectGuide.gatherLines({node:O,x:P.x+d,y:P.y+U,w:P.w,h:P.h},E)}return M}},Eb.prototype._calcShiftByAddon=function(w,J){var T=this._target,C=T.rawPos,y=T.node.getPosition();return w=w||0,J=J||0,{x:C.x-y.x+w,y:C.y-y.y+J}},Eb.prototype._dealShiftDown=function(r){var F=this,U=F._target.shiftGuide,f=F._target.lp,_=Math.abs(r.x-f.x),j=Math.abs(r.y-f.y);_>j&&_>U.limit&&"y"===U.dir&&(U.dir="x"),j>_&&j>U.limit&&"x"===U.dir&&(U.dir="y");var l=U.dir;return"x"===l?(r.y=f.y,U.limit=Math.max(U.limit,_)):"y"===l&&(r.x=f.x,U.limit=Math.max(U.limit,j)),r},Eb.prototype._gatherGridInfo=function(k){var b,i=this,p=i._interactor,H=p._getValidSelection();if(H.length){if(1===H.length){if(b=H[0],!b.getRect)return i._target=null,void 0}else if(b=Hf.Group.findOrCreateGroup(H),!b)return i._target=null,void 0}else{var H=p.gv.sm().getSelection();if(H.length&&(b=H.get(0),!b.getRect))return i._target=null,void 0}var z=b.getPosition(),c=b.getRect();i._target={node:b,x:c.x-z.x,y:c.y-z.y,w:c.width,h:c.height,lp:{x:k.x,y:k.y},pos:{x:z.x,y:z.y},shiftGuide:{dir:"x",limit:0},downPosition:new Hf.Math.Vector2(k)},p.rectGuide.gatherRects()},Eb.prototype.clear=function(){var K=this;K._interactor.rectGuide.clear(),K._interactor._42()};var Qk="directional",xf="point",Ao="spot",Bj="light.color",ni={},qd=function(K,W){xr(W)&&me.test(W)?$j(K,W):Bq(W)&&W.modelType?Bk(K,W):Jr[K]=W},Th=function(g){if(Bq(g))return g.modelType?g.uuid?Jr[g.uuid]:(g.uuid=f.Math.generateUUID(),Bk(g.uuid,g),m):g;var k=Jr[g];return g&&k===m&&me.test(g)&&(Eo&&Eo[g]||$j(g,g)),k},$n=function(p,O){p.frameStack?p.frameStack.push(O):p.frameStack=[O],p.bindFramebuffer(p.FRAMEBUFFER,O)},_h=function(A){var H=A.frameStack;if(H){if(H.pop(),H.length)return A.bindFramebuffer(A.FRAMEBUFFER,H[H.length-1]),void 0;A.frameStack=null}A.bindFramebuffer(A.FRAMEBUFFER,null)};kk(O,{graph3dViewAttributes:A,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:s/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:pr,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:s/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:qd,getShape3dModel:Th,createMatrix:function(E,c){Nq(E)||(E=[E]);for(var k=E.length-1;k>=0;k--){var B=E[k];c=Hp(B.mat,B.s3,B.r3,B.rotationMode,B.t3,c)}return c},transformVec:function(s,t){return li(s,t)},glBindFrame:$n,glUnbindFrame:_h,createBoxModel:function(){return{vs:Mg,ns:_e,uv:_g,is:Io}},createRoundRectModel:function(N,v){return Lr.roundRect(N,v)},createStarModel:function(O,A){return Lr.star(O,A)},createRectModel:function(Y,x){return Lr.rect(Y,x)},createTriangleModel:function(M,t){return Lr.triangle(M,t)},createRightTriangleModel:function(g,E){return Lr.rightTriangle(g,E)},createParallelogramModel:function(T,d){return Lr.parallelogram(T,d)},createTrapezoidModel:function(l,W){return Lr.trapezoid(l,W)},createSmoothSphereModel:function(J,Z,w,W,Y,B,y){return Cm(new cr(J,Z,w,W,Y,B,y))},createSphereModel:function(e,V,w,b,W,o){return e?Re(e,V,w,b,W,o):O.createSmoothSphereModel()},createSmoothConeModel:function(q,i,R,s,k){return np(q,i,R,s,k)},createConeModel:function(V,A,L,Y,s,I){return V?Kh(V,A,L,Y,s,I):np(I)},createSmoothCylinderModel:function(Z,Q,G,J,u,T,H,a){return Cm(new Br(Z,Q,G,J,u,T,H,a))},createCylinderModel:function(p,A,W,v,T,w,q){return p?le(p,A,W,v,T,w,q):wn(w,q)},createSmoothTorusModel:function(f,k,C,E,g,L){return Cm(new Aj(f,k,C,E,g,L))},createTorusModel:function($,g,z,O,f,Y,V){return $?kd($,g,z,O,f,Y,V):tk(Y,V)},createExtrusionModel:function(Z,U,r,J,O,e,$,t){return Ml(Z,U,r,J,O,e,$,t)},createSmoothRingModel:function(j,O,b,u,G,w){for(var t=[],c=0;c<j.length-1;c+=2)t.push({x:j[c],y:j[c+1]});for(j=sn(t,O,b)[0],t=[],c=0;c<j.length;c++){var A=j[c];t.push(new hh(A.x,0,A.y))}return Cm(new Bn(t,w,u,G))},createTextGeometry:function(G,N){return Cm(new Vm(G,N))},loadFontFace:function(s,_){O.xhrLoad(s,function(t){if(!t)return _();var o;try{o=JSON.parse(t)}catch(R){o=JSON.parse(t.substring(65,t.length-2))}vc.loadFace(o),_&&_(o.familyName.toLowerCase())},_?null:{sync:!0})},createRingModel:function(B,r,u,q,X,H,E,V,K,Z){for(var P=[],k=0;k<B.length-1;k+=2)P.push({x:B[k],y:B[k+1]});H=H||O.shapeSide,E=E||0,V=V||H;var T,m,l,D,F,Y,Q,v,J,d,k,i,$,f,S,t,s,N,o=[],h=[],I=K?[]:A,j=K?[]:A,L=Z?[]:A,G=Z?[]:A,c=q?[]:A,C=q?[]:A,w=X?[]:A,g=X?[]:A,B=sn(P,r,u),R=Do(B),b=0,_=2*Math.PI/H;return B.forEach(function(O){if(l=O.length,l>1){if(D=O[0],q)for(Y=D.x,v=D.y,k=E;V>k;k++)i=k+1,$=k*_,f=i*_,S=W($),t=n($),s=W(f),N=n(f),c.push(S*Y,v,-t*Y,s*Y,v,-N*Y,0,v,0),C.push(.5-.5*S,.5-.5*t,.5-.5*s,.5-.5*N,.5,.5);for(d=0;l>d;d++){for(F=O[d],Y=D.x,Q=F.x,v=D.y,J=F.y,T=b/R,b+=Ng(D,F),m=b/R,k=E;V>k;k++)i=k+1,$=k*_,f=i*_,S=W($),t=n($),s=W(f),N=n(f),o.push(S*Q,J,-t*Q,s*Q,J,-N*Q,S*Y,v,-t*Y,s*Q,J,-N*Q,s*Y,v,-N*Y,S*Y,v,-t*Y),h.push(k/H,m,i/H,m,k/H,T,i/H,m,i/H,T,k/H,T),K&&k===E&&(I.push(0,v,0,0,J,0,S*Q,J,-t*Q,S*Q,J,-t*Q,S*Y,v,-t*Y,0,v,0),j.push(0,.5-v,0,.5-J,2*Q,.5-J,2*Q,.5-J,2*Y,.5-v,0,.5-v)),Z&&i===V&&(L.push(0,v,0,s*Q,J,-N*Q,0,J,0,s*Q,J,-N*Q,0,v,0,s*Y,v,-N*Y),G.push(1,.5-v,1-2*Q,.5-J,1,.5-J,1-2*Q,.5-J,1,.5-v,1-2*Y,.5-v));D=F}if(X)for(Y=D.x,v=D.y,k=E;V>k;k++)i=k+1,$=k*_,f=i*_,S=W($),t=n($),s=W(f),N=n(f),w.push(s*Y,v,-N*Y,S*Y,v,-t*Y,0,v,0),g.push(.5-.5*s,.5+.5*N,.5-.5*S,.5+.5*t,.5,.5)}}),{vs:o,uv:h,bottom_vs:w,bottom_uv:g,top_vs:c,top_uv:C,from_vs:I,from_uv:j,to_vs:L,to_uv:G}}},!0),kk(K,{"3d.move.mode":m,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":m,"edge.gradient.color":m,"edge.source.t3":m,"edge.target.t3":m,"light.type":xf,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":s/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":dg,"wf.short":!1,"wf.mat":m,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:m,"transparent.mask":!1,brightness:m,"select.brightness":.7,"repeat.uv.length":m,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Jn,"label.t3":m,"label.r3":m,"label.texture.scale":2,"label.rotationMode":vk,"label.light":!1,"label.blend":m,"label.reverse.flip":!1,"label.reverse.color":Gr,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Jn,"label2.t3":m,"label2.r3":m,"label2.texture.scale":2,"label2.rotationMode":vk,"label2.light":!1,"label2.blend":m,"label2.reverse.flip":!1,"label2.reverse.color":Gr,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Jn,"note.t3":m,"note.r3":m,"note.texture.scale":2,"note.rotationMode":vk,"note.light":!1,"note.blend":m,"note.reverse.flip":!1,"note.reverse.color":Gr,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Jn,"note2.t3":m,"note2.r3":m,"note2.texture.scale":2,"note2.rotationMode":vk,"note2.light":!1,"note2.blend":m,"note2.reverse.flip":!1,"note2.reverse.color":Gr,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:m,"shape3d.color":rc,"shape3d.top.color":m,"shape3d.bottom.color":m,"shape3d.from.color":m,"shape3d.to.color":m,"shape3d.image":m,"shape3d.top.image":m,"shape3d.bottom.image":m,"shape3d.from.image":m,"shape3d.to.image":m,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":m,"shape3d.side.to":m,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":m,"shape3d.opacity":m,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Gr,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":m,"shape3d.uv.scale":m,"shape3d.top.uv.offset":m,"shape3d.top.uv.scale":m,"shape3d.bottom.uv.offset":m,"shape3d.bottom.uv.scale":m,"shape3d.from.uv.offset":m,"shape3d.from.uv.scale":m,"shape3d.to.uv.offset":m,"shape3d.to.uv.scale":m,"shape3d.top.cap":m,"shape3d.bottom.cap":m,"shape3d.start.angle":0,"shape3d.sweep.angle":H,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":m,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":rc,"all.image":m,"all.blend":m,"all.opacity":m,"all.reverse.flip":!1,"all.reverse.color":Gr,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":m,"all.uv.offset":m,"all.uv.scale":m,"all.discard.selectable":!0,mat:m,"left.mat":m,"right.mat":m,"top.mat":m,"bottom.mat":m,"front.mat":m,"back.mat":m},!0);var kr,Em=!1,fk=[0,0,0,0],ln={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:zd,2:Nl,3:kq,4:Ud,5:Jn,6:rd}},ap=function(J,E,r,U){if(E.getFaceVisible(J,r)){xm(E,Vl(J,E.getFaceMat(J,r)||E.getMat(J)));var z=E._26I;E.getFaceReverseCull(J,r)?z.enable(z.CULL_FACE):z.disable(z.CULL_FACE),ob(z,E._prg.uFixPickReverseColor,ln[r]),wd(z),ol(z,U,6),Oo(z),Lq(E)}},dd=function(p){return p instanceof ml},Sf=function(D){return[D.x,D.e||0,D.y]},Eh=function(V,D,E){for(var D=Ke(D),Q=D[0],f=D[1],B=D[2];E--;)V.push(Q,f,B)},tr=function(r,b,w){for(var b=Ke(b),Z=b[0],$=b[1],Q=b[2],c=b[3];w--;)r.push(Z,$,Q,c)},nb=function(_,J,H){if(J)for(var x,n,O,N=J[0],P=J[1],l=J[2],k=J[4],C=J[5],d=J[6],S=J[8],y=J[9],Q=J[10],e=J[12],R=J[13],g=J[14],U=H.length,L=0,L=0;U>L;L+=3)x=H[L],n=H[L+1],O=H[L+2],_.push(N*x+k*n+S*O+e,P*x+C*n+y*O+R,l*x+d*n+Q*O+g);else hk(_,H)},Er=function(y,W){var D=W.s("light.intensity"),C=Ke(W.s(Bj)),T=C[0],i=C[1],Y=C[2];1!==D&&(T*=D,i*=D,Y*=D),y.push(T,i,Y,W.s("light.disabled")?1:0)},br=function(K,E,Q){ob(E,Q.uHeadlightRange,K._headlightRange);var H=K._headlightIntensity,A=Ke(K._headlightColor);1!==H&&(A=[A[0]*H,A[1]*H,A[2]*H]),ob(E,Q.uHeadlightColor,[A[0],A[1],A[2],K._headlightDisabled?1:0]);var _=K._59O,C=K._spots,F=K._dirs;if(_.length){var N=[],h=[],j=[];_.forEach(function(I){Er(N,I),hk(h,K._transformPointToViewSpace(I.p3())),j.push(I.s("light.range"))}),E.uniform4fv(Q.uPointColor,N),E.uniform1fv(Q.uPointRange,j),E.uniform3fv(Q.uPointPosition,h)}if(C.length){var P=[],T=[],X=[],O=[],u=[],z=[];C.forEach(function(S){Er(P,S),hk(T,K._transformPointToViewSpace(S.p3())),hk(u,K._transformDirectionToViewSpace(S.p3(),S.s("light.center"))),X.push(S.s("light.range")),O.push(W(S.s("light.angle")/2)),z.push(S.s("light.exponent"))}),E.uniform4fv(Q.uSpotColor,P),E.uniform1fv(Q.uSpotRange,X),E.uniform1fv(Q.uSpotAngle,O),E.uniform1fv(Q.uSpotExponent,z),E.uniform3fv(Q.uSpotPosition,T),E.uniform3fv(Q.uSpotDirection,u)}if(F.length){var q=[],t=[];F.forEach(function(X){Er(q,X),hk(t,K._transformDirectionToViewSpace(X.p3()))}),E.uniform4fv(Q.uDirColor,q),E.uniform3fv(Q.uDirDirection,t)}},ug=function(K){return K>0&&0===(K-1&K)},Am=function(C){return C=$(0,Y(s,C)),C=$(Kg,Y(s-Kg,C))},Wh=function(){return.05+w()/2},Kp=function(z,T,M,d){var N,U=z.getEye();return z.isOrtho()?(N=Dg(z.getCenter(),U),N[0]+=d[0],N[1]+=d[1],N[2]+=d[2]):N=U,$k(T,M,d,N)},$k=function(g,i,f,e){var I=vg(g,i),E=Dg(e,f,!0),k=vg(E,i);if(G(k)<Kg)return A;var Y=(I-vg(f,i))/k;return[f[0]+E[0]*Y,f[1]+E[1]*Y,f[2]+E[2]*Y]},yb=function(b,h){return{x:2*b.x-h.x,y:2*b.y-h.y}},ih=function(p,f,t,s){var i,e;if(!p)return i=b(f.y-t.y,t.x-f.x),{x:f.x+s*n(i),y:f.y+s*W(i)};if(!t)return i=b(p.y-f.y,f.x-p.x),{x:f.x+s*n(i),y:f.y+s*W(i)};var Y=Dg([p.x,p.y,0],[f.x,f.y,0],!0),O=Dg([t.x,t.y,0],[f.x,f.y,0],!0),Q=-(Y[0]+O[0])/2,u=-(Y[1]+O[1])/2,l=r(Q*Q+u*u);if(Kg>l)return i=b(p.y-f.y,f.x-p.x),{x:f.x+s*n(i),y:f.y+s*W(i)};var h=p.x-f.x,V=p.y-f.y,G=t.x-f.x,F=t.y-f.y,U=r(h*h+V*V),B=r(G*G+F*F);i=y(vg(Y,O))/2,e=Y[1]*O[0]-Y[0]*O[1]>0?-1:1,Q/=l,u/=l;var J=s/n(i),j=$(U,B)/W(i);l=Math.min(J,j);var v={x:f.x+e*l*Q,y:f.y+e*l*u};return t.b&&J>B/W(i)&&(v.adjust=!0),v},Qj=function(m){var T=m[1],E=m[2],s=m[3],n=m[6],F=m[7],Z=m[11];m[1]=m[4],m[2]=m[8],m[3]=m[12],m[4]=T,m[6]=m[9],m[7]=m[13],m[8]=E,m[9]=n,m[11]=m[14],m[12]=s,m[13]=F,m[14]=Z},uo=function(v){var p=v[0],o=v[1],N=v[2],B=v[3],M=v[4],I=v[5],e=v[6],y=v[7],S=v[8],Z=v[9],R=v[10],D=v[11],h=v[12],z=v[13],x=v[14],P=v[15],t=p*I-o*M,j=p*e-N*M,O=p*y-B*M,s=o*e-N*I,l=o*y-B*I,g=N*y-B*e,C=S*z-Z*h,V=S*x-R*h,r=S*P-D*h,u=Z*x-R*z,b=Z*P-D*z,Y=R*P-D*x,f=t*Y-j*b+O*u+s*r-l*V+g*C;return f?(f=1/f,v[0]=(I*Y-e*b+y*u)*f,v[1]=(N*b-o*Y-B*u)*f,v[2]=(z*g-x*l+P*s)*f,v[3]=(R*l-Z*g-D*s)*f,v[4]=(e*r-M*Y-y*V)*f,v[5]=(p*Y-N*r+B*V)*f,v[6]=(x*O-h*g-P*j)*f,v[7]=(S*g-R*O+D*j)*f,v[8]=(M*b-I*r+y*C)*f,v[9]=(o*r-p*b-B*C)*f,v[10]=(h*l-z*O+P*t)*f,v[11]=(Z*O-S*l-D*t)*f,v[12]=(I*V-M*u-e*C)*f,v[13]=(p*u-o*V+N*C)*f,v[14]=(z*j-h*s-x*t)*f,v[15]=(S*s-Z*j+R*t)*f,void 0):A},io=function(u,c){if(c){var B=c[0],z=c[1],R=c[2];u[12]=u[0]*B+u[4]*z+u[8]*R+u[12],u[13]=u[1]*B+u[5]*z+u[9]*R+u[13],u[14]=u[2]*B+u[6]*z+u[10]*R+u[14],u[15]=u[3]*B+u[7]*z+u[11]*R+u[15]}},Qg=function(D,z){if(z){var X=z[0],m=z[1],x=z[2];D[0]=D[0]*X,D[1]=D[1]*X,D[2]=D[2]*X,D[3]=D[3]*X,D[4]=D[4]*m,D[5]=D[5]*m,D[6]=D[6]*m,D[7]=D[7]*m,D[8]=D[8]*x,D[9]=D[9]*x,D[10]=D[10]*x,D[11]=D[11]*x}},Zh=function(_,i,U){var t=i[0],u=i[1],e=i[2],h=i[3],W=i[4],O=i[5],H=i[6],R=i[7],J=i[8],p=i[9],K=i[10],c=i[11],v=i[12],C=i[13],$=i[14],S=i[15],b=U[0],y=U[1],G=U[2],P=U[3];return _[0]=b*t+y*W+G*J+P*v,_[1]=b*u+y*O+G*p+P*C,_[2]=b*e+y*H+G*K+P*$,_[3]=b*h+y*R+G*c+P*S,b=U[4],y=U[5],G=U[6],P=U[7],_[4]=b*t+y*W+G*J+P*v,_[5]=b*u+y*O+G*p+P*C,_[6]=b*e+y*H+G*K+P*$,_[7]=b*h+y*R+G*c+P*S,b=U[8],y=U[9],G=U[10],P=U[11],_[8]=b*t+y*W+G*J+P*v,_[9]=b*u+y*O+G*p+P*C,_[10]=b*e+y*H+G*K+P*$,_[11]=b*h+y*R+G*c+P*S,b=U[12],y=U[13],G=U[14],P=U[15],_[12]=b*t+y*W+G*J+P*v,_[13]=b*u+y*O+G*p+P*C,_[14]=b*e+y*H+G*K+P*$,_[15]=b*h+y*R+G*c+P*S,_},wm=function(B,W,Y,A){var l,a,d,N,D,H,b,P,p,k,g=W[0],n=W[1],L=W[2],x=A[0],M=A[1],U=A[2],w=Y[0],y=Y[1],S=Y[2];return G(g-w)<Kg&&G(n-y)<Kg&&G(L-S)<Kg?$h(B):(b=g-w,P=n-y,p=L-S,k=1/r(b*b+P*P+p*p),b*=k,P*=k,p*=k,l=M*p-U*P,a=U*b-x*p,d=x*P-M*b,k=r(l*l+a*a+d*d),k?(k=1/k,l*=k,a*=k,d*=k):(l=0,a=0,d=0),N=P*d-p*a,D=p*l-b*d,H=b*a-P*l,k=r(N*N+D*D+H*H),k?(k=1/k,N*=k,D*=k,H*=k):(N=0,D=0,H=0),B[0]=l,B[1]=N,B[2]=b,B[3]=0,B[4]=a,B[5]=D,B[6]=P,B[7]=0,B[8]=d,B[9]=H,B[10]=p,B[11]=0,B[12]=-(l*g+a*n+d*L),B[13]=-(N*g+D*n+H*L),B[14]=-(b*g+P*n+p*L),B[15]=1,B)},ci=function(Y,P,s,a,R){var I=1/k(P/2),v=1/(a-R);return Y[0]=I/s,Y[1]=0,Y[2]=0,Y[3]=0,Y[4]=0,Y[5]=I,Y[6]=0,Y[7]=0,Y[8]=0,Y[9]=0,Y[10]=(R+a)*v,Y[11]=-1,Y[12]=0,Y[13]=0,Y[14]=2*R*a*v,Y[15]=0,Y},md=function(v,_,V,y,F,k,Z){var z=1/(_-V),D=1/(y-F),g=1/(k-Z);return v[0]=-2*z,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*D,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*g,v[11]=0,v[12]=(_+V)*z,v[13]=(F+y)*D,v[14]=(Z+k)*g,v[15]=1,v},zr=function(r,K){var T=K[0],q=K[1],n=K[2],u=K[3],j=T*T+q*q+n*n+u*u,c=j?1/j:0;return r[0]=-T*c,r[1]=-q*c,r[2]=-n*c,r[3]=u*c,r},Zf=function(O,e){var r=e[0]+e[5]+e[10],f=0;return r>0?(f=2*Math.sqrt(r+1),O[3]=.25*f,O[0]=(e[6]-e[9])/f,O[1]=(e[8]-e[2])/f,O[2]=(e[1]-e[4])/f):e[0]>e[5]&e[0]>e[10]?(f=2*Math.sqrt(1+e[0]-e[5]-e[10]),O[3]=(e[6]-e[9])/f,O[0]=.25*f,O[1]=(e[1]+e[4])/f,O[2]=(e[8]+e[2])/f):e[5]>e[10]?(f=2*Math.sqrt(1+e[5]-e[0]-e[10]),O[3]=(e[8]-e[2])/f,O[0]=(e[1]+e[4])/f,O[1]=.25*f,O[2]=(e[6]+e[9])/f):(f=2*Math.sqrt(1+e[10]-e[0]-e[5]),O[3]=(e[1]-e[4])/f,O[0]=(e[8]+e[2])/f,O[1]=(e[6]+e[9])/f,O[2]=.25*f),O},nd=function(h,n,z){var J=n[0],A=n[1],N=n[2],p=n[3],O=J+J,x=A+A,H=N+N,e=J*O,k=J*x,f=J*H,S=A*x,L=A*H,m=N*H,i=p*O,o=p*x,$=p*H;return h[0]=1-(S+m),h[1]=k+$,h[2]=f-o,h[3]=0,h[4]=k-$,h[5]=1-(e+m),h[6]=L+i,h[7]=0,h[8]=f+o,h[9]=L-i,h[10]=1-(e+S),h[11]=0,h[12]=z[0],h[13]=z[1],h[14]=z[2],h[15]=1,h},vn=function(V,C){if(V.vr.enable){var R=V.vr.getViewMatrix(C);if(R)return R}return wm(C?C:co(),V._eye,V._center,V._up)},yh=function(M,x){if(M.vr.enable){var V=M.vr.getProjectMatrix();if(V)return V}if(!x&&M._computedProjectMatrix)return Hn(M._computedProjectMatrix);var t=M.getAspect(),c=M._near,N=M._far,A=co();if(M._ortho){var U=M._orthoWidth/2,u=U/t;md(A,-U,U,-u,u,c,N)}else ci(A,M._fovy,t,c,N);return A},fi=function(U,P){if(!U)return A;var Q=0,L=1,F=2,I=[],K=0,k=U.length,z=k/3;if(P){for(;k>K;K++)I[K]=0;for(K=0;K<P.length;K+=3){var H=[],w=[],D=[];H[Q]=U[3*P[K+1]+Q]-U[3*P[K]+Q],H[L]=U[3*P[K+1]+L]-U[3*P[K]+L],H[F]=U[3*P[K+1]+F]-U[3*P[K]+F],w[Q]=U[3*P[K+2]+Q]-U[3*P[K+1]+Q],w[L]=U[3*P[K+2]+L]-U[3*P[K+1]+L],w[F]=U[3*P[K+2]+F]-U[3*P[K+1]+F],D[Q]=H[L]*w[F]-H[F]*w[L],D[L]=H[F]*w[Q]-H[Q]*w[F],D[F]=H[Q]*w[L]-H[L]*w[Q];for(var o=0;3>o;o++)I[3*P[K+o]+Q]+=D[Q],I[3*P[K+o]+L]+=D[L],I[3*P[K+o]+F]+=D[F]}}else for(K=0;z>K;K+=3){var H=[],w=[],D=[];H[Q]=U[3*(K+1)+Q]-U[3*K+Q],H[L]=U[3*(K+1)+L]-U[3*K+L],H[F]=U[3*(K+1)+F]-U[3*K+F],w[Q]=U[3*(K+2)+Q]-U[3*(K+1)+Q],w[L]=U[3*(K+2)+L]-U[3*(K+1)+L],w[F]=U[3*(K+2)+F]-U[3*(K+1)+F],D[Q]=H[L]*w[F]-H[F]*w[L],D[L]=H[F]*w[Q]-H[Q]*w[F],D[F]=H[Q]*w[L]-H[L]*w[Q];for(var o=0;3>o;o++)I[3*(K+o)+Q]=D[Q],I[3*(K+o)+L]=D[L],I[3*(K+o)+F]=D[F]}for(K=0;k>K;K+=3){var t=[];t[Q]=I[K+Q],t[L]=I[K+L],t[F]=I[K+F];var s=r(t[Q]*t[Q]+t[L]*t[L]+t[F]*t[F]);0===s&&(s=Kg),t[Q]=t[Q]/s,t[L]=t[L]/s,t[F]=t[F]/s,I[K+Q]=t[Q],I[K+L]=t[L],I[K+F]=t[F]}return new cb(I)},jg=function(y,u,Q,P){if(Q||(Q=y.createTexture()),u){var U=y.TEXTURE_2D,t=y.REPEAT,q=y.CLAMP_TO_EDGE,X=y.TEXTURE_MIN_FILTER;P!==y.NEAREST&&(P=y.LINEAR),sk(y,Q),y.texImage2D(U,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,u),ik(y,y.TEXTURE_MAG_FILTER,P);var d=u.naturalWidth||u.width,z=u.naturalHeight||u.height;ug(d)&&ug(z)&&!u.clampToEdge?(ik(y,y.TEXTURE_WRAP_S,t),ik(y,y.TEXTURE_WRAP_T,t),ik(y,X,y.LINEAR_MIPMAP_LINEAR),y.generateMipmap(U)):(ik(y,y.TEXTURE_WRAP_S,q),ik(y,y.TEXTURE_WRAP_T,q),ik(y,X,P)),sk(y,A)}return Q},Bp=function(A,L){var E=new Uint8Array(4);return L=L||A.createTexture(),sk(A,L),ik(A,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,E),L},ym=function(L){L._26I&&L._prg&&(L._26I.deleteProgram(L._prg),L._prg=A)},Db=function(o,k,V,r){var H=o.createShader(V);return o.shaderSource(H,r),o.compileShader(H),o.attachShader(k,H),H},Wr=function(d){return d.createBuffer()},sk=function(z,S){z.bindTexture(z.TEXTURE_2D,S)},ik=function(Z,T,l){Z.texParameteri(Z.TEXTURE_2D,T,l)},Cj=function(W,m){W.enable(W.POLYGON_OFFSET_FILL),W.polygonOffset(m[0],m[1])},ks=function(R){R.disable(R.POLYGON_OFFSET_FILL)},om=function(t,Q){if(Q){var Q=Ke(Q);t.clearColor(Q[0],Q[1],Q[2],Q[3])}},bk=function(Z,j){ob(Z,j.uFix,!0),nk(Z,j.aNormal)},ee=function(K,m){ob(K,m.uFix,!1),mh(K,m.aNormal)},Pj=function(c,U,_,T,S,m,w,Q){c._picking||(_?(ob(c,U.uBlend,!0),ob(c,U.uBlendColor,_)):ob(c,U.uBlend,!1),ob(c,U.uLight,T==A?!0:T),Fb(S)&&1!==S&&ob(c,U.uPartOpacity,S),ob(c,U.uReverseFlip,m==A?!1:m),ob(c,U.uFixPickReverseColor,w||Gr)),Q?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE)},If=function(_,e){_._picking||ob(_,e.uPartOpacity,1)},wd=function(){var H=[0,0,1,1];return function(D,A,w,K,z,j,F,O,Z){return w?(ob(D,A.uTexture,!0),ob(D,A.uDiscardSelectable,hn(K)?K:!0),mh(D,A.aUv),zp(D,z,j,A.aUv,2),Z?(ob(D,A.uBlendTexture,!0),D.activeTexture(D.TEXTURE1),sk(D,Z),D.uniform1i(A.uBlendSampler,1)):(ob(D,A.uBlendTexture,!1),D.activeTexture(D.TEXTURE1),sk(D,D._emptyBlendTexture)),D.activeTexture(D.TEXTURE0),sk(D,w),D.uniform1i(A.uSampler,0),F?(H[0]=F[0],H[1]=F[1]):(H[0]=0,H[1]=0),O?(H[2]=O[0],H[3]=O[1]):(H[2]=1,H[3]=1),ob(D,A.uOffsetScale,H),void 0):(D.activeTexture(D.TEXTURE0),sk(D,D._emptyTexture),D.activeTexture(D.TEXTURE1),sk(D,D._emptyBlendTexture),void 0)}}(),Oo=function(q,v,U){q.activeTexture(q.TEXTURE0),sk(q,A),q.activeTexture(q.TEXTURE1),sk(q,A),U&&(nk(q,v.aUv),ob(q,v.uTexture,!1),ob(q,v.uBlendTexture,!1))},rn=function(N,t,e,f,J,L){!e||Oe||Md||N.lineWidth(e),f&&!N._picking&&ob(N,t.uFixPickReverseColor,f),J&&zp(N,J,L,t.aPosition)},Gh=function(H,L,u,f){kr&&(f=H[kr]),H.drawArrays(f==A?H.TRIANGLES:f,L,u);var g=H._renderInfo;g&&(g.calls++,g.vertices+=u,(f==A||f===H.TRIANGLES)&&(g.faces+=u/3),f===H.LINES&&(g.lines+=u/2))},ol=function(g,C,B,x){kr&&(x=g[kr]),g.drawElements(x==A?g.TRIANGLES:x,B,g.UNSIGNED_SHORT,C==A?0:2*C);var M=g._renderInfo;M&&(M.calls++,M.vertices+=B,(x==A||x===g.TRIANGLES)&&(M.faces+=B/3),x===g.LINES&&(M.lines+=B/2))},vm=function(d,o,E,y,O){var Q=d.ARRAY_BUFFER;d.bindBuffer(Q,o),E&&d.bufferData(Q,E,d.STATIC_DRAW),y!=A&&d.vertexAttribPointer(y,O?O:3,d.FLOAT,!1,0,0)},zp=function(N,X,D,F,K){return D?(gg(N,N.ARRAY_BUFFER,X,D),F!=A&&N.vertexAttribPointer(F,K?K:3,N.FLOAT,!1,0,0),void 0):vm(N,X,D,F,K)},Ie=function(Y,E,f){var j=Y.ELEMENT_ARRAY_BUFFER;Y.bindBuffer(j,E),f&&Y.bufferData(j,f,Y.STATIC_DRAW)},$q=function(j,a,d){gg(j,j.ELEMENT_ARRAY_BUFFER,a,d)},gg=function(e,q,M,h){var P=h._bufId;P||(P=h._bufId=f.Math.generateIncreasingID());var M,s=e._bufPool;(M=s[P])&&M._buf?e.bindBuffer(q,M._buf):(M=s[P]={_buf:Wr(e)},e.bindBuffer(q,M._buf),e.bufferData(q,h,e.STATIC_DRAW)),M._fid=e._renderInfo.frame},ob=function(P,K,Z){if(Z!=A&&K!=A){Z=Ke(Z);var N=Z.length;3===N?P.uniform3fv(K,Z):4===N?P.uniform4fv(K,Z):16===N?P.uniformMatrix4fv(K,!1,Z):hn(Z)?P.uniform1i(K,Z?1:0):2===N?P.uniform2fv(K,Z):P.uniform1f(K,Z)}},mh=function(b,K){K!=A&&K>=0&&b.enableVertexAttribArray(K)},nk=function(F,G){G!=A&&G>=0&&F.disableVertexAttribArray(G)},Lq=function(h,b){var e=h.getGL(),r=h._prg;h._7O=h._8O.pop(),b&&(ob(e,r.uMVMatrix,h._7O),h._6O=b,ob(e,r.uNMatrix,b))},_d=function(O,F){return F||(F=co()),zk(F,O),uo(F),Qj(F),F},xm=function(T,S){var i=T.getGL(),R=T._prg,g=T._7O;S&&(T._8O.push(Hn(g)),ob(i,R.uMMatrix,S),Zh(g,g,S),T._7O=g),ob(i,R.uMVMatrix,g),ob(i,R.uNMatrix,_d(g,T._6O))},gs=function(o,Z,d,R,x,W){if(d){if(R){var s=d.value++,C=2147483648|s,F=[(255&C>>16)/255,(255&C>>8)/255,(255&C)/255,(255&C>>24)/255];d[s]={data:x,part:W}}else F=fk;return ob(o,Z.uFixPickReverseColor,F),F}},cm=function(){var P={center:function(U,V,O,s,S){var C=-V[1]/2,r={x:-V[0]/2,y:C,width:V[0],height:V[1]},T=Ef(U,r,O);return[T.x+s,-T.y-S,Wh()]},front:function(V,N,L,p,M){var b=-N[1]/2,P={x:-N[0]/2,y:b,width:N[0],height:N[1]},z=Ef(V,P,L);return[z.x+p,-z.y-M,N[2]/2+Wh()]},back:function(O,t,s,q,E){var Q=-t[0]/2,b=-t[1]/2,D={x:Q,y:b,width:t[0],height:t[1]},u=Ef(O,D,s);return[-u.x-q,-u.y-E,-t[2]/2-Wh()]},left:function($,I,o,P,C){var f=-I[1]/2,H={x:-I[2]/2,y:f,width:I[2],height:I[1]},y=Ef($,H,o);return[-I[0]/2-Wh(),-y.y-C,y.x+P]},right:function(u,A,Q,m,C){var w=-A[2]/2,c=-A[1]/2,_={x:w,y:c,width:A[2],height:A[1]},H=Ef(u,_,Q);return[A[0]/2+Wh(),-H.y-C,-H.x-m]},top:function(s,p,m,P,O){var i={x:-p[0]/2,y:-p[2]/2,width:p[0],height:p[2]},D=Ef(s,i,m);return[D.x+P,p[1]/2+Wh(),D.y+O]},bottom:function(h,C,O,S,Z){var E=-C[2]/2,g={x:-C[0]/2,y:E,width:C[0],height:C[2]},v=Ef(h,g,O);return[v.x+S,-C[1]/2-Wh(),-v.y-Z]}};return function(f,O,I,E,J,w){return P[E](f,O,I,J||0,w||0)}}(),yg=function(Y,N,R,D,t,o,U,X,I,G){if(t&&(N[0]+=t[0],N[1]+=t[1],N[2]+=t[2]),io(Y,R),X){var Q=co();if(Ac(Q,I,G),li(N,Q),io(Y,N),Y.auto=X,Y.pos=li([0,0,0],Y),o){var _=Y.mat2=co();Ac(_,o,U)}}else Ac(Y,I,G),io(Y,N),D===zd?Vk(Y,-Z):D===Nl?Vk(Y,Z):D===kq?$b(Y,-Z):D===Ud?$b(Y,Z):D===rd&&Vk(Y,s),Ac(Y,o,U);return Y},Li=function(E,r){var K=r.auto,T=r.mat2,g=E.gv;if(K){var f,k=co(),l=[0,0,0,0];f="string"==typeof K?[K.indexOf("x")<0?g._eye[0]:g._center[0],K.indexOf("y")<0?g._eye[1]:g._center[1],K.indexOf("z")<0?g._eye[2]:g._center[2]]:g._eye,Zf(l,wm(co(),f,g._center,g._up)),nd(k,zr(l,l),r.pos),T&&Zh(k,k,T),xm(g,k)}else xm(g,r)},rk=function(e,j,P,T,u){var b=e.s,I=e.gv,G=I.getGL(),D=I._prg,_=I._buffer,z=I._1O;jg(G,Le,z),Li(e,P),Pj(G,D,b(j+".blend"),b(j+".light"),b(j+".opacity"),b(j+".reverse.flip"),b(j+".reverse.color"),b(j+".reverse.cull")),wd(G,D,z,u,_.uv,Rb),zp(G,_.vs,T,D.aPosition),zp(G,_.ns,lp,D.aNormal),$q(G,_.is,Wf),ol(G,0,Wf.length),Oo(G,D,z),If(G,D),Lq(I)},fj=function(f,J,H){var n=f.gv,$=f.data,X=f[J]={blend:n.getBodyColor($)||n.getFaceBlend($,J),light:n.getFaceLight($,J),color:n.getFaceColor($,J),opacity:n.getFaceOpacity($,J),transparent:n.getFaceTransparent($,J),reverseFlip:n.getFaceReverseFlip($,J),reverseColor:n.getFaceReverseColor($,J),reverseCull:n.getFaceReverseCull($,J),texture:n.getFaceImage($,J),blendTexture:n.getFaceBlendImage($,J),discardSelectable:n.getFaceDiscardSelectable($,J)};if("csg"!==J){X.uv=n.getFaceUv($,J)||H&&H[J+"Uv"],X.uvScale=n.getFaceUvScale($,J)||H&&H[J+"UvScale"],X.uvOffset=n.getFaceUvOffset($,J)||H&&H[J+"UvOffset"];var b=n.getFaceMat($,J);b&&(X.mat=Vl($,b))}return X},fd=function(D,I,T,v,b){if(v){if(!b(v.transparent))return;var m=D.data,V=D.gv,J=V._buffer,Q=V.getTexture(v.texture,m),l=V.getTexture(v.blendTexture,m);wd(I,T,Q,v.discardSelectable,J.uv,v.tuv,v.uvOffset,v.uvScale,l),Pj(I,T,v.blend,v.light,v.opacity,v.reverseFlip,v.reverseColor,v.reverseCull),ob(I,T.uDiffuse,v.color||K["color.empty"]),zp(I,J.vs,v.vs,T.aPosition),zp(I,J.ns,v.ns,T.aNormal),Gh(I,0,v.vs.length/3),If(I,T),Oo(I,T,Q)}},eh=function(i,s,d,v,w,P){var f,t,D,V,r,k,T,K,G,z,m,R=[v-s,w-d],n=i?i.length:0;for(D=0;n>D;D++){for(V=2,f=i[D],r=f[0],k=f[1];V+1<f.length;){if(T=f[V],K=f[V+1],t=Qo(s,d,v,w,r,k,T,K,!0)){G=[T-r,K-k],z=Ng(G),G[0]/=z,G[1]/=z,z=vg(R,G),z=z>0?P:-P,m=[G[0]*z,G[1]*z];break}r=T,k=K,V+=2}if(m)break}if(m)for(v=s+m[0],w=d+m[1],D=0;n>D;D++)for(V=2,f=i[D],r=f[0],k=f[1];V+1<f.length;){if(T=f[V],K=f[V+1],t=Qo(s,d,v,w,r,k,T,K,!0))return[0,0];r=T,k=K,V+=2}return m?m:[v-s,w-d]},rp=f.graph3d={},gq=function(Y,p,z){Bg(V+".graph3d."+Y,p,z)},Ye="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",pn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
kk(O,{setBatchInfo:function(U,g){on[U]=g},getBatchInfo:function(R){return on[R]}},!0);var Nd=[1,1,1],gd=[1,0,0,0,0,1,0,1,1,1,1,0],El=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],oc=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Xo=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],bn=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Ch=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Bc=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],fn=function(t,v){_n(t,v,"_batchModelMap","_batchIndexMap"),Yn(t,v,"_wireframeModelMap","_wireframeIndexMap"),Yn(t,v,"_polylineModelMap","_polylineIndexMap"),Yn(t,v,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Yn(t,v,"_polylineModelMapSwap","_polylineIndexMapSwap")},_n=function(X,J,M,_){if(!J)return X[M]={},X[_]={},void 0;var I=J._id,L=X[_],j=L[I];if(j){var w=X[M],F=j.batch,C=w[F],E=C.ds,n=j.index;if(C.invalidate=!0,delete L[I],E.splice(n,1),oe(E))return delete w[F],void 0;for(var Z=j.begin,g=j.size,G=3*Z,t=3*g,$=4*Z,k=4*g,r=C.vs,P=C.ps,v=C.uv,i=C.cs,S=C.bs,H=C.rs,U=C.ns,l=C.ls;n<E.length;n++)j=L[E[n]._id],j.index--,j.begin-=g;r.splice(G,t),P.splice($,k),v&&v.splice(2*Z,2*g),i&&i.splice($,k),S&&S.splice(G,t),H&&H.splice(Z,g),U&&U.splice(G,t),l&&l.splice(Z,g)}},Yn=_n,Om=function(G,d,U,g){if(!g)return A;var H=d[g];if(!H){var c=on[g]||Zl,E=c.image?[]:A;H=d[g]={vs:[],ns:[],uv:E,cs:E?A:c.color?A:[],bs:c.blend?[]:A,ps:[],rs:c.brightness?[]:A,ds:[]}}return H.invalidate=!0,G[U._id]={index:H.ds.length,begin:H.vs.length/3,batch:g},H.ds.push(U),H},Mo=function(I,S){return S!=A&&1!==S?[I[0]*S,I[1]*S,I[2]*S,I[3]]:I},bc=function(){var H;return function(F,I,s){var d=F.getData3dUI(I),u=d.shapeModel;u||(u=Qi(d));var i,E=I.s("wf.combineTriangle");if(s.geometry){if(!u&&(I instanceof f.Node&&!(I instanceof f.Shape)?(H||(H={vs:Mg,is:Io,uv:_g}),u=H):u=[d.left,d.front,d.right,d.back,d.top,d.bottom],!u))return m;if(E?(E=0|Math.min(3,Math.max(1,isNaN(E)?1:E)),i=Xr[E-1](u)):i=sl(u),!i||0===i.length)return}else i=s.short?Gb:Vf;var z=F.getBrightness(I),K=Ke(s.color||"white"),g=K[3]<1,k=Math.ceil(s.width)||1,y=(g?"T":"O")+k,U=F._wireframeIndexMap,Z=F._wireframeModelMap,e=Z[y];e||(e=Z[y]={vs:[],cs:[],ps:[],ds:[],T:g,W:k}),e.invalidate=!0;var Q=e.vs,w=e.cs,R=e.ds,t=U[I._id]={index:R.length,begin:Q.length/3,batch:y};R.push(I);var n=d.mat;if(!n){n=Vl(I,s.mat);var W=d._calcAnchorMat(I);W&&Zh(n,n,W)}nb(Q,n,i);var q=t.size=Q.length/3-t.begin;tr(w,Mo(K,z),q)}}(),En=function(p,i,D,N,L,v,u,n,U){var h=p.getBrightness(i);h==A&&(h=1);var E=Mo(Ke(N),h),$=E[3]<1;v=Math.ceil(v)||1;var t=($?"T":"O")+v;if(u){var c=u[0],W=(u[1]||c)+c;t+="-"+c+"-"+W,U&&(t+="-"+en(U)+"-"+h,U=Mo(Ke(U),h))}var C=p._polylineIndexMap,z=p._polylineModelMap,X=z[t];X||(X=z[t]={vs:[],cs:[],ps:[],ds:[],ls:u?[]:A,T:$,W:v},u&&(X.D=c,X.G=W,X.A=U)),X.invalidate=!0;var b,Y=X.vs,S=X.cs,_=X.ds,o=X.ls,F=C[i._id]={index:_.length,begin:Y.length/3,batch:t};_.push(i),hk(Y,D);var w,e=F.size=Y.length/3-F.begin,V=D.length,m=0,f=[];if(u||L)for(b=0;V>b;b+=6)w=Ng([D[b],D[b+1],D[b+2]],[D[b+3],D[b+4],D[b+5]]),f.push(w),m+=w;if(m&&L){var r,M=Mo(Ke(L),h),T=[M[0]-E[0],M[1]-E[1],M[2]-E[2],M[3]-E[3]],j=0;for(b=0;V>b;b+=6)r=j/m,tr(S,[E[0]+T[0]*r,E[1]+T[1]*r,E[2]+T[2]*r,E[3]+T[3]*r],1),j+=f[b/6],r=j/m,tr(S,[E[0]+T[0]*r,E[1]+T[1]*r,E[2]+T[2]*r,E[3]+T[3]*r],1)}else tr(S,E,e);if(u)for(j=n||0,b=0;V>b;b+=6)o.push(j),j+=f[b/6],o.push(j)},Tm=function(R,S,N){if(S)for(var H=4*S.begin,q=N[S.batch].ps,T=0;T<S.size;T++)q[H++]=R[0],q[H++]=R[1],q[H++]=R[2],q[H++]=R[3]},Cq=function(N,K){var W=K+["32"],a=N[K],z=N[W];a?z&&z.length===a.length?(z.set(a),z._bufId=null):N[W]=new cb(a):delete N[W]},gb=function(I,$,d,p,l,H,Y,q,G){if(Nq(d))d.forEach(function(T){gb(I,$,T,p,l,H,Y,q,G)});else if(xr(d))gb(I,$,Qi(p,d),p,l,H,Y,q,G);else if(Bq(d)){var k,C=Ti(d.mat,$,I),J=Ti(d.s3,$,I),U=Ti(d.t3,$,I),X=Ti(d.r3,$,I);if((J||X||U||C)&&(k=Hp(C,J,X,Ti(d.rotationMode,$,I),U),H.push(k)),d.shape3d)gb(I,$,d.shape3d,p,l,H,Y,q,d);else{var Z=p.s;G=G||Zl;var P=H[0],S=H.length,g=Z("shape3d.color",d.color,G.color);if(l||(l=Z("shape3d.blend",d.blend,G.blend)),S>1){P=Hn(P);for(var e=1;S>e;e++)Zh(P,P,H[e])}d.vs&&Z(Gg,d.visible,G.visible)&&pc(P,Y,q,d.vs,d.uv,d.is,l,g),d.top_vs&&Z(xd,d.topVisible,G.topVisible)&&pc(P,Y,q,d.top_vs,d.top_uv,d.top_is,l,Z("shape3d.top.color",d.topColor,G.topColor)||g),d.bottom_vs&&Z(Xg,d.bottomVisible,G.bottomVisible)&&pc(P,Y,q,d.bottom_vs,d.bottom_uv,d.bottom_is,l,Z("shape3d.bottom.color",d.bottomColor,G.bottomColor)||g),d.from_vs&&Z(ar,d.fromVisible,G.fromVisible)&&pc(P,Y,q,d.from_vs,d.from_uv,d.from_is,l,Z("shape3d.from.color",d.fromColor,G.fromColor)||g),d.to_vs&&Z(Yf,d.toVisible,G.toVisible)&&pc(P,Y,q,d.to_vs,d.to_uv,d.to_is,l,Z("shape3d.to.color",d.toColor,G.toColor)||g)}k&&H.pop()}},pc=function(E,S,h,b,L,p,N,x){var Q,r=S.cs,l=S.uv,w=S.bs;if(p){Q=p.length;for(var G=0;Q>G;G++){var g=p[G];nb(h,E,[b[3*g],b[3*g+1],b[3*g+2]]),l&&hk(l,[L[2*g],L[2*g+1]])}}else Q=b.length/3,nb(h,E,b),l&&hk(l,L);r&&tr(r,x,Q),w&&(N?Eh(w,N,Q):hk(w,Nd,Q))},Wc=function(u,K,v,l){var p=[];l?gb(u.gv,u.data,l,u,u.getBodyColor(),[K],v,p):(qi(u,zd,K,v,p),qi(u,Nl,K,v,p),qi(u,Jn,K,v,p),qi(u,rd,K,v,p),qi(u,kq,K,v,p),qi(u,Ud,K,v,p),qi(u,"csg",K,v,p)),p.length&&(hk(v.vs,p),hk(v.ns,fi(p)))},qi=function(T,e,x,F,h){var X=T[e];if(X){var o=X.tuv;if(o){var U,E,c,H,i=X.uvScale,N=X.uvOffset;if(i)for(U=o.length,E=i[0],c=i[1],H=0;U>H;H+=2)o[H]*=E,o[H+1]*=c;if(N)for(U=o.length,E=N[0],c=N[1],H=0;U>H;H+=2)o[H]+=E,o[H+1]+=c}pc(x,F,h,X.vs,o,A,X.blend,X.color)}},Ul=function(u,v,o,K,Y,F,l,T){var x,f=o.cs,G=o.uv,q=o.bs;if(u.getFaceVisible(v,F)){var y=u.getFaceMat(v,F);if(y&&(Y=Vl(v,y)),nb(l,Y,T),f&&tr(f,u.getFaceColor(v,F),6),G){var Z=u.getFaceUv(v,F)||K[F+"Uv"],_=u.getFaceUvScale(v,F)||K[F+"UvScale"],b=u.getFaceUvOffset(v,F)||K[F+"UvOffset"];Z=Z?[Z[6],Z[7],Z[0],Z[1],Z[2],Z[3],Z[2],Z[3],Z[4],Z[5],Z[6],Z[7]]:gd;var d=Z[0],j=Z[1],r=Z[2],V=Z[3],g=Z[4],O=Z[5],L=Z[6],N=Z[7],J=Z[8],$=Z[9],z=Z[10],E=Z[11];if(_){var S=_[0],C=_[1];d*=S,j*=C,r*=S,V*=C,g*=S,O*=C,L*=S,N*=C,J*=S,$*=C,z*=S,E*=C}if(b){var m=b[0],p=b[1];d+=m,j+=p,r+=m,V+=p,g+=m,O+=p,L+=m,N+=p,J+=m,$+=p,z+=m,E+=p}G.push(d,j,r,V,g,O,L,N,J,$,z,E)}q&&(x=u.getBodyColor(v)||u.getFaceBlend(v,F),x?Eh(q,x,6):hk(q,Nd,6))}},rl=function(h,G,d,J){var l=h.getGL(),Y=h._prg,w=h._buffer;if(!h.drawFilter&&!Lc(G)){xm(h),bk(l,Y);for(var E in G){var B=G[E];if(!(J&&!B.T||!J&&B.T)){B.invalidate?(B.invalidate=!1,Cq(B,"vs"),Cq(B,"cs"),Cq(B,"ls"),Cq(B,"ps")):d&&Cq(B,"ps");var Q=B.vs32,S=d?B.ps32:B.cs32;rn(l,Y,B.W,A,w.vs,Q);var v=B.D,p=!h._dashDisabled&&v;ob(l,Y.uAlphaTest,K.alphaTest),p&&(ob(l,Y.uDash,!0),ob(l,Y.uDashDistance,v),ob(l,Y.uDashGapDistance,B.G),mh(l,Y.aLineDistance),zp(l,w.lineDistance,B.ls32,Y.aLineDistance,1),ob(l,Y.uDiffuse,B.A||K["color.empty"]));var D=!h._batchColorDisabled;D&&(ob(l,Y.uBatchColor,!0),mh(l,Y.aBatchColor),zp(l,w.batchColor,S,Y.aBatchColor,4)),wd(l),Gh(l,0,Q.length/3,l.LINES),Oo(l),D&&(ob(l,Y.uBatchColor,!1),nk(l,Y.aBatchColor)),p&&(ob(l,Y.uDash,!1),nk(l,Y.aLineDistance))}}ee(l,Y)}},sf=function(d,w,X){var L,S,$,B,M,c,f,k,J,G,n,N=d.getGL(),v=d._prg,u=d._buffer,r=d._batchModelMap;if(!Lc(r)){xm(d);for(L in r)if(S=on[L]||Zl,!(X&&!S.transparent||!X&&S.transparent)&&($=r[L],w||!S.transparentMask)){var W=X&&S.autoSort!==!1&&(d._33Q||$.invalidate);if($.invalidate?($.invalidate=!1,Cq($,"vs"),Cq($,"ns"),Cq($,"cs"),Cq($,"rs"),Cq($,"ps"),Cq($,"bs"),Cq($,"uv")):w&&Cq($,"ps"),M=$.vs32,c=w?$.ps32:$.cs32,J=$.uv32,f=$.bs32,k=$.rs32,n=M.length/3,W&&($.is=qp(M,d.getEye())),n){B=S.light,G=d.getTexture(S.image),Pj(N,v,A,S.light,S.opacity,S.reverseFlip,S.reverseColor,S.reverseCull),c?d._batchColorDisabled||(ob(N,v.uBatchColor,!0),mh(N,v.aBatchColor),zp(N,u.batchColor,c,v.aBatchColor,4)):ob(N,v.uDiffuse,S.color||K["color.empty"]);var Q=S.alphaTest;ob(N,v.uAlphaTest,Q===m?K.alphaTest:Q),S.envmap!==m?(ob(N,v.uUseEnvMap,!0),ob(N,v.uReflectivity,S.envmap)):(ob(N,v.uUseEnvMap,!1),ob(N,v.uReflectivity,0));var T=f&&!d._batchBlendDisabled;T&&(ob(N,v.uBatchBlend,!0),mh(N,v.aBatchBlend),zp(N,u.batchBlend,f,v.aBatchBlend));var p=k&&!d._batchBrightnessDisabled;p&&(ob(N,v.uBatchBrightness,!0),mh(N,v.aBatchBrightness),zp(N,u.batchBrightness,k,v.aBatchBrightness,1)),J?wd(N,v,G,S.discardSelectable,u.uv,J,S.uvOffset,S.uvScale):wd(N),zp(N,u.vs,M,v.aPosition),zp(N,u.ns,$.ns32,v.aNormal),$.is?(Ie(N,u.is,$.is),ol(N,0,n)):Gh(N,0,n),J?Oo(N,v,G):Oo(N),c&&!d._batchColorDisabled&&(ob(N,v.uBatchColor,!1),nk(N,v.aBatchColor)),T&&(ob(N,v.uBatchBlend,!1),nk(N,v.aBatchBlend)),p&&(ob(N,v.uBatchBrightness,!1),nk(N,v.aBatchBrightness)),If(N,v)}}}},qp=function($,h){for(var y=$.length/3,f=new Array(y),J=y/3,a=new Array(J),W=0;J>W;W++)a[W]=W;a.sort(function(X,y){var g=9*X,m=[($[g]+$[g+3]+2*$[g+6])/4,($[g+1]+$[g+4]+2*$[g+7])/4,($[g+2]+$[g+5]+2*$[g+8])/4];g=9*y;var f=[($[g]+$[g+3]+2*$[g+6])/4,($[g+1]+$[g+4]+2*$[g+7])/4,($[g+2]+$[g+5]+2*$[g+8])/4],e=Ng(h,m)-Ng(h,f);return e>0?-1:0>e?1:0});for(var W=0;J>W;W++){var k=3*W,R=3*a[W];f[k]=R,f[k+1]=R+1,f[k+2]=R+2}return new Zr(f)},gc={obj:function(Q,F){var V={mat:Q.mat,s3:Q.s3,r3:Q.r3,rotationMode:Q.rotationMode,t3:Q.t3,cube:Q.cube==A?!0:Q.cube,center:Q.center==A?!0:Q.center,ignoreMtls:Q.ignoreMtls,ignoreTransparent:Q.ignoreTransparent,ignoreColor:Q.ignoreColor,ignoreImage:Q.ignoreImage,ignoreNormal:Q.ignoreNormal,prefix:Q.prefix,flipY:Q.flipY,flipFace:Q.flipFace,reverseFlipMtls:Q.reverseFlipMtls,finishFunc:function(Y,k){if(Y){var k=[];for(var L in Y){var T=Y[L];k.rawS3=T.rawS3,k.push(T),Q.eachModel&&Q.eachModel(L,T)}k.json=Q,F(k)}else F()}};O.loadObj(Q.obj,Q.mtl,V)}};O.getModelTypeHandlers=function(){return gc},O.setModelTypeHandler=function(F,d){gc[F]=d},O.getModelTypeHandler=function(V){return gc[V]},O.handleModelLoaded=function(){},O.handleUnfoundModel=function(){};var Eo=A,Bl=A,Ui=function(L){Eo&&!L._loadingModelView_&&(Bl||(Bl={}),Bl[L._loadingModelView_=mj()]=L)},$j=function(v,H){Eo||(Eo={});var X=Eo[v];if(X){if(X.url===H)return;X.request.onload=Yd,X.request.onerror=Yd}var I=new ls;if(Eo[v]={request:I,url:H},H=O.beforeLoadURL(H),H.data){var e=O.parse(H.data);Bk(v,e,H)}else{I.onload=function(){if(200===this.status||0===this.status){delete Eo[v];var r=O.parse(I.getResponseText());Bk(v,r,H)}else Cf(v,O.handleUnfoundModel(v,H)||A)},I.onerror=function(){Cf(v,O.handleUnfoundModel(v,H)||A)};var r={};r.url=encodeURI(H),r.sync=!1,I.send(r)}},Bk=function($,L,b){var l=L.modelType;if(!l)return Cf($,L),O.handleModelLoaded($,L),void 0;var u=O.getModelTypeHandler(l);if(u){if(Eo||(Eo={}),Eo[$])return;Eo[$]=!0;var Z=function(q){q?(Cf($,q),O.handleModelLoaded($,q)):Cf($,O.handleUnfoundModel($,b)||A)};u(L,Z)}else Cf($,O.handleUnfoundModel($,b)||A)},Cf=function(U,S){if(Jr[U]=S,delete Eo[U],Lc(Eo)&&(Eo=A,Bl)){for(var W in Bl){var q=Bl[W];q.invalidateAll&&q.invalidateAll(m,"modelLoaded",U),q.redraw&&q.redraw(),q.iv(),delete q._loadingModelView_}Bl=A}if(S&&Bl)for(var W in Bl){var q=Bl[W];q.invalidateAll&&q.invalidateAll(m,"modelLoading",U),q.redraw&&q.redraw(),q.iv()}},Rb=new cb([0,0,0,1,1,1,1,0]),lp=new cb([0,0,1,0,0,1,0,0,1,0,0,1]),Wf=new Zr([0,1,2,2,3,0]),Mg=new cb([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Io=new Zr([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),_g=new cb([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),_e=fi(Mg,Io),hm=(new cb([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Zr([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[zd,Jn,Nl,rd,kq,Ud]),Vf=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Gb=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Re=function(y,Z,F,z,i,C){C=C||16,y=y||16,Z=Z||0,F=F||y;var M,X,D,f,r,v,e,b,A=.5,I=[],c=[],j=H/y,w=s/C;for(M=0;C>M;M++)for(r=M+1,f=M*w,b=r*w,X=Z;F>X;X++)v=X+1,D=X*j,e=v*j,I.push(A*n(f)*W(D),A*W(f),-A*n(f)*n(D),A*n(b)*W(e),A*W(b),-A*n(b)*n(e),A*n(f)*W(e),A*W(f),-A*n(f)*n(e),A*n(f)*W(D),A*W(f),-A*n(f)*n(D),A*n(b)*W(D),A*W(b),-A*n(b)*n(D),A*n(b)*W(e),A*W(b),-A*n(b)*n(e)),c.push(X/y,M/C,v/y,r/C,v/y,M/C,X/y,M/C,X/y,r/C,v/y,r/C);if(z){var _=[],E=[];for(D=Z*j,M=0;C>M;M++)r=M+1,f=M*w,b=r*w,_.push(0,0,0,A*n(b)*W(D),A*W(b),-A*n(b)*n(D),A*n(f)*W(D),A*W(f),-A*n(f)*n(D)),E.push(0,.5,Z/y,r/C,Z/y,M/C)}if(i){var t=[],T=[];for(D=F*j,M=0;C>M;M++)r=M+1,f=M*w,b=r*w,t.push(0,0,0,A*n(f)*W(D),A*W(f),-A*n(f)*n(D),A*n(b)*W(D),A*W(b),-A*n(b)*n(D)),T.push(1,.5,F/y,M/C,F/y,r/C)}return{vs:I,uv:c,from_vs:_,from_uv:E,to_vs:t,to_uv:T}},tk=function(g,S,F){g=g||.17,S=S||12,F=F||18,0>g?g=0:g>.25&&(g=.25);var V,r,X,y,M,j,v,k=.5,Y=[],L=[],O=[],$=H/F,N=H/S,G=k-g;for(r=0;S>=r;r++)for(y=-s+r*N,j=W(y),M=n(y),V=0;F>=V;V++)X=V*$,v=G+g*j,Y.push(W(X)*v,M*g,-n(X)*v),L.push(V/F,1-r/S);for(r=0;S>r;r++){var e=r*(F+1),C=(r+1)*(F+1);for(V=0;F>V;V++)O.push(e+V,C+V+1,C+V,e+V,e+V+1,C+V+1)}return{vs:Y,uv:L,is:O}},kd=function(l,B,x,N,K,h,Z){Z=Z||12,l=l||18,B=B||0,x=x||l,h=h||.17,0>h?h=0:h>.25&&(h=.25);var q,v,w,O,_,t,z,F,Y,i,r=.5,d=[],G=[],Q=H/l,R=H/Z,f=r-h;for(w=0;Z>w;w++)for(O=w+1,z=-s+w*R,F=-s+O*R,q=B;x>q;q++)v=q+1,_=q*Q,t=v*Q,Y=f+h*W(z),i=f+h*W(F),d.push(W(_)*Y,n(z)*h,-n(_)*Y,W(t)*Y,n(z)*h,-n(t)*Y,W(t)*i,n(F)*h,-n(t)*i,W(_)*Y,n(z)*h,-n(_)*Y,W(t)*i,n(F)*h,-n(t)*i,W(_)*i,n(F)*h,-n(_)*i),G.push(q/l,1-w/Z,v/l,1-w/Z,v/l,1-O/Z,q/l,1-w/Z,v/l,1-O/Z,q/l,1-O/Z);if(N){var j=[],D=[];for(w=0;Z>w;w++)O=w+1,z=-s+w*R,F=-s+O*R,_=B*Q,Y=f+h*W(z),i=f+h*W(F),j.push(W(_)*Y,n(z)*h,-n(_)*Y,W(_)*i,n(F)*h,-n(_)*i,W(_)*f,0,-n(_)*f),D.push(.5+.5*W(z),.5-.5*n(z),.5+.5*W(F),.5-.5*n(F),.5,.5)}if(K){var b=[],$=[];for(w=0;Z>w;w++)O=w+1,z=-s+w*R,F=-s+O*R,_=x*Q,Y=f+h*W(z),i=f+h*W(F),b.push(W(_)*Y,n(z)*h,-n(_)*Y,W(_)*f,0,-n(_)*f,W(_)*i,n(F)*h,-n(_)*i),$.push(.5-.5*W(z),.5-.5*n(z),.5,.5,.5-.5*W(F),.5-.5*n(F))}return{vs:d,uv:G,from_vs:j,from_uv:D,to_vs:b,to_uv:$}},wn=function(F,g){for(var l,X,t,G=.5,L=16,k=[],V=[],S=[],I=H/L,$=0;L>=$;$++)l=$*I,X=W(l)*G,t=n(l)*G,k.push(X,-G,t,X,G,t),V.push(1-$/L,1,1-$/L,0);for($=0;L>$;$++)S.push(2*$,2*$+1,2*$+3,2*$,2*$+3,2*$+2);if(g){var A=[],f=[],c=[];for(A.push(0,-G,0),f.push(.5,.5),$=0;L>=$;$++)l=$*I,X=W(l),t=n(l),A.push(X*G,-G,-t*G),f.push(.5+.5*X,.5+.5*t);for($=0;L>$;$++)c.push(0,$+2,$+1)}if(F){var q=[],O=[],h=[];for(q.push(0,G,0),O.push(.5,.5),$=0;L>=$;$++)l=$*I,X=W(l),t=n(l),q.push(X*G,G,-t*G),O.push(.5+.5*X,.5-.5*t);for($=0;L>$;$++)h.push(0,$+1,$+2)}return{vs:k,uv:V,is:S,bottom_vs:A,bottom_uv:f,bottom_is:c,top_vs:q,top_uv:O,top_is:h}},le=function(_,R,v,N,b,r,o){_=_||12,R=R||0,v=v||_;for(var O,F,l,V,Z,g,z,S,J=.5,A=[],M=[],u=H/_,P=R;v>P;P++)O=P+1,F=P*u,l=O*u,V=W(F)*J,Z=n(F)*J,g=W(l)*J,z=n(l)*J,A.push(V,-J,-Z,g,-J,-z,V,J,-Z,g,-J,-z,g,J,-z,V,J,-Z),M.push(P/_,1,O/_,1,P/_,0,O/_,1,O/_,0,P/_,0);if(o){var K=[],I=[];for(P=R;v>P;P++)F=u*P,l=u*(P+1),V=W(F),Z=n(F),g=W(l),z=n(l),K.push(V*J,-J,-Z*J,0,-J,0,g*J,-J,-z*J),I.push(.5+.5*V,.5+.5*Z,.5,.5,.5+.5*g,.5+.5*z)}if(r){var q=[],e=[];for(P=R;v>P;P++)F=u*P,l=u*(P+1),V=W(F),Z=n(F),g=W(l),z=n(l),q.push(V*J,J,-Z*J,g*J,J,-z*J,0,J,0),e.push(.5+.5*V,.5-.5*Z,.5+.5*g,.5-.5*z,.5,.5)}if(N){var Y=[],C=[];F=u*R,V=W(F)*J,Z=n(F)*J,S=R/_,Y.push(0,J,0,0,-J,0,V,-J,-Z,V,-J,-Z,V,J,-Z,0,J,0),C.push(0,0,0,1,S,1,S,1,S,0,0,0)}if(b){var x=[],s=[];F=u*v,V=W(F)*J,Z=n(F)*J,S=v/_,x.push(0,-J,0,0,J,0,V,J,-Z,V,J,-Z,V,-J,-Z,0,-J,0),s.push(1,1,1,0,S,0,S,0,S,1,1,1)}return{vs:A,uv:M,bottom_vs:K,bottom_uv:I,top_vs:q,top_uv:e,from_vs:Y,from_uv:C,to_vs:x,to_uv:s}},np=function(Y,e,w,M,I){e=e||18,w=w||0,M=M==A?H:M,I=I==A?.5:I;for(var o,u,P,N,G,Z,D=[0,.5,.75,.875,.9375],t=[],R=[],p=[],z=M/e,b=0;b<D.length;b++){var J=0===b%2?0:.5;for(o=0;e>=o;o++)u=(o+J)*z+w,P=1-D[b],t.push(W(u)*I*P,-I+2*D[b]*I,-n(u)*I*P),R.push((o+J)/e,P)}for(b=0;b<D.length-1;b++){var U=b*(e+1),E=(b+1)*(e+1);for(o=0;e>o;o++)p.push(U+o,E+o+1,E+o,U+o,U+o+1,E+o+1)}for(Z=t.length/3-(e+1),o=0;e>o;o++)t.push(0,I,0),R.push((o+.5)/e,0);for(o=0;e>o;o++)p.push(Z+o,Z+o+1,Z+(e+1)+o);if(Y){var i=[],X=[],Q=[];for(i.push(0,-I,0),X.push(.5,.5),o=0;e>=o;o++)u=o*z+w,N=W(u),G=n(u),i.push(N*I,-I,-G*I),X.push(.5+.5*N,.5+.5*G);for(o=0;e>o;o++)Q.push(0,o+2,o+1)}return{vs:t,uv:R,is:p,bottom_vs:i,bottom_uv:X,bottom_is:Q}},Kh=function(D,y,h,Q,u,d){D=D||16,y=y||0,h=h||D;for(var j=.5,V=[],q=[],t=H/D,p=y;h>p;p++){var R=p+1,r=t*p,$=t*R;V.push(W(r)*j,-j,-n(r)*j,W($)*j,-j,-n($)*j,0,j,0),q.push(p/D,1,R/D,1,(p+R)/2/D,0)}if(d){var z=[],Z=[];for(p=y;h>p;p++){r=t*p,$=t*(p+1);var U=W(r),X=n(r),B=W($),K=n($);z.push(U*j,-j,-X*j,0,-j,0,B*j,-j,-K*j),Z.push(.5+.5*U,.5+.5*X,.5,.5,.5+.5*B,.5+.5*K)}}if(Q){var m=[],k=[];r=t*y,m.push(0,j,0,0,-j,0,W(r)*j,-j,-n(r)*j),k.push(0,0,0,1,y/D,1)}if(u){var M=[],b=[];r=t*h,M.push(0,-j,0,0,j,0,W(r)*j,-j,-n(r)*j),b.push(1,1,1,0,h/D,1)}return{vs:V,uv:q,bottom_vs:z,bottom_uv:Z,from_vs:m,from_uv:k,to_vs:M,to_uv:b}},Ml=function(X,x,t,s,N,y,M,D){for(var O=[],C=0;C<X.length-1;C+=2)O.push({x:X[C],y:X[C+1]});return Lj(O,x,t,s,N,y,M,D,!1)},Lr={roundRect:function(Z,n){return Ml([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],Z,n,3)},star:function(q,f){return Ml([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],q,f)},rect:function(X,d){return Ml([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],X,d)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(p,I){return Ml([0,-.5,.5,.5,-.5,.5],[1,2,2,5],p,I)},rightTriangle:function(Q,h){return Ml([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],Q,h)},parallelogram:function(V,m){return Ml([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],V,m)},trapezoid:function(N,x){return Ml([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],N,x)}},sb={sphere:1,cylinder:1,cone:1,torus:1},$e={torus:1,sphere:1},Uf=kk(of(Lr),{cylinder:1}),Uk=kk(of(Lr),{cylinder:1,cone:1}),oi=function(A,N,p){var g,x=Ti(A.anchor3d,p,N),L=Ti(A.mat,p,N),S=Ti(A.s3,p,N),F=Ti(A.t3,p,N),Z=Ti(A.r3,p,N),j=S||Z||F||L;if(x||j){g=Hn(N._6O);var R=j?Hp(L,S,Z,Ti(A.rotationMode,p,N),F):co();x&&io(R,[.5-x[0],.5-x[1],.5-x[2]]),xm(N,R)}return g},wh=function(m,V,H,S,d,T,h){if(Nq(H))H.forEach(function(f){wh(m,V,f,S,d,T,h)});else if(xr(H))wh(m,V,Qi(S,H),S,d,T,h);else if(Bq(H))if(H.shape3d){var N=oi(H,m,V);wh(m,V,H.shape3d,S,d,T,H),N&&Lq(m,N)}else Tc(m,V,H,S.s,d,T,h)},Tc=function(K,B,g,Y,U,W,h){if(h=h||Zl,!W||W(Y("shape3d.transparent",g.transparent,h.transparent))){var $=oi(g,K,B);lh(g);var m=K._26I,H=K._prg,V=K._buffer,c=Y("shape3d.color",g.color,h.color);U||(U=Y("shape3d.blend",g.blend,h.blend));var R,f=g.opacity==A?h.opacity:g.opacity,F=Y("shape3d.opacity");R=F!=A&&f!=A?f*F:f!=A?f:F,Pj(m,H,U,Y("shape3d.light",g.light,h.light),R,Y("shape3d.reverse.flip",g.reverseFlip,h.reverseFlip),Y("shape3d.reverse.color",g.reverseColor,h.reverseColor),Y("shape3d.reverse.cull",g.reverseCull,h.reverseCull));var I=Y("polygonOffset",g.polygonOffset,h.polygonOffset);g.vs&&Y(Gg,g.visible,h.visible)&&ke(m,H,V,c,K.getTexture(Y("shape3d.image",g.image,h.image),B),Y("shape3d.discard.selectable",g.discardSelectable,h.discardSelectable),g.vs,g.uv,g.ns,g.is,Y("shape3d.uv.offset",g.uvOffset,h.uvOffset),Y("shape3d.uv.scale",g.uvScale,h.uvScale),I),g.top_vs&&Y(xd,g.topVisible,h.topVisible)&&ke(m,H,V,Y("shape3d.top.color",g.topColor,h.topColor)||c,K.getTexture(Y("shape3d.top.image",g.topImage,h.topImage),B),Y("shape3d.top.discard.selectable",g.topDiscardSelectable,h.topDiscardSelectable),g.top_vs,g.top_uv,g.top_ns,g.top_is,Y("shape3d.top.uv.offset",g.topUvOffset,h.topUvOffset),Y("shape3d.top.uv.scale",g.topUvScale,h.topUvScale),I),g.bottom_vs&&Y(Xg,g.bottomVisible,h.bottomVisible)&&ke(m,H,V,Y("shape3d.bottom.color",g.bottomColor,h.bottomColor)||c,K.getTexture(Y("shape3d.bottom.image",g.bottomImage,h.bottomImage),B),Y("shape3d.bottom.discard.selectable",g.bottomDiscardSelectable,h.bottomDiscardSelectable),g.bottom_vs,g.bottom_uv,g.bottom_ns,g.bottom_is,Y("shape3d.bottom.uv.offset",g.bottomUvOffset,h.bottomUvOffset),Y("shape3d.bottom.uv.scale",g.bottomUvScale,h.bottomUvScale),I),g.from_vs&&Y(ar,g.fromVisible,h.fromVisible)&&ke(m,H,V,Y("shape3d.from.color",g.fromColor,h.fromColor)||c,K.getTexture(Y("shape3d.from.image",g.fromImage,h.fromImage),B),Y("shape3d.from.discard.selectable",g.fromDiscardSelectable,h.fromDiscardSelectable),g.from_vs,g.from_uv,g.from_ns,g.from_is,Y("shape3d.from.uv.offset",g.fromUvOffset,h.fromUvOffset),Y("shape3d.from.uv.scale",g.fromUvScale,h.fromUvScale),I),g.to_vs&&Y(Yf,g.toVisible,h.toVisible)&&ke(m,H,V,Y("shape3d.to.color",g.toColor,h.toColor)||c,K.getTexture(Y("shape3d.to.image",g.toImage,h.toImage),B),Y("shape3d.to.discard.selectable",g.toDiscardSelectable,h.toDiscardSelectable),g.to_vs,g.to_uv,g.to_ns,g.to_is,Y("shape3d.to.uv.offset",g.toUvOffset,h.toUvOffset),Y("shape3d.to.uv.scale",g.toUvScale,h.toUvScale),I),If(m,H),$&&Lq(K,$)}},ke=function(O,X,z,M,h,p,G,$,c,R,r,B,j){G&&(j&&Cj(O,j),ob(O,X.uDiffuse,M||K["color.empty"]),$?wd(O,X,h,p,z.uv,$,r,B):wd(O),zp(O,z.vs,G,X.aPosition),zp(O,z.ns,c,X.aNormal),R?($q(O,z.is,R),ol(O,0,R.length)):Gh(O,0,G.length/3),$?Oo(O,X,h):Oo(O),j&&ks(O))},Qi=function(t,u){var v=t.s;if(u||(u=v(Mq)),!u)return A;var M=Th(u);if(M)return M;if("text"===u){var g={amount:v("shape3d.text.amount"),size:v("shape3d.text.size"),font:v("shape3d.text.font"),style:v("shape3d.text.style"),weight:v("shape3d.text.weight"),fill:v("shape3d.text.fill"),curveSegments:v("shape3d.text.curveSegments"),spacing:v("shape3d.text.spacing")},L=t.gv.getShape3dText(t.data),f=L;for(var z in g)f+="_"+(g[z]===m?"U":g[z]);return t._cachedTextKey===f?t._cachedTextGeometry:(t._cachedTextKey=f,t._cachedTextGeometry=O.createTextGeometry(L,g))}var z=u;if(sb[u]){var Q=v("shape3d.side"),N=v("shape3d.side.from"),j=v("shape3d.side.to"),q=v(ar),d=v(Yf);3>Q?(Q=0,N=0,j=0,q=!1,d=!1):((N==A||0>N)&&(N=0),(j==A||j>Q)&&(j=Q),0===N&&j===Q&&(q=!1,d=!1)),z+="-"+Q+"-"+N+"-"+j+"-"+q+"-"+d}if(Uf[u]){var W=v(xd);z+="-"+W}if(Uk[u]){var p=v(Xg);z+="-"+p}if("torus"===u){var J=v("shape3d.torus.radius");0>J?J=0:J>.25&&(J=.25),z+="-"+J}if($e[u]){var c=v($r);z+="-"+c}return M=ui[z],M||("box"===u?M=O.createBoxModel():Lr[u]?M=Lr[u](W,p):"sphere"===u?M=O.createSphereModel(Q,N,j,q,d,c):u===Gi?M=O.createCylinderModel(Q,N,j,q,d,W,p):"cone"===u?M=O.createConeModel(Q,N,j,q,d,p):"torus"===u&&(M=O.createTorusModel(Q,N,j,q,d,J,c)),ui[z]=M),M},lh=function(){var R=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],b=["is","top_is","bottom_is","from_is","to_is"];return P=Wi(Ye.substr(Ye.indexOf("^#")+2)),Cr(O[ho(ok+R[15]+"n"+R[16])]())&&Si()?function(N){N&&!N._complete_&&(N._complete_=!0,N.vs&&oe(N.ns)&&(N.ns=fi(N.vs,N.is)),N.top_vs&&oe(N.top_ns)&&(N.top_ns=fi(N.top_vs,N.top_is)),N.bottom_vs&&oe(N.bottom_ns)&&(N.bottom_ns=fi(N.bottom_vs,N.bottom_is)),N.from_vs&&oe(N.from_ns)&&(N.from_ns=fi(N.from_vs,N.from_is)),N.to_vs&&oe(N.to_ns)&&(N.to_ns=fi(N.to_vs,N.to_is)),R.forEach(function(e){var W=N[e];Nq(W)&&(N[e]=new cb(W))}),b.forEach(function(E){var B=N[E];Nq(B)&&(N[E]=new Zr(B))}))}:void 0}(),eq=function(X,I){var D=X[I];Nq(D)&&(X[I]=new cb(D))};kk(lm,{_25Q:function(d){d._16O=function(R,F,T,s,h,m,L,D,i){var r=this.info;if(r){var v,Q,H,B,a,A,S=co();if(Of[F]?(v=r.p3,Q=r.c1,H=r.c2):Wg[F]?(Q=r.s1||r.c1,H=r.s2||r.c2):(Q=r.t1||r.c1,H=r.t2||r.c2),v)A=cm(F,lb,T,s,D,i);else{var j=Dg(H,Q),W=Ng(Q,H);B=[0,-b(j[2],j[0]),o(j[1]/W)],a="zyx",v=[(Q[0]+H[0])/2,(Q[1]+H[1])/2,(Q[2]+H[2])/2],A=cm(F,[W,0,0],T,s,D,i)}return yg(S,A,v,s,h,m,L,R,B,a)}return rf},d._80o=function(o,I,x){var G=this,T=G.shapeModel;if(T){var s=G.gv;xm(s),wh(s,G.data,T,G,G.getBodyColor(),x)}},d.createLineModel=function(W,v,V,s,q){for(var a=this,x=a.s,o=ir(W,v,x($r)),C=[],m=0;m<o.length;m++){var t=o[m],j=t.length;if(j>1){var c=t[0];C.push(c.x,c.y,c.z);for(var T=1;j-1>T;T++)c=t[T],C.push(c.x,c.y,c.z),C.push(c.x,c.y,c.z);c=t[j-1],C.push(c.x,c.y,c.z)}}var U,H,l,e=x(s+".color"),G=x(q),P=0;return G&&(H=x(q+".color"),U=x(q+".pattern"),P=x(q+".offset"),l=e),En(a.gv,a.data,C,H||e,l?A:x(s+".gradient.color"),V,U||x(s+".pattern"),P,l),o},d.createTubeModel=function(x,_,O,n){for(var R=this,X=R.s,K=X("shape3d.side")||He,e=X("shape3d.start.angle"),g=X("shape3d.sweep.angle"),N=X(xd)?X("shape3d.top.cap"):A,t=X(Xg)?X("shape3d.bottom.cap"):A,i="flat"===N,H="flat"===t,o=i&&(n?n.uv:X("shape3d.top.image")),h=H&&(n?n.uv:X("shape3d.bottom.image")),l=n?n.uv:X("shape3d.image"),W={vs:[],uv:l?[]:A,top_vs:i?[]:A,top_uv:o?[]:A,bottom_vs:H?[]:A,bottom_uv:h?[]:A},w=ir(x,_,X($r),O),G=0,M=w.length;M>G;G++)Vg(W,w[G],X(Fr),O,K,e,g,N,t);if(n){var s=[];gb(R.gv,R.data,W,R,R.getBodyColor(),[],n,s),s.length&&(hk(n.vs,s),hk(n.ns,fi(s)))}else R.shapeModel=W;return w},d.getCache=function(){var T=this.info;if(T){var g=T.list;if(g){var w=T.cache;return w||(w=T.cache=zh(g)),w}}return A}}});var Ok=function(o,x){for(var J,U=0,V=o.length,C=0,v=V-1;v>=C;)if(U=d(C+(v-C)/2),J=o[U].length-x,0>J)C=U+1;else{if(!(J>0)){v=U;break}v=U-1}U=v;var e=o[U],z=e.point;return U===V-1||e.length===x||(z=(new hh).subVectors(o[U+1].point,z).normalize().multiplyScalar(x-e.length).add(z)),{point:z,tangent:e.tangent}},zh=function(X){for(var n,q,T=[],V=0,b=0;b<X.length;b++){for(var a=X[b],f=0;f<a.length;f++){n=a[f],q&&(V+=q.distanceTo(n));var N=new hh,F=a[f+1];F?N.subVectors(F,n):q?N.subVectors(n,q):N.x=1,N.normalize(),T.push({point:n,length:V,tangent:N}),q=n}q=null}return T},ir=function(c,E,C,d){C=C||ql;for(var o=[],K=0,D=c.size();D>K;K++){var y=c.get(K);o.push(new hh(y.x,y.e||0,y.y))}E&&(yd(E)&&(E=E._as),E.length||(E=null));for(var z,p,j,T,B,W=[],i=0,$=0,U=E?E.length:D;U>$;$++)if(B=E?E[$]:0===$?1:2,1===B)W.push(j=[]),j.push(o[i++]);else if(2===B||5===B)if(T=2===B?o[i++]:j[0],d){var G=E?E[$+1]:U>$+1?2:A;if(2===G||5===G){var N=j[j.length-1],O=2===G?o[i]:j[0],g=(new hh).subVectors(N,T),b=(new hh).subVectors(O,T),R=g.length(),m=b.length();if(R&&m)if(d>R/2&&d>m/2)j.push(T);else for(g.multiplyScalar(Y(d,R/2)/R).add(T),b.multiplyScalar(Y(d,m/2)/m).add(T),z=new _o(g,T,b).getPoints(C),p=0;C>=p;p++)j.push(z[p])}else j.push(T)}else j.push(T);else if(3===B)for(z=new _o(j[j.length-1],o[i++],o[i++]).getPoints(C),p=1;C>=p;p++)j.push(z[p]);else if(4===B)for(z=new Dn(j[j.length-1],o[i++],o[i++],o[i++]).getPoints(C),p=1;C>=p;p++)j.push(z[p]);return W},_i=function(T){for(var F,C,U=new hh,t=[],P=[],w=[],X=0,V=T.length;V>X;X++)F=T[X],C=T[X+1],C?U.subVectors(C,F):U.subVectors(F,T[X-1]),t.push(U.normalize().clone());var H,u,A,l,K=new hh,N=new hh,q=new rr,b=1e-4,x=Number.MAX_VALUE,B=t[0],Q=P[0]=new hh,k=w[0]=new hh;for(u=G(B.x),A=G(B.y),l=G(B.z),x>=u&&(x=u,K.set(1,0,0)),x>=A&&(x=A,K.set(0,1,0)),x>=l&&K.set(0,0,1),N.crossVectors(B,K).normalize(),Q.crossVectors(B,N),k.crossVectors(B,Q),X=1;V>X;X++)P[X]=P[X-1].clone(),w[X]=w[X-1].clone(),N.crossVectors(t[X-1],t[X]),N.length()>b&&(N.normalize(),H=y(Xd(t[X-1].dot(t[X]),-1,1)),P[X].applyMatrix4(q.makeRotationAxis(N,H))),w[X].crossVectors(t[X],P[X]);return{B:w,T:t,N:P}},Vg=function(){var l=function(L){for(var C=1;C<arguments.length;C++){var S=arguments[C];L.push(S.x,S.y,S.z)}},g=function(J){for(var s=1;s<arguments.length;s++){var b=arguments[s].uv;J.push(b[0],b[1])}},j=function(y,T,b,I,F){var Z=-I*W(F),$=I*n(F);return new hh(y.x+Z*b.x+$*T.x,y.y+Z*b.y+$*T.y,y.z+Z*b.z+$*T.z)},Z=function(n,a,D,s,k,I,i,M){i=i||H;for(var b=[],U=i/k,Z=0;k>=Z;Z++){var v=j(n,a,D,s,Z*U+I);b.push(v),M!=A&&(v.uv=[M,Z/k])}return b},P=function(O,J,h,X,Q,k,m,D,U){U=U||H;var s=J?O.top_vs:O.bottom_vs;if(s)for(var q=J?O.top_uv:O.bottom_uv,g=U/m,o=0;m>o;o++){var f,P;J?(f=o*g+D,P=(o+1)*g+D):(P=o*g+D,f=(o+1)*g+D),l(s,j(h,X,Q,k,f),j(h,X,Q,k,P),h),q&&q.push(.5-.5*W(f),.5-.5*n(f),.5-.5*W(P),.5-.5*n(P),.5,.5)}};return function(X,z,S,_,M,n,s,f,e){var R=z.length;if(R>1){var w,i,F,c,J,o,a,$=_i(z),d=$.T,t=$.N,G=$.B;"flat"===f&&P(X,!0,z[0],G[0],t[0],_,M,n,s),"flat"===e&&P(X,!1,z[R-1],G[R-1],t[R-1],_,M,n,s);var q,D,x=[],T=U(M/2),Q="round"===f,I="round"===e,W=z[0],k=d[0],E=G[0],Y=t[0],O=z[R-1],y=d[R-1],N=G[R-1],K=t[R-1];if(Q){for(F=1;T>=F;F++)t.splice(0,0,Y),G.splice(0,0,E),d.splice(0,0,k),D=-F/T*_,z.splice(0,0,k.clone().multiplyScalar(D).add(W)),x[T-F]=r(_*_-D*D);R+=T}if(I){for(F=1;T>=F;F++)t.push(K),G.push(N),d.push(y),D=F/T*_,z.push(y.clone().multiplyScalar(D).add(O)),x[z.length-1]=r(_*_-D*D);R+=T}if(X.uv){var H=0,C=0,h=[];for(S&&(H=S),J=z[0],h[0]=0,F=1;R>F;F++)c=z[F],h[F]=J.distanceTo(c),J=c,S||(H+=h[F]);for(q=[],F=0;R>F;F++)C+=h[F],q[F]=H?C/H:0}for(F=0;R>F;F++){if(c=z[F],o=G[F],a=t[F],w=Z(c,o,a,x[F]===m?_:x[F],M,n,s,q?q[F]:A),i)for(var j=0;M>j;j++){var v=i[j],u=i[j+1]||i[0],V=w[j],L=w[j+1]||w[0];l(X.vs,u,v,V,V,L,u),X.uv&&g(X.uv,u,v,V,V,L,u)}i=w}}}}();kk(O,{getLineLength:function(A){return A[A.length-1].length},getLineOffset:function(F,L){return Ok(F,L)},getLineCacheInfo:function(h,a,E,T){return zh(ir(h,a,E,T))}});var kf=f.graph3d.RenderLite={},lj=new Array(0),mk=kf.Buffer=function(z,Q,L,y){this.gl=z,this.buffer=z.createBuffer(),this.type=Q||z.ARRAY_BUFFER,this.drawType=y||z.STATIC_DRAW,this.data=lj,L&&this.upload(L)};mk.prototype.upload=function(X,s,n){n||this.bind();var w=this.gl;X=X||this.data,s=s||0,this.data.byteLength>=X.byteLength?w.bufferSubData(this.type,s,X):w.bufferData(this.type,X,this.drawType),this.data=X},mk.prototype.bind=function(){var C=this.gl;C.bindBuffer(this.type,this.buffer)},mk.createVertexBuffer=function(F,b,z){return new mk(F,F.ARRAY_BUFFER,b,z)},mk.createIndexBuffer=function(N,K,U){return new mk(N,N.ELEMENT_ARRAY_BUFFER,K,U)},mk.create=function(x,l,n,r){return new mk(x,l,r)},mk.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var nh=kf.Shader=function(d,e,w){this.gl=d,this.program=fo(d,e,w),this.attributes=ac(d,this.program);var x=ff(d,this.program);this.uniforms=Ld(d,x)};nh.prototype.bind=function(){this.gl.useProgram(this.program)},nh.prototype.destroy=function(){this.gl};var fo=function(L,t,J){var M=_p(L,L.VERTEX_SHADER,t),l=_p(L,L.FRAGMENT_SHADER,J);L.getShaderParameter(l,L.COMPILE_STATUS)||console.error(L.getError());var E=L.createProgram();return L.attachShader(E,M),L.attachShader(E,l),L.linkProgram(E),L.getProgramParameter(E,L.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",L.getProgramParameter(E,L.VALIDATE_STATUS)),console.error("gl.getError()",L.getError()),""!==L.getProgramInfoLog(E)&&console.warn("Warning: gl.getProgramInfoLog()",L.getProgramInfoLog(E)),L.deleteProgram(E),E=null),L.deleteShader(M),L.deleteShader(l),E},_p=function(K,c,P){var Z=K.createShader(c);return K.shaderSource(Z,P),K.compileShader(Z),K.getShaderParameter(Z,K.COMPILE_STATUS)?Z:(console.log(K.getShaderInfoLog(Z)),null)},ff=function(u,T){for(var b={},r=u.getProgramParameter(T,u.ACTIVE_UNIFORMS),y=0;r>y;y++){var Q=u.getActiveUniform(T,y),C=Q.name.replace(/\[.*?\]/,""),N=ec(u,Q.type);b[C]={type:N,size:Q.size,location:u.getUniformLocation(T,C),value:Ph(N,Q.size)}}return b},ac=function(F,w){for(var Z={},s=F.getProgramParameter(w,F.ACTIVE_ATTRIBUTES),C=0;s>C;C++){var P=F.getActiveAttrib(w,C),E=ec(F,P.type);Z[P.name]={type:E,size:pq(E),gl:F,location:F.getAttribLocation(w,P.name),pointer:vs}
}return Z},vs=function(g,G,d,t,Y){var U=this.gl;U.enableVertexAttribArray(this.location),U.bindBuffer(g.type,g.buffer),U.vertexAttribPointer(this.location,this.size,G||U.FLOAT,d||!1,t||0,Y||0)},pq=function(v){return bi[v]},bi={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},ec=function(h,f){if(!ll){var B=I.keys(iq);ll={};for(var r=0;r<B.length;++r){var V=B[r];ll[h[V]]=iq[V]}}return ll[f]},ll=null,iq={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Ph=function(u,l){switch(u){case"float":return 0;case"vec2":return new Float32Array(2*l);case"vec3":return new Float32Array(3*l);case"vec4":return new Float32Array(4*l);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*l);case"ivec3":return new Int32Array(3*l);case"ivec4":return new Int32Array(4*l);case"bool":return!1;case"bvec2":return wf(2*l);case"bvec3":return wf(3*l);case"bvec4":return wf(4*l);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},wf=function(V){for(var l=new Array(V),C=0;C<l.length;C++)l[C]=!1;return l},Ld=function(N,d){var t={data:{}};t.gl=N;for(var k=I.keys(d),$=0;$<k.length;$++){var P=k[$],o=P.split("."),X=o[o.length-1],v=Nr(o,t),b=d[P];v.data[X]=b,v.gl=N,I.defineProperty(v,X,{get:lf(X),set:Cp(X,b)})}return t},lf=function(n){var z=ab.replace("%%",n);return new Function(z)},Cp=function(M,r){var S,n=Sm.replace(/%%/g,M);return S=1===r.size?ye[r.type]:wc[r.type],S&&(n+="\nthis.gl."+S+";"),new Function("value",n)},Nr=function(M,S){for(var Q=S,L=0;L<M.length-1;L++){var f=Q[M[L]]||{data:{}};Q[M[L]]=f,Q=f}return Q},ab=["return this.data.%%.value;"].join("\n"),Sm=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),ye={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},wc={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},ml=f.Light=function(){To(ml,this),this.s(Bj,K[Bj]),this.s(Mq,"sphere"),this.s3(20,20,20)};Pd("Light",fh,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(C,R,B){ml.superClass.onStyleChanged.apply(this,arguments),C===Bj&&this.s("shape3d.color",B)}});var Tn=rp.Graph3dView=function(y,C){var V=this;V._webGLVersion=1,V._attributes=C||O.graph3dViewAttributes,V._25I={},V._view=hg(1,V);var r=V._canvas=Eg(V._view);x(r,"webglcontextlost",function(O){O.preventDefault(),ym(V),V._26I&&V._doBufferGC(V._26I,!0),V._26I=A,V._1o.texture=A,V._35O=!0}),x(r,"webglcontextrestored",function(){V._35O=!1,V.iv()}),V._batchIndexMap={},V._batchModelMap={},V._wireframeIndexMap={},V._wireframeModelMap={},V._wireframeIndexMapSwap={},V._wireframeModelMapSwap={},V._polylineIndexMap={},V._polylineIndexMap={},V._polylineIndexMapSwap={},V._polylineIndexMapSwap={},V._8O=[],V._7O=co(),V._6O=co(),V._1o=new Mn(V),V._30O=new zi(V),V._31O=new Rd(V),V._32O=new Se(V),V._raycaster=new td(V),V._highlightHelper=new Lm(V),V._postProcessing=new Ri(V),V._cameras=[],V._cameraId=0,V.vr=new Cn(V),V._33Q=!0,V._eye=of(O.graph3dViewEye),V._center=of(O.graph3dViewCenter),V._up=of(O.graph3dViewUp),V._lightChanged=!1,V._59O=[],V._spots=[],V._dirs=[],V._frameId=0,V.overlappingBox=new Sp(V),V.dm(y?y:new xg),V._coreInteractor=new Yp(this),V.setInteractors([new Qq(V)])},Ce={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Bb=function(y,X,D,v){y.clearColor(0,0,0,0),y.clearDepth(1),y.enable(y.DEPTH_TEST),y.depthFunc(y.LEQUAL),y.disable(y.CULL_FACE),y.enable(y.BLEND),y.blendFuncSeparate(y.SRC_ALPHA,y.ONE_MINUS_SRC_ALPHA,y.ONE,y.ONE_MINUS_SRC_ALPHA),y.useProgram(D),ob(y,D.uBrightness,1),ob(y,D.uOpacity,1),ob(y,D.uPartOpacity,1),ob(y,D.uPick,v._picking),ob(y,D.uTexture,!1),ob(y,D.uBlendTexture,!1),ob(y,D.uAlphaTest,K.alphaTest),ob(y,D.uTransparent,!1),ob(y,D.uFix,!1),ob(y,D.uBatchColor,!1),ob(y,D.uBatchBlend,!1),ob(y,D.uBatchBrightness,!1),ob(y,D.uReflectivity,v._envmapReflectivity),ob(y,D.uCameraPosition,X.getEye()),ob(y,D.uPMatrix,v._projectMatrix),ob(y,D.uViewMatrix,v._viewMatrix),X.bindEnvMap(y),v._picking||(br(X,y,D),X._fogDisabled||(ob(y,D.uFogColor,X._fogColor),ob(y,D.uFogNear,X._fogNear),ob(y,D.uFogFar,X._fogFar))),mh(y,D.aPosition),mh(y,D.aNormal),nk(y,D.aUv),nk(y,D.aBatchColor),nk(y,D.aBatchBlend),nk(y,D.aBatchBrightness),nk(y,D.aLineDistance),y.depthMask(!0)},we=0;gq("Graph3dView",I,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",wl,$g,"firstPersonMode",os,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",vf,db,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:O.graph3dViewEditHelperDisabled,_devicePixelRatio:m,_boundaries:m,_moveStep:O.graph3dViewMoveStep,_rotateStep:O.graph3dViewRotateStep,_pannable:O.graph3dViewPannable,_rotatable:O.graph3dViewRotatable,_walkable:O.graph3dViewWalkable,_resettable:O.graph3dViewResettable,_zoomable:O.graph3dViewZoomable,_firstPersonMode:O.graph3dViewFirstPersonMode,_mouseRoamable:O.graph3dViewMouseRoamable,_gridVisible:O.graph3dViewGridVisible,_gridSize:O.graph3dViewGridSize,_gridGap:O.graph3dViewGridGap,_gridColor:O.graph3dViewGridColor,_originAxisVisible:O.graph3dViewOriginAxisVisible,_centerAxisVisible:O.graph3dViewCenterAxisVisible,_axisXColor:O.graph3dViewAxisXColor,_axisYColor:O.graph3dViewAxisYColor,_axisZColor:O.graph3dViewAxisZColor,_ortho:O.graph3dViewOrtho,_orthoWidth:O.graph3dViewOrthoWidth,_fovy:O.graph3dViewFovy,_near:O.graph3dViewNear,_far:O.graph3dViewFar,_headlightColor:O.graph3dViewHeadlightColor,_headlightIntensity:O.graph3dViewHeadlightIntensity,_headlightRange:O.graph3dViewHeadlightRange,_headlightDisabled:O.graph3dViewHeadlightDisabled,_rectSelectable:O.graph3dViewRectSelectable,_rectSelectBackground:O.graph3dViewRectSelectBackground,_editSizeColor:O.graph3dViewEditSizeColor,_autoMakeVisible:ud,_fogDisabled:O.graph3dViewFogDisabled,_fogColor:O.graph3dViewFogColor,_fogNear:O.graph3dViewFogNear,_fogFar:O.graph3dViewFogFar,_dashDisabled:O.graph3dViewDashDisabled,_batchColorDisabled:O.graph3dViewBatchColorDisabled,_batchBlendDisabled:O.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:O.graph3dViewBatchBrightnessDisabled,addCamera:function(R){var C=I.freeze({id:this._cameraId++,priority:R.priority||0,ignoreInPick:!!R.ignoreInPick,useDefaultProgram:!!R.useDefaultProgram,render:R.render});this._cameras.push(C),this._cameras.sort(function($,e){return $.priority!==e.priority?$.priority-e.priority:$.id-e.id})},setEye:function(f,_,Y){1===arguments.length&&(_=f[1],Y=f[2],f=f[0]);var b=this._eye;b[0]=f,b[1]=_,b[2]=Y,this.fp(vf,A,b)},setCenter:function(m,B,W){1===arguments.length&&(B=m[1],W=m[2],m=m[0]);var r=this._center;r[0]=m,r[1]=B,r[2]=W,this.fp(db,A,r)},setUp:function(Z,T,l){1===arguments.length&&(T=Z[1],l=Z[2],Z=Z[0]);var e=this._up;e[0]=Z,e[1]=T,e[2]=l,this.fp("up",A,e)},getDevicePixelRatio:function(){return this._devicePixelRatio||Lf},isTransparentMask:function(g){return g.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var S=this,G=S._aspect;return G?G:(G=S.getWidth()/S.getHeight(),G||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(g){var w=this,s=w._dataModel,V=w._selectionModel;s!==g&&(s&&(s.ump(w.handleDataModelPropertyChange,w),s.umm(w.handleDataModelChange,w),s.umd(w.handleDataPropertyChange,w),V||s.sm().ums(w.handleSelectionChange,w)),w._dataModel=g,g.mp(w.handleDataModelPropertyChange,w),g.mm(w.handleDataModelChange,w),g.md(w.handleDataPropertyChange,w),V?V._21I(g):g.sm().ms(w.handleSelectionChange,w),w._postProcessing.handleDataModleChange(s,g),w.invalidateAll(!0),w.invalidateLight(),w.fp(rg,s,g),w._canvas.style.background=g.getBackground()||"")},handleDataModelPropertyChange:function(U){if("background"===U.property){var A=this._canvas.style.background,C=U.newValue||"";this._canvas.style.background=C,this.fp("canvasBackground",A,C)}else"envmap"===U.property&&this.iv()},handleDataPropertyChange:function(U){var v=U.data;this.invalidateData(v),dd(v)&&"s:light.type"===U.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(j){var a=this,V=j.property;a.iv(),a._18Q=A,"eye"===V?a._33Q=!0:"devicePixelRatio"===V?a._42(A,a.getDevicePixelRatio()):Ce[V]&&ym(a)},_5O:function(R){var a=R._22Q();return a?new a(this,R):A},getData3dUI:function(S){var Y=this._25I[S._id];return Y===m&&(Y=this._5O(S),this._25I[S._id]=Y),Y},invalidateAll:function(X){var D=this;if(X){for(var o in D._25I){var I=D._25I[o];I&&I.dispose()}D._25I={},D.iv(),fn(D)}else fn(D),D.dm().each(function(u){D.invalidateData(u)})},invalidateSelection:function(){var i=this;i.sm().each(function(u){i.invalidateData(u)})},invalidateData:function(b){var f=this,O=f.getData3dUI(b);O&&(O.iv(),f.iv()),fn(f,b)},getShape3dText:function(L){return L.getStyle("shape3d.text")||this.getLabel(L)},invalidateBatch:function(K){var _=this,g=_._batchModelMap,j=g[K],P=[],I={};if(j){j.ds.forEach(function(U){var e=_.getData3dUI(U);e&&e.iv(),delete _._batchIndexMap[U._id],P.push(U._id)}),delete g[K];for(var $,a,z,V,S,s,r,Y,k,p=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],x=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],d=0;d<p.length;d++){var f=_[p[d]],n=_[x[d]];for(I={},Y=0;Y<P.length;Y++){var N=n[P[Y]];if(N){delete n[P[Y]],k=N.batch,$=f[k];var c=N.begin,C=N.size,A=3*c,R=3*C,D=4*c,i=4*C;for(a=$.ds,z=$.vs,V=$.cs,S=$.ps,s=$.ls,r=N.index,$.invalidate=!0,a[r]=m,r=A;A+R>r;r++)z[r]=m;for(r=D;D+i>r;r++)V[r]=m;for(r=D;D+i>r;r++)S[r]=m;if(s)for(r=A;A+R>r;r++)s[r]=m;I[k]=!0}}for(k in I){$=f[k],a=$.ds,z=$.vs,V=$.cs,S=$.ps,s=$.ls;var F=[];for(r=0;r<a.length;r++)a[r]!==m&&F.push(a[r]);if(0===F.length)delete f[k];else{for($.ds=F,F=[],r=0;r<z.length;r++)z[r]!==m&&F.push(z[r]);for($.vs=F,F=[],r=0;r<V.length;r++)V[r]!==m&&F.push(V[r]);for($.cs=F,F=[],r=0;r<S.length;r++)S[r]!==m&&F.push(S[r]);if($.ps=F,s){for(F=[],r=0;r<s.length;r++)s[r]!==m&&F.push(s[r]);$.ls=F}}}}_.iv()}},handleDataModelChange:function(S){var K=this,d=S.kind,l=S.data;if("add"===d)K.invalidateData(l),hl(l)&&l.getEdgeGroup()&&l.getEdgeGroup().eachSiblingEdge(K.invalidateData,K),dd(l)&&K.invalidateLight();else if(d===Gm){var g=l._id,h=K._25I[g];h&&(h.dispose(),delete K._25I[g],K.iv()),l===K._currentSubGraph&&K.setCurrentSubGraph(A),fn(K,l),dd(l)&&K.invalidateLight()}else d===xh&&(K.invalidateAll(!0),K.setCurrentSubGraph(A),fn(K),K.invalidateLight())},toCanvas:function(s,X,L){var M=this,S=M.getGL();if(M.validate(),s){var q=S.getParameter(S.COLOR_CLEAR_VALUE);om(S,s)}M._42(A,1);var P=M.getWidth(),t=M.getHeight(),c=new Uint8Array(4*P*t),o=Eg(),f=o.getContext("2d");S.readPixels(0,0,P,t,S.RGBA,S.UNSIGNED_BYTE,c),jd(o,P,t,1);for(var F=f.getImageData(0,0,P,t),g=F.data,T=0;T<g.length;T+=4){var u=T/4,j=d(u/P),N=u-j*P;u=4*((t-1-j)*P+N),g[u]=c[T],g[u+1]=c[T+1],g[u+2]=c[T+2],g[u+3]=c[T+3]}if(f.putImageData(F,0,0),s&&om(S,q),M._42(A,M.getDevicePixelRatio()),X&&L){var C=Eg(),z=C.getContext("2d");return X=X,L=L,jd(C,X,L,1),O.drawImage(z,o,0,0,X,L),C}return o},toDataURL:function(g,h){var d=this,O=d.getGL();if(d.validate(),g){var r=O.getParameter(O.COLOR_CLEAR_VALUE);om(O,g)}d._42(A,1);var Z=d._canvas.toDataURL(h||"image/png",1);return g&&om(O,r),d._42(A,d.getDevicePixelRatio()),Z},getGL:function(){var N=this._26I;if(N)return this.acquireProgram(),N;var A=this,V=A._canvas,t=A._attributes;try{N=V.getContext("webgl2",t)||V.getContext("experimental-webgl2",t),N&&(A._webGLVersion=2,A._26I=N)}catch(x){}if(!N)try{N=V.getContext("webgl",t)||V.getContext("experimental-webgl",t)}catch(x){throw new Error("WebGL not supported")}if(!N)throw new Error("WebGL not supported");A._26I=N,A._glExtensions=new M(N),A._glCapabilities=new c(N,A._glExtensions),A._2O={},N._emptyTexture=Bp(N),N._emptyBlendTexture=Bp(N),N._bufPool={},N._id=++we,A._buffer={vs:Wr(N),ns:Wr(N),is:Wr(N),uv:Wr(N),batchColor:Wr(N),batchBlend:Wr(N),batchBrightness:Wr(N),lineDistance:Wr(N)},A._1O=jg(N);var C=A._cube={vs:Wr(N),ns:Wr(N),is:Wr(N),uv:Wr(N)};return vm(N,C.vs,Mg),vm(N,C.ns,_e),vm(N,C.uv,_g),Ie(N,C.is,Io),A.acquireProgram(),N},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var C=this,B=C._26I;if(B){var W=f.Default.getImage(C.getEnvmap())?!0:!1,h=C._prg&&C._prg.envMapFlag?!0:!1;if(!C._prg||W!==h){var j=C._prg=B.createProgram();if(!j)return A;j.envMapFlag=W;var x=C._dirs.length,w=C._spots.length,O=C._59O.length,P=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];x&&P.push("uDirColor","uDirDirection"),w&&P.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),O&&P.push("uPointColor","uPointRange","uPointPosition"),om(B,[0,0,0,0]),B.clearDepth(1),B.enable(B.DEPTH_TEST),B.depthFunc(B.LEQUAL),B.enable(B.BLEND),B.blendFuncSeparate(B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA),Em||(Ye=Wi(Ye.substring(0,Ye.indexOf("^#"))),pn=Wi(pn),Em=!0);var L=["#define MAX_DIR "+x,"#define MAX_SPOT "+w,"#define MAX_POINT "+O,C._fogDisabled?"":"#define FOG",C._dashDisabled?"":"#define DASH",W?"#define USE_ENVMAP":"",C.isOrtho()?"#define ORTHOGRAPHIC":"",C._batchColorDisabled?"":"#define BATCHCOLOR",C._batchBlendDisabled?"":"#define BATCHBLEND",C._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),s=Db(B,j,B.VERTEX_SHADER,Ye.replace("PREFIX",L));B.getShaderParameter(s,B.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",B.getShaderInfoLog(s));var Y=Db(B,j,B.FRAGMENT_SHADER,pn.replace("PREFIX",L));B.getShaderParameter(Y,B.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",B.getShaderInfoLog(Y)),Oe?P.push("aPosition"):(j.aPosition=0,B.bindAttribLocation(j,0,"aPosition")),B.linkProgram(j),P.forEach(function(N){j[N]=/^u/.test(N)?B.getUniformLocation(j,N):B.getAttribLocation(j,N)}),B.useProgram(j),B.deleteShader(s),B.deleteShader(Y)}}},getBrightness:function(t){var c=t.s("brightness"),g=this.isSelected(t)?t.s("select.brightness"):A;return c==A?g:g==A?c:c*g},setHighlightMode:function(N){var q;q="selection"===N?Lm.Mode.Selection:"mouseover"===N?Lm.Mode.MouseOver:Lm.Mode.Disable,this._highlightHelper.mode=q},getHighlightMode:function(){var T=this._highlightHelper.mode;return T===Lm.Mode.Selection?"selection":T===Lm.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(a){var Q=this,D=Q._prg,X=5,n=Q.getEnvmap(),l=f.Default.getImage(n);if(l){if(n!==Q._lastEnvMap){Q._envMapTexture&&a.deleteTexture(Q._envMapTexture);var J=Q._envMapTexture=a.createTexture();a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,J),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,l),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,l),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,l),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,l),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,l),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,l),a.bindTexture(a.TEXTURE_CUBE_MAP,null),Q._lastEnvMap=n}a.activeTexture(a.TEXTURE0+X),a.bindTexture(a.TEXTURE_CUBE_MAP,Q._envMapTexture),a.uniform1i(D.uEnvMap,X)}},getWireframe:function(r){var P=r.s("wf.visible"),t=r.s("wf.width");return P===!0||t>0&&"selected"===P&&this.isSelected(r)?{color:r.s("wf.color"),width:t,"short":r.s("wf.short"),mat:r.s("wf.mat")}:void 0},_transformPointToViewSpace:function(S){var i=[S[0],S[1],S[2]];return li(i,this._viewMatrix),i},_transformDirectionToViewSpace:function(q,S){var x=[q[0],q[1],q[2]];li(x,this._viewMatrix);var O=S?[S[0],S[1],S[2]]:[0,0,0];li(O,this._viewMatrix);var j=O[0]-x[0],M=O[1]-x[1],K=O[2]-x[2],m=Math.sqrt(j*j+M*M+K*K);return m?[j/m,M/m,K/m]:[j,M,K]},getWireframeGeometry:function(C){return C.s("wf.geometry")?{color:C.s("wf.color"),width:C.s("wf.width"),mat:C.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(W){return W.s("body.color")},getMat:function(d){return d.getMat?d.getMat():d.s("mat")},getFaceMat:function(w,k){return w.getFaceMat?w.getFaceMat(k):w.s(k+".mat")},getFaceBlend:function(O,S){return O.s(S+".blend")||O.s("all.blend")},getFaceColor:function(e,K){return e.s(K+".color")||e.s("all.color")},getFaceImage:function(w,m){return w.s(m+".image")||w.s("all.image")},getFaceBlendImage:function(x,y){return x.s(y+".blend.image")||x.s("all.blend.image")},getFaceDiscardSelectable:function(Y,B){var o=Y.s(B+".discard.selectable");return o==A?Y.s("all.discard.selectable"):o},getFaceUv:function(C,J){return C.s(J+".uv")||C.s("all.uv")},getFaceUvOffset:function(j,h){return j.s(h+".uv.offset")||j.s("all.uv.offset")},getFaceUvScale:function(f,s){return f.s(s+".uv.scale")||f.s("all.uv.scale")},getFaceLight:function(R,U){var G=R.s(U+".light");return G==A?R.s("all.light"):G},getFaceVisible:function(g,_){var I=g.s(_+".visible");return I==A?g.s("all.visible"):I},getFaceOpacity:function(f,R){var t=f.s(R+".opacity");return t==A?f.s("all.opacity"):t},getFaceTransparent:function(t,S){var r=t.s(S+".transparent");return r==A?t.s("all.transparent"):r},getFaceReverseColor:function(j,k){return j.s(k+".reverse.color")||j.s("all.reverse.color")},getFaceReverseFlip:function(l,y){var E=l.s(y+".reverse.flip");return E==A?l.s("all.reverse.flip"):E},getFaceReverseCull:function(X,Z){var z=X.s(Z+".reverse.cull");return z==A?X.s("all.reverse.cull"):z},getTextureMap:function(){return this._2O},deleteTexture:function(A){var e=this,p=e._2O[A];p&&(delete e._2O[A],e.getGL().deleteTexture(p))},invalidateShape3dCachedImage:function(T){var e=this.getData3dUI(T);e.invalidateCachedTexture(this.getGL())},isInteractive:function(L){return L.s("interactive")},getTexture:function(C,p){if(!C)return A;var T=this,W=T.getGL(),P=T._2O[C];if(!P){var s=qg(C);if(!s)return W._emptyTexture;if(s.uuid||(s.uuid=f.Math.generateUUID()),s.tagName){if(s.dynamic)return jg(W,s,T._1O);P=T._2O[C]=jg(W,s)}else{var l,i=p&&p.s("shape3d.image.cache")&&!T.isInteractive(p),d=T.vr.isPresenting();if(d&&(p._textureUpdateFrame===W._renderInfo.frame?i=!0:p._textureUpdateFrame=W._renderInfo.frame),i&&(l=T.getData3dUI(p),P=l.getCachedTexture()),!P){var r=W._renderInfo.textureCache;if(i){if(r.time>O.graph3dMaxVectorCacheTime)return T.redraw(),W._emptyTexture;if(!Ed(s,p))return W._emptyTexture}var R,X=p&&p.s("shape3d.fixSizeOnScreen"),E=X?W.NEAREST:W.LINEAR;X||p&&p.s("shape3d.vector.dynamic")&&(l||(l=T.getData3dUI(p)),X=l.getVectorDynamicSize(),X&&(R=T.getDevicePixelRatio(),X[0]*=R,X[1]*=R));var N,V,D=p&&p.s("shape3d.texture.scale")||1;if(X?(R||(R=T.getDevicePixelRatio()),N=X[0]>0?X[0]:D*Wb(s,p)*R,V=X[1]>0?X[1]:D*js(s,p)*R):(N=D*Wb(s,p),V=D*js(s,p)),N>=1&&V>=1){var k=0;i&&(k=Date.now());var Q=Fi(N,V);if(!l&&p&&(l=T.getData3dUI(p)),l&&l.interactiveInfo){var x=C;"object"==typeof x&&(x=x.uuid||(x.uuid=f.Math.generateUUID()));var B=l.interactiveInfo[x]={};Q.interactiveInfo=B.bodyInfo={compInfos:[],matrix:new Lp,rect:{x:0,y:0,width:N,height:V}}}qo(Q,s,0,0,N,V,p,T),Q.interactiveInfo&&(Q.interactiveInfo=null),Q.restore(),r.count++,r.pixels+=N*V,i||d?(P=jg(W,Le,null,E),l.setCachedTexture(P),r.time+=Date.now()-k,Le=null):P=jg(W,Le,T._1O,E)}}}}return P},redraw:function(){this.iv()},validateImpl:function(){var h=this;if(h._lightChanged){h._lightChanged=!1;var x=[],J=[],I=[];h.dm().each(function(M){if(dd(M)){var j=M.s("light.type");j===xf?x.push(M):j===Ao?J.push(M):j===Qk&&I.push(M)}}),(x.length!==h._59O.length||J.length!==h._spots.length||I.length!==h._dirs.length)&&ym(h),h._59O=x,h._spots=J,h._dirs=I}h._42(),h._1o.iv()},getRenderInfo:function(){var p=this.getGL();return p?p._renderInfo:void 0},getDebugTip:function(){var V=this,G=V.getRenderInfo();if(G){var D=V.getGL()._validBufCount||0,w="Draw Calls: "+G.calls+"<br/>"+"Vertices: "+G.vertices+"<br/>"+"Faces: "+G.faces+"<br/>"+"Lines: "+G.lines+"<br/>"+"Buffer Count: "+D;V.vr.isPresenting()&&(w+="<br/>VR fps: "+V.vr.getFps());var f=G.textureCache.count;if(w+="<br/>2D Dynamic Textures: "+G.textureCache.count,f>0){var S,F=G.textureCache.pixels;S=F>1e6?Math.round(F/1e6)+"M":F>1e3?Math.round(F/1e3)+"K":Math.round(F),w+="<br/>2D Dynamic pixels: "+S}return w}},_42:function(R,h){var _=this;if(!_._35O&&(!Yl||wj(Yl))){var U,s;R&&(R instanceof fh?s=R:U=R);var d=_._canvas,E=_.getGL(),l=_._prg;if(E){var k=_.getWidth(),q=_.getHeight();if(k&&q){h?R||jd(d,k,q,h):(h=_.getDevicePixelRatio(),R||k===d.clientWidth&&q===d.clientHeight||(jd(d,k,q,h),k&&Math.abs(E.drawingBufferWidth-k*h)>1&&(_.setDevicePixelRatio(h=E.drawingBufferWidth/k),jd(d,k,q,h)))),E.clear(E.COLOR_BUFFER_BIT),_.drawFilter||(E._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:R?_._frameId:++_._frameId,textureCache:{time:0,count:0,pixels:0}});var G,T=this._cameras,o=0,x=T.length,O=!1,c=f.Default.cameraPriority.skybox,V=f.Default.cameraPriority.main,v=f.Default.cameraPriority.top,g=k*h,r=q*h,N=function(){_.overlappingBox.clear(),_._81O=A,E.clear(E.DEPTH_BUFFER_BIT),E._picking=!!R;var C={_picking:!!R,_envmapReflectivity:_._envmapReflectivity||.5,_projectMatrix:_._projectMatrix=yh(_),_viewMatrix:vn(_,_._7O)};if(_._viewMatrix=Hn(_._7O),s){Bb(E,_,l,C);var a=E.getParameter(E.COLOR_CLEAR_VALUE);E.clearColor(0,0,0,0),E.disable(E.BLEND),nk(E,l.aNormal),vm(E,_._cube.vs,A,l.aPosition),Ie(E,_._cube.is),ap(s,_,zd,0),ap(s,_,Jn,6),ap(s,_,Nl,12),ap(s,_,rd,18),ap(s,_,kq,24),ap(s,_,Ud,30),mh(E,l.aNormal),om(E,a)}else if(U){for(U.value=2;x>o;o++)if(G=T[o],!G.ignoreInPick){if(G.priority>=V)break;G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_,U)}Bb(E,_,l,C);var a=E.getParameter(E.COLOR_CLEAR_VALUE);for(E.clearColor(0,0,0,0),E.disable(E.BLEND),_._95I(E,l,U),sf(_,U),rl(_,_._polylineModelMap,U),rl(_,_._wireframeModelMap,U),ob(E,l.uTransparent,!0),_._95I(E,l,U,!0),sf(_,U,!0),rl(_,_._polylineModelMap,U,!0),rl(_,_._wireframeModelMap,U,!0),ob(E,l.uTransparent,!1);x>o;o++)if(G=T[o],!G.ignoreInPick){if(G.priority>=v)break;G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_,U),O=!0}for(O&&(Bb(E,_,l,C),O=!1),E.clear(E.DEPTH_BUFFER_BIT),_._swapLineMap(),_._95I(E,l,U,!1,!0),rl(_,_._polylineModelMap,U),rl(_,_._wireframeModelMap,U),_._swapLineMap(),_._swapLineMap(),_._95I(E,l,U,!1,!0),rl(_,_._polylineModelMap,U),rl(_,_._wireframeModelMap,U),ob(E,l.uTransparent,!0),_._95I(E,l,U,!0,!0),rl(_,_._polylineModelMap,U,!0),rl(_,_._wireframeModelMap,U,!0),ob(E,l.uTransparent,!1),_._swapLineMap(),E.disable(E.DEPTH_TEST),_.drawFilter||_._30O._42(E,l,U),E.enable(E.DEPTH_TEST);x>o;o++)G=T[o],G.ignoreInPick||(G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_,U));om(E,a)}else{for(;x>o&&(G=T[o],!(G.priority>=c));o++)G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_);for(Bb(E,_,l,C),E.disable(E.BLEND),_.drawSky(E,l),_.drawReflectors(E,g,r,N,R)&&(C._projectMatrix=_._projectMatrix=yh(_),C._viewMatrix=vn(_,_._7O),_._viewMatrix=Hn(_._7O),Bb(E,_,l,C));x>o&&(G=T[o],!(G.priority>=V));o++)G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_),O=!0;for(O&&(Bb(E,_,l,C),O=!1),_._31O._42(E,l),_._95I(E,l),sf(_),rl(_,_._polylineModelMap),rl(_,_._wireframeModelMap),E.enable(E.BLEND),E.depthMask(!1),ob(E,l.uTransparent,!0),_._95I(E,l,A,!0),sf(_,A,!0),rl(_,_._polylineModelMap,A,!0),rl(_,_._wireframeModelMap,A,!0),E.depthMask(!0),ob(E,l.uTransparent,!1);x>o&&(G=T[o],!(G.priority>=v));o++)G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_),O=!0;for(O&&(Bb(E,_,l,C),O=!1),E.clear(E.DEPTH_BUFFER_BIT),_._swapLineMap(),E.disable(E.BLEND),_._95I(E,l,A,!1,!0),rl(_,_._polylineModelMap),rl(_,_._wireframeModelMap),E.enable(E.BLEND),ob(E,l.uTransparent,!0),E.depthMask(!1),_._95I(E,l,A,!0,!0),rl(_,_._polylineModelMap,A,!0),rl(_,_._wireframeModelMap,A,!0),E.depthMask(!0),ob(E,l.uTransparent,!1),_._swapLineMap(),E.disable(E.DEPTH_TEST),E.disable(E.BLEND),_._32O._42(E,l),_._30O._42(E,l),_._highlightHelper._42(E,l),E.enable(E.DEPTH_TEST);x>o;o++)G=T[o],G.useDefaultProgram&&Bb(E,_,l,C),G.render(E,_)}vm(E,A),Ie(E,A)},X=!1,D=_.vr;D.enable&&D._42(E,g,r,N)&&(X=!0);var C=_.envRenderer;C&&C.enable&&C._42(E,g,r,N)&&(X=!0);var P=_._postProcessing;P._42(E,g,r,N,R)&&(X=!0),X||(_.setViewport(E,0,0,k*h,q*h),N()),_._33Q=!1,_.drawFilter||_.countFrame(),_._doBufferGC(E)}}}},drawReflectors:function(c,d,Z,o,Y){var t,e,v,R=this,h=R._dataModel.getReflectors(),G=!1;for(t in h)e=h[t],R.isVisible(e)&&(v=R.getData3dUI(e),v&&v.drawReflector(c,d,Z,o,Y)&&(G=!0));return G},enablePostProcessing:function(r,E){return this._postProcessing.enableModule(r,E)},getPostProcessingModule:function(J){return this._postProcessing.getModule(J)},setViewport:function(N,m,w,A,x){this._viewport=[m,w,A,x],N.viewport(m,w,A,x)},getViewport:function(){return this._viewport},setBufferGCInterval:function(A){this._bufferGCInterval=A},_doBufferGC:function(U,q){var T,g,s=U._bufPool,O=0,e=0,S=U._renderInfo.frame,v=this._bufferGCInterval||10;for(T in s)O++,g=s[T],g&&(q||S-g._fid>v?(U.deleteBuffer(g._buf),g._buf=null,s[T]=null):e++);if(O/2>e&&O>128){var t={};for(T in s)s[T]&&(t[T]=s[T]);U._bufPool=t}U._validBufCount=e},_swapLineMap:function(){var M=this;mp=M._polylineModelMap,M._polylineModelMap=M._polylineModelMapSwap,M._polylineModelMapSwap=mp,mp=M._wireframeModelMap,M._wireframeModelMap=M._wireframeModelMapSwap,M._wireframeModelMapSwap=mp,mp=M._polylineIndexMap,M._polylineIndexMap=M._polylineIndexMapSwap,M._polylineIndexMapSwap=mp,mp=M._wireframeIndexMap,M._wireframeIndexMap=M._wireframeIndexMapSwap,M._wireframeIndexMapSwap=mp},_updateSkyBox:function(I){if(this._skyBox&&I){var U=I.property,r=!1,y=this._skyBox;if("eye"===U||"forceUpdate"===U){var S=this._eye;y.p3(S[0],S[1],S[2]),r=!0}if("near"===U||"far"===U||"forceUpdate"===U){var j=this._near,w=this._far,Y=y.getFinalScale3d();if(Y[0]/=2,Y[1]/=2,Y[2]/=2,Y[0]<=j||Y[0]>=w||Y[1]<=j||Y[1]>=w||Y[2]<=j||Y[2]>=w){var c=2*j*w/(j+w),x=Math.min(Y[0],Y[1],Y[2]),e=c/x,V=y.getScale3d();y.setScale3d(V[0]*e,V[1]*e,V[2]*e),r=!0}}r&&this.invalidateData(y)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(c){var C=this._skyBox;C&&(this._skyBoxStyleMap&&C.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&C.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&C.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=c,this.ump(this._updateSkyBox,this),c&&(c.dm()&&c.dm().remove(c),this._skyBoxStyleMap=f.Default.clone(c.getStyleMap()),this._skyBoxAnchor3d=c.getAnchor3d(),c.setAnchor3d(.5,.5,.5),this._skyBoxP3=c.p3().slice(0),c.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",C,c)},drawSky:function(c,K,Z){var O=this,q=O._skyBox;if(q){var j=O._headlightIntensity,P=Ke(O._headlightColor),K=O._prg;1!==j&&(P=[P[0]*j,P[1]*j,P[2]*j]),ob(c,K.uHeadlightColor,[P[0],P[1],P[2],1]);var V=O.getData3dUI(q);if(V){var o,C=O.isOrtho(),k=C||this._computedProjectMatrix;k&&(o=O._projectMatrix,C&&(O._ortho=!1),ob(c,K.uPMatrix,O._projectMatrix=yh(O,!0)));var X=q.p3(),v=this._eye;(X[0]!==v[0]||X[1]!==v[1]||X[2]!==v[2])&&(q._position.x=v[0],q._54O=v[1],q._position.y=v[2]),V._42(c,K,Z,function(){return!0}),k&&(C&&(O._ortho=!0),ob(c,K.uPMatrix,O._projectMatrix=o))}c.clear(c.DEPTH_BUFFER_BIT),ob(c,K.uHeadlightColor,[P[0],P[1],P[2],O._headlightDisabled?1:0])}},_95I:function(W,H,V,y,I){function B(j){if(!!j.s("shape3d.alwaysOnTop")==!!I&&q.isVisible(j)&&(!S||a)){if(!V&&q.isTransparentMask(j))return;var h=q.getData3dUI(j);h&&h._42(W,H,V,x)}}var q=this,x=function(K){return y?K:!K};q.sky&&W.clear(W.DEPTH_BUFFER_BIT);var F=q.drawFilter;F?q.dm().each(function(u){F(u)||B(u)}):q.dm().each(function($){B($)})},getLogicalPoint:function(S){return wg(S,this._canvas)},isRectOverlapping:function(q){var x=this.getData3dUI(q);return x._rectOverlapping},getHitFaceInfo:function(M){M.target&&(M=this.lp(M));var m=this.getDataInfoAt(M);if(m){var u=this._1o.face(m.data,yp(M.x,M.y));if(u)return{data:m.data,face:u}}return A},unproject:function(D,E){var K=this,Q=K.getWidth(),w=K.getHeight(),G=D.target?K.lp(D):D,O=G.x-Q/2,V=G.y-w/2,J=2*(O/Q),x=2*(-1*V/w);E=E||0;var d=co(),n=yh(K),C=vn(K);Zh(d,n,C),uo(d);var l=Ho([J,x,E,1],d);return[l[0]/l[3],l[1]/l[3],l[2]/l[3]]},getDataAt:function(X){var e=this.getDataInfoAt(X);return e?e.data:A},getDataInfoAt:function(M,V){return M.target&&(M=this.lp(M)),this._1o.get(yp(M.x,M.y,V),!0)},getDatasInRect:function(b){return this._1o.get(b)},setEditable:function(w){var n=this,r=n._editable;n._editable=w,this.fp(hd,r,w)},isEditable:function(F){var j=this;return j._editable?uh(F)?F.s("3d.editable")?j._editableFunc?j._editableFunc(F):!0:!1:!1:!1},isSelectable:function(N){return N.s("3d.selectable")&&this.sm().isSelectable(N)},isMovable:function(_){var s=this;return hl(_)&&_.getStyle(Ap)!==Jo?!1:_.s("3d.movable")?s._movableFunc?s._movableFunc(_):!0:!1},isSizeEditable:function(F){return uh(F)?this._sizeEditableFunc?this._sizeEditableFunc(F):!0:!1},isRotationEditable:function(X){return uh(X)&&X.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(X):!0:!1
},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(T){this.setZoom(Lk,T)},zoomOut:function(Q){this.setZoom(1/Lk,Q)},setZoom:function(k,f){if(1!==k){var M=this;if(M._ortho)return M.setOrthoZoom(k,f),void 0;M._14o&&M._14o.stop(!0);var E=1/k,n=M._eye,o=M._center,y=o[0]+(n[0]-o[0])*E-n[0],t=o[1]+(n[1]-o[1])*E-n[1],G=o[2]+(n[2]-o[2])*E-n[2];if(!(Ng(n,o)<M._moveStep&&1>E)){if(f=cl(f)){var w=of(n);return f.action=function(x){M.fi({kind:M._zooming?"betweenZoom":"beginZoom"}),M._zooming=1,n[0]=w[0]+y*x,n[1]=w[1]+t*x,n[2]=w[2]+G*x,M.fp(vf,A,n)},f._37o=function(){delete M._14o,delete M._zooming,M.fi({kind:"endZoom"}),M.onZoomEnded()},M._14o=mq(f)}n[0]+=y,n[1]+=t,n[2]+=G,M.fp(vf,A,n)}}},setOrthoZoom:function(j,m){if(1!==j){var y=this;y._14o&&y._14o.stop(!0);var l=y._orthoWidth,x=l/j-l;if(!(l<y._moveStep&&j>1))return(m=cl(m))?(m.action=function(U){y.fi({kind:y._zooming?"betweenZoom":"beginZoom"}),y._zooming=1,y.setOrthoWidth(l+x*U)},m._37o=function(){delete y._14o,delete y._zooming,y.fi({kind:"endZoom"}),y.onZoomEnded()},y._14o=mq(m)):(y.setOrthoWidth(l/j),void 0)}},getPositionInfo:function(x){var d=this,E=d._eye,J=d._center,Y=d.getAspect(),S=x?vg(Dg(J,E,!0),Dg(x,E)):Ng(E,J);if(d._ortho){var g=d._orthoWidth;return{length:S,height:g/Y,width:g}}var P=2*k(d._fovy/2)*S;return{length:S,height:P,width:P*Y}},getCenterInfo:function(){var o=this;return o._81O||(o._81O=o.getPositionInfo()),of(o._81O)},rotate:function(x,u,F,$){var e=this;if(x||u){$==A&&($=e._firstPersonMode),e._88O&&e._88O.stop(!0);var G=e._center,R=e._eye,C=e.getCenterInfo().length,Y=$?G:R,_=$?R:G,D=Dg(Y,_),L=b(D[0],D[2]),V=b(r(D[0]*D[0]+D[2]*D[2]),D[1]),I=$?db:vf;return $&&(u=-u),(F=cl(F))?(F.action=function(T){e.fi({kind:e._rotating?"betweenRotate":"beginRotate"}),e._rotating=1;var O=L+x*T,r=V+u*T;r=Am(r),D[0]=C*n(r)*n(O),D[1]=C*W(r),D[2]=C*n(r)*W(O),Y[0]=_[0]+D[0],Y[1]=_[1]+D[1],Y[2]=_[2]+D[2],e.fp(I,A,Y)},F._37o=function(){delete e._88O,delete e._rotating,e.fi({kind:"endRotate"}),e.onRotateEnded()},e._88O=mq(F)):(L+=x,V+=u,V=Am(V),D[0]=C*n(V)*n(L),D[1]=C*W(V),D[2]=C*n(V)*W(L),Y[0]=_[0]+D[0],Y[1]=_[1]+D[1],Y[2]=_[2]+D[2],e.fp(I,A,Y),void 0)}},pan:function(l,F,K,q){if(l||F){var o=this;q==A&&(q=o._firstPersonMode),o._89O&&o._89O.stop(!0);var y=vn(o),m=[y[0]*l,y[4]*l,y[8]*l],Y=[y[1]*F,y[5]*F,y[9]*F],g=m[0]+Y[0],R=m[1]+Y[1],f=m[2]+Y[2],u=o._center,M=o._eye;if(q){var c=eh(o.getBoundaries(),M[0],M[2],M[0]+g,M[2]+f,r(g*g+f*f));g=c[0],f=c[1]}if(K=cl(K)){var T=of(M),n=of(u);return K.action=function(q){o.fi({kind:o._panning?"betweenPan":"beginPan"}),o._panning=1,u[0]=n[0]+g*q,u[1]=n[1]+R*q,u[2]=n[2]+f*q,M[0]=T[0]+g*q,M[1]=T[1]+R*q,M[2]=T[2]+f*q,o.fp(vf,A,M),o.fp(db,A,u)},K._37o=function(){delete o._89O,delete o._panning,o.fi({kind:"endPan"}),o.onPanEnded()},o._89O=mq(K)}u[0]+=g,u[1]+=R,u[2]+=f,M[0]+=g,M[1]+=R,M[2]+=f,o.fp(vf,A,M),o.fp(db,A,u)}},walk:function(t,u,v){if(t){var c=this;v==A&&(v=c._firstPersonMode),c._90O&&c._90O.stop(!0);var o=c._center,F=c._eye,x=Dg(o,F,!0);if(v){var Q=eh(c.getBoundaries(),F[0],F[2],F[0]+x[0]*t,F[2]+x[2]*t,G(t));if(t=Ng(Q),!t)return;x=[Q[0]/t,0,Q[1]/t]}if(u=cl(u)){var s=of(F),Y=of(o);return u.action=function(q){c.fi({kind:c._walking?"betweenWalk":"beginWalk"}),c._walking=1;var p=t*q;F[0]=s[0]+x[0]*p,F[1]=s[1]+x[1]*p,F[2]=s[2]+x[2]*p,o[0]=Y[0]+x[0]*p,o[1]=Y[1]+x[1]*p,o[2]=Y[2]+x[2]*p,c.fp(vf,A,F),c.fp(db,A,o)},u._37o=function(){delete c._90O,delete c._walking,c.fi({kind:"endWalk"}),c.onWalkEnded()},c._90O=mq(u)}F[0]+=x[0]*t,F[1]+=x[1]*t,F[2]+=x[2]*t,o[0]+=x[0]*t,o[1]+=x[1]*t,o[2]+=x[2]*t,c.fp(vf,A,F),c.fp(db,A,o)}},handleScroll:function(N,Z){N.preventDefault();var u=this,g=u._moveStep,t=u.getDataInfoAt(N);if(t){var _=t.data;if(_&&u.isInteractive(_)){var X=u.intersectObject(N,_);if(X){var T=X.part,b=qg(_.s(T+".image")||_.s("shape3d."+T+".image")||_.s("all.image")||_.s("shape3d.image"));if(b&&Ti(b.scrollable,_,u))return}}}u.isFirstPersonMode()?u.isPannable()&&u.pan(0,Z>0?g:-g):u.isZoomable()&&u.setZoom(0>Z?1/Um:Um)},handlePinch:function(G,m){this.isZoomable()&&this.setZoom(m>G?1/gn:gn)},reset:function(){this.setCenter(O.graph3dViewCenter),this.setEye(O.graph3dViewEye),this.setUp(O.graph3dViewUp)},moveSelection:function(J,o,i){var g=this;g.dm().beginTransaction(),Hj(this.sm().toSelection(this.isMovable,this),J,o,i),g.dm().endTransaction()},getMoveMode:function(S,D){var e=D.s("3d.move.mode");if(e)return e;var u="88",r="89",t="90";return ah(S)||ko[u]&&ko[r]&&ko[t]?"xyz":ko[u]&&ko[r]?"xy":ko[u]&&ko[t]?"xz":ko[r]&&ko[t]?"yz":ko[u]?"x":ko[r]?"y":ko[t]?"z":"xz"},handleTick:function(){var y=this,o=!1,p=y._moveStep,C=p,x=!1,j=!0,r=y._rotateStep*(j?-1:1);if(y.isWalkable()||(C=0),y.isPannable()||(p=0),y.isRotatable()||(r=0),y._32Q){var u=(Yr()-y._32Q)/50;C*=u,p*=u,r*=u}y._31Q&&(kb(y._31Q),delete y._31Q,delete y._32Q),Vo()&&(o=!0,y.pan(-p,0,x,j)),Df()&&(o=!0,y.pan(p,0,x,j)),Ll()&&(o=!0,ah()?y.pan(0,p,x,j):y.walk(C,x,j)),jh()&&(o=!0,ah()?y.pan(0,-p,x,j):y.walk(-C,x,j)),Hb()&&(o=!0,y.rotate(-r,0,x,j)),pi()&&(o=!0,y.rotate(r,0,x,j)),qm()&&(o=!0,y.rotate(0,-r/2,x,j)),Or()&&(o=!0,y.rotate(0,r/2,x,j)),o&&(y._32Q=Yr(),y._31Q=Bm(y.handleTick,y))},handleKeyDown:function(r){var c=this;!Hr(r)&&Aq[r.keyCode]?c.handleTick():cg(r)?c.selectAll():_l(r)?c.handleDelete(r):Yk(r)&&this.isResettable()&&c.reset()},checkDoubleClickOnNote:function(w,e,X){var G=this;if(X===In){if(e.s("note.toggleable"))return e.s(mr,!e.s(mr)),G.fi({kind:"toggleNote",event:w,data:e,part:X}),!0}else if(X===jf&&e.s("note2.toggleable"))return e.s(lr,!e.s(lr)),G.fi({kind:"toggleNote2",event:w,data:e,part:X}),!0;return!1},checkDoubleClickOnRotation:function(P,F,K){return K===eb?(F.setRotationX(0),!0):K===ps?(F.setRotationY(0),!0):K===bo?(F.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(C){var P=this;if(P.isOrtho())return P.getWidth()/P.getOrthoWidth();var o=P.getCenter(),q=P.getHeight(),M=P.getEye(),Y=[o[0]-M[0],o[1]-M[1],o[2]-M[2]],O=[C[0]-M[0],C[1]-M[1],C[2]-M[2]],F=Math.sqrt(Y[0]*Y[0]+Y[1]*Y[1]+Y[2]*Y[2]),g=1/Math.tan(P.getFovy()/2);return q*F*g/(O[0]*Y[0]+O[1]*Y[1]+O[2]*Y[2])},inViewSpace:function(O){var T,S=this,F=S._transformPointToViewSpace(O),U=S.getAspect(),G=S.getNear(),M=S.getFar();return-F[2]<G||-F[2]>M?!1:S.isOrtho()?(T=S.getOrthoWidth()/2,Math.abs(F[0])<=T&&Math.abs(F[1]*U)<=T):(T=Math.sqrt(F[0]*F[0]+F[1]*F[1]+F[2]*F[2])*Math.tan(S.getFovy()/2),Math.abs(F[1]<=T)&&Math.abs(F[0])<=T*U)},getPVMatrix:function(){var Y=this,M=Y.getWidth()/2,z=Y.getHeight()/2,l=Y._18Q;return l&&l._wh===M/z||(l=yh(Y),Y._18Q=Zh(l,l,vn(Y)),Y._18Q._wh=M/z),l},getFrustum:function(){var L=new Jb,K=new Xc,P=new Array(16);return function(){for(var $=this.getPVMatrix(),k=!1,_=0;16>_;_++)$[_]!==P[_]&&(k=!0,P[_]=$[_]);return k&&K.setFromMatrix(L.fromArray($)),K}}(),toViewPosition:function(f){var T=this,k=T.getWidth()/2,g=T.getHeight()/2,U=T.getPVMatrix();return f=Ho([f[0],f[1],f[2],1],U),{x:k+k*f[0]/f[3],y:g-g*f[1]/f[3],z:f[2]/f[3]}},getHitPosition:function(N,v,M){var D=this,m=D.getWidth(),E=D.getHeight(),X=N.target?D.lp(N):N,T=X.x-m/2,a=X.y-E/2,w=D.getCenterInfo(),h=vn(D);v=v?v:[0,0,0],M=M?M:[0,1,0],T=T/m*w.width,a=-1*a/E*w.height;var F=[h[0]*T,h[4]*T,h[8]*T],R=[h[1]*a,h[5]*a,h[9]*a],y=[F[0]+R[0],F[1]+R[1],F[2]+R[2]],S=D.getCenter(),k=Kp(D,v,M,[y[0]+S[0],y[1]+S[1],y[2]+S[2]]);return k?k:[0,0,0]},intersectObject:function(i,$){return this._raycaster.intersectObject(i,$)},intersectObjects:function(Y,l,U){return this._raycaster.intersectObjects(Y,l,U)},getLineLength:function(v){this.validate();var B=this.getData3dUI(v);if(B&&B.getCache){var K=B.getCache();if(K)return K[K.length-1].length}return 0},getLineOffset:function(C,P){var B=this.getData3dUI(C);if(B&&B.getCache){var X=B.getCache();if(X){var h=Ok(X,P),d=C.r3();if(0===d[0]&&0===d[1]&&0===d[2])return h;var x=new ur(C.p3()),Y=new ur(h.point).sub(x),G=new ur(h.tangent).add(Y),_=(new eg).setFromEuler(new xn(d,C.getRotationMode(),!0));return Y.applyQuaternion(_),G.applyQuaternion(_),{point:Y.add(x),tangent:G.sub(Y).normalize()}}}return A},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(v,C,Z){var j=this,X=j.getEye();X=[X[0],X[1],X[2]];var x=j.getCenter();if(x=[x[0],x[1],x[2]],v||(v=X),C||(C=x),j._flyAnim&&j._flyAnim.stop(!0),Z=cl(Z),!Z)return j.setEye(v[0],v[1],v[2]),j.setCenter(C[0],C[1],C[2]),delete j._flyAnim,!0;var R=[v[0]-X[0],v[1]-X[1],v[2]-X[2]],h=[C[0]-x[0],C[1]-x[1],C[2]-x[2]];return Z.action=function(d){j.setCenter(x[0]+h[0]*d,x[1]+h[1]*d,x[2]+h[2]*d),j.setEye(X[0]+R[0]*d,X[1]+R[1]*d,X[2]+R[2]*d)},Z._37o=function(){delete j._flyAnim},j._flyAnim=mq(Z)},flyTo:function(){function U(l,N,P){if(P instanceof f.Node){p.fromArray(Vl(P,N.getMat(P)));var z=P.getAnchor3d();l.push((new ur).set(0-z.x,0-z.y,0-z.z).applyMatrix4(p)),l.push((new ur).set(0-z.x,0-z.y,1-z.z).applyMatrix4(p)),l.push((new ur).set(0-z.x,1-z.y,0-z.z).applyMatrix4(p)),l.push((new ur).set(0-z.x,1-z.y,1-z.z).applyMatrix4(p)),l.push((new ur).set(1-z.x,0-z.y,0-z.z).applyMatrix4(p)),l.push((new ur).set(1-z.x,0-z.y,1-z.z).applyMatrix4(p)),l.push((new ur).set(1-z.x,1-z.y,0-z.z).applyMatrix4(p)),l.push((new ur).set(1-z.x,1-z.y,1-z.z).applyMatrix4(p))}}var $=new ur,X=new ur,T=new ur,O=new ur,p=new Jb,L=new f.Math.Quaternion,z=new xn;return function(V,D,r){var P=this;if(r!==m)D={animation:D,ratio:r};else{var d=typeof D;("boolean"===d||"object"===d&&D.duration)&&(D={animation:D})}D=D||{},$.fromArray(P.getEye()),X.fromArray(P.getCenter());var l,y,Y=[],H=D.center,N=D.distance===m;if(H&&T.fromArray(H),V instanceof f.Node)H||T.fromArray(V.p3()),N&&(U(Y,P,V),l=Y.length);else{if(V||(V=P.dm().getDatas()),!V.length)return;if((N||!H)&&(Y=[],V.forEach(function(c){U(Y,P,c)}),l=Y.length,!l))return;if(!H){for(T.set(0,0,0),y=0;l>y;y++)T.add(Y[y]);T.multiplyScalar(1/l)}}if(P.setCenter(T.x,T.y,T.z),O.subVectors($,X),D.direction||D.worldDirection){!D.worldDirection&&V instanceof f.Node?L.setFromEuler(z.set(V.r3(),V.getRotationMode(),!0)):L.set(0,0,0,1);var Q=O.length();O.fromArray(D.worldDirection||D.direction).applyQuaternion(L).setLength(Q)}var i=0;if(N){var h,R,A,r=D.ratio||.8,e=D.xRatio||r,w=D.yRatio||r;if(P.isOrtho()){var S=-1/0;for(P._eye[0]=O.x+T.x,P._eye[1]=O.y+T.y,P._eye[2]=O.z+T.z,h=yh(P),Zh(h,h,vn(P)),y=0;l>y;y++)A=Y[y],R=Ho([A.x,A.y,A.z,1],h),S=Math.max(S,Math.max(Math.abs(R[0])/e,Math.abs(R[1])/w));i=P.getOrthoWidth()*S,O.add(T)}else{for(var E,W,p=P.getNear(),C=10;C--;){for(P._eye[0]=O.x+T.x,P._eye[1]=O.y+T.y,P._eye[2]=O.z+T.z,h=yh(P),Zh(h,h,vn(P)),E=!0,W=-1/0,y=0;l>y;y++){if(A=Y[y],R=Ho([A.x,A.y,A.z,1],h),R[3]<p&&C){O.multiplyScalar(2),E=!1;break}W=Math.max(W,Math.max(Math.abs(R[0])/e,Math.abs(R[1])/w)-R[3])}if(E)break}O.setLength(W+O.length()).add(T)}}else O.setLength(D.distance).add(T);P._flyAnim&&P._flyAnim.stop(!0);var c=cl(D.animation);if(c){P.setEye($.x,$.y,$.z),P.setCenter(X.x,X.y,X.z);var t=(new ur).subVectors(O,$),q=(new ur).subVectors(T,X);if(i)var u=P.getOrthoWidth();var x=new ur,K=new ur,o=c.action,B=c._37o;return c.action=function(e,s){x.copy($).addScaledVector(t,e),K.copy(X).addScaledVector(q,e),P.setCenter(K.x,K.y,K.z),P.setEye(x.x,x.y,x.z),i&&P.setOrthoWidth((i-u)*e+u),o&&o(e,s)},c._37o=function(){delete P._flyAnim,B&&B()},{lastEye:$,lastCenter:X,eye:O,center:T,orthoWidth:i,animation:P._flyAnim=mq(c)}}return P.setEye(O.x,O.y,O.z),i&&P.setOrthoWidth(i),delete P._flyAnim,{lastEye:$,lastCenter:X,eye:O,center:T,orthoWidth:i}}}(),getBoundingBox:function(){function n(c,o,q){s.fromArray(Vl(q,o.getMat(q)));var L=q.getAnchor3d();c.push((new ur).set(0-L.x,0-L.y,0-L.z).applyMatrix4(s)),c.push((new ur).set(0-L.x,0-L.y,1-L.z).applyMatrix4(s)),c.push((new ur).set(0-L.x,1-L.y,0-L.z).applyMatrix4(s)),c.push((new ur).set(0-L.x,1-L.y,1-L.z).applyMatrix4(s)),c.push((new ur).set(1-L.x,0-L.y,0-L.z).applyMatrix4(s)),c.push((new ur).set(1-L.x,0-L.y,1-L.z).applyMatrix4(s)),c.push((new ur).set(1-L.x,1-L.y,0-L.z).applyMatrix4(s)),c.push((new ur).set(1-L.x,1-L.y,1-L.z).applyMatrix4(s))}var s=new Jb;return function(D){if(D=D||this.sm().getSelection(),D instanceof f.Node&&(D=[D]),0===D.length)return A;var H=[];D.forEach(function(g){n(H,this,g)},this);var O=[1/0,1/0,1/0],T=[-1/0,-1/0,-1/0];return H.forEach(function(u){O[0]=Math.min(u.x,O[0]),O[1]=Math.min(u.y,O[1]),O[2]=Math.min(u.z,O[2]),T[0]=Math.max(u.x,T[0]),T[1]=Math.max(u.y,T[1]),T[2]=Math.max(u.z,T[2])}),{min:O,max:T}}}()}),rp.RenderEnv=function(b){this.gv=b,this.enable=!1},I.defineProperties(rp.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(Q){this._debugOn=Q,this.capture&&this.capture()}}}),I.assign(rp.RenderEnv.prototype,{renderEnvToCube:function(E,q,t,v){var p=this,f=p.gv;if(!E||!q||!t)return p.enable=!1,p._42=null,void 0;p.enable=!0;var b=Math.floor(v/E*q),Y=f.getGL(),S=p._renderTargets;S?S.length<t&&(S=p._renderTargets=S.concat(new Array(t-S.length))):S=p._renderTargets=new Array(t);for(var M=0;t>M;M++)S[M]?S[M].setSize(Y,v,b):S[M]=new rp.RenderTarget(f,Y,v,b);var z=!1;p.capture=function(){z=!0,f._42(),z=!1};var F=new ur,Z=new ur,T=new ur,H=new ur,U=(new ur).setY(0),w=2*Math.PI/t,j=E/2/Math.tan(Math.PI/t),i=2*Math.atan2(q/2,j),L=E/q;p._42=function(g,C,c,n){var D=p._debugOn;if(!z&&!D)return!1;F.copy(f.getEye()),H.copy(f.getCenter()).sub(F);var B=Math.atan2(H.z,H.x),E=f.getNear(),Y=f.getFovy(),a=f.getAspect();Z.copy(f.getCenter());for(var X,V=0;t>V;V++)if(X=S[V],U.setZ(Math.cos(B)).setX(Math.sin(B)).multiplyScalar(j),B-=w,T.addVectors(F,U),f.setNear(j),f.setCenter([T.x,T.y,T.z]),f.setFovy(i),f.setAspect(L),D){var K=Math.round(C/t);g.viewport(K*V,0,K,c),n()}else $n(g,X.frame),g.viewport(0,0,X.width,X.height),g.clear(g.COLOR_BUFFER_BIT),n(),_h(g),X.assureTexture();return f.setNear(E),f.setCenter([Z.x,Z.y,Z.z]),f.setFovy(Y),f.setAspect(a),!0},p.capture()},getTextureInfo:function(P){var x=this._renderTargets;if(!x)return null;var m=this._renderTargets[P];return m?{index:P,texture:m.texture,textureName:m.uuid}:null}}),I.assign(rp.Graph3dView.prototype,{renderEnvToCube:function(j,p,L,h){var b=this;b.envRenderer||(b.envRenderer=new rp.RenderEnv(b)),b.envRenderer.renderEnvToCube(j,p,L,h)}}),rp.RenderTarget=function(O,n,B,C,$){var w=this;$=$||{},$.samples=Math.min(O._glCapabilities.maxSamples,$.samples&&$.samples>1&&2===O._webGLVersion?$.samples:0),w.options=$,w.uuid=f.Math.generateUUID(),w.gv=O,w.init(O,n,$),w.setSize(n,B,C)},I.assign(rp.RenderTarget.prototype,{bind:function(D){$n(D,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(A){_h(A),this.options.samples&&(A.bindFramebuffer(A.READ_FRAMEBUFFER,this._MSAAFbo),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,this.frame),A.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,A.COLOR_BUFFER_BIT,A.NEAREST),A.bindFramebuffer(A.READ_FRAMEBUFFER,null),A.bindFramebuffer(A.DRAW_FRAMEBUFFER,null))},init:function(N,E,S){var R=this,j=R.texture=E.createTexture();E.activeTexture(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,j),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_S,E.CLAMP_TO_EDGE),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_WRAP_T,E.CLAMP_TO_EDGE);var h=S.samples,_=h?E.NEAREST:E.LINEAR;E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MIN_FILTER,S.minFilter||_),E.texParameteri(E.TEXTURE_2D,E.TEXTURE_MAG_FILTER,S.magFilter||_),E.bindTexture(E.TEXTURE_2D,null),R.render=E.createRenderbuffer(),R.frame=E.createFramebuffer(),h&&(R._MSAAFbo=E.createFramebuffer(),R._MSAARbO=E.createRenderbuffer()),N._2O[R.uuid]=j},assureTexture:function(){var W=this,x=W.uuid,C=W.gv._2O;C[x]||(C[x]=W.texture)},setSize:function(O,w,G){var X=this;if(w&&G&&(X.width!==w||X.height!==G)){var o=O.RGBA,r=O.TEXTURE_2D,B=O.RENDERBUFFER,C=O.FRAMEBUFFER,b=X.options.samples;sk(O,X.texture),O.texImage2D(r,0,o,w,G,0,o,O.UNSIGNED_BYTE,A),O.bindRenderbuffer(B,X.render),b?O.renderbufferStorageMultisample(B,b,O.DEPTH_COMPONENT16,w,G):O.renderbufferStorage(B,O.DEPTH_COMPONENT16,w,G),$n(O,X.frame),O.framebufferTexture2D(C,O.COLOR_ATTACHMENT0,r,X.texture,0),b||O.framebufferRenderbuffer(C,O.DEPTH_ATTACHMENT,B,X.render),_h(O),b&&(O.bindRenderbuffer(O.RENDERBUFFER,X._MSAARbO),O.renderbufferStorageMultisample(O.RENDERBUFFER,b,O.RGBA8,w,G),$n(O,X._MSAAFbo),O.framebufferRenderbuffer(O.FRAMEBUFFER,O.COLOR_ATTACHMENT0,O.RENDERBUFFER,X._MSAARbO),O.framebufferRenderbuffer(C,O.DEPTH_ATTACHMENT,B,X.render),_h(O)),sk(O,A),O.bindRenderbuffer(B,A),X.width=w,X.height=G}},toCanvas:function(){var i=this,b=i.gv.getGL();$n(b,i.frame);var s=i.width,x=i.height,d=new Uint8Array(4*s*x);b.readPixels(0,0,s,x,b.RGBA,b.UNSIGNED_BYTE,d),_h(b);var H=J.createElement("canvas");H.width=s,H.height=x;var G=H.getContext("2d"),T=G.createImageData(s,x);return T.data.set(d),G.putImageData(T,0,0),H}});var nr=rp.Interactor=function(o){this.gv=o};gq("Interactor",I,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Qq=rp.DefaultInteractor=function(P){To(Qq,this,[P])};gq("DefaultInteractor",nr,{handle_contextmenu:function(G){Ec(G)},handle_mousewheel:function(l){this.gv.handleScroll(l,l.wheelDelta/40)},handle_DOMMouseScroll:function(_){2===_.axis&&this.gv.handleScroll(_,-_.detail)},handle_keydown:function(L){this.gv.handleKeyDown(L)},handle_mousedown:function(B){this.handle_touchstart(B)},handle_touchstart:function(S){Ec(S);var j=this,J=j.gv,o=im(S),D=J.getDataInfoAt(S),d=D?D.data:A,L=D?D.part:A,p=J.sm(),X=se(S),l=Sc(S);J.setFocus(S)&&(j._62O=A,j._57I=A,d?Hr(S)?p.co(d)?p.rs(d):p.as(d):p.co(d)||p.ss(d):o&&(Hr(S)?J.isRectSelectable()&&(j._62O=lk):j._57I=Pb(S)),j._31Q&&(kb(j._31Q),delete j._31Q,delete j._32Q),j._62O||(J.isFirstPersonMode()&&(ah(S)||fc(S)||l>2?j._62O="pan":J.isMouseRoamable()||hj?(j._62O="roaming",j.foward=X&&im(S),j._32Q=Yr(),j._31Q=Bm(j.tick,j)):o||(j._62O="roaming")),j._62O||(o&&X&&dk[L]?(j._62O=L,j.p3=d.p3()):o&&X&&uh(d)&&J.isSelected(d)?J.isMovable(d)?(j._62O="move",j.p3=d.p3(),j.movedata=d):J._39Q(d)&&(j._62O="none"):hj&&(l>2?j._62O="pan":2===l&&(j.dist=Gl(S),j._62O="pinch")))),j.point=J.lp(S),Ff(j,S),yk(S)?J.handleDoubleClick(S,d,L):J.handleClick(S,d,L))},tick:function(){var A=this,e=A.gv,l=e._moveStep;A.point&&e.isWalkable()&&(A._32Q&&(l*=(Yr()-A._32Q)/50),e.walk(A.foward?l:-l),A._32Q=Yr(),A._31Q=Bm(A.tick,A))},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(f){var a=this._57I;a&&(Ng(a,Pb(f))<=1&&this.gv.sm().cs(),this._57I=A)},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(E){var O,i,T=this,x=T.gv,P=T._62O,Z=T.point,w=x.dm(),U=x.lp(E),v=U.x-Z.x,g=U.y-Z.y,$=x.getWidth(),q=x.getHeight();if($&&q){var e=-H*v/$,I=-H*g/q;if("roaming"===P)T.rotate(E,e/2,I/2);else if(P===eb||P===ps||P===bo)x._86O||w.beginTransaction(),x.fi({kind:x._86O?"betweenEditRotation":"beginEditRotation",event:E}),x._86O=1,x.sm().each(function(m){if(uh(m)&&x.isRotationEditable(m)){var h=G(e)>G(I)?e:I;P===eb?m.setRotationX(m.getRotationX()+h):P===ps?m.setRotationY(m.getRotationY()+h):P===bo&&m.setRotationZ(m.getRotationZ()+h)}});else if("move"===P||dk[P]){P===Jk||P===ij||P===Uj?(x._87O||w.beginTransaction(),x.fi({kind:x._87O?"betweenEditScale":"beginEditScale",event:E}),x._87O=1):(x._moving||w.beginTransaction(),x.fi({kind:x._moving?"betweenMove":"beginMove",event:E}),x._moving=1);var B,Y=T.p3,L=x.getPositionInfo(Y),d=vn(x);B=P===ed?"x":P===Be?"y":P===Go?"z":P===Jk?"sx":P===ij?"sy":P===Uj?"sz":x.getMoveMode(E,T.movedata),v=v/$*L.width,g=-1*g/q*L.height;var s,F,b=[d[0]*v,d[4]*v,d[8]*v],X=[d[1]*g,d[5]*g,d[9]*g],W=b[0]+X[0],r=b[1]+X[1],o=b[2]+X[2],M=[Y[0]+W,Y[1]+r,Y[2]+o],k=Dg(x.getEye(),M,!0);if("xyz"===B?(s=M,x.moveSelection(W,r,o)):"xz"===B?(s=Kp(x,Y,[0,1,0],M),s&&x.moveSelection(s[0]-Y[0],0,s[2]-Y[2])):"xy"===B?(s=Kp(x,Y,[0,0,1],M),s&&x.moveSelection(s[0]-Y[0],s[1]-Y[1],0)):"yz"===B?(s=Kp(x,Y,[1,0,0],M),s&&x.moveSelection(0,s[1]-Y[1],s[2]-Y[2])):"x"===B||"sx"===B?(k[0]=0,s=Kp(x,Y,k,M),s&&(F=s[0]-Y[0],"x"===B?x.moveSelection(F,0,0):x.sm().each(function(f){uh(f)&&x.isSizeEditable(f)&&(O=f.getScaleX()+F/100,i=O/f.getScaleX(),f.setScaleX(O),ah(E)&&(f.setScaleY(f.getScaleY()*i),f.setScaleTall(f.getScaleTall()*i)))}))):"y"===B||"sy"===B?(k[1]=0,s=Kp(x,Y,k,M),s&&(F=s[1]-Y[1],"y"===B?x.moveSelection(0,F,0):x.sm().each(function(w){uh(w)&&x.isSizeEditable(w)&&(O=w.getScaleTall()+F/100,i=O/w.getScaleTall(),w.setScaleTall(O),ah(E)&&(w.setScaleY(w.getScaleY()*i),w.setScaleX(w.getScaleX()*i)))}))):("z"===B||"sz"===B)&&(k[2]=0,s=Kp(x,Y,k,M),s&&(F=s[2]-Y[2],"z"===B?x.moveSelection(0,0,F):x.sm().each(function(T){uh(T)&&x.isSizeEditable(T)&&(O=T.getScaleY()+F/100,i=O/T.getScaleY(),T.setScaleY(O),ah(E)&&(T.setScaleX(T.getScaleX()*i),T.setScaleTall(T.getScaleTall()*i)))}))),!s)return;T.p3=s}else if(P===lk){var f=T.div;f||(f=T.div=Gj(),gr(T.getView(),f),f.op=Z,f.style.background=x.getRectSelectBackground()),x.fi({kind:x._rectSelecting?"betweenRectSelect":"beginRectSelect",event:E}),x._rectSelecting=1,f.rect=pj(f.op,U),tj(f,f.rect)}else if("pinch"===P&&2===Sc(E)){x.fi({kind:x._pinching?"betweenPinch":"beginPinch",event:E}),x._pinching=1;var F=Gl(E);x.handlePinch(F,T.dist),T.dist=F}else"pan"===P||ah(E)||fc(E)?T.pan(E,v,g):"none"===P||x.isFirstPersonMode()||T.rotate(E,e,I);T.point=U}},pan:function(l,Q,r){var j=this.gv;if(j.isPannable()){var A=j.getWidth(),v=j.getHeight();if(!A||!v)return;var $=j.getCenterInfo(),e=Q/A*$.width,C=-1*r/v*$.height;j.fi({kind:j._panning?"betweenPan":"beginPan",event:l}),j._panning=1,j.pan(-e,-C)}},rotate:function(R,f,X){var x=this.gv;x.isRotatable()&&(x.fi({kind:x._rotating?"betweenRotate":"beginRotate",event:R}),x._rotating=1,x.rotate(f,X))},handleWindowMouseUp:function(i){this.handleWindowTouchEnd(i)},handleWindowTouchEnd:function(i){var P=this,U=P.gv,j=U.dm(),O=P.div;if(O){var b=U.getDatasInRect(O.rect);if(!b.isEmpty()){var v=U.sm(),R=v.toSelection();b.each(function(s){v.co(s)?R.remove(s):R.add(s)}),v.ss(R)}ws(O)}U._moving&&(delete U._moving,U.fi({kind:"endMove",event:i}),U.onMoveEnded(),j.endTransaction()),U._panning&&(delete U._panning,U.fi({kind:"endPan",event:i}),U.onPanEnded()),U._rotating&&(delete U._rotating,U.fi({kind:"endRotate",event:i}),U.onRotateEnded()),U._86O&&(delete U._86O,U.fi({kind:"endEditRotation",event:i}),j.endTransaction()),U._87O&&(delete U._87O,U.fi({kind:"endEditScale",event:i}),j.endTransaction()),U._pinching&&(delete U._pinching,U.fi({kind:"endPinch",event:i}),U.onPinchEnded()),U._rectSelecting&&(delete U._rectSelecting,U.fi({kind:"endRectSelect",event:i}),U.onRectSelectEnded()),U._walking&&(delete U._walking,U.fi({kind:"endWalk",event:i}),U.onWalkEnded()),P.dist=P.point=P._62O=P.p3=P.movedata=P.div=P._57I=P._32Q=P._31Q=P.foward=A}});var gp=rp.MapInteractor=function(I){To(gp,this,[I]),this._minPhi=0,this._maxPhi=5*s/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};gq("MapInteractor",nr,{handle_contextmenu:function(K){Ec(K)},handle_mousewheel:function(b){this.gv.handleScroll(b,b.wheelDelta/40)},handle_DOMMouseScroll:function($){2===$.axis&&this.gv.handleScroll($,-$.detail)},handle_keydown:function(c){this.gv.handleKeyDown(c)},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(X){Ec(X);var N=this,P=N.gv;if(P.setFocus(X)){P.lp(X);var H=P.getDataInfoAt(X),D=H?H.data:A,I=H?H.part:A;if(!D||!P._39Q(D)){var n=N.editing={point:P.lp(X)};hj?n.touch=!0:(n.touch=!1,n.clickLeft=im(X),n.pan=fc(X)?!0:"left"===this.panButton===n.clickLeft),Ff(N,X)}yk(X)?P.handleDoubleClick(X,D,I):P.handleClick(X,D,I)}},handle_mouseup:function(s){this.handle_touchend(s)},handle_touchend:function(){},handleWindowMouseMove:function(D){this.handleWindowTouchMove(D)},handleWindowTouchMove:function(Y){var q=this,l=q.gv,k=q.editing;if(k){var g=l.lp(Y),y=k.point,J=g.x-y.x,r=g.y-y.y;if(!k.moved){if(Math.abs(J)<q.threshold&&Math.abs(r)<q.threshold&&!(Y.touches&&Y.touches.length>1))return;k.moved=!0}if(k.point=g,k.touch){var C=Y.touches.length;if(2!==C)q.pan(Y,J,r);else{if(1>=C)return;var x=Y.touches,h={x:x[0].clientX,y:x[0].clientY},F={x:x[1].clientX,y:x[1].clientY},j={x:F.x-h.x,y:F.y-h.y},O=k.lastCenter,e=Math.atan2(j.y,j.x),K=k.theta,M=0;K==A?K=k.theta=e:(M=e-K,k.thetaStarted||Math.abs(M)>q.touchRotateThreshold?(k.thetaStarted=!0,k.theta=e):M=0);var L=s*(h.y+F.y)/2/l.getHeight(),$=k.phi,Q=0;$==A?$=k.phi=L:(Q=L-$,k.phiStarted||Math.abs(Q)>q.touchRotateThreshold?(k.phiStarted=!0,k.phi=L):Q=0);var _,z=Math.sqrt(j.x*j.x+j.y*j.y),p=k.vlen;if(p){var v=h.x-O.x,D=h.y-O.y,U=F.x-O.x,f=F.y-O.y,d=Math.sqrt(v*v+D*D),E=Math.sqrt(U*U+f*f),i=p/2,R=q._sign2(d-i),W=q._sign2(E-i);0>R*W||0===R&&0===W?(_=1,k.vlen=z):(_||(_=z/p),k.scaleStarted||Math.abs(_-1)>q.touchScaleThreshold?(k.vlen=z,k.scaleStarted=!0):_=1)}else p=k.vlen=z,_=1;1!==_&&l.setZoom(_),(Q||M)&&q.rotate(Y,M,-Q),k.lastCenter={x:(F.x+h.x)/2,y:(F.y+h.y)/2}}}else if(k.pan)q.pan(Y,J,r);else{var m=l.getWidth(),G=l.getHeight();if(!m||!G)return;var T=-H*J/m,S=-H*r/G;q.rotate(Y,T,S)}}},_sign2:function(W){return Math.abs(W)<this._touchScaleCheckAccuracy?0:W>0?1:-1},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(n){var C=this,z=C.editing;if(C.editing=null,z){var y=C.gv;if(!z.moved&&z.clickLeft){var Z=y.getDataAt(n);Z?y.sm().setSelection([Z]):y.sm().clearSelection()}else y._panning=null,y._rotating=null,y.fi({kind:z.pan?"endPan":"endRotate",event:n})}},pan:function(e,J,Q){var s=this,b=s.gv;if(b.isPannable()){var d=b.getWidth(),K=b.getHeight();if(d&&K){var V=b.getCenterInfo(),S=-J/d*V.width,j=1*Q/K*V.height;b.fi({kind:b._panning?"betweenPan":"beginPan",event:e}),b._panning=1;var C=s.keepHorizon,X=s.editing.touch;if((X&&e.touches&&e.touches.length>1||!X&&ah(e))&&(C=!C),!C)return b.pan(S,j);if(S||j){var h=vn(b),i=[h[0]*S,h[4]*S,h[8]*S],r=[h[1],0,h[9]],o=Math.sqrt(r[0]*r[0]+r[2]*r[2]);o&&(r=[r[0]/o*j,0,r[2]/o*j]);var x=i[0]+r[0],f=i[1]+r[1],P=i[2]+r[2],Z=b._center,u=b._eye;Z[0]+=x,Z[1]+=f,Z[2]+=P,u[0]+=x,u[1]+=f,u[2]+=P,b.fp(vf,A,u),b.fp(db,A,Z)}}}},rotate:function(V,i,D){var o=this,L=o.gv;if(L.isRotatable()){var m=L._center,J=L._eye,l=Dg(J,m),f=b(r(l[0]*l[0]+l[2]*l[2]),l[1]),Z=f+D;Z=Math.max(o.minPhi,Math.min(o.maxPhi,Z)),D=Z-f,L.fi({kind:L._rotating?"betweenRotate":"beginRotate",event:V}),L._rotating=1,L.rotate(i,D)}}}),I.defineProperties(gp.prototype,{panButton:{get:function(){return this._panButton},set:function(m){this._panButton=m}},minPhi:{get:function(){return this._minPhi},set:function(L){this._minPhi=L}},maxPhi:{get:function(){return this._maxPhi},set:function(o){this._maxPhi=o}},keepHorizon:{get:function(){return this._keepHorizon},set:function(f){this._keepHorizon=f}},threshold:{get:function(){return this._threshold},set:function(u){this._threshold=u}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(E){this._touchScaleThreshold=E}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(Q){this._touchRotateThreshold=Q}}});var Mn=function(U){this.gv=U};Bg(Mn,I,{_iv:!0,iv:function(){this._iv=!0},face:function(u,N){var K=this,b=K.gv.getGL();if(!b||!uh(u))return A;var y=N.x,W=N.width,o=N.height,S=K.height-N.y-o,X=d(W/2),B=new Uint8Array(4*W*o),J=0;for(K.iv(),K.validate(u),$n(b,K.frame),b.readPixels(y,S,W,o,b.RGBA,b.UNSIGNED_BYTE,B),_h(b),K.iv();X>=J;J++)for(var O=X-J,U=X+J,l=O;U>=l;l++)for(var P=O;U>=P;P++)if(l===O||l===U||P===O||P===U){var D=ln.m[B[4*(l*W+P)]];if(D)return D}},get:function(S,C){this.validate();var i=this,D=i.gv.getGL();if(!D)return A;var o,c,$=S.x,T=S.width,n=S.height,H=i.height-S.y-n,E=d(T/2),m=new Uint8Array(4*T*n),q=0,X=m.length,W=C?A:new Dj,a=C?A:{};if($n(D,i.frame),D.readPixels($,H,T,n,D.RGBA,D.UNSIGNED_BYTE,m),_h(D),C){for(;E>=q;q++)for(var B=E-q,t=E+q,v=B;t>=v;v++)for(var K=B;t>=K;K++)if((v===B||v===t||K===B||K===t)&&(o=i.info(m,4*(v*T+K))))return o}else for(;X>q;q+=4)o=i.info(m,q),o&&(c=o.data,a[c._id]||(W.add(c),a[c._id]=c));return W},info:function(Y,c){return this.colorMap[(Y[c]<<16)+(Y[c+1]<<8)+Y[c+2]+((127&Y[c+3])<<24)]},validate:function(e){var O=this,C=O.gv,K=C.getGL();if(K){var G=C.getWidth(),p=C.getHeight(),l=K.RGBA,N=K.TEXTURE_2D,D=K.RENDERBUFFER,I=K.FRAMEBUFFER;O.texture||(O.texture=jg(K),O.render=K.createRenderbuffer(),O.frame=K.createFramebuffer()),(O.width!==G||O.height!==p)&&(sk(K,O.texture),K.texImage2D(N,0,l,G,p,0,l,K.UNSIGNED_BYTE,A),ik(K,K.TEXTURE_MIN_FILTER,K.LINEAR),K.bindRenderbuffer(D,O.render),K.renderbufferStorage(D,K.DEPTH_COMPONENT16,G,p),$n(K,O.frame),K.framebufferTexture2D(I,K.COLOR_ATTACHMENT0,N,O.texture,0),K.framebufferRenderbuffer(I,K.DEPTH_ATTACHMENT,D,O.render),sk(K,A),K.bindRenderbuffer(D,A),_h(K),O.width=G,O.height=p),O._iv&&(O._iv=!1,$n(K,O.frame),C._42(e||(O.colorMap={}),1),_h(K))}}});var Rd=function(w){this.gv=w};Bg(Rd,I,{gap:0,size:0,_42:function(D,J){var S=this,M=S.gv,H=M._gridGap,s=M._gridSize;if(M._gridVisible){if(S.gap!==H||S.size!==s){for(var F=[],Q=M._gridSize/2,B=H*Q,m=0;2*Q+1>m;m++){var W=6*m,G=6*(2*Q+1)+W;F[W]=-B,F[W+1]=0,F[W+2]=-B+m*H,F[W+3]=B,F[W+4]=0,F[W+5]=-B+m*H,F[G]=-B+m*H,F[G+1]=0,F[G+2]=-B,F[G+3]=-B+m*H,F[G+4]=0,F[G+5]=B}S.vs=new cb(F),S.gap=H,S.size=s}xm(M),bk(D,J),wd(D),rn(D,J,1,M._gridColor,M._buffer.vs,S.vs),Gh(D,0,S.vs.length/3,D.LINES),Oo(D),ee(D,J)}else S.vs=S.gap=S.size=A}});var Se=function(D){this.gv=D};Bg(Se,I,{_42:function(N,g){var D=this.gv,K=D._buffer.vs,r=D._axisXColor,b=D._axisYColor,s=D._axisZColor,d=D._originAxisVisible,y=D._centerAxisVisible;if(d||y){var i=Oe?N.TRIANGLES:N.TRIANGLE_FAN,n=N.LINES;if(xm(D),bk(N,g),wd(N),d){var S=D.getCenterInfo(),W=Y(S.width,S.height)/5,X=.8*W,L=.05*W;rn(N,g,1.5,r,K,new cb([0,0,0,W,0,0,X,L,0,X,0,L,X,-L,0,X,0,-L,X,L,0,0,0,0,0,W,0,L,X,0,0,X,L,-L,X,0,0,X,-L,L,X,0,0,0,0,0,0,W,L,0,X,0,L,X,-L,0,X,0,-L,X,L,0,X])),Gh(N,0,2,n),Gh(N,1,6,i),rn(N,g,A,b),Gh(N,7,2,n),Gh(N,8,6,i),rn(N,g,A,s),Gh(N,14,2,n),Gh(N,15,6,i)}if(y){var $=D._center,V=$[0],M=$[1],j=$[2],S=D.getPositionInfo($);W=Y(S.width,S.height)/20,rn(N,g,1.5,r,K,new cb([V,M,j,V+W,M,j,V,M,j,V,M+W,j,V,M,j,V,M,j+W])),Gh(N,0,2,n),rn(N,g,A,b),Gh(N,2,2,n),rn(N,g,A,s),Gh(N,4,2,n)}Oo(N),ee(N,g)}}});var Lm=function(t){this.gv=t,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Lm.Mode.Disable};Lm.Mode={Disable:0,Selection:1,MouseOver:2},Bg(Lm,I,{onMouseOver:function(x){O.preventDefault(x);var F=this.gv.getDataAt(x);F!==this.mouseOverData&&(this.mouseOverData=F,this.gv.iv())},setFetchTargetFunc:function(N){this.fetchTargetFunc=N},_42:function(J,B){var Z,k=this,C=k._mode;if(C!==Lm.Mode.Disable&&(C===Lm.Mode.Selection?Z=k.gv.sm().getSelection().toArray(function(T){return T.s("highlight.visible")}):C===Lm.Mode.MouseOver&&k.mouseOverData&&k.mouseOverData.s("highlight.visible")&&(Z=[k.mouseOverData]),k.fetchTargetFunc&&(Z=k.fetchTargetFunc(Z)),Z&&Z.length)){var y=k.gv,D=y.vr.isPresenting(),S=y.getWidth();if(D){var R=y.getWidth;S/=2,y.getWidth=function(){return S};var E=y.getViewport()}var d,b=y.getDevicePixelRatio(),G=S*b,U=y.getHeight()*b;(d=k._renderTarget)?d.setSize(J,G,U):k._renderTarget=d=new rp.RenderTarget(y,J,G,U),$n(J,d.frame),y.drawFilter=function(p){return Z.indexOf(p)<0?!0:void 0},y._42({}),y.drawFilter=null,_h(J),D&&(y.getWidth=R,y.setViewport(J,E[0],E[1],E[2],E[3])),k.shader||(k.shader=new kf.Shader(J,Fm.vs,Fm.fs));var r=k.shader;if(k.shader.bind(),J.enable(J.BLEND),J.activeTexture(J.TEXTURE0+0),J.bindTexture(J.TEXTURE_2D,d.texture),r.uniforms.image=0,r.uniforms.textureSize=[G,U],r.uniforms.edgeWidth=K["highlight.width"],k.highlightColor!==K["highlight.color"]){var z=en(k.highlightColor=K["highlight.color"]);k.highlightColorData=[z[0]/255,z[1]/255,z[2]/255,z[3]/255]}r.uniforms.edgeColor=k.highlightColorData,k.ibuffer?(k.ibuffer.upload(),k.vbuffer.upload()):(k.ibuffer=kf.Buffer.createIndexBuffer(J,new Uint16Array([0,2,1,1,2,3])),k.vbuffer=kf.Buffer.createVertexBuffer(J,new Float32Array([0,0,1,0,0,1,1,1]))),r.attributes.pos.pointer(k.vbuffer),J.drawElements(J.TRIANGLES,6,J.UNSIGNED_SHORT,0),J.disable(J.BLEND),J.bindTexture(J.TEXTURE_2D,null),J.useProgram(B)}}}),I.defineProperties(Lm.prototype,{mode:{get:function(){return this._mode},set:function(y){var w=this._mode;y!==w&&(this._mode=y,y===Lm.Mode.MouseOver?x(this.gv.getView(),"mousemove",this.onMouseOver):w===Lm.Mode.MouseOver&&h(this.gv.getView(),"mousemove",this.onMouseOver))
}}});var Fm={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},zi=function(u){this.gv=u},ed="edit_tx",Be="edit_ty",Go="edit_tz",eb="edit_rx",ps="edit_ry",bo="edit_rz",Jk="edit_sx",ij="edit_sy",Uj="edit_sz",dk={};dk[ed]=1,dk[Be]=1,dk[Go]=1,dk[eb]=1,dk[ps]=1,dk[bo]=1,dk[Jk]=1,dk[ij]=1,dk[Uj]=1,Bg(zi,I,{_42:function(z,f,_){var M=this,l=M.gv,F=l.sm().ld();if(F&&l.isEditable(F)&&!l.isEditHelperDisabled()&&uh(F)&&(!l.isFirstPersonMode()||!l.isMouseRoamable()&&!hj)){xm(l);var X,O,L=l.isMovable(F),Q=l.isRotationEditable(F),Y=l.isSizeEditable(F),U=l._axisXColor,A=l._axisYColor,g=l._axisZColor,d=l._editSizeColor,q=F.p3(),N=Ng(l.getEye(),q)/10,C=N/(_?5:10),S=.7*N,m=.4*S,v=q[0],B=q[1],r=q[2];X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],L&&M._17O(z,f,F,_,ed,U,X,[v,B-C,r,v+S,B-C,r,v+S,B,r,v+S,B,r,v,B,r,v,B-C,r,v,B-C,r+C,v+S,B-C,r+C,v+S,B-C,r,v+S,B-C,r,v,B-C,r,v,B-C,r+C]),O=v+S,Y&&M._17O(z,f,F,_,Jk,d,X,[O,B-C,r,O+m,B-C,r,O+m,B,r,O+m,B,r,O,B,r,O,B-C,r,O,B-C,r+C,O+m,B-C,r+C,O+m,B-C,r,O+m,B-C,r,O,B-C,r,O,B-C,r+C]),O+=m,Q&&M._17O(z,f,F,_,eb,U,X,[O,B-C,r,O+m,B-C,r,O+m,B,r,O+m,B,r,O,B,r,O,B-C,r,O,B-C,r+C,O+m,B-C,r+C,O+m,B-C,r,O+m,B-C,r,O,B-C,r,O,B-C,r+C]),X=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],L&&M._17O(z,f,F,_,Be,A,X,[v,B,r,v,B+S,r,v-C,B+S,r,v-C,B+S,r,v-C,B,r,v,B,r,v,B,r,v,B,r-C,v,B+S,r-C,v,B+S,r-C,v,B+S,r,v,B,r]),O=B+S,Y&&M._17O(z,f,F,_,ij,d,X,[v,O,r,v,O+m,r,v-C,O+m,r,v-C,O+m,r,v-C,O,r,v,O,r,v,O,r,v,O,r-C,v,O+m,r-C,v,O+m,r-C,v,O+m,r,v,O,r]),O+=m,Q&&M._17O(z,f,F,_,ps,A,X,[v,O,r,v,O+m,r,v-C,O+m,r,v-C,O+m,r,v-C,O,r,v,O,r,v,O,r,v,O,r-C,v,O+m,r-C,v,O+m,r-C,v,O+m,r,v,O,r]),X=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],L&&M._17O(z,f,F,_,Go,g,X,[v,B,r,v,B,r+S,v,B-C,r+S,v,B-C,r+S,v,B-C,r,v,B,r,v,B-C,r,v-C,B-C,r,v-C,B-C,r+S,v-C,B-C,r+S,v,B-C,r+S,v,B-C,r]),O=r+S,Y&&M._17O(z,f,F,_,Uj,d,X,[v,B,O,v,B,O+m,v,B-C,O+m,v,B-C,O+m,v,B-C,O,v,B,O,v,B-C,O,v-C,B-C,O,v-C,B-C,O+m,v-C,B-C,O+m,v,B-C,O+m,v,B-C,O]),O+=m,Q&&M._17O(z,f,F,_,bo,g,X,[v,B,O,v,B,O+m,v,B-C,O+m,v,B-C,O+m,v,B-C,O,v,B,O,v,B-C,O,v-C,B-C,O,v-C,B-C,O+m,v-C,B-C,O+m,v,B-C,O+m,v,B-C,O])}},_17O:function(e,Z,v,O,W,N,p,X){var y=this.gv._buffer;gs(e,Z,O,!0,v,W),Pj(e,Z,A,!0,A,!0,A,!1),ob(e,Z.uDiffuse,N),vm(e,y.vs,new cb(X),Z.aPosition),vm(e,y.ns,new cb(p),Z.aNormal),wd(e),Gh(e,0,12),Oo(e),If(e,Z)}});var td=f.Raycaster=function(O){this.gv=O,this.maxTriangleTest=1/0};Pd("Raycaster",I,{intersect:function(n){var F=this,z=F.gv,L=z.getDataAt(n);return L?F.intersectObject(n,L):null},intersectObjects:function(d,F,N){var E,o,v,R,q=this,u=1/0,V=d.origin||(new ur).fromArray(q.gv.getEye()),s=q.maxTriangleTest,U=[];return F.forEach(function(j){N&&N(j)===!1||j.s("intersect")!==!1&&U.push(j)}),U.sort(function(p,m){return V.distanceToSquared2(p.p3())-V.distanceToSquared2(m.p3())}),q.countTriangles=0,U.forEach(function(k){q.countTriangles>s||(E=q.intersectObject(d,k),E&&(o=V.distanceToSquared(E.world),u>o&&(v=k,R=E,u=o)))}),q.countTriangles=0,{data:v,intersect:R}},intersectObject:function(m,X){if(m instanceof Ro)return this._intersectObjectImpl(m,X);var U=this,Q=U.gv,J=Q.unproject(m),G=new ur,M=Q.getEye(),j=new ur;if(Q.isOrtho()){var S=new ur(M);j.copy(Q.getCenter()).sub(S).normalize();var r=G.copy(J).sub(S).dot(j);G.copy(j).setLength(-r).add(S.copy(J))}else G.copy(M),j.copy(J).sub(G).normalize();var h=new f.Math.Ray(G,j);return U._intersectObjectImpl(h,X)},_intersectObjectImpl:function(){function b(){var U=new ur;return U.subVectors(z,O),k.subVectors(C,O),U.cross(k).normalize(),U}function j(y,P,c,v,$,L,J){return Jq.barycoordFromPoint(y,P,c,v,U),$.multiplyScalar(U.x),L.multiplyScalar(U.y),J.multiplyScalar(U.z),$.add(L).add(J),$.clone()}var s=new Jb,M=new Jb,E=new Ro,l=new ur,F=new ur,K=new ur,D=new ur,R=new ur,C=new ur,O=new ur,z=new ur,Z=new Dh,d=new Dh,q=new Dh,k=new ur,I={vs:Mg,is:Io,uv:_g},U=new ur;return function(v,k){var g=this.gv.getData3dUI(k),c=k.mat||g.mat;if(c){s.fromArray(c),M.getInverse(s),E.copy(v).applyMatrix4(M);var o,w,J="body",h=g.shapeModel;if(h||(h=Qi(g)),h||(k instanceof f.Node&&!(k instanceof f.Shape)?(o=!0,h=I):(w=!0,h=[g.left,g.front,g.right,g.back,g.top,g.bottom])),!h)return console.log("Can not find shape model."),null;Nq(h)||(h=[h]);var G,$,T,S,L,X,i,B,Q,e,_,Y,p,t,A,x,n=1/0,H=["","top_","bottom_"],U=!1;for(G=0,$=h.length;$>G;G++)if(p=h[G])for(T=0,S=H.length;S>T;T++)if(t=H[T],i=p[t+"vs"],B=p[t+"is"],Q=p[t+"uv"]||p[t+"tuv"],i){if(A=p[t+"boundingBox"]){var _=E.intersectBox(A);if(!_)continue;if(E.origin.distanceTo(_)>n)continue;x=!1}else p[t+"boundingBox"]=A=new f.Math.Box3,x=!0;for(L=0,X=B?B.length:i.length/3;X>L;L+=3)this.countTriangles++,B?(F.fromArray(i,3*B[L]),K.fromArray(i,3*B[L+1]),D.fromArray(i,3*B[L+2])):(F.fromArray(i,3*L),K.fromArray(i,3*(L+1)),D.fromArray(i,3*(L+2))),x&&(A.expandByPoint(F),A.expandByPoint(K),A.expandByPoint(D)),e=E.intersectTriangle(F,K,D,!0,l),e&&(Y=E.origin.distanceTo(e),n>Y&&(n=Y,R.copy(e),C.copy(F),O.copy(K),z.copy(D),""!==t?J=t.slice(0,-1):o?J=hm[Math.floor(L/6)]:w&&(J=hm[G]),Q&&(U=!0,B?(Z.fromArray(Q,2*B[L]),d.fromArray(Q,2*B[L+1]),q.fromArray(Q,2*B[L+2])):(Z.fromArray(Q,2*L),d.fromArray(Q,2*(L+1)),q.fromArray(Q,2*(L+2))))))}if(!isFinite(n))return null;var m,W=R.clone().applyMatrix4(s);U&&(m=j(R,C,O,z,Z,d,q));var P=b(C,O,z),a=b(C.applyMatrix4(s),O.applyMatrix4(s),z.applyMatrix4(s)),N=E.direction.dot(P);return N>0&&(P.multiplyScalar(-1),a.multiplyScalar(-1)),{world:W,local:R.clone(),worldNormal:a,normal:P,uv:m,part:J}}}}()});var Up=function(E,f){this.gv=E,this.s=function(F,w,T){return w==A&&(w=T),w==A?f.getStyle(F):Ti(w,f,E)},this.data=f};Bg(Up,I,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(E,q,n,f){var X=this,j=X.data;if(!(j instanceof bb)){var U,M,G,L,_,R,z,I=X.gv,a=j._id,F=X.s("shape3d.alwaysOnTop")?null:X.s("batch"),H=I._batchIndexMap,w=I._batchModelMap,V=I.isSelectable(j),D=I.getBrightness(j),s=D!=A&&1!==D;if(X.needValidate(E)){if(G=Om(H,w,j,F),X.validate(G,F?on[F]||Zl:A),G&&(L=H[a],_=L.size=G.vs.length/3-L.begin,z=G.rs))for(D=s?D:1,R=0;_>R;R++)z.push(D);if(uh(j)){var l=I.getWireframeGeometry(j);if(l)bc(I,j,l);else{var Y=I.getWireframe(j);Y&&bc(I,j,Y)}}X.labelInfo=X.label2Info=X.noteInfo=X.note2Info=X._38o=A,X._24O(ch,"getLabel"),X._24O(Zo,"getLabel2"),X._26O(In,"getNote"),X._26O(jf,"getNote2"),X._15O(),X.interactiveInfo=I.isInteractive(j)?{}:A,X._iv=!1}s&&ob(E,q.uBrightness,D),ob(E,q.uAlphaTest,X.s("alphaTest")),ob(E,q.uUseEnvMap,j.s("envmap")?!0:!1),ob(E,q.uReflectivity,j.s("envmap")||.01),M=gs(E,q,n,V,j,dj),M&&(Tm(M,H[a],w),Tm(M,I._polylineIndexMap[a],I._polylineModelMap),Tm(M,I._wireframeIndexMap[a],I._wireframeModelMap)),H[a]||X._80o(E,q,f),I.isLabelVisible(j)&&((U=X.labelInfo)&&(gs(E,q,n,V,j,ch),X._28O(U,ch,f)),(U=X.label2Info)&&(gs(E,q,n,V,j,Zo),X._28O(U,Zo,f))),I.isNoteVisible(j)&&((U=X.noteInfo)&&(gs(E,q,n,V,j,In),X._29O(U,In,f)),(U=X.note2Info)&&(gs(E,q,n,V,j,jf),X._29O(U,jf,f))),(U=X._38o)&&X._99O(E,q,U,n,V,f),s&&ob(E,q.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return rf},_80o:function(){},dispose:function(){},_calcAnchorMat:function(b){if(b.hasOwnProperty("_anchor")||b.hasOwnProperty("_anchorElevation")){var E=b.getAnchor3d(),o={x:E.x-.5,y:E.y-.5,z:E.z-.5},l=co();return io(l,[-o.x,-o.y,-o.z]),l}},getBodyColor:function(o){var q=this.data,n=this.gv.getBodyColor(q);return n?n:o?q.getStyle(o):A},_24O:function(x,l){var p=this,H=p.data,N=p.gv,j=p.s,W=N[l](H);if(W!=A){var Q=j(x+".scale"),B=j(x+".max"),O=p[x+"Info"]={label:W,textureScale:j(x+".texture.scale"),color:N[l+"Color"](H),font:j(x+".font"),align:j(x+".align"),background:N[l+"Background"](H)},I=O.rect=Un(O,W);B>0&&B<I.width&&(O.labelWidth=I.width,I.width=B),I.x=I.y=0,I.width*=Q,I.height*=Q,O.mat=p._16O(j(x+".autorotate"),j(x+".position"),I,j(x+".face"),j(x+".t3"),j(x+".r3"),j(x+".rotationMode"));var k=I.width/2,z=I.height/2;O.vs=new cb([-k,z,0,-k,-z,0,k,-z,0,k,z,0]),I.width/=Q,I.height/=Q}},_26O:function(g,i){var K=this,s=K.data,M=K.gv,T=K.s,u=M[i](s);if(u!=A){var U=T(g+".scale"),z=this[g+"Info"]={note:u,textureScale:T(g+".texture.scale"),expanded:T(g+".expanded"),font:T(g+".font"),color:T(g+".color"),align:T(g+".align"),borderWidth:T(g+".border.width"),borderColor:T(g+".border.color"),background:M[i+"Background"](s)};if(z.expanded){var E=T(g+".max"),J=Un(z,u);J.width+=6,J.height+=2,E>0&&E<J.width&&(z.labelWidth=J.width,J.width=E);var Q={x:-J.width/2,y:-8-J.height,width:J.width,height:J.height+8}}else Q={x:-6,y:-18,width:12,height:18};z.mat=K._16O(T(g+".autorotate"),T(g+".position"),A,T(g+".face"),T(g+".t3"),T(g+".r3"),T(g+".rotationMode")),z.rect=Q,1!==U&&(Q=of(Q),Q.x*=U,Q.height*=U,Q.y=-Q.height,Q.width*=U);var H=Q.x,N=Q.y,n=Q.width,R=Q.height;z.vs=new cb([H,-N,0,H,-N-R,0,H+n,-N-R,0,H+n,-N,0])}},_28O:function(W,Z,L){if(L(this.s(Z+".transparent"))){var D=W.rect,l=W.textureScale,w=D.width*l,j=D.height*l;if(w>=1&&j>=1){var M=Fi(w,j);1!==l&&(M.translate(M,D.x,D.y),M.scale(l,l),M.translate(M,-D.x,-D.y)),qj(M,W),M.restore(),rk(this,Z,W.mat,W.vs,!0)}}},_29O:function(_,n,Y){if(Y(this.s(n+".transparent"))){var J=_.rect,R=_.textureScale,u=J.x,I=J.y,m=J.width*R,L=J.height*R;if(m>=1&&L>=1){J.x=J.y=0;var d=Fi(m,L);1!==R&&d.scale(R,R),yi(d,_),d.restore(),J.x=u,J.y=I,rk(this,n,_.mat,_.vs,!1)}}},_99O:function(B,H,z,d,y,Y){if(z){var o=this,q=o.gv,k=o.data,w=q._buffer,Q=q._1O,D=z.icons;for(var e in D){var V=D[e],C=z.rects[e];if(C&&Y(Ti(V.transparent,k,q))){gs(B,H,d,y,k,e);var j=Ti(V.shape3d,k,q),r=j?[j]:Ti(V.names,k,q),s=r?r.length:0,f=Ti(V.textureScale,k,q)||1,L=Ti(V.light,k,q);L==A&&(L=j?!0:!1),Pj(B,H,Ti(V.blend,k,q),L,Ti(V.opacity,k,q),Ti(V.reverseFlip,k,q),Ti(V.reverseColor,k,q),Ti(V.reverseCull,k,q));for(var S=0;s>S;S++){var g=r[S],v=C[S];if(Li(o,v.mat),j)wh(q,k,Qi(o,j),o);else{var G=qg(g);if(G){var u=v.width*f,b=v.height*f;if(u>=1&&b>=1){var p=Fi(u,b);Cl(p,G,Ti(V.stretch,k,q),0,0,u,b,k,q),p.restore(),jg(B,Le,Q),wd(B,H,Q,Ti(V.discardSelectable,k,q),w.uv,Rb),vm(B,w.vs,v.vs,H.aPosition),zp(B,w.ns,lp,H.aNormal),$q(B,w.is,Wf),ol(B,0,Wf.length),Oo(B,H,Q)}}}Lq(q)}If(B,H)}}}}});var Rm=function(d,M){To(Rm,this,[d,M])};Bg(Rm,Up,{_16O:function(o,F,O,V,Z,d,j,L,T){var p=this.data,v=p.getFinalScale3d(),S=cm(F,v,O,V,L,T);if(p.hasOwnProperty("_anchor")||p.hasOwnProperty("_anchorElevation")){var x=p.getAnchor3d();S[0]-=(x.x-.5)*v[0],S[1]-=(x.y-.5)*v[1],S[2]-=(x.z-.5)*v[2]}return yg(co(),S,p.p3(),V,Z,d,j,o,p.getFinalRotation3d(),p.getRotationMode())},clear:function(){var j=this;j.faceMat=j.mat=j.shapeModel=j.left=j.right=j.front=j.back=j.top=j.bottom=j.csg=A},needValidate:function(U){if(this._iv)return this._validateFrameId=U._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var p=U._renderInfo.frame;if(this._validateFrameId!==p)return this._validateFrameId=p,!0}return!1},validate:function(H,f){var G=this,I=G.gv,C=G.data,O=G.shapeName=G.s(Mq),Q=Qi(G,O);G._updateAutoRotation(),G._updateFixSize2d(),G._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Yn(I,C,"_wireframeModelMap","_wireframeIndexMap"),Yn(I,C,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var z=Vl(C,I.getMat(C),Q?G.s("shape3d.scaleable"):!0),w=G._calcAnchorMat(C);if(w&&Zh(z,z,w),C.mat=z,G.clear(),Q||!O)if(H){var R=[];Q?gb(I,C,Q,G,G.getBodyColor(),[z],H,R):(Ul(I,C,H,f,z,zd,R,El),Ul(I,C,H,f,z,Nl,R,oc),Ul(I,C,H,f,z,kq,R,Xo),Ul(I,C,H,f,z,Ud,R,bn),Ul(I,C,H,f,z,Jn,R,Ch),Ul(I,C,H,f,z,rd,R,Bc)),R.length&&(hk(H.vs,R),hk(H.ns,fi(R)))}else G.mat=z,(G.shapeModel=Q)||(G._cubeUvs=null,G.vf(zd,0),G.vf(Nl,16),G.vf(Jn,8),G.vf(rd,24),G.vf(kq,32),G.vf(Ud,40))},_updateAutoRotation:function(){var i=new xn,I=new Jb,G=new ur,H=new ur,N=new ur;return function(){var M=this,d=M.data,Q=M.s("shape3d.autorotate");if(!Q)return d._dynamicRotation&&delete d._dynamicRotation,void 0;var O=M.gv;N.copy(M.s("shape3d.autorotate.up")||O._up);var y;y="string"==typeof Q?[Q.indexOf("x")<0?O._eye[0]:O._center[0],Q.indexOf("y")<0?O._eye[1]:O._center[1],Q.indexOf("z")<0?O._eye[2]:O._center[2]]:O._eye;var v=O._center,E=d.p3();G.copy(E),H.set(y[0]-v[0],y[1]-v[1],y[2]-v[2]).add(G),I.lookAt(H,G,N),i.set(0,0,0,d.getRotationMode(),!0).setFromRotationMatrix(I);var z=d._dynamicRotation;z&&Math.abs(z[0]-i.x)<1e-5&&Math.abs(z[1]-i.y)<1e-5&&Math.abs(z[2]-i.z)<1e-5||(d._dynamicRotation=[i.x,i.y,i.z])}}(),_updateFixSize2d:function(){var P=this,x=P.data,J=P.s("shape3d.fixSizeOnScreen");if(!J)return x._dynamicScale3d&&delete x._dynamicScale3d,void 0;var M=P.gv;x.getFinalScale3d();var L=Vl(x,M.getMat(x)),z=li([0,0,0],L),R=M.toViewPosition(z);if(!isNaN(R.x)&&!isNaN(R.y)){var s=li([1,0,0],L),b=M.toViewPosition(s),n=li([0,1,0],L),S=M.toViewPosition(n),r=b.x-R.x,e=S.y-R.y;if(r&&e){var $=x._dynamicScale3d||[1,1,1],t=qg(x.s("shape3d.image")),A=J[0]>0?J[0]:t?Wb(t,x):20,W=J[1]>0?J[1]:t?js(t,x):20,F=Math.abs(r/A),O=Math.abs(e/W);Math.abs(F-1)<.001&&Math.abs(O-1)<.001||(x._dynamicScale3d=[$[0]/F,$[1]/O,$[2]])}}},_updateOverlapping:function(){var G=this,c=G.s("hide.overlapping.group");if(!c)return G._rectOverlapping&&(G._rectOverlapping=m),void 0;var x,D,M,P=G.gv,g=G.data,f=Vl(g,P.getMat(g)),v=1/0,i=1/0,$=-1/0,n=-1/0,L=g.getAnchor3d(),W=L.x,w=L.y,d=L.z;for(x=0;8>x;x++){if(D=li([(x>>2)-W,(1&x>>1)-w,(1&x)-d],f),M=P.toViewPosition(D),isNaN(M.x)||isNaN(M.y))return;v=Math.min(v,M.x),$=Math.max($,M.x),i=Math.min(i,M.y),n=Math.max(n,M.y)}var p={x:v,y:i,w:$-v,h:n-i};G._rectOverlapping=P.overlappingBox.isOverlapping(c,p)},getVectorDynamicSize:function(){var F,E=this,j=E.s("shape3d"),k=E.data;if("billboard"===j||"plane"===j||(F=k._currentCubeElementId)!=A){var H,U,h=E.gv,u=Vl(k,h.getMat(k)),O=k.getAnchor3d(),R=.5-O.x,I=.5-O.y,l=.5-O.z,n=E.s("shape3d.vector.dynamic.maxsize"),t=function(W,S){W[0]+=R,W[1]+=I,W[2]+=l,S[0]+=R,S[1]+=I,S[2]+=l;var v=h.toViewPosition(li(W,u)),K=h.toViewPosition(li(S,u)),e=v.x-K.x,q=v.y-K.y;return Math.min(n,Math.sqrt(e*e+q*q))};if("billboard"===j)H=t([-.5,0,0],[.5,0,0]),U=t([0,-.5,0],[0,.5,0]);else if("plane"===j)H=t([-.5,0,0],[.5,0,0]),U=t([0,0,-.5],[0,0,.5]);else if(k._currentCubeElementId!=A){var z=3*Io[F+1],g=3*Io[F],i=3*Io[F+2];H=t([Mg[z],Mg[z+1],Mg[z+2]],[Mg[i],Mg[i+1],Mg[i+2]]),U=t([Mg[z],Mg[z+1],Mg[z+2]],[Mg[g],Mg[g+1],Mg[g+2]])}return[H,U]}},getCachedTexture:function(){var T=this,D=T.data,m=D._currentCubeElementId;return m!=A?T._cubeCachedImage?T._cubeCachedImage[m]:null:T._shape3dCachedImage},setCachedTexture:function(D){var s=this,M=s.data,p=M._currentCubeElementId;p!=A?(s._cubeCachedImage||(s._cubeCachedImage={}),s._cubeCachedImage[p]=D):s._shape3dCachedImage=D},invalidateCachedTexture:function(R){var h,L,d,V=this;if((d=V._shape3dCachedImage)&&(R.deleteTexture(d),V._shape3dCachedImage=null),L=V._cubeCachedImage){for(h in L)R.deleteTexture(L[h]);V._cubeCachedImage=null}},vf:function(A,k){var V=this;if(V.gv.getFaceVisible(V.data,A)){var y=fj(V,A);y.mat&&(V.faceMat=!0);var q=y.uv;if(q){var c=V._cubeUvs;c||(c=V._cubeUvs=new cb([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var x=0;8>x;x++)c[k+x]=q[x]}return y}},_billboardInView:function(){var Z=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],o=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],U=new Pk,A=new ur,t=new Jb;return function($){var f=this;if(!f.mat)return!0;var z=f.gv.getFrustum(),N="billboard"===$?Z:o;U.makeEmpty(),t.fromArray(f.mat);for(var J=0,C=N.length;C>J;J+=3)U.expandByPoint(A.fromArray(N,J).applyMatrix4(t));return z.intersectsBox(U)}}(),_80o:function(s,h,o){var H=this;if(H._rectOverlapping)return!0;var d=H.shapeModel;if(d||!H.shapeName){var Y=H.s("shape3d");if(("billboard"===Y||"plane"===Y)&&!H._billboardInView(Y))return!0;var x=H.gv,i=H.data,N=x._cube;xm(x,H.mat),H.s("shape3d.reflector")&&!s._picking||(d?wh(x,i,d,H,H.getBodyColor(),o):(vm(s,N.vs,A,h.aPosition),vm(s,N.ns,A,h.aNormal),Ie(s,N.is),H._18O(s,h,H.left,0,o),H._18O(s,h,H.front,6,o),H._18O(s,h,H.right,12,o),H._18O(s,h,H.back,18,o),H._18O(s,h,H.top,24,o),H._18O(s,h,H.bottom,30,o))),Lq(x),H.faceMat&&(H._18O(s,h,H.left,0,o,!0),H._18O(s,h,H.front,6,o,!0),H._18O(s,h,H.right,12,o,!0),H._18O(s,h,H.back,18,o,!0),H._18O(s,h,H.top,24,o,!0),H._18O(s,h,H.bottom,30,o,!0))}},_18O:function(V,o,Q,$,G,Y){if(Q){if(!G(Q.transparent))return;if(Y&&!Q.mat||!Y&&Q.mat)return;var q=this.data.s("polygonOffset");q&&Cj(V,q),Y&&xm(this.gv,Q.mat);var U=this,X=U.data;X._currentCubeElementId=$;var j=U.gv,w=j.getTexture(Q.texture,X),h=Q.uv,F=Q.uvScale,H=Q.uvOffset,i=Q.discardSelectable;w?h?wd(V,o,w,i,j._buffer.uv,U._cubeUvs,H,F):wd(V,o,w,i,j._cube.uv,A,H,F):wd(V),Pj(V,o,Q.blend,Q.light,Q.opacity,Q.reverseFlip,Q.reverseColor,Q.reverseCull),ob(V,o.uDiffuse,Q.color||K["color.empty"]),ol(V,$,6),If(V,o),Oo(V,o,w),Y&&Lq(j),q&&ks(V),X._currentCubeElementId=null}},drawReflector:function(){var H=new ur,n=new ur,l=new xn,R=new Jb,f=new ur,K=new ur,t=new ur,g=new ur,O=new Jb,q=new Jb,Z=new or,X=new Hh,P=new Hh,w=function(E,Q,X){E[X]=Q[0],E[X+1]=Q[1],E[X+2]=Q[2]},r=function(m,S){w(m,S.getEye(),0),w(m,S.getCenter(),3),w(m,S.getUp(),6)},h=function(c,W){W._eye=[c[0],c[1],c[2]],W._center=[c[3],c[4],c[5]],W._up=[c[6],c[7],c[8]],W._18Q=A;var Z=W._skyBox;Z&&(Z.p3([c[0],c[1],c[2]]),W.getData3dUI(Z).iv())};return function(s,$,j,E,c){var I=this;I._reflectorInfo=null;var Q=I.data;if(Q._reflecting)return!1;var J=I.gv;if(c)return!1;var L=I._reflectorRenderTarget;L?L.setSize(s,$,j):L=I._reflectorRenderTarget=new rp.RenderTarget(J,s,$,j),H.copy(Q.p3()),n.copy(J.getEye()),R.makeRotationFromEuler(l.set(Q.r3(),Q.getRotationMode(),!0));var o;if(!I._reflectNormal){var o=Qi(I,I.s("shape3d"));if(!o)return!1;if(!o.ns&&o.length&&(o=o[0]),!o.ns||!o.vs)return!1;I._reflectNormal=[o.ns[0],o.ns[1],o.ns[2]],I._reflectorVbuffer=kf.Buffer.createVertexBuffer(s,new Float32Array(o.vs))}if(f.copy(I._reflectNormal),f.applyMatrix4(R),K.subVectors(H,n),K.dot(f)>0)return!1;K.reflect(f).negate(),K.add(H),t.copy(J.getCenter()).negate().add(H),t.reflect(f).negate(),t.add(H),g.copy(J.getUp()),g.reflect(f);var d=[0,0,0,0,0,0,0,0,0];r(d,J),J._eye=K.toArray(),J._center=t.toArray(),J._up=g.toArray(),J._18Q=A;var B=J._skyBox;B&&(B.p3(J._eye),J.getData3dUI(B).iv()),$n(s,L.frame),s.viewport(0,0,L.width,L.height),s.clearColor(0,0,0,1),s.clear(s.COLOR_BUFFER_BIT);var N=yh(J),b=vn(J);Z.setFromNormalAndCoplanarPoint(f,H),Z.applyMatrix4(q.fromArray(b)),X.set(Z.normal.x,Z.normal.y,Z.normal.z,Z.constant),P.x=(Math.sign(X.x)+N[8])/N[0],P.y=(Math.sign(X.y)+N[9])/N[5],P.z=-1,P.w=(1+N[10])/N[14],X.multiplyScalar(2/X.dot(P));var z=Q.s("shape3d.reflector.clip"),W=z===m?.003:z;N[2]=X.x,N[6]=X.y,N[10]=X.z+1-W,N[14]=X.w;var S=J._computedProjectMatrix;J._computedProjectMatrix=N,Q._reflecting=!0,E(),J._computedProjectMatrix=S,O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(q.fromArray(J._projectMatrix)),O.multiply(q.fromArray(J._viewMatrix)),_h(s),h(d,J);var i=ni.Reflector.shader;return i||(i=ni.Reflector.shader=new kf.Shader(s,ni.Reflector.vs,ni.Reflector.fs)),i.bind(),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,L.texture),i.uniforms.tDiffuse=0,i.uniforms.color=Ke(Q.s("shape3d.reflector.color")||"rgb(128,128,128)"),i.uniforms.textureMatrix=O.toArray(),i.uniforms.modelMatrix=Vl(Q),i.uniforms.viewMatrix=vn(J),i.uniforms.projectionMatrix=yh(J),I._reflectorVbuffer.upload(),i.attributes.pos.pointer(I._reflectorVbuffer),s.drawArrays(s.TRIANGLES,0,6),Q._reflecting=!1,s.useProgram(J._prg),!0}}()}),ni.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var Uo=function(P,t){To(Uo,this,[P,t])};Bg(Uo,Up,{_25Q:1,validate:function(h){var b=this,f=b.gv,w=b.data,V=b.s,Z=V("edge.width"),U=w._40I,a=w._41I;if(b.shapeModel=b.info=A,U&&a){var X,x,r,E,F,m,Q,$,q,j,z=w.isLooped(),t=V(Ap),M=O.getEdgeType(t);if(M){var p=M(w,_f(b,f,w,z,t),f,b._19Q);if(!p.points||p.points.isEmpty())return;m=b.info={},Q=p.segments,F=p.points,$=F.size();for(var W=U.getElevation(),I=a.getElevation(),g=0;$>g;g++){var d=F.get(g);d.e==A&&(d.e=W+(I-W)*g/($-1))}q=Sf(F.get(0)),j=Sf(F.get($-1));var s=$%2;0===s?(m.c1=Sf(F.get($/2-1)),m.c2=Sf(F.get($/2))):m.p3=Sf(F.get(($-s)/2)),m.s1=q,m.s2=Sf(F.get(1)),m.t1=Sf(F.get($-2)),m.t2=j}else{F=new Dj,m=b.info={};var c=V("edge.offset"),o=V("edge.center"),D=V("edge.source.t3"),P=V("edge.target.t3"),K=b._getEdge3dHostPoint(U,"source"),J=b._getEdge3dHostPoint(a,"target");if(D&&(K[0]+=D[0],K[1]+=D[1],K[2]+=D[2]),P&&(J[0]+=P[0],J[1]+=P[1],J[2]+=P[2]),t===Jo){Q=V("edge.segments");var T=m.points=V(kj)||Jd;if($=T.size()){q=Sf(T.get(0)),j=Sf(T.get($-1)),!o&&c&&(r=Dg(q,K,!0),c=Y(c,Ng(K,q)),K=[K[0]+r[0]*c,K[1]+r[1]*c,K[2]+r[2]*c],r=Dg(J,j,!0),c=Y(c,Ng(j,J)),J=[J[0]-r[0]*c,J[1]-r[1]*c,J[2]-r[2]*c]);var s=$%2;0===s?(X=Sf(T.get($/2-1)),x=Sf(T.get($/2))):m.p3=Sf(T.get(($-s)/2)),m.s1=K,m.s2=q,m.t1=j,m.t2=J}else!o&&c&&(r=Dg(J,K,!0),E=Ng(K,J),c=Vp(c,E),K=[K[0]+r[0]*c,K[1]+r[1]*c,K[2]+r[2]*c],J=[J[0]-r[0]*c,J[1]-r[1]*c,J[2]-r[2]*c]),X=K,x=J;F.add({x:K[0],y:K[2],e:K[1]}),F.addAll(T),F.add({x:J[0],y:J[2],e:J[1]})}else{var l=_f(b,f,w,z,t);if(b._19Q||(l=-l),z){var B=K[0],v=K[1],n=K[2],G=U.getTall()/2+l;X=[B-l,v+G,n],x=[B+l,v+G,n],F.add({x:B-l,y:n,e:v}),F.add({x:B-l,y:n,e:v+G}),F.add({x:B+l,y:n,e:v+G}),F.add({x:B+l,y:n,e:v})}else{r=Dg(J,K,!0),E=Ng(K,J);var e={x:K[0],y:K[2]},C={x:J[0],y:J[2]},S=ih(A,e,C,l),H=S.x-e.x,y=S.y-e.y;c=Vp(c,E),r[0]*=c,r[1]*=c,r[2]*=c,X=[K[0]+r[0]+H,K[1]+r[1],K[2]+r[2]+y],x=[J[0]-r[0]+H,J[1]-r[1],J[2]-r[2]+y],o?(F.add({x:K[0],y:K[2],e:K[1]}),F.add({x:X[0],y:X[2],e:X[1]}),F.add({x:x[0],y:x[2],e:x[1]}),F.add({x:J[0],y:J[2],e:J[1]})):(F.add({x:X[0],y:X[2],e:X[1]}),F.add({x:x[0],y:x[2],e:x[1]}))}}m.c1=X,m.c2=x}m.list=V(Mq)===Gi?b.createTubeModel(F,Q,Z/2,h):b.createLineModel(F,Q,Z,"edge","edge.dash")}},_getEdge3dHostPoint:function(K,G){if(!uh(K))return K.p3();var z=this;G="edge."+G+".anchor.";var C=z.s(G+"x"),O=z.s(G+"elevation"),k=z.s(G+"y");if(C===m&&O===m&&k===m)return K.p3();var w=Vl(K,z.gv.getMat(K)),y=K.getAnchor3d();return li([(C===m?.5:C)-y.x,(O===m?.5:O)-y.y,(k===m?.5:k)-y.z],w)}});var Cb=function(H,Z){To(Cb,this,[H,Z])};Bg(Cb,Rm,{_80o:function(I,d,M){var S=this,g=S.gv,v=S.shapeModel;xm(g,S.mat),v?wh(g,S.data,v,S,S.getBodyColor(),M):(fd(S,I,d,S.left,M),fd(S,I,d,S.front,M),fd(S,I,d,S.right,M),fd(S,I,d,S.back,M),fd(S,I,d,S.top,M),fd(S,I,d,S.bottom,M)),Lq(g)},validate:function(i,a){var s,z,I=this,F=I.s,g=I.data,j=g.p3(),r=g._thickness/2,G=g.isClosePath(),S=g.getPoints(),o=g.getSegments(),x=F($r),K=i&&i.uv;if(I.clear(),0>r)z=I.shapeModel=Lj(S,o,F(xd),F(Xg),x,F(Fr),g.getTall(),g.getShapeElevation(),G),F(Gg)?F("shape3d.image")||delete z.uv:(delete z.vs,delete z.ns,delete z.uv),F("shape3d.top.image")||delete z.top_uv,F("shape3d.bottom.image")||delete z.bottom_uv;else if(F(Mq)===Gi)s=sn(S,o,x,G),z=I.shapeModel={vs:[]},F("shape3d.image")&&(z.uv=[],z.sum=F(Fr)||Do(s)||1,z.len=0),F(xd)&&!G&&(z.top_vs=[],F("shape3d.top.image")&&(z.top_uv=[])),F(Xg)&&!G&&(z.bottom_vs=[],F("shape3d.bottom.image")&&(z.bottom_uv=[])),I._12O(s,r);else{var V,v,q,t,Z,O,n,m,N,B;if(s=sn(S,o,x,G),Z=I.vf(Jn,K,!1,a),r&&(O=I.vf(rd,K,!1,a),n=G?A:I.vf(zd,K,!1,a),m=G?A:I.vf(Nl,K,!1,a),N=I.vf(kq,K,!1,a),B=I.vf(Ud,K,!1,a)),r){for(var U=0,P=s.length;P>U;U++)s[U]=I._tryRemoveBezierPoints(s[U],r);I._12O(s,r)}else Z&&s.forEach(function(K){if(t=K.length,t>0)for(V=K[0],q=1;t>q;q++)v=K[q],I.addV(Z.vs,V,v),V=v});I._20Q(s),i||(Z&&(Z.ns=fi(Z.vs),eq(Z,"vs"),eq(Z,Ve)),r&&(O&&(O.ns=fi(O.vs),eq(O,"vs"),eq(O,Ve)),n&&(n.ns=fi(n.vs),eq(n,"vs"),eq(n,Ve)),m&&(m.ns=fi(m.vs),eq(m,"vs"),eq(m,Ve)),N&&(N.ns=fi(N.vs),eq(N,"vs"),eq(N,Ve)),B&&(B.ns=fi(B.vs),eq(B,"vs"),eq(B,Ve))))}var l=I.mat=co();io(l,j),Ac(l,g.getFinalRotation3d(),g.getRotationMode());var R=g.getScale3d(),_=g._dynamicScale3d;_&&(R[0]*=_[0],R[1]*=_[1],R[2]*=_[2]),Qg(l,R),io(l,Rf(j)),i&&(Wc(I,l,i,z),I.clear())},_20Q:function(Y){var s,H,d,g,G,k,t,I=this,c=I.front,v=I.back,l=I.top,R=I.bottom,W=c?c.tuv:A,M=v?v.tuv:A,V=l?l.tuv:A,T=R?R.tuv:A,y=0;(W||M||V||T)&&(s=I.s(Fr)||Do(Y)||1,Y.forEach(function(E){if(H=E.length,H>0)for(k=E[0],d=1;H>d;d++)t=E[d],g=y/s,y+=Ng(k,t),G=y/s,I._14O(c,g,G),I._14O(v,1-G,1-g),I._14O(l,g,G),I._14O(R,g,G),k=t}))},_14O:function(x,r,Z){if(x){var V=x.uv,k=x.tuv;if(k){if(V)var X=V[0]+(V[6]-V[0])*r,b=V[1]+(V[7]-V[1])*r,v=V[2]+(V[4]-V[2])*r,N=V[3]+(V[5]-V[3])*r,c=V[2]+(V[4]-V[2])*Z,u=V[3]+(V[5]-V[3])*Z,y=V[0]+(V[6]-V[0])*Z,R=V[1]+(V[7]-V[1])*Z;else X=r,b=0,v=r,N=1,c=Z,u=1,y=Z,R=0;k.push(v,N,c,u,y,R,y,R,X,b,v,N)}}},_13O:function(r){var w=r.uv,l=r.tuv;l&&(w?l.push(w[2],w[3],w[4],w[5],w[6],w[7],w[6],w[7],w[0],w[1],w[2],w[3]):l.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(B,t){var N=B.length;if(4>N)return B;var w,E,_,L,T,j,S=!1,G=function(A){return B[A]},Y=function(K){return B[N-1-K]};for(T=0;1>=T;T++)for(j=T?Y:G,E=j(0),_=j(1),w=2;N-1>w;w++)if(L=j(w),!L.remove)if(L.b){var m=ih(E,_,L,t);m.adjust?(L.remove=!0,S=!0):(E=_,_=L)}else E=_,_=L;if(!S)return B;var I=[];for(w=0;N>w;w++)B[w].remove||I.push(B[w]);return I},_12O:function(K,t){var g,c,m,w,y,k=this.s("shape3d.point.epsilon"),X=this;K.forEach(function(F){if(y=F.length,y>0)for(g={p:F[0],n:!0},w=1;y>w;w++)c=F[w],m=y-1>w?F[w+1]:A,m&&Math.abs(c.x-m.x)<k&&Math.abs(c.y-m.y)<k||X.addPoint(g,c,m,t,F)})},addPoint:function(P,m,r,I,i){var W,f,n,U,F,k,u,E,V,M=this,S=P.p,N=P.f,R=P.b,K=M.s("shape3d.side")||He,T=M.s("shape3d.start.angle"),d=M.s("shape3d.sweep.angle"),Y=M.shapeModel,L=M.data.isClosePath();if(P.n&&(P.n=!1,N=L&&i.length>2?ih(i[i.length-2],S,m,I):ih(A,S,m,I),R=yb(S,N),Y?Y.top_vs&&M._10O(R,N,K,T,d,Y.top_vs,Y.top_uv):(W=M.left)&&(M.addV(W.vs,R,N),M._13O(W))),f=r?ih(S,m,r,I):L&&i.length>2?ih(S,m,i[1],I):ih(S,m,A,I),n=yb(m,f),Y){var p,z,q=Y.vs,Q=Y.uv,j=Y.sum;for(Q&&(p=Y.len/j,Y.len+=Ng(S,m),z=Y.len/j),k=M._9O(R,N,K,T,d),u=M._9O(n,f,K,T,d),E=0;K>E;E++)V=E+1,hk(q,k[V]),hk(q,u[E]),hk(q,k[E]),hk(q,u[E]),hk(q,k[V]),hk(q,u[V]),Q&&(U=E/K,F=V/K,Q.push(p,F,z,U,p,U,z,U,p,F,z,F));!r&&Y.bottom_vs&&M._10O(n,f,K,T,d,Y.bottom_vs,Y.bottom_uv,!0)}else!r&&(W=M.right)&&(M.addV(W.vs,f,n),M._13O(W)),(W=M.front)&&M.addV(W.vs,N,f),(W=M.back)&&M.addV(W.vs,n,R),(W=M.top)&&M.addH(W.vs,N,f,n,R,!0),(W=M.bottom)&&M.addH(W.vs,R,n,f,N);P.p=m,P.f=f,P.b=n},_10O:function(j,r,O,g,z,$,k,b){var l,m,D=this,i=D.data,p=D._9O(j,r,O,g,z),Y=(j.x+r.x)/2,K=(j.y+r.y)/2,s=i.getShapeElevation(),I=0;for(I=0;O>I;I++)b?(hk($,p[I]),hk($,p[I+1])):(hk($,p[I+1]),hk($,p[I])),hk($,[Y,s,K]),k&&(b?(l=H*(I+1)/O+g,m=H*I/O+g):(l=H*I/O+g,m=H*(I+1)/O+g),k.push(.5-.5*W(m),.5-.5*n(m),.5-.5*W(l),.5-.5*n(l),.5,.5))},_9O:function(x,G,r,t,h){var A,u,P=this,L=P.data,J=[],d=(x.x+G.x)/2,y=(x.y+G.y)/2,s=L.getTall()/2,v=L.getShapeElevation(),i=0;for(h=h||H;r>=i;i++)A=h*i/r+t,u=W(A),J.push([d+(x.x-d)*u,v+s*n(A),y+(x.y-y)*u]);return J},addV:function(Z,g,v){var n=g.x,W=g.y,I=v.x,u=v.y,_=this.data,L=_.getShapeElevation(),t=_.getTall()/2;Z.push(n,L-t,W,I,L-t,u,I,L+t,u,I,L+t,u,n,L+t,W,n,L-t,W)},addH:function(s,Z,J,D,H,w){var O=this.data,f=O.getTall()/2,o=O.getShapeElevation()+(w?f:-f);s.push(Z.x,o,Z.y,J.x,o,J.y,D.x,o,D.y,D.x,o,D.y,H.x,o,H.y,Z.x,o,Z.y)},vf:function(u,K,s,i){var J,P=this,x=P.gv.getFaceVisible(P.data,u);return(s||x)&&(J=fj(P,u,i),J.vs=[],J.tuv=x&&(J.texture||K)?[]:A,J.visible=x),J}});var rm=function(C,o){To(rm,this,[C,o])};Bg(rm,Up,{_25Q:1,validate:function(m){var x=this,T=x.data,O=x.s,b=T.getPoints(),h=b.size();if((!x.s("shape3d.geometry.cache")||!x.shapeModel)&&(x.shapeModel=x.info=A,h>1)){var R=x.info={},s=T.getSegments(),p=T.getThickness(),t=Sf(b.get(0)),D=Sf(b.get(h-1)),n=h%2;0===n?(R.c1=Sf(b.get(h/2-1)),R.c2=Sf(b.get(h/2))):R.p3=Sf(b.get((h-n)/2)),R.s1=t,R.s2=Sf(b.get(1)),R.t1=Sf(b.get(h-2)),R.t2=D,R.list=O(Mq)===Gi?x.createTubeModel(b,s,p/2,m):x.createLineModel(b,s,p,"shape.border","shape.dash")}var y=T.p3(),G=x.mat=co();io(G,y),Ac(G,T.getFinalRotation3d(),T.getRotationMode());var i=T.getScale3d(),r=T._dynamicScale3d;r&&(i[0]*=r[0],i[1]*=r[1],i[2]*=r[2]),Qg(G,i),io(G,Rf(y))},_80o:function(n,A,x){var w=this,z=w.shapeModel;if(z){var C=w.gv;xm(C,w.mat),wh(C,w.data,z,w,w.getBodyColor(),x),Lq(C)}}});var Cn=f.graph3d.VR=function(Y){var x=this;x.gv=Y,x._controllers=[],x.switch=new ld(x),x._enable=!1,x._defaultCallLater=f.Default.callLater,x._defaultCancelLater=kb,"undefined"!=typeof q&&"VRFrameData"in q&&(x._frameData=new q.VRFrameData),x.measureOflength=1,x.eyesOffset=[0,0,0],x._orientation=new f.Math.Quaternion,x._lastHeadPose=[0,0,0],x._offsetToBeAdd=[0,0,0],x._fpsInfo={time:0,fps:0,frames:0}};Bg(Cn,I,{ms_fire:!0,_42:function(y,Z,T,u){var A=this,t=A.gv;if(!t.drawFilter&&A._deviceInAction){var g=A._device;if(g){var m=A._measureOflength;g.depthNear=t.getNear()*m,g.depthFar=t.getFar()*m;var j=A._offsetToBeAdd;if(A.eyesOffset[0]+=j[0],A.eyesOffset[1]+=j[1],A.eyesOffset[2]+=j[2],j[0]=0,j[1]=0,j[2]=0,g.isPresenting===!1)return A._controllers.forEach(function(o){o&&o.update()}),t.iv(),!1;var R=A._frameData;g.getFrameData(R);var Q=R.pose.position;if(Q){var V=A.toViewPosition(Q);t.setEye(V),A._orientation.fromArray(R.pose.orientation);var P=new f.Math.Vector3(0,0,-10*A._scaleFactor);P.applyQuaternion(A._orientation),t.setCenter([V[0]+P.x,V[1]+P.y,V[2]+P.z])}A._controllers.forEach(function(E){E&&E.update()}),t.setViewport(y,0,0,Z/2,T),A._viewMatrix=A._copyViewMatrix(R.leftViewMatrix),A._projectMatrix=A._copyProjectMatrix(R.leftProjectionMatrix),u(),t.setViewport(y,Z/2,0,Z/2,T),A._viewMatrix=A._copyViewMatrix(R.rightViewMatrix),A._projectMatrix=A._copyProjectMatrix(R.rightProjectionMatrix),u(),A._lastViewMatrix=A._viewMatrix,A._lastProjectMatrix=A._projectMatrix,A._viewMatrix=null,A._projectMatrix=null,A.submitFrame();var r=Date.now(),W=A._fpsInfo;return r-W.time>1e3?(W.fps=Math.round(1e3*(W.frames+1)/(r-W.time)),W.time=r,W.frames=0):W.frames++,!0}}},onVRDisplayPresentChange:function(){var v=this.isPresenting();this._injectGraphView(v),this.fp("present",!v,v)},getOrientation:function(){return this._orientation},addController:function(c){c=c||0;var M=this,h=M.getController(c);return h?h:(h=new As(M,c),M._controllers.push(h),h)},getController:function(m){m=m||0;for(var n=this._controllers,f=0,k=n.length;k>f;f++)if(n[f]&&n[f].id===m)return n[f];return null
},removeController:function(P){P=P||0;for(var m=this._controllers,g=0,c=m.length;c>g;g++)if(m[g]&&m[g].id===P)return m.splice(g,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(O,j){var s=this,i=s._scaleFactor,N=s._eyesOffset,T=s._lastHeadPose;return T[0]=O[0]*i,T[1]=O[1]*i,T[2]=O[2]*i,j?(j[0]=T[0]+N[0],j[1]=T[1]+N[1],j[2]=T[2]+N[2],j):[T[0]+N[0],T[1]+N[1],T[2]+N[2]]},addEyesOffset:function(Y,T,g){var w=this._offsetToBeAdd;w[0]+=Y,w[1]+=T,w[2]+=g},_copyViewMatrix:function(B){var P=this.dup(B),U=this._scaleFactor;P[12]*=U,P[13]*=U,P[14]*=U;var g=this._eyesOffset;if(g&&(g[0]||g[1]||g[2])){var F=g[0],j=g[1],R=g[2];P[12]-=P[0]*F+P[4]*j+P[8]*R,P[13]-=P[1]*F+P[5]*j+P[9]*R,P[14]-=P[2]*F+P[6]*j+P[10]*R}return P},shutdown:function(){var Q=this._device;Q&&Q.isPresenting&&Q.exitPresent()},isPresenting:function(){var F=this._device;return F&&F.isPresenting},_copyProjectMatrix:function(A){var w=this.dup(A),B=this._scaleFactor;return w[14]*=B,w},dup:function(b,e){for(var M=b.length,v=e||new Array(M);M--;)v[M]=b[M];return v},getViewMatrix:function(W){var r=this._viewMatrix;return r?this.dup(r,W):void 0},getProjectMatrix:function(){var C=this._projectMatrix;return C?this.dup(C):void 0},submitFrame:function(){var n=this;if(n._enable&&n._deviceInAction){var L=n._device;L&&L.isPresenting&&(L.submitFrame(),n.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(E){var s=this.gv;return s.intersectObjects(E,s.dm().getDatas())},setDevice:function($){var S=this;S._device=$},_injectGraphView:function(){var r,x,f;return function(d){var c=this.gv;if(!d)return r&&(c.getWidth=r,c.getHeight=x,c.getDevicePixelRatio=f),void 0;var S=this._device,Z=S.getEyeParameters("left"),$=Z.renderWidth,F=Z.renderHeight;r=c.getWidth,x=c.getHeight,f=c.getDevicePixelRatio,c.getWidth=function(){return 2*$},c.getHeight=function(){return F},c.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(n){var E=this;if(!n)return Bm=f.Default.callLater=E._defaultCallLater,kb=f.Default.cancelLater=E._defaultCancelLater,void 0;var E=this;Bm=f.Default.callLater=function(t,S,L,W){var k=E._device;return k&&k.isPresenting?W?l(function(){Bm(t,S,L)},W):k.requestAnimationFrame(function(){E._deviceInAction=!0,t.apply(S,L),E._deviceInAction=!1}):E._defaultCallLater(t,S,L,W)},kb=f.Default.cancelLater=function(v,Y){var n=E._device;return n&&n.isPresenting?Y?z(v):n.cancelAnimationFrame(v):E._defaultCancelLater(v,Y)}}}),I.defineProperties(Cn.prototype,{enable:{get:function(){return this._enable},set:function(q){var d=this;d._enable!==q&&(d._enable=q,q?(d.switch.showButton(),d._injectCallLaterFunc(!0)):(d.shutdown(),d.switch.hideButton(),d._injectCallLaterFunc(!1)),d.fp("enable",!q,q))}},measureOflength:{get:function(){return this._measureOflength},set:function(Q){this._measureOflength=Q;var t=this._scaleFactor=1/Q;this._controllers.forEach(function(o){o&&o._setScaleFactor(t)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(E){this._eyesOffset=E}},controllerModel:{get:function(){return this._controllerModel},set:function(h){var k;"object"==typeof h?(k=h.mtl,h=h.obj):(k=h+".mtl",h+=".obj");var U=this,l=U._controllerModel;l&&l.obj===h&&l.mtl===k||(l=U._controllerModel={obj:h,mtl:k},O.loadObj(h,k,{finishFunc:function(e,P){U._controllerModel===l&&O.setShape3dModel("vrControllerModel",P)}}))}},interactive:{get:function(){return!!this._interactive},set:function(O){!!O!=!!this._interactive&&(this._interactive=O,O&&this.addController(0),this.gv.getCoreInteractor().enableVR(O))}}});var As=function(y,u){function n(N){var o=navigator.getGamepads&&navigator.getGamepads();if(o)for(var a=0,X=0,x=o.length;x>a;a++){var C=o[a];if(C){var Y=C.id;if("OpenVR Gamepad"===Y||"OpenVR Controller"===Y||0===Y.indexOf("Oculus Touch")||0===Y.indexOf("Spatial Controller")){if(X===N)return C;X++}}}}function W(e,i,T){return Math.abs(e[0]-i[0])<T&&Math.abs(e[1]-i[1])<T&&Math.abs(e[2]-i[2])<T?!0:!1}var L=this;L.vr=y,L.id=u;var z,H,c=[0,0],x=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],K=new fh;K.s("shape3d","vrControllerModel"),K.isController=!0,K.s("intersect",!1),L.getGamepad=function(){return H},L.isButtonPressed=function(X){for(var d,R=0,D=x.length;D>R;R++)if(d=x[R],d.id===X)return d.pressed;return!1},L.getNode=function(){return K};var S=.003;L.setRotationEpsilon=function(U){S=U};var B=5e-4,w=B;L.setPositionEpsilon=function(o){B=o,w=o*L.vr._scaleFactor},L._setScaleFactor=function(I){K.s3(I,I,I),w=B*I},L._setScaleFactor(L.vr._scaleFactor);var s,g=new eg,e=new Jb,Y=[0,0,0],V=[0,0,0],U=new xn,i=new ur,a=new Ro;L.getRay=function(){return s?(a.origin.fromArray(Y),a.direction.copy(i),s=!1,a):a},L.update=function(){if(z=H,H=n(u),z!=H&&console.log("gamepad changed",H),!H||H.pose===m)return H=null,K.s("3d.visible",!1),void 0;if(O.getShape3dModel("vrControllerModel")){K.dm()||y.gv.dm().add(K),K.s("3d.visible",!0);var d=H.pose;if(null!==d){d.position&&(L.vr.toViewPosition(d.position,Y),W(K.p3(),Y,w)||(s=!0,K.p3(Y))),d.orientation&&(g.fromArray(d.orientation),i.set(0,0,-1).applyQuaternion(g).normalize(),e.makeRotationFromQuaternion(g),U.set(0,0,0,K.getRotationMode(),!0).setFromRotationMatrix(e),V[0]=U.x,V[1]=U.y,V[2]=U.z,W(K.r3(),V,S)||(s=!0,K.r3(V))),s&&y.fp("gamepad.pose",null,{position:Y,rotation:V,id:u});var A=H.axes;(c[0]!==A[0]||c[1]!==A[1])&&(c=[A[0],A[1]],y.fp("gamepad.axes",null,{id:u,axes:c}));var F,o,Z,a,k=H.buttons;for(F=0,o=k.length;o>F;F++)if(Z=k[F],a=Z.pressed,a!==x[F].pressed){x[F].pressed=a;var p={id:u},B="state";p[B]=p._62O=a?"down":"up",y.fp("gamepad.button."+x[F].id,null,p)}}}}},ld=function(o){this.vr=o,this._button=null};Bg(ld,I,{showButton:function(){var S=this.assureButton();if(!S.parentNode){var U=this.vr.gv,w=U.getView();U._79O?w.insertBefore(S,U._79O):w.appendChild(S)}},hideButton:function(){var V=this._button;V&&V.parentNode&&V.parentNode.removeChild(V)},assureButton:function(){var T=this._button;return T?T:this._button=this.createButton(this.vr.gv)},createButton:function(D){function R(M,Y){M.textContent=Y&&Y.isPresenting?" VR ":" VR "}function d(e){h.style.display="",h.style.cursor="pointer",h.style.left="calc(50% - 50px)",h.style.width="100px",R(h,e),h.onmouseenter=function(){h.style.opacity="1.0"},h.onmouseleave=function(){h.style.opacity="0.5"},h.onclick=function(){e.isPresenting?e.exitPresent():e.requestPresent([{source:D.getCanvas()}])},D.vr.setDevice(e)}function V(){h.style.display="",h.style.cursor="auto",h.style.left="calc(50% - 75px)",h.style.width="150px",R(h,null),h.onmouseenter=null,h.onmouseleave=null,h.onclick=null,D.vr.setDevice(null)}function g(v){v.style.position="absolute",v.style.bottom="20px",v.style.padding="12px 6px",v.style.border="1px solid #fff",v.style.borderRadius="4px",v.style.color="#000",v.style.font="normal 13px sans-serif",v.style.textAlign="center",v.style.opacity="0.5",v.style.outline="none",v.style.zIndex="999"}if("getVRDisplays"in navigator){var h=this._button=J.createElement("button");return h.style.display="none",g(h),x(q,"vrdisplayconnect",function(t){d(t.display)}),x(q,"vrdisplaydisconnect",function(){V()}),x(q,"vrdisplaypresentchange",function(z){R(h,z.display),D.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(Z){Z.length>0?d(Z[0]):V()}),h}var W=J.createElement("a");return W.href="https://webvr.info",W.innerHTML=" webvr",W.style.left="calc(50% - 90px)",W.style.width="180px",W.style.textDecoration="none",g(W),W}}),I.defineProperties(ld.prototype,{});var Ri=f.graph3d.PostProcessing=function(n){function v(){if(!F){var z=n.getGL();F=new rp.RenderTarget(n,z,null,null,{samples:K.renderTextureSamples||1}),m=new kf.Shader(z,k.vs,k.fs),E=kf.Buffer.createIndexBuffer(z,new Uint16Array([0,2,1,1,2,3])),l=kf.Buffer.createVertexBuffer(z,new Float32Array([0,0,1,0,0,1,1,1]))}}var F,m,E,l,e=this,o={},u=!1;!function(){I.keys(Ri).forEach(function(W){o[W]=new Ri[W](n)})}(),e.getModule=function(R){return R?o[R]:e},e.getModuleList=function(){return I.keys(o)},e.handleDataModleChange=function(H,o){H&&(H.setPostProcessingData(e.serialize()),H.removeSerializeListener(e.onDataModelSerialize,e)),o&&(o.addSerializeListener(e.onDataModelSerialize,e),e.deserialize(o.getPostProcessingData()))},e.onDataModelSerialize=function(x){"serialize"===x.type?n.dm()._postProcessingData=e.serialize():"deserialize"===x.type&&e.deserialize(n.dm().getPostProcessingData())},e.serialize=function(){var C,z,D,d,j={};for(C in o)D=o[C],z=C.toLowerCase(),j[z]={enable:D.enable},d=D.serializeProperties,d&&d.forEach(function(u){j[z][u]=D[u]});return j},e.deserialize=function(B){if(B){var T,L,D,M,d;for(L in B)if(L&&(T=L[0].toUpperCase()+L.slice(1),D=o[T])){M=B[L],e.enableModule(T,M.enable);for(d in M)"enable"!==d&&(D[d]=M[d])}}else{var T,D;for(T in o)D=o[T],D.enable=!1,D.resetProperties&&D.resetProperties()}},e.decodeShader=function(L){var a,H,v,X="",h="";for(v=0;v<L.length;v++)a=L[v],"%"===a?a="'":"a"===a?a='"':"]"===a&&(a="\\"),H=String.fromCharCode(a.charCodeAt(0)-1),v%2?h+=H:X=H+X;return h+X},e.createShader=function(W,f,I){var b=f.indexOf("^#"),y=e.decodeShader(f.substr(0,b)),j=e.decodeShader(f.substr(b+2));if(I){var t=I(y,j);t&&t.vs&&(y=t.vs),t&&t.fs&&(j=t.fs)}return new kf.Shader(W,y,j)},e.enableModule=function(c,x){var h,w,Z,P=c.split(",");for(h=0,w=P.length;w>h;h++)Z=P[h].trim(),o[Z]&&(o[Z].enable=x);u=!1;for(Z in o)if(o[Z].enable){u=!0;break}u&&v()};var k={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};e._42=function(_,Q,N,w,j){if(u&&!j){F.setSize(_,Q,N),F.bind(_),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT),n.setViewport(_,0,0,Q,N),w(),F.unbind(_);for(var L=0,e=n._glCapabilities.maxAttributes;e>L;L++)_.disableVertexAttribArray(L);var b,O=F;for(b in o)O=o[b]._42(_,O)||O;return n.setViewport(_,0,0,Q,N),_.clear(_.COLOR_BUFFER_BIT|_.DEPTH_BUFFER_BIT),m.bind(),_.activeTexture(_.TEXTURE0+0),_.bindTexture(_.TEXTURE_2D,O.texture),m.uniforms.image=0,E.upload(),l.upload(),m.attributes.pos.pointer(l),_.drawElements(_.TRIANGLES,6,_.UNSIGNED_SHORT,0),_.bindTexture(_.TEXTURE_2D,null),_.useProgram(n._prg),!0}}},Tq=f.graph3d.PostProcessing.Bloom=function(M){function P(){var D=M.getGL();if(D)for(var v=M._postProcessing,d=0;w>d;d++)X[d]=v.createShader(D,Tq._35Q,function(W,T){return{fs:T.replace(/DEFINE_VALUE/g,p[d]).replace("%OVERRIDE_ALPHA_DEFINE%",A?"#define OVERRIDE_ALPHA":"")}})}function j(){var i=M.getWidth(),C=M.getHeight();if(i&&C){m=[i,C],e=!0;var Y,I=M.getGL(),f=Math.round(m[0]/2),L=Math.round(m[1]/2);for(k=new rp.RenderTarget(M,I,f,L),Y=0;w>Y;Y++)R.push(new rp.RenderTarget(M,I,f,L)),U.push(new rp.RenderTarget(M,I,f,L)),f=Math.round(f/2),L=Math.round(L/2);var K=M._postProcessing;z=K.createShader(I,Tq._34Q),P(),T=K.createShader(I,Tq._36Q,function(s,P){return{fs:P.replace(/NUM_MIPS/g,w)}}),V=K.createShader(I,Tq.finalShader),O=kf.Buffer.createIndexBuffer(I,new Uint16Array([0,2,1,1,2,3])),_=kf.Buffer.createVertexBuffer(I,new Float32Array([0,0,1,0,0,1,1,1]))}}var o,S,s,A,O,_,K=this,D=!1,e=!1;this.serializeProperties="strength,threshold,radius,overrideAlpha".split(","),this.resetProperties=function(){o=1.5,S=.55,s=.4,A=!0},I.defineProperties(K,{enable:{get:function(){return D},set:function(M){!!D!=!!M&&(D=M,M&&!e&&j())}},strength:{get:function(){return o},set:function(N){o=N}},threshold:{get:function(){return S},set:function(C){S=C}},radius:{get:function(){return s},set:function(u){s=u}},overrideAlpha:{get:function(){return A},set:function(i){!!A!=!!i&&(A=i,e&&P())}}}),this.resetProperties();var k,z,T,V,m=[256,256],R=[],U=[],w=5,p=[3,5,7,9,11],X=[];K._42=function(r,p){function W(d,x,z,c){$n(r,x.frame),M.setViewport(r,0,0,x.width,x.height),c?c(r):r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),q!==d&&d.bind();var B=0;for(var R in z){var f=z[R];f instanceof WebGLTexture&&(r.activeTexture(r.TEXTURE0+B),r.bindTexture(r.TEXTURE_2D,f),f=B,B++),d.uniforms[R]=f}for(q!==d&&(O.upload(),_.upload(),d.attributes.pos.pointer(_),q=d),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0);B--;)r.activeTexture(r.TEXTURE0+B),r.bindTexture(r.TEXTURE_2D,null);_h(r)}if(D&&(e||(j(),e))){var q;W(z,k,{smoothWidth:.01,luminosityThreshold:S,tDiffuse:p.texture});var K,L=k,N=Math.round(m[0]/2),f=Math.round(m[1]/2);for(K=0;w>K;K++)W(X[K],R[K],{colorTexture:L.texture,direction:[1,0],texSize:[N,f]}),W(X[K],U[K],{colorTexture:R[K].texture,direction:[0,1],texSize:[N,f]}),N=Math.round(N/2),f=Math.round(f/2),L=U[K];return W(T,R[0],{blurTexture1:U[0].texture,blurTexture2:U[1].texture,blurTexture3:U[2].texture,blurTexture4:U[3].texture,blurTexture5:U[4].texture,bloomStrength:o,bloomRadius:s,bloomTintColor:[1,1,1]}),W(V,p,{image:R[0].texture},function(X){X.enable(X.BLEND),X.blendEquation(X.FUNC_ADD),X.blendFunc(X.SRC_ALPHA,X.ONE)}),r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA),p}}};Tq._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",Tq._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",Tq._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",Tq.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var il=f.graph3d.PostProcessing.Dof=function(w){function r(){y=!0;var g=w.getGL();C=new rp.RenderTarget(w,g),V=w._postProcessing.createShader(g,il._38Q),m=kf.Buffer.createIndexBuffer(g,new Uint16Array([0,2,1,1,2,3])),P=kf.Buffer.createVertexBuffer(g,new Float32Array([0,0,1,0,0,1,1,1]))}var C,V,m,P,z,k,i,e,H=this,c=!1,y=!1;this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},I.defineProperties(H,{enable:{get:function(){return c},set:function(V){!!c!=!!V&&(c=V,V&&!y&&r())}},image:{get:function(){return k},set:function(S){k!==S&&(k=S,z&&(w.getGL().deleteTexture(z),z=null),w.iv())}},maxblur:{get:function(){return i},set:function(r){i!==r&&(i=r,w.iv())}},aperture:{get:function(){return e},set:function(T){e!==T&&(e=T,w.iv())}}}),this.resetProperties(),H._42=function(h,B){function b(_,c,V,S){$n(h,c.frame),w.setViewport(h,0,0,c.width,c.height),S?S(h):h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),x!==_&&_.bind();var W=0;for(var U in V){var l=V[U];l instanceof WebGLTexture&&(h.activeTexture(h.TEXTURE0+W),h.bindTexture(h.TEXTURE_2D,l),l=W,W++),_.uniforms[U]=l}for(x!==_&&(m.upload(),P.upload(),_.attributes.pos.pointer(P),x=_),h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);W--;)h.activeTexture(h.TEXTURE0+W),h.bindTexture(h.TEXTURE_2D,null);_h(h)}if(c){y||r();var x;if(!z){var q=qg(this.image);if(!q||!q.tagName)return B;z=jg(h,q)}var X=B.width,$=B.height;if(X&&$)return C.setSize(h,X,$),b(V,C,{tColor:B.texture,tDepth:z,aspect:X/$,aperture:this.aperture,maxblur:this.maxblur}),C}}};il._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",kk(O,{accordionViewExpandIcon:Yi(th),accordionViewCollapseIcon:Yi(th,!0),accordionViewLabelColor:_j,accordionViewLabelFont:Oh,accordionViewTitleBackground:Ym,accordionViewSelectBackground:dg,accordionViewSelectWidth:3,accordionViewSeparatorColor:m,splitViewDividerSize:1,splitViewDividerBackground:Ym,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:uj,rect:[2,2,12,12],background:th}]},propertyViewLabelColor:We,propertyViewLabelSelectColor:_j,propertyViewLabelFont:Oh,propertyViewExpandIcon:Yi(Vb),propertyViewCollapseIcon:Yi(Vb,!0),propertyViewBackground:Xi,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Al,propertyViewColumnLineColor:Al,propertyViewSelectBackground:dg,listViewLabelColor:We,listViewLabelSelectColor:_j,listViewLabelFont:Oh,listViewRowLineVisible:!1,listViewRowLineColor:Al,listViewSelectBackground:dg,treeViewLabelColor:We,treeViewLabelSelectColor:_j,treeViewLabelFont:Oh,treeViewExpandIcon:Yi(Qf),treeViewCollapseIcon:Yi(Qf,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Al,treeViewSelectBackground:dg,treeViewDoubleClickToToggle:!0,tableViewLabelColor:We,tableViewLabelSelectColor:_j,tableViewLabelFont:Oh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Al,tableViewColumnLineColor:Al,tableViewSelectBackground:dg,treeTableViewLabelColor:We,treeTableViewLabelSelectColor:_j,treeTableViewLabelFont:Oh,treeTableViewExpandIcon:Yi(Qf),treeTableViewCollapseIcon:Yi(Qf,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Al,treeTableViewColumnLineColor:Al,treeTableViewSelectBackground:dg,tableHeaderLabelColor:We,tableHeaderLabelFont:Oh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Po,tableHeaderBackground:Xi,tableHeaderMoveBackground:es,tableHeaderInsertColor:dg,tableHeaderSortDescIcon:$p(Vb,!0),tableHeaderSortAscIcon:$p(Vb),tabViewTabGap:1,tabViewLabelColor:_j,tabViewLabelFont:Oh,tabViewTabBackground:Ym,tabViewSelectWidth:3,tabViewSelectBackground:dg,tabViewMoveBackground:es,tabViewInsertColor:dg,toolbarLabelColor:We,toolbarLabelSelectColor:_j,toolbarLabelFont:Oh,toolbarBackground:Xi,toolbarSelectBackground:dg,toolbarItemGap:8,toolbarSeparatorColor:po},!0);var _c={translateX:1,sortColumn:1},Mc={sortable:1,sortOrder:1,sortFunc:1},Ae={focusData:1},Af={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},lg={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Sg=function(r,y){y.add(r),r.hasChildren()&&r.eachChild(function(x){Sg(x,y)})},qe=function(I,i,G,F,p,y,T,K,j,Z,L){var n,o=G.getValueType(Z),t=G.getAlign(Z);if(G.getEnumValues(Z)){var $=G.toEnumLabel(i,Z),S=bm||0,E=0,e=y,z=O.getTextSize(F,$).width;return n=qg(G.toEnumIcon(i,Z)),n&&(E=y+bm/2,"center"===t?E+=(K-(S+z))/2:"right"===t&&(E=E+K-(S+z)),ao(I,n,E,T+j/2,Z,L),e=E+bm/2),$!=A&&(n?ji(I,$,F,p,e,T,K-(e-y),j):ji(I,$,F,p,y,T,K,j,t)),void 0}return i=G.formatValue(i),i!=A?o===Gd?(Hq(I,y,T,K,j,i),void 0):o===Mf||!o&&hn(i)?(n=qg(i?Mh:xi),ao(I,n,y+K/2,T+j/2,Z,L),void 0):(ji(I,i,F,p,y,T,K,j,t),void 0):void 0},Ig=function(j,O){var v=O.view,h=Yg(j),p=O.column||O.property;v.getDataModel().beginTransaction(),O.editor=j,j.info=O,v.setCurrentEditor(j),v.getView().insertBefore(h,v._79O),tj(j,O.editorRect),j.setFocus?j.setFocus():Bh(j),j.commitValue=function(L,c){j._17Q&&(j=j._17Q),c||v.setValue(O.data,p,j.getValue?j.getValue():j.value),j.close&&j.close(),ws(h)},p.onEditorCreated&&p.onEditorCreated(O)},Jp=function(V,o,G,n,C){var k=cj(V,G),y=o.value,X=o.view,P=C.getValueType(o.data);return k.onblur=k.onchange=function(){X.endEditing()},"input"===V?(y=C.formatValue(y),y!=A&&(k.value=y),k.onkeydown=function(d){Yq(d)?X.endEditing():hb(d)&&X.endEditing(!0)},(P===ok||P===Dl)&&x(k,vd,O.numberListener)):V===lk&&n.forEach(function(I){var M=J.createElement("option");M.innerHTML=C.toEnumLabel(I),M.value=I,C.isEnumEqual(y,I)&&(M.selected=!0),gr(k,M)}),Ig(k,o),k},fq=f.widget={},oo=function(J,c,W){Bg(V+".widget."+J,c,W)};kk(lm,{ms_value:function(Q){Q.getValue=function(e){var w=this.getItemById(e),b=w.element;return xr(b)?b:b?b.getValue?b.getValue():b.value:w.selected},Q.setValue=function(T,H){var E=this.getItemById(T);if(E){var V=E.element;V&&!xr(V)?V.setValue?V.setValue(H):V.value=H:hn(H)?(E.selected=H,this.iv()):(E.element=H,this.iv())}},Q.v=function(J,a){var E=this;if(2===arguments.length)E.setValue(J,a);else{if(!Bq(J))return E.getValue(J);for(var F in J)E.setValue(F,J[F])}return E}},_46o:function(k){k._icon=A,k._accessType=A,k._valueType=A,k._editable=!1,k._batchEditable=!0,k._align=zd,k._nullable=!0,k._emptiable=!1,k.setParent=jn,k.formatValue=function(Y){var X=this,n=X._valueType;return X.getEnumValues()?X.toEnumLabel(Y):n===Mf?!!Y:Y!=A&&n===ok?T(Y):Y},k.setEnum=function(j,G,k,Y,S,r,F){var c=this;j&&!Nq(j)&&j.values&&(Y=j.editable,k=j.icons,G=j.labels,S=j.strict,r=j.maxHeight,F=j.dropDownWidth,j=j.values),yd(j)&&(j=j._as),yd(G)&&(G=G._as),yd(k)&&(k=k._as),c._enumValues=j,c._enumLabels=G,c._enumIcons=k,c._enumEditable=Y,c._enumStrict=S==A?!0:S,c._enumMaxHeight=r,c._enumDropDownWidth=F,j&&j.length&&Fb(j[0])&&(c._valueType=Dl),c.fp("enum",!1,!0)},k.getEnumDropDownWidth=function(){return this._enumDropDownWidth},k.getEnumMaxHeight=function(){return this._enumMaxHeight},k.isEnumEditable=function(){return this._enumEditable},k.getEnumValues=function(){return this._enumValues},k.getEnumLabels=function(){return this._enumLabels},k.getEnumIcons=function(){return this._enumIcons},k.isEnumStrict=function(){return this._enumStrict},k.isEnumEqual=function(N,O){return this._enumStrict?N===O:N==O},k.toEnumLabel=function(O,e){var G=this,p=G.getEnumValues(e),_=G.getEnumLabels(e);if(p&&_)for(var b=0;b<p.length;b++)if(G.isEnumEqual(O,p[b]))return _[b];return O},k.toEnumIcon=function(Q,b){var Y=this,E=Y.getEnumValues(b),l=Y.getEnumIcons(b);if(E&&l)for(var V=0;V<E.length;V++)if(Y.isEnumEqual(Q,E[V]))return l[V];return m}},_45o:function(L){L._87o=function(v,M,r,A,q,$){if(v){var j=this,O=j._90I,N=Gj(1);j._columnLineVisible&&(q-=1),j._rowLineVisible&&($-=1),0>=q||0>=$||(j._90I||(O=j._90I={}),O[M]||(O[M]=new Dj),tj(N,j.tx()+r,j.ty()+A,q,$),gr(N,v),j._view.insertBefore(N,j._79O),v.onParentAdded&&v.onParentAdded(N),O[M].add(N))}},L._76o=function(){var I=this,L=I._90I;if(L){for(var n in L)L[n].each(function(G){ws(G)});delete I._90I}},L._77o=function(V){var A=this;if(A._90I){var E=A._90I[V];E&&(E.each(function(E){ws(E)}),delete A._90I[V])}}},_47o:function(b){b.getValue=function(U,Q){return Q.getValue?Q.getValue(U,Q,this):tg(U,Q.getAccessType(),Q.getName())},b.setValue=function(x,f,$){if(f.isEmptiable(x)||""!==$||($=m),f.isNullable(x)||$!=A){var N=this,D=f.getName(x),V=f.getAccessType(x),L=f.getValueType(x);L===ok&&xr($)?$=e($):L===Dl&&xr($)?$=parseFloat($):L===Mf&&xr($)&&($="true"===$),N._batchEditable&&f._batchEditable&&N.isSelected(x)?N.sm().each(function(O){f.setValue?f.setValue(O,f,$,N):Yj(O,V,D,$)}):f.setValue?f.setValue(x,f,$,N):Yj(x,V,D,$)}},b.setCurrentEditor=function(D){this.endEditing(),this._currentEditor=D,this.redraw()},b.isEditing=function(o,z){var a=this,D=a._currentEditor;if(!D)return!1;if(z){var q=D.info;return q?(q.column||q.property)===z&&q.data===o:!1}return!0},b.endEditing=function(Z){var L=this,R=L._currentEditor;R&&(delete L._currentEditor,R.commitValue&&R.commitValue(R.info,Z),L.redraw(),L.getDataModel().endTransaction())},b.beginEditing=function(i){this.endEditing();var r=this,W=i.column||i.property;if(W.beginEditing)W.beginEditing(i);else{var v=i.data,V=i.value,P=r.getSelectBackground(v),b=W.getEnumValues(v),y=W.getSlider(v),u=W.getColorPicker(v);if(y){var B=zo(fq.Slider,y);return B.setValue(V),B.getView().onblur=function(){r.endEditing()},B.isInstant()&&(B.onValueChanged=function(){r.setValue(v,W,B.getValue())}),Ig(B,i),void 0}if(u||W.getValueType(v)===Gd){var z=zo(fq.ColorPicker,u);return z.setValue(V),z.onClosed=function(){r.endEditing()},z.isInstant()&&(z.onValueChanged=function(z,O){r.setValue(v,W,O)}),Ig(z,i),z.open(),void 0}if(b){if(fq.ComboBox){var Q=new fq.ComboBox;Q.setValue(V),Q.setValues(b),Q.setLabels(W.getEnumLabels(v)),Q.setIcons(W.getEnumIcons(v)),Q.setEditable(W.isEnumEditable(v)),Q.setStrict(W.isEnumStrict(v)),Q.setMaxHeight(W.getEnumMaxHeight(v)),Q.setDropDownWidth(W.getEnumDropDownWidth(v)),Q.onClosed=function(){r.endEditing()},Ig(Q,i),Q.open()}else Jp(lk,i,P,b,W);return}var Z=W.getValueType(v);if(Z===Mf||hn(V))return r.setValue(v,W,!V),void 0;if(W.getItemEditor(v)){var s=sg(W.getItemEditor(v)),x=new s(v,W,r,i),C=x.getView();return C._17Q=x,x.setValue(V),dm(C),Ig(C,i),x.editBeginning&&x.editBeginning(),void 0}Jp("input",i,P,A,W)}}},_44o:function(S){S.init=function(A){var n=this,m=n.th=new dc(A),_=n._view=hg(1,n);n.tv=n._tableView=A,gr(_,m.getView()),gr(_,A.getView()),m.mp(function(S){S.property===On&&n.iv()}),n.iv()},S.getTableView=function(){return this.tv},S.getTableHeader=function(){return this.th},S.getDataModel=function(){return this.tv.dm()
},S.getColumnModel=function(){return this.tv.getColumnModel()},S.setColumns=function($){this.tv.setColumns($)},S.addColumns=function($){this.tv.addColumns($)},S.endEditing=function(){this.tv.endEditing()},S.validateImpl=function(){var _=this,M=_.th,h=$m(M),Q={x:0,y:0,width:_.getWidth(),height:h};tj(M,Q),Q.y=h,Q.height=$(0,_.getHeight()-h),tj(_.tv,Q)}},ms_vs:function(H){H._41o=function(){return this._29I.height<this._59I},H._43o=function(){var Z=this;Z._41o()&&(Z._58I||(l(function(){Z._94O()},Nf),Z.iv()),Z._58I=new Date)},H._94O=function(){var J=this;if(J._58I){var i=new Date;i.getTime()-J._58I.getTime()>=Nf?(delete J._58I,J.iv()):l(function(){J._94O()},Nf)}},H._93I=function(){var c=this,r=c._27I;if(c._58I||!c._autoHideScrollBar){r||gr(c._79O,r=c._27I=Gj());var V=c._29I,s=V.height,L=c._59I,b=c.getScrollBarSize(),n=V.width-b-2,E=s*(-c.ty()/L),$=s*(s/L),k=r.style;L>s?(qb>$&&(E=E+$/2-qb/2,0>E&&(E=0),E+qb>s&&(E=s-qb),$=qb),k.visibility=dl,k.background=c.getScrollBarColor(),k.borderRadius=b/2+Ug,tj(r,n,E,b,$)):k.visibility=Sn}else r&&(r.style.visibility=Sn)}},ms_hs:function(Q){Q._40o=function(){return this._29I.width<this._91I},Q._42o=function(){var n=this;n._40o()&&(n._95O||(l(function(){n._94I()},Nf),n.iv()),n._95O=new Date)},Q._94I=function(){var R=this;if(R._95O){var t=new Date;t.getTime()-R._95O.getTime()>=Nf?(delete R._95O,R.iv()):l(function(){R._94I()},Nf)}},Q._92I=function(){var K=this,I=K._28I;if(K._95O||!K._autoHideScrollBar){I||gr(K._79O,I=K._28I=Gj());var v=K._29I,g=v.width,_=K._91I,r=K.getScrollBarSize(),s=v.height-r-2,B=g*(-K.tx()/_),C=g*(g/_),A=I.style;_>g?(qb>C&&(B=B+C/2-qb/2,0>B&&(B=0),B+qb>g&&(B=g-qb),C=qb),A.visibility=dl,A.background=K.getScrollBarColor(),A.borderRadius=r/2+Ug,tj(I,B,s,C,r)):A.visibility=Sn}else I&&(I.style.visibility=Sn)}}}),fp(Mh,tb(16,16,[{type:Pr,rect:[1,1,14,14],background:dg},{type:Qh,rect:[1,1,14,14],width:1,color:Vc},{type:Gk,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),fp(xi,tb(16,16,{type:Qh,rect:[1,1,14,14],width:1,color:Vc})),fp(jj,tb(16,16,[{type:pk,rect:[2,2,12,12],borderWidth:1,borderColor:Vc,background:"#FFF"},{type:pk,rect:[4,4,8,8],background:dg}])),fp(_r,tb(16,16,{type:pk,rect:[2,2,12,12],borderWidth:1,borderColor:Vc})),lm._15Q=function(u){u._29I=xj,u._59I=0,u._91I=0,u._5o=function(H){var z=this;z._30I=new Dj,z._rows=new Dj,z._rowMap={},z._31I=0,z._14I=0,z._view=hg(1,z),z._canvas=Eg(z._view),gr(z._view,z._79O=Gj()),z.dm(H?H:new xg)},u.getCheckIcon=function(P){var J=this.sm(),X=J.co(P);return J.sg()?qg(X?jj:_r):qg(X?Mh:xi)},u.checkData=function(X){var l=this.sm(),D=l.co(X);l.sg()&&D||(this._32o=1,D?l.rs(X):l.as(X),delete this._32o)},u.getDataAt=function(E){E.target&&(E=this.lp(E));var o=d(E.y/this._rowHeight),F=this._rows;return 0>o||o>=F.size()?A:F.get(o)},u.onDataDoubleClicked=function(){},u.onDataClicked=function(){},u.adjustTranslateX=function(){return 0},u.adjustTranslateY=function(D){var x=this.getHeight()-this._59I;return x>D&&(D=x),D>0?0:T(D)},u.onPropertyChanged=function(D){var C=this,i=D.property;Af[i]?C.ivm():Ae[i]||C.redraw(),i===yj?C._42o():i===Mk&&C._43o()},u.getLabel=function(S){return S.toLabel()},u.getLabelFont=function(){return this._labelFont},u.getLabelColor=function(X){var F=this;if(F.isCheckMode()){if(F._focusData===X)return F._labelSelectColor}else if(F.isSelected(X))return F._labelSelectColor;return F._labelColor},u.getStartRowIndex=function(){return this._31I},u.getEndRowIndex=function(){return this._14I},u.getRowDatas=function(){return this._rows},u.getRowIndex=function(m){return this._rowMap[m._id]},u.getRowSize=function(){return this._rows.size()},u.getViewRect=function(){return of(this._29I)},u.isVisible=function(m){return this._visibleFunc?this._visibleFunc(m):!0},u.getCurrentSortFunc=function(){return this._sortFunc},u.setDataModel=function(N){var f=this,W=f._dataModel,p=f._selectionModel;W!==N&&(W&&(W.umm(f.handleDataModelChange,f),W.umd(f.handleDataPropertyChange,f),W.umh(f.handleHierarchyChange,f),p||W.sm().ums(f.handleSelectionChange,f)),f._dataModel=N,N.mm(f.handleDataModelChange,f),N.md(f.handleDataPropertyChange,f),N.mh(f.handleHierarchyChange,f),p?p._21I(N):N.sm().ms(f.handleSelectionChange,f),f.fp("dataModel",W,N))},u.validateModel=function(){var y=this;y._rows.clear(),y._rowMap={},y.buildChildren(y._dataModel._roots);var $=y._rows=y._rows.toList(y.isVisible,y),V=0,u=y.getCurrentSortFunc(),c=$.size();for(u&&$.sort(u);c>V;V++)y._rowMap[$.get(V)._id]=V},u.buildChildren=function(d){var u=this;d.each(function(o){u._rows.add(o),u.buildChildren(o._children)})},u.handleDataModelChange=function(){this.ivm()},u.handleDataPropertyChange=function(L){"parent"===L.property?this.ivm():this.invalidateData(L.data)},u.handleHierarchyChange=function(){this.ivm()},u.handleSelectionChange=function(k){k.datas.each(this.invalidateData,this),this.onSelectionChanged(k)},u.onSelectionChanged=function(J){var B=this,E=B.sm();!B.isAutoMakeVisible()||1!==E.size()||"set"!==J.kind&&"append"!==J.kind||B._32o||B.makeVisible(E.ld())},u.handleBackgroundClick=function(e){im(e)&&!this.isCheckMode()&&this.sm().cs()},u.makeVisible=function(x){x&&(this._23I=x,this.iv())},u.scrollToIndex=function(P){var k=this,M=k._29I,T=M.height,K=k._rowHeight,C=K*P;P>=0&&P<k._rows.size()&&T>0&&(C+K>M.y+T?k.ty(-C+T-K):C<M.y&&k.ty(-C))},u.autoScroll=function(V,m){var L=this,b=L._rowHeight,g=b,Z=b/4,I=L._29I,M=L.lp(V),B={x:L.tx(),y:L.ty()};return b>0&&I&&(M.x-I.x<g?L.translate(Z,0):I.x+I.width-M.x<g&&L.translate(-Z,0),M.y-I.y<g?L.translate(0,Z):I.y+I.height-M.y<g&&L.translate(0,-Z)),B.x=L.tx()-B.x,B.y=L.ty()-B.y,m&&(m.x+=B.x,m.y+=B.y),B},u.getTopRowOrderSelection=function(){var q=this.sm().getTopSelection(),S={},O=new Dj;return q.each(function(d){S[d._id]=d}),this._rows.each(function(d){S[d._id]&&O.add(d)}),O},u.getRowOrderSelection=function(){var A=new Dj;return this._rows.each(function(l){this.isSelected(l)&&A.add(l)},this),A},u.ivm=function(){this.invalidateModel()},u.invalidateModel=function(){var v=this;v._96I||(v._96I=1,v._32I=1,delete v._24I),v.iv()},u.redraw=function(){var w=this;w._32I||(w._32I=1,delete w._24I,w.iv())},u.invalidateData=function(b){var w=this;no?w.redraw():w._32I||(w._24I||(w._24I={}),w._24I[b._id]=b,w.iv())},u.getFocusData=function(){return this._focusData},u.setFocusDataById=function(B){this.setFocusData(this.dm().getDataById(B))},u.setFocusData=function(L){var l=this,O=l._focusData;O!==L&&(l._focusData=L,l.fp("focusData",O,L),O&&l.invalidateData(O),L&&(l.invalidateData(L),l.isAutoMakeVisible()&&l.makeVisible(L)))},u.drawRowBackground=function(d,I,L,B,V,y,z){var v=this,k=v.isCheckMode();(I===v._focusData&&k||L&&!k)&&Hq(d,B,V,y,z,v.getSelectBackground(I))},u.drawData=function(h,Q,y){var v=this,L=v._rowHeight,E=L*y,W=v._29I,S=W.x,U=W.width;h.save(),h.beginPath(),h.rect(S,E,U,L),h.clip(),v._87o(v.drawRow(h,Q,v.isSelected(Q),S,E,U,L),y,S,E,U,L),h.restore(),v._rowLineVisible&&Hq(h,S,E+L-1,U,1,v._rowLineColor)},u._12I=function(k){var s=this,R=s._31I,p=s._29I,B=p.x,d=p.y,w=p.width,I=p.height;for(k.beginPath(),k.rect(B,d,w,I),k.clip(),k.clearRect(B,d,w,I),s._76o(),s._93db(k);R<s._14I;R++)s.drawData(k,s._rows.get(R),R);s._92db(k)},u._13I=function(b){for(var H,k=this,m=k._rowHeight,D=k._29I,G=D.x,z=D.width,L=k._31I,$=k._30I;L<k._14I;L++)H=k._rows.get(L),k._24I[H._id]&&$.add({data:H,index:L});$.isEmpty()||(b.beginPath(),$.each(function($){b.rect(G,$.index*m,z,m)}),b.clip(),$.each(function(Y){b.clearRect(G,Y.index*m,z,m)}),$.each(function(v){k._77o(v.index)}),k._93db(b),$.each(function(O){k.drawData(b,O.data,O.index)}),k._92db(b),$.clear())},u.preValidateModel=function(){this.endEditing&&this.endEditing()},u.validateImpl=function(){var F=this,x=F._canvas,X=F.getWidth(),i=F.getHeight(),m=F._rowHeight,o=F._32I;(X!==x.clientWidth||i!==x.clientHeight)&&(jd(x,X,i),o=1);var V=S&&!a;F._96I&&!V&&(F.preValidateModel(),F.validateModel());var N=F._29I,j={x:-F.tx(),y:-F.ty(),width:X,height:i},E=F._rows.size(),n=pm(x),k=F._23I;o||tc(j,N)||(o=1),F._29I=j,F._59I=E*m+F.getScrollBarSize(),F._31I=d(j.y/m),F._14I=U((j.y+j.height)/m),F._31I<0&&(F._31I=0),F._14I>E&&(F._14I=E),F._99I&&o&&F._99I(),aq(n,F.tx(),F.ty(),1),o?F._12I(n):F._24I&&F._13I(n),F._93I(),F._92I(),n.restore(),F._32I=F._24I=F._96I=A,k&&(F.scrollToIndex(F.getRowIndex(k)),delete F._23I),F.tx(F.tx()),F.ty(F.ty())}},lm._48o=function(u){u._rootVisible=!0,u._rootData=A,u._35o=function(){this._expandMap={},this._levelMap={}},u.validateModel=function(){var _=this,B=_._rootData;_._rows.clear(),_._levelMap={},_._rowMap={},_._currentLevel=0,B?_._rootVisible?_.isVisible(B)&&_.buildData(B):_.buildChildren(B):_.buildChildren(),delete _._currentLevel},u.buildData=function($){var n=this,X=$._id,s=n._rows;n._rowMap[X]=s.size(),s.add($),n._levelMap[X]=n._currentLevel,n.isExpanded($)&&(n._currentLevel++,n.buildChildren($),n._currentLevel--)},u.buildChildren=function(z){var y=this,E=z?z._children:y._dataModel._roots,N=y.getCurrentSortFunc();N&&y.isChildrenSortable(z)?E.toList(y.isVisible,y).sort(N).each(y.buildData,y):E.each(function(D){y.isVisible(D)&&y.buildData(D)})},u.getLevel=function(a){return this._levelMap[a._id]},u.getToggleIcon=function(M){var q=this,d=q._loader,h=q._collapseIcon;return d&&!d.isLoaded(M)?h:M.hasChildren()?q.isExpanded(M)?q._expandIcon:h:A},u.isCheckMode=function(){return this._checkMode!=A},u.isChildrenSortable=function(){return!0},u.handleDataModelChange=function(M){var j=this;M.kind===Gm?delete j._expandMap[M.data._id]:M.kind===xh&&(j._expandMap={}),j.ivm()},u.toggle=function(p){var c=this;c.isExpanded(p)?c.collapse(p):c.expand(p)},u.isExpanded=function(Z){return 1===this._expandMap[Z._id]},u.expand=function(J){var r=this,H=r._loader;r.isExpanded(J)||(H&&!H.isLoaded(J)&&H.load(J),r._expandMap[J._id]=1,r.ivm(),r.onExpanded(J))},u.onExpanded=function(){},u.collapse=function(u){var h=this;h.isExpanded(u)&&(delete h._expandMap[u._id],h.ivm(),h.onCollapsed(u))},u.onCollapsed=function(){},u.expandAll=function(v){if(v)this.expand(v),v.eachChild(function(n){this.expandAll(n)},this);else{var Z=this;Z._dataModel.each(function(g){g.hasChildren()&&(Z._expandMap[g._id]=1)}),Z.ivm()}},u.collapseAll=function(){this._expandMap={},this.ivm()},u.makeVisible=function(i){if(i){var G=this;if(!G._rootData||i.isDescendantOf(G._rootData)){for(var T=i._parent;T;)G.expand(T),T=T._parent;G._23I=i,G.iv()}}},u.checkData=function(r){var f,U=this,D=U._checkMode,R=U.sm(),Q=R.co(r);if(!R.sg()||!Q){if(U._32o=1,D===lc)Q?R.rs(r):R.as(r);else if(D===sj)f=new Dj(r),f.addAll(r._children);else if("descendant"===D)f=new Dj,Sg(r,f);else if("all"===D&&(f=new Dj,Sg(r,f),!Q))for(var S=r._parent;S;)f.add(S),S=S._parent;f&&(Q?R.rs(f):R.as(f)),delete U._32o}},u._97I=function(Z,e,s,X,G,k,v){var M=this,E=M._indent,l=M._levelMap[e._id],P=M.getIconWidth(e),x=qg(M.getToggleIcon(e));x?(X+=E*l,ao(Z,x,X+E/2,G+v/2,e,M),X+=E):X+=E*(l+1),M._checkMode&&(ao(Z,M.getCheckIcon(e),X+E/2,G+v/2,e,M),X+=E),M.drawIcon(Z,e,X,G,P,v),M.drawLabel(Z,e,X+P,G,v)}},lm._14Q=function(U){U.getIcon=function(q){return q.getIcon()},U.getIconWidth=function(T){return this.getIcon(T)?this._indent:0},U.drawIcon=function(M,B,z,_,t,$){if(t){var S=this,T=S.getBodyColor(B),j=qg(S.getIcon(B),T);j&&($-=S.isRowLineVisible()?1:0,Cl(M,j,lq,z,_,t,$,B,S,T),Qm(M,S.getBorderColor(B),z,_,t,$))}},U.drawLabel=function(K,g,Y,T,Z){var Q=this;ji(K,Q.getLabel(g),Q.getLabelFont(g),Q.getLabelColor(g),Y,T,0,Z)}},lm._50o=function(b){b._98I=function(){var J=this,T=J._39o=new xg;J._60I=new Dj,T.mm(J._17o,J),T.md(J._18o,J),T.mh(J._19o,J)},b.setColumns=function(L){this._39o.clear(),this.addColumns(L)},b.addColumns=function(o){var p=this._39o;o.forEach(function(T){if(!(T instanceof fs)){var O=sg(T.className);T=zo(O?O:fs,T)}p.add(T)})},b.onColumnClicked=function(){},b.onCheckColumnClicked=function(){},b._3Q=function(H){for(var u,p=0,D=this._60I,e=D.size();e>p;p++)if(u=D.get(p),u.column===H)return u;return A},b.getColumnAt=function(r){var F=this._4Q(r);return F?F.column:A},b._4Q=function(N){for(var _=this,f=N.target?_.lp(N).x:N.x,h=_._60I,t=0;t<h.size();t++){var l=h.get(t),F=l.startX;if(f>=F&&f<F+l.column.getWidth())return l}return A},b.getToolTip=function(H){var b=this,G=b.getDataAt(H),k=b.getColumnAt(H);return G&&k?k.getToolTip(G,b):A},b.adjustTranslateX=function(X){var h=this.getWidth()-this._91I;return h>X&&(X=h),X>0?0:T(X)},b._99I=function(){var f=this,c=f._29I,x=f._60I;x.clear(),f._91I=0,f._39o._roots.each(function(I){if(I.isVisible()){var b=f._91I+I.getWidth();f._91I<=c.x+c.width&&b>=c.x&&x.add({column:I,startX:f._91I}),f._91I=b}}),f._91I+=f.getScrollBarSize()},b.drawData=function(W,I,G){var p=this,R=p._rowHeight,k=R*G,T=p.isSelected(I),C=p._29I,e=C.x,x=C.width;p.drawRowBackground(W,I,T,e,k,x,R),p._60I.each(function(r){var w=r.column,J=r.startX,S=w.getWidth();S>0&&!p.isEditing(I,w)&&(W.save(),W.beginPath(),W.rect(J,k,S,R),W.clip(),p._87o(p.drawCell(W,I,T,w,J,k,S,R),G,J,k,S,R),p._columnLineVisible&&Hq(W,J+S-1,k,1,R,p._columnLineColor),W.restore())}),p._rowLineVisible&&Hq(W,e,k+R-1,x,1,p._rowLineColor)},b.drawCell=function(J,H,x,c,S,V,K,P){var b=this;if(c.drawCell)return c.drawCell(J,H,x,c,S,V,K,P,b);var L=b.getValue(H,c);qe(J,L,c,b.getLabelFont(H,c,L),b.getLabelColor(H,c,L),S,V,K,P,H,b)},b.getColumnModel=function(){return this._39o},b._17o=function(){this.redraw()},b._18o=function(X){var o=this;X.data===o._sortColumn&&Mc[X.property]?o.ivm():(o._42o(),o.redraw())},b._19o=function(){this.redraw()},b.getCurrentSortFunc=function(){var c=this,E=c._sortColumn;if(E&&E.isSortable()){var K=E.getSortFunc(),o=yl===E.getSortOrder()?1:-1;return K||(K=Mj),function(N,L){return K.call(c,c.getValue(N,E),c.getValue(L,E),N,L)*o}}return c._sortFunc},b.isCellEditable=function(Q,D,o){return D.isEditable()&&this.isEditable()?D.isCellEditable?D.isCellEditable(Q,D,o,this):!0:!1},b._37O=function(m,y){if(im(y))for(var l=this,S=l.lp(y),f=l._60I,e=l._rowHeight,g=l._29I,Z=g.x,w=g.y,u=g.width,K=g.height,O=0;O<f.size();O++){var A=f.get(O),_=A.startX,d=A.column,v=d.getWidth();if(d!==l._31o&&d!==l._4o&&S.x>=_&&S.x<_+v&&l.isCellEditable(m,d,y)){var x={x:_,y:l.getRowIndex(m)*e,width:v,height:e},W={x:x.x+l.tx(),y:x.y+l.ty(),width:x.width,height:x.height},z=0,C=0;return x.x<Z?z=x.x-Z:x.x+x.width>Z+u&&(z=x.x+x.width-Z-u),z&&(l.tx(l.tx()-z),W.x-=z),x.y<w?C=x.y-w:x.y+e>w+K&&(C=x.y+e-w-K),C&&(l.ty(l.ty()-C),W.y-=C),l.beginEditing({data:m,column:d,value:l.getValue(m,d),event:y,rect:x,editorRect:W,view:l}),void 0}}}},fq.BaseItemEditor=function(r,e,a,o){this._data=r,this._column=e,this._master=a,this._editInfo=o},oo("BaseItemEditor",I,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Zk=f.Tab=function(){To(Zk,this)};Pd("Tab",xo,{ms_ac:["view","closable","disabled","visible"],_icon:A,_closable:!1,_disabled:!1,_visible:!0,setParent:jn});var fs=f.Column=function(){To(fs,this)};Pd("Column",xo,{_46o:1,ms_ac:["accessType","valueType",dl,hd,Gn,Dr,"align",Gd,"sortOrder",Ai,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:yl,_sortFunc:A,_sortable:!0,_clickable:!0,setWidth:function(p){16>p&&(p=16);var F=this._width;this._width=p,this.fp(Dr,F,p)},getToolTip:function(T,E){return this.formatValue(E.getValue(T,this))}});var $f=f.Property=function(){To($f,this)};Pd("Property",xo,{_46o:1,ms_ac:["accessType","valueType",hd,Gn,"categoryName",Gd,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:A,getToolTip:function(h,n,$){var r=this;return n?r.formatValue($.getValue(h,r)):$.getPropertyName(r)}}),fq.AccordionView=function(){var w=this;w._20o={},w._21o=new Dj,w._10o=A,w._9o=A,w._11o=A,w._view=hg(0,w),w.iv()},oo("AccordionView",I,{ms_v:1,ms_fire:1,ms_ac:[so,Rq,"titleHeight",pb,Nn,"titleBackground","selectWidth",Ih,"orientation","separatorColor"],_expandIcon:O.accordionViewExpandIcon,_collapseIcon:O.accordionViewCollapseIcon,_titleHeight:kn,_labelColor:O.accordionViewLabelColor,_labelFont:O.accordionViewLabelFont,_titleBackground:O.accordionViewTitleBackground,_selectBackground:O.accordionViewSelectBackground,_selectWidth:O.accordionViewSelectWidth,_orientation:"v",_separatorColor:O.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(f,c,h,U){var L=this,M=Gj();if(L._20o[f])throw f+" already exists";M.onmousedown=Ec,M.style.cursor=ek,x(M,hj?Uc:Kn,function(t){Ec(t)}),x(M,hj?od:hc,function(s){Ec(s),im(s)&&(L._10o===f?L.collapse():L.expand(f))}),gr(L._view,M),L._20o[f]={content:c,div:M,canvas:Eg(M),icon:U},L._21o.add(f),h&&L.expand(f),L.iv()},remove:function(X){var v=this,g=v._20o[X];g&&(ws(g.div),delete v._20o[X],v._21o.remove(X),v.iv())},clear:function(){var H=this;H._21o.toArray().forEach(H.remove,H),H._20o={},H._21o.clear(),H.iv()},isExpanded:function(K){return this._10o===K},expand:function(O){var G=this;G._20o[O]&&G._10o!==O&&(G._10o=O,G.onExpanded(O),G.iv())},onExpanded:function(){},collapse:function(){var p=this;p._10o&&(p.onCollapsed(p._10o),delete p._10o,p.iv())},onCollapsed:function(){},initCanvas:function(F,Y,o){jd(F,Y,o);var f=pm(F);return aq(f,0,0,1),f.clearRect(0,0,Y,o),f},drawTitle:function(n,T,R,r,Z){var W=this,g=qg(Z.icon),E=W.isExpanded(T),V=W._titleHeight,y=W._titleBackground,q=W._selectWidth,o=W._separatorColor,H=qg(E?W._expandIcon:W._collapseIcon),N=q+4;Hq(n,0,0,R,r,y),E&&q&&Hq(n,0,0,q,r,W._selectBackground),(E||W._21o.get(W._21o.size()-1)!==T)&&Hq(n,0,r-1,R,1,o?o:ej(y)),g&&(ao(n,g,N+Wb(g)/2,V/2),N+=Wb(g)+2),ji(n,T,W.getLabelFont(T),W.getLabelColor(T),N,0,0,V),H&&ao(n,H,R-Wb(H)/2-4,V/2)},validateImpl:function(){var A=this,N=A._view,S=0,h=0,k=A.getWidth(),e=A.getHeight(),z=A._titleHeight,U=A._21o.size()*z,J=A._11o,d=A._9o;delete A._11o,delete A._9o,A._21o.each(function(p){var o,Y,d=A._20o[p],D=d.content,w=A._10o===p;Dm(A)?(tj(d.div,S,0,z,e),o=A.initCanvas(d.canvas,z,e),de(o,0,e),Ah(o,-Z),A.drawTitle(o,p,e,z,d),o.restore(),w?(Y=$(0,k-U),D&&(A._11o=D,A._9o=Yg(D),tj(D,S+z,0,Y,e)),S+=z+Y):S+=z):(tj(d.div,0,h,k,z),o=A.initCanvas(d.canvas,k,z),A.drawTitle(o,p,k,z,d),o.restore(),w?(Y=$(0,e-U),D&&(A._11o=D,A._9o=Yg(D),tj(D,0,h+z,k,Y)),h+=z+Y):h+=z)});var H=A._9o;J&&J!==A._11o&&J.endEditing&&J.endEditing(),H&&H!==d&&gr(N,H),d&&d!==H&&ws(d)}}),fq.SplitView=function(R,$,Y,f){var H=this,F=H._dividerDiv=Gj(),P=H._60O=Eg(),p=H._61O=Eg(),D=P.style,i=p.style;H._view=hg(1,H),gr(H._view,F),D.msTouchAction=Kd,D.pointerEvents=Kd,D.cursor=ek,i.msTouchAction=Kd,i.pointerEvents=Kd,i.cursor=ek,R&&H.setLeftView(R),$&&H.setRightView($),Y&&H.setOrientation(Y),f!=A&&H.setPosition(f),H.setStatus(jq),new Wn(H)},oo("SplitView",I,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:O.splitViewDividerSize,_dividerBackground:O.splitViewDividerBackground,_dragOpacity:O.splitViewDragOpacity,_toggleIcon:O.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(b,y){var P=this,K=P._position;isNaN(b)||(y||(P._82O=0>b?-1:b>1?1:0),P._position=b,P.fp(si,K,b))},getLeftView:function(){return this._leftView},setLeftView:function(m){var R=this,G=R._leftView,P=R._view;if(R._leftView!==m){if(G&&G!==R._rightView){var n=Yg(G);n.parentNode===P&&ws(n)}if(R._leftView=m,m){var C=Yg(m);C.parentNode!==P&&P.insertBefore(C,R._dividerDiv)}R.fp("leftView",G,m)}},getRightView:function(){return this._rightView},setRightView:function(J){var y=this,T=y._rightView,C=y._view;if(y._rightView!==J){if(T&&T!==y._leftView){var n=Yg(T);n.parentNode===C&&ws(n)}if(y._rightView=J,J){var E=Yg(J);E.parentNode!==C&&C.insertBefore(E,y._dividerDiv)}y.fp("rightView",T,J)}},validateImpl:function(){var F=this,W=F._draggable,q=F._position,H=F.getWidth(),K=F.getHeight(),r=F._dividerSize,n=F._dividerBackground,e=hj?18:8,u=F._dividerDiv,L=F._82O,p=F._60O,k=F._61O,A=F._toggleIcon,v=F._status,c=u.style,G=null,x=hj?20:4,d=A.comps[0];r>=e||0===r?F._coverDiv&&(ws(F._coverDiv),delete F._coverDiv):F._coverDiv||(F._coverDiv=Gj(),Oe&&(F._coverDiv.style.background=ng),gr(u,F._coverDiv)),F._togglable?p.parentNode||(gr(u,p),gr(u,k)):(ws(p),ws(k));var o=F._coverDiv,V=F._leftView,B=F._rightView;if(Dm(F)){if(r>H&&(r=H),v===jq)if(1===L)var U=Y(q,H),J=$(0,H-r-U);else-1===L?(J=Y(-q,H),U=$(0,H-r-J)):(U=T((H-r)*q),J=$(0,H-r-U));else"cl"===v?(U=0,J=$(0,H-r)):"cr"===v&&(J=0,U=$(0,H-r));V&&tj(V,0,0,U,K),B&&tj(B,U+r,0,J,K),tj(u,U,0,r,K),F._22o=U,o&&(tj(o,r/2-e/2,0,e,K),o.style.cursor=W?Vq:""),u.style.cursor=W?Vq:"";var y=u.clientHeight/2,D=u.clientWidth;jd(p,D,D),tj(p,0,y-D-x,D,D),G=pm(p),aq(G,0,0,1),d.rotation=-Z,qo(G,A,0,0,D,D),G.restore(),jd(k,D,D),tj(k,0,y+x,D,D),G=pm(k),aq(G,0,0,1),d.rotation=Z,qo(G,A,0,0,D,D),G.restore()}else{if(r>K&&(r=K),v===jq)if(1===L)var M=Y(q,K),X=$(0,K-r-M);else-1===L?(X=Y(-q,K),M=$(0,K-r-X)):(M=T((K-r)*q),X=$(0,K-r-M));else"cl"===v?(M=0,X=$(0,K-r)):"cr"===v&&(X=0,M=$(0,K-r));V&&tj(V,0,0,H,M),B&&tj(B,0,M+r,H,X),tj(u,0,M,H,r),F._22o=M,o&&(tj(o,0,r/2-e/2,H,e),o.style.cursor=W?Ik:""),c.cursor=W?Ik:"";var E=u.clientWidth/2,D=u.clientHeight;jd(p,D,D),tj(p,E-D-x,0,D,D),G=pm(p),aq(G,0,0,1),d.rotation=0,qo(G,A,0,0,D,D),G.restore(),jd(k,D,D),tj(k,E+x,0,D,D),G=pm(k),aq(G,0,0,1),d.rotation=s,qo(G,A,0,0,D,D),G.restore()}c.background=n}});var Wn=function(w){this.sv=w,this.addListeners()};Bg(Wn,I,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(r){var k=this,n=k.sv,w=n._dividerDiv,J=n._60O,o=n._61O,c=n._status,H=r.target;if(H===J)c===jq?n.setStatus("cl"):"cr"===c&&n.setStatus(jq);else if(H===o)c===jq?n.setStatus("cr"):"cl"===c&&n.setStatus(jq);else if(se(r)&&(H===w||H===n._coverDiv)&&(Ec(r),n.isDraggable())){n.getLeftView(),n.getRightView();var F=k.maskDiv=Gj();if(F.style.left=0,F.style.top=0,F.style.width=n.getWidth()+"px",F.style.height=n.getHeight()+"px",n.getView().appendChild(F),!n.isContinuousLayout()){var Y=k.resizeDiv=Gj();Y.style.left=w.style.left,Y.style.top=w.style.top,Y.style.width=w.style.width,Y.style.height=w.style.height,Y.style.opacity=n.getDragOpacity(),Y.style.background=n.getDividerBackground(),gr(k.getView(),Y)}k._lastAbsPosition=n._22o,k._86o=Dm(n)?Pb(r).x:Pb(r).y,Ff(k,r)}},handleWindowTouchMove:function(x){se(x)&&this.update(x,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(w){var G=this;G.update(w,!0),G.sv.setStatus(jq),G.maskDiv&&ws(G.maskDiv),G.resizeDiv&&ws(G.resizeDiv),G.maskDiv=G.resizeDiv=A},handle_mousedown:function(b){im(b)&&this.handle_touchstart(b)},handleWindowMouseMove:function(R){this.handleWindowTouchMove(R)},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},update:function(M,C){var d=this,w=d.sv,B=Dm(w)?w.getWidth():w.getHeight(),I=w._dividerSize,S=d._lastAbsPosition-d._86o;Dm(w)?(S+=Pb(M).x,S>B-I&&(S=B-I),0>S&&(S=0),d.resizeDiv&&(d.resizeDiv.style.left=S+Ug)):(S+=Pb(M).y,S>B-I&&(S=B-I),0>S&&(S=0),d.resizeDiv&&(d.resizeDiv.style.top=S+Ug)),C&&B!==I&&(1===w._82O?w.setPosition(S,1):-1===w._82O?w.setPosition(S-B+I,1):w.setPosition(S/(B-I),1))}}),fq.TabView=function(){var F=this,u=F._view=hg(1,F),V=F._91O=Gj(1),g=F._tabModel=new xg,n=g.sm(),M=F.invalidate;F._7o=new Dj,F._canvas=Eg(V),gr(u,V),gr(u,F._92O=Gj(1)),n.setSelectionMode(kl),n.ms(F.handleSelectionChange,F),g.mm(M,F),g.mh(M,F),g.md(M,F),F._interactor=new Hl(F),F.iv()},oo("TabView",I,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",pb,Nn,"tabHPadding","tabBackground","selectWidth",Ih,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:kq,_tabHeight:kn,_tabGap:O.tabViewTabGap,_labelColor:O.tabViewLabelColor,_labelFont:O.tabViewLabelFont,_tabBackground:O.tabViewTabBackground,_selectWidth:O.tabViewSelectWidth,_selectBackground:O.tabViewSelectBackground,_moveBackground:O.tabViewMoveBackground,_insertColor:O.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(T,W,I){var F,H=this._tabModel;return T instanceof Zk?(F=T,W&&F.setView(W)):(F=new Zk,F.setName(T),F.setView(W)),H.add(F),I&&H.sm().ss(F),F},getLabel:function(V){return V.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(C){this._23o=C,this.iv()},get:function(J){var e=this,b=e._tabModel;if(Fb(J))return b._roots.get(J);if(xr(J)){var i;return b.each(function(h){J===e.getLabel(h)&&(i=h)}),i}return J instanceof Zk?J:A},select:function(k){this._tabModel.sm().ss(this.get(k))},remove:function(y){var j=this;if(y=j.get(y)){var Y=j._tabModel,S=Y._roots.indexOf(y);j._tabModel.remove(y),j.selectByIndex(--S)}},getCurrentTab:function(){return this._8o},hideTabView:function(Z,R){R.parentNode===this._92O&&(zl(R)?(R.style.display=Rr,R._tab_=Z):ws(R),ts())},showTabView:function(H,f){zl(f)&&(f.style.display="block",f._tab_=H),f.parentNode!==this._92O&&(gr(this._92O,f),ts())},_24o:function(){var X,H=this,T=H._8o,k=H._9o,A=H._tabModel.sm().ld();A&&(X=Yg(A.getView())),X!==k&&(k&&(T.getView()&&T.getView().endEditing&&T.getView().endEditing(),H.hideTabView(T,k)),X&&H.showTabView(A,X)),H._8o=A,H._9o=X,T!==A&&H.onTabChanged(T,A)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(Z,n){this.selectByIndex(--n)},selectByIndex:function(c){var P=this,l=P._tabModel,D=l.size();if(D&&!l.sm().ld()){c==A&&(c=0),c>=D&&(c=D-1),0>c&&(c=0);for(var f=c;f>=0;f--){var S=P.get(f);if(!S.isDisabled())return P.select(S),S}for(f=c+1;D>f;f++)if(S=P.get(f),!S.isDisabled())return P.select(S),S}},getTabWidth:function(V){var C=this.getTabHPadding(),x=4+2*C,Z=qg(V.getIcon());Z&&(x+=Wb(Z,V)+4);var H=this.getLabel(V);return H&&(x+=wr(this.getLabelFont(V),H).width+4),V.isClosable()&&(x+=10),x},drawTab:function(c,C,U,l,u,E,v){var d,P=this,I=P._tabPosition,b=this.getTabHPadding(),i=U+4+b,$=P._selectWidth,X=qg(C.getIcon()),m=C.isDisabled(),r=P.getLabelColor(C),y=P.getLabelFont(C),B=P.getLabel(C),O=P._selectBackground,Q=I===zd+"-vertical",a=I===Nl+"-vertical";(Q||a)&&(i=l+4+b),m&&(c.globalAlpha=Ep),Hq(c,U,l,u,E,v),C===P._8o&&$&&(I===kq?Hq(c,U,l+E-$,u,$,O):I===zd?Hq(c,U+u-$,l,$,E,O):I===Nl?Hq(c,U,l,$,E,O):Q?Hq(c,U+u-$,l,$,E,O):a?Hq(c,U,l,$,E,O):Hq(c,U,l,u,$,O));var z=u/2;if(Q&&(de(c,z,l+E/2),Ah(c,s),de(c,-z,-l-E/2)),X){var S=js(X,C),h=Wb(X,C);if(Q||a){var k=U+u/2,J=i+S/2;de(c,k,J),Ah(c,Z),de(c,-k,-J),ao(c,X,U+u/2,i+S/2,C,P),de(c,k,J),Ah(c,-Z),de(c,-k,-J),i+=S+4}else ao(c,X,i+h/2,l+E/2,C,P),i+=h+4}return Q||a?(de(c,u/2,i+u/2),Ah(c,Z),de(c,-u/2,-i-u/2),ji(c,B,y,r,U,i,E,u),de(c,u/2,i+u/2),Ah(c,-Z),de(c,-u/2,-i-u/2)):ji(c,B,y,r,i,l,u,E),Q&&(de(c,z,l+E/2),Ah(c,-s),de(c,-z,-l-E/2)),C.isClosable()&&(d=a?{x:U+u-12,y:l+E-12,width:12,height:12}:{x:U+u-12,y:l+2,width:12,height:12},this.drawCloseIcon(C,c,r,d)),m&&(c.globalAlpha=1),d},drawCloseIcon:function(t,h,p,c){var _=c.x,Q=c.y;h.strokeStyle=p,h.lineWidth=1,h.beginPath(),h.moveTo(_+2,Q+8),h.lineTo(_+8,Q+2),h.moveTo(_+8,Q+8),h.lineTo(_+2,Q+2),h.stroke()},getTabAt:function(x){var r=this._interactor._8Q(x);return r?r.tab:null},validateImpl:function(){var O=this;O._24o();var w,W=O._canvas,d=O._tabPosition,a=O._91O,j=O._92O,b=O._tabModel,A=O.getWidth(),U=O.getHeight(),m=O._tabHeight,e=O._7o,_=O._tabGap,g=d===kq,n=d===zd,Y=d===Nl,o=d===zd+"-vertical",l=d===Nl+"-vertical",i=O._23o,J=0;if((n||Y)&&b._roots.each(function(r){J=$(O.getTabWidth(r),J)}),g?(tj(a,0,0,A,m),w={x:0,y:m,width:A,height:$(0,U-m)}):n?(tj(a,0,0,J,U),w={x:J,y:0,width:$(0,A-J),height:U}):Y?(tj(a,A-J,0,J,U),w={x:0,y:0,width:$(0,A-J),height:U}):o?(tj(a,0,0,m,U),w={x:m,y:0,width:$(0,A-m),height:U}):l?(tj(a,A-m,0,m,U),w={x:0,y:0,width:$(0,A-m),height:U}):(tj(a,0,U-m,A,m),w={x:0,y:0,width:A,height:$(0,U-m)}),tj(j,w),o||l){O._9o&&(w.x=0,tj(O._8o.getView(),w)),jd(W,m,U);var u=pm(W),f=0;if(aq(u,0,O.ty(),1),u.clearRect(0,0,m,U),e.clear(),b._roots.each(function(y){if(y.isVisible()){var C,S=O.getTabWidth(y);i&&i.tab===y||(C=O.drawTab(u,y,0,f,m,S,O._tabBackground)),e.add({_75o:C,tab:y,startY:f,endY:f+S,height:S}),f+=S+_}}),O._23Q=$(0,f-_),i){var M=i.position;O.drawTab(u,i.tab,0,i.startY,m,i.height,O._moveBackground),Hq(u,0,M,m,1,O._insertColor)}if(u.restore(),O._selectionChanged){O._selectionChanged=!1;for(var x=O.ty(),v=0;v<e.size();v++){var K=e.get(v);if(K.tab===O._8o){if(K.endY+x<0){O.ty(-K.startY);break}if(K.startY+x>U){O.ty(U-K.endY);break}}}}O.ty(O.ty())}else if(n||Y){O._9o&&(w.x=0,tj(O._8o.getView(),w)),jd(W,J,U);var u=pm(W),f=0;if(aq(u,0,O.ty(),1),u.clearRect(0,0,J,U),e.clear(),b._roots.each(function(l){if(l.isVisible()){var R;i&&i.tab===l||(R=O.drawTab(u,l,0,f,J,m,O._tabBackground)),e.add({_75o:R,tab:l,startY:f,endY:f+m,height:m}),f+=m+_}}),O._23Q=$(0,f-_),i){var M=i.position;O.drawTab(u,i.tab,0,i.startY,J,i.height,O._moveBackground),Hq(u,0,M,J,1,O._insertColor)}if(u.restore(),O._selectionChanged){O._selectionChanged=!1;for(var x=O.ty(),v=0;v<e.size();v++){var K=e.get(v);if(K.tab===O._8o){if(K.endY+x<0){O.ty(-K.startY);break}if(K.startY+x>U){O.ty(U-K.endY);break}}}}O.ty(O.ty())}else{O._9o&&(w.y=0,tj(O._8o.getView(),w)),jd(W,A,m);var u=pm(W),N=0;if(aq(u,O.tx(),0,1),u.clearRect(0,0,A,m),e.clear(),b._roots.each(function(l){if(l.isVisible()){var f,A=O.getTabWidth(l);i&&i.tab===l||(f=O.drawTab(u,l,N,0,A,m,O._tabBackground)),e.add({_75o:f,tab:l,startX:N,endX:N+A,width:A}),N+=A+_}}),O._64I=$(0,N-_),i){var M=i.position;O.drawTab(u,i.tab,i.startX,0,i.width,m,O._moveBackground),zj(u,O._insertColor,M,0,m)}if(u.restore(),O._selectionChanged){O._selectionChanged=!1;for(var X=O.tx(),v=0;v<e.size();v++){var K=e.get(v);if(K.tab===O._8o){if(K.endX+X<0){O.tx(-K.startX);break}if(K.startX+X>A){O.tx(A-K.endX);break}}}}O.tx(O.tx())}for(var C=[],T=j.children,v=0;v<T.length;v++){var D=T[v],R=D._tab_;R&&!b.contains(R)&&C.push(D)}C.forEach(function($){j.removeChild($)})}});var Hl=function(p){this.tv=p,this.addListeners()};Bg(Hl,I,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(V){this.handleScroll(V,10*(V.wheelDelta/40))},handle_DOMMouseScroll:function(l){this.handleScroll(l,10*-l.detail)},handleScroll:function(P,y){Ec(P);var O=this.tv,A=O._tabPosition;!O._40o()||A!==kq&&A!==Ud||O.tx(this.tv.tx()+y),!O._41o()||A!==zd&&A!==Nl&&A!==zd+"-vertical"&&A!==Nl+"-vertical"||O.ty(this.tv.ty()+y)},_8Q:function(P){var l,U,N=this.tv,H=N._tabPosition,y=N._7o;if(H===kq||H===Ud){var v=N.lp(P).x;for(l=0;l<y.size();l++)if(U=y.get(l),U.startX<=v&&v<=U.endX)return U}else if(H===zd||H===Nl||H===zd+"-vertical"||H===Nl+"-vertical"){var r=N.lp(P).y;for(l=0;l<y.size();l++)if(U=y.get(l),U.startY<=r&&r<=U.endY)return U}return A},isClickable:function(r){var l=this.tv,W=l._tabPosition,V=this._73o=this._8Q(r);return!l._40o()||W!==kq&&W!==Ud?!l._41o()||W!==zd&&W!==Nl&&W!==zd+"-vertical"&&W!==Nl+"-vertical"?V&&(!V.tab.isDisabled()||l.isMovable()):!0:!0},handle_mousemove:function(F){var G=this;ig?G._74o=G._8Q(F):G.getView().style.cursor=G.isClickable(F)?ek:""},handle_mousedown:function(B){this.handle_mousemove(B),this.handle_touchstart(B)},handle_touchstart:function(W){var n=this,Q=n.tv,q=Q._tabPosition;Ec(W),im(W)&&n.isClickable(W)&&(q===kq||q===Ud?(n.x=Pb(W).x,n.lp=Q.lp(W),n.tx=Q.tx()):(n.y=Pb(W).y,n.lp=Q.lp(W),n.ty=Q.ty()),Ff(n,W))},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(k){var i,z=this,A=z.tv,s=A._tabPosition,B=z._73o;if(s===kq||s===Ud){if(i=Pb(k).x-z.x,!z._25o&&!z.moving&&G(i)>2&&(A._40o()&&!Hr(k)?z._25o=1:B&&A.isMovable()&&(z.moving=1)),z._25o)A.tx(z.tx+i);else if(z.moving){var M=z.lp.x+i,x=A._tabGap/2;A._7o.each(function(b){var R=b.endX,u=M-b.startX<R-M;M>=b.startX&&R>=M&&A._7Q({tab:B.tab,startX:B.startX+i,width:B.width,front:u,insertTab:b.tab,position:u?$(0,b.startX-x):Y(A._64I,R+x)})})}}else if(i=Pb(k).y-z.y,!z._25o&&!z.moving&&G(i)>2&&(A._41o()&&!Hr(k)?z._25o=1:B&&A.isMovable()&&(z.moving=1)),z._25o)A.ty(z.ty+i);
else if(z.moving){var w=z.lp.y+i,x=A._tabGap/2;A._7o.each(function(b){var k=b.endY,l=w-b.startY<k-w;w>=b.startY&&k>=w&&A._7Q({tab:B.tab,startY:B.startY+i,height:B.height,front:l,insertTab:b.tab,position:l?$(0,b.startY-x):Y(A._23Q,k+x)})})}},handleWindowMouseUp:function(f){this.handleWindowTouchEnd(f)},handleWindowTouchEnd:function(){var $=this,W=$.tv,j=W._tabPosition,y=W.getTabModel(),L=y._roots,i=$._73o;if($.moving){var T=W._23o;if(T&&T.insertTab!==T.tab){var l=T.tab,u=L.remove(l),k=L.indexOf(T.insertTab);k>=0&&(T.front||k++,k<=L.size()&&(L.add(l,k),y._38I(l,u,k)))}W._7Q(A),delete $.moving}else if(!$._25o&&i){l=i.tab;var Q=$._74o;if(!Q||Q.tab===l)if(!l.isDisabled()&&ub(i._75o,$.lp)){var Y=function(){var V=L.indexOf(l);y.remove(l),W.onTabClosed(l,V)};W.onTabClosing(l,Y)&&Y()}else l.isDisabled()||W._8o===l||y.sm().ss(l)}$._25o=$._73o=$._74o=j===kq||j===Ud?$.x=$.lp=$.tx=A:$.y=$.lp=$.ty=A}}),fq.PropertyView=function(l){var I=this;I._view=hg(1,I),I._canvas=Eg(I._view),gr(I._view,I._79O=Gj()),I._rows=new Dj,I._28o=new Dj,I._26o={},I._26Q={};var P=I._propertyModel=new xg,G=I.ivm;P.mm(G,I),P.md(G,I),P.mh(G,I),I.dm(l?l:new xg),new dh(I)},oo("PropertyView",I,{ms_ac:[pb,Jj,Nn,hd,Gn,"categorizable",Xp,Ai,os,so,Rq,Ee,zm,as,"selectRowIndex",Ih,"background",Zb,ti,Ab,Fg,vq],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:xj,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:bm,_background:O.propertyViewBackground,_expandIcon:O.propertyViewExpandIcon,_collapseIcon:O.propertyViewCollapseIcon,_scrollBarColor:dq,_scrollBarSize:dp,_autoHideScrollBar:rq,_selectBackground:O.propertyViewSelectBackground,_rowHeight:yq,_rowLineVisible:O.propertyViewRowLineVisible,_rowLineColor:O.propertyViewRowLineColor,_10I:.5,_columnLineVisible:O.propertyViewColumnLineVisible,_columnLineColor:O.propertyViewColumnLineColor,_labelColor:O.propertyViewLabelColor,_labelSelectColor:O.propertyViewLabelSelectColor,_labelFont:O.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(u){0>u&&(u=0),u>1&&(u=1);var E=this,Y=E._10I;E._10I=u,E.fp("columnPosition",Y,u)},getPropertyName:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(e,l,Y){return Y===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(m,M){return M===this._selectRowIndex?this._labelSelectColor:m.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(N){var D=this.getHeight()-this._59I;return D>N&&(N=D),N>0?0:T(N)},isExpanded:function(n){if(!n)return!0;var M=this._26o[n];return M?M.isExpanded:!(this._26Q[n]===!1)},toggle:function(T){var B=this;B.isExpanded(T)?B.collapse(T):B.expand(T)},expandAll:function(){this.validate();for(var w in this._26o)this.expand(w)},expand:function(V){if(V&&V!==Rr){var f=this,t=f._26o[V];t&&!t.isExpanded&&(t.isExpanded=!0,f.onExpanded(V),f.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var L in this._26o)this.collapse(L)},collapse:function(j){if(j&&j!==Rr){var J=this,F=J._26o[j];F&&F.isExpanded&&(F.isExpanded=!1,J.onCollapsed(j),J.ivm())}},onCollapsed:function(){},getCategoryName:function(z){if(!this.isCategorizable())return Rr;var c=z.getCategoryName();return c?c:Rr},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(G){var M=this,A=M._dataModel;A!==G&&(A&&(A.umd(M.handlePropertyChange,M),M._selectionModel||A.sm().ums(M.handleSelectionChange,M)),M._dataModel=G,G.md(M.handlePropertyChange,M),M._selectionModel?M._selectionModel._21I(G):G.sm().ms(M.handleSelectionChange,M),M.fp(rg,A,G))},isVisible:function(Q){return this._visibleFunc?this._visibleFunc(Q):!0},onPropertyChanged:function(A){var Y=this,m=A.property;lg[m]?Y.ivm():Y.iv(),m===Mk&&Y._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Jd},handlePropertyChange:function(R){this._27o===R.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var Y=this;Y._96I||(Y.setSelectRowIndex(-1),Y._96I=1,Y.iv())},redraw:function(){this.iv()},validateModel:function(){var G=this,P=G._rows,U=G._28o,a={},z=new Dj,Q=G._27o;G.updateCurrentData(),Q!==G._27o&&G.endEditing(),P.clear(),U.clear(),G.getRawProperties().each(function(u){if(G.isVisible(u)){z.add(u);var q=G.getCategoryName(u);a[q]||(U.add(q,q===Rr?0:m),a[q]={isExpanded:G.isExpanded(q),properties:new Dj})}}),G._sortFunc&&z.sort(G._sortFunc);for(var d in G._26o)G._26Q[d]=G.isExpanded(d);G._26o=a,U.each(function(O){O!==Rr&&P.add(O);var l=a[O];l.isExpanded&&z.each(function(T){G.getCategoryName(T)===O&&(l.properties.add(T),P.add({property:T,data:G._27o}))},G)})},validateImpl:function(){var N=this;N._76o(),N._96I&&(N.validateModel(),delete N._96I);var R=N._canvas,c=N.getWidth(),I=N.getHeight(),o=-N.ty(),x=N._rowHeight,Y=N._indent,i=c-Y,P=N._rows,X=P.size(),K=N._9I=Y+i*N._10I,p=N._59I=X*x;jd(R,c,I),N._29I={x:0,y:o,width:c,height:I},N._31I=d(o/x),N._14I=U((o+I)/x),N._31I<0&&(N._31I=0),N._14I>X&&(N._14I=X);var r,v=pm(R),W=N._background;aq(v,0,-o,1),v.beginPath(),v.rect(0,o,c,I),v.clip(),v.clearRect(0,o,c,I),N._93db(v),W&&Hq(v,0,0,Y,p,W);for(var w=N._31I;w<N._14I;w++){var g=P.get(w),o=x*w;if(xr(g))W&&Hq(v,Y,o,i,x,W),r=qg(N.isExpanded(g)?N._expandIcon:N._collapseIcon),r&&Cl(v,r,lq,0,o,Y,x),v.save(),v.beginPath(),v.rect(Y,o,i,x),v.clip(),N.drawCategoryName(v,g,w,Y,o,i,x),v.restore();else{var B=g.property,M=g.data,r=qg(B.getIcon()),h=N._selectRowIndex===w?N.getSelectBackground():A;if(r&&Cl(v,r,lq,0,o,Y,x),h&&Hq(v,Y,o,i,x,h),v.save(),v.beginPath(),v.rect(Y,o,K-Y,x),v.clip(),N.drawPropertyName(v,B,w,Y,o,K-Y,x),v.restore(),!N.isEditing(M,B)){var t=K+1,l=c-K-1;v.save(),v.beginPath(),v.rect(t,o,l,x),v.clip(),N._87o(N.drawPropertyValue(v,B,N.getValue(M,B),w,t,o,l,x,M),w,t,o,l,x),v.restore()}}N._rowLineVisible&&Hq(v,Y,o+x-1,i,1,N._rowLineColor)}N._columnLineVisible&&(Hq(v,K,0,1,p,N._columnLineColor),Hq(v,c-1,0,1,p)),N._92db(v),N._93I(),v.restore(),N.ty(N.ty())},drawCategoryName:function(R,G,I,h,Q,Z,Y){ji(R,G,this.getCategoryFont(G),this.getCategoryColor(G),h,Q,Z,Y)},drawPropertyName:function(c,f,H,k,M,N,b){return f.drawPropertyName?(f.drawPropertyName(c,f,H,k,M,N,b,this),void 0):(ji(c,this.getPropertyName(f),this.getPropertyFont(f,H),this.getPropertyColor(f,H),k,M,N,b),void 0)},drawPropertyValue:function(h,v,V,e,D,L,B,q,i){return v.drawPropertyValue?v.drawPropertyValue(h,v,V,e,D,L,B,q,i,this):(qe(h,V,v,this.getLabelFont(v,V,e),this.getLabelColor(v,V,e),D,L,B,q,i,this),void 0)},isPropertyEditable:function(G){return G.isEditable()&&this.isEditable()},setProperties:function(Y){this._propertyModel.clear(),this.addProperties(Y)},addProperties:function(q){if(q){var T=this._propertyModel;q.forEach(function(M){if(!(M instanceof $f)){var d=sg(M.className);M=zo(d?d:$f,M)}T.add(M)})}},getRowIndexAt:function($){var q=this,k=d(q.lp($).y/q._rowHeight);return k>=0&&k<q._rows.size()?k:-1},getPropertyAt:function(R){var S=this,Q=S.getRowIndexAt(R);return Q>=0?S._rows.get(Q).property:A},getToolTip:function(I){var R=this,r=R.getPropertyAt(I),b=R._27o;return r&&b?r.getToolTip(b,R._9I<R.lp(I).x,R):A}});var dh=function(Z){this.pv=Z,this.addListeners()};Bg(dh,I,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(k){this.getView().style.cursor=k},clear:function(){var v=this;v._62O=v.cp=v.ty=v.p=A,v.setCursor(lc)},handle_mousedown:function(R){this.handle_touchstart(R)},handle_touchstart:function(E){var v=this,I=v.pv;Ec(E),I.setFocus(E)&&(im(E)?(v.cp=Pb(E),v.ty=I.ty(),v.p=I.getColumnPosition(),v.handle_touchmove(E)):I.setSelectRowIndex(I.getRowIndexAt(E)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(k){this.handle_touchend(k)},handle_touchend:function(r){var N=this;if(N.cp&&!N._62O){var K=N.pv,W=K.lp(r),Z=W.x,n=W.y,L=K._indent,q=K.getRowIndexAt(r),y=K._9I;if(q>=0){var c=K._rowHeight,e=c*q,d=K._rows.get(q),m=d.property;if(xr(d))qg(K.isExpanded(d)?K._expandIcon:K._collapseIcon)&&Z>=0&&L>=Z&&n>=e&&e+c>=n?K.toggle(d):yk(r)&&K.toggle(d);else if(Z>y&&K.isPropertyEditable(m,r)){var J={x:y+1,y:e,width:K.getWidth()-y-1,height:c},a={x:J.x+K.tx(),y:J.y+K.ty(),width:J.width,height:J.height},H=0,M=K._29I;J.y<M.y?H=J.y-M.y:J.y+c>M.y+M.height&&(H=J.y+c-M.y-M.height),H&&(K.ty(K.ty()-H),a.y-=H),K.beginEditing({data:d.data,property:m,value:K.getValue(d.data,m),event:r,rect:J,editorRect:a,view:K})}}K.setSelectRowIndex(q)}N.clear()},handleWindowMouseMove:function(j){this.handleWindowTouchMove(j)},handleWindowTouchMove:function(z){var C=this,x=C.pv,U=C.ty,v=C.cp,K=Pb(z),M=C._62O;if("p"===M)x.setTranslateY(U+K.y-v.y);else if("c"===M){var t=x.getWidth()-x._indent;if(t>16){var r=C.p-(v.x-K.x)/t,f=16/t;f>r&&(r=f),r>1-f&&(r=1-f),x.setColumnPosition(r)}}else"s"===M&&x.setTranslateY(U+(v.y-K.y)*x._59I/x._29I.height)},handle_mousemove:function(M){this.handle_touchmove(M)},handle_touchmove:function(U){if(!ig&&im(U)){var u=this,C=u.pv,N=G(C.lp(U).x-C._9I)<=(hj?8:3);u.cp?u._62O||(N?(u._62O="c",Ff(u)):G(Pb(U).y-u.cp.y)>=2&&(u._62O=u.isV(U)?"s":"p",Ff(u))):(N?u.setCursor(Vq):u.setCursor(lc),u.isV(U)&&C._43o())}},isV:function(g){var C=this.pv,E=C._29I;return C._41o()&&E.x+E.width-C.lp(g).x<Fn},handle_mousewheel:function(j){this.handleScroll(j,j.wheelDelta/40)},handle_DOMMouseScroll:function(e){2===e.axis&&this.handleScroll(e,-e.detail)},handleScroll:function(A,e){var v=this.pv;Ec(A),v.endEditing(),v.translate(0,e*v.getRowHeight())},handle_keydown:function(S){var V=this.pv,f=V._rows.size(),k=V._selectRowIndex+(qm(S)?-1:1);(qm(S)||Or(S))&&(0>k&&(k=0),k>=f&&(k=f-1),V.setSelectRowIndex(k))}}),fq.ListView=function(n){this._5o(n),new _k(this)},oo("ListView",I,{ms_ac:[pb,Jj,Nn,Zb,Xp,ti,Ab,Ai,os,Ee,zm,as,$g,Ih],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:bm,_rowHeight:yq,_rowLineVisible:O.listViewRowLineVisible,_rowLineColor:O.listViewRowLineColor,_scrollBarColor:dq,_scrollBarSize:dp,_autoMakeVisible:ud,_autoHideScrollBar:rq,_selectBackground:O.listViewSelectBackground,_labelColor:O.listViewLabelColor,_labelSelectColor:O.listViewLabelSelectColor,_labelFont:O.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(D){var M=this,b=M._checkMode;M._checkMode=D,M.fp(kg,b,D)},drawRow:function(d,Y,Q,W,k,q,j){var E=this,U=0,P=E._indent,T=E.getIconWidth(Y);E.drawRowBackground(d,Y,Q,W,k,q,j),E._checkMode&&(ao(d,qg(E.getCheckIcon(Y)),U+P/2,k+j/2,Y,E),U+=P),E.drawIcon(d,Y,U,k,T,j),E.drawLabel(d,Y,U+T,k,j)}});var _k=function(G){this.list=G,this._lastSelectDataTime=Yr(),this.addListeners()};Bg(_k,I,{ms_listener:1,getView:function(){return this.list._view},clear:function(t){var g=this,T=g.list;t&&"d"===g._62O&&!g.dragCancel&&T.handleDragAndDrop(t,"end"),T.draggingData&&(T.draggingData=null,T.redraw()),g.dragCancel=g._62O=g._isV=g._isH=g.cp=g.tx=g.ty=A},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(H){var w=this,D=w.list;if(Ec(H),D.setFocus(H)){var n=D.getDataAt(H);w.cp=Pb(H),w.tx=D.tx(),w.ty=D.ty(),im(H)?n&&D.handleDragAndDrop&&!w.isV(H)&&!w.isH(H)&&(D.draggingData=n,D.redraw(),D.handleDragAndDrop(H,"prepare")):(n&&w._33o(H,n),w.clear(H))}},handleWindowMouseUp:function(M){this.clear(M)},handleWindowTouchEnd:function(n){this.clear(n)},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(C){var d=this,b=d.list;if(!d._isV&&!d._isH&&d.cp&&!d._62O){var Q=b.getDataAt(C);Q?(b.isCheckMode()?d._34o(C,Q):d._33o(C,Q),yk(C)?b.onDataDoubleClicked(Q,C):b.onDataClicked(Q,C)):b.handleBackgroundClick(C)}d.clear(C)},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(K){var s=this,v=s.list,A=s._62O,J=s.tx,E=s.ty,U=s.cp,m=Pb(K),a=v._29I;"p"===A?v.setTranslate(J+m.x-U.x,E+m.y-U.y):"v"===A?v.ty(E+(U.y-m.y)*v._59I/a.height):"h"===A?v.tx(J+(U.x-m.x)*v._91I/a.width):"d"===A&&(s.dragCancel||v.handleDragAndDrop(K,"between"))},handle_mousemove:function(_){this.handle_touchmove(_)},handle_touchmove:function(e){if(!ig&&im(e)){var H=this,O=H.list;if(H._isV=H.isV(e),H._isH=H.isH(e),H.cp){if(!H._62O){if(Ng(Pb(e),H.cp)<2)return;H._isV?H._62O="v":H._isH?H._62O="h":O.draggingData&&!this.dragCancel?(H._62O="d",O.handleDragAndDrop(e,"begin")):H._62O="p",H._62O&&"d"!==H._62O&&O.draggingData&&(O.draggingData=null,O.redraw()),Ff(H)}}else H._isV&&O._43o(),H._isH&&O._42o()}},isV:function(i){var S=this.list,U=S._29I;return S._41o()&&U.x+U.width-S.lp(i).x<Fn},isH:function(S){var W=this.list,f=W._29I;return W._40o()&&f.y+f.height-W.lp(S).y<Fn},handle_mousewheel:function(M){this.handleScroll(M,M.wheelDelta/40,M.wheelDelta!==M.wheelDeltaX)},handle_DOMMouseScroll:function(L){this.handleScroll(L,-L.detail,1)},handleScroll:function(C,Z,T){var Q=this.list;Ec(C),Q.endEditing&&Q.endEditing(),T&&Q._41o()?Q.translate(0,Z*Q.getRowHeight()):Q._40o()&&Q.translate(10*Z,0)},handle_keydown:function(t){if(!O.isInput(t.target)){var Z,m=this.list,S=m.sm(),y=m._rows,U=y.size();if(cg(t))m.selectAll();else if(_l(t))m.handleDelete&&m.handleDelete(t);else if(hb(t))"d"!==this._62O||this.dragCancel||(m.handleDragAndDrop(t,"cancel"),this.dragCancel=!0);else if(Yk(t))m.isCheckMode()&&(Z=m.getFocusData(),Z&&m.checkData(Z));else if(qm(t)||Or(t)){var I=m.isCheckMode();if(Z=I?m.getFocusData():S.ld()){var l=m.getRowIndex(Z);l>=0&&(qm(t)?0!==l&&(Z=y.get(l-1),I?m.setFocusData(Z):S.ss(Z)):l!==U-1&&(Z=y.get(l+1),I?m.setFocusData(Z):S.ss(Z)))}else U>0&&(Z=y.get(0),I?m.setFocusData(Z):S.ss(Z))}}},_34o:function(B,E){var V=this.list,F=V.lp(B).x;return F>=0&&F<=V._indent?(V.checkData(E),void 0):(V.setFocusData(E),void 0)},_33o:function(u,$){var I=this.list,F=I.sm(),X=F.ld();if(Hr(u))I.isSelected($)?F.rs($):F.as($);else if(ah(u))if(X)for(var G=I.getRowIndex(X),z=I.getRowIndex($);G!==z;)G+=z>G?1:-1,F.as(I._rows.get(G));else F.ss($);else if(im(u)){var T=Yr();if(F.contains($)){var A=T-this._lastSelectDataTime;I.handleDataDoubleSelect&&A>500&&1500>A&&I.handleDataDoubleSelect(u,$)}F.ss($),this._lastSelectDataTime=T}else F.contains($)||F.ss($)}}),fq.TreeView=function(P){var i=this;i._35o(),i._5o(P),new Lb(i)},oo("TreeView",I,{ms_ac:[pb,Jj,Nn,"rootVisible",kg,"rootData",Ai,os,Ee,zm,as,Xp,Zb,ti,Ab,so,Rq,$g,Ih,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:A,_indent:bm,_rowHeight:yq,_rowLineVisible:O.treeViewRowLineVisible,_rowLineColor:O.treeViewRowLineColor,_scrollBarColor:dq,_scrollBarSize:dp,_autoHideScrollBar:rq,_expandIcon:O.treeViewExpandIcon,_collapseIcon:O.treeViewCollapseIcon,_autoMakeVisible:ud,_selectBackground:O.treeViewSelectBackground,_labelColor:O.treeViewLabelColor,_labelSelectColor:O.treeViewLabelSelectColor,_labelFont:O.treeViewLabelFont,_doubleClickToToggle:O.treeViewDoubleClickToToggle,drawRow:function(d,x,J,c,_,H,F){var C=this;C.drawRowBackground(d,x,J,c,_,H,F),C._97I(d,x,J,0,_,H,F)},isOnToggleIcon:function(l){var z=this.getDataAt(l);if(z){var n=this.getIndent(),g=this.lp(l).x;if(qg(this.getToggleIcon(z))){var Y=n*this.getLevel(z);if(g>=Y&&Y+n>=g)return!0}}return!1}});var Lb=function(U){To(Lb,this,[U])};Bg(Lb,_k,{toggle:function(v,d,P,q){var g=this.list,h=g.lp(v).x;if(qg(g.getToggleIcon(d))){var R=P*q;if(h>=R&&R+P>=h)return g.toggle(d),!0}return g.isDoubleClickToToggle()&&yk(v)?(g.toggle(d),!0):!1},_34o:function(P,Z){var k=this.list,W=k.lp(P).x,h=k._levelMap[Z._id],v=k._indent,A=v*(h+1);return W>=A&&A+v>=W?(k.checkData(Z),void 0):(this.toggle(P,Z,v,h)||k.setFocusData(Z),void 0)},_33o:function(B,p){var N=this,V=N.list;if(!N.toggle(B,p,V._indent,V.getLevel(p)))if(ah(B)){var T=V.sm();if(T.size()>0){for(var e=V._rows,L=null,S=0,W=e.size();W>S;S++)if(V.isSelected(e.get(S))){L=S;break}for(var b=null,S=e.size()-1;S>=0;S--)if(V.isSelected(e.get(S))){b=S;break}var z,i,q=V.getRowIndex(p);for(L>q?(z=q-1,i=L):q>b?(z=b,i=q):(z=L,i=b);z!==i;)z++,T.as(V._rows.get(z))}else T.ss(p)}else Lb.superClass._33o.call(N,B,p)},handle_keydown:function(f){if(Hb(f)||pi(f)){var w=this.list,Q=w._rows,n=w.isCheckMode(),G=w.sm(),g=n?w.getFocusData():G.ld();g?g.hasChildren()&&(Hb(f)?w.collapse(g):w.expand(g)):Q.size()>0&&(g=Q.get(0),n?w.setFocusData(g):G.ss(g))}else Lb.superClass.handle_keydown.call(this,f)}});var pl=fq.TableView=function(k){this._98I(),this._5o(k),new Ue(this)};oo("TableView",I,{ms_ac:[pb,Jj,Nn,"sortMode",hd,Gn,Zb,ti,Ab,Fg,vq,"sortColumn",Ai,os,Ee,zm,as,$g,Ih],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:zq,_editable:!0,_batchEditable:!1,_rowHeight:yq,_rowLineVisible:O.tableViewRowLineVisible,_rowLineColor:O.tableViewRowLineColor,_columnLineVisible:O.tableViewColumnLineVisible,_columnLineColor:O.tableViewColumnLineColor,_scrollBarColor:dq,_scrollBarSize:dp,_autoHideScrollBar:rq,_autoMakeVisible:ud,_selectBackground:O.tableViewSelectBackground,_labelColor:O.tableViewLabelColor,_labelSelectColor:O.tableViewLabelSelectColor,_labelFont:O.tableViewLabelFont,getCheckColumn:function(){var J=this;if(!J._31o){var Z=J._31o=new fs;Z.setEditable(!0),Z.setWidth(40),Z.getValue=J.getCheckColumValue,Z.drawCell=J.drawCheckColumnCell}return J._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(v){var T=this,H=T._39o,h=T.getCheckColumn();v!==T.isCheckMode()&&(v?H.add(h,0):H.remove(h),T.fp(kg,!v,v))},getCheckColumValue:function(L,Q,$){return $.isSelected(L)},drawCheckColumnCell:function(w,E,T,O,W,k,B,m,H){ao(w,H.getCheckIcon(E),W+B/2,k+m/2,E,H)}});var Ue=function(X){To(Ue,this,[X])};Bg(Ue,_k,{_34o:function(L,H){var S=this.list,O=S._31o;if(S.isCellEditable(H,O,L)){var n=S._3Q(O),Q=S.lp(L).x;if(n&&Q>=n.startX&&Q<n.startX+O.getWidth())return S.checkData(H),void 0}S._37O(H,L),S.setFocusData(H)},_33o:function(w,S){this.list._37O(S,w),Ue.superClass._33o.apply(this,arguments)}});var qn=fq.TreeTableView=function(b){var q=this,m=q._4o=new fs;q._35o(),q._98I(),q._5o(b),m.setDisplayName("Name"),m.setEditable(!0),m.setWidth(180),m.drawCell=xq,m.getValue=Pl,q._39o.add(m),new Zn(q)},xq=function(m,I,F,D,l,Q,V,s,v){v._97I(m,I,F,l,Q,V,s)},Pl=function(c,r,$){return $.getLabel(c)};oo("TreeTableView",I,{ms_ac:[pb,Jj,Nn,"sortMode",hd,Gn,Xp,kg,"rootData","rootVisible",Ai,os,"sortColumn",so,Rq,Ee,zm,as,$g,Ab,Zb,ti,Fg,vq,Ih,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:zq,_checkMode:A,_editable:!0,_batchEditable:!1,_indent:bm,_rowHeight:yq,_rowLineVisible:O.treeTableViewRowLineVisible,_rowLineColor:O.treeTableViewRowLineColor,_columnLineVisible:O.treeTableViewColumnLineVisible,_columnLineColor:O.treeTableViewColumnLineColor,_expandIcon:O.treeTableViewExpandIcon,_collapseIcon:O.treeTableViewCollapseIcon,_scrollBarColor:dq,_scrollBarSize:dp,_autoHideScrollBar:rq,_autoMakeVisible:ud,_selectBackground:O.treeTableViewSelectBackground,_labelColor:O.treeTableViewLabelColor,_labelSelectColor:O.treeTableViewLabelSelectColor,_labelFont:O.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Zn=function(e){To(Zn,this,[e])};Bg(Zn,_k,{_34o:function(u,O){var J=this.list,V=J._4o,C=J._3Q(V),l=J.lp(u).x;if(C){var U=J._indent,N=C.startX+U*J.getLevel(O);if(qg(J.getToggleIcon(O))&&l>=N&&N+U>=l)return J.toggle(O),void 0;if(J.isCellEditable(O,V)&&(N+=U,l>=N&&N+U>=l))return J.checkData(O),void 0}J._37O(O,u),J.setFocusData(O)},_33o:function(k,g){var x=this.list,y=x.lp(k).x;if(qg(x.getToggleIcon(g))){var I=x._3Q(x._4o);if(I){var h=x._indent,H=I.startX+h*x.getLevel(g);if(y>=H&&H+h>=y)return x.toggle(g),void 0}}x._37O(g,k),Zn.superClass._33o.apply(this,arguments)}});var dc=fq.TableHeader=function(_){var c=this,d=c._view=hg(1,c),b=c._39o=_.getColumnModel(),z=c.iv;c.tv=c._tableView=_,c._60I=new Dj,c._canvas=Eg(d),d.style.background=O.tableHeaderBackground||"",d.style.height=tp+Ug,b.mm(z,c),b.md(z,c),b.mh(z,c),_.mp(function(d){_c[d.property]&&c.iv()},c),new zf(c),c.iv()};oo("TableHeader",I,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",pb,Nn,Xp,"moveBackground","insertColor",Fg,vq,"resizable","movable"],_checkIcon:xi,_movable:!0,_resizable:!0,_labelColor:O.tableHeaderLabelColor,_labelFont:O.tableHeaderLabelFont,_columnLineColor:O.tableHeaderColumnLineColor,_columnLineVisible:O.tableHeaderColumnLineVisible,_sortDescIcon:O.tableHeaderSortDescIcon,_sortAscIcon:O.tableHeaderSortAscIcon,_moveBackground:O.tableHeaderMoveBackground,_insertColor:O.tableHeaderInsertColor,_indent:bm,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(H){return H.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(M){return M.getColor()||this._labelColor},getLabelAlign:function(U){return U._align},onPropertyChanged:function(){this.iv()},_5Q:function(z){this._61I=z,this.iv()},getLogicalPoint:function($){return wg($,this._canvas,this.tv.tx())},validateImpl:function(){var k=this,c=k._canvas,F=k.getWidth(),r=k.getHeight(),N=k.tv,j=k._60I,M=k._61I,l=-N.tx(),o=0;(F!==c.clientWidth||r!==c.clientHeight)&&jd(c,F,r),j.clear(),k._39o._roots.each(function(P){if(P.isVisible()){var I=o+P.getWidth();l+F>=o&&I>=l&&j.add({column:P,startX:o}),o=I}});var y=pm(c);if(aq(y,-l,0,1),y.beginPath(),y.rect(l,0,F,r),y.clip(),y.clearRect(l,0,F,r),j.each(function(V){var n=V.column,K=V.startX,U=n.getWidth();U>0&&(y.save(),y.beginPath(),y.rect(K,0,U,r),y.clip(),M&&M.column===n||k.drawColumn(y,n,K,0,U,r),k._columnLineVisible&&Hq(y,K+U-1,0,1,r,k._columnLineColor),y.restore())}),M){var E=M.column,o=M.startX,u=M.position,a=E.getWidth();y.save(),y.beginPath(),y.rect(o,0,a,r),y.clip(),y.fillStyle=k._moveBackground,y.fill(),k.drawColumn(y,E,o,0,a,r),y.restore(),zj(y,k._insertColor,u,0,r)}y.restore()},_6Q:function(t){var J=this.tv;return J._31o===t&&J.sm().getSelectionMode()===Tj},drawColumn:function(s,f,E,u,_,M){var g=this,O=g.tv,n=qg(f.getIcon()),G=g.getLabelAlign(f);if(g._6Q(f)){var j=qg(g._checkIcon);ao(s,j,E+_/2,u+M/2,f,g)}else{var S=g.getLabel(f),V=g.getLabelFont(f),H=g.getLabelColor(f),W=wr(V,S).width,L=n?g._indent:0;G===zd?(n&&Cl(s,n,lq,E,u,L,M),ji(s,S,V,H,E+L,u,_,M,zd)):G===Nl?(n&&Cl(s,n,lq,E+_-W-L,u,L,M),ji(s,S,V,H,E,u,_,M,Nl)):(n&&Cl(s,n,lq,E+(_-W-L)/2,u,L,M),ji(s,S,V,H,E+(_-W+L)/2,u,0,M,zd))}if(f.isSortable()&&O.getSortColumn()===f&&(n=qg(f.getSortOrder()===yl?g._sortAscIcon:g._sortDescIcon))){var X=Wb(n,f)/2+2;ao(s,n,G===Nl?E+X:E+_-X,u+M/2,f,O)}}});var zf=function(x){var X=this;X.th=x,X.tv=x._tableView,X.addListeners()};Bg(zf,I,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(I){this.getView().style.cursor=I},handle_mousemove:function(a){if(!ig){var e=this;delete e._29o,e.setCursor(lc);for(var _=e.th,D=_._60I,u=_.lp(a).x,Y=D.size()-1;Y>=0;Y--){var n=D.get(Y),J=n.column,Q=n.startX+J.getWidth();if(_.isResizable()&&G(Q-u)<=(hj?10:3))return e._29o=n,e.setCursor(Vq),void 0;u>n.startX&&Q>u&&(e._29o=n),(J.isClickable()||J.isSortable()||_.isMovable()||e.tv.getCheckColumn&&J===e.tv.getCheckColumn())&&u>n.startX&&Q>u&&e.setCursor(ek)}}},handle_mousedown:function(y){this.handle_touchstart(y)},handle_touchstart:function(y){var g=this;Ec(y),g.tv.endEditing(),g.handle_mousemove(y),g._29o&&(g.x=Pb(y).x,g.lx=g.th.lp(y).x,g.w=g._29o.column.getWidth(),Ff(g,y))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(r){var N=this,v=N.th,L=N.getView().style.cursor,_=N._29o,b=Pb(r).x-N.x;if(N.resizing||N.moving||(L===Vq?N.resizing=1:v.isMovable()&&L===ek&&G(b)>2&&(N.moving=1)),N.resizing)_.column.setWidth(N.w+b);else if(N.moving){var D=N.lx+b;v._60I.each(function(c){var r=c.startX,T=r+c.column.getWidth();if(D>=r&&T>=D){var Y={column:_.column,startX:_.startX+b,front:T-D>D-r,insertColumn:c.column};Y.position=Y.front?r:T,v._5Q(Y)}})}},_16Q:function(E,N){var U=this,p=U.tv,H=U.th,L=H._checkIcon;if(H._6Q(E)){var x=qg(L),V=U.lx,M=E.getWidth(),z=Wb(x,E);if(V>=N+M/2-z&&N+M/2+z>=V){H.setCheckIcon(L===Mh?xi:Mh);var $=p.sm(),K=p._rows;return L===Mh?$.rs(K):$.ss(K),p.onCheckColumnClicked(E),!0}}return!1},handleWindowMouseUp:function(H){this.handleWindowTouchEnd(H)},handleWindowTouchEnd:function(u){var p=this,c=p.tv,o=p.th,y=p._29o;if(p.moving){var D=o._61I;if(D&&D.insertColumn!==D.column){var j=D.column,O=c.getColumnModel()._roots,h=O.remove(j),q=O.indexOf(D.insertColumn);q>=0&&(D.front||q++,q<=O.size()&&(O.add(j,q),c.getColumnModel()._38I(j,h,q)))}o._5Q(A),delete p.moving}else if(!p.resizing&&y){j=y.column;var U=o.lp(u).x,s=y.startX,E=!0;if(o.onColumnClicked){var x=o.onColumnClicked(j,u,s);x===!1&&(E=!1)}if(E&&U>=s&&U<=s+j.getWidth()&&!p._16Q(j,s)){if(j.isSortable()){var K=c.getSortMode(),W=j.getSortOrder();K===zq?c.getSortColumn()===j?(W===$i&&c.setSortColumn(A),j.setSortOrder(W===yl?$i:yl)):c.setSortColumn(j):"bistate"===K&&(c.getSortColumn()===j?j.setSortOrder(W===yl?$i:yl):c.setSortColumn(j))}c.onColumnClicked(j,u,s)}}p._29o=p.resizing=p.x=p.lx=p.w=A}}),fq.TablePane=function(G){this.init(new pl(G))},oo("TablePane",I,{ms_v:1,_44o:1}),fq.TreeTablePane=function(t){this.init(new qn(t))},oo("TreeTablePane",I,{ms_v:1,_44o:1}),fq.Toolbar=function(c){var y=this,J=y._view=hg(1,y),C=J.style;C.background=O.toolbarBackground||"",C.height=kn+Ug,y._canvas=Eg(J),y._30o=new Dj,y._90I=new Dj,y.setItems(c||[]),J.handleGroupSelectedChanged=function(N){if(N.isSelected()){var E=N.getGroupId();null!=E&&y._items.forEach(function(m){var l=m.element;l&&l!==N&&l.setSelected&&l.getGroupId&&l.getGroupId()===E&&l.setSelected(!1)})}},new Tf(y)},oo("Toolbar",I,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Wk,pb,Nn,Jj,Ih,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:O.toolbarLabelColor,_labelSelectColor:O.toolbarLabelSelectColor,_labelFont:O.toolbarLabelFont,_selectBackground:O.toolbarSelectBackground,_itemGap:O.toolbarItemGap,_separatorColor:O.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(t){var c=this.getItemInfoAt(t);return c?c.item.toolTip:A},getLabelColor:function(W){return W&&W.selected&&W.type!==Mh&&W.type!==hq?this._labelSelectColor:this._labelColor},onPropertyChanged:function(o){this.iv(),o.property===Wk&&this._items.forEach(function(W){nq(W)})},redraw:function(){this.iv()},addItem:function(q,J){var P=this._items;J==A?P.push(q):P.splice(J,0,q),this.fp(Wk,A,P)},removeItem:function(b){if(b)for(var w=this._items,s=0;s<w.length;s++)b===w[s]&&(w.splice(s,1),this.fp(Wk,A,w))},removeItemById:function(C){if(C!=A)for(var f=this._items,d=0;d<f.length;d++)if(C===f[d].id){var w=f.splice(d,1)[0];return this.fp(Wk,A,f),w}},getItemById:function(Q){if(Q!=A)for(var n=this._items,f=0;f<n.length;f++){var u=n[f];if(Q===u.id)return u}},setItemVisible:function(t,q){var S=this.getItemById(t);S&&(S.visible=q)},getItemInfos:function(){return this._30o},getItemInfoAt:function(D){var k=this,U=0,Q=k._30o,l=k.lp(D),S=l.x,E=l.y;if(E>=0&&E<=k.getHeight())for(;U<Q.size();U++){var d=Q.get(U);if(d.startX<=S&&S<=d.endX)return d}return A},drawItem:function(u,A,U,c,r){if(A.visible===!1)return 0;if(ne(A.visible)&&!A.visible())return 0;var D=this,z=A.disabled;z&&(u.globalAlpha=Ep);var k=D.drawItemImpl(u,A,U,c,r),Z=D._itemGap;return z&&(u.globalAlpha=1),this._currentItem!==A||"separator"===A||A.separator===!0||A.unfocusable||Qm(u,D._separatorColor,U-Z/2,0,k+Z,c),k},drawItemImpl:function(c,B,Q,S,J){var m=this,T=m._view,g=m._itemGap,r=S/2,e=B.type,P=B.element,L=B.label;xr(P)&&(L=P,P=A);var U,j=m.getLabelFont(B),p=m.getLabelColor(B),F=B.selected,C=qg(B.icon),h=Wb(C,B),$=0,f=h+(L?wr(j,L).width:0);if("separator"===B||B.separator===!0)return zj(c,m._separatorColor,Q,S/4,r),1;if(P){C&&ao(c,C,Q+h/2,r,B,m),ji(c,L,j,p,Q+h,0,0,S);var E=Yg(P);J||m._90I.add(E),E.parentNode!==T&&gr(T,E),P.iv&&P.iv(),P.validate&&P.validate();var O=E.getBoundingClientRect(),k=O.width,s=E.style;return dm(E),s.left=m.tx()+Q+f+Ug,s.top=(S-O.height)/2+Ug,f+k}return e===hq?U=qg(F?jj:_r):e===Mh&&(U=qg(F?Mh:xi)),U?($=Wb(U,B),ao(c,U,Q+$/2,r,B,m),Q+=$,f+=$):F&&Hq(c,Q-g/2,0,f+g,S,m.getSelectBackground(B)),C&&ao(c,C,Q+h/2,r,B,m),ji(c,L,j,p,Q+h,0,0,S),f},validateImpl:function(){var y=this,a=y._canvas,c=y.getWidth(),L=y.getHeight(),f=y._30o,Q=y._items;jd(a,c,L);var R=pm(a),P=y._itemGap,n=P/2;aq(R,y.tx(),0,1),R.clearRect(0,0,c,L);var A=y._90I;y._90I=new Dj,f.clear(),Q.forEach(function(o){var C=y.drawItem(R,o,n,L);f.add({item:o,startX:n,endX:n+C,width:C}),C&&(n+=C+P)}),A.each(function(d){y._90I.contains(d)||ws(d)});var s=y._64I;y._64I=$(0,n),R.restore(),y._stickToRight?(y._65O=0,R=pm(a),n=c-y._64I+P,aq(R,0,0,1),R.clearRect(0,0,c,L),f.clear(),Q.forEach(function(p){var x=y.drawItem(R,p,n,L,!0);f.add({item:p,startX:n,endX:n+x,width:x}),x&&(n+=x+P)}),R.restore()):y.tx(y.tx()),s!==y._64I&&y.onSumWidthChanged(s,y._64I)},onSumWidthChanged:function(){},handleClick:function(t,G){var L=this,Y=t.type,C=t.action,N=t.groupId,r=t.selected;t.disabled||(N!=A?r||(t.selected=!0,this._items.forEach(function(r){r.groupId===N&&t!==r&&(r.selected=!1)}),C&&t.action(t,L,G)):Y===Mh||"toggle"===Y?(t.selected=!r,C&&t.action(t,L,G)):C&&t.action(t,L,G)),ts(),L.iv()}});var Tf=function(P){this.tb=P,this.addListeners()};Bg(Tf,I,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(v){this.handleScroll(v,10*(v.wheelDelta/40))},handle_DOMMouseScroll:function(o){this.handleScroll(o,10*-o.detail)},handleScroll:function(x,I){Ec(x);var D=this.tb;D.isScrollable()&&!D._stickToRight&&(D.tx(D.tx()+I),qk())},handle_mousemove:function(d){var e=this;ig||e.setItem(d)},handle_mouseout:function(Q){var E=this;Q.target===E.getView()?E.tb.setCurrentItem(A):E.handle_mousemove(Q)},handle_mousedown:function(k){this.handle_mousemove(k),this.handle_touchstart(k)},handle_touchstart:function(g){var c=this,X=c.tb,f=g.target;im(g)&&(f===c.getView()||f===X._canvas)&&(Ec(g),X.setFocus(g)&&(this.setItem(g,!0),(X.isScrollable()||c.info&&!c.info.item.disabled)&&(c.x=Pb(g).x,c.tx=X.tx(),Ff(c,g))))},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function($){var J=this,E=J.tb;if(!E._stickToRight){var D=Pb($).x-J.x;!J._25o&&G(D)>2&&E.isScrollable()&&(J._25o=1),J._25o&&E.tx(J.tx+D)}},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(S){var D=this,L=D.tb,H=D.info,M=D.tb.getItemInfoAt(S);if(!D._25o&&H){var t=H.item;M&&M.item===t&&L.handleClick(t,S)}D._25o=D.x=D.tx=A,D.setItem()},setItem:function(E,e){var V=this,O=V.tb,$=V.info=E?O.getItemInfoAt(E):A,F=$?$.item:A;O.setCurrentItem(F),e&&F&&ne(F.onDown)&&F.onDown(E)}}),fq.BorderPane=function(){this._view=hg(1,this),this.iv()},oo("BorderPane",I,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(u,H){this._12o("leftView",u),H!=A&&this.setLeftWidth(H)},getRightView:function(){return this._rightView},setRightView:function(G,d){this._12o("rightView",G),d!=A&&this.setRightWidth(d)},getTopView:function(){return this._topView},setTopView:function(p,U){this._12o("topView",p),U!=A&&this.setTopHeight(U)},getBottomView:function(){return this._bottomView},setBottomView:function(J,D){this._12o("bottomView",J),D!=A&&this.setBottomHeight(D)},getCenterView:function(){return this._centerView},setCenterView:function(Q){this._12o("centerView",Q)},_12o:function(w,A){var z=this,c="_"+w,f=z._view,O=z[c];O!==A&&(O&&(O.getView?ws(O.getView()):ws(O)),z[c]=A,A&&(A.getView?gr(f,A.getView(),1):gr(f,A,1)),z.fp(w,O,A))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var E=this,P=E._topView,y=E._bottomView,v=E._leftView,U=E._rightView,R=E._centerView,X=E.getWidth(),u=E.getHeight(),S=0,r=0,g=X,Q=u,G=0,m=0,t=0,W=0;
P&&(G=E._topHeight==A?$m(P):E._topHeight,r=G),y&&(m=E._bottomHeight==A?$m(y):E._bottomHeight,Q=u-m),v&&(t=E._leftWidth==A?Pm(v):E._leftWidth,S=t),U&&(W=E._rightWidth==A?Pm(U):E._rightWidth,g=X-W);var O=$(0,g-S),z=$(0,Q-r);P&&tj(P,0,0,X,G),y&&tj(y,0,Q,X,m),v&&tj(v,0,r,t,z),U&&tj(U,g,r,W,z),R&&tj(R,S,r,O,z)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);